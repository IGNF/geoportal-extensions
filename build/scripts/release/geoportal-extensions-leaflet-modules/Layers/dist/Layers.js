/*!
 * @brief French Geoportal Extension for Leaflet
 *
 * This software is released under the licence CeCILL-B (Free BSD compatible)
 * @see http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt
 * @see http://www.cecill.info/licences/Licence_CeCILL-B_V1-fr.txt
 * @see http://www.cecill.info/
 *
 * @copyright copyright (c) IGN 
 * @license CeCILL-B
 * @author IGN
 * @version 2.2.7
 * @date 18/11/2022
 *
 */
Layers=function(e){var t={};function i(o){if(t[o])return t[o].exports;var n=t[o]={i:o,l:!1,exports:{}};return e[o].call(n.exports,n,n.exports,i),n.l=!0,n.exports}return i.m=e,i.c=t,i.d=function(e,t,o){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(i.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)i.d(o,n,function(t){return e[t]}.bind(null,n));return o},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=76)}({0:function(e,t){e.exports=L},15:function(e,t){var i;i=function(){return this}();try{i=i||new Function("return this")()}catch(e){"object"==typeof window&&(i=window)}e.exports=i},23:function(e){e.exports=JSON.parse('{"name":"geoportal-extensions","description":"French Geoportal Extensions for OpenLayers, Leaflet and iTowns libraries","version":"2.7.2","date":"18/11/2022","leafletExtName":"French Geoportal Extension for Leaflet","leafletExtVersion":"2.2.7","olExtName":"French Geoportal Extension for OpenLayers","olExtVersion":"3.2.18","itownsExtName":"French Geoportal Extension for Itowns","itownsExtVersion":"2.3.9","main":"dist/leaflet/GpPluginLeaflet.js, dist/openlayers/GpPluginOpenLayers.js, dist/itowns/GpPluginItowns.js","types":"dist/leaflet/index.d.ts, dist/openlayers/index.d.ts, dist/itowns/index.d.ts","module":"src/Leaflet/index.js, src/OpenLayers/index.js, src/Itowns/index.js","directories":{},"scripts":{"setup":"npm install","clean":"echo \\"Warning: target not yet implemented!\\" && exit 0","eslint":"eslint src/","test":"npm run test:serve","test:serve":"cd test && webpack-dev-server --hot --config webpack.test.serve.js","sample":"npm run sample:serve","sample:serve":"npm run sample:ol:serve","sample:itowns:serve":"webpack-dev-server --config build/webpack/webpack.config.itowns --mode=development --https --open-page samples/index-itowns-map.html --content-base . --output-public-path \'/dist/itowns/\' --port 9001 --open","sample:leaflet:serve":"webpack-dev-server --config build/webpack/webpack.config.leaflet --mode=development --https --open-page samples/index-leaflet-map.html --content-base . --output-public-path \'/dist/leaflet/\' --port 9001 --open","sample:ol:serve":"webpack-dev-server --config build/webpack/webpack.config.openlayers --mode=development --https --open-page samples/index-openlayers-map.html --content-base . --output-public-path \'/dist/openlayers/\' --port 9001 --open","generate-types:ol":"npx tsc -p build/types/tsconfig-openlayers.json","generate-types:leaflet":"npx tsc -p build/types/tsconfig-leaflet.json","generate-types:itowns":"npx tsc -p build/types/tsconfig-itowns.json","generate-jsdoc:ol":"jsdoc -c build/jsdoc/jsdoc-openlayers.json","generate-jsdoc:leaflet":"jsdoc -c build/jsdoc/jsdoc-leaflet.json","generate-jsdoc:itowns":"jsdoc -c build/jsdoc/jsdoc-itowns.json","doc":"npm run doc:serve","doc:serve":"npm run doc:ol:serve","doc:itowns:serve":"webpack-dev-server --hot  --config build/webpack/webpack.config.itowns --content-base jsdoc/itowns --port 9001 --open","doc:leaflet:serve":"webpack-dev-server --hot  --config build/webpack/webpack.config.leaflet --content-base jsdoc/leaflet --port 9001 --open","doc:ol:serve":"webpack-dev-server --hot  --config build/webpack/webpack.config.openlayers --content-base jsdoc/openlayers --port 9001 --open","build:dev":"npm-run-all --print-label --print-name build:*:dev","build:prod":"npm-run-all --print-label --print-name build:*:prod","build:src":"npm-run-all --print-label --print-name build:*:src","build":"npm-run-all --print-label --print-name build:*:*","build:itowns":"npm-run-all --print-label --print-name build:itowns:*","build:itowns:dev":"webpack --config build/webpack/webpack.config.itowns --mode=development","build:itowns:prod":"webpack --config build/webpack/webpack.config.itowns --mode=production","build:itowns:src":"webpack --config build/webpack/webpack.config.itowns --mode=none","build:ol":"npm-run-all --print-label --print-name build:ol:*","build:ol:dev":"webpack --config build/webpack/webpack.config.openlayers --mode=development","build:ol:prod":"webpack --config build/webpack/webpack.config.openlayers --mode=production","build:ol:src":"webpack --config build/webpack/webpack.config.openlayers --mode=none","build:ol-modules":"npm-run-all --print-label --print-name build:ol-modules:*","build:ol-modules:dev":"webpack --config build/webpack/webpack.config.openlayers.modules --mode=development","build:ol-modules:prod":"webpack --config build/webpack/webpack.config.openlayers.modules --mode=production","build:ol-modules:src":"webpack --config build/webpack/webpack.config.openlayers.modules --mode=none","build:leaflet":"npm-run-all --print-label --print-name build:leaflet:*","build:leaflet:dev":"webpack --config build/webpack/webpack.config.leaflet --mode=development","build:leaflet:prod":"webpack --config build/webpack/webpack.config.leaflet --mode=production","build:leaflet:src":"webpack --config build/webpack/webpack.config.leaflet --mode=none","build:leaflet-modules":"npm-run-all --print-label --print-name build:leaflet-modules:*","build:leaflet-modules:dev":"webpack --config build/webpack/webpack.config.leaflet.modules --mode=development","build:leaflet-modules:prod":"webpack --config build/webpack/webpack.config.leaflet.modules --mode=production","build:leaflet-modules:src":"webpack --config build/webpack/webpack.config.leaflet.modules --mode=none"},"repository":{"type":"git","url":"https://github.com/IGNF/geoportal-extensions.git"},"author":"IGNF","keywords":["geoportail","javascript","OpenLayers","Leaflet","Itowns","3D"],"license":"CECILL-B","bugs":{"url":"https://github.com/IGNF/geoportal-extensions/issues"},"homepage":"https://github.com/IGNF/geoportal-extensions#readme","dependencies":{"@mapbox/mapbox-gl-style-spec":"13.20.1","eventbusjs":"0.2.0","geoportal-access-lib":"3.2.0","itowns":"2.38.2","leaflet":"1.7.1","leaflet-draw":"1.0.4","loglevel":"^1.6.7","markdown-toc":"^1.2.0","ol":"6.9.0","ol-mapbox-style":"6.7.0","proj4":"2.7.5","proj4leaflet":"1.0.2","sortablejs":"1.14.0","three":"0.137.5","typescript":"^4.5.5","whatwg-fetch":"3.0.0"},"devDependencies":{"@babel/core":"^7.4.4","@babel/plugin-transform-template-literals":"^7.7.4","@babel/preset-env":"^7.4.4","babel-loader":"^8.0.5","chai":"^4.2.0","chalk":"^4.0.0","clean-webpack-plugin":"^3.0.0","copy-webpack-plugin":"^5.0.3","core-js":"^3.6.4","css-loader":"^3.4.2","eslint":"^6.8.0","eslint-config-standard":"^14.1.1","eslint-loader":"^4.0.0","eslint-plugin-import":"^2.17.2","eslint-plugin-node":"^11.1.0","eslint-plugin-promise":"^4.1.1","eslint-plugin-standard":"^4.0.0","exports-loader":"^0.7.0","expose-loader":"^0.7.5","fs-extra":"^9.0.0","handlebars":"^4.7.5","handlebars-layouts":"^3.1.4","html-webpack-plugin":"^4.0.4","jsdoc-webpack-plugin":"^0.3.0","mini-css-extract-plugin":"^0.9.0","mocha":"^7.1.1","mocha-loader":"^5.0.0","npm-run-all":"^4.1.5","optimize-css-assets-webpack-plugin":"^5.0.1","path":"^0.12.7","replace-bundle-webpack-plugin":"^1.0.0","requirejs":"^2.3.6","responsive-loader":"^1.2.0","speed-measure-webpack-plugin":"^1.3.0","string-template":"^1.0.0","style-loader":"^1.1.3","terser-webpack-plugin":"^2.0.0","url-loader":"^4.0.0","webpack":"^4.30.0","webpack-cli":"^3.3.1","webpack-dev-server":"^3.3.1","webpack-node-externals":"^1.7.2"}}')},30:function(e,t,i){"use strict";var o={getZoomLevelFromScaleDenominator:function(e,t){var i={};switch(t){case"EPSG:2154":i={0:104579.224549894,1:52277.5323537905,2:26135.4870785954,3:13066.8913818,4:6533.2286041135,5:3266.5595244627,6:1633.2660045974,7:816.629554986,8:408.3139146768,9:204.1567415109,10:102.0783167832,11:51.0391448966,12:25.5195690743,13:12.7597836936,14:6.379891636,15:3.1899457653,16:1.5949728695,17:.7974864315,18:.3987432149,19:.1993716073,20:.0996858037,21:.0498429018};break;default:i={0:156543.033928041,1:78271.51696402048,2:39135.758482010235,3:19567.87924100512,4:9783.93962050256,5:4891.96981025128,6:2445.98490512564,7:1222.99245256282,8:611.49622628141,9:305.7481131407048,10:152.8740565703525,11:76.43702828517624,12:38.21851414258813,13:19.10925707129406,14:9.554628535647032,15:4.777314267823516,16:2.388657133911758,17:1.194328566955879,18:.5971642834779395,19:.2985821417389697,20:.1492910708694849,21:.0746455354347424}}var o=28e-5*e;for(var n in i)if(i.hasOwnProperty(n)&&i[n]<=o)return n=parseInt(n,10);return 0},getAttributions:function(e){var t=e.zoom,i=[];if(null!=e.originators&&e.visibility)for(var o,n=0,a=e.originators.length;n<a;n++){o=!0;for(var r=e.originators[n],s=e.originators[n].constraints||[],l=0,p=s.length;l<p;l++){var c=s[l];o=!0;var d=this.getZoomLevelFromScaleDenominator(c.maxScaleDenominator,e.crs),u=this.getZoomLevelFromScaleDenominator(c.minScaleDenominator,e.crs)||21;d&&d>t&&(o=!1),o&&u&&u<t&&(o=!1);var m=c.bbox;if(o&&m){o=!1;var f=e.extent;if(f){var g=[m.top,m.left,m.bottom,m.right];if(this.intersects(f,g)){o=!0;break}}}}if(o){var h=r.logo,v=r.url,b=r.name?r.name:"",y=r.attribution,w=document.createElement("div");w.className="gp-control-attribution";var k=null;(k=document.createElement("a")).className="gp-control-attribution-link",k.target="_blank",w.appendChild(k),v&&(k.href=v);var _=null;!!h?(_=document.createElement("img"),k?(_.className="gp-control-attribution-image",k.appendChild(_)):(_.className="",w.appendChild(_)),_.src=h,_.title=y||b,_.style.height="30px",_.style.width="30px"):k.textContent=b||(y||(v||"")),i.push(w.innerHTML+" ")}}return i},intersects:function(e,t){var i=e[1]<=t[3]&&t[1]<=e[3],o=e[2]<=t[0]&&t[2]<=e[0];return i&&o}};t.a=o},31:function(e,t,i){"use strict";var o=i(5),n=i(30),a=o.a.getLogger("layer-event"),r={_id:null,_attributions:[],_visibility:!0,_originators:[],isEnable:function(e){return!!e.attributionControl},setVisible:function(e){a.log("visibility",e),this._visibility=e,this.fire("visibilitychange")},getVisible:function(){return this._visibility},_onRemoveLayer:function(e){a.trace("onRemove event",e),e.layer._geoportal_id===this._geoportal_id&&this.setVisible(!1)},_onAddLayer:function(e){a.trace("onAdd event",e),e.layer._geoportal_id===this._geoportal_id&&this.setVisible(!0)},_onMoveEndLayer:function(e){a.trace("moveend event",e),this.updateAttributions(this._map,this)},updateAttributions:function(e){this.isEnable(e)&&(this.removeAttributions(e),this.addAttributions(e),this.fire("attributionchange"))},removeAttributions:function(e){if(a.trace("removeAttributions...",this._geoportal_id),this.isEnable(e)){for(var t=0;t<this._attributions.length;t++)e.attributionControl.removeAttribution(this._attributions[t]);this._attributions=[]}},addAttributions:function(e){if(a.trace("addAttributions...",this._geoportal_id),this.isEnable(e)){var t=e.getBounds().getNorthWest(),i=e.getBounds().getSouthEast(),o={extent:[t.lat,t.lng,i.lat,i.lng],zoom:e.getZoom(),originators:this._originators,visibility:this._visibility};a.log(o);var r=n.a.getAttributions(o);if(a.log(r),r&&0!==r.length)for(var s=0;s<r.length;s++)this._attributions.push(r[s]),e.attributionControl.addAttribution(r[s])}}};t.a=r},5:function(e,t,i){"use strict";var o=i(6),n={getLogger:function(e){"true".match(/true/)?o.disableAll():o.enableAll();var t=e||"default";return o.getLogger(t)},disableAll:function(){var e=o.getLoggers();for(var t in e){if(Object.hasOwnProperty.call(e,t))e[t].disableAll()}},enableAll:function(){var e=o.getLoggers();for(var t in e){if(Object.hasOwnProperty.call(e,t))e[t].enableAll()}}};t.a=n},54:function(e,t,i){"use strict";i.r(t);var o=i(7),n=i(0),a=i.n(n),r=i(5),s=i(31),l=i(23),p=r.a.getLogger("wms"),c=a.a.TileLayer.WMS.extend({includes:s.a,initialize:function(e,t){var i={};a.a.Util.extend(i,t.paramsWms,t.paramsNative),a.a.TileLayer.WMS.prototype.initialize.call(this,o.a.normalyzeUrl(e,{"gp-leaflet-ext":l.leafletExtVersion||l.version},!1),i),this._originators=t.originators,this._legends=t.legends,this._metadata=t.metadata,this._title=t.title,this._description=t.description,this._quicklookUrl=t.quicklookUrl,this._geoportal_id=0},onAdd:function(e){p.trace("onAdd layer",this._geoportal_id),this._map=e,this._geoportal_id=a.a.stamp(this),a.a.TileLayer.WMS.prototype.onAdd.call(this,e),this.setVisible(!0),this.updateAttributions(e),e.on({overlayremove:this._onRemoveLayer,overlayadd:this._onAddLayer,layerremove:this._onRemoveLayer,layeradd:this._onAddLayer,moveend:this._onMoveEndLayer},this)},onRemove:function(e){p.trace("onRemove layer",this._geoportal_id),this._map=e,a.a.TileLayer.prototype.onRemove.call(this,e),this.setVisible(!1),this.removeAttributions(e),e.off({overlayremove:this._onRemoveLayer,overlayadd:this._onAddLayer,layerremove:this._onRemoveLayer,layeradd:this._onAddLayer,moveend:this._onMoveEndLayer},this)},getTileUrl:function(e){var t=this._map,i=this.options.tileSize,o=e.multiplyBy(i),n=o.add([i,i]),r=this._crs.project(t.unproject(o,e.z)),s=this._crs.project(t.unproject(n,e.z)),l=this._wmsVersion>=1.3&&-1!==["EPSG:4326"].indexOf(this._crs.code)?[s.y,r.x,r.y,s.x].join(","):[r.x,s.y,s.x,r.y].join(","),p=a.a.Util.template(this._url,{s:this._getSubdomain(e)});return p+a.a.Util.getParamString(this.wmsParams,p,!0)+"&BBOX="+l}});t.default=c},55:function(e,t,i){"use strict";i.r(t);var o=i(7),n=i(0),a=i.n(n),r=i(5),s=i(31),l=i(23),p=r.a.getLogger("wmts"),c=a.a.TileLayer.extend({includes:s.a,defaultWmtsParams:{service:"WMTS",request:"GetTile",version:"1.0.0",layer:"",style:"",tilematrixset:"PM",format:"image/jpeg"},initialize:function(e,t){p.log("initialize"),this._wmtsParams={},a.a.Util.extend(this._wmtsParams,this.defaultWmtsParams,t.paramsWmts),a.a.TileLayer.prototype.initialize.call(this,o.a.normalyzeUrl(e,{"gp-leaflet-ext":l.leafletExtVersion||l.version},!1),t.paramsNative),this._originators=t.originators,this._legends=t.legends,this._metadata=t.metadata,this._title=t.title,this._description=t.description,this._quicklookUrl=t.quicklookUrl,this._geoportal_id=0},onAdd:function(e){p.trace("onAdd layer",this._geoportal_id),this._map=e,this._geoportal_id=a.a.stamp(this),a.a.TileLayer.prototype.onAdd.call(this,e),this.setVisible(!0),this.updateAttributions(e),e.on({overlayremove:this._onRemoveLayer,overlayadd:this._onAddLayer,layerremove:this._onRemoveLayer,layeradd:this._onAddLayer,moveend:this._onMoveEndLayer},this)},onRemove:function(e){p.trace("onRemove layer",this._geoportal_id),this._map=e,a.a.TileLayer.prototype.onRemove.call(this,e),this.setVisible(!1),this.removeAttributions(e),e.off({overlayremove:this._onRemoveLayer,overlayadd:this._onAddLayer,layerremove:this._onRemoveLayer,layeradd:this._onAddLayer,moveend:this._onMoveEndLayer},this)},getTileUrl:function(e){var t=this._getZoomForUrl(),i=a.a.Util.template(this._url,{s:this._getSubdomain(e)});return i+a.a.Util.getParamString(this._wmtsParams,i)+"&tilematrix="+t+"&tilerow="+e.y+"&tilecol="+e.x},setParams:function(e,t){return a.a.extend(this._wmtsParams,e),t||this.redraw(),this}});t.default=c},6:function(e,t,i){var o,n;!function(a,r){"use strict";void 0===(n="function"==typeof(o=function(){var e=function(){},t="undefined"!=typeof window&&void 0!==window.navigator&&/Trident\/|MSIE /.test(window.navigator.userAgent),i=["trace","debug","info","warn","error"];function o(e,t){var i=e[t];if("function"==typeof i.bind)return i.bind(e);try{return Function.prototype.bind.call(i,e)}catch(t){return function(){return Function.prototype.apply.apply(i,[e,arguments])}}}function n(){console.log&&(console.log.apply?console.log.apply(console,arguments):Function.prototype.apply.apply(console.log,[console,arguments])),console.trace&&console.trace()}function a(i){return"debug"===i&&(i="log"),"undefined"!=typeof console&&("trace"===i&&t?n:void 0!==console[i]?o(console,i):void 0!==console.log?o(console,"log"):e)}function r(t,o){for(var n=0;n<i.length;n++){var a=i[n];this[a]=n<t?e:this.methodFactory(a,t,o)}this.log=this.debug}function s(e,t,i){return function(){"undefined"!=typeof console&&(r.call(this,t,i),this[e].apply(this,arguments))}}function l(e,t,i){return a(e)||s.apply(this,arguments)}function p(e,t,o){var n,a=this;t=null==t?"WARN":t;var s="loglevel";function p(){var e;if("undefined"!=typeof window&&s){try{e=window.localStorage[s]}catch(e){}if(void 0===e)try{var t=window.document.cookie,i=t.indexOf(encodeURIComponent(s)+"=");-1!==i&&(e=/^([^;]+)/.exec(t.slice(i))[1])}catch(e){}return void 0===a.levels[e]&&(e=void 0),e}}"string"==typeof e?s+=":"+e:"symbol"==typeof e&&(s=void 0),a.name=e,a.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},a.methodFactory=o||l,a.getLevel=function(){return n},a.setLevel=function(t,o){if("string"==typeof t&&void 0!==a.levels[t.toUpperCase()]&&(t=a.levels[t.toUpperCase()]),!("number"==typeof t&&t>=0&&t<=a.levels.SILENT))throw"log.setLevel() called with invalid level: "+t;if(n=t,!1!==o&&function(e){var t=(i[e]||"silent").toUpperCase();if("undefined"!=typeof window&&s){try{return void(window.localStorage[s]=t)}catch(e){}try{window.document.cookie=encodeURIComponent(s)+"="+t+";"}catch(e){}}}(t),r.call(a,t,e),"undefined"==typeof console&&t<a.levels.SILENT)return"No console available for logging"},a.setDefaultLevel=function(e){t=e,p()||a.setLevel(e,!1)},a.resetLevel=function(){a.setLevel(t,!1),function(){if("undefined"!=typeof window&&s){try{return void window.localStorage.removeItem(s)}catch(e){}try{window.document.cookie=encodeURIComponent(s)+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC"}catch(e){}}}()},a.enableAll=function(e){a.setLevel(a.levels.TRACE,e)},a.disableAll=function(e){a.setLevel(a.levels.SILENT,e)};var c=p();null==c&&(c=t),a.setLevel(c,!1)}var c=new p,d={};c.getLogger=function(e){if("symbol"!=typeof e&&"string"!=typeof e||""===e)throw new TypeError("You must supply a name when creating a logger.");var t=d[e];return t||(t=d[e]=new p(e,c.getLevel(),c.methodFactory)),t};var u="undefined"!=typeof window?window.log:void 0;return c.noConflict=function(){return"undefined"!=typeof window&&window.log===c&&(window.log=u),c},c.getLoggers=function(){return d},c.default=c,c})?o.call(t,i,t,e):o)||(e.exports=n)}()},7:function(e,t,i){"use strict";var o={normalyzeParameters:function(e){var t=null;if(e){var i=[];for(var o in e)if(e.hasOwnProperty(o)){var n=e[o];n||(n=""),i.push(o+"="+n)}t=i.join("&")}return t},normalyzeUrl:function(e,t,i){var o=e;if(e){var n=e.indexOf("?");-1===n&&(o+="?"),-1!==n&&n!==e.length-1&&(o+="&")}return t&&(o+="string"==typeof t?t:this.normalyzeParameters(t)),i&&(o=encodeURIComponent(o)),o},indent:function(e,t){return new Array((e||0)+1).join("\t")+t}};t.a=o},76:function(e,t,i){"use strict";i.r(t);var o=i(0),n=i.n(o),a=i(5),r=i(8),s=i(30),l=a.a.getLogger("layer-config"),p={get:function(e){var t={};if(r.a.isConfigLoaded()){if((t=r.a.getLayerParams(e.layer,e.service,e.key))&&0!==Object.keys(t).length)return t.minZoom=s.a.getZoomLevelFromScaleDenominator(t.maxScale)||1,t.maxZoom=s.a.getZoomLevelFromScaleDenominator(t.minScale)||21,t;l.warn("WARNING AUTOCONF_FAILED : params not found ?!")}else l.warn("WARNING AUTOCONF_MISSING : contract key configuration has to be loaded to load Geoportal layers !")}},c=i(54),d=i(55),u=a.a.getLogger("layers"),m={options:{},params:{},protocol:null,serviceUrl:"http://localhost?no-rights-found-for=[{layer}]",_initOptions:function(){if(!this.options||0===Object.keys(this.options).length)throw new Error("PARAM_MISSING : options !");if(!this.options.layer)throw new Error("PARAM_MISSING : layer !");this.options.apiKey||u.log("PARAM_MISSING : apiKey !"),void 0===this.options.ssl&&(this.options.ssl=!0)},_initContext:function(){this.protocol=!1===this.options.ssl?"http://":"https://"},_initParams:function(e){e||(e="WMTS"),this.params=p.get({key:this.options.apiKey,layer:this.options.layer,service:e}),this.params&&0!==Object.keys(this.params).length||(this.params={},this.options.apiKey||u.log("WARNING PARAM_MISSING : parameter 'apiKey' is mandatory if the contract key configuration has not been loaded !"))},WMS:function(e,t){var i=a.a.getLogger("layers-wms");this.options=e||{},this._initOptions(),this.settings=t||{},this._initContext(),this._initParams("WMS"),i.log(this.params);var o=null;o=this.params.key||this.options.apiKey?this.params.url||n.a.Util.template("https://wxs.ign.fr/{key}/geoportail/r/wms",{key:this.params.key||this.options.apiKey}):n.a.Util.template(this.serviceUrl,{layer:this.options.layer});var r={layers:this.options.layer,styles:this.params.styles||"normal",format:this.params.format||"image/jpeg",version:this.params.version||"1.3.0"},s={minZoom:this.params.minZoom||1,maxZoom:this.params.maxZoom||21};return n.a.Util.extend(r,this.settings),n.a.Util.extend(s,this.settings),new c.default(o.replace(/(http|https):\/\//,this.protocol),{paramsNative:s,paramsWms:r,originators:this.params.originators||[],legends:this.params.legends||[],metadata:this.params.metadata||[],title:this.params.title||null,description:this.params.description||null,quicklookUrl:this.params.quicklookUrl||null})},WMTS:function(e,t){var i=a.a.getLogger("layers-wmts");this.options=e||{},this._initOptions(),this.settings=t||{},this._initContext(),this._initParams("WMTS"),i.log(this.params);var o=null;o=this.params.key||this.options.apiKey?this.params.url||n.a.Util.template("https://wxs.ign.fr/{key}/geoportail/wmts",{key:this.params.key||this.options.apiKey}):n.a.Util.template(this.serviceUrl,{layer:this.options.layer});var r={layer:this.options.layer,style:this.params.styles||"normal",format:this.params.format||"image/jpeg",version:this.params.version||"1.0.0",tilematrixset:this.params.TMSLink||"PM"},s={minZoom:this.params.minZoom||1,maxZoom:this.params.maxZoom||21};return n.a.Util.extend(r,this.settings),n.a.Util.extend(s,this.settings),new d.default(o.replace(/(http|https):\/\//,this.protocol),{paramsNative:s,paramsWmts:r,originators:this.params.originators||[],legends:this.params.legends||[],metadata:this.params.metadata||[],title:this.params.title||"",description:this.params.description||"",quicklookUrl:this.params.quicklookUrl||""})}};t.default=m;window.L&&(window.L.geoportalLayer=m)},8:function(e,t,i){"use strict";(function(e){var o=i(5).a.getLogger("config"),n={configuration:null,isConfigLoaded:function(){var t="undefined"!=typeof window?window:"undefined"!=typeof self?self:void 0!==e?e:{};return!(!t.Gp||!t.Gp.Config||0===Object.keys(t.Gp.Config).length)&&(this.configuration=t.Gp.Config,!0)},getLayerId:function(e,t){var i=null;if(this.configuration){var n=this.configuration.layers;for(var a in n)if(n.hasOwnProperty(a)){var r=a.split("$");if(e===r[0]&&r[1]){var s=r[1].split(":");if(r[1].split(";")[1]===t){i=a;break}if(s[2]===t){i=a;break}}}}return i||o.error("ERROR layer id (layer name: "+e+" / service: "+t+") was not found !?"),i},getLayerParams:function(e,t,i){var n={};if(this.configuration){var a=this.getLayerId(e,t);if(a){var r=this.configuration.layers[a],s=r.apiKeys[0];if(i&&i!==s)return void o.error("ERROR different keys ("+i+" !== "+s+") !?");i=i||s,n.key=i,n.url=r.getServerUrl(i),n.version=r.getServiceParams().version,n.styles=r.getDefaultStyle(),n.format=r.getDefaultFormat(),n.projection=r.getDefaultProjection(),n.minScale=r.getMinScaleDenominator(),n.maxScale=r.getMaxScaleDenominator(),n.extent=r.getBBOX(),n.legends=r.getLegends(),n.metadata=r.getMetadata(),n.originators=r.getOriginators(),n.title=r.getTitle(),n.description=r.getDescription(),n.quicklookUrl=r.getQuicklookUrl(),r.wmtsOptions&&(n.tileMatrixSetLimits=r.wmtsOptions.tileMatrixSetLimits);var l=r.getTMSID();if(l){n.TMSLink=l;var p=this.configuration.getTMSConf(l);n.matrixOrigin=p.getTopLeftCorner(),n.nativeResolutions=p.nativeResolutions,n.matrixIds=p.matrixIds,n.tileMatrices=p.tileMatrices}}}return n},getServiceParams:function(e,t,i){var o={};if(this.configuration){var n=this.getLayerId(e,t);if(n){var a=this.configuration.layers[n],r=a.apiKeys[0];if(i){Array.isArray(i)||(i=[i]);for(var s=0;s<i.length;s++)if(i[s]===r){var l=s;break}if(void 0===l)return}var p=i[l]||r;o.key=p,o.url=a.getServerUrl(p),o.version=a.getServiceParams().version,o.extent=a.getBBOX(),o.title=a.getTitle(),o.description=a.getDescription()}}return o},getResolutions:function(){var e=[];return this.configuration&&(e=this.configuration.generalOptions.wgs84Resolutions),e},getTileMatrix:function(e){var t={};return this.configuration&&e&&(t=this.configuration.tileMatrixSets[e.toUpperCase()]),t},getGlobalConstraints:function(e){var t={};if(e){var i=this.configuration.layers[e];t.projection=i.getDefaultProjection(),t.minScale=i.getMinScaleDenominator(),t.maxScale=i.getMaxScaleDenominator(),t.extent=i.getBBOX()}return t}};t.a=n}).call(this,i(15))}}).default;