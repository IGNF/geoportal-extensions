{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap 452a9316dedb75bbe8cb","webpack:///./src/Common/Utils.js","webpack:///external {\"commonjs\":\"openlayers\",\"commonjs2\":\"openlayers\",\"amd\":\"ol\",\"root\":\"ol\"}","webpack:///./src/Common/Utils/SelectorID.js","webpack:///./src/Common/Utils/LoggerByDefault.js","webpack:///./node_modules/geoportal-access-lib/dist/GpServices-src.js","webpack:///./src/Common/Utils/LayerUtils.js","webpack:///./src/Common/Utils/CheckRightManagement.js","webpack:///./src/OpenLayers/Controls/Utils/Markers.js","webpack:///./src/Itowns/GlobeViewExtended.js","webpack:///./node_modules/proj4/dist/proj4-src.js","webpack:///./src/Common/Utils/Config.js","webpack:///./src/Itowns/Controls/Widget.js","webpack:///./src/OpenLayers/Controls/LayerSwitcher.js","webpack:///./src/OpenLayers/Controls/Measures/Measures.js","webpack:///./src/OpenLayers/Controls/MeasureToolBox.js","webpack:///external {\"commonjs2\":\"xmldom\",\"commonjs\":\"xmldom\",\"amd\":\"require\"}","webpack:///./src/Common/Utils/ProxyUtils.js","webpack:///./src/OpenLayers/GfiUtils.js","webpack:///./src/OpenLayers/Formats/KML.js","webpack:///./src/OpenLayers/Controls/Utils/Interactions.js","webpack:///./res/Common/GPdrawing.css?0fc7","webpack:///./res/Common/GPisochron.css?c10b","webpack:///./res/Common/GPmeasureAzimuth.css?fe85","webpack:///./res/Common/GPreverseGeocoding.css?69d2","webpack:///./res/Common/GPelevationPath.css?72a2","webpack:///./res/Common/GPlayerSwitcher.css?0028","webpack:///./res/Common/GPmeasureLength.css?d992","webpack:///./res/Common/GProute.css?5722","webpack:///./res/Common/GPgeneralWidget.css?b492","webpack:///./res/Common/GPlocation.css?4cec","webpack:///./res/Common/GPmeasureToolTip.css?2b21","webpack:///./res/Common/GPsearchEngine.css?8115","webpack:///./res/Common/GPgetFeatureInfo.css?4376","webpack:///./res/Common/GPmeasureArea.css?08e9","webpack:///./res/Common/GPmousePosition.css?71ce","webpack:///external {\"commonjs2\":\"itowns\",\"commonjs\":\"itowns\",\"amd\":\"itowns\",\"root\":\"itowns\"}","webpack:///./src/Common/Controls/MousePositionDOM.js","webpack:///./src/Common/Controls/LayerSwitcherDOM.js","webpack:///./node_modules/sortablejs/Sortable.js","webpack:///./src/Common/Utils/Register.js","webpack:///./src/OpenLayers/Sources/WMTS.js","webpack:///./src/OpenLayers/CRS/CRS.js","webpack:///./src/OpenLayers/Layers/SourceWMTS.js","webpack:///./src/OpenLayers/Layers/SourceWMS.js","webpack:///./src/OpenLayers/Controls/LocationSelector.js","webpack:///./src/Common/Utils/AutoLoadConfig.js","webpack:///external {\"commonjs2\":\"request\",\"commonjs\":\"request\",\"amd\":\"require\"}","webpack:///./src/Itowns/CSS.js","webpack:///./res/Itowns/GPgeneralWidgetItowns.css?0888","webpack:///./res/Itowns/Controls/Attribution/GPattributionItowns.css?9d5c","webpack:///./res/Itowns/Controls/LayerSwitcher/GPlayerSwitcherItowns.css?d427","webpack:///./res/Itowns/Controls/MiniGlobe/GPminiGlobeItowns.css?5ce7","webpack:///./res/Itowns/Controls/MousePosition/GPmousePositionItowns.css?1e43","webpack:///./res/Itowns/Controls/Scale/GPscaleItowns.css?f034","webpack:///./src/OpenLayers/CSS.js","webpack:///./res/OpenLayers/GPgeneralWidgetOpenLayers.css?b94b","webpack:///./res/OpenLayers/Controls/Attribution/GpattributionOpenLayers.css?8dbc","webpack:///./res/OpenLayers/Controls/Measures/GPmeasureAreaOpenLayers.css?7344","webpack:///./res/OpenLayers/Controls/Drawing/GPdrawingOpenLayers.css?3084","webpack:///./res/OpenLayers/Controls/Measures/GPmeasureAzimuthOpenLayers.css?f391","webpack:///./res/OpenLayers/Controls/ElevationPath/GPelevationPathOpenLayers.css?f02a","webpack:///./res/OpenLayers/Controls/Measures/GPmeasureLengthOpenLayers.css?57b8","webpack:///./res/OpenLayers/Controls/GetFeatureInfo/GPgetFeatureInfoOpenLayers.css?7697","webpack:///./res/OpenLayers/Controls/MousePosition/GPmousePositionOpenLayers.css?3e38","webpack:///./res/OpenLayers/Controls/Isochrone/GPisochronOpenLayers.css?3d70","webpack:///./res/OpenLayers/Controls/ReverseGeocoding/GPreverseGeocodingOpenLayers.css?bc34","webpack:///./res/OpenLayers/Controls/LayerImport/GPimportOpenLayers.css?9453","webpack:///./res/OpenLayers/Controls/Route/GProuteOpenLayers.css?3f16","webpack:///./res/OpenLayers/Controls/LayerSwitcher/GPlayerSwitcherOpenLayers.css?68d5","webpack:///./res/OpenLayers/Controls/SearchEngine/GPsearchEngineOpenLayers.css?b4fb","webpack:///./res/OpenLayers/Controls/LocationSelector/GPlocationOpenLayers.css?a899","webpack:///./res/OpenLayers/Controls/ToolBoxMeasure/GPtoolBoxMeasureOpenLayers.css?7be3","webpack:///./src/Itowns/GpPluginItowns.js","webpack:///./src/Itowns/Controls/MousePosition.js","webpack:///./node_modules/loglevel/lib/loglevel.js","webpack:///./src/Itowns/Controls/Utils/PositionFormater.js","webpack:///./src/Itowns/CRS/CRS.js","webpack:///./src/Itowns/Controls/LayerSwitcher.js","webpack:///./src/Itowns/Controls/Attributions.js","webpack:///./src/Common/Controls/AttributionDOM.js","webpack:///./src/Itowns/Controls/Scale.js","webpack:///./src/Common/Controls/ScaleDOM.js","webpack:///./src/Itowns/Controls/MiniGlobe.js","webpack:///./src/Common/Controls/MiniGlobeDOM.js","webpack:///./src/OpenLayers/GpPluginOpenLayers.js","webpack:///./src/OpenLayers/Layers/LayerWMTS.js","webpack:///./src/OpenLayers/Layers/LayerWMS.js","webpack:///./src/OpenLayers/Controls/GetFeatureInfo.js","webpack:///./src/Common/Controls/GetFeatureInfoDOM.js","webpack:///./src/OpenLayers/Controls/SearchEngine.js","webpack:///./src/Common/Utils/SearchEngineUtils.js","webpack:///./src/Common/Controls/SearchEngineDOM.js","webpack:///./src/OpenLayers/Controls/MousePosition.js","webpack:///./src/Common/Utils/MathUtils.js","webpack:///./src/OpenLayers/Controls/Drawing.js","webpack:///./src/Common/Controls/DrawingDOM.js","webpack:///./src/OpenLayers/Controls/Route.js","webpack:///./src/Common/Controls/LocationSelectorDOM.js","webpack:///./src/Common/Controls/RouteDOM.js","webpack:///./src/OpenLayers/Controls/Isocurve.js","webpack:///./src/Common/Controls/IsoDOM.js","webpack:///./src/OpenLayers/Controls/ReverseGeocode.js","webpack:///./src/Common/Controls/ReverseGeocodingDOM.js","webpack:///./src/OpenLayers/Controls/LayerImport.js","webpack:///./src/Common/Controls/LayerImportDOM.js","webpack:///./src/OpenLayers/Controls/GeoportalAttribution.js","webpack:///./src/OpenLayers/Controls/ElevationPath.js","webpack:///./src/Common/Controls/MeasureToolBoxDOM.js","webpack:///./src/Common/Controls/ElevationPathDOM.js","webpack:///./src/Common/Controls/ProfileElevationPathDOM.js","webpack:///./src/OpenLayers/Controls/Measures/MeasureLength.js","webpack:///./src/Common/Controls/MeasureLengthDOM.js","webpack:///./src/OpenLayers/Controls/Measures/MeasureArea.js","webpack:///./src/Common/Controls/MeasureAreaDOM.js","webpack:///./src/OpenLayers/Controls/Measures/MeasureAzimuth.js","webpack:///./src/Common/Controls/MeasureAzimuthDOM.js"],"names":["Utils","detectSupport","isDesktop","userAgent","window","navigator","toLowerCase","indexOf","assign","dest","source","prop","hasOwnProperty","mergeParams","param","SelectorID","generate","timestamp","Math","floor","Date","now","name","id","i","lastIndexOf","substring","index","uuid","parseInt","Log","LoggerByDefault","getLogger","__PRODUCTION__","disableAll","enableAll","logname","LayerUtils","getZoomLevelFromScaleDenominator","scaleDenominator","crs","resolutionsNatives","resolution","getAttributions","params","zoom","attributions","originators","visibility","drawLogo","j","jl","length","originator","constraints","k","kl","constraint","minZoomLevel","maxScaleDenominator","maxZoomLevel","minScaleDenominator","bbox","viewExtent","extent","bounds","top","left","bottom","right","intersects","logo","url","text","attribution","container","document","createElement","className","link","target","appendChild","href","bImage","image","src","title","style","height","width","textContent","push","innerHTML","extent1","extent2","intersectsX","intersectsY","check","options","logger","error","_key","key","_resources","resources","_services","services","_rightManagement","isConfigLoaded","console","log","Object","keys","configuration","generalOptions","apiKeys","_noRightManagement","service","resource","_resource","l","_service","getServiceParams","Marker","lightOrange","darkOrange","red","turquoiseBlue","defaultOffset","GlobeViewExtended","viewerDiv","coordCarto","position","scope","_itowns","itowns","_viewerDiv","_widgets","_initEventMap","_isInitialized","_globeView","GlobeView","self","listen","EVENTS","GLOBE_INITIALIZED","addFrameRequester","MAIN_LOOP_EVENTS","BEFORE_RENDER","clearTimeout","_preRenderTimer","setTimeout","_fetchVisibleColorLayers","_fetchVisibleElevationLayers","_fetchExtent","event","type","PRE_RENDER","Extent","colorLayersId","elevationLayersId","_getCurrentSceneInfos","scene","dispatchEvent","bind","freezeControl","prototype","RANGE_CHANGED","CONTROL_EVENTS","CENTER_CHANGED","CAMERA_TARGET_CHANGED","ORIENTATION_CHANGED","LAYER_ADDED","GLOBE_VIEW_EVENTS","LAYER_REMOVED","LAYERS_ORDER_CHANGED","COLOR_LAYERS_ORDER_CHANGED","VIEW_INITIALIZED","MOUSE_MOVE","AFTER_RENDER","OPACITY_PROPERTY_CHANGED","VISIBLE_PROPERTY_CHANGED","SEQUENCE_PROPERTY_CHANGED","constructor","getGlobeView","isInitialized","controls","enabled","afterRenderHandlerFunction","afterRenderHandler","mainLoop","scheduler","commandsWaitingExecutionCount","_changeSources","size","removeFrameRequester","callback","_getEventTarget","addEventListener","addLayerListener","layer","forgetByKey","removeEventListener","removeLayerListener","forget","addLayer","notifyChange","removeLayer","layerId","setLayerOpacity","opacityValue","getColorLayerById","opacity","setLayerVisibility","visible","moveLayerToIndex","ColorLayersOrdering","preRenderEventFetchViewExtent","b","preRenderEventFetchColorLayersDisplayed","preRenderEventFetchElevationLayersDisplayed","preRenderEventFetchLayersDisplayed","getLayerById","getLayers","trace","getColorLayers","getVectorLayers","protocol","getElevationLayers","getExtent","node","level","material","union","children","child","addWidget","widget","getTarget","setTarget","setGlobe","getWidgets","removeWidget","idx","splice","getTargetElement","getScale","setTilt","tilt","getTilt","getCameraOrientation","setAzimuth","azimuth","setHeading","getAzimuth","getCoordinateFromPixel","x","y","pickGeoPosition","getCoordinateFromMouseEvent","mouseEvent","coords","eventToViewCoords","getFeaturesAtMousePosition","vectorLayers","visibleFeatures","geoCoord","precision","pixelsToDegrees","result","FeaturesUtils","filterFeaturesUnderCoordinate","feature","setCameraTargetGeoPosition","center","setCameraTargetGeoPositionAdvanced","getCenter","cameraCenter","getCameraTargetGeoPosition","lon","longitude","lat","latitude","alt","altitude","getZoom","setZoom","pixelsToMeters","pixels","metersToPixels","value","getRange","moveTarget","getLayerEventInfos","evt","propertyName","replace","previousValue","previous","newValue","new","Config","Gp","getLayerId","layerName","layers","parts","split","servicePartsLayer","servicePartsService","getLayerParams","apiKey","layerConf","getServerUrl","version","styles","getDefaultStyle","format","getDefaultFormat","projection","getDefaultProjection","minScale","getMinScaleDenominator","maxScale","getMaxScaleDenominator","getBBOX","legends","getLegends","metadata","getMetadata","getOriginators","getTitle","description","getDescription","quicklookUrl","getQuicklookUrl","wmtsOptions","tileMatrixSetLimits","TMSLink","getTMSID","tmsConf","getTMSConf","matrixOrigin","getTopLeftCorner","nativeResolutions","matrixIds","tileMatrices","getResolutions","resolutions","getTileMatrix","tmsName","tms","toUpperCase","getGlobalConstraints","Widget","_element","_target","_globe","setOptions","getElement","targetDiv","removeChild","element","getGlobe","globe","LayerSwitcher","lsOptions","TypeError","Array","isArray","Error","_initialize","_initContainer","control","Control","call","render","inherits","create","setMap","map","_addMapLayers","_listeners","onMoveListener","on","_onMapMoveEnd","onAddListener","_layerId","gpLayerId","_layers","onRemoveListener","Observable","unByKey","_layersOrder","setZIndex","config","getMap","isLayerInMap","forEach","lyr","layerInfos","getLayerInfo","getOpacity","getVisible","isInRange","layerOptions","inRange","_title","_description","_legends","_metadata","_quicklookUrl","layerDiv","_createLayerDiv","div","getZIndex","_forceNullzIndex","_updateLayersOrder","unshift","_lastZIndex","_layerListContainer","insertBefore","firstChild","_updateLayerOpacity","_updateLayerVisibility","context","updateLayersOrder","e","onZIndexChangeEvent","nameDiv","getElementById","_addUID","infodiv","advancedTools","_createAdvancedToolInformationElement","layerID","layerList","layerIndex","abs","layerOrderTemp","setCollapsed","collapsed","undefined","isCollapsed","checked","getElementsByClassName","getCollapsed","setRemovable","removable","removalDiv","display","_uid","_layersIndex","conf","_createMainContainerElement","input","_createMainLayersShowElement","changeCollapsed","divL","_createMainLayersElement","_createDraggableElement","picto","_createMainPictoElement","divI","_createMainInfoElement","zindex","isLegends","isMetadata","isQuicklookUrl","displayInformationElement","_createContainerLayerElement","classList","add","_onChangeLayerOpacity","divId","opacityId","setOpacity","layerOpacityInput","round","layerOpacitySpan","_onVisibilityLayerClick","setVisible","layerVisibilityInput","_onOpenLayerInfoClick","panel","info","remove","obj","maxResolution","getMaxResolution","Infinity","_maxScaleDenominator","infoLayer","_createContainerLayerInfoElement","_onDropLayerClick","_onDragAndDropLayerClick","matchesLayers","querySelectorAll","maxZIndex","tag","updateSize","getLayerDOMId","olLayer","foundId","mapResolution","getView","getResolution","getMinResolution","mapExtent","calculateExtent","getSize","layerExtent","layerInfo","getSource","Measures","DEFAULT_POINTER_STYLE","Circle","radius","stroke","Stroke","color","fill","Fill","DEFAULT_DRAW_START_STYLE","Style","lineDash","DEFAULT_DRAW_FINISH_STYLE","tools","MeasureLength","active","instance","MeasureArea","MeasureAzimuth","measureDraw","measureSource","measureVector","sketch","measureTooltipElement","measureTooltip","helpTooltipElement","helpTooltip","clean","_class","CLASSNAME","clearMeasure","clearMeasureToolTip","removeMeasureEvents","_showContainer","onPointerMoveHandler","dragging","tooltipCoord","coordinate","output","geom","getGeometry","getType","getLastCoordinate","getInteriorPoint","getCoordinates","setPosition","onShowMeasureClick","o","unset","current","addMeasureEvents","initMeasureInteraction","addMeasureInteraction","mapContainer","overlays","nodes","len","nodesToRemove","removeInteraction","createMeasureTooltip","parentNode","Overlay","offset","positioning","addOverlay","createHelpTooltip","createStylingMeasureInteraction","start","startStyleOpts","getFill","getStroke","pointer","Image","finish","finishStyleOpts","interaction","Draw","condition","originalEvent","ctrlKey","removeLastPoint","setProperties","addInteraction","setOffset","Vector","gpResultLayerId","MeasureToolBox","_toolbox","ctrl","mapDocument","ownerDocument","mapId","uid","getToolBoxID","toolboxContainer","_createToolBoxContainerElement","overlaysContainer","widgetContainer","getWidgetID","ProxyUtils","proxifyUrl","proxyOptions","proxyUrl","trim","noProxyDomains","encodeURIComponent","GfiUtils","getLayerFormat","TileWMS","ImageWMS","WMTS","displayInfo","content","contentType","autoPanOptions","_htmlDoc","_parser","_content","exports","DOMParser","require","parseFromString","ActiveXObject","async","loadXML","body","getElementsByTagName","hasChildNodes","closer","onclick","featuresOverlay","removeOverlay","contentDiv","autoPan","autoPanAnimation","autoPanMargin","insertFirst","stopEvent","features2html","features","f","props","getProperties","insertAdjacentHTML","descDiv","p","others","oDiv","ul","li","span","createTextNode","layerGetFeatureAtCoordinates","olCoordinate","pixel","getPixelFromCoordinate","hasFeatureAtPixel","displayVectorFeatureInfo","olLayers","forEachFeatureAtPixel","displayFeatureInfo","gfiLayers","layersOrdered","requests","positions","sort","a","foundFeature","h","infoFormat","minMaxResolutionOk","minResolution","_res","_url","getGetFeatureInfoUrl","getProjection","INFOFORMAT","INFO_FORMAT","vectorLayersOrdered","requestsSync","list","iterator","nextItemIndex","report","displayed","data","m","n","Protocols","XHR","method","onResponse","resp","exception","onFailure","getPosition","offsetX","offsetY","pointerType","pointers","pageX","pageY","onDisplayFeatureInfo","gfiObj","isActive","preventDefault","interactions","getInteractions","getArray","getActive","Select","Modify","_proxyUrl","_noProxyDomains","_autoPan","_autoPanAnimation","_autoPanMargin","eventLayers","_defaultEvent","ind","_defaultInfoFormat","KML","_kmlFormattedToString","xml","reg","wsexp","contexp","formatted","lines","indent","lastType","transitions","ln","single","Boolean","match","closing","opening","fromTo","padding","substr","_kmlParse","kmlString","kmlDoc","parser","_kmlToString","oSerializer","XMLSerializer","kmlStringExtended","serializeToString","_kmlRead","process","root","documentElement","firstNodeLevel","childNodes","nodeName","stylesUrl","attributes","_k","nodeValue","_v","types","point","extend","_idStyle","slice","fctExtend","extendedData","fctName","nameData","labelStyle","iconStyle","labelName","labelDescription","fctLabel","fctIcon","fctIconLabel","iconLabelStyle","writeFeatures","_writeExtendStylesFeatures","__createExtensionStyleLabel","__convertRGBColorsToKML","strColor","toString","charAt","getStyle","fTextStyle","getText","_haloColor","getColor","_haloRadius","getWidth","_haloOpacity","_font","labelextend","setAttribute","__createHotSpotStyleIcon","fImageStyle","getImage","xunits","yunits","anchor","getAnchor","hotspot","__createStyleToFeatureIconLabel","__setNameData","tags","kmlStringFormatted","readFeatures","_readExtendStylesFeatures","outerHTML","__getExtensionStyleToFeatureLabel","__convertKMLColorsToRGB","hex","comp","_text","_color","_colorHalo","_radiusHalo","_fontSize","bLabelStyleSimpleExtensionGroup","attributs","setStyle","Icon","anchorOrigin","anchorXUnits","anchorYUnits","Text","font","textAlign","__getHotSpotStyleToFeatureIcon","_src","_scale","_bSizeIcon","_sizeW","_sizeH","_bHotSpot","_anchorX","_anchorXUnits","_anchorY","_anchorYUnits","parseFloat","_options","crossOrigin","scale","featureStyleFunction","getStyleFunction","_styles","_style","__getExtendedData","_fname","_fdescription","_ftitle","__getStyleToFeatureIconLabel","showPointNames","Interactions","_extensions","opts","setActive","action","args","apply","MousePositionDOM","_createShowMousePositionElement","_createShowMousePositionPictoElement","label","htmlFor","mapCenterClass","onShowMousePositionClick","spanOpen","_createMousePositionPanelElement","displayAltitude","displayCoordinates","editCoordinates","currentProjectionUnits","_createMousePositionPanelHeaderElement","_createMousePositionPanelBasicElement","arraySettings","_createShowMousePositionSettingsElement","_createMapCenter","divTitle","divClose","click","attachEvent","_createMousePositionPanelBasicCoordinateElement","_createMousePositionPanelEditToolsElement","_createMousePositionPanelBasicAltitudeElement","_createCoordinateElement","coordType","readOnly","onMousePositionEditModeClick","valid","validateExtentCoordinate","_createDMSCoordinateElement","dataset","min","max","_checkDMSDegrees","input1","_checkDMSElement","span1","input2","span2","select","disabled","option","option1","divLat","spanLat","arrayCoords","divLon","spanLon","arrayCoords1","spanLabel","spanAlt","spanUnits","onMousePositionEditModeLocateClick","_createMousePositionSettingsElement","_createMousePositionSettingsSystemsElement","systems","selectSystem","onMousePositionProjectionSystemChange","onMousePositionProjectionSystemMouseOver","code","_createMousePositionSettingsUnitsElement","units","selectUnits","onMousePositionProjectionUnitsChange","_resetLabelElements","currentProjectionType","_resetUnitElements","elts","_resetCoordinateElements","latElt","lonElt","onMapMove","_setEditMode","editing","locateElt","closeEditElt","selector","inputs","selects","isFloat","isNaN","v","Number","inputMinutes","inputSeconds","GPdisplayCoords","labelLon","labelLat","lng","u","elt","direction","elLat","elLon","unit","elements","GPdisplayElevation","altitudeTimeoutDelay","noDataValue","noDataValueTolerance","altitudeTimeout","maxThreshold","minThreshold","onRequestAltitude","z","GPresetElevation","LayerSwitcherDOM","elementDraggable","handle","draggable","ghostClass","animation","onEnd","spanClose","_createBasicToolElement","array","_createAdvancedToolShowElement","_createAdvancedToolElement","_createBasicToolNameElement","_createBasicToolVisibilityElement","_createAdvancedToolDeleteElement","_createAdvancedToolOpacityElement","divO","divC","quick","refquick","close","onCloseClick","desc","mtd","mtdtitle","urlmtd","mtdlink","refmtd","lgd","lgdtitle","s","pow","urllgd","lgdlink","reflgd","Register","isLoaded","get","register","load","registers","codes","defs","EPSG","CRS","IGNF","AMST63","CROZ63","CSG67","ED50","ETRS89","GUAD48","GUADFM49","IGN63","IGN72","KERG62CAR","MART38","MAYO50","MOOREA87","NTF","NUKU72","REUN47","RGF93","RGFG95","RGM04","RGNC","RGPF","RGR92","RGSPM06","RGTAAF07","RRAF91","STPL69","STPM50","TAHAA","TAHI79","TERA50","WALL78","WGS72","WGS84","AMST63GEO","CROZ63GEO","CSG67GEO","ED50G","GUAD48GEO","GUADFM49GEO","IGN63GEO","IGN72GEO","KERG62GEO","MART38GEO","MAYO50GEO","MOOREA87GEO","NTFG","NTFP","NUKU72GEO","REUN47GEO","RGF93G","RGFG95GEO","RGM04GEO","RGNCGEO","RGPFGEO","RGR92GEO","RGSPM06GEO","RGTAAF07G","STPL69GEO","STPM50GEO","TAHAAGEO","TAHI79GEO","TERA50G","WALL78GEO","WGS72G","WGS84G","WGS84RRAFGEO","XGEO","AMST63UTM43S","CROZ63UTM39S","CSG67UTM21","CSG67UTM22","GEOPORTALANF","GEOPORTALASP","GEOPORTALCRZ","GEOPORTALFXX","GEOPORTALGUF","GEOPORTALKER","GEOPORTALMYT","GEOPORTALNCL","GEOPORTALPYF","GEOPORTALREU","GEOPORTALSPM","GEOPORTALWLF","GUAD48UTM20","GUADFM49U20","IGN63UTM7S","IGN72UTM58S","KERG62UTM42S","LAMB1","LAMB1C","LAMB2","LAMB2C","LAMB3","LAMB3C","LAMB4","LAMB4C","LAMB93","RGF93CC42","RGF93CC43","RGF93CC44","RGF93CC45","RGF93CC46","RGF93CC47","RGF93CC48","RGF93CC49","RGF93CC50","LAMBE","MART38UTM20","MAYO50UTM38S","MILLER","MOOREA87U6S","NUKU72U7S","REUN47GAUSSL","RGM04UTM38S","RGNCUTM57S","RGNCUTM58S","RGNCUTM59S","RGPFUTM5S","RGPFUTM6S","RGPFUTM7S","RGR92UTM40S","RGSPM06U21","STPL69UTM43S","STPM50UTM21","TAHAAUTM05S","TAHI51UTM06S","TAHI79UTM6S","TERA50STEREO","UTM01SW84","UTM20W84GUAD","UTM20W84MART","UTM22RGFG95","UTM39SW84","UTM42SW84","UTM43SW84","WALL78UTM1S","ETRS89GEO","ETRS89LAEA","ETRS89LCC","UTM26ETRS89","UTM27ETRS89","UTM28ETRS89","UTM29ETRS89","UTM30ETRS89","UTM31ETRS89","UTM32ETRS89","UTM33ETRS89","UTM34ETRS89","UTM35ETRS89","UTM36ETRS89","UTM37ETRS89","UTM38ETRS89","pixelRatio","tilePixelRatio","tileGrid","tileCoord","getTileCoordForCoordAndResolution","getTransformedTileCoord","tmpTileCoord","tmpExtent","createEmpty","tileExtent","getTileCoordExtent","projectionExtent","isGlobal","numCols","ceil","transformedTileCoord","tileResolution","tileMatrix","getMatrixIds","baseParams","SERVICE","VERSION","REQUEST","LAYER","getLayer","TILECOL","TILEROW","TILEMATRIX","TILEMATRIXSET","getMatrixSet","FORMAT","getFormat","STYLE","urls","featureInfoUrl","Helper","normalyzeUrl","proj","proj4_","setProj4","overloadTransformExtent","transformExtent","destination","transformFn","getTransform","transformedExtent","applyTransform","overload","SourceWMTS","ssl","getLayerConf","wmtsParams","ctx","location","_originators","wmtsSourceOptions","maxZoom","matrixSet","tilegrid","origin","olParams","SourceWMS","wmsParams","wmsSourceOptions","LAYERS","STYLES","LocationSelector","initialize","_container","groupId","addOption","removeOption","autocompleteOptions","_map","_inputsContainer","_inputLabelContainer","_inputAutoCompleteContainer","_inputShowPointerContainer","_inputShowPointer","_inputCoordinateContainer","_addPointElement","_removePointElement","_coordinate","_suggestedContainer","_suggestedLocations","_currentLocation","_initMarker","_checkRightsManagement","_marker","_markerUrl","_markerOffset","markerOpts","getCoordinate","clear","_clearResults","_opts","filterOptions","rightManagement","_createLocationPointElement","_inputLabel","_createLocationPointLabelElement","_inputAutoComplete","_createLocationAutoCompleteteInputElement","onAutoCompleteInputClick","_inputCoordinate","_createLocationCoordinateInputElement","_createLocationPointerShowInputElement","_inputPointer","_createLocationPointerInputElement","_inputAddStage","_createLocationAddPointElement","_inputRemoveStage","_createLocationRemovePointElement","results","_createLocationAutoCompleteResultElement","_displaySuggestedLocation","onAutoCompleteSearchText","_clearSuggestedLocation","_requestAutoComplete","maximumResponses","onSuccess","locations","suggestedLocations","_fillAutoCompletedLocationListContainer","message","_hideSuggestedLocation","onAutoCompletedResultsItemClick","fields","fullText","_setLabel","view","mapProj","getCode","transform","_setPosition","_setMarker","onActivateMapPointClick","onMouseMapClick","_setCursor","un","onLocationClearPointClick","onLocationRemovePointClick","onLocationAddPointClick","_setCoordinate","cursor","toFixed","GPdisplayCoordinate","setCenter","information","markerDiv","settings","Services","autoComplete","childElementCount","_createLocationAutoCompletedLocationElement","scripts","getAttribute","splitKeys","timeout","success","serverUrl","callbackSuffix","timeOut","getConfig","Itowns","MousePosition","Attributions","Scale","MiniGlobe","deepCopy","_callbacks","_centerElement","mouseMove","onMouseMove","_isDesktop","onGlobeMove","lastChild","addSystem","system","warn","_projectionSystems","addSystems","removeSystem","systemCrs","systemCode","oldNewCodeGlobe","ii","indexChildToRemove","systemList","_currentProjectionSystems","_setCurrentSystem","setUnits","_projectionUnits","_initProjectionUnits","_currentProjectionType","_setTypeUnitsPanel","setAltitudeOptions","triggerDelay","responseDelay","serviceOptions","opt","_setElevationPanel","_setCoordinatesPanel","_setSettingsPanel","_showMousePositionContainer","_initProjectionSystems","_timer","_currentProjectionUnits","_projectionUnitsContainer","projectionSystemsByDefault","geoBBox","sys","projectionUnitsByDefault","Geographical","convert","_displayDEC","_displayDMS","_displayRAD","_displayGON","Metric","_displayMeter","_displayKMeter","found","inputShow","_projectionSystemsContainer","divPicto","divPanel","roundToDecimal","decimalLatToDMS","decimalLongToDMS","decimalToRadian","decimalToGrade","coord","coordinates","oSrs","crsProp","_setElevation","delay","onMoveStopped","zonly","rawResponse","elevations","getAltitude","selectedIndex","globeExtent","west","south","east","north","PositionFormater","NORTH","SOUTH","EAST","WEST","digitSecond","digitDecimal","digitRadian","inputNum","numPoints","multiplier","d","decimalToDMS","hemisphere","degrees","minutesFromRemainder","minutes","secondsFromRemainder","seconds","dms","DMSToDecimal","ddVal","decimal","_addedLayerConf","_initLayers","ipr","_addGlobeLayers","onOpacityLayerCallBack","onVisibilityLayerCallBack","onChangedViewCallBack","_inRangeUpdate","onAddedLayerCallBack","_layerDisplayedInLayerSwitcher","_getLayerConf","onRemovedLayerCallBack","onIndexLayerCallBack","arraysEquals","a1","a2","sequence","_updateLayerListContainer","LayerInGlobe","_getLayerInfo","elementLayersList","orderedLayers","lsLayerConf","_resolveLayerId","newIndex","oldIndex","targetIndex","layerTargetID","from","item","layersDisplayed","layerKey","bInRange","divName","aOptions","onPreRenderCallBack","allLayers","concat","_AttributionContainer","_createMainAttributionsShowElement","divA","_attributionListContainer","_createMainAttributionsListContainer","ulA","_createAttributionsList","Map","ori","has","set","attributionZoomLevel","maxAttributionScaleDenominator","_resolutionsWGS84","minAttributionScaleDenominator","_updateAttributionListContainer","AttributionDOM","vDiv","onChangedViewCallback","digit","pix","_ScaleContainer","ScaleDOM","minDistance","maxDistance","positionOnGlobe","miniView","maxSubdivisionLevel","noControls","gfxEngine","renderer","setClearColor","updateMiniGlobeHandler","range","distance","camera","camera3D","copy","setLength","lookAt","miniGlobeLayer","_baseLayer","_globeObj","_MiniGlobeContainer","updateStrategy","networkOptions","mimetype","tileMatrixSet","minTileRow","maxTileRow","minTileCol","maxTileCol","MiniGlobeDOM","ol3extVersion","ol3extDate","olUtils","gp","KMLExtended","WMTSExtended","GeoportalWMTS","GeoportalWMS","GeoportalAttribution","GetFeatureInfo","SearchEngine","Route","Isocurve","GeoportalMousePosition","Drawing","ReverseGeocode","LayerImport","DefaultMarkers","ElevationPath","LayerWMTS","olSourceParams","sourceParams","wmtsSource","layerTileOptions","globalConstraints","getUnits","PI","Tile","LayerWMS","wmsSource","getParams","geobbox","gfiOptions","_events","dblclick","singleclick","contextmenu","_eventsHandler","auto","_auto","_active","defaultEvent","_isValidEvent","defaultInfoFormat","cursorStyle","_cursorStyle","duration","easing","_setLayers","_activateGetFeatureInfoContainer","_updateEvents","_activateCursor","updated","layerFormat","_hasLayer","_clearEvents","setDefaultEvent","eventName","setCursorStyle","_setActive","setHidden","hidden","isHidden","setLayers","_activateEvent","getFeatureInfoHandler","getViewport","_deactivateEvent","sEvent","activate","displayCursor","hit","onActivateGetFeatureInfoElementChange","inputActivate","_createActivateGetFeatureInfoElement","GetFeatureInfoDOM","_containerElement","_showSearchEngineInput","_checkInputOptions","zoomTo","geocode","autocomplete","displayAdvancedSearch","advancedSearch","geocodeOptions","triggerGeocode","displayMarker","markerStyle","placeholder","_inputSearchContainer","_autocompleteContainer","_geocodedContainer","_geocodedLocations","_filterContainer","_currentGeocodingCode","_currentGeocodingLocation","_advancedSearchFilters","_initAdvancedSearchFilters","_advancedSearchCodes","_initAdvancedSearchCodes","_markerStyle","_displayMarker","_popupContent","_popupDiv","_initPopupDiv","_popupOverlay","_servicesRightManagement","_triggerHandler","geocodeResources","geocodeResourcesList","autocompleteResources","autocompleteResourcesList","advancedSearchFiltersByDefault","advancedSearchFiltersCustom","_createShowSearchEngineElement","_createShowSearchEnginePictoElement","search","_createSearchInputElement","advancedShow","_createShowAdvancedSearchElement","advancedPanel","_createAdvancedSearchPanelElement","advancedHeader","_createAdvancedSearchPanelHeaderElement","advancedForm","_createAdvancedSearchPanelFormElement","advancedFormFilters","_createAdvancedSearchFormFiltersElement","_setFilter","advancedFormInput","_createAdvancedSearchFormInputElement","_createAutoCompleteElement","autocompleteList","_createAutoCompleteListElement","_createGeocodeResultsElement","geocodeList","_createGeocodeResultsListElement","codeFound","lstAttributs","divTable","_createAdvancedSearchFiltersTableElement","divFilter","_createAdvancedSearchFiltersAttributElement","rightManagementAutoComplete","rightManagementGeocode","_createAutoCompletedLocationElement","_requestGeocoding","returnFreeForm","_fillGeocodedLocationListContainer","_clearGeocodedLocation","_createGeocodedLocationElement","_onResultMarkerSelect","_getZoom","zoomToResultsByDefault","isInteger","isFinite","minZoom","popupContent","attr","onShowSearchEngineClick","onSearchResetClick","inputSearchTextContainer","_triggerGeocode","_triggerDelay","_locationsToBeDisplayed","ilocation","_getGeocodeCoordinatesFromFullText","placeAttributes","freeform","suggestedLocation","response","onGeocodingSearchSubmit","onGeocodedResultsItemClick","postalCode","commune","cadastralParcel","onGeocodingAdvancedSearchCodeChange","onGeocodingAdvancedSearchSubmit","_location","_filterOptions","filter","_getCadastralParcelRequestParams","dep","department","insee","absorbedCity","section","number","SearchEngineUtils","PositionOfInterest","StreetAddress","CadastralParcel","Administratif","importance","classification","SearchEngineDOM","showAdvancedSearch","querySelector","form","charCode","which","keyCode","curr","next","prev","focus","_createGeocodeResultsHeaderElement","advancedSearchCodes","matchesFilters","_createAdvancedSearchFormCodeElement","filterAttributes","places","_markerOverlay","oldNewCodeMap","_hideMarker","positionMarker","hide","_getCurrentProjectionInformation","systemInfo","join","projectionUnits","oLatLng","_protocol","_timeout","_zonly","_positions","_scope","_rawResponse","_onSuccess","_onFailure","_apiKey","inputDegrees","toInteger","mins","secs","toFloat","locateDMSCoordinates","lonlat","locateCoordinates","xy","xyWGS84","optionElement","oldProjectionUnits","rd","MathUtils","modulo","r","hemispheres","numDigits","normalizedDegrees","dflPrecision","deg","sec","base","_base","DefaultTools","points","polygons","tooltip","edit","export","measure","DefaultLabels","creatingTools","editingTools","exportTitle","applyToObject","saveDescription","setAsDefault","strokeColor","strokeWidth","fillColor","fillOpacity","DefaultStyles","textFillColor","textStrokeColor","textIcon1x1","polyFillColor","polyFillOpacity","polyStrokeColor","polyStrokeWidth","DefaultCursorStyle","eventKey","setLayer","evtRm","interactionCurrent","exportFeatures","getFeatures","featProj","kmlFormat","writeStyles","dataProjection","featureProjection","onShowDrawingClick","_showDrawingContainer","setExportName","_exportName","getExportName","_getsMarkersOptionsFromSrc","markerOptions","markersList","_getIconStyleOptions","markerElement","iconOptions","_exportFormat","labels","defaultStyles","intValue","interactionSelectEdit","stylingOvl","_detectSupport","_createEmptyLayer","Collection","vlayer","mapLayer","_createShowDrawingElement","_createShowDrawingPictoElement","_createDrawingPanelElement","_drawEndFeature","geomType","hexToRgba","_updateMeasure","popupOvl","setAttValue","save","formated","popup","_createLabelDiv","applyFunc","inputId","geomExtent","_createRemoveInteraction","seEv","selected","removeFeature","_createStylingInteraction","valuesColor","hexColor","initValues","Point","_label","rgbaToHex","strokeOpacity","getSrc","markerSrc","LineString","Polygon","dtObj","applyStyle","setDefault","fillColorElem","fillOpacityElem","strokeColorElem","strokeWidthElem","markerSelected","idxMarker","findIndex","mrk","popupDiv","_createStylingDiv","mapBrowserEvent","_createLabelInteraction","labelOvl","_textValue","_measure","featProps","setTextValue","setText","_formated","wgs84Sphere","Sphere","__roundDecimal","nombre","factor","coordinatesPoint","c","measureLength","coordinatesLine","c1","c2","haversineDistance","measureArea","coordinatesAera","clone","getLinearRing","geodesicArea","_handleToolClick","clickEvent","toolId","dtOptions","getFeaturesCollection","deEv","events","singleClick","deleteCondition","toolsType","toolsId","onExportFeatureClick","charset","createEvent","initEvent","DrawingDOM","_createDrawingPanelHeaderElement","_createDrawingToolSection","_createSavingSection","controlLabel","sectionLabel","panelType","liClickHandler","_handleDOMToolClick","buttonLabel","buttonTitle","button","rgba","str","regex","parsed","exec","green","blue","alpha","elems","shorthandRegex","g","rgb","_createMarkersChooser","inputElem","defaultValue","labelElem","imgElem","_createStylingElement","textNode","step","applyButton","setDefaultButton","cancelButton","inputLabel","rows","cols","onblur","onkeyup","evtk","inputMeasure","readonly","availType","availToolId","_geojsonSections","graphs","exclusions","toll","tunnel","bridge","routeOptions","defaultMarkersOpts","departure","stages","arrival","markersOpts","_waitingContainer","_formRouteContainer","_resultsRouteContainer","_showRouteExclusionsElement","_currentPoints","_currentTransport","_initTransport","_currentComputation","_initComputation","_currentExclusions","_initExclusions","_waiting","_geojsonRoute","_resultsSelectInteraction","_resultsHoverInteraction","_defaultFeatureStyle","_selectedFeatureStyle","_currentRouteInformations","rightManagementRoute","_showRouteContainer","_createShowRouteElement","_createShowRoutePictoElement","routePanel","_createRoutePanelElement","routeHeader","_createRoutePanelHeaderElement","routeForm","_createRoutePanelFormElement","_createRoutePanelFormPointsElement","choice","_createRoutePanelFormModeChoiceElement","_createRoutePanelFormModeChoiceTransportElement","_createRoutePanelFormModeChoiceComputeElement","_createShowRouteExclusionsElement","_createShowRouteExclusionsPictoElement","exclusion","_createRoutePanelFormExclusionsElement","_createRoutePanelFormExclusionOptionsElement","divReset","_createRouteFormResetElement","submit","_createRouteSubmitFormElement","routeResults","_createRoutePanelResultsElement","waiting","_createRouteWaitingElement","_hideRouteSuggestedLocations","transport","graph","routePreference","count","_addFormPointsEventListeners","end","formPoint","onRouteOriginLabelClick","onRouteOriginPointerClick","exclusionsPictoTop","onRouteComputationSubmit","startCoordinate","endPoint","endCoordinate","iCoordinate","computation","_requestRouting","startPoint","viaPoints","geometryInInstructions","distanceUnit","_fillRouteResultsDetails","_hideWaitingContainer","_clearRouteResultsDetails","routeControl","locationSelector","onShowRoutePanelClick","_clear","onRouteModeComputationChange","onRouteModeComputationChangeAndRun","_clearRouteResultsGeometry","_clearRouteResultsFeatureGeometry","onRouteModeTransportChange","onShowRouteExclusionsClick","onRouteExclusionsChange","bFound","iFound","onRouteResetClick","currentPoints","_clearRouteInputOptions","onShowRouteResultsNewClick","onRouteResultsDetailsMouseOver","tagid","getFeatureById","onRouteResultsDetailsMouseOut","_displayWaitingContainer","route","totalDistance","totalTime","instructions","_simplifiedInstructions","routeInstructions","_fillRouteResultsDetailsContainer","geometry","routeGeometry","_fillRouteResultsDetailsGeometry","_fillRouteResultsDetailsFeatureGeometry","fit","_resultsRouteValuesContainer","_addRouteResultsValuesElement","_convertSecondsToTime","_resultsRouteDetailsContainer","_addRouteResultsDetailsElement","geojsonObject","properties","geojsonformat","GeoJSON","defaultDataProjection","_convertDistance","getControls","pointerMove","_onResultsFeatureMouseOver","_onResultsFeatureSelect","selectedInstruction","getId","deselected","deselectedFeature","deSelectedInstruction","_removeRouteStepLocations","transportdiv","computationdiv","tollInput","tunnelInput","bridgeInput","stepPoints","detailsDiv","valuesDiv","pointId","newInstructions","instruction","time","hours","divisor4minutes","distanceKm","LocationSelectorDOM","cssText","labelOrigin","inputOrigin","inputOriginCoord","inputOriginPointer","labelOriginPointer","stopPropagation","divRm","last","startID","endID","divAdd","lastStage","nbStages","id1","id2","RouteDOM","resultStage","resultStageLabel","resultStageValue","elementCoords","stageCoords","modeComputation","modeTransport","exclusionsElement","el","_createRouteResultsStagesElement","_createRouteResultsElement","divBorderUp","_createRouteShowResultsDetailsElement","labelShow","labelHide","divBorderDown","_createRouteResultsDetailsElement","divValue","divMode","computes","divNew","fconvert","containerDistance","labelDistance","distanceLabel","isKm","distanceArrondi","divDistance","containerDuration","labelDuration","divDuration","distanceCumul","durationCumul","divNum","isCumulKm","divIns","onRouteResultsDetailsClick","_createRoutePanelFormPointElement","onRouteMapPointClick","_createRoutePanelFormRemoveStageElement","onRouteRemovePointClick","_createRoutePanelFormAddStageElement","onRouteAddPointClick","_createRoutePanelFormAutoCompleteListElement","_createRouteAutoCompletedLocationElement","transports","inputCar","labelCar","inputPedestrian","labelPedestrian","status","inputToll","labelToll","inputTunnel","labelTunnel","inputBridge","labelBridge","_geojsonLayer","methods","directions","isocurveOptions","_currentDirection","_initDirection","_originPoint","_showIsoContainer","_formContainer","_currentIsoResults","reverse","rightManagementIsocurve","_createShowIsoElement","_createShowIsoPictoElement","_createIsoPanelElement","header","_createIsoPanelHeaderElement","_createIsoPanelFormElement","_createIsoPanelFormPointElement","isoChronChecked","isoDistChecked","typeChoice","_createIsoPanelFormTypeChoiceElement","_createIsoPanelFormTypeChoiceChronElement","_createIsoPanelFormTypeChoiceDistElement","_createIsoPanelFormValueIsochronElement","_createIsoPanelFormValueIsodistanceElement","modeChoice","_createIsoPanelFormModeChoiceElement","_createIsoPanelFormModeChoiceTransportElement","_createIsoPanelFormModeChoiceDirectionElement","_createShowIsoExclusionsElement","_createShowIsoExclusionsPictoElement","_createIsoPanelFormExclusionsElement","_createIsoPanelFormExclusionOptionsElement","_createIsoFormResetElement","_submitContainer","_createIsoSubmitFormElement","_createIsoWaitingElement","_hideIsoSuggestedLocations","_clearGeojsonLayer","onIsoComputationSubmit","positionCoordinates","timeHourInput","timeMinutesInput","distInput","isoRequestOptions","smoothing","_drawIsoResults","_requestIsoCurve","onShowIsoPanelClick","onIsoTypeChoiceChange","onIsoModeTransportChange","onIsoModeDirectionChange","onIsoExclusionsChange","onIsoResetClick","isoCurve","_clearIsoInputs","directionSelect","IsoDOM","onIsoValueChronTimeMinuteChange","onIsoValueChronTimeHourChange","label1","label2","onIsoValueDistChange","departureOption","arrivalOption","_activateMapInteraction","_clearInputFeatures","_removeMapInteraction","_inputFeaturesLayer","_inputFeaturesSources","_inputFeatures","delimitations","reverseGeocodeOptions","_currentGeocodingType","_initGeocodingType","_currentGeocodingDelimitation","_initGeocodingDelimitation","_showReverseGeocodingInput","_panelHeaderContainer","_panelTitleContainer","_returnPictoContainer","_resultsContainer","_resultsListContainer","_inputFeaturesSource","_mapInteraction","_requestOptions","_requestPosition","_requestCircleFilter","_requestBboxFilter","_reverseGeocodingLocations","_reverseGeocodingLocationsMarkers","_resultsDefaultStyle","_resultsSelectedStyle","resourcesList","wrongResourcesIndexes","delimitationsList","wrongDelimitationsIndexes","noRightsIndexes","_createShowReverseGeocodingElement","_createShowReverseGeocodingPictoElement","reverseGeocodingPanel","_createReverseGeocodingPanelElement","panelHeader","_createReverseGeocodingPanelHeaderElement","returnPicto","_createReverseGeocodingPanelReturnPictoElement","panelTitle","_createReverseGeocodingPanelTitleElement","closeDiv","_createReverseGeocodingPanelCloseElement","reverseGeocodingForm","_createReverseGeocodingPanelFormElement","_createReverseGeocodingFormModeChoiceGeocodingTypeElement","_createReverseGeocodingFormModeChoiceGeocodingDelimitationElement","_createReverseGeocodingSubmitFormElement","_createReverseGeocodingWaitingElement","resultsPanel","_createReverseGeocodingResultsPanelElement","reverseGeocodingResultsList","_createReverseGeocodingResultsListElement","delimitation","_activatePointInteraction","_activateCircleInteraction","_activateBoxInteraction","_onDrawStart","getRadius","geometryFunction","setCoordinates","maxPoints","_onBoxDrawEnd","srs","geoCoordinate","startGeoCoordinate","endGeoCoordinate","_reverseGeocodingRequest","_getReverseGeocodingRequestOptions","reverseGeocode","requestOptions","_displayGeocodedLocations","circle","_displayGeocodedLocationsOnMap","locationDescription","_fillGeocodedLocationDescription","_createReverseGeocodingResultElement","street","matchType","municipality","nature","inseeDepartment","inseeRegion","_createResultsLayer","_addResultFeature","_resultsFeatures","getLength","_resultsFeaturesSource","_resultsFeaturesLayer","geocodeType","Feature","setId","_fillPopupContent","selectedResultDiv","deSelectedResultDiv","onShowReverseGeocodingClick","onReverseGeocodingTypeChange","onReverseGeocodingDelimitationChange","onGPreverseGeocodingReturnPictoClick","onReverseGeocodingSubmit","onReverseGeocodingResultClick","onReverseGeocodingResultMouseOver","onReverseGeocodingResultMouseOut","ReverseGeocodingDOM","resultsPanelDiv","POIOption","SAOption","CPOption","adminOption","pointOption","circleOption","extentOption","getStaticImportContent","contentStatic","getServiceImportContent","contentService","layerTypes","webServicesOptions","vectorStyleOptions","extractStyles","defaultStyle","GPX","_initImportTypes","_initDefaultStyles","_showImportInput","_importPanel","_staticLocalImportInput","_staticUrlImportInput","_serviceUrlImportInput","_getCapPanel","_getCapResultsListContainer","_getCapRequestUrl","_getCapResponseWMS","_getCapResponseWMSLayers","_getCapResponseWMTS","_getCapResponseWMTSLayers","typesList","wrongTypesIndexes","kmlDefaultStyles","_defaultKMLStyle","gpxDefaultStyles","_defaultGPXStyle","geoJSONDefaultStyles","_defaultGeoJSONStyle","_currentImportType","_isCurrentImportTypeStatic","_currentStaticImportType","_createShowImportElement","_createShowImportPictoElement","importPanel","_createImportPanelElement","_createImportPanelHeaderElement","importForm","_initInputFormElement","getCapPanel","_createImportGetCapPanelElement","_createImportGetCapPanelHeaderElement","importGetCapResultsList","_createImportGetCapResultsListElement","_createImportWaitingElement","_createImportPanelFormElement","importTypeChoiceDiv","_createImportTypeLineElement","importStaticParamsContainer","_createImportStaticParamsContainer","staticNameLabel","_createStaticNameLabel","staticImportChoice","_createStaticModeChoiceDiv","staticLocalImportChoice","_createStaticLocalChoiceDiv","staticUrlImportChoice","_createStaticUrlChoiceDiv","staticLocalInputDiv","_createStaticLocalInputDiv","_createStaticLocalInputLabel","_createStaticLocalInput","staticUrlInputDiv","_createStaticUrlInputDiv","_createStaticUrlInputLabel","_createStaticUrlInput","importServiceParamsContainer","_createServiceParamsContainer","importServiceUrlDiv","_createServiceUrlDiv","_createServiceUrlInputLabel","_createServiceUrlInput","_createImportSubmitFormElement","_onShowImportClick","_onImportTypeChange","_onStaticImportTypeChange","_onGetCapPanelClose","_clearGetCapParams","_emptyGetCapResultsList","_onImportSubmit","_importStaticLayer","_importServiceLayers","staticImportNameInput","_importStaticLayerFromLocalFile","_importStaticLayerFromUrl","_addFeaturesFromImportStaticLayer","file","files","fReader","FileReader","onerror","onprogress","onloadstart","onabort","onloadend","onload","readAsText","fileContent","vectorStyle","fileProj","readProjection","_getMapProjectionCode","vectorSource","addFeatures","readName","vectorLayer","sourceExtent","_addFeaturesFromImportStaticLayerUrl","forEachFeature","questionMarkIndex","bfound","_displayGetCapResponseLayers","xmlResponse","layerDescription","WMSCapabilities","getCapResponseWMS","read","Capability","Layer","getCapLayer","_displayGetCapResponseWMSLayer","WMTSCapabilities","getCapResponseWMTS","Contents","_getWMTSLayerProjection","Title","_createImportGetCapResultElement","layerObj","parentLayersInfos","mapProjCode","addKeys","replaceKeys","_isRootLayer","lastIndex","_getWMSLayerProjection","_projection","_onGetCapResponseLayerClick","proposalId","_addGetCapWMSLayer","_addGetCapWMTSLayer","getMapUrl","_getWMSLayerGetMapUrl","Name","legend","LegendURL","OnlineResource","_getWMSLayerInfoForLayerSwitcher","_getWMSLayerMinMaxResolution","_getWMSLayerExtent","wmsLayer","queryable","gpGFIparams","Request","Format","formats","getmapurl","GetMap","getmap","DCPType","HTTP","Get","CRSList","layerCRS","mapUnits","MinScaleDenominator","MaxScaleDenominator","cste","exGeographicBoundingBox","boundingBox","BoundingBox","olProj","reversedExtent","Abstract","MetadataURL","Attribution","LogoURL","Identifier","_getWMTSLayerGetTileUrl","tmsOptions","_getTMSParams","projCode","isDefault","_getWMTSLayerExtent","wmtsLayer","gettileurl","OperationsMetadata","GetTile","gettile","DCP","TileMatrixSetLink","TileMatrixSet","tileMatrixSets","TileMatrix","SupportedCRS","tilematrix","scaledenominator","ScaleDenominator","TopLeftCorner","WGS84BoundingBox","LayerImportDOM","_createImportPanelTitleElement","_createImportPanelCloseElement","importTypes","currentType","ctrls","_updateAttributions","mapAttributions","mapProjection","geoExtent","standardExtent","_updateLayerAttributions","lyrs","mapCrs","mapZoom","setAttributions","layerAttributions","attributionj","html","_pictoContainer","_panelContainer","_profileContainer","_infoContainer","_timerHdlr","_drawStyleStart","_drawStyleFinish","_profile","_data","_measureSource","_measureVector","_measureDraw","_lastSketch","_currentSketch","_initializeContainer","__removeProfileMarker","__createProfileMarker","_coordinateProj","getClosestPoint","_geometry","addFeature","__updateProfileMarker","__customRawProfileOperation","_pts","_proj","DEFAULT_STYLES","RESULTS","_image","imageRadius","imageStrokeColor","imageStrokeWidth","imageFillColor","__customRawProfileMouseOverEvent","DISPLAY_PROFILE_LIB_AMCHARTS","AmCharts","profile","displayProfileLibAmCharts","DISPLAY_PROFILE_LIB_D3","d3","displayProfileLibD3","DISPLAY_PROFILE_RAW","displayProfileRaw","DISPLAY_PROFILE_BY_DEFAULT","displayProfileByDefault","MARKER","snapToPixel","_initMeasureInteraction","_addMeasureInteraction","_removeProfile","_removeMeasure","_removeMeasureInteraction","_features","elevationOptions","displayProfileOptions","greaterSlope","meanSlope","ascendingElevation","descendingElevation","currentSlope","stylesOptions","draw","marker","displayFunction","displayContainer","_createStylingDraw","_createStylingMarker","_createShowElevationPathElement","_createShowElevationPathPictoElement","_createElevationPathPanelElement","_createElevationPathPanelHeaderElement","_createElevationPathPanelProfilElement","_createElevationPathWaitingElement","_createElevationPathInformationsElement","_createStylingProfile","userStyles","PROFILE","_defaultStyle","_requestService","_getGeometry","projSrc","projDest","ll","_getLength","_requestServiceOnSuccess","_displayProfile","_requestServiceOnFailure","sampling","_sampling","_length","_computeElevationMeasure","_limite","_unit","_factor","dist","slope","_distanceMinus","_distancePlus","_ascendingElevation","_descendingElevation","_distance","_slopes","za","zb","coeffArrond","_altMin","_altMax","_greaterSlope","ji","distancePlus","toLocaleString","distanceMinus","altMin","altMax","onShowElevationPathClick","onOpenElevationPathInfoClick","_addElevationPathInformationsItem","MeasureToolBoxDOM","_toolboxId","_buttonId","_widgetId","getButtonID","blur","ElevationPathDOM","divInfo","divReduce","onReduceElevationPathPanelClick","ProfileElevationPathDOM","_displayProfileOptions","_points","sortedElev","JSON","parse","stringify","e1","e2","minZ","maxZ","diff","barwidth","divBox","divZ","ulZ","liZmin","liZmax","divData","_lon","_lat","ulData","pct","divX","ulX","liXmin","liXmax","margin","clientWidth","clientHeight","linear","xAxis","svg","axis","orient","ticks","yAxis","line","interpolate","area","y0","y1","append","xDomain","domain","yDomain","datum","tickSize","tickFormat","selectAll","enter","bisectDist","bisector","transition","mouse","invert","d0","d1","xc","yc","_message","ballonText","addInitHandler","pathToImages","categoryField","autoMarginOffset","marginRight","marginTop","startDuration","fontSize","theme","thousandsSeparator","numberFormatter","decimalSeparator","thousandsSeparato","categoryAxis","gridPosition","minHorizontalGap","tickPosition","titleColor","labelOffset","startOnAxis","chartCursor","animationDuration","bulletsEnabled","bulletSize","categoryBalloonEnabled","cursorColor","graphBulletAlpha","graphBulletSize","zoomable","trendLines","balloonColor","balloonText","bullet","bulletAlpha","bulletBorderColor","bulletBorderThickness","bulletColor","fillAlphas","fillColors","lineAlpha","lineColor","lineThickness","valueField","guides","valueAxes","minVerticalGap","balloon","borderColor","borderThickness","showBullet","titles","allLabels","dataProvider","_containerProfile","makeChart","addListener","chart","geodesic","show","_createShowMeasureLengthElement","_createShowMeasureLengthPictoElement","sourceProj","onShowMeasureLengthClick","MeasureLengthDOM","_createShowMeasureAreaElement","_createShowMeasureAreaPictoElement","polygon","getArea","onShowMeasureAreaClick","MeasureAreaDOM","setGeodesic","isGeodesic","_createShowMeasureAzimuthElement","_createShowMeasureAzimuthPictoElement","onPointerMoveAzimutHandler","getFirstCoordinate","lengthGeodesic","fraction","getCoordinateAt","degrees2radians","radians2degrees","lon1","lon2","lat1","lat2","sin","cos","atan","atan2","azimut","onShowMeasureAzimuthClick","finishDrawing","MeasureAzimuthDOM"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD,O;ACVA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAK;AACL;AACA;;AAEA;AACA;AACA;AACA,mCAA2B,0BAA0B,EAAE;AACvD,yCAAiC,eAAe;AAChD;AACA;AACA;;AAEA;AACA,8DAAsD,+DAA+D;;AAErH;AACA;;AAEA;AACA;;;;;;;;;;;;;;;;AC7DA,IAAIA,QAAQ;;AAER;;;;;;;AAOAC,mBAAe,yBAAW;;AAEtB,YAAIC,YAAY,IAAhB;AACA,YAAIC,YAAYC,OAAOC,SAAP,CAAiBF,SAAjB,CAA2BG,WAA3B,EAAhB;;AAEA,YAAIH,UAAUI,OAAV,CAAkB,QAAlB,MAAgC,CAAC,CAAjC,IACAJ,UAAUI,OAAV,CAAkB,MAAlB,MAA8B,CAAC,CAD/B,IAEAJ,UAAUI,OAAV,CAAkB,MAAlB,MAA8B,CAAC,CAF/B,IAGAJ,UAAUI,OAAV,CAAkB,SAAlB,MAAiC,CAAC,CAHlC,IAIAJ,UAAUI,OAAV,CAAkB,QAAlB,MAAgC,CAAC,CAJjC,IAKAJ,UAAUI,OAAV,CAAkB,YAAlB,MAAoC,CAAC,CALrC,IAMAJ,UAAUI,OAAV,CAAkB,QAAlB,MAAgC,CAAC,CANjC,IAOAJ,UAAUI,OAAV,CAAkB,OAAlB,MAA+B,CAAC,CAPhC,IAQAJ,UAAUI,OAAV,CAAkB,OAAlB,MAA+B,CAAC,CARpC,EAQuC;AACnCL,wBAAY,KAAZ;AACH;;AAED,YAAIC,UAAUI,OAAV,CAAkB,MAAlB,MAA8B,CAAC,CAA/B,IACAJ,UAAUI,OAAV,CAAkB,SAAlB,MAAiC,CAAC,CADtC,EACyC;AACrCL,wBAAY,IAAZ;AACH;;AAED,eAAOA,SAAP;AACH,KAhCO;;AAkCR;;;;;;;AAOAM,YAAQ,gBAASC,IAAT,EAAeC,MAAf,EAAuB;AAC3BD,eAAOA,QAAQ,EAAf;AACA,aAAK,IAAIE,IAAT,IAAiBD,MAAjB,EAAyB;AACrB,gBAAIA,OAAOE,cAAP,CAAsBD,IAAtB,CAAJ,EAAiC;AAC7BF,qBAAKE,IAAL,IAAaD,OAAOC,IAAP,CAAb;AACH;AACJ;AACD,eAAOF,IAAP;AACH,KAjDO;;AAmDR;;;;;;AAMAI,iBAAa,qBAASJ,IAAT,EAAeC,MAAf,EAAuB;AAChC,YAAI,CAACD,IAAD,IAAS,CAACC,MAAd,EAAsB;AAClB;AACH;AACD,aAAK,IAAII,KAAT,IAAkBJ,MAAlB,EAA0B;AACtB,gBAAIA,OAAOE,cAAP,CAAsBE,KAAtB,CAAJ,EAAkC;AAC9B,oBAAI,QAAOJ,OAAOI,KAAP,CAAP,MAAyB,QAA7B,EAAuC;AACnC,wBAAIL,KAAKG,cAAL,CAAoBE,KAApB,CAAJ,EAAgC;AAC5B,6BAAKD,WAAL,CAAiBJ,KAAKK,KAAL,CAAjB,EAA8BJ,OAAOI,KAAP,CAA9B;AACH,qBAFD,MAEO;AACHL,6BAAKK,KAAL,IAAcJ,OAAOI,KAAP,CAAd;AACH;AACJ,iBAND,MAMO;AACHL,yBAAKK,KAAL,IAAcJ,OAAOI,KAAP,CAAd;AACH;AACJ;AACJ;AACJ;AA1EO,CAAZ;;kBA6Eed,K;;;;;;AC7Ef,+C;;;;;;;;;;;;ACAA;;;;;;;;AAQA,IAAIe,aAAa;;AAEb;;;;AAIAC,cAAW,YAAW;AAClB,YAAIC,YAAYC,KAAKC,KAAL,CAAWC,KAAKC,GAAL,EAAX,CAAhB;AACA,eAAO,YAAW;AACd,mBAAOJ,WAAP;AACH,SAFD;AAGH,KALS,EANG;;AAab;AACAK,UAAM,cAASC,EAAT,EAAa;AACf,YAAID,OAAO,IAAX;;AAEA,YAAIE,IAAID,GAAGE,WAAH,CAAe,GAAf,CAAR;AACA,YAAID,MAAM,CAAC,CAAX,EAAc;AACVF,mBAAOC,EAAP;AACH,SAFD,MAEO;AACHD,mBAAOC,GAAGG,SAAH,CAAa,CAAb,EAAgBF,CAAhB,CAAP;AACH;;AAED,eAAOF,IAAP;AACH,KAzBY;;AA2Bb;AACAK,WAAO,eAASJ,EAAT,EAAa;AAChB,YAAII,QAAQ,IAAZ;;AAEA,YAAIL,OAAO,KAAKA,IAAL,CAAUC,EAAV,CAAX;AACA;AACA,YAAIC,IAAIF,KAAKG,WAAL,CAAiB,GAAjB,CAAR;AACA,YAAID,MAAM,CAAC,CAAX,EAAc;AACVG,oBAAQL,KAAKI,SAAL,CAAeF,IAAI,CAAnB,CAAR;AACH;AACD;;AAEA,eAAOG,KAAP;AACH,KAxCY;;AA0Cb;AACAC,UAAM,cAASL,EAAT,EAAa;AACf,YAAIK,OAAO,IAAX;;AAEA,YAAIJ,IAAID,GAAGE,WAAH,CAAe,GAAf,CAAR;AACA,YAAID,MAAM,CAAC,CAAX,EAAc;AACVI,mBAAOC,SAASN,GAAGG,SAAH,CAAaF,IAAI,CAAjB,CAAT,EAA8B,EAA9B,CAAP;AACH;;AAED,eAAOI,IAAP;AACH;;AApDY,CAAjB;;kBAwDeb,U;;;;;;;;;;;;;AC/Df;;IAAYe,G;;;;AAEZ,IAAIC,kBAAkB;AAClB;AACAC,eAAY,mBAAUV,IAAV,EAAgB;AACxB;AACA;AACEW,QAAA,MAAF,GACIH,IAAII,UAAJ,EADJ,GACuBJ,IAAIK,SAAJ,EADvB;AAEA,YAAIC,UAAUd,QAAQ,SAAtB;AACA,eAAOQ,IAAIE,SAAJ,CAAcI,OAAd,CAAP;AACH;AATiB,CAAtB,C,CAHA;kBAeeL,e;;;;;;ACff;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD,oCAAoC;AACpC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA,mCAAmC,0BAA0B,EAAE;AAC/D,yCAAyC,eAAe;AACxD;AACA;AACA;AACA;AACA;AACA,8DAA8D,+DAA+D;AAC7H;AACA;AACA;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;;AAGA,OAAO;AACP;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA,eAAe,OAAO;AACtB,eAAe,SAAS;AACxB,gBAAgB,OAAO;AACvB;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA,SAAS;AACT;;AAEA;;AAEA;AACA;AACA;;AAEA;;;AAGA,OAAO;AACP;AACA;;AAEA;AACA;AACA;AACA;AACA,cAAc,OAAO;AACrB,cAAc,OAAO,+BAA+B,2BAA2B,iEAAiE,8DAA8D,EAAE;AAChN,cAAc,OAAO,qBAAqB,2BAA2B,GAAG,2BAA2B,KAAK,2BAA2B;AACnI;AACA;AACA;AACA,WAAW,cAAc;AACzB,WAAW,OAAO;AAClB,WAAW,KAAK;AAChB,WAAW,OAAO,0CAA0C,2BAA2B,iEAAiE,8DAA8D;AACtN;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;;AAED;;;AAGA,OAAO;AACP;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;AASA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,OAAO;AAClB;AACA,WAAW,OAAO;AAClB;AACA;AACA;AACA;AACA,WAAW,OAAO;AAClB;AACA;AACA;AACA,WAAW,OAAO;AAClB;AACA;AACA;AACA;AACA,WAAW,QAAQ;AACnB;AACA;AACA;AACA;AACA,WAAW,OAAO;AAClB;AACA;AACA,WAAW,OAAO;AAClB;AACA;AACA;AACA;AACA;AACA,WAAW,OAAO;AAClB;AACA;AACA;AACA;AACA,WAAW,OAAO;AAClB;AACA;AACA;AACA;AACA,WAAW,OAAO;AAClB;AACA;AACA,WAAW,QAAQ;AACnB;AACA;AACA,WAAW,SAAS;AACpB;AACA;AACA;AACA;AACA;AACA,WAAW,SAAS;AACpB;AACA;AACA,WAAW,SAAS;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0CAA0C;AAC1C,uCAAuC;AACvC;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,cAAc;AACd;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB,QAAQ,uBAAuB;AACpD,qBAAqB,QAAQ,uCAAuC;AACpE;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;;AAET;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,iDAAiD,QAAQ,uBAAuB;AAChF;AACA;AACA;AACA;AACA;AACA;AACA,iCAAiC;AACjC;AACA,6BAA6B;AAC7B,uDAAuD;AACvD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB;AACzB;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;;AAGA,OAAO;AACP;AACA;;AAEA;AACA;;AAEA;;;AAGA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,OAAO;AAClB;AACA,WAAW,OAAO;AAClB;AACA;AACA;AACA,WAAW,OAAO;AAClB;AACA,WAAW,OAAO;AAClB;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA,cAAc;AACd;AACA;;AAEA;AACA;AACA,cAAc;AACd;AACA;;AAEA;AACA;AACA,cAAc;AACd;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,iBAAiB,OAAO;AACxB;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA,eAAe,OAAO;AACtB;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA,gBAAgB,OAAO;AACvB;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA,eAAe,OAAO;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA,gBAAgB,WAAW;AAC3B;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,gBAAgB,OAAO;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,OAAO;AAClB,YAAY,WAAW;AACvB;AACA;;AAEA;AACA;AACA,0DAA0D;AAC1D;AACA,KAAK;AACL;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,SAAS;AACT;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B,wBAAwB;AACvD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,oCAAoC;AACjD;AACA;AACA;;AAEA,SAAS;AACT;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,WAAW;AACtB,YAAY,WAAW;AACvB;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,WAAW;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA,uBAAuB,qBAAqB;AAC5C;;AAEA,uCAAuC;AACvC;;AAEA,aAAa;AACb;;AAEA;AACA;AACA;;AAEA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,WAAW;AACtB,YAAY,OAAO;AACnB;AACA;AACA;AACA;AACA;AACA,uBAAuB,uBAAuB;AAC9C;AACA;AACA;AACA;AACA;AACA;;AAEA;;;AAGA,OAAO;AACP;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,eAAe,OAAO;AACtB;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,iBAAiB;AACjB;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA,eAAe,OAAO;AACtB,eAAe,cAAc;AAC7B,eAAe,QAAQ;AACvB;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,iBAAiB;AACjB;AACA;;AAEA;;AAEA;AACA;AACA,2BAA2B;AAC3B;AACA;;AAEA,mDAAmD;AACnD;AACA;AACA;;AAEA;;AAEA;AACA;AACA,aAAa;AACb;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA,KAAK;;AAEL;AACA;AACA;AACA,eAAe,OAAO;AACtB,eAAe,OAAO;AACtB;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;;AAEA;;;AAGA,OAAO;AACP;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,YAAY,OAAO;AACnB;AACA;AACA,WAAW;AACX;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA,gBAAgB;AAChB,kBAAkB,SAAS;AAC3B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,gBAAgB;AAChB,kBAAkB,SAAS;AAC3B;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,gBAAgB;AAChB,kBAAkB,SAAS;AAC3B;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,gBAAgB;AAChB,kBAAkB,SAAS;AAC3B;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,gBAAgB;AAChB,kBAAkB,SAAS;AAC3B;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA,+BAA+B,gBAAgB;AAC/C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,gBAAgB;AAChB,kBAAkB,SAAS;AAC3B;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,gBAAgB;AAChB,kBAAkB,SAAS;AAC3B;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;;AAGA,OAAO;AACP;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,cAAc;AACd;AACA;;AAEA;AACA;AACA;AACA,cAAc;AACd;AACA;;AAEA;AACA;AACA;AACA,cAAc;AACd;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;;;AAGA,OAAO;AACP;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;AAIA;;AAEA;AACA;AACA;AACA;AACA,eAAe,OAAO;AACtB,eAAe,SAAS;AACxB,eAAe,SAAS;AACxB;AACA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,0BAA0B;AAC1B;AACA;AACA;AACA,6BAA6B,EAAE;AAC/B;AACA;AACA;AACA,6BAA6B,EAAE;AAC/B,4BAA4B;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb,0BAA0B;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B;AAC3B;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;;AAGA,OAAO;AACP;AACA;;AAEA;AACA;AACA,wBAAwB,6DAA6D;AACrF;AACA,cAAc,mCAAmC;AACjD;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;;AAGA,OAAO;AACP;AACA;;AAEA;;AAEA;AACA;AACA;AACA,cAAc,MAAM;AACpB,cAAc,MAAM;AACpB,cAAc,MAAM;AACpB,cAAc,MAAM;AACpB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;;AAGA,OAAO;AACP;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;;;;;;AAOA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU;AACV,UAAU;AACV,UAAU;AACV;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0CAA0C,mDAAmD;AAC7F,iDAAiD,iEAAiE;AAClH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,SAAS;AACpB,WAAW,SAAS;AACpB;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,cAAc;AACd;AACA;;AAEA;AACA;AACA;AACA;AACA,cAAc;AACd;AACA;;AAEA;AACA;AACA;AACA,cAAc;AACd;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,KAAK;;AAEL;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA,eAAe,OAAO;AACtB;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA,SAAS;AACT;AACA;;AAEA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,WAAW,OAAO,WAAW;AAC7B;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA,0BAA0B;;AAE1B;AACA;AACA;AACA,uBAAuB,sBAAsB;AAC7C;AACA;AACA;AACA,4BAA4B;;AAE5B;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,KAAK;AACL;;AAEA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;;AAEA;AACA,mBAAmB;AACnB;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;;;AAGA,OAAO;AACP;AACA;;AAEA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,OAAO;AAClB;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA,cAAc;AACd;AACA;;AAEA;AACA;AACA,cAAc;AACd;AACA;;AAEA;AACA;AACA,cAAc;AACd;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,eAAe,OAAO;AACtB;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA,eAAe,OAAO;AACtB;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;;AAGA,OAAO;AACP;AACA;;AAEA;AACA;;;;AAIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO,OAAO;AACd;AACA;AACA;AACA;AACA;AACA,4CAA4C,8CAA8C;AAC1F;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,eAAe,OAAO;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;;AAEA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA,eAAe,OAAO;AACtB,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,KAAK;;AAEL;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA,eAAe,OAAO;AACtB,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA,eAAe,OAAO;AACtB,eAAe,OAAO;AACtB;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA,eAAe,OAAO;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;;AAGA,OAAO;AACP;AACA;;AAEA;;AAEA;AACA,wBAAwB,qDAAqD,KAAK,mEAAmE;AACrJ;AACA,cAAc,+FAA+F;AAC7G;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;;AAGA,OAAO;AACP;AACA;;AAEA;;AAEA;AACA;AACA;AACA,cAAc,SAAS;AACvB,cAAc,OAAO;AACrB,cAAc,OAAO;AACrB,cAAc,OAAO;AACrB;AACA;AACA;AACA;AACA,+BAA+B,cAAc;AAC7C;AACA;AACA;AACA;AACA;AACA,qEAAqE,6CAA6C;AAClH,0EAA0E,6CAA6C;AACvH;AACA,4CAA4C,6DAA6D;AACzG;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+FAA+F,sFAAsF;AACrL;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;;AAGA,OAAO;AACP;AACA;;AAEA;AACA;AACA,wBAAwB,iDAAiD;AACzE;AACA,cAAc,QAAQ;AACtB,cAAc,OAAO,kDAAkD,0BAA0B;AACjG,cAAc,2CAA2C;AACzD,cAAc,OAAO;AACrB,cAAc,MAAM;AACpB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA,8BAA8B;;AAE9B;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;;AAGA,OAAO;AACP;AACA;;AAEA;;AAEA;AACA;AACA;AACA,cAAc,OAAO;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAc,OAAO;AACrB,cAAc,OAAO,6CAA6C,0BAA0B;AAC5F,cAAc,MAAM;AACpB,cAAc,MAAM;AACpB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA,yBAAyB;AACzB;;AAEA;;AAEA;;AAEA;;AAEA;;;AAGA,OAAO;AACP;AACA;;AAEA;;AAEA;AACA,wBAAwB,uDAAuD;AAC/E;AACA,cAAc,MAAM;AACpB,cAAc,MAAM;AACpB,cAAc,OAAO,6CAA6C,0BAA0B;AAC5F,cAAc,OAAO;AACrB,cAAc,SAAS;AACvB,cAAc,OAAO;AACrB,cAAc,OAAO;AACrB;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;;AAGA,OAAO;AACP;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;AAKA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA,eAAe,OAAO;AACtB,eAAe,OAAO;AACtB,eAAe,OAAO;AACtB,eAAe,OAAO;AACtB,eAAe,OAAO;AACtB,eAAe,OAAO;AACtB,eAAe,cAAc;AAC7B,eAAe,cAAc;AAC7B,eAAe,OAAO;AACtB,eAAe,OAAO;AACtB,eAAe,SAAS;AACxB,eAAe,SAAS;AACxB;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,qCAAqC;AACrC;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4GAA4G;AAC5G;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA,gBAAgB,OAAO;AACvB,gBAAgB,OAAO;AACvB;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;AACA;;AAEA,sDAAsD;;AAEtD;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA,yBAAyB;AACzB;AACA;AACA,qBAAqB;AACrB,iBAAiB;;AAEjB;;AAEA;;AAEA;AACA,qEAAqE;AACrE;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qCAAqC;AACrC,iCAAiC;AACjC;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,uDAAuD;AACvD;AACA;AACA;AACA,iCAAiC;AACjC;AACA;AACA;AACA;AACA;AACA,qCAAqC;AACrC;AACA;;AAEA;;AAEA;AACA;;AAEA;;AAEA,qBAAqB;AACrB;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,6BAA6B;AAC7B;AACA;AACA;AACA;AACA;AACA,iCAAiC;AACjC;AACA;;AAEA;;AAEA;;AAEA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;;AAEA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA,gBAAgB,OAAO;AACvB,gBAAgB,OAAO;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA,gBAAgB,OAAO;AACvB,gBAAgB,OAAO;AACvB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,sEAAsE;AACtE;AACA,iBAAiB;AACjB;AACA;AACA;AACA,qBAAqB,OAAO;AAC5B;AACA;AACA;AACA;AACA;;AAEA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA,aAAa;AACb;;AAEA;;AAEA;;;AAGA,OAAO;AACP;AACA;;AAEA;;AAEA,OAAO;AACP;AACA;;AAEA;AACA;AACA;;;;;AAKA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,OAAO;AAClB,WAAW,QAAQ;AACnB;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA,6CAA6C;;AAE7C;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;;AAEA,CAAC;;AAED;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,aAAa;AACb;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,KAAK;AACL,iBAAiB,oCAAoC,EAAE;AACvD;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,KAAK;;AAEL;AACA;;AAEA;;;AAGA,OAAO;AACP;AACA;;AAEA;AACA;;;;AAIA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,QAAQ;AACnB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,iBAAiB,mBAAmB,GAAG,mBAAmB;AAC1D;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,eAAe,SAAS;AACxB;AACA,2BAA2B,2BAA2B,GAAG,2BAA2B;AACpF;AACA;AACA;AACA,uBAAuB,wBAAwB;AAC/C;AACA;AACA;AACA;AACA;;AAEA;AACA,KAAK;;AAEL;AACA;AACA;AACA,eAAe,IAAI;AACnB,iBAAiB;AACjB;AACA,2BAA2B,OAAO,mBAAmB,GAAG,mBAAmB;AAC3E,4BAA4B,MAAM,mBAAmB;AACrD;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA,KAAK;;AAEL;AACA;AACA;AACA,eAAe,SAAS;AACxB;AACA,2BAA2B,2BAA2B,GAAG,2BAA2B;AACpF;AACA;;AAEA,uBAAuB,wBAAwB;AAC/C;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA,iBAAiB,OAAO;AACxB;AACA;AACA;AACA;AACA;AACA,uBAAuB,2BAA2B;AAClD;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA,iBAAiB,OAAO;AACxB;AACA;AACA;AACA;AACA;AACA,uBAAuB,2BAA2B;AAClD;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA,aAAa;AACb;AACA;;AAEA;;AAEA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,KAAK;;AAEL;AACA;;AAEA;;;AAGA,OAAO;AACP;AACA;;AAEA;AACA;AACA;;;;;AAKA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA,+CAA+C;;AAE/C;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA,CAAC;;AAED;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,aAAa;AACb;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,KAAK;AACL,iBAAiB,oCAAoC,EAAE;AACvD;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,KAAK;;AAEL;AACA;;AAEA;;;AAGA,OAAO;AACP;AACA;;AAEA;;AAEA;AACA,wBAAwB,yDAAyD;AACjF;AACA,cAAc,OAAO;AACrB,cAAc,OAAO;AACrB,cAAc,OAAO;AACrB,cAAc,OAAO;AACrB,cAAc,OAAO;AACrB,cAAc,cAAc,kHAAkH,iFAAiF;AAC/N,cAAc,OAAO,4GAA4G,+BAA+B;AAChK,cAAc,OAAO,+GAA+G,mCAAmC;AACvK,cAAc,OAAO,yHAAyH,uCAAuC;AACrL,cAAc,OAAO,2HAA2H,iCAAiC;AACjL;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,oBAAoB;AACpB;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,eAAe,OAAO;AACtB,iBAAiB,QAAQ;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA,eAAe,OAAO;AACtB,iBAAiB,MAAM;AACvB;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA,eAAe,OAAO;AACtB,iBAAiB,OAAO;AACxB;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,0BAA0B;AACrD;AACA;AACA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CA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA,iBAAiB,OAAO;AACxB;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA,iBAAiB,OAAO;AACxB;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA,eAAe,OAAO;AACtB,iBAAiB,OAAO;AACxB;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA,iBAAiB,kCAAkC;AACnD;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA,iBAAiB,oCAAoC;AACrD;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA,iBAAiB,iCAAiC;AAClD;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA,iBAAiB,OAAO;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,cAAc;AACrC;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA,iBAAiB,oCAAoC;AACrD;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA,iBAAiB,OAAO;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,cAAc;AACrC;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA,iBAAiB,sCAAsC;AACvD;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA,iBAAiB,sCAAsC;AACvD;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA,iBAAiB,OAAO;AACxB;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA,iBAAiB,OAAO;AACxB;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;;AAEA;;AAEA;;;AAGA,OAAO;AACP;AACA;;AAEA;;AAEA;AACA;AACA;AACA,cAAc,OAAO;AACrB,cAAc,OAAO;AACrB,cAAc,OAAO;AACrB;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;;AAGA,OAAO;AACP;AACA;;AAEA;;AAEA;AACA;AACA;AACA,cAAc,OAAO;AACrB,cAAc,OAAO;AACrB;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;;AAGA,OAAO;AACP;AACA;;AAEA;;AAEA;AACA;AACA;AACA,cAAc,OAAO;AACrB,cAAc,OAAO;AACrB,cAAc,OAAO;AACrB,cAAc,OAAO;AACrB,cAAc,sCAAsC;AACpD;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;;AAGA,OAAO;AACP;AACA;;AAEA;;AAEA;AACA;AACA;AACA,cAAc,OAAO;AACrB,cAAc,OAAO;AACrB,cAAc,OAAO;AACrB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;;AAGA,OAAO;AACP;AACA;;AAEA;;AAEA;AACA;AACA;AACA,cAAc,OAAO;AACrB,cAAc,OAAO;AACrB,cAAc,QAAQ;AACtB;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;;AAGA,OAAO;AACP;AACA;;AAEA;;AAEA;AACA;AACA;AACA,cAAc,QAAQ;AACtB,cAAc,OAAO;AACrB,cAAc,eAAe;AAC7B,cAAc,eAAe;AAC7B,cAAc,OAAO;AACrB,cAAc,OAAO;AACrB,cAAc,OAAO;AACrB,cAAc,OAAO;AACrB,cAAc,QAAQ;AACtB,cAAc,OAAO;AACrB,cAAc,MAAM;AACpB,cAAc,MAAM;AACpB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;;AAGA,OAAO;AACP;AACA;;AAEA;;AAEA;AACA;AACA;AACA,cAAc,OAAO;AACrB,cAAc,QAAQ,yDAAyD,4DAA4D;AAC3I;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;;AAGA,OAAO;AACP;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA,cAAc,eAAe;AAC7B,cAAc,sCAAsC;AACpD,cAAc,cAAc;AAC5B,cAAc,OAAO;AACrB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA,iBAAiB,MAAM;AACvB;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA,iBAAiB,MAAM;AACvB;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA,iBAAiB,OAAO;AACxB;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA,iBAAiB,sCAAsC;AACvD;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA,iBAAiB,SAAS;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;;AAGA,OAAO;AACP;AACA;;AAEA;;AAEA;AACA;AACA;AACA,cAAc,OAAO;AACrB,cAAc,OAAO;AACrB,cAAc,OAAO;AACrB,cAAc,OAAO;AACrB,cAAc,OAAO;AACrB,cAAc,OAAO;AACrB,cAAc,SAAS;AACvB;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA,iBAAiB,SAAS;AAC1B;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA,iBAAiB,OAAO;AACxB;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA,iBAAiB,OAAO;AACxB;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA,iBAAiB,OAAO;AACxB;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA,iBAAiB,OAAO;AACxB;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA,iBAAiB,OAAO;AACxB;AACA;AACA;AACA;;AAEA;;AAEA;;;AAGA,OAAO;AACP;AACA;;AAEA;;AAEA;AACA;AACA;AACA,cAAc,OAAO;AACrB,cAAc,OAAO;AACrB,cAAc,OAAO;AACrB,cAAc,OAAO;AACrB;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;;AAGA,OAAO;AACP;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;;;;;;AAOA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4CAA4C,SAAS;AACrD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,OAAO,kCAAkC;AACpD,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,SAAS;AACpB,WAAW,SAAS;AACpB;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;;AAED;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,WAAW,OAAO;AAClB;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA,WAAW,OAAO;AAClB;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,aAAa;AACb;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;;AAGA,OAAO;AACP;AACA;;AAEA;AACA;;;;AAIA;AACA;AACA;AACA,cAAc,MAAM;AACpB;AACA;AACA,aAAa;AACb;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA,cAAc;AACd;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;;AAGA,OAAO;AACP;AACA;;AAEA;AACA;;;;AAIA;AACA;AACA;AACA,cAAc,MAAM;AACpB;AACA;AACA,aAAa;AACb;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA,cAAc;AACd;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;;AAGA,OAAO;AACP;AACA;;AAEA;AACA;AACA,wBAAwB,+DAA+D;AACvF;AACA,cAAc,mDAAmD;AACjE;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;;AAGA,OAAO;AACP;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA,cAAc,OAAO;AACrB,cAAc,SAAS;AACvB,cAAc,OAAO;AACrB,cAAc,OAAO;AACrB,cAAc,OAAO;AACrB,cAAc,QAAQ;AACtB,cAAc,OAAO;AACrB,cAAc,OAAO;AACrB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,S;AACA;AACA;AACA,e;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe;AACf,e;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,cAAc;AACd;AACA;;AAEA;AACA;AACA,cAAc;AACd;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,cAAc,O;AACd;AACA;;AAEA;AACA;AACA,cAAc,O;AACd;AACA;;AAEA;AACA;AACA,cAAc,O;AACd;AACA;;AAEA;AACA;AACA,cAAc,Q;AACd;AACA;;AAEA;AACA;AACA,cAAc;AACd;AACA;;AAEA;AACA;AACA,cAAc;AACd;AACA;;AAEA;AACA;AACA,cAAc;AACd;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;;;AAGA,OAAO;AACP;AACA;;AAEA;;;AAGA,OAAO;AACP;AACA;;AAEA;AACA,0DAA0D,cAAc;AACxE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAgCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,OAAO;AACtB;AACA,eAAe,OAAO;AACtB;AACA;AACA;AACA;AACA;;AAEA;;AAEA,uBAAuB,QAAQ;AAC/B;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,yBAAyB;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,mEAAmE,cAAc;;;AAGjF,OAAO;AACP;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;AASA;AACA;AACA,uHAAuH,yCAAyC;AAChK;AACA;AACA,eAAe,OAAO;AACtB,eAAe,OAAO,oEAAoE,gDAAgD;AAC1I,eAAe,SAAS,yFAAyF,oCAAoC;AACrJ,eAAe,SAAS,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A;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA,WAAW,OAAO;AAClB;AACA,WAAW,eAAe,+BAA+B,oBAAoB;AAC7E;AACA;AACA;AACA;AACA;AACA,WAAW,OAAO;AAClB;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,OAAO;AAClB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,OAAO;AAClB;AACA;AACA,WAAW,QAAQ;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0CAA0C;AAC1C,uCAAuC;AACvC;AACA,sBAAsB,WAAW,GAAG,WAAW;AAC/C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,gDAAgD;AAChD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;;AAED;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,WAAW,SAAS;AACpB,WAAW,SAAS;AACpB;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,WAAW,SAAS;AACpB,WAAW,SAAS;AACpB;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA,KAAK;AACL;AACA;AACA;;AAEA;;;AAGA,OAAO;AACP;AACA;;AAEA,kEAAkE;AAClE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA,KAAK;AACL;AACA;AACA,CAAC;AACD;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,yBAAyB;AACzB,SAAS;AACT;AACA,SAAS;AACT;AACA,SAAS;AACT;AACA;AACA;;AAEA;;AAEA;AACA;AACA,uBAAuB,uBAAuB;AAC9C;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA,WAAW;;AAEX;AACA;AACA;AACA,qEAAqE;AACrE,WAAW;AACX;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA,WAAW;;AAEX;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0CAA0C;AAC1C;AACA,eAAe;AACf;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA,qBAAqB;AACrB;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,sCAAsC;AACtC;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,CAAC;;;AAGD,OAAO;AACP;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;AAKA;;AAEA;AACA;AACA;AACA;AACA;AACA,eAAe,OAAO;AACtB,eAAe,OAAO;AACtB,eAAe,OAAO;AACtB,eAAe,OAAO;AACtB,eAAe,OAAO;AACtB,eAAe,OAAO;AACtB,eAAe,OAAO;AACtB,eAAe,OAAO;AACtB,eAAe,QAAQ;AACvB,eAAe,cAAc;AAC7B,eAAe,cAAc;AAC7B,eAAe,cAAc;AAC7B,eAAe,OAAO;AACtB,eAAe,SAAS;AACxB,eAAe,SAAS;AACxB,eAAe,SAAS;AACxB,eAAe,OAAO;AACtB;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,yBAAyB,QAAQ,uBAAuB;AACxD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,mCAAmC,QAAQ,uBAAuB,2BAA2B;AAC7F;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,SAAS;AACT;AACA;;AAEA,wEAAwE;AACxE;;AAEA;AACA;AACA;AACA;AACA;AACA,mCAAmC;AACnC;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;;AAGA,OAAO;AACP;AACA;;AAEA,uDAAuD;AACvD;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,CAAC,qBAAqB;;AAEtB;AACA;AACA;AACA;;AAEA;AACA;AACA;;;;AAIA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,gFAAgF;;AAEhF;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA,0BAA0B,sBAAsB;;AAEhD;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,iBAAiB,SAAS;AAC1B;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA,CAAC;AACD;AACA,CAAC;AACD;AACA,CAAC;AACD;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;;;AAGA;AACA;AACA;AACA;AACA,KAAK;AACL,GAAG;AACH;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA,GAAG;AACH;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA,GAAG;AACH;;AAEA;AACA;AACA,UAAU,IAAI;AACd;AACA,WAAW,QAAQ;AACnB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;;AAEA,uBAAuB;;AAEvB;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;;AAEA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA,GAAG;AACH;;AAEA;AACA;AACA;AACA,GAAG;AACH;AACA,GAAG;AACH;AACA;AACA,KAAK;AACL;AACA,KAAK;AACL;AACA;;AAEA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA,KAAK;AACL;AACA,KAAK;AACL;AACA,KAAK;AACL;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,GAAG;AACH;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;;AAGA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA,iBAAiB,wBAAwB;AACzC;AACA;;AAEA;AACA;AACA,KAAK;AACL;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;;AAEA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA,GAAG;AACH;AACA,GAAG;AACH;AACA,GAAG;AACH;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA,KAAK;AACL,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;;AAEA;AACA,mBAAmB,6CAA6C;AAChE;AACA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;AACA,OAAO;AACP;AACA;AACA,OAAO;AACP;AACA;AACA;AACA,OAAO;AACP;AACA;AACA,SAAS;AACT;AACA,KAAK;AACL;AACA;AACA;;AAEA;AACA;;;AAGA;AACA;;AAEA;AACA;AACA,OAAO;AACP;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,KAAK;AACL;AACA,KAAK;AACL;;AAEA;AACA,CAAC;;AAED;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,GAAG;AACH;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,GAAG;AACH;AACA,GAAG;AACH;;AAEA;AACA;AACA,UAAU,MAAM;AAChB,UAAU,OAAO;AACjB;AACA,WAAW,QAAQ;AACnB;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA,KAAK;AACL,GAAG;;AAEH;AACA;AACA;AACA,KAAK;AACL,GAAG;;AAEH;AACA;AACA;AACA,GAAG;AACH;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,KAAK;AACL,GAAG;;AAEH;AACA;AACA;AACA,KAAK;AACL,GAAG;;AAEH;AACA;AACA,GAAG;AACH;AACA;AACA,GAAG;AACH;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,UAAU,MAAM;AAChB;AACA,WAAW,QAAQ;AACnB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,KAAK;AACL,GAAG;AACH;AACA;AACA,qBAAqB,YAAY;AACjC;AACA;AACA,KAAK;AACL;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA,GAAG;AACH;AACA,GAAG;AACH;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA,GAAG;AACH;AACA,GAAG;AACH;;AAEA;AACA;AACA,UAAU,IAAI;AACd;AACA,WAAW,QAAQ;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA,GAAG;;AAEH;AACA;AACA,GAAG;AACH;AACA,GAAG;AACH;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA;AACA,KAAK;AACL;;AAEA;AACA;AACA,GAAG;AACH;AACA,GAAG;AACH;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,GAAG;AACH;;AAEA;AACA,UAAU,SAAS;AACnB;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA,GAAG;AACH;AACA;AACA,GAAG;AACH;AACA;AACA,GAAG;AACH;AACA,GAAG;AACH;AACA,GAAG;AACH;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA,GAAG;AACH;AACA,GAAG;AACH;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA,GAAG;AACH;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,SAAS;AACT,OAAO;AACP;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA,GAAG;AACH;AACA;AACA,UAAU,SAAS;AACnB,UAAU,SAAS;AACnB;AACA,WAAW;AACX;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA,UAAU,SAAS;AACnB;AACA,WAAW;AACX;;;AAGA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,0BAA0B;AAC1B,KAAK;AACL;AACA,KAAK;AACL;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA,KAAK;AACL;AACA,KAAK;AACL;;AAEA;AACA,YAAY,SAAS;AACrB,aAAa;AACb;;;AAGA;AACA;AACA;;AAEA;AACA;AACA;AACA,OAAO;AACP,KAAK;AACL;AACA;AACA,OAAO;AACP,KAAK;AACL;;AAEA;AACA,CAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,GAAG;AACH;AACA,GAAG;AACH;AACA;AACA,KAAK;AACL;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA,CAAC;;;;AAID;;AAEA,4BAA4B;;AAE5B,OAAO;AACP;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;;;;AAIA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,uBAAuB,sBAAsB;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,qCAAqC;;AAErC;AACA;AACA;;AAEA,2BAA2B;AAC3B;AACA;AACA;AACA,4BAA4B,UAAU;;;AAGtC,OAAO;AACP;AACA;;AAEA;;AAEA;AACA;AACA;AACA,CAAC;;AAED;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;;AAEA;AACA;AACA,4CAA4C;;AAE5C;;;AAGA,OAAO;AACP;AACA;;AAEA;;AAEA,OAAO;AACP;AACA;;AAEA;AACA;AACA;AACA,+EAA+E,0CAA0C;AACzH;AACA;AACA;AACA;AACA;;;AAGA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,OAAO;AACtB,eAAe,OAAO;AACtB;AACA;AACA;AACA,eAAe,OAAO;AACtB;AACA,eAAe,OAAO;AACtB;AACA,eAAe,OAAO;AACtB;AACA;AACA;AACA;AACA;AACA,eAAe,SAAS;AACxB;AACA;AACA,eAAe,SAAS;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,kDAAkD;AAClD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,KAAK;;AAEL;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,8CAA8C;AAC9C;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;;AAEA,KAAK;;AAEL;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;;AAGA,OAAO;AACP;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;AAMA;;AAEA;AACA;AACA;AACA;AACA;AACA,eAAe,OAAO;AACtB;AACA;AACA;AACA;AACA,8CAA8C;AAC9C,yCAAyC;AACzC;AACA,0BAA0B,WAAW,GAAG,WAAW;AACnD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;;AAGA,OAAO;AACP;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;;;;;;AAOA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,QAAQ;AACnB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,QAAQ;AACnB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAsB,uBAAuB;AAC7C,sBAAsB,uBAAuB;AAC7C,sBAAsB;AACtB;AACA,+BAA+B;AAC/B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA,cAAc;AACd;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;;AAEA;;AAEA;AACA;AACA;AACA,SAAS;AACT;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA,KAAK;;AAEL;AACA;AACA;AACA,iBAAiB;AACjB;AACA;;AAEA;;AAEA;AACA;AACA;AACA,SAAS;AACT;AACA,SAAS;AACT;AACA;;AAEA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;;AAEA;;;AAGA,OAAO;AACP;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;AAOA;;AAEA;AACA;AACA;AACA;AACA,eAAe,OAAO;AACtB,eAAe,OAAO;AACtB,eAAe,OAAO;AACtB,eAAe,QAAQ;AACvB,eAAe,OAAO;AACtB,eAAe,OAAO;AACtB,eAAe,QAAQ;AACvB,eAAe,OAAO;AACtB,eAAe,OAAO;AACtB,eAAe,OAAO;AACtB,eAAe,OAAO;AACtB,eAAe,OAAO;AACtB,eAAe,OAAO;AACtB,eAAe,OAAO;AACtB,eAAe,OAAO;AACtB;AACA;AACA;AACA;AACA;AACA;AACA,0BAA0B,uBAAuB;AACjD,0BAA0B,uBAAuB;AACjD,0BAA0B;AAC1B;AACA,mCAAmC;AACnC;AACA;AACA;AACA;AACA;AACA,kBAAkB;AAClB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;;AAGA,OAAO;AACP;AACA;;AAEA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,SAAS;AACpB,WAAW,SAAS;AACpB;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,cAAc;AACd;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA,SAAS;AACT;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,KAAK;;AAEL;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kDAAkD;AAClD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;;AAEA;;AAEA;AACA;AACA;AACA,SAAS;AACT;AACA,SAAS;AACT;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA,KAAK;;AAEL;AACA;AACA;AACA,iBAAiB;AACjB;AACA;;AAEA;;AAEA;AACA;AACA,2CAA2C;;AAE3C;AACA;AACA;AACA,uBAAuB,gBAAgB;AACvC;AACA;AACA;AACA,yDAAyD;AACzD;AACA;AACA,aAAa;AACb;;AAEA;AACA,KAAK;;AAEL;AACA;AACA;AACA,eAAe,OAAO;AACtB,eAAe,OAAO;AACtB,eAAe,OAAO;AACtB,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA,eAAe,OAAO;AACtB;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;;AAEA;;;AAGA,OAAO;AACP;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;AASA;;AAEA;AACA;AACA;AACA;AACA;AACA,eAAe,OAAO;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA,aAAa;AACb;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA,6BAA6B;;AAE7B;AACA;AACA,6BAA6B;AAC7B;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA,yBAAyB;;AAEzB;AACA;AACA;AACA;AACA;AACA,6BAA6B;AAC7B;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,yBAAyB;AACzB;AACA;;AAEA;AACA;AACA,oCAAoC,UAAU;AAC9C;AACA;AACA;AACA;AACA,6BAA6B;AAC7B;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,+CAA+C,uBAAuB;AACtE;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qCAAqC;AACrC;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,6BAA6B;AAC7B;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,yBAAyB;AACzB;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;;AAGA,OAAO;AACP;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;AAMA;AACA;AACA;AACA;AACA,YAAY,OAAO;AACnB;AACA,cAAc,OAAO;AACrB;AACA;AACA;AACA;AACA;AACA,cAAc,OAAO;AACrB;AACA;AACA;AACA,cAAc,OAAO;AACrB;AACA;AACA,cAAc,OAAO;AACrB;AACA;AACA,cAAc,OAAO;AACrB;AACA;AACA,cAAc,OAAO;AACrB;AACA;AACA,cAAc,OAAO;AACrB;AACA;AACA,cAAc,OAAO;AACrB;AACA,cAAc,OAAO;AACrB;AACA,cAAc,OAAO;AACrB;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA,eAAe,WAAW;AAC1B;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA,2BAA2B,qBAAqB;AAChD;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA,eAAe,WAAW;AAC1B,gBAAgB,MAAM;AACtB;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA,2BAA2B,qBAAqB;AAChD;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA,eAAe,WAAW;AAC1B,eAAe,OAAO;AACtB;AACA;AACA;AACA;AACA;AACA,kDAAkD;AAClD;AACA,SAAS;AACT;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA,eAAe,WAAW;AAC1B,eAAe,OAAO;AACtB;AACA;AACA;AACA;AACA;AACA,kDAAkD;AAClD;AACA,SAAS;AACT;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA,eAAe,WAAW;AAC1B,eAAe,OAAO;AACtB;AACA;AACA;AACA;AACA;AACA,kDAAkD;AAClD;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA,eAAe,WAAW;AAC1B,eAAe,OAAO;AACtB;AACA;AACA;AACA;AACA;AACA,kDAAkD;AAClD;AACA,SAAS;AACT;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA,eAAe,WAAW;AAC1B,gBAAgB,OAAO;AACvB;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA,2BAA2B,qBAAqB;AAChD;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,KAAK;;AAEL;AACA;AACA;AACA,eAAe,WAAW;AAC1B,gBAAgB,OAAO;AACvB,aAAa,OAAO;AACpB,aAAa,OAAO;AACpB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,kDAAkD;AAClD;AACA;;AAEA;AACA,KAAK;;AAEL;AACA;AACA;AACA,eAAe,WAAW;AAC1B,gBAAgB,OAAO;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,qBAAqB;AAChD;AACA;AACA;AACA,wEAAwE;AACxE;AACA,8DAA8D;AAC9D;AACA;AACA;AACA;AACA,+EAA+E;AAC/E;AACA,8DAA8D;AAC9D;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA,WAAW,WAAW;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA,KAAK;AACL;AACA;AACA,KAAK;AACL;AACA;AACA;;AAEA;;;AAGA,OAAO;AACP;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;AAUA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA,WAAW,OAAO;AAClB;AACA,WAAW,OAAO;AAClB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0CAA0C;AAC1C,uCAAuC;AACvC;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,wCAAwC;AACxC;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,CAAC;;AAED;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,WAAW,SAAS;AACpB,WAAW,SAAS;AACpB;AACA;;AAEA;;AAEA;AACA;;AAEA,uCAAuC;AACvC;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA,yBAAyB,QAAQ,0BAA0B,aAAa;AACxE;AACA;AACA;AACA,KAAK;AACL;AACA;;AAEA;AACA;AACA;AACA;AACA,SAAS;AACT;;AAEA;AACA;;AAEA;AACA;AACA;AACA,WAAW,SAAS;AACpB,WAAW,SAAS;AACpB;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA,KAAK;AACL;AACA;;AAEA;;AAEA;;;AAGA,OAAO;AACP;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;AAOA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,OAAO;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;;AAEA,aAAa;;AAEb;;AAEA;AACA;AACA,qBAAqB;;AAErB;AACA;AACA,qBAAqB;AACrB;AACA;;AAEA;;AAEA,iBAAiB;;AAEjB;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;;AAEA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;;AAEA,SAAS;AACT;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;;AAEA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,OAAO;AACtB,eAAe,OAAO;AACtB,eAAe,OAAO;AACtB;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;;AAGA,OAAO;AACP;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;;AAkBA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA,SAAS;;AAET;AACA;AACA;AACA;AACA,8CAA8C;AAC9C;AACA,aAAa,6BAA6B;AAC1C;AACA;AACA,SAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;;AAET;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,2CAA2C,oBAAoB;AAC/D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;;AAEA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA,mCAAmC,qBAAqB;AACxD;AACA,mDAAmD;AACnD;AACA;AACA;AACA,6BAA6B;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA,iBAAiB;AACjB;AACA,iBAAiB;AACjB;AACA,iBAAiB;AACjB;AACA;AACA;AACA;;AAEA,KAAK;;AAEL;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wDAAwD;AACxD;AACA,iBAAiB,OAAO;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,yDAAyD;AACzD;;AAEA,qBAAqB,wCAAwC;AAC7D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,yBAAyB;AACzB;AACA;AACA;AACA;;AAEA,qBAAqB,OAAO;AAC5B;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,SAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,mCAAmC,+BAA+B;AAClE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA,SAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;;AAET;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,KAAK;;AAEL;AACA;AACA;AACA,qDAAqD;AACrD;AACA,aAAa,oDAAoD;AACjE;AACA;AACA,SAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4DAA4D;AAC5D;AACA,iBAAiB,qBAAqB;AACtC;AACA;AACA;AACA;AACA,iBAAiB,uDAAuD;AACxE;AACA;AACA;AACA,SAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4DAA4D;AAC5D;AACA,iBAAiB,qBAAqB;AACtC;AACA;AACA;AACA;AACA,iBAAiB,uDAAuD;AACxE;AACA;AACA;AACA;AACA,KAAK;;AAEL;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,SAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B,qBAAqB;AACpD;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA,qBAAqB;AACrB;AACA,qBAAqB;AACrB;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;;AAET;AACA;AACA;AACA;AACA;;AAEA,8CAA8C;AAC9C;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,uCAAuC,6BAA6B;AACpE;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA,aAAa,OAAO;AACpB;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;;AAET;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,SAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,qBAAqB;AAChD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,kDAAkD;AAClD;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA,WAAW,WAAW;AACtB,YAAY,OAAO;AACnB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA,KAAK;AACL;AACA;;AAEA,KAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,WAAW;AACtB,YAAY,OAAO;AACnB;AACA;AACA;AACA;AACA;AACA,uBAAuB,uBAAuB;AAC9C;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,WAAW;AACtB,WAAW,aAAa;AACxB;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA,uBAAuB,qBAAqB;AAC5C;;AAEA,uCAAuC;AACvC;AACA;;AAEA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,WAAW;AACtB,YAAY,OAAO;AACnB;AACA;;AAEA;AACA;;AAEA;AACA;AACA,iEAAiE;AACjE;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,WAAW;AACtB;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;;AAGA,OAAO;AACP;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;AASA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA,WAAW,OAAO;AAClB;AACA,WAAW,cAAc;AACzB;AACA;AACA;AACA,gBAAgB,OAAO;AACvB;AACA,gBAAgB,OAAO;AACvB;AACA,gBAAgB,OAAO;AACvB;AACA,gBAAgB,OAAO;AACvB;AACA;AACA,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB;AACA,gBAAgB,MAAM;AACtB,gBAAgB,MAAM;AACtB,gBAAgB,MAAM;AACtB,gBAAgB,MAAM;AACtB;AACA,WAAW,eAAe;AAC1B;AACA;AACA;AACA;AACA;AACA,WAAW,OAAO;AAClB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,OAAO;AAClB;AACA;AACA;AACA,WAAW,QAAQ;AACnB;AACA;AACA,WAAW,OAAO;AAClB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0CAA0C;AAC1C,uCAAuC;AACvC;AACA,sBAAsB,WAAW,GAAG,WAAW;AAC/C;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,KAAK;AACL;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,mBAAmB,mBAAmB;AACtC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;;AAED;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,WAAW,SAAS;AACpB,WAAW,SAAS;AACpB;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;AACA,WAAW,SAAS;AACpB,WAAW,SAAS;AACpB;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA,KAAK;AACL;AACA;;AAEA;;AAEA;;;AAGA,OAAO;AACP;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;AAUA;;AAEA;AACA;AACA;AACA;AACA;AACA,eAAe,OAAO;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB,OAAO;AACxB;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;;AAEA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;;;AAGA,OAAO;AACP;AACA;;AAEA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,SAAS;AACpB,WAAW,SAAS;AACpB;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,cAAc;AACd;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;;AAGA,OAAO;AACP;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,SAAS;AACpB,WAAW,SAAS;AACpB;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,cAAc;AACd;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT,KAAK;;AAEL;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;;AAGA,OAAO;AACP;AACA;;AAEA;AACA;AACA;AACA;;;;;AAKA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA6B;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,SAAS;AACpB,WAAW,SAAS;AACpB;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,cAAc;AACd;AACA;;AAEA;AACA;AACA,cAAc;AACd;AACA;;AAEA;AACA;AACA,cAAc;AACd;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,eAAe,OAAO;AACtB;AACA;;AAEA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA,eAAe,OAAO;AACtB;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,wCAAwC;;AAExC;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA,sCAAsC,yBAAyB;AAC/D;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;;AAGA,OAAO;AACP;AACA;;AAEA;AACA;;;;AAIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB;AAChB;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA,cAAc;AACd;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA,aAAa;AACb;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;;AAGA,OAAO;AACP;AACA;;AAEA;AACA;AACA;AACA;;;;;;AAMA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4CAA4C,SAAS;AACrD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,SAAS;AACpB,WAAW,SAAS;AACpB;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,cAAc;AACd;AACA;;AAEA;AACA;AACA,cAAc;AACd;AACA;;AAEA;AACA;AACA,cAAc;AACd;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,eAAe,OAAO;AACtB;AACA;;AAEA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA,eAAe,OAAO;AACtB;AACA;;AAEA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,4CAA4C;AAC5C;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;;AAGA,OAAO;AACP;AACA;;AAEA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA,cAAc;AACd;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,aAAa;AACb;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mCAAmC,sBAAsB;AACzD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;;;AAGA,OAAO;AACP;AACA;;AAEA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,OAAO;AAClB;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,cAAc;AACd;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA,cAAc;AACd;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,aAAa;AACb;AACA;;AAEA;AACA;AACA,qBAAqB,wBAAwB;AAC7C;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;;AAGA,OAAO;AACP;AACA;;AAEA;AACA;;;;AAIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA,cAAc;AACd;AACA;;AAEA;AACA;AACA,iFAAiF,yBAAyB,IAAI,OAAO;AACrH,uFAAuF,OAAO;AAC9F,wGAAwG,OAAO;AAC/G,2IAA2I,OAAO;AAClJ,6EAA6E,OAAO;AACpF,0CAA0C,OAAO;AACjD,mDAAmD,OAAO;AAC1D,gDAAgD,OAAO;AACvD,yDAAyD,OAAO;AAChE;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;;AAGA,OAAO;AACP;AACA;;AAEA;AACA;;;;AAIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA,cAAc;AACd;AACA;;AAEA;AACA;AACA,gFAAgF,yBAAyB,GAAG,OAAO;AACnH,mDAAmD,OAAO;AAC1D,4CAA4C,OAAO;AACnD,+EAA+E,OAAO;AACtF,4CAA4C,OAAO;AACnD,qDAAqD,OAAO;AAC5D,yEAAyE,OAAO;AAChF,wDAAwD,OAAO;AAC/D;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;;AAGA,OAAO;AACP;AACA;;AAEA;AACA;;;;AAIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,yCAAyC,OAAO;AAChD,sDAAsD,OAAO;AAC7D,yDAAyD,OAAO;AAChE,yDAAyD,OAAO;AAChE,0CAA0C,OAAO;AACjD,mDAAmD,OAAO;AAC1D,6CAA6C,OAAO;AACpD,sDAAsD,OAAO;AAC7D;AACA;AACA,uIAAuI,OAAO;AAC9I;AACA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;;AAGA,OAAO;AACP;AACA;;AAEA;AACA;;;;AAIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA,cAAc;AACd;AACA;;AAEA;AACA;AACA,+FAA+F,yBAAyB;AACxH,gFAAgF,OAAO;AACvF,uDAAuD,OAAO;AAC9D,6DAA6D,OAAO;AACpE,4DAA4D,OAAO;AACnE;AACA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;;AAGA,OAAO;AACP;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;AAOA;;AAEA;AACA;AACA;AACA;AACA;AACA,eAAe,OAAO;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,aAAa;;AAEb;;AAEA;AACA;AACA,qBAAqB;;AAErB;AACA;AACA,qBAAqB;AACrB;AACA;;AAEA;;AAEA;AACA;AACA;AACA,iBAAiB;;AAEjB;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;;AAGA,OAAO;AACP;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;AAQA;AACA;AACA;AACA;;AAEA;AACA,cAAc,OAAO;AACrB;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA,SAAS;;AAET;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA,SAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;;AAET;AACA;AACA;AACA;AACA;AACA,SAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA,iBAAiB;AACjB;AACA;AACA;AACA,SAAS;;AAET;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,iBAAiB;AACjB;AACA;AACA;AACA,SAAS;;AAET;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA,iBAAiB;AACjB,mDAAmD;AACnD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,iBAAiB;AACjB;;AAEA,iBAAiB;AACjB;;AAEA,iBAAiB;AACjB;;AAEA,iBAAiB;AACjB;;AAEA,iBAAiB;AACjB;;AAEA,iBAAiB;AACjB;;AAEA,iBAAiB;AACjB;;AAEA,iBAAiB;AACjB;;AAEA,iBAAiB;AACjB;;AAEA,iBAAiB;AACjB;;AAEA,iBAAiB;AACjB;;AAEA,iBAAiB;AACjB;;AAEA,iBAAiB;AACjB;;AAEA,iBAAiB;AACjB;AACA;AACA;;AAEA,iBAAiB;AACjB;;AAEA,iBAAiB;AACjB;;AAEA,iBAAiB;AACjB;;AAEA,iBAAiB;AACjB;;AAEA;AACA;AACA,SAAS;;AAET;AACA;AACA;AACA;AACA;AACA,SAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA,KAAK;;AAEL;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,qBAAqB;AAChD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,kDAAkD;AAClD;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA,WAAW,WAAW;AACtB,YAAY,OAAO;AACnB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,KAAK;AACL;AACA;;AAEA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,WAAW;AACtB,YAAY,OAAO;AACnB;AACA;AACA;AACA;AACA;AACA,uBAAuB,uBAAuB;AAC9C;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,WAAW;AACtB,WAAW,aAAa;AACxB;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA,uBAAuB,qBAAqB;AAC5C;;AAEA,uCAAuC;AACvC;AACA;;AAEA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,WAAW;AACtB,YAAY,OAAO;AACnB;AACA;;AAEA;AACA;;AAEA;AACA;AACA,sCAAsC;AACtC;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,WAAW;AACtB;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;;AAGA,OAAO;AACP;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;AASA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA,WAAW,OAAO;AAClB;AACA,WAAW,OAAO;AAClB,gBAAgB,MAAM;AACtB,gBAAgB,MAAM;AACtB;AACA,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB;AACA,gBAAgB,MAAM;AACtB,gBAAgB,MAAM;AACtB,gBAAgB,MAAM;AACtB,gBAAgB,MAAM;AACtB;AACA,WAAW,OAAO;AAClB;AACA,gBAAgB,MAAM;AACtB,gBAAgB,MAAM;AACtB,gBAAgB,MAAM;AACtB;AACA,WAAW,eAAe;AAC1B;AACA;AACA,WAAW,eAAe;AAC1B;AACA;AACA;AACA;AACA;AACA,WAAW,OAAO;AAClB;AACA;AACA,WAAW,OAAO;AAClB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0CAA0C;AAC1C,uCAAuC;AACvC;AACA,oBAAoB,UAAU;AAC9B;AACA,oBAAoB,yCAAyC;AAC7D;AACA;AACA;AACA;AACA,aAAa;AACb,0BAA0B,QAAQ,GAAG,QAAQ,GAAG,QAAQ,GAAG,QAAQ,GAAG,QAAQ,GAAG,QAAQ;AACzF;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,mBAAmB,mBAAmB;AACtC;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,oBAAoB;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;;AAED;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,WAAW,SAAS;AACpB,WAAW,SAAS;AACpB;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,WAAW,SAAS;AACpB,WAAW,SAAS;AACpB;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA,KAAK;AACL;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;;;AAGA,OAAO;AACP;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;AAKA;;AAEA;AACA;AACA;AACA;AACA;AACA,eAAe,OAAO;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB,OAAO;AACxB;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA,SAAS;;AAET;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;;;AAGA,OAAO;AACP;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;AAOA;;AAEA;AACA;AACA;AACA;AACA;AACA,eAAe,OAAO;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,aAAa;;AAEb;;AAEA;AACA;AACA,qBAAqB;;AAErB;AACA;AACA,qBAAqB;AACrB;AACA;;AAEA;;AAEA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,uCAAuC,2BAA2B;AAClE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;;AAGA,OAAO;AACP;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;AAQA;AACA;AACA,YAAY,OAAO;AACnB;AACA,cAAc,OAAO;AACrB;AACA,cAAc,OAAO;AACrB;AACA,cAAc,OAAO;AACrB;AACA,cAAc,OAAO;AACrB;AACA,cAAc,OAAO;AACrB;AACA;AACA;AACA;AACA;AACA,cAAc,OAAO;AACrB;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA,SAAS;;AAET;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA,SAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA,iBAAiB;AACjB;AACA;AACA;AACA,SAAS;;AAET;AACA;AACA;AACA;AACA;;AAEA;AACA,aAAa;AACb;AACA;AACA,SAAS;;AAET;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA,iBAAiB;AACjB,mDAAmD;AACnD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,iBAAiB;AACjB;;AAEA,iBAAiB;AACjB;;AAEA,iBAAiB;AACjB;;AAEA,iBAAiB;AACjB;;AAEA,iBAAiB;AACjB;;AAEA,iBAAiB;AACjB;;AAEA,iBAAiB;AACjB;;AAEA,iBAAiB;AACjB;;AAEA,iBAAiB;AACjB;;AAEA,iBAAiB;AACjB;;AAEA,iBAAiB;AACjB;;AAEA,iBAAiB;AACjB;;AAEA,iBAAiB;AACjB;;AAEA,iBAAiB;AACjB;AACA;AACA;;AAEA,iBAAiB;AACjB;;AAEA,iBAAiB;AACjB;;AAEA,iBAAiB;AACjB;;AAEA,iBAAiB;AACjB;;AAEA;AACA;AACA,SAAS;;AAET;AACA;AACA;AACA;AACA;AACA,SAAS;;AAET;AACA;AACA;AACA;AACA;AACA,SAAS;;AAET;AACA;AACA,wDAAwD,UAAU;AAClE;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA,KAAK;;AAEL;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,qBAAqB;AAChD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,kDAAkD;AAClD;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA,WAAW,WAAW;AACtB,YAAY,OAAO;AACnB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,KAAK;AACL;AACA;;AAEA,KAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,WAAW;AACtB,YAAY,OAAO;AACnB;AACA;AACA;AACA;AACA;AACA,uBAAuB,uBAAuB;AAC9C;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,WAAW;AACtB,WAAW,aAAa;AACxB;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA,uBAAuB,qBAAqB;AAC5C;;AAEA,uCAAuC;AACvC;AACA;;AAEA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,WAAW;AACtB,YAAY,OAAO;AACnB;AACA;;AAEA;AACA;;AAEA;AACA;AACA,sCAAsC;AACtC;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,WAAW;AACtB;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;;AAGA,OAAO;AACP;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;AAQA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA,WAAW,OAAO;AAClB;AACA,WAAW,OAAO;AAClB;AACA;AACA;AACA,WAAW,eAAe;AAC1B;AACA;AACA;AACA;AACA,WAAW,eAAe;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,OAAO;AAClB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0CAA0C;AAC1C,uCAAuC;AACvC;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,wCAAwC;AACxC;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,CAAC;;AAED;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,WAAW,SAAS;AACpB,WAAW,SAAS;AACpB;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,kEAAkE;AAClE;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;;AAEA;AACA;AACA;AACA;AACA,WAAW,SAAS;AACpB,WAAW,SAAS;AACpB;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA,KAAK;AACL;AACA;;AAEA;;AAEA;;;AAGA,OAAO;AACP;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;AAQA;;AAEA;AACA;AACA;AACA;AACA;AACA,eAAe,OAAO;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;;AAEA,aAAa;;AAEb;AACA;AACA;AACA,iBAAiB;AACjB;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB;AACzB;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA,uCAAuC,iCAAiC;AACxE;AACA;;AAEA;;AAEA;AACA;AACA;AACA,iCAAiC;AACjC;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA,qBAAqB;AACrB;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;;AAGA,OAAO;AACP;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;AAUA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb,WAAW,OAAO;AAClB;AACA,WAAW,OAAO;AAClB;AACA;AACA,WAAW,OAAO;AAClB;AACA;AACA;AACA;AACA;AACA,WAAW,OAAO;AAClB;AACA;AACA;AACA;AACA,WAAW,OAAO;AAClB,WAAW,MAAM;AACjB,WAAW,MAAM;AACjB;AACA,WAAW,OAAO;AAClB,WAAW,MAAM;AACjB,WAAW,MAAM;AACjB;AACA,WAAW,SAAS,wCAAwC,gBAAgB;AAC5E,qEAAqE;AACrE;AACA,WAAW,OAAO;AAClB;AACA;AACA;AACA,WAAW,SAAS;AACpB;AACA;AACA;AACA,WAAW,QAAQ;AACnB;AACA;AACA,WAAW,QAAQ;AACnB;AACA;AACA,WAAW,OAAO;AAClB;AACA;AACA,WAAW,OAAO;AAClB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0CAA0C;AAC1C,uCAAuC;AACvC;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,uDAAuD;AACvD,yDAAyD;AACzD;AACA;AACA,kFAAkF;AAClF,2DAA2D;AAC3D;AACA,0CAA0C;AAC1C;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,gDAAgD;AAChD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;;AAED;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,WAAW,SAAS;AACpB,WAAW,SAAS;AACpB;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,WAAW,SAAS;AACpB,WAAW,SAAS;AACpB;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA,KAAK;AACL;AACA;;AAEA;;AAEA;;;AAGA,OAAO;AACP;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;AAMA;;AAEA;AACA;AACA;AACA;AACA;AACA,eAAe,OAAO;AACtB;AACA;AACA;AACA;AACA;AACA,8CAA8C;AAC9C,yCAAyC;AACzC;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB;AACxB;AACA;AACA,2BAA2B;AAC3B,UAAU;AACV;AACA;AACA,iBAAiB,OAAO;AACxB;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;;AAGA,OAAO;AACP;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;AAKA;;AAEA;AACA;AACA;AACA;AACA;AACA,eAAe,OAAO;AACtB;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB,OAAO;AACxB;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;;AAGA,OAAO;AACP;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;;;;;AAMA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN,MAAM;AACN,MAAM;AACN,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA,aAAa;AACb;AACA;AACA,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,SAAS;AACpB,WAAW,SAAS;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,SAAS;AACT;AACA,aAAa,qBAAqB;AAClC,aAAa,qBAAqB;AAClC,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;;AAED;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,WAAW,OAAO;AAClB;AACA;;AAEA;AACA;AACA;AACA,KAAK;AACL;AACA;;AAEA;;AAEA;AACA;AACA;AACA,WAAW,OAAO;AAClB;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,aAAa;AACb;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;;AAGA,OAAO;AACP;AACA;;AAEA;AACA;AACA;;;;AAIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,SAAS;AACpB,WAAW,SAAS;AACpB;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,cAAc;AACd;AACA;;AAEA;AACA;AACA,cAAc;AACd;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA,eAAe,OAAO;AACtB;AACA;;AAEA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;;AAGA,OAAO;AACP;AACA;;AAEA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,OAAO;AAClB;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA,cAAc;AACd;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA,iBAAiB;AACjB;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,2BAA2B,sCAAsC;AACjE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,kCAAkC;AAC7D;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,SAAS;AACT;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;;;AAGA,OAAO;AACP;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA,OAAO;AACP;AACA;;AAEA;AACA;AACA;AACA;;;;;;AAMA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,OAAO;AAClB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,cAAc;AACd;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,uBAAuB,mBAAmB;AAC1C;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;;;AAGA,OAAO;AACP;AACA;;AAEA;AACA;;;;AAIA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,OAAO;AAClB;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA,gEAAgE;;AAEhE;AACA;;AAEA;AACA;;AAEA,oFAAoF;AACpF;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,2BAA2B;AAClD;AACA;AACA;;AAEA,4BAA4B;AAC5B,KAAK;;AAEL;AACA;AACA;AACA;AACA,sCAAsC;AACtC;AACA;;AAEA;AACA;AACA;AACA,aAAa;AACb;AACA;;AAEA;;AAEA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA,SAAS;AACT;;AAEA;AACA;AACA;AACA;AACA,SAAS;AACT;;AAEA;AACA;AACA;AACA;AACA,SAAS;AACT;;AAEA;AACA;AACA;AACA;AACA,SAAS;AACT;;AAEA;AACA;AACA;AACA;AACA,SAAS;AACT;;AAEA;AACA;AACA;AACA;AACA,SAAS;AACT;;AAEA;AACA;;AAEA;;;AAGA,OAAO;AACP;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;AAWA;;AAEA;AACA;AACA;AACA;AACA;AACA,eAAe,OAAO;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA,aAAa;AACb;;AAEA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA,6BAA6B;;AAE7B;AACA;AACA;AACA,6BAA6B;AAC7B;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA,yBAAyB;AACzB;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,yBAAyB;AACzB;AACA;;AAEA;AACA;AACA,oCAAoC;AACpC;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,2EAA2E;AAC3E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,+CAA+C,oBAAoB;AACnE;AACA;AACA;AACA;AACA,+CAA+C,iBAAiB;AAChE;AACA;AACA;AACA;AACA,+CAA+C,qBAAqB;AACpE;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mDAAmD,wBAAwB;AAC3E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qCAAqC;AACrC;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,6CAA6C;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iCAAiC;AACjC;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;;AAGA,OAAO;AACP;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;AASA;AACA;AACA,YAAY,OAAO;AACnB;AACA,cAAc,OAAO;AACrB;AACA;AACA;AACA;AACA;AACA,cAAc,OAAO;AACrB;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;;AAEA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA,yDAAyD;AACzD;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA,2BAA2B,qBAAqB;AAChD;;AAEA,2CAA2C;AAC3C;;AAEA;AACA;AACA,qBAAqB;AACrB;AACA,qBAAqB;AACrB;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA,KAAK;AACL;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,WAAW;AACtB,YAAY,OAAO;AACnB;AACA;;AAEA;AACA;;AAEA;AACA;AACA,kDAAkD;AAClD;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,WAAW;AACtB,WAAW,aAAa;AACxB;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA,uBAAuB,qBAAqB;AAC5C;;AAEA,uCAAuC;AACvC;;AAEA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;;AAEA;;;AAGA,OAAO;AACP;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;AAIA;AACA;AACA,YAAY,OAAO;AACnB;AACA,cAAc,OAAO;AACrB;AACA;AACA;AACA;AACA;AACA,cAAc,OAAO;AACrB;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,+JAA+J,gCAAgC,6BAA6B,gCAAgC;AAC5P;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,WAAW,WAAW;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;;AAGA,OAAO;AACP;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;AAUA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA,WAAW,OAAO;AAClB;AACA,WAAW,OAAO;AAClB;AACA;AACA;AACA;AACA,WAAW,OAAO;AAClB;AACA,gBAAgB,MAAM;AACtB,gBAAgB,MAAM;AACtB;AACA,WAAW,OAAO;AAClB;AACA;AACA;AACA;AACA,WAAW,OAAO;AAClB;AACA;AACA,WAAW,eAAe;AAC1B;AACA;AACA;AACA,WAAW,OAAO;AAClB;AACA;AACA;AACA,WAAW,MAAM;AACjB;AACA;AACA;AACA,WAAW,MAAM;AACjB;AACA;AACA;AACA,WAAW,QAAQ;AACnB;AACA;AACA,WAAW,QAAQ;AACnB;AACA;AACA,WAAW,QAAQ;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0CAA0C;AAC1C,uCAAuC;AACvC;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,oDAAoD;AACpD;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,gDAAgD;AAChD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;;AAED;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,WAAW,SAAS;AACpB,WAAW,SAAS;AACpB;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA,KAAK;AACL;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA,WAAW,SAAS;AACpB,WAAW,SAAS;AACpB;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA,KAAK;;AAEL;AACA;AACA;;AAEA;;;AAGA,OAAO;AACP;AACA;;AAEA;AACA;AACA;AACA;;;;;;AAMA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,OAAO;AAClB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,cAAc;AACd;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,cAAc;AACd;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA,2BAA2B,mBAAmB;AAC9C;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA,+BAA+B,qCAAqC;AACpE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;;;AAGA,OAAO;AACP;AACA;;AAEA;AACA;;;;AAIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,OAAO;AAClB;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,oDAAoD;AACpD,wDAAwD;;AAExD;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA,sCAAsC;AACtC;AACA;;AAEA;AACA;AACA;AACA,aAAa;AACb;AACA;;AAEA;;AAEA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA,SAAS;AACT;;AAEA;AACA;AACA;AACA;AACA,SAAS;AACT;;AAEA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA,SAAS;AACT;;AAEA;AACA;AACA;AACA;AACA,SAAS;AACT;;AAEA;AACA;;AAEA;;;AAGA,OAAO;AACP;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;AASA;;AAEA;AACA;AACA;AACA;AACA;AACA,eAAe,OAAO;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;;AAEA,aAAa;AACb;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA,6BAA6B;;AAE7B;AACA;AACA;AACA,6BAA6B;AAC7B;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA,yBAAyB;;AAEzB;AACA;AACA;AACA;AACA;AACA;AACA,6BAA6B;AAC7B;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,yBAAyB;AACzB;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qCAAqC;AACrC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA6B;AAC7B;AACA;AACA;;AAEA,yBAAyB;AACzB;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;;AAEA;AACA,SAAS;AACT;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;;AAGA,OAAO;AACP;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;AAQA;AACA;AACA;AACA,YAAY,OAAO;AACnB;AACA,cAAc,OAAO;AACrB;AACA;AACA;AACA;AACA;AACA,cAAc,OAAO;AACrB;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA,2BAA2B,qBAAqB;AAChD;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,qBAAqB;AAChD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,qBAAqB;AAChD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,kDAAkD;AAClD;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA,KAAK;AACL;AACA;;AAEA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;;AAEA,KAAK;AACL;AACA;AACA;AACA,SAAS;AACT;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,WAAW;AACtB,YAAY,OAAO;AACnB;AACA;;AAEA;AACA;;AAEA;AACA;AACA,kDAAkD;AAClD;AACA;AACA;AACA;AACA;;AAEA;;;AAGA,OAAO;AACP;AACA,CAAC;AACD,0C;;;;;;;;;;;;AC5okBA,IAAIM,aAAa;;AAEb;;;AAGAC,sCAAkC,0CAASC,gBAAT,EAA2BC,GAA3B,EAAgC;;AAE9D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,YAAIC,qBAAqB,EAAzB;AACA,gBAAQD,GAAR;AACI,iBAAK,WAAL;AACIC,qCAAqB;AACjB,uBAAG,gBADc;AAEjB,uBAAG,gBAFc;AAGjB,uBAAG,gBAHc;AAIjB,uBAAG,aAJc;AAKjB,uBAAG,eALc;AAMjB,uBAAG,eANc;AAOjB,uBAAG,eAPc;AAQjB,uBAAG,aARc;AASjB,uBAAG,cATc;AAUjB,uBAAG,cAVc;AAWjB,wBAAI,cAXa;AAYjB,wBAAI,aAZa;AAajB,wBAAI,aAba;AAcjB,wBAAI,aAda;AAejB,wBAAI,WAfa;AAgBjB,wBAAI,YAhBa;AAiBjB,wBAAI,YAjBa;AAkBjB,wBAAI,YAlBa;AAmBjB,wBAAI,YAnBa;AAoBjB,wBAAI,YApBa;AAqBjB,wBAAI,YArBa;AAsBjB,wBAAI;AAtBa,iBAArB;A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L,IAAIM,GAAJ,CAAQL,YAAR;AAHP,KAAP;AAKH,CAPD;;kBASetK,iB;;;;;;AC3uBf;AACA;AACA;AACA;AACA,CAAC,qBAAqB;;AAEtB;AACA;AACA;AACA;;AAEA;AACA,yCAAyC;AACzC;AACA;AACA;AACA;;AAEA;AACA;AACA,mBAAmB;AACnB,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,2BAA2B;AAC3B,oCAAoC;AACpC,kCAAkC;AAClC,qCAAqC;AACrC,oCAAoC;AACpC,kCAAkC;AAClC,iCAAiC;AACjC,sCAAsC;AACtC,oCAAoC;AACpC,+BAA+B;AAC/B,uCAAuC;AACvC,+BAA+B;AAC/B,kCAAkC;;AAElC;AACA,QAAQ,iBAAiB;AACzB,aAAa;AACb;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA,IAAI,IAAI;AACR;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA,MAAM;AACN;AACA;AACA,MAAM;AACN;AACA;AACA,MAAM;AACN;AACA;AACA,MAAM;AACN;AACA;AACA,MAAM;AACN;AACA;AACA,MAAM;AACN;AACA;AACA,MAAM;AACN;AACA;AACA,MAAM;AACN;AACA;AACA,MAAM;AACN;AACA;AACA,MAAM;AACN;AACA;AACA,MAAM;AACN;AACA;AACA,MAAM;AACN;AACA;AACA,MAAM;AACN;AACA;AACA,MAAM;AACN;AACA;AACA,MAAM;AACN;AACA;AACA,MAAM;AACN;AACA;AACA,MAAM;AACN;AACA;AACA,MAAM;AACN;AACA;AACA;AACA,QAAQ;AACR,MAAM;AACN;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA,MAAM;AACN;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,uBAAuB;;AAEvB;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA,IAAI;AACJ;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ;AACR;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ;AACR;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,4J;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,kBAAkB,SAAS;AAC3B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA,kBAAkB;AAClB,kBAAkB;AAClB,2BAA2B;AAC3B;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ,uBAAuB;AACvB;AACA,4BAA4B;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY;AACZ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,IAAI;AACJ;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,aAAa;AACb;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,sBAAsB;AACtB,yBAAyB;;AAEzB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,kBAAkB;AAClB,IAAI;AACJ;AACA;AACA;AACA,IAAI;AACJ;AACA,IAAI;AACJ;AACA,IAAI;AACJ,iBAAiB;AACjB;AACA,EAAE;;AAEF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8BAA8B;;AAE9B,UAAU;AACV,eAAe;AACf,gBAAgB;AAChB,eAAe;;AAEf;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA,IAAI;AACJ;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;;AAEF;AACA;AACA;AACA;AACA;AACA;;AAEA,SAAS;AACT,UAAU;AACV,UAAU;AACV,UAAU;AACV;AACA;AACA,UAAU;AACV,aAAa;AACb,aAAa;AACb,YAAY;AACZ,YAAY;AACZ,aAAa;AACb,YAAY;;AAEZ;AACA;AACA,2BAA2B;AAC3B;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;;AAEF;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;;AAEF;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,kBAAkB;AAClB;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,cAAc,OAAO;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mCAAmC;AACnC;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI,OAAO;AACX;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ;AACR;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,KAAK,IAAI;AACT;AACA;;AAEA;AACA;AACA;AACA;AACA,KAAK,OAAO;AACZ;AACA;;AAEA;AACA;AACA;AACA;AACA,KAAK,OAAO;AACZ;AACA;;AAEA,YAAY;AACZ,YAAY;AACZ,YAAY;AACZ,YAAY;AACZ,YAAY;AACZ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,OAAO;AACnB;AACA,YAAY,IAAI;AAChB;AACA,aAAa,OAAO;AACpB;AACA;AACA,4BAA4B;AAC5B;AACA;AACA;AACA,IAAI;AACJ;;AAEA;AACA;AACA;AACA,YAAY,OAAO;AACnB,aAAa,MAAM;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,OAAO;AACnB,aAAa,OAAO;AACpB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,YAAY,OAAO;AACnB,aAAa,OAAO;AACpB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,YAAY,OAAO;AACnB;AACA,aAAa,OAAO;AACpB;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB,+BAA+B;AAC/B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,+CAA+C;AAC/C;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA,+BAA+B;AAC/B;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,OAAO;AACnB;AACA;AACA;AACA,aAAa,OAAO;AACpB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,qBAAqB;AACrB,+BAA+B;AAC/B;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;;AAEA;AACA,+CAA+C;AAC/C;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,YAAY,OAAO;AACnB;AACA,aAAa,KAAK;AAClB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,YAAY,OAAO;AACnB;AACA,YAAY,OAAO;AACnB,aAAa,OAAO;AACpB;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,YAAY,OAAO;AACnB,YAAY,OAAO;AACnB,YAAY,OAAO;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,YAAY,OAAO;AACnB,aAAa,OAAO;AACpB;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,YAAY,OAAO;AACnB;AACA;AACA,YAAY,OAAO;AACnB;AACA;AACA,YAAY,OAAO;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,YAAY,OAAO;AACnB,aAAa,OAAO;AACpB;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,KAAK;AACjB,YAAY,OAAO;AACnB,aAAa,OAAO;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,KAAK;AACjB,YAAY,OAAO;AACnB;AACA,aAAa,OAAO;AACpB;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0BAA0B;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,KAAK;AACjB,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA,yBAAyB,GAAG,OAAO;AACnC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,2BAA2B,OAAO;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA,kBAAkB;AAClB,kBAAkB;AAClB,iBAAiB;AACjB,iBAAiB;AACjB,kBAAkB;AAClB,kBAAkB;AAClB,uBAAuB;AACvB,wBAAwB;;AAExB;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gCAAgC;AAChC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,kBAAkB,QAAQ;AAC1B;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;;AAGA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,kBAAkB,SAAS;AAC3B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,sBAAsB;AACtB,YAAY;AACZ,cAAc;AACd,WAAW;AACX;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA,UAAU;AACV;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAkB,QAAQ;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA,wCAAwC;AACxC;AACA;AACA;AACA;AACA;AACA,2EAA2E;AAC3E;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,GAAG;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,2BAA2B,GAAG;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA,mBAAmB;;AAEnB;AACA,cAAc,SAAS;AACvB;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,mBAAmB;AACnB;AACA;;AAEA;AACA;AACA,cAAc,QAAQ;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,kBAAkB;AAClB;AACA;;AAEA;AACA;AACA,cAAc,QAAQ;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,kBAAkB,qBAAqB;AACvC;AACA;AACA;AACA;;AAEA;AACA;AACA,gBAAgB,QAAQ;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,gBAAgB,QAAQ;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,mBAAmB;;AAEnB;AACA,cAAc,QAAQ;AACtB;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B,GAAG;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,sBAAsB;AACtB;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA,UAAU;AACV;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,iBAAiB;;AAEjB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,sBAAsB;AACtB,YAAY;AACZ,cAAc;AACd,WAAW;AACX;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,UAAU;AACV,SAAS;AACT,kBAAkB;AAClB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,IAAI;AACJ;AACA,IAAI;AACJ;AACA,IAAI;AACJ;AACA,IAAI;AACJ;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,SAAS;AACT,eAAe;;AAEf;AACA;;AAEA;AACA;AACA;AACA,uBAAuB;AACvB;AACA,IAAI;AACJ;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA,MAAM;AACN;AACA;AACA,MAAM;AACN;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA,MAAM;AACN;AACA;AACA,MAAM;AACN;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;;AAEA;AACA;AACA,MAAM;AACN;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA,MAAM;AACN;AACA;AACA,MAAM;AACN;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,IAAI;AACJ;AACA,IAAI;AACJ;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,eAAe;;AAEf;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA,IAAI;AACJ;AACA;AACA,IAAI;AACJ;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA,MAAM;AACN;AACA,MAAM;AACN;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA,MAAM;AACN;AACA,MAAM;AACN;AACA,MAAM;AACN;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA,MAAM;AACN;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA,MAAM;AACN;AACA;AACA,MAAM;AACN;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,gCAAgC;AAChC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA,CAAC;;;;;;;;;;;;;ACtrMD,IAAI4K,SAAS;;AAET;AACA5L,mBAAe,IAHN;;AAKT;;;;;AAKAL,oBAAgB,0BAAW;;AAEvB,YAAIyB,QAAQ,OAAOjI,MAAP,KAAkB,WAAlB,GAAgCA,MAAhC,GAAyC,EAArD;AA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B;AACA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA,QAAQ;AACR;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA,GAAG;;AAEH;AACA;;AAEA;AACA,6BAA6B;AAC7B;;AAEA;AACA;AACA;AACA;AACA,IAAI;;AAEJ;AACA;AACA;;;;AAIA;AACA;AACA,aAAa,YAAY;AACzB,aAAa,OAAO;AACpB;AACA;AACA;AACA,4DAA4D;AAC5D;;AAEA,eAAe;AACf,qCAAqC;;;AAGrC;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA,WAAW;AACX;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,YAAY;AACZ;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA,YAAY;AACZ;AACA;;;AAGA;AACA;AACA;;;AAGA;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,KAAK;AACL;AACA;AACA;AACA,GAAG;;AAEH;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA,IAAI;AACJ;AACA,GAAG;;AAEH;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;;AAEA;AACA;;AAEA,sBAAsB;AACtB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,GAAG;;;AAGH;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;;AAGA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA,qBAAqB;AACrB;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,QAAQ;AACR;AACA;AACA,OAAO;AACP;AACA;;AAEA;AACA;AACA;AACA,QAAQ;AACR;AACA;AACA;;AAEA,mCAAmC;;AAEnC;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA,uBAAuB;;AAEvB;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA,GAAG;;AAEH;AACA;;AAEA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,GAAG;;;AAGH;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;;;AAGH;AACA;AACA,eAAe;AACf;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,SAAS,OAAO;AAChB;AACA;AACA;AACA;AACA;;AAEA;AACA,GAAG;;;AAGH;AACA;AACA,cAAc,SAAS;AACvB;AACA;AACA,iBAAiB;;AAEjB;AACA;;AAEA;AACA;AACA;AACA,IAAI;;AAEJ;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ,GAAG;;;AAGH;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;;;AAGH;AACA;AACA,eAAe,YAAY;AAC3B,eAAe,OAAO;AACtB,eAAe;AACf;AACA;AACA;AACA,GAAG;;;AAGH;AACA;AACA,eAAe,OAAO;AACtB,eAAe,EAAE;AACjB,eAAe;AACf;AACA;AACA;;AAEA;AACA;AACA,IAAI;AACJ;;AAEA;AACA;AACA;AACA;AACA,GAAG;;;AAGH;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,IAAI;;AAEJ;;AAEA;;AAEA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;;;AAGA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;;AAGA;AACA;AACA;;AAEA;AACA,UAAU,OAAO;AACjB;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;;;AAIA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;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,QAAIhnC,QAAQyI,EAAE3V,MAAF,CAASkB,OAAT,CAAiBiJ,GAAjB,EAAsB+C,KAAlC;;AAEA,SAAK4kC,uBAAL,GAA+B5kC,KAA/B;;AAEA;AACA,QAAI,CAAC,KAAK2iC,UAAV,EAAsB;AAClB,aAAKC,WAAL;AACH;AACJ,CAXD;;kBAaeV,a;;;;;;ACnvCf;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AACA,KAAK;AACL;AACA,KAAK;AACL;AACA;AACA,CAAC;AACD;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,yBAAyB;AACzB,SAAS;AACT;AACA,SAAS;AACT;AACA,SAAS;AACT;AACA;AACA;;AAEA;;AAEA;AACA;AACA,uBAAuB,uBAAuB;AAC9C;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA,WAAW;;AAEX;AACA;AACA;AACA,qEAAqE;AACrE,WAAW;AACX;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA,WAAW;;AAEX;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0CAA0C;AAC1C;AACA,eAAe;AACf;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA,qBAAqB;AACrB;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,sCAAsC;AACtC;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA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","file":"GpPluginOlItowns-src.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"openlayers\"), require(\"xmldom\"), require(\"request\"), require(\"itowns\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"Gp\", [\"ol\", \"require\", \"require\", \"itowns\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"Gp\"] = factory(require(\"openlayers\"), require(\"xmldom\"), require(\"request\"), require(\"itowns\"));\n\telse\n\t\troot[\"Gp\"] = factory(root[\"ol\"], root[undefined], root[undefined], root[\"itowns\"]);\n})(typeof self !== 'undefined' ? self : this, function(__WEBPACK_EXTERNAL_MODULE_1__, __WEBPACK_EXTERNAL_MODULE_15__, __WEBPACK_EXTERNAL_MODULE_47__, __WEBPACK_EXTERNAL_MODULE_35__) {\nreturn \n\n\n// WEBPACK FOOTER //\n// webpack/universalModuleDefinition"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 45);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 452a9316dedb75bbe8cb","var Utils = {\n\n    /**\n     * this method is called by the constructor.\n     * this information is useful to switch to touch mode.\n     * Detection : test for desktop or tactile\n     *\n     * @returns {Boolean} isDesktop - true for desktop userAgent, false for mobile\n     */\n    detectSupport: function() {\n\n        var isDesktop = true;\n        var userAgent = window.navigator.userAgent.toLowerCase();\n\n        if (userAgent.indexOf(\"iphone\") !== -1 ||\n            userAgent.indexOf(\"ipod\") !== -1 ||\n            userAgent.indexOf(\"ipad\") !== -1 ||\n            userAgent.indexOf(\"android\") !== -1 ||\n            userAgent.indexOf(\"mobile\") !== -1 ||\n            userAgent.indexOf(\"blackberry\") !== -1 ||\n            userAgent.indexOf(\"tablet\") !== -1 ||\n            userAgent.indexOf(\"phone\") !== -1 ||\n            userAgent.indexOf(\"touch\") !== -1) {\n            isDesktop = false;\n        }\n\n        if (userAgent.indexOf(\"msie\") !== -1 ||\n            userAgent.indexOf(\"trident\") !== -1) {\n            isDesktop = true;\n        }\n\n        return isDesktop;\n    },\n\n    /**\n     *  Copies all source object members to dest\n     *\n     * @param {Object} dest - destination object where properties and method will be copied\n     * @param {Object} source - source object from which properties and method will be copied\n     * @returns {Object} dest\n     */\n    assign: function(dest, source) {\n        dest = dest || {};\n        for (var prop in source) {\n            if (source.hasOwnProperty(prop)) {\n                dest[prop] = source[prop];\n            }\n        }\n        return dest;\n    },\n\n    /**\n     * Merge two objects parameters (deeper than assign)\n     *\n     * @param {Object} dest   - destination object where properties and method will be merge\n     * @param {Object} source - source object from which properties and method will be merge\n     */\n    mergeParams: function(dest, source) {\n        if (!dest || !source) {\n            return;\n        }\n        for (var param in source) {\n            if (source.hasOwnProperty(param)) {\n                if (typeof source[param] === \"object\") {\n                    if (dest.hasOwnProperty(param)) {\n                        this.mergeParams(dest[param], source[param]);\n                    } else {\n                        dest[param] = source[param];\n                    }\n                } else {\n                    dest[param] = source[param];\n                }\n            }\n        }\n    }\n};\n\nexport default Utils;\n\n\n\n// WEBPACK FOOTER //\n// ./src/Common/Utils.js","module.exports = __WEBPACK_EXTERNAL_MODULE_1__;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external {\"commonjs\":\"openlayers\",\"commonjs2\":\"openlayers\",\"amd\":\"ol\",\"root\":\"ol\"}\n// module id = 1\n// module chunks = 0","/**\n * formalisme d'un tag ID :\n * -> NAME(_ORDER)-1460636385836\n *\n * Ex.\n *   GProutePoints-1460636385836\n *   GProutePoint_10-1460636385836\n */\nvar SelectorID = {\n\n    /**\n     * Construction d'un identifiant statique bas sur le timestamp,\n     * et qui s'incremente de +1  chaque appel\n     */\n    generate: (function() {\n        var timestamp = Math.floor(Date.now());\n        return function() {\n            return timestamp++;\n        };\n    })(),\n\n    /** nom du tag */\n    name: function(id) {\n        var name = null;\n\n        var i = id.lastIndexOf(\"-\");\n        if (i === -1) {\n            name = id;\n        } else {\n            name = id.substring(0, i);\n        }\n\n        return name;\n    },\n\n    /** numero d'identifiant du tag */\n    index: function(id) {\n        var index = null;\n\n        var name = this.name(id);\n        // if (name !== id) {\n        var i = name.lastIndexOf(\"_\");\n        if (i !== -1) {\n            index = name.substring(i + 1);\n        }\n        // }\n\n        return index;\n    },\n\n    /** uuid du tag */\n    uuid: function(id) {\n        var uuid = null;\n\n        var i = id.lastIndexOf(\"-\");\n        if (i !== -1) {\n            uuid = parseInt(id.substring(i + 1), 10);\n        }\n\n        return uuid;\n    }\n\n};\n\nexport default SelectorID;\n\n\n\n// WEBPACK FOOTER //\n// ./src/Common/Utils/SelectorID.js","/* global __PRODUCTION__ */\nimport * as Log from \"loglevel\";\n\nvar LoggerByDefault = {\n    /** logger statique */\n    getLogger : function (name) {\n        // Substitute global constants configured at compile time\n        // cf. webpack.config.js\n        ( __PRODUCTION__ ) ?\n            Log.disableAll() : Log.enableAll();\n        var logname = name || \"default\";\n        return Log.getLogger(logname);\n    }\n};\n\nexport default LoggerByDefault;\n\n\n\n// WEBPACK FOOTER //\n// ./src/Common/Utils/LoggerByDefault.js","/*!\n * @brief Geoportal resources access library\n *\n * This software is released under the licence CeCILL-B (Free BSD compatible)\n * @see http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt\n * @see http://www.cecill.info/licences/Licence_CeCILL-B_V1-fr.txt\n * @see http://www.cecill.info/\n *\n * copyright CeCILL-B\n * copyright IGN\n * @author IGN\n * @version 2.0.0\n * @date 2018-03-05\n *\n */\n/*!\n * @overview es6-promise - a tiny implementation of Promises/A+.\n * @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors (Conversion to ES6 API by Jake Archibald)\n * @license   Licensed under MIT license\n *            See https://raw.githubusercontent.com/stefanpenner/es6-promise/master/LICENSE\n * @version   v4.2.4\n */\n\n(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"xmldom\"), require(\"request\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"Gp\", [\"require\", \"require\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"Gp\"] = factory(require(\"xmldom\"), require(\"request\"));\n\telse\n\t\troot[\"Gp\"] = factory(root[undefined], root[undefined]);\n})(typeof self !== 'undefined' ? self : this, function(__WEBPACK_EXTERNAL_MODULE_20__, __WEBPACK_EXTERNAL_MODULE_52__) {\nreturn /******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId]) {\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/ \t\t}\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\ti: moduleId,\n/******/ \t\t\tl: false,\n/******/ \t\t\texports: {}\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.l = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// define getter function for harmony exports\n/******/ \t__webpack_require__.d = function(exports, name, getter) {\n/******/ \t\tif(!__webpack_require__.o(exports, name)) {\n/******/ \t\t\tObject.defineProperty(exports, name, {\n/******/ \t\t\t\tconfigurable: false,\n/******/ \t\t\t\tenumerable: true,\n/******/ \t\t\t\tget: getter\n/******/ \t\t\t});\n/******/ \t\t}\n/******/ \t};\n/******/\n/******/ \t// getDefaultExport function for compatibility with non-harmony modules\n/******/ \t__webpack_require__.n = function(module) {\n/******/ \t\tvar getter = module && module.__esModule ?\n/******/ \t\t\tfunction getDefault() { return module['default']; } :\n/******/ \t\t\tfunction getModuleExports() { return module; };\n/******/ \t\t__webpack_require__.d(getter, 'a', getter);\n/******/ \t\treturn getter;\n/******/ \t};\n/******/\n/******/ \t// Object.prototype.hasOwnProperty.call\n/******/ \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(__webpack_require__.s = 43);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_loglevel__ = __webpack_require__(47);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_loglevel___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_loglevel__);\n/* global __PRODUCTION__ */\n\n\nvar LoggerByDefault = {\n    /** logger statique */\n    getLogger : function (name) {\n        // Substitute global constants configured at compile time\n        // cf. webpack.config.js\n        (  false ) ?\n            Log.disableAll() : __WEBPACK_IMPORTED_MODULE_0_loglevel__[\"enableAll\"]();\n        var logname = name || \"default\";\n        return __WEBPACK_IMPORTED_MODULE_0_loglevel__[\"getLogger\"](logname);\n    }\n};\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (LoggerByDefault);\n\n\n/***/ }),\n/* 1 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/**\n * Classe de gestion des erreurs qui permer d'associer un message d'erreur  l'exception lance.\n *\n * @example\n * MessagesResources.getMessage(\"ERROR_PARAM_MISSING\", \"x\", \"y\", \"z\")));\n * // --> output : Parameter(s) 'x - y - z' missing\n *\n * @module MessagesResources\n * @alias Gp.Utils.MessagesResources\n * @private\n */\nvar MessagesResources = {\n\n    // Paramtres\n    PARAM_MISSING : \"Parameter(s) '%var%' missing\",\n    PARAM_EMPTY : \"Parameter(s) '%var%' empty\",\n    PARAM_TYPE : \"Wrong type(s) for parameter(s) '%var%'\",\n    PARAM_FORMAT : \"Parameter(s) '%var%' not correctly formatted\",\n    PARAM_NOT_SUPPORT : \"Value(s) for parameter(s) '%var%' not supported\",\n    PARAM_NOT_SUPPORT_NODEJS : \"Value(s) for parameter(s) '%var%' not supported to NodeJS\",\n    PARAM_UNKNOWN : \"Value(s) for parameter(s) '%var%' unknown\",\n\n    // Services\n    // Requte\n    SERVICE_REQUEST_BUILD : \"An error occurred during the request building of the service\",\n    SERVICE_REQUEST_EMPTY : \"The request sent to the service is empty\",\n\n    // Rponse\n    SERVICE_RESPONSE_EXCEPTION : \"The service returned an exception : '%var%'\",\n    SERVICE_RESPONSE_EXCEPTION_2 : \"The service returned an exception\",\n    SERVICE_RESPONSE_ANALYSE : \"An error occurred while parsing the response '%var%' of the service\",\n    SERVICE_RESPONSE_ANALYSE_2 : \"An unknown error occurred while parsing the response\",\n    SERVICE_RESPONSE_EMPTY : \"The response of the service is empty\",\n    SERVICE_RESPONSE_EMPTY_2 : \"The response from the service could not be analyzed or is empty\",\n    SERVICE_RESPONSE_FORMAT : \"The format of the service response is not supported (handled format(s) : '%var%')\",\n    SERVICE_RESPONSE_FORMAT_2 : \"The format of the service response is not supported\",\n    SERVICE_RESPONSE_FORMAT_3 : \"No suggestion matching the search\",\n\n    // Classes\n    CLASS_CONSTRUCTOR : \"'%var%' constructor cannot be called as a function.\",\n\n    /**\n     * Fonction qui va retourner le message d'erreur associ  la cl donne\n     *\n     * @method getMessage\n     * @param {String} clef - Clef de l'erreur (ex : ERROR_PARAM)\n     * @param {String[]} parametres - Paramtres/variables concerns par le message d'erreur associ  la clef donne\n     * @return {String} message - String contenant le message de l'exception\n     */\n    getMessage : function (clef, parametres) {\n        // param de la fonction uniquement pour la documentation...\n\n        if (Object.keys(arguments).length === 0) {\n            return \"Message indefined !\";\n        }\n\n        var params = Array.prototype.slice.call(arguments);\n        var key = params.shift();\n        var args = params;\n\n        var message = this[key];\n\n        try {\n            if (Array.isArray(args) && args.length > 0) {\n                message = message.replace(\"%var%\", args.join(\" - \"));\n            } else {\n                message = message.replace(\"%var%\", \"%var% (not specified)\");\n            }\n        } catch (e) {\n            // error de string.replace()\n\n        }\n\n        return message;\n    }\n};\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (MessagesResources);\n\n\n/***/ }),\n/* 2 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/**\n * Errors raised by API for one among three reasons : wrong API usage, underlying service error or unknown reason.\n *\n * @property {String} message - Error message\n * @property {Number} status - Error status : when {@link Gp.Error.TYPE_SRVERR}, gives the [HTTP status of the underlying web service response]{@link https://en.wikipedia.org/wiki/List_of_HTTP_status_codes} ; -1 otherwise.\n * @property {String} type - Error type ({@link Gp.Error.TYPE_SRVERR}, {@link Gp.Error.TYPE_USEERR} or {@link Gp.Error.TYPE_UNKERR}).\n *\n * @namespace\n * @alias Gp.Error\n * @param {Object|String} error - Options for creating error object. Can be a String (message) or an Object.\n * @param {String} error.message - Error message to return to user.\n * @param {enum} [error.type=TYPE_UNKERR] - Error type\n * @param {status} [error.status=-1] - Error status : when {@link Gp.Error.TYPE_SRVERR}, gives the [HTTP status of the underlying web service response]{@link https://en.wikipedia.org/wiki/List_of_HTTP_status_codes}.\n *\n */\nfunction ErrorService (error) {\n\n    if (!(this instanceof ErrorService)) {\n        throw new TypeError(\"ErrorService constructor cannot be called as a function.\");\n    }\n\n    var e = error;\n    if ( typeof error === \"string\" || error instanceof String) {\n        this.message = error;\n        this.status = -1;\n        this.type = ErrorService.TYPE_UNKERR;\n    } else {\n        this.message = e.message || \"undefined!?\";\n        this.type = e.type;\n        this.status = e.status || -1;\n    }\n\n    this.name = \"ErrorService\";\n    this.stack = (new Error()).stack;\n}\n\n/**\n * Error raised when underlying geoportal service answers on error.\n *\n * @type {String}\n * @constant\n * @static\n */\nErrorService.TYPE_SRVERR = \"SERVICE_ERROR\";\n/**\n * Error raised when funcion use is inappropriate\n *\n * @type {String}\n * @constant\n * @static\n */\nErrorService.TYPE_USEERR = \"USAGE_ERROR\";\n/**\n * Error raised when API can't perform the job for a reason other than the two other ones.\n *\n * @type {String}\n * @constant\n * @static\n */\nErrorService.TYPE_UNKERR = \"UNKNOWN_ERROR\";\n\n/**\n * @lends module:ErrorService#\n */\nErrorService.prototype = Object.create(Error.prototype, {\n    constructor : {\n        value : ErrorService,\n        writable : true,\n        configurable : true\n    }\n});\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (ErrorService);\n\n\n/***/ }),\n/* 3 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__Utils_Helper__ = __webpack_require__(5);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__Utils_MessagesResources__ = __webpack_require__(1);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__Protocols_Protocol__ = __webpack_require__(48);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__Exceptions_ErrorService__ = __webpack_require__(2);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__DefaultUrlService__ = __webpack_require__(6);\n/**\n * desativation du contrle cf. l. 254 (fonction call ())\n * Possible strict violation. (W040)\n */\n\n\n\n\n\n\n\n\n/**\n * @classdesc\n * Composant Service\n *\n * @constructor\n * @alias Gp.Services.CommonService\n * @param {Object} options - options communes  tous les services\n *\n * @param {String} options.apiKey - Clef d'accs  la plateforme Goportail,\n *      ncessaire pour franchir la couche de contrle des accs pour avoir une rponse du service invoqu.\n *      Plusieurs clefs peuvent tre passes dans le cas de l'invocation du service d'autoconfiguration.\n *      Si ce paramtre n'est pas renseign, alors le paramtre serverUrl doit tre renseign (comprenant alors, si ncessaire la clef API).\n *\n * @param {String} options.serverUrl - URL d'accs au service.\n *      Permet de forcer l'utilisation d'un service quivalent dploy derrire une ventuelle autre URL d'accs.\n *      Si ce paramtre est renseign alors, le paramtre apiKey est ignor.\n *\n * @param {String} [options.protocol] - Le protocole  utiliser pour rcuprer les informations du service :\n *      peut valoir 'JSONP' ou 'XHR'.\n *      Par dfaut, c'est le protocole XHR qui sera utilis.\n *      Attention, le protocole JSONP n'est pas valide dans un environnement NodeJS (Utilisation du mode XHR).\n *\n * @param {Boolean} [options.ssl] - Indique si l'on souhaite intrroger les services en https.\n *      Ce paramtre ne fonctionne que pour une utilisation hors navigateur (ex. NodeJS).\n *      Sur un navigateur, le protocole est automatiquement extrait de l'url du site...\n *      Par dfaut, on utilise le protocole http (ssl=false).\n *\n * @param {String} [options.proxyURL] - Le proxy  utiliser pour pallier au problme de cross-domain dans le cas d'une requte XHR.\n *      Utile si le paramtre 'protocol' vaut 'XHR', il ne sera pas pris en compte si protocol vaut JSONP.\n *\n * @param {String} [options.callbackSuffix] - Suffixe de la fonction de callback  utiliser, dans le cas du protocole JSONP.\n *      Par dfaut, la fonction de callback portera un nom du type \"callback\"+ID, o ID est soit un identifiant unique gnr  chaque requte,\n *      soit le paramtre callbackSuffix s'il est spcifi. Par exemple, si callbackSuffix=\"_2\", la fonction sera \"callback_2 ()\".\n *      Utile pour utiliser une rponse dj encapsule dans une fonction de callback, dont le nom est connu (ex : chargement de l'autoconfiguration en local)\n *      Utile seulement si le paramtre 'protocol' vaut 'JSONP', il ne sera pas pris en compte si protocol vaut 'XHR'.\n *\n * @param {String} [options.httpMethod] - La mthode HTTP\n *       utiliser dans le cas d'une requte XHR : peut valoir 'GET' ou 'POST'.\n *      Non pris en compte si 'protocol' vaut JSONP qui fonctionne obligatoirement en GET.\n *      Par dfaut, c'est la mthode GET qui est utilise.\n *\n * @param {String} [options.contentType] - Content-Type de la requete\n *       utiliser dans le cas d'une requte XHR en mode POST.\n *      Non pris en compte si 'protocol' vaut JSONP et/ou la mthode HTTP vaut GET.\n *      Par dfaut, c'est la mthode GET qui est utilise donc on n'utilise pas de Content-Type.\n *\n * @param {Number} [options.timeOut] - Dlai d'attente maximal (en ms) de la rponse du service ( partir de l'envoi de la requte).\n *      Par dfaut, aucun timeOut n'est pris en compte (timeoutDelay= 0).\n *\n * @param {Boolean} [options.rawResponse] - Indique si l'on souhaite que la rponse du service ne soit pas parse par l'API avant d'tre restitue.\n *      (Cf. paramtre  onSuccess  pour plus de dtails).\n *\n * @param {Function} [options.onSuccess] - Fonction appele lorsque le service rpond correctement  la requte\n *      (code HTTP 200, sans message d'erreur).\n *      Cette fonction prend en paramtre la rponse du service,\n *      soit sous la forme d'un Object Javascript format par le parseur ddi  la syntaxe du service (comportement par dfaut) ;\n *      soit brute au format String non prtrait si le paramtre  rawResponse  a t prcis avec la valeur  true .\n *\n * @param {Function} [options.onFailure] - Fonction appele lorsque le service ne rpond pas correctement\n *      (code HTTP de retour diffrent de 200 ou pas de rponse).\n *\n * @param {Function} [options.onBeforeParse] - Fonction appele avant le parsing de la rponse\n *      Permet de modifier la rponse avant parsing si la fonction retourne une String.\n *      Cette fonction prend en paramtre la rponse XML telle que renvoye par le service,\n *      sous la forme d'une chane de caractres (comportement par dfaut).\n *      Si le paramtre \"rawResponse\" a t prcis avec la valeur \"true\",\n *      la fonction prend en paramtre un Object JavaScript contenant la rponse XML.\n *\n * @example\n *   var options = {\n *      apiKey : null,\n *      serverUrl : 'http://localhost/service/',\n *      protocol : 'JSONP', // JSONP|XHR\n *      ssl : false,\n *      proxyURL : null,\n *      callbackName : null,\n *      httpMethod : 'GET', // GET|POST\n *      timeOut : 10000, // ms\n *      rawResponse : false, // true|false\n *      scope : null, // this\n *      onSuccess : function (response) {},\n *      onFailure : function (error) {},\n *      onBeforeParse : function (rawResponse) {}\n *   };\n * @private\n */\nfunction CommonService (options) {\n\n    if (!(this instanceof CommonService)) {\n        throw new TypeError(__WEBPACK_IMPORTED_MODULE_2__Utils_MessagesResources__[\"a\" /* default */].getMessage(\"CLASS_CONSTRUCTOR\"));\n    }\n\n    this.logger = __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__[\"a\" /* default */].getLogger(\"CommonService\");\n    this.logger.trace(\"[Constructeur CommonService (options)]\");\n\n    // #####################\n    // rcupration des options par dfaut pour les paramtres optionnels\n    // #####################\n\n    /**\n     * Options du service\n     * @type {Object}\n     */\n    this.options = {\n        // protocol : \"JSONP\",\n        protocol : \"XHR\",\n        ssl : false,\n        proxyURL : \"\",\n        // callbackName : \"\",\n        callbackSuffix : null,\n        httpMethod : \"GET\",\n        timeOut  : 0,\n        rawResponse : false,\n        scope : this,\n        /** callback par defaut pour la reponse */\n        onSuccess : function (response) {\n            console.log(\"onSuccess - la reponse est la suivante : \", response);\n        },\n        /** callback par defaut pour les erreurs */\n        onFailure : function (error) {\n            if (error.status === 200 || !error.status) {\n                console.log(\"onFailure : \", error.message);\n            } else {\n                console.log(\"onFailure - Erreur (\", error.status, \") : \", error.message);\n            }\n        }\n    };\n\n    // et on ajoute les options en paramtre aux options par dfaut\n    for (var opt in options) {\n        if (options.hasOwnProperty(opt)) {\n            this.options[opt] = options[opt];\n        }\n    }\n\n    // #####################\n    // analyse des options\n    // #####################\n\n    // gestion des clefs API\n    if (!this.options.apiKey && !this.options.serverUrl) {\n        throw new Error(__WEBPACK_IMPORTED_MODULE_2__Utils_MessagesResources__[\"a\" /* default */].getMessage(\"PARAM_MISSING\", \"apiKey\", \"serverUrl\"));\n    }\n\n    // modification de la fonction de callback onSuccess dans le cas o la rponse brute est demande\n    if (this.options.rawResponse && !this.options.onSuccess) {\n        /** callback onSuccess par defaut */\n        this.options.onSuccess = function (response) {\n            console.log(\"onSuccess - la rponse brute du service est la suivante : \", response);\n        };\n    }\n\n    // gestion du callback onSuccess\n    var bOnSuccess = (this.options.onSuccess !== null && typeof this.options.onSuccess === \"function\") ? true : false;\n    if (!bOnSuccess) {\n        throw new Error(__WEBPACK_IMPORTED_MODULE_2__Utils_MessagesResources__[\"a\" /* default */].getMessage(\"PARAM_MISSING\", \"onSuccess()\"));\n    }\n\n    // gestion de l'url du service par defaut\n    if (!this.options.serverUrl) {\n        // INFO\n        // gestion de l'url du service par defaut pour les services qui ne possdent qu'une seul url par defaut\n        // les cas particuliers des services avec plusieurs urls (ex. Alti) devront tre trait dans la classe du composant\n        // donc si l'url n'est pas renseigne, il faut utiliser les urls par defaut\n        __WEBPACK_IMPORTED_MODULE_5__DefaultUrlService__[\"a\" /* default */].ssl = this.options.ssl;\n        var urlByDefault = __WEBPACK_IMPORTED_MODULE_5__DefaultUrlService__[\"a\" /* default */][this.CLASSNAME].url(this.options.apiKey);\n        if ( typeof urlByDefault === \"string\") {\n            this.options.serverUrl = urlByDefault;\n        } else {\n            this.logger.trace(\"URL par defaut  determiner au niveau du composant...\");\n        }\n    }\n\n    // FIXME nettoyage des KVP dans l'url du service\n    // if (this.options.serverUrl) {\n    //     // INFO\n    //     // si l'url est renseigne, il faut la nettoyer de tous ses KVP\n    //     // ex. on ne veut pas de params. 'callback' ou 'output' car ceci declencherait\n    //     // des oprations d'encapsulations des reponses lgrement farfelues ...\n    //     var urlsource = this.options.serverUrl;\n    //     var urlparts = urlsource.split(\"?\");\n    //     this.options.serverUrl = urlparts[0];\n    // }\n\n    // gestion de la methode HTTP\n    this.options.httpMethod = ( typeof options.httpMethod === \"string\") ? options.httpMethod.toUpperCase() : \"GET\";\n\n    switch (this.options.httpMethod) {\n        case \"POST\":\n        case \"GET\":\n            break;\n        case \"PUT\":\n        case \"DELETE\":\n        case \"HEAD\":\n        case \"OPTIONS\":\n            throw new Error(__WEBPACK_IMPORTED_MODULE_2__Utils_MessagesResources__[\"a\" /* default */].getMessage(\"PARAM_NOT_SUPPORT\", \"httpMethod\"));\n        default:\n            throw new Error(__WEBPACK_IMPORTED_MODULE_2__Utils_MessagesResources__[\"a\" /* default */].getMessage(\"PARAM_UNKNOWN\", \"httpMethod\"));\n    }\n\n    // gestion du protocole\n    // this.options.protocol = ( typeof options.protocol === \"string\" ) ? options.protocol.toUpperCase() : \"JSONP\";\n    this.options.protocol = ( typeof options.protocol === \"string\") ? options.protocol.toUpperCase() : \"XHR\";\n\n    switch (this.options.protocol) {\n        case \"JSONP\":\n        case \"XHR\":\n            break;\n        default:\n            throw new Error(__WEBPACK_IMPORTED_MODULE_2__Utils_MessagesResources__[\"a\" /* default */].getMessage(\"PARAM_UNKNOWN\", \"protocol\"));\n    }\n\n    // on determine l'environnement d'execution : browser ou non ?\n    // et on lance une exception sur l'utilisation du protocole JSONP pour nodeJS...\n    if ( typeof window === \"undefined\" && this.options.protocol === \"JSONP\") {\n        throw new Error(__WEBPACK_IMPORTED_MODULE_2__Utils_MessagesResources__[\"a\" /* default */].getMessage(\"PARAM_NOT_SUPPORT_NODEJS\", \"protocol=JSONP (instead use XHR)\"));\n    }\n\n    // le protocole JSONP ne fonctionne qu'en GET.\n    if (this.options.protocol === \"JSONP\") {\n        this.options.httpMethod = \"GET\";\n    }\n\n    // gestion du cache\n    this.options.nocache = options.nocache || false;\n\n    // #####################\n    // attributs d'instances\n    // #####################\n\n    /**\n     * Format de rponse du service\n     */\n    this.options.outputFormat = null;\n    /**\n     * Requte envoye au service\n     */\n    this.request = null;\n    /**\n     * Reponse du service\n     */\n    this.response = null;\n}\n\n/**\n * @lends module:CommonService\n */\nCommonService.prototype = {\n\n    /*\n     * Constructeur (alias)\n     */\n    constructor : CommonService,\n\n    /**\n     * Appel du service Goportail\n     */\n    call : function () {\n\n        /* jshint validthis : true */\n        this.logger.trace(\"CommonService::call ()\");\n\n        /** fonction d'execution */\n        function run () {\n            this.logger.trace(\"CommonService::run ()\");\n            this.buildRequest.call(this, onError, onBuildRequest);\n        }\n\n        run.call(this);\n\n        /** callback de fin de construction de la requte */\n        function onBuildRequest (result) {\n            this.logger.trace(\"CommonService::onBuildRequest : \", result);\n            this.callService.call(this, onError, onCallService);\n        }\n\n        /** callback de fin d'appel au service */\n        function onCallService (result) {\n            this.logger.trace(\"CommonService::onCallService : \", result);\n            this.analyzeResponse.call(this, onError, onAnalyzeResponse);\n        }\n\n        /** callback de fin de lecture de la reponse */\n        function onAnalyzeResponse (result) {\n            this.logger.trace(\"CommonService::onAnalyzeResponse : \", result);\n            if (result) {\n                this.options.onSuccess.call(this, result);\n            } else {\n                return onError.call(this, new __WEBPACK_IMPORTED_MODULE_4__Exceptions_ErrorService__[\"a\" /* default */](\"Analyse de la reponse en chec !?\"));\n            }\n        }\n\n        /** callback de gestion des erreurs : renvoit un objet de type ErrorService */\n        function onError (error) {\n            this.logger.trace(\"CommonService::onError()\");\n            // error : l'objet est du type ErrorService ou Error\n            var e = error;\n            if (!(e instanceof __WEBPACK_IMPORTED_MODULE_4__Exceptions_ErrorService__[\"a\" /* default */])) {\n                e = new __WEBPACK_IMPORTED_MODULE_4__Exceptions_ErrorService__[\"a\" /* default */](error.message);\n            }\n            this.options.onFailure.call(this, e);\n        }\n\n    },\n\n    /**\n     * Cration de la requte\n     */\n    buildRequest : function (error, success) {\n        // INFO\n        // retourne l'objet 'this.request'\n        // error.call(this, \"This method must be overwritten !\");\n        this.logger.error(\"overwritten method !\");\n    },\n\n    /**\n     * Appel du service\n     */\n    callService : function (error, success) {\n        // INFO\n        // retourne l'objet 'this.response'\n\n        // NOTES\n        //  Pour le mode XHR, on recupre une reponse sous forme d'une string. Le content\n        //  est donc du JSON natif ou du XML en fonction du service demand (pas d'encapsulation !).\n        //  Pour le mode JSONP, on a toujours un objet JSON mais sous 2 formats :\n        //      - natif\n        //      - XML encapsul :\n        //          {http : {status:200, error:null},xml :'rponse du service'}\n        //          {http : {status:400, error:'reponse du service'},xml :null}\n        //  En XHR, la reponse est directement sauvegarde dans 'this.response'.\n        //  Par contre, en JSONP, on doit analyser la reponse (status ou non vide),\n        //  et ne renvoyer que le contenu (xml ou l'objet)\n\n        // gestion de la proxification du service\n        var strUrlProxified = null;\n        var strData = this.request;\n\n        // a t on mis en place un proxy ?\n        // la proxyfication est valable uniquement en mode XHR !\n        var bUrlProxified = (this.options.proxyURL && this.options.protocol === \"XHR\") ? true : false;\n\n        // rajout de l'option gpbibaccess\n        // FIXME : acces au numero de version de package.conf\n        /*\n        var scope = typeof window !== \"undefined\" ? window : {};\n        var servicesVersion = scope.Gp ? scope.Gp.servicesVersion : \"2.0.0\";\n        */\n        this.options.serverUrl = __WEBPACK_IMPORTED_MODULE_1__Utils_Helper__[\"a\" /* default */].normalyzeUrl(this.options.serverUrl, {\n            \"gp-access-lib\" : \"2.0.0\"\n        }, false);\n\n        // si le proxy est renseign, on proxifie l'url du service\n        if (bUrlProxified) {\n            if (this.options.httpMethod === \"GET\") {\n                strUrlProxified = this.options.proxyURL + __WEBPACK_IMPORTED_MODULE_1__Utils_Helper__[\"a\" /* default */].normalyzeUrl(this.options.serverUrl, this.request, true);\n                strData = null;\n            }\n\n            if (this.options.httpMethod === \"POST\") {\n                strUrlProxified = this.options.proxyURL + __WEBPACK_IMPORTED_MODULE_1__Utils_Helper__[\"a\" /* default */].normalyzeUrl(this.options.serverUrl, null, true);\n                strData = this.request;\n            }\n        }\n\n        // contexte du composant spcifique !\n        var self = this;\n\n        var options = {\n            url : strUrlProxified || this.options.serverUrl,\n            method : this.options.httpMethod,\n            protocol : this.options.protocol,\n            timeOut : this.options.timeOut || 0,\n            format : this.options.outputFormat, // ceci declenche le parsing de la reponse du service, mais on souhaite toujours une reponse brute (string) !\n            nocache : this.options.nocache || false, // ceci permet d'ajouter un timestamp dans la requte\n            wrap : (this.options.protocol === \"XHR\") ? false : true, // ceci declenche l'encapsulation de la reponse XML du service dans du JSON, mais pas en mode XHR !\n            callbackSuffix : this.options.callbackSuffix,\n            // callbackName : this.options.callbackName || null,\n            data : strData,\n            headers : null, // TODO...\n            content : this.options.contentType || \"application/xml\",\n            scope : this.options.scope || this,\n            /** callback de reponse */\n            onResponse : function (response) {\n                self.logger.trace(\"callService::onResponse()\");\n\n                // le contenu de la reponse  renvoyer !\n                var content = null;\n\n                // XHR : on renvoie la reponse brute (string)\n                if (self.options.protocol == \"XHR\") {\n                    // on ne peut pas savoir si la reponse est en XML ou JSON\n                    // donc on laisse le boulot  l'analyse de la reponse !\n                    content = response;\n                }\n\n                // JSONP : on doit analyser le contenu (json)\n                if (self.options.protocol == \"JSONP\") {\n                    self.logger.trace(\"Response JSON\", response);\n                    if (response) {\n                        // reponse encapsule : {http : {status:200, error:null},xml :'rponse du service'}\n                        if (response.http) {\n                            if (response.http.status !== 200) {\n                                error.call(self, new __WEBPACK_IMPORTED_MODULE_4__Exceptions_ErrorService__[\"a\" /* default */]({\n                                    status : response.http.status,\n                                    message : response.http.error,\n                                    type : __WEBPACK_IMPORTED_MODULE_4__Exceptions_ErrorService__[\"a\" /* default */].TYPE_SRVERR\n                                }));\n                                return;\n                            } else {\n                                content = response.xml; // par defaut !\n                                if (self.options.rawResponse) {\n                                    content = response;\n                                }\n                                if ( typeof self.options.onBeforeParse === \"function\") {\n                                    var newResponse = self.options.onBeforeParse(content);\n                                    if ( typeof newResponse === \"string\") {\n                                        content = newResponse;\n                                    }\n                                }\n                            }\n                        } else {\n                            content = response;\n                        }\n                    } else {\n                        error.call(self, new __WEBPACK_IMPORTED_MODULE_4__Exceptions_ErrorService__[\"a\" /* default */](\"Le contenu de la reponse est vide !?\"));\n                        return;\n                    }\n                }\n\n                // sauvegarde de la reponse dans l'objet parent (CommonService)\n                self.response = content;\n\n                // on renvoie la reponse...\n                success.call(self, content);\n            },\n            /** callback des erreurs */\n            onFailure : function (e) {\n                self.logger.trace(\"callService::onFailure()\");\n                // on est forcement sur une erreur leve par un service !\n                e.type = __WEBPACK_IMPORTED_MODULE_4__Exceptions_ErrorService__[\"a\" /* default */].TYPE_SRVERR;\n                error.call(self, new __WEBPACK_IMPORTED_MODULE_4__Exceptions_ErrorService__[\"a\" /* default */](e));\n            },\n            /** callback de timeOut */\n            onTimeOut : function () {\n                self.logger.trace(\"callService::onTimeOut()\");\n                error.call(self, new __WEBPACK_IMPORTED_MODULE_4__Exceptions_ErrorService__[\"a\" /* default */](\"TimeOut!\"));\n            }\n        };\n\n        __WEBPACK_IMPORTED_MODULE_3__Protocols_Protocol__[\"a\" /* default */].send(options);\n\n    },\n\n    /**\n     * Analyse de la rponse\n     */\n    analyzeResponse : function (error, success) {\n        // INFO\n        // retourne l'objet spcifique au type de composant (json)\n        // error.call(this, \"This method must be overwritten !\");\n        this.logger.error(\"overwritten method !\");\n    }\n\n};\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (CommonService);\n\n\n/***/ }),\n/* 4 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__ = __webpack_require__(0);\n\n/* global exports, require */\n\n\n// import __xmldom from \"xmldom\";\n\n/**\n * @classdesc\n *\n * Classe permettant d'crire ou de lire du XML, sous forme de document DOM,\n * ventuellement selon des cls de lecture (readers) ou d'criture (writers) spcifiques.\n *\n * @constructor\n * @alias Gp.Formats.XML\n *\n * @param {Object} [options] - options du format XML\n *\n * @param {Object} [options.reader] - Instance d'un Reader de service (AltiResponseReader, GeocodeRequestReader, etc.)\n *      utile pour interprter le XML lorsque sa structure est connue.\n *      Ce reader doit comporter au moins une fonction statique read (root) permettant d'initialiser la lecture.\n *\n * @param {Object} [options.writers] - writers\n *\n * @param {String} [options.xmlString] - chane de caractre contenant du XML  interprter.\n *\n * @private\n */\nfunction XML (options) {\n\n    if (!(this instanceof XML)) {\n        throw new TypeError(\"XML constructor cannot be called as a function.\");\n    }\n\n    // FIXME : notion de singleton\n\n    this.logger = __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__[\"a\" /* default */].getLogger();\n    this.logger.trace(\"[Constructeur XML ()]\");\n\n    /**\n     * Chane de caractres contenant le texte XML\n     * @type {String}\n     */\n    this.xmlString = null;\n\n    /**\n     * DOM Element correspondant  la structure du XML.\n     * @type {DOMElement}\n     */\n    this.xmlDoc = null;\n\n    /**\n     * Objet contenant des fonctions de lecture des diffrentes balises XML.\n     * @type {Object}\n     */\n    this.reader = null;\n\n    // traitement des paramtres d'options s'il y en a\n    if (options) {\n        if (options.xmlString && typeof options.xmlString === \"string\") {\n            this.xmlString = options.xmlString;\n            // Si une chaine de caractre a t passe en entre : on la transforme aussi en XML document\n            this.xmlDoc = __getXMLDOC(options.xmlString);\n        }\n        if (options.reader) {\n            this.setReader(options.reader);\n        }\n    }\n}\n\nXML.prototype = {\n\n    /**\n     * @lends module:XML\n     */\n\n    /*\n     * Constructeur (alias)\n     */\n    constructor : XML,\n\n    /**\n     * Mthode permettant de rcuprer la chane de caractres associe au format XML\n     *\n     * @returns {String} xmlString - la chane de caractres correspondant au format XML\n     */\n    getXMLString : function () {\n        return this.xmlString;\n    },\n\n    /**\n     * Mthode permettant d'attribuer une chane de caractres au format XML (attribut xmlString).\n     * La mthode va aussi transformer cette chane de caractres en document XML,\n     * afin de remplir l'attribut xmlDoc.\n     *\n     * @param {String} xmlString - la chane de caractres correspondant au format XML\n     */\n    setXMLString : function (xmlString) {\n        if (xmlString && typeof xmlString === \"string\") {\n            this.xmlString = xmlString;\n            this.xmlDoc = __getXMLDOC(xmlString);\n        }\n    },\n\n    /**\n     * Mthode permettant de rcuprer les readers associs au format XML, s'ils ont t dfinis\n     *\n     * @return {Object} readers - les readers associs au format XML, s'ils existent,\n     *      sous forme d'une collection de fonctions\n     */\n    getReader : function () {\n        return this.reader;\n    },\n\n    /**\n     * Mthode permettant d'attribuer des readers, sous la forme d'un objet de fonctions (node, data),\n     *      lorsqu'ils n'ont pas t dfinis lors de l'instanciation par exemple (new XML (options)).\n     *\n     * @param {Object} reader - Instance d'un Reader de service (AltiResponseReader, GeocodeRequestReader, etc.)\n     *      utile pour interprter le XML lorsque sa structure est connue.\n     *      Ce reader doit comporter au moins une fonction statique read (root) permettant d'initialiser la lecture.\n     */\n    setReader : function (reader) {\n        if (reader && reader.read && typeof reader.read === \"function\") {\n            this.reader = reader;\n        }\n    },\n\n    /**\n     * Mthode permettant de rcuprer le document XML associ au format, s'il existe.\n     *\n     * @return {DOMElement} xmlDoc - le document XML (DOM document node) s'il existe\n     */\n    getXMLDoc : function () {\n        return this.xmlDoc;\n    },\n\n    /**\n     * Setter\n     */\n    setXMLDoc : function (doc) {\n        this.xmlDoc = doc;\n    },\n    /**\n     * Mthode initialisant la lecture du XML,  partir d'un XML Document :\n     *      cration d'un objet JavaScript contenant les informations du XML,\n     *      sauf dans le cas o il n'existe pas de XML Document  interprter (retourne un objet vide).\n     *\n     * @return {Object} [parserOutput] - un objet JavaScript contenant les informations du XML :\n     * - soit toutes les informations si aucun reader n'a t spcifi  la cration du format\n     * - soit les informations spcifies dans le reader.\n     */\n    parse : function () {\n        // build xml document from xmlString\n        if (!this.xmlDoc && this.xmlString) {\n            this.xmlDoc = __getXMLDOC(this.xmlString);\n        }\n        if (this.xmlDoc) {\n            var root = __getRootNode(this.xmlDoc);\n            if (root) {\n                var parserOutput;\n                // call reader if exists\n                if (this.reader && this.reader.read) {\n                    parserOutput = this.reader.read(root);\n                } else {\n                    parserOutput = {};\n                    parserOutput[root.nodeName] = __readDefault(root);\n                }\n                return parserOutput;\n            } else {\n                return {};\n            }\n        }\n    }\n\n};\n\n/**\n * Mthode de la classe (prive) permettant de crer un XML Document  partir d'une chane de caractres XML,\n *      en utilisant DOMParser () lorsque c'est possible.\n *      For more information, see: https://dvcs.w3.org/hg/innerhtml/raw-file/tip/index.html#the-domparser-interface\n *\n * @private\n * @memberof XML\n * @method __getXMLDOC\n * @param {String} xmlString - xml string to be converted into DOM element\n * @return {DOMElement} - the corresponding XML Document\n */\nfunction __getXMLDOC (xmlString) {\n\n    if ( typeof window === \"undefined\" ) {\n        // env. nodejs\n        var DOMParser = __webpack_require__(20).DOMParser; // __xmldom.DOMParser;\n        return new DOMParser().parseFromString(xmlString, \"text/xml\");\n    } else {\n        // env. browser\n\n        var parser;\n        var xmlDoc;\n        var errorMsg = \"Erreur lors du parsing de la rponse du service : XML non conforme\";\n\n        if (window.ActiveXObject) {\n            // Internet Explorer < 9\n            xmlDoc = new window.ActiveXObject(\"Microsoft.XMLDOM\");\n            xmlDoc.async = false;\n            xmlDoc.loadXML(xmlString);\n            var parseError = xmlDoc.parseError;\n            if (parseError.errorCode) {\n                if (parseError.line && parseError.linepos) {\n                    errorMsg += \"( ligne \" + parseError.line + \", colonne \" + parseError.linepos;\n                }\n                if (parseError.reason) {\n                    errorMsg += \":  \" + parseError.reason + \")\";\n                }\n                throw new Error(errorMsg);\n            }\n            return xmlDoc;\n\n        } else if (window.DOMParser) {\n            // les autres (Chrome, Mozilla, IE >= 9)\n            parser = new window.DOMParser();\n            try {\n                xmlDoc = parser.parseFromString(xmlString, \"text/xml\");\n            } catch (e) {\n                // Internet Explorer browser raises exception if xmlString is not valid XML\n                if (e.message === \"SyntaxError\") {\n                    throw new Error(errorMsg);\n                } else {\n                    throw new Error(\"Erreur lors du parsing de la rponse du service : \" + e.message);\n                }\n            }\n            // look for parsing error in case no exception was raised\n            if (xmlDoc.getElementsByTagName(\"parsererror\").length > 0) {\n                var parsererror = xmlDoc.getElementsByTagName(\"parsererror\");\n                for (var i = 0; i < parsererror.length; i++) {\n                    var content = parsererror[i].innerHTML;\n                    // except in case parsererror is just because of huge xml, but parsing is done.\n                    if (content.indexOf(\"Huge input lookup\") == -1) {\n                        errorMsg += \"(\" + content + \")\";\n                        throw new Error(errorMsg);\n                    }\n                }\n            } else if (!xmlDoc.documentElement) { // may happen in chrome browser\n                throw new Error(errorMsg);\n            }\n            return xmlDoc;\n\n        } else {\n            // FIXME\n            throw new Error(\"Incompatible DOM Parser pour ce navigateur !\");\n        }\n    }\n}\n\n/**\n * Mthode de la classe (prive) permettant de rcuprer le noeud racine du document,\n *       partir d'un document node (nodeType=9), puis lecture de ce noeud (readNode)\n *\n * @private\n * @memberof XML\n * @method __getRootNode\n * @param {DOMElement} [xmlDoc] - a Document Node\n * @return {DOMElement} root - the document root node\n */\nfunction __getRootNode (xmlDoc) {\n    var root;\n    if (xmlDoc.nodeType === 9) {\n        // INFO : nodeType 9 represents the entire document (the root-node of the DOM tree)\n        root = xmlDoc.documentElement;\n    } else if (xmlDoc.nodeType === 1) {\n        root = xmlDoc;\n    }\n    return root;\n}\n\n/**\n * Mthode de la classe (prive) permettant de lire automatiquement un noeud XML,\n *      lorsqu'aucun reader spcifique n'a t spcifi (parser brut)\n *\n * @private\n * @memberof XML\n * @method readDefault\n * @param {DOMElement} node - a DOM element node\n * @example final data object looks like :\n *          data = {\n *              attributeName: attributeValue,\n *              childName: {\n *                  attributeName: attributeValue,\n *                  attributeName: attributeValue,\n *                  childName: {\n *                      \"textContent\": textContent\n *                  },\n *                  childName: {\n *                      childName: {\n *                          attributeName:attributeValue\n *                      }\n *                  }\n *              }\n *          }\n */\nfunction __readDefault (node) {\n\n    var data = {};\n\n    // if element node has attributes, set their values to data\n    if (node.attributes.length > 0) {\n        var dataAttributes = __getAttributes(node);\n        data[\"attributes\"] = dataAttributes;\n    }\n\n    // if element node has childNodes, read them and set them to data\n    if (node.hasChildNodes()) {\n\n        var childData = {};\n        var child;\n        var children = node.childNodes;\n\n        for (var i = 0; i < children.length; i++) {\n            child = children[i];\n\n            if (child.nodeType === 3) { // TEXT_NODE\n                data[\"textContent\"] = child.nodeValue;\n\n            } else if (child.nodeType === 1) {\n                childData = __readDefault(child);\n\n                if (!data[child.nodeName]) {\n                    // store childData in an object\n                    data[child.nodeName] = childData;\n\n                } else {\n                    // in case several childNodes has the same name : store them in an array.\n                    // if data[nodeName] already exists but is not an array\n                    if (!Array.isArray(data[child.nodeName])) {\n                        var old = data[child.nodeName];\n                        data[child.nodeName] = [];\n                        data[child.nodeName].push(old);\n                    }\n                    data[child.nodeName].push(childData);\n                }\n            }\n            // TODO : manage other node types (4=CDATA, etc)\n        }\n    }\n\n    return data;\n}\n\n/**\n * Mthode de la classe (prive) permettant de rcuprer les attributs d'un noeud lment\n *\n * @private\n * @memberof XML\n * @method __getAttributes\n * @param {DOMElement} node - noeud contenant l'attribut recherch\n * @return {Object} nodeAttributes - objet contenant les noms et valeurs des diffrents attributs\n */\nfunction __getAttributes (node) {\n    if (node.attributes.length > 0) {\n        var nodeAttributes = {};\n        var attributes = node.attributes;\n        for (var i = 0; i < attributes.length; i++) {\n            var attribute = attributes[i];\n            nodeAttributes[attribute.nodeName] = attribute.nodeValue;\n        }\n        return nodeAttributes;\n    }\n}\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (XML);\n\n\n/***/ }),\n/* 5 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/**\n * Classe utilitaire\n *\n * @module Helper\n * @private\n * @alias Gp.Utils.Helper\n */\nvar Helper = {\n\n    /**\n     * concatenation des parametres key/value dans les urls\n     *\n     * @method normalyzeParameters\n     * @static\n     * @param {Object} params - tableau de clef/valeur\n     *\n     * @example\n     *  Gp.Utils.Helper.normalyzeParameters ({\n     *         key1:value1,\n     *         key2:value2,\n     *         key3:value3\n     *  });\n     *  // out : \"key1=value1&key2=value2&key3=value3\"\n     *\n     * @returns {String}\n     */\n    normalyzeParameters : function (params) {\n\n        var myParams = null;\n\n        if (params) {\n            var tabParams = [];\n            for (var key in params) {\n                if (params.hasOwnProperty(key)) {\n                    var value = params[key];\n                    if (!value) {\n                        value = \"\";\n                    }\n                    tabParams.push(key + \"=\" + value);\n                }\n            }\n\n            myParams = tabParams.join(\"&\");\n        }\n\n        return myParams;\n    },\n\n    /**\n     * Concatnation et encodage des urls.\n     *\n     * @method normalyzeUrl\n     * @static\n     * @param {String} url - url\n     * @param {Object|String} params - tableau de clef/valeur ou string\n     * @param {Boolean} encode - true|false, false par defaut\n     *\n     * @example\n     *  Gp.Utils.Helper.normalyzeUrl (url, {\n     *         key1:value1,\n     *         key2=:value2,\n     *         key3:value3\n     *  });\n     *  // out : \"url?key1=value1&key2=value2&key3=value3\"\n     *\n     * @returns {String}\n     */\n    normalyzeUrl : function (url, params, encode) {\n\n        var myUrl = url;\n\n        if (url) {\n            var k = url.indexOf(\"?\");\n            if (k === -1) { // pas de ? et KVP\n                myUrl += \"?\";\n            }\n\n            if (k !== -1 && k !== url.length - 1) { // KVP\n                myUrl += \"&\";\n            }\n        }\n\n        if (params) {\n\n            if ( typeof params === \"string\") {\n                myUrl += params;\n            } else {\n                myUrl += this.normalyzeParameters(params);\n            }\n        }\n\n        if (encode) {\n            // FIXME bonne ide ?\n            myUrl = encodeURIComponent(myUrl);\n        }\n\n        return myUrl;\n    },\n\n    /**\n     * Indentation d'une chaine\n     *\n     * @param {Number} n - nombre de tabulation\n     * @param {String} msg - chaine\n     *\n     * @example\n     * Gp.Utils.Helper.indent (2, \"message  indenter\")\n     * // out\n     * // ........message  indenter\n     *\n     * @returns {String}\n     */\n    indent : function (n, msg) {\n        var num = n || 0;\n        return new Array(num + 1).join(\"\\t\") + msg;\n    }\n};\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (Helper);\n\n\n/***/ }),\n/* 6 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n// cette classe contient les URLs par defaut des services.\n//  DefaultUrlService.Alti.url(key)[elevation-json]\n//  DefaultUrlService.Alti.url(key)[elevation-xml]\n//  DefaultUrlService.Alti.url(key)[profil-json]\n//  DefaultUrlService.Alti.url(key)[profil-xml]\n//  DefaultUrlService.Alti.url(key)[wps]\n//  DefaultUrlService.ProcessIsoCurve.url(key)\n//  DefaultUrlService.AutoComplete.url(key)\n//  DefaultUrlService.ReverseGeocode.url(key)\n//  DefaultUrlService.AutoConf.url(key)[apiKey]\n//  DefaultUrlService.AutoConf.url(key)[apiKeys]\n//  DefaultUrlService.AutoConf.url(key)[aggregate]\n//  DefaultUrlService.Geocode.url(key)\n//  DefaultUrlService.Route.url(key)\n\n// Example :\n//\n// DefaultUrlService.Alti.url('efe4r54tj4uy5i78o7545eaz7e87a')[elevation-json]\n//  output {String} -> http://wxs.ign.fr/efe4r54tj4uy5i78o7545eaz7e87a/alti/rest/elevation.json\n//\n// DefaultUrlService.Alti.url('efe4r54tj4uy5i78o7545eaz7e87a')\n// output {Object|String}\n// -> http://wxs.ign.fr/efe4r54tj4uy5i78o7545eaz7e87a/alti/rest/elevation.json\n// -> http://wxs.ign.fr/efe4r54tj4uy5i78o7545eaz7e87a/alti/rest/elevation.xml\n// -> http://wxs.ign.fr/efe4r54tj4uy5i78o7545eaz7e87a/alti/rest/elevationLine.json\n// -> http://wxs.ign.fr/efe4r54tj4uy5i78o7545eaz7e87a/alti/rest/elevationLine.xml\n// -> http://wxs.ign.fr/efe4r54tj4uy5i78o7545eaz7e87a/alti/wps\n//\n// Force ssl :\n//\n// DefaultUrlService.ssl = true;\n// DefaultUrlService.AutoComplete.url('efe4r54tj4uy5i78o7545eaz7e87a')\n// output {Object|String}\n// -> https://wxs.ign.fr/efe4r54tj4uy5i78o7545eaz7e87a/ols/apis/completion\n\n// constantes internes\nvar ISBROWSER = typeof window !== \"undefined\" ? true : false;\nvar HOSTNAME = \"wxs.ign.fr\";\n\n/**\n * Default Geoportal web services URLs access.\n *\n * @namespace\n * @alias Gp.Services.DefaultUrl\n */\nvar DefaultUrlService = {\n\n    /** if set true, require the use of https protocol (except browser) */\n    ssl : false,\n\n    /** base url of services (ssl protocol management) */\n    url : function (key, path) {\n        // en mode browser, c'est le protocole du navigateur,\n        // sinon, il est fix par l'option 'ssl' (par dfaut  false, cad en http)\n        var _protocol = (ISBROWSER) ?\n            (location && location.protocol && location.protocol.indexOf(\"https:\") === 0 ? \"https://\" : \"http://\") :\n            (DefaultUrlService.ssl ? \"https://\" : \"http://\");\n        return _protocol + HOSTNAME.concat(\"/\", key, path);\n    },\n\n    /**\n     * Elevation web service access\n     *\n     * @member {Object}\n     * @property {Function} url (key) - Returns elevation service default urls with or without geoportal access key given as a parameter. The result is a javascript object with different urls given used protocols (\"elevation-json\", \"elevation-xml\", \"profil-json\" or \"profil-xml\").\n     */\n    Alti : {\n        _key : {\n            // rest\n            \"elevation-json\" : \"/alti/rest/elevation.json\",\n            \"elevation-xml\" : \"/alti/rest/elevation.xml\",\n            \"profil-json\" : \"/alti/rest/elevationLine.json\",\n            \"profil-xml\" : \"/alti/rest/elevationLine.xml\",\n            // other\n            wps : \"/alti/wps\"\n        },\n        /** url */\n        url : function (key) {\n            return {\n                // rest\n                \"elevation-json\" : DefaultUrlService.url(key, this._key[\"elevation-json\"]),\n                \"elevation-xml\" : DefaultUrlService.url(key, this._key[\"elevation-xml\"]),\n                \"profil-json\" : DefaultUrlService.url(key, this._key[\"profil-json\"]),\n                \"profil-xml\" : DefaultUrlService.url(key, this._key[\"profil-xml\"]),\n                // other\n                wps : DefaultUrlService.url(key, this._key[\"wps\"])\n            };\n        }\n    },\n    /**\n     * IsoCurve web service access\n     *\n     * @member {Object}\n     * @property {Function} url (key) - Returns isocurve service default urls with or without geoportal access key given as a parameter. The result is a javascript object with different urls given used protocols (\"iso-json\" or \"iso-xml\").\n     */\n    ProcessIsoCurve : {\n        _key : {\n            \"iso-json\" : \"/isochrone/isochrone.json\", // rest (geoconcept)\n            \"iso-xml\" : \"/isochrone/isochrone.xml\" // rest (geoconcept)\n        },\n        /** url */\n        url : function (key) {\n            return {\n                \"iso-json\" : DefaultUrlService.url(key, this._key[\"iso-json\"]),\n                \"iso-xml\" : DefaultUrlService.url(key, this._key[\"iso-xml\"])\n            };\n        }\n    },\n    /**\n     * Autocompletion web service access\n     *\n     * @member {Object}\n     * @property {Function} url (key) - Returns autocomplete service default urls with or without geoportal access key given as a parameter. The result is a String.\n     */\n    AutoComplete : {\n        _key : \"/ols/apis/completion\",\n        /** url */\n        url : function (key) {\n            return DefaultUrlService.url(key, this._key);\n        }\n    },\n    /**\n     * Reverse geocoding web service access\n     *\n     * @member {Object}\n     * @property {Function} url (key) - Returns reverse geocoding service default urls with or without geoportal access key given as a parameter. The result is a String.\n     */\n    ReverseGeocode : {\n        _key : \"/geoportail/ols\",\n        /** url */\n        url : function (key) {\n            return DefaultUrlService.url(key, this._key);\n        }\n    },\n    /**\n     * Autoconfiguration web service access\n     *\n     * @member {Object}\n     * @property {Function} url ([key1,...]) - Returns autoconfiguration service default urls with geoportal access key (s) given as a String array parameter. The result is a javascript object with different urls given the access mode (\"apiKey\", \"apiKeys\" or \"aggregate\").\n     */\n    AutoConf : {\n        _key : {\n            apiKey : \"/autoconf\",\n            apiKeys : \"/autoconf?keys=%KEYS%\",\n            aggregate : \"/autoconf/id/\"\n        },\n        /** url */\n        url : function (key) {\n            var keys = \"\";\n            if (Array.isArray(key) && key.length > 0) {\n                keys = key[0];\n                for (var i = 1; i < key.length; i++) {\n                    keys += \",\" + key[i];\n                }\n            }\n            return {\n                apiKey : DefaultUrlService.url(key, this._key[\"apiKey\"]), // une seule cl\n                apiKeys : DefaultUrlService.url(key[0], this._key[\"apiKeys\"]).replace(\"%KEYS%\", keys), // autoconf de plusieurs cls\n                aggregate : DefaultUrlService.url(key, this._key[\"aggregate\"])\n            };\n        }\n    },\n    /**\n     * Geocoding web service access\n     *\n     * @member {Object}\n     * @property {Function} url (key) - Returns geocoding service default urls with or without geoportal access key given as a parameter. The result is a String.\n     */\n    Geocode : {\n        _key : \"/geoportail/ols\",\n        /** url */\n        url : function (key) {\n            return DefaultUrlService.url(key, this._key);\n        }\n    },\n    /**\n     * Routing web service access\n     *\n     * @member {Object}\n     * @property {Function} url (key) - Returns routing service default urls with or without geoportal access key given as a parameter. The result is a javascript object with different urls given used protocols (\"route-json\" or \"route-xml\").\n     */\n    Route : {\n        _key : {\n            ols : \"/itineraire/ols\", // openLS\n            \"route-json\" : \"/itineraire/rest/route.json\", // rest (geoconcept)\n            \"route-xml\" : \"/itineraire/rest/route.xml\" // rest (geoconcept)\n        },\n        /** url */\n        url : function (key) {\n            return {\n                ols : DefaultUrlService.url(key, this._key[\"ols\"]),\n                \"route-json\" : DefaultUrlService.url(key, this._key[\"route-json\"]),\n                \"route-xml\" : DefaultUrlService.url(key, this._key[\"route-xml\"])\n            };\n        }\n    }\n};\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (DefaultUrlService);\n\n\n/***/ }),\n/* 7 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n\n/**\n * @classdesc\n *\n * Liste des attributs des tables de geocodage\n * @constructor\n * @alias Gp.Services.Geocode.Request.GeocodeLocation\n * @private\n */\nfunction GeocodeLocation () {\n\n    if (!(this instanceof GeocodeLocation)) {\n        throw new TypeError(\"GeocodeLocation constructor cannot be called as a function.\");\n    }\n\n    /**\n     * Objet qui peut prendre comme proprits les valeurs du tableau serviceAttributes\n     * @type {Object}\n     */\n    this.placeAttributes = {};\n\n    /**\n     * Tableau qui liste les attributs spcifiques selon le type de la GeocodeLocation.\n     * Ces attributs correspondent  ceux saisis par l'utilisateur (lgrement diffrents de ceux du service)\n     * @type {String[]}\n     */\n    this.attributesList = [];\n\n    /**\n     * Tableau qui liste les attributs spcifiques selon le type de la GeocodeLocation\n     * Ces attributs correspondent  ceux interprts par le service (balises Place).\n     * @type {String[]}\n     */\n    this.serviceAttributes = [];\n\n}\n\n/**\n * @lends module:GeocodeLocation\n */\nGeocodeLocation.prototype = {\n\n    /**\n     * Constructeur (alias)\n     */\n    constructor : GeocodeLocation\n\n};\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (GeocodeLocation);\n\n\n/***/ }),\n/* 8 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__ = __webpack_require__(0);\n/**\n * Lecture / Ecriture du format WKT\n *\n * Les besoins sont assez simples :\n * 1. lecture des types suivants :\n *  - LINESTRING\n *  - POLYGON\n *  - (TODO)\n * 2. convertir aux formats suivants :\n *  - json\n *  - (TODO)\n *\n *\n * @example\n *  var strWKT = \"LINESTRING (2.416907 48.846577, 2.416916 48.846613)\";\n *  WKT.toJson (strWKT,\n *      function onSuccess (json) {\n *          // {\n *          //      type : 'LINESTRING',\n *          //      coordinates : [\n *          //          [2.416907, 48.846577],\n *          //          [2.416916, 48.846613]\n *          //      ]\n *          // }\n *      },\n *      function onError (error) {\n *          console.log(error);\n *      }\n *  );\n *\n * @module WKT\n * @alias Gp.Formats.WKT\n * @private\n */\n\n\n\nvar WKT = {\n\n    /**\n     * Parsing d'une chaine WKT\n     *\n     * @method toJson\n     * @param {String} strWkt - chaine de type WKT\n     * @param {Function} success - fonction callback\n     * @param {Function} error   - fonction callback\n     */\n    toJson : function (strWkt, success, error) {\n\n        var logger = __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__[\"a\" /* default */].getLogger();\n\n        var json = null;\n\n        try {\n\n            if (! strWkt) {\n                throw new Error(\"La chaine WKT n'est pas renseigne !\");\n            }\n\n            if (! success) {\n                /** callback success par defaut */\n                success = function (json) {\n                    console.log(json);\n                };\n            }\n\n            if (! error) {\n                /** callback error par defaut */\n                error = function (e) {\n                    console.log(e);\n                };\n            }\n\n            var regex;\n            var subst;\n            var result;\n\n            // regex coordinates\n            regex = /(-?\\d+\\.?[0-9]*)\\s(-?\\d+\\.?[0-9]+)/g;\n            subst = \"[$1,$2]\";\n            strWkt = strWkt.replace(regex, subst);\n\n            // regex type\n            regex = /^(\\w+)/;\n            result = regex.exec(strWkt);\n            if (RegExp.$1 === \"POLYGON\") {\n                subst = \"{\\\"type\\\" : \\\"Polygon\\\",\";\n                strWkt = strWkt.replace(RegExp.$1, subst);\n                // clean\n                // (( --> coordinates : [[\n                regex = /(\\({2}?)/;\n                subst = \"\\\"coordinates\\\" : [[\";\n                strWkt = strWkt.replace(regex, subst);\n                // )) --> ]]}\n                regex = /(\\){2}?)/;\n                subst = \"]]}\";\n                strWkt = strWkt.replace(regex, subst);\n                // all ( --> [\n                regex = /(\\()/g;\n                subst = \"[\";\n                strWkt = strWkt.replace(regex, subst);\n                // all ) --> ]\n                regex = /(\\))/g;\n                subst = \"]\";\n                strWkt = strWkt.replace(regex, subst);\n            } else if (RegExp.$1 === \"LINESTRING\") {\n                subst = \"{\\\"type\\\" : \\\"LineString\\\",\";\n                strWkt = strWkt.replace(RegExp.$1, subst);\n                // clean\n                regex = /(\\(\\(?)/;\n                subst = \"\\\"coordinates\\\" : [\";\n                strWkt = strWkt.replace(regex, subst);\n                regex = /(\\)\\)?)/;\n                subst = \"]}\";\n                strWkt = strWkt.replace(regex, subst);\n            }\n\n            logger.trace(strWkt);\n\n            json = JSON.parse(strWkt);\n\n            if (! json) {\n                throw new Error(\"Le JSON est vide !\");\n            }\n\n            if (! json.type) {\n                throw new Error(\"Le type de geometrie n'est pas connu !\");\n            }\n\n            if (! json.coordinates) {\n                throw new Error(\"La liste des points est vide !\");\n            }\n\n            success.call(this, json);\n\n        } catch (e) {\n            if (e.name === \"SyntaxError\") {\n                error.call(this, \"Erreur de parsing JSON !\");\n                return;\n            }\n            error.call(this, e);\n        }\n    }\n};\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (WKT);\n\n\n/***/ }),\n/* 9 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/**\n * Response object for {@link module:Services~getAltitude Gp.Services.getAltitude ()} invocation when successful. Received as the argument of onSuccess callback function.\n *\n * @property {Array.<Gp.Services.Alti.Elevation>} elevations - Elevations array.\n * \n * @namespace\n * @alias Gp.Services.AltiResponse\n */\nfunction AltiResponse () {\n\n    if (!(this instanceof AltiResponse)) {\n        throw new TypeError(\"AltiResponse constructor cannot be called as a function.\");\n    }\n\n    this.elevations = [];\n\n}\n\nAltiResponse.prototype = {\n\n    constructor : AltiResponse\n\n};\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (AltiResponse);\n\n\n/***/ }),\n/* 10 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n\n/**\n * Single elevation object returned by underlying web service. Contains at least, one elevation (z). May also contain point coordinates and elevation accuracy if \"zonly\" parameter wasn't set to true. \n *\n * @property {Float} lat - Point latitude. (only if zonly=false)\n * @property {Float} lon - Point longitude. (only if zonly=false)\n * @property {Float} z - Point elevation.\n * @property {Float} acc - Accuracy of elevation for this point. (only if zonly=false)\n *\n * @namespace\n * @alias Gp.Services.Alti.Elevation\n */\nfunction Elevation () {\n\n    if (!(this instanceof Elevation)) {\n        throw new TypeError(\"Elevation constructor cannot be called as a function.\");\n    }\n\n    this.z = null;\n}\n\nElevation.prototype = {\n\n    constructor : Elevation\n\n};\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (Elevation);\n\n\n/***/ }),\n/* 11 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__XLS_RequestHeader__ = __webpack_require__(65);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__XLS_Request__ = __webpack_require__(66);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__XLS_AbstractService__ = __webpack_require__(12);\n/* jshint multistr: true */\n\n\n\n\n\n\n/**\n * @classdesc\n *\n * standard OpenLS\n * standard XLS\n * (version 1.2)\n *\n * Rfs :\n *     - {@link http://schemas.opengis.net/ols/1.2/}\n *     - {@link http://www.opengeospatial.org/standards/ols}\n *     - {@link http://wxs.ign.fr/schemas/}\n *\n *\n * Cration du template XLS (avec gestion des namespaces)\n * ------------------------\n * ```\n *   balise xsd : element name=\"XLS\" attribute name=\"version\" [(attribute ref=\"lang\")]\n * ```\n *\n * Exemple :\n * ```\n * <XLS xmlns=\"http://www.opengis.net/xls\" version=\"1.2\">\n *   < (ref. OLS) />\n * </XLS>\n * ```\n * ```\n * <xls:XLS xmlns:xls=\"http://www.opengis.net/xls\" version=\"1.2\">\n *   <xls: (ref. OLS) />\n * </xls:XLS>\n * ```\n *\n * Cration des templates OLS pour LocationUtilityService\n * ------------------------------------------------------\n *\n * Exemple :\n *\n * ```\n * <RequestHeader srsName=\"epsg:4326\"/>\n * <Request maximumResponses=\"26\" methodName=\"GeocodeRequest\" requestID=\"uid1349081498314_388\" version=\"1.2\">\n *      <GeocodeRequest>\n *          <Address countryCode=\"PositionOfInterest\">\n *              <freeFormAddress>saint mand</freeFormAddress>\n *          </Address>\n *      </GeocodeRequest>\n *  </Request>\n * ```\n * ```\n * <RequestHeader sessionID=\"\" />\n * <Request methodName=\"ReverseGeocodeRequest\" version=\"1.2\" requestID=\"\" maximumResponses=\"10\">\n *   <ReverseGeocodeRequest>\n *     <Position>\n *       <gml:Point xmlns:gml=\"http://www.opengis.net/gml\">\n *           <gml:pos>50.347775 3.205098</gml:pos>\n *       </gml:Point>\n *     </Position>\n *     <ReverseGeocodePreference>StreetAddress</ReverseGeocodePreference>\n *  </ReverseGeocodeRequest>\n * </Request>\n * ```\n * ```\n * Geocodage direct (balise xsd) :\n *   element ref=\"RequestHeader\" [ (attribute name=\"clientName\" attribute name=\"clientPassword\" attribute name=\"sessionID\" attribute name=\"srsName\" attribute name=\"MSID\") ]\n *     element name=\"Request\" attribute name=\"methodName\" attribute name=\"version\" attribute name=\"requestID\" [ attribute name=\"maximumResponses\" ]\n *       element name=\"GeocodeRequest\" attribute name=\"returnFreeForm\"\n *         element ref=\"xls:Address\"\n * ```\n * ```\n * Geocodage inverse (balise xsd) :\n *   element ref=\"RequestHeader\" [ (attribute name=\"clientName\" attribute name=\"clientPassword\" attribute name=\"sessionID\" attribute name=\"srsName\" attribute name=\"MSID\") ]\n *     element name=\"Request\" attribute name=\"methodName\" attribute name=\"version\" attribute name=\"requestID\" [ attribute name=\"maximumResponses\" ]\n *       element name=\"ReverseGeocodeRequest\"\n *         element ref=\"xls:Position\"\n *         element name=\"ReverseGeocodePreference\" (enumeration)\n * ```\n *\n * Il existe 3 sous ensembles d'objets :\n *     - RequestHeader\n *     - Request\n *     - ReverseGeocodeRequest, GeocodeRequest\n *\n * GeocodeRequest est compos d'un objet {@link Gp.Services.Geocode.Response.GeocodeLocation}.\n * ReverseGeocodeRequest est compos d'un objet {@link Gp.Services.ReverseGeocode.Response.ReverseGeocodeLocation}.\n *\n * Les locations font appels aux objets suivants qui possdent des attributs spcifiques\n * en fonction du type de table de geocodage interrog :\n *     - StreetAddress\n *     - CadastralParcel\n *     - PositionOfInterest\n *     - Administratif\n *\n *\n * et des lements sous jacents tels que :\n *     - ReverseGeocodePreference -> tables de geocodages :\n *         - StreetAddress\n *         - CadastralParcel\n *         - PositionOfInterest\n *         - Administratif (une balise par table)\n *     - Position -> standard GML 3.2.1\n *     - Address  -> cf. ci-dessous\n *\n * ```\n * Position (balise xsd) :\n *   ex. <Position><gml:Point xmlns:gml=\"http://www.opengis.net/gml\"><gml:pos>50.347775 3.205098</gml:pos></gml:Point></Position>\n *   ex. <Position><gml:CircleByCenterPoint xmlns:gml=\"http://www.opengis.net/gml\"><gml:pos>48.85978570614691 2.2913572761128878</gml:pos><gml:radius>1000</gml:radius></gml:CircleByCenterPoint></Position>\n *   (au choix)\n *   element ref=\"gml:Point\"\n *   element ref=\"gml:CircleByCenterPoint\"\n *   element ref=\"gml:Polygon\"\n *   element ref=\"gml:MultiPolygon\"\n *   les autres elemennts ne sont pas implments (QoP, Speed, Direction, Time, ...)\n *\n * Address (balise xsd) :\n *   ex. <Address countryCode=\"StreetAddress\"><freeFormAddress>1 r de paris saint denis</freeFormAddress></Address>\n *   attribute name=\"countryCode\"\n *     element name=\"freeFormAddress\"\n *     element ref=\"xls:Place\"\n *     element ref=\"gml:Envelope\"\n *  ou\n *   ex. <Address countryCode=\"StreetAddress\"><StreetAddress><Street>1 rue Marconi</Street></StreetAddress><Place type=\"Municipality\">Metz</Place><PostalCode>57000</PostalCode></Address>\n *   attribute name=\"countryCode\"\n *     element ref=\"xls:StreetAddress\"\n *     element ref=\"xls:PostalCode\"\n *     element ref=\"xls:Place\"\n *     element ref=\"gml:Envelope\"\n *\n * Place  (balise xsd) :\n *  ex. <Place type=\"Municipality\">Metz</Place>\n *  attribute name=\"type\"\n *   enumeration value=\"CountrySubdivision\"\n *   enumeration value=\"CountrySecondarySubdivision\"\n *   enumeration value=\"Municipality\"\n *   enumeration value=\"MunicipalitySubdivision\"\n *   enumeration value=\"choume-banchi-go\"\n *   enumeration value=\"Qualite\"\n *   enumeration value=\"Departement\"\n *   enumeration value=\"Bbox\"\n *   enumeration value=\"Commune\"\n *   enumeration value=\"Territoire\"\n *   enumeration value=\"Importance\"\n *   enumeration value=\"Nature\"\n *   (la liste n'est pas exhaustives...)\n *\n * StreetAddress (balise xsd) :\n *   ex. <StreetAddress><Street>1 rue Marconi</Street></StreetAddress>\n *   attribute name=\"locator\"\n *    element name=\"xls:Building\"\n *    element ref=\"xls:Street\"\n *\n * Street (balise xsd) :\n *   ex. <Street>1 rue Marconi</Street>\n *   attribute name=\"officialName\" (...)\n *\n * Building (balise xsd) :\n *   ex. <Building number=\"800\"/>\n *   attribute name=\"number\" attribute name=\"subdivision\" attribute name=\"buildingName\"\n *\n * PostalCode (balise xsd) :\n *   ex. <PostalCode>77182</PostalCode>\n *\n * ```\n *\n * Requte\n * -------\n *\n * 2 modes de requte sur les services : GET ou POST.\n *\n * Le mode GET n'est que l'encodage du XML en param (qxml) de la requte (donc pas d'implementation particulire ?)\n *\n * Modle de classes\n * -----------------\n *\n * ```\n *                 ________  XLS ____________\n *               /            |               \\\n *   RequestHeader      AbstractService    Request\n *                            ^\n *                      ______|________________________\n *           (extends) /                               \\ (extends)\n *          LocationUtilityService                    RouteService\n *                    |                                    |\n *         ___________|___________                       (...)\n *       /                        \\\n * GeocodeRequest          ReverseGeocodeRequest\n *      |                          |\n *      |                     _____|______\n *      |                    /            \\\n *   Address              Preference  Position\n *      |\n *    /   \\\n * Place   StreetAddress\n *               |\n *             /   \\\n *       Street   Building\n * ```\n *\n * @example\n * // encapsule un objet 'LocationUtilityService'\n * // dans une coquille XSL (avec/sans namespace)\n * xsl = new XSL ();\n * xsl.namespace = false;\n * xsl.srsName = \"epsg:4326\";\n * xsl.maximumResponses = 26;\n * //   methodName fournit par l'objet 'lus'\n * //   requestID est calcul\n * xsl.setService (lus);\n * xsl.build ();\n * // out ->\n * // <XLS xmlns=\"http://www.opengis.net/xls\" version=\"1.2\">\n * // <RequestHeader srsName=\"epsg:4326\"/>\n * // <Request maximumResponses=\"26\" methodName=\"GeocodeRequest\" requestID=\"uid1349081498314_388\" version=\"1.2\">\n * //   < (ref. LocationUtilityService ou vide) />\n * //  </Request>\n * // </XLS>\n *\n *\n * @constructor\n * @alias Gp.Formats.XLS\n * @param {Object} options - options du constructeur\n * @param {Object} options.srsName - identifiant du Systeme de Coordonnees\n * @param {String}   options.maximumResponses - nombre de reponses max d'une requete\n * @param {Function} options.onsuccess - function callback success (TODO)\n * @param {Function} options.onerror   - function callback error   (TODO)\n *\n * @private\n */\nfunction XLS (options) {\n\n    this.logger = __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__[\"a\" /* default */].getLogger();\n    this.logger.trace(\"[Constructeur XLS()]\");\n\n    if (!(this instanceof XLS)) {\n        throw new TypeError(\"XLS constructor cannot be called as a function.\");\n    }\n\n    // options par defaut\n    this.options = {\n        srsName : \"EPSG:4326\",\n        maximumResponses : 25\n    };\n\n    // et on ajoute les options en paramtre aux options par dfaut\n    for (var opt in options) {\n        if (options.hasOwnProperty(opt)) {\n            if (options[opt]) {\n                this.options[opt] = options[opt];\n            }\n        }\n    }\n}\n\n/**\n * Version\n */\nXLS.VERSION = \"1.2\";\n\nXLS.prototype = {\n\n    /**\n     * @lends module:XLS#\n     */\n\n    /**\n     * request (out)\n     * @type {String}\n     */\n    requestString : null,\n\n    /**\n     * namespace\n     * Surcharge les balises XLS d'un prefixe.\n     * Par defaut, false\n     * @type {Boolean}\n     */\n    namespace : false,\n\n    /**\n     * Objet Service\n     * LocationUtilityService ou RouteService\n     * @type {AbstractService}\n     */\n    oService : null,\n\n    /**\n     * Constructeur (alias)\n     */\n    constructor : XLS,\n\n    /**\n     * Template de la requte.\n     * substitution des valeurs suivantes :\n     * __VERSION__, __NAMESPACE__, __SCHEMALOCATION__\n     * __REQUESTHEADER__, __REQUEST__\n     */\n    template : \"<?xml version=\\\"1.0\\\" encoding=\\\"UTF-8\\\"?>\\n\" +\n        \"<XLS version=\\\"__VERSION__\\\"\\n\" +\n        \"__NAMESPACE__ \\n\" +\n        \"__SCHEMALOCATION__>\\n\" +\n        \"__REQUESTHEADER__\\n\" +\n        \"__REQUEST__\\n\" +\n        \"</XLS>\\n\",\n\n    /**\n     * Namespace par defaut.\n     *\n     * @returns {String}\n     */\n    namespaceByDefault : function () {\n        var ns = [\n            \"xmlns:xsi=\\\"http://www.w3.org/2001/XMLSchema-instance\\\"\",\n            \"xmlns:xls=\\\"http://www.opengis.net/xls\\\"\",\n            \"xmlns:gml=\\\"http://www.opengis.net/gml\\\"\"\n        ];\n\n        return ns.join(\" \");\n    },\n\n    /**\n     * Schemalocation par defaut\n     *\n     * @returns {String}\n     */\n    schemaLocationByDefault : function () {\n        return \"xsi:schemaLocation=\\\"http://www.opengis.net/xls http://schemas.opengis.net/ols/1.2/olsAll.xsd\\\"\";\n    },\n\n    /**\n     * Setter Service\n     * Ajout d'un objet de type LocationUtilityService (LUS) ou RouteService\n     *\n     * @param {Object} oService - GeoceodeRequest / ReverseGeocodeRequest ou RouteRequest\n     */\n    setService : function (oService) {\n\n        if (!oService) {\n            this.logger.trace(\"L'objet de type Service XSL n'est pas encore defini !?\");\n            return;\n        }\n\n        if (oService instanceof __WEBPACK_IMPORTED_MODULE_3__XLS_AbstractService__[\"a\" /* default */]) {\n            this.oService = oService;\n        } else {\n            this.logger.error(\"L'objet n'est pas du type 'LocationUtilityService' ou 'RouteService' !?\");\n        }\n\n    },\n\n    /**\n     * Getter Service\n     * Retourne un objet de type LocationUtilityService (LUS) ou RouteService\n     * ex. GeoceodeRequest / ReverseGeocodeRequest ou RouteRequest\n     *\n     * @returns {Object}\n     */\n    getService : function () {\n        return this.oService;\n    }\n};\n\n/**\n * Ajout d'un prefixe de namespace\n *\n * @todo impl. l'ajout de namespace\n * @param {Object} ns - ex. {key:xls, url:http://www.opengis.net/xls}\n */\nXLS.prototype.addNamespace = function (ns, request) {\n\n    // INFO\n    // on recherche la clef dans les namespaces par defaut.\n    // si la clef n'existe pas dans les namespaceByDefault (), on l'ajoute.\n    // on surcharge toutes les balises, ex. XLS -> xls:XLS\n    // sauf celles qui sont dj prefixes !\n\n    var keyNS = ns.key;\n    // var urlNS = ns.url; // TODO not yet implemented !\n\n    // recherche la clef dans les namespaces par defaut\n    var bFound = false;\n    var allNS = this.namespaceByDefault().split(\" \");\n    for (var index = 0; index < allNS.length; index++) {\n        var element = allNS[index];\n        var map = element.split(\"=\");\n        var key = map[0];\n        // var url = map[1]; // TODO not yet implemented !\n\n        if (key === \"xmlns:\" + keyNS) {\n            bFound = true;\n            break;\n        }\n    }\n\n    // TODO\n    // si on a une nouvelle clef, on l'ajoute...\n    if (!bFound) {\n        this.logger.warn(\"L'ajout d'un nouvel namespace n'est pas encore implment !\");\n        return request;\n    }\n\n    // surcharge toutes les balises\n    var regex;\n    var subst;\n\n    // regex balise ouvrante\n    regex = /<(\\w+[\\s>])/g;\n    subst = \"<\" + keyNS + \":$1\";\n    request = request.replace(regex, subst);\n\n    // regex balise fermante\n    regex = /<\\/(\\w+[\\s>])/g;\n    subst = \"</\" + keyNS + \":$1\";\n    request = request.replace(regex, subst);\n\n    this.logger.trace(\"namespace\", request);\n\n    return request;\n};\n\n/**\n * Construction de la requte\n */\nXLS.prototype.build = function () {\n\n    // out ->\n    // <XLS xmlns=\"http://www.opengis.net/xls\" version=\"1.2\">\n    // <RequestHeader srsName=\"epsg:4326\"/>\n    // <Request maximumResponses=\"26\" methodName=\"GeocodeRequest\" requestID=\"uid1349081498314_388\" version=\"1.2\">\n    //   < (ref. LocationUtilityService ou vide) />\n    //  </Request>\n    // </XLS>\n\n    // as t on un objet de type Service XLS  disposition ?\n    var bService = this.getService() ? true : false;\n\n    var template = \"\";\n    template = this.template;\n    template = template.replace(/__VERSION__/g, XLS.VERSION);\n    template = template.replace(/__NAMESPACE__/g, this.namespaceByDefault);\n    template = template.replace(/__SCHEMALOCATION__/g, this.schemaLocationByDefault);\n\n    // header\n    var oHeader = new __WEBPACK_IMPORTED_MODULE_1__XLS_RequestHeader__[\"a\" /* default */]({\n        srsName : this.options.srsName\n    });\n    template = template.replace(/__REQUESTHEADER__/g, oHeader.toString());\n\n    // request\n    var oRequest = new __WEBPACK_IMPORTED_MODULE_2__XLS_Request__[\"a\" /* default */]({\n        maximumResponses : this.options.maximumResponses,\n        version : XLS.VERSION, // FIXME mme version ?\n        methodName : bService ? this.getService().CLASSTYPE : null\n    });\n    template = template.replace(/__REQUEST__/g, oRequest.toString());\n\n    // objet lus ou route\n    if (bService) { // INFO : clef __REQUESTSERVICE__ dispo dans l'objet 'Request'\n        template = template.replace(/<!-- __REQUESTSERVICE__ -->/g, this.getService().toString());\n    }\n\n    if (!template) {\n        this.logger.warn(\"traduction tmpl : empty request !?\");\n        return;\n    }\n\n    // ajout d'un namespace\n    if (this.namespace) {\n        // ajout de xls par defaut\n        template = this.addNamespace({\n            key : \"xls\",\n            url : \"http://www.opengis.net/xls\"\n        }, template);\n    }\n\n    this.requestString = template;\n    this.logger.trace(\"traduction tmpl\", template);\n\n    // on retourne qqchose !\n    return this.requestString;\n};\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (XLS);\n\n\n/***/ }),\n/* 12 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__ = __webpack_require__(0);\n\n\n/**\n * @classdesc\n * @private\n *\n * @constructor\n * @alias Gp.Formats.XLS.AbstractService\n *\n * @param {Object} [options] - options\n */\nfunction AbstractService (options) {\n\n    this.logger = __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__[\"a\" /* default */].getLogger();\n    this.logger.trace(\"[Constructeur AbstractService ()]\");\n\n    if (!(this instanceof AbstractService)) {\n        throw new TypeError(\"AbstractService constructor cannot be called as a function.\");\n    }\n\n    // options par defaut\n    this.options = options || {};\n\n    // et on ajoute les options en paramtre aux options par dfaut\n    for (var opt in options) {\n        if (options.hasOwnProperty(opt)) {\n            this.options[opt] = options[opt];\n        }\n    }\n}\n\n/**\n * @lends module:AbstractService#\n */\nAbstractService.prototype = {\n\n    /**\n     * request (out)\n     * @type {String}\n     */\n    strRequest : null,\n\n    /**\n     * objet Request\n     * @type {Request}\n     */\n    oRequest : null,\n\n    /**\n     * Filter\n     * @type {FilterExtension}\n     */\n    oFilter : null,\n\n    /**\n     * Constructeur (alias)\n     */\n    constructor : AbstractService,\n\n    /**\n     * Ajout d'un objet de type Request : GeocodeRequest / ReverseGeocodeRequest / RouteRequest\n     *\n     * @param {Object} oRequest - GeocodeRequest / ReverseGeocodeRequest / RouteRequest\n     */\n    addRequest : function (oRequest) {\n        this.logger.error(\"overwritten method !\");\n    },\n\n    /**\n     * Ajout d'un objet de type FilterExtension : GeocodeFilterExtension ou RouteRequestExtension\n     *\n     * @param {Object} oFilter - GeocodeFilterExtension ou RouteRequestExtension\n     */\n    addFilter : function (oFilter) {\n        this.logger.error(\"overwritten method !\");\n    },\n\n    /**\n     * toString\n     */\n    toString : function () {\n        this.logger.error(\"overwritten method !\");\n    }\n};\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (AbstractService);\n\n\n/***/ }),\n/* 13 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__ = __webpack_require__(0);\n\n\n\n/**\n * @classdesc\n *\n * Ajouter des extensions de filtres spcifiques au service de geocodage de l'IGN.\n * Ceci permet de contrler les options spcifiques de la table de geocodage intrroges.\n *\n * @example\n * var ext =  new GeocodeFiltersExtension ();\n *     ext.add (new Administratif ());\n *     ext.add (new StreetAddress ());\n *     ext.add (new PositionOfInterest ());\n *     ext.add (new CadastralParcel ());\n *\n * ext.getNames ()\n * // --> out\n * // [Administratif, StreetAddress, PositionOfInterest, CadastralParcel]\n *\n * ext.getFilters ()\n * // --> out\n * // [Object, Object, Object, Object] = tableau d'objet GeocodeLocation\n *\n * ext.getFilter ('StreetAddress')\n * // --> out\n * // {Object} = objet GeocodeLocation\n *\n * ext.getAttributs ('StreetAddress')\n * // --> out\n * // [\"bbox\", \"number\", \"ID\", \"IDTR\", \"postalCode\", \"quality\", \"street\", \"territoire\", \"commune\", \"department\", \"insee\", \"municipality\"]\n *\n * ext.setPlaceAttributs ('StreetAddress', {number:'', territoire:'', quality:'', fake:''})\n * // --> out\n * // (fake est cart car il n'appartient pas  la liste !)\n *\n * ext.getPlaceAttributs ('StreetAddress')\n * // --> out\n * // {number : '', territoire : '', quality : ''}\n *\n * // Comment ajouter des filtres spcifiques au service de geocodage ?\n * var req = new GeocodeRequest ({\n *      location : \"saint mand\",\n *      returnFreeForm : true,\n *      filterOptions : {\n *          type : ['PositionOfInterest'], <-- ajouter une extension afin de gerer les attributs de cette table de geocodage !\n *          (...)\n *      }\n *  })\n *  req.addFilter (new PositionOfInterest ());\n * @constructor\n * @alias Gp.Formats.XLS.LocationUtilityService.GeocodeFilterExtension\n *\n * @private\n */\nfunction GeocodeFilterExtension () {\n\n    this.logger = __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__[\"a\" /* default */].getLogger(\"GeocodeFilterExtension\");\n    this.logger.trace(\"[Constructeur GeocodeFilterExtension ()]\");\n\n    if (!(this instanceof GeocodeFilterExtension)) {\n        throw new TypeError(\"GeocodeFilterExtension constructor cannot be called as a function.\");\n    }\n\n    /**\n     * Tableau de filtres (table de geocodage)\n     */\n    this.filters = [];\n}\n\n/**\n * @lends module:GeocodeFilterExtension#\n */\nGeocodeFilterExtension.prototype = {\n\n    /**\n     * Constructeur (alias)\n     */\n    constructor : GeocodeFilterExtension,\n\n    /**\n     * Ajout d'un filtre\n     *\n     * @param {Object} oGeocodeLocation - objet de type 'GeocodeLocation'\n     */\n    addFilterExtensions : function (oGeocodeLocation) {\n        // FIXME test sur le type d'objet !\n        if (oGeocodeLocation) {\n            // FIXME ou test sur ses proprits !\n            this.filters.push(oGeocodeLocation);\n        }\n    },\n\n    // getter\n\n    /**\n     * Tableau de noms (tables de geocodage)\n     *\n     * @returns {Array.<String>}\n     */\n    getNames : function () {\n        var names = [];\n        for (var idx in this.filters) {\n            names.push(this.filters[idx].CLASSNAME);\n        }\n        this.logger.trace(names);\n        return names;\n    },\n\n    /**\n     * Retourne une table de geocodage\n     *\n     * @param {String} name - nom de la table de geocodage\n     * @returns {Object}\n     */\n    getFilter : function (name) {\n        var filter = null;\n        for (var idx in this.filters) {\n            if (this.filters[idx].CLASSNAME == name) {\n                filter = this.filters[idx];\n            }\n        }\n        this.logger.trace(filter);\n        return filter;\n\n    },\n\n    /**\n     * Tableau d'objects (tables de geocodage)\n     *\n     * @returns {Array.<Object>}\n     */\n    getFilters : function () {\n        this.logger.trace(this.filters);\n        return this.filters;\n    },\n\n    /**\n     * Rcupre la liste des attributs (filtres) sur une table de geocodage\n     *\n     * @param {String} name - nom de la table de geocodage\n     * @returns {Array}\n     */\n    getAttributs : function (name) {\n        var attributs = [];\n        for (var idx in this.filters) {\n            if (this.filters[idx].CLASSNAME == name) {\n                attributs = this.filters[idx].attributesList;\n            }\n        }\n        this.logger.trace(attributs);\n        return attributs;\n    },\n\n    /**\n     * Ajout des attributs (filtres) sur une table de geocodage\n     *\n     * @param {String} name - nom de la table de geocodage\n     * @param {Object} options - options de la table de geocodage\n     */\n    setPlaceAttributs : function (name, options) {\n\n        var filter = this.getFilter(name);\n        var attributs = this.getAttributs(name);\n        for (var idx in attributs) {\n            var value = attributs[idx];\n            if (options[value]) {\n                filter.placeAttributes[value] = options[value];\n            }\n        }\n    },\n\n    /**\n     * Retourne les attributs (filtres) sur une table de geocodage\n     *\n     * @param {String} name - nom de la table de geocodage\n     */\n    getPlaceAttributs : function (name) {\n        var places = {};\n        for (var idx in this.filters) {\n            if (this.filters[idx].CLASSNAME == name) {\n                places = this.filters[idx].placeAttributes;\n            }\n        }\n        this.logger.trace(places);\n        return places;\n    }\n};\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (GeocodeFilterExtension);\n\n\n/***/ }),\n/* 14 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n\n/**\n * Response object for {@link module:Services~geocode Gp.Services.geocode ()} or {@link module:Services~reverseGeocode Gp.Services.reverseGeocode ()} invocation when successful. Received as the argument of onSuccess callback function.\n *\n * @property {Array.<Gp.Services.Geocode.DirectGeocodedLocation|Gp.Services.Geocode.ReverseGeocodedLocation>} locations - locations array.\n * \n * @namespace\n * @alias Gp.Services.GeocodeResponse\n */\nfunction GeocodeResponse () {\n\n    if (!(this instanceof GeocodeResponse)) {\n        throw new TypeError(\"GeocodeResponse constructor cannot be called as a function.\");\n    }\n\n    this.locations = [];\n\n}\n\nGeocodeResponse.prototype = {\n\n    constructor : GeocodeResponse\n\n};\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (GeocodeResponse);\n\n\n/***/ }),\n/* 15 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n\n/**\n * Location object holding common properties returned by the underlying geocoding and reverse geocoding web service.\n *\n * @property {Gp.Point} position - Position of the location given in the requested coordinates system.\n * @property {String} type - location type \"StreetAddress\" (for an address), \"PositionOfInterest\" (for a place name) or \"CadastralParcel\" (for cadastral parcel).\n * @property {String} matchType - how geocoding is performed : \"street number\" (exact address), \"street enhanced\" (street number calculated by interpolation), \"street\" (only the street), \"city\" (only the city).\n * @property {Object} placeAttributes - Associative array matching the following attributes with their values given by the underlying web service :\n *\n * *Common attributes : *\n *\n * - **freeform** - freeform complete Address.\n * - **bbox** - Bounding Box *{@link Gp.BBox}*.\n * - **municipality** - Municipality\n *\n * *if type == \"StreetAddress\" : *\n * \n * - **number** - Street number. \n * - **ID** - Identifier of the address in the [BD ADRESSE Database]{@link http://professionnels.ign.fr/bdadresse}.\n * - **IDTR** - Identifier of the lineString in the [BD ADRESSE Database]{@link http://professionnels.ign.fr/bdadresse}.\n * - **postalCode** - PostCode \n * - **quality** - Geocoding quality ([see]{@link http://api.ign.fr/tech-docs-js/developpeur/search.html})\n * - **street** - Street name \n * - **territory** - French Territory code \n * - **commune** - City\n * - **department** - Department\n * - **insee** - INSEE Code\n * \n * \n * *if type == \"PositionOfInterest\" :*\n * \n * - **importance** - Place name importance \n * - **nature** - Place name nature\n * - **postalCode** - PostCode\n * - **territory** - French Territory code \n * - **commune** - City\n * - **department** - Department\n * - **insee** - INSEE Code\n *\n * \n * *si type = \"CadastralParcel\" :*    \n * \n * - **absorbedCity** - when a parcel comes from a city that was absorbed by another, code of that old city. \"000\" otherwise.\n * - **arrondissement** - arrondissement \n * - **cadastralParcel** - cadastral parcel code\n * - **district** - district\n * - **sheet** - Parcel Sheet (eg. \"1\").\n * - **number** - Parcel Number (eg. \"0041\")\n * - **section** - Parcel Section (eg. \"0D\").\n * - **commune** - Parcel municipality.\n * - **department** - Parcel Department.\n * - **insee** - INSEE Code.\n * - **origin** - Parcel origin (see \"type\" attribute in the [underlying web service response]{@link http://api.ign.fr/tech-docs-js/developpeur/search.html#Cadastral_parcels_search})\n *\n * @namespace\n * @alias Gp.Services.Geocode.GeocodedLocation\n */\nfunction GeocodedLocation () {\n\n    if (!(this instanceof GeocodedLocation)) {\n        throw new TypeError(\"GeocodedLocation constructor cannot be called as a function.\");\n    }\n\n    this.position = {\n        x : null,\n        y : null\n    };\n\n    this.matchType = null;\n\n    this.placeAttributes = {};\n\n    this.type = null;\n\n}\n\nGeocodedLocation.prototype = {\n\n    constructor : GeocodedLocation\n\n};\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (GeocodedLocation);\n\n\n/***/ }),\n/* 16 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/**\n * Response object for {@link module:Services~route Gp.Services.route ()} invocation when successful. Received as the argument of onSuccess callback function.\n *\n * @property {Gp.BBox} bbox - Bounding Box of the route. Given when provideBBox parameter is used in function call.\n * @property {Object} routeGeometry - Geometry (expressed in [GeoJSON]{@link http://geojson.org/}) of the route.\n * @property {Array.<Gp.Services.Route.RouteInstruction>} routeInstructions - Instructions of the route.\n * @property {String} totalDistance - Length of the route. If distanceUnit parameter was set to \"km\" (default), totalDistance is a string containing the total distance expressed in kilometers, followed by \" Km\" (e.g. : \"19.6 Km\"). If distanceUnit parameter was set to \"m\", totalDistance is a string containing the total distance expressed in meters (e.g. : \"19599.14\").\n * @property {Float} totalTime - Route duration in seconds.\n *\n * @namespace\n * @alias Gp.Services.RouteResponse\n */\nfunction RouteResponse () {\n\n    if (!(this instanceof RouteResponse)) {\n        throw new TypeError(\"RouteResponse constructor cannot be called as a function.\");\n    }\n\n    this.totalTime = null;\n\n    this.totalDistance = null;\n\n    this.bbox = {\n        left : null,\n        right : null,\n        top : null,\n        bottom : null\n    };\n\n    this.routeGeometry = null; // FIXME can be null if option 'geometryInInstructions' is true !\n\n    this.routeInstructions = [];\n}\n\nRouteResponse.prototype = {\n\n    constructor : RouteResponse\n\n};\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (RouteResponse);\n\n\n/***/ }),\n/* 17 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n\n/**\n * Single Route Instruction object.\n *\n * @property {String} code - Instruction code :\n *\n * - \"F\" : Straight forward\n * - \"B\" : U-turn\n * - \"L\" : turn left\n * - \"R\" : turn right\n * - \"BL\" : turn left strongly\n * - \"BR\" : turn right strongly\n * - \"FL\" : turn lightly to the left\n * - \"FR\" : turn lightly to the right\n * - \"round_about_entry\" : round about entry\n * - \"round_about_exit\" : round about exit\n *\n * @property {String} instruction - Instruction text : translated code + street name\n * @property {Object} geometry - Geometry (expressed in [GeoJSON]{@link http://geojson.org/}) of the street.\n * @property {Float} distance - Length of the instruction. Expressed in km or m, depending on distanceUnit parameter.\n * @property {Float} duration - Instruction duration in seconds.\n *\n * @namespace\n * @alias Gp.Services.Route.RouteInstruction\n */\nfunction RouteInstruction () {\n\n    if (!(this instanceof RouteInstruction)) {\n        throw new TypeError(\"RouteInstruction constructor cannot be called as a function.\");\n    }\n\n    this.duration = null;\n\n    this.distance = null;\n\n    this.code = null;\n\n    this.instruction = null;\n\n    this.geometry = null; // FIXME can be null if option 'geometryInInstructions' is false !\n}\n\nRouteInstruction.prototype = {\n\n    constructor : RouteInstruction\n\n};\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (RouteInstruction);\n\n\n/***/ }),\n/* 18 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n\n/**\n * Response object for {@link module:Services~isoCurve Gp.Services.isoCurve ()} invocation when successful. Received as the argument of onSuccess callback function.\n *\n * @property {Float} distance - distance (expressed in meters) used for the request.\n * @property {Float} time - time (expressed in seconds) used for the request.\n * @property {Object} geometry - Geometry (expressed in [GeoJSON]{@link http://geojson.org/}) of the isocurve.\n * @property {String} id - request id (used by underlying webservice).\n * @property {Gp.Point} location - Position of the start or end point used for the request (expressed in \"srs\" coordinates system).\n * @property {String} message - message\n * @property {String} srs - Identifier of the coordinates system used for the isocurve.\n * \n * @namespace\n * @alias Gp.Services.IsoCurveResponse\n * \n */\nfunction ProcessIsoCurveResponse () {\n\n    if (!(this instanceof ProcessIsoCurveResponse)) {\n        throw new TypeError(\"ProcessIsoCurveResponse constructor cannot be called as a function.\");\n    }\n\n    this.message = null;\n\n    this.id = null;\n\n    this.location = {};\n    this.location.x = null;\n    this.location.y = null;\n\n    this.srs = null;\n\n    this.geometry = null;\n\n    this.time = null;\n\n    this.distance = null;\n}\n\nProcessIsoCurveResponse.prototype = {\n\n    constructor : ProcessIsoCurveResponse\n\n};\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (ProcessIsoCurveResponse);\n\n\n/***/ }),\n/* 19 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__Utils_Helper__ = __webpack_require__(5);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_es6_promise__ = __webpack_require__(49);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_es6_promise___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_es6_promise__);\n/* global Promise */\n\n/**\n * Requtes Ajax (utilisation des Promises)\n * cf. https://xhr.spec.whatwg.org/\n * cf. https://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest\n *\n * @module XHR\n * @private\n * @alias Gp.Protocols.XHR\n * @see dependance 'promise'\n */\n\n\n\n\n// import __request from \"request\";\n// import __xmldom from \"xmldom\";\n\nvar XHR = {\n\n    /**\n     * Interface unique d'envoi d'une requte.\n     *\n     * @method call\n     * @static\n     * @param {Object} settings - options generales\n     * @param {String} settings.url    - url du service\n     * @param {String} settings.method - GET, POST, PUT, DELETE\n     * @param {String} settings.format - format de la reponse du service : json, xml ou null (brute)\n     * @param {String} settings.data   - content (post) ou param (get)\n     * @param {String} settings.proxy  - proxy url\n     * @param {Object|String} settings.headers - (post) ex. referer\n     * @param {Object|String} settings.content - (post) ex. 'application/json'\n     * @param {String} settings.timeOut - timeout = 0 par defaut\n     * @param {String} settings.scope - this\n     * @param {Function} settings.onResponse - callback\n     * @param {Function} settings.onFailure  - callback\n     */\n    call : function (settings) {\n\n        // logger\n        var logger = __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__[\"a\" /* default */].getLogger(\"XHR\");\n        logger.trace(\"[XHR::call()]\");\n\n        // FIXME\n        // To polyfill the global environment\n        __WEBPACK_IMPORTED_MODULE_2_es6_promise___default.a.polyfill();\n\n        // test sur les settings obligatoires\n        if (!settings.url) {\n            throw new Error(\"missing parameter : url is not defined !\");\n        }\n\n        if (!settings.method) {\n            throw new Error(\"missing parameter : method is not defined !\");\n        }\n\n        if (!settings.format) {\n            settings.format = \"text\"; // reponse brute !\n        }\n\n        var options = {};\n        options.url = settings.url;\n        options.data = settings.data ? settings.data : null;\n        options.method = settings.method;\n        options.timeOut = settings.timeOut || 0;\n        options.scope = settings.scope || this;\n        options.proxy = settings.proxy || null;\n        options.content = settings.content || null;\n        options.headers = settings.headers || {\n            referer : \"http://localhost\"\n        };\n\n        // test sur les valeurs de 'settings.method'\n        switch (settings.method) {\n            case \"DELETE\":\n            case \"GET\":\n                break;\n            case \"PUT\":\n            case \"POST\":\n                // on force sur ces params spcifiques au mode POST\n                options.content = settings.content ? settings.content : \"application/x-www-form-urlencoded\"; // FIXME en attente des services : bascule en \"application/xml\" ou \"application/json\"\n                options.headers = settings.headers ? settings.headers : {\n                    referer : \"http://localhost\" // todo ...\n                };\n                break;\n            case \"HEAD\":\n            case \"OPTIONS\":\n                throw new Error(\"HTTP method not yet supported !\");\n            default:\n                throw new Error(\"HTTP method unknown !\");\n        }\n\n        // test sur les valeurs de 'settings.format'\n        switch (settings.format) {\n            case \"text\":\n                this.__call(options)\n                    .then(function (response) {\n                        logger.trace(response);\n                        settings.onResponse.call(this, response);\n                    })\n                    .catch(function (error) {\n                        settings.onFailure.call(this, error);\n                    });\n                break;\n            case \"json\":\n                this.__callJSON(options)\n                    .then(function (response) {\n                        logger.trace(response);\n                        settings.onResponse.call(this, response);\n                    })\n                    .catch(function (error) {\n                        settings.onFailure.call(this, error);\n                    });\n                break;\n            case \"xml\":\n                this.__callXML(options)\n                    .then(function (response) {\n                        logger.trace(response);\n                        settings.onResponse.call(this, response);\n                    })\n                    .catch(function (error) {\n                        settings.onFailure.call(this, error);\n                    });\n                break;\n            default:\n                throw new Error(\"This output Format is not yet supported !\");\n        }\n    },\n\n    /**\n     * Requete\n     *\n     * @method __call\n     * @private\n     * @param  {Object} options - options\n     * @return {Object} promise\n     */\n    __call : function (options) {\n\n        var logger = __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__[\"a\" /* default */].getLogger(\"XHR\");\n        logger.trace(\"[XHR::__call()]\");\n\n        var promise = new Promise(\n            function (resolve, reject) {\n\n                // traitement du corps de la requte\n                var corps = (options.method === \"POST\" || options.method === \"PUT\") ? true : false;\n\n                // seulement si options.data n'est pas vide (peut tre un objet ou une chaine de caractres)\n                if (options.data && (( typeof options.data === \"object\" && Object.keys(options.data).length) || ( typeof options.data === \"string\" && options.data.length)) && !corps) {\n                    options.url = __WEBPACK_IMPORTED_MODULE_1__Utils_Helper__[\"a\" /* default */].normalyzeUrl(options.url, options.data);\n                }\n\n                logger.trace(\"URL = \", options.url);\n\n                var hXHR = null;\n\n                // test on env. nodejs or browser\n                if ( typeof window === \"undefined\") {\n\n                    // Utilisation du module :\n                    // cf. http://blog.modulus.io/node.js-tutorial-how-to-use-request-module\n\n                    var req = __webpack_require__(52);// __request\n\n                    // mapping data avec body param. pour le mode POST ou PUT (?)\n                    if (options.data && typeof options.data === \"string\" && corps) {\n                        options.body = options.data;\n                    }\n\n                    // FIXME ERROR : self signed certificate in certificate chain\n                    options.rejectUnauthorized = false;\n\n                    req(options, function (error, response, body) {\n\n                        if (!error && response.statusCode == 200 && body) {\n                            resolve(body);\n                        } else {\n                            reject(\"Errors Occured on Http Request (nodejs) : \" + error);\n                        }\n                    });\n                } else {\n\n                    if (window.XMLHttpRequest) {\n\n                        logger.trace(\"XMLHttpRequest\");\n\n                        hXHR = new XMLHttpRequest();\n                        hXHR.open(options.method, options.url, true); // async\n                        hXHR.overrideMimeType = options.content;\n\n                        // gestion du timeout\n                        var onTimeOutTrigger = null;\n                        if (options.timeOut > 0) {\n                            // FIXME le timeout interne ne me permet pas de declencher le bon message...\n                            // hXHR.timeout = options.timeOut;\n                            logger.trace(\"XHR - TimeOut actif !\");\n                            /**\n                             * Description\n                             *\n                             * @method onTimeOutTrigger\n                             * @private\n                             */\n                            onTimeOutTrigger = window.setTimeout(\n                                function () {\n                                    var message = \"TimeOut Occured on Http Request with XMLHttpRequest !\";\n                                    reject({\n                                        message : message,\n                                        status : -1\n                                    });\n                                }, options.timeOut);\n                        }\n\n                        if (corps) {\n                            // headers, data, content of data\n                            // cf. https://dvcs.w3.org/hg/xhr/raw-file/tip/Overview.html#dom-xmlhttprequest-setrequestheader\n                            logger.trace(\"data = \", options.data);\n                            hXHR.setRequestHeader(\"Content-type\", options.content);\n                            // FIXME refused to set unsafe header content-length javascript\n                            // hXHR.setRequestHeader (\"Content-length\", options.data.length);\n                            // hXHR.setRequestHeader (\"Referer\", options.headers.referer);\n                        }\n\n                        /**\n                         * Description\n                         * FIXME ne se declenche pas !?\n                         *\n                         * @method onerror\n                         * @private\n                         */\n                        hXHR.onerror = function (e) {\n                            console.log(e);\n                            reject(new Error(\"Errors Occured on Http Request with XMLHttpRequest !\"));\n                        };\n\n                        /**\n                         * Description\n                         * FIXME ne se declenche pas !?\n                         *\n                         * @method ontimeout\n                         * @private\n                         */\n                        hXHR.ontimeout = function () {\n                            reject(new Error(\"TimeOut Occured on Http Request with XMLHttpRequest !\"));\n                        };\n\n                        /**\n                         * Description\n                         *\n                         * @method onreadystatechange\n                         * @private\n                         */\n                        hXHR.onreadystatechange = function () {\n\n                            if (hXHR.readyState == 4) { // DONE\n                                if (hXHR.status == 200) {\n                                    window.clearTimeout(onTimeOutTrigger);\n                                    resolve(hXHR.response);\n                                } else {\n                                    var message = \"Errors Occured on Http Request (status : '\" + hXHR.status + \"' | response : '\" + hXHR.response + \"')\";\n                                    var status = hXHR.status;\n                                    reject({\n                                        message : message,\n                                        status : status\n                                    });\n                                }\n                            }\n\n                        };\n\n                        // gestion du content data\n                        var data4xhr = (options.data && corps) ? options.data : null;\n\n                        hXHR.send(data4xhr);\n\n                    } else if (window.XDomainRequest) {\n                        // worked in Internet Explorer 810 only !\n                        logger.trace(\"XDomainRequest\");\n\n                        hXHR = new XDomainRequest();\n                        hXHR.open(options.method, options.url);\n\n                        hXHR.overrideMimeType = options.content;\n\n                        if (options.timeOut > 0) {\n                            hXHR.timeout = options.timeout;\n                            logger.trace(\"XHR - TimeOut actif !\");\n                        }\n\n                        if (corps) {\n                            // headers, data, content of data\n                            // cf. https://dvcs.w3.org/hg/xhr/raw-file/tip/Overview.html#dom-xmlhttprequest-setrequestheader\n                            hXHR.setRequestHeader(\"Content-type\", options.content);\n                            // FIXME refused to set unsafe header content-length javascript\n                            // hXHR.setRequestHeader (\"Content-length\", options.data.length);\n                            // hXHR.setRequestHeader (\"Referer\", options.headers.referer);\n                        }\n\n                        /**\n                         * Description\n                         *\n                         * @method onerror\n                         * @private\n                         */\n                        hXHR.onerror = function () {\n                            reject(new Error(\"Errors Occured on Http Request with XMLHttpRequest !\"));\n                        };\n\n                        /**\n                         * Description\n                         *\n                         * @method ontimeout\n                         * @private\n                         */\n                        hXHR.ontimeout = function () {\n                            reject(new Error(\"TimeOut Occured on Http Request with XMLHttpRequest !\"));\n                        };\n\n                        /**\n                         * Description\n                         *\n                         * @method onload\n                         * @private\n                         */\n                        hXHR.onload = function () {\n\n                            if (hXHR.status == 200) {\n                                resolve(hXHR.responseText);\n                            } else {\n                                var message = \"Errors Occured on Http Request (status : '\" + hXHR.status + \"' | response : '\" + hXHR.responseText + \"')\";\n                                var status = hXHR.status;\n                                reject({\n                                    message : message,\n                                    status : status\n                                });\n                            }\n                        };\n\n                        var data4xdr = (options.data && corps) ? options.data : null;\n\n                        hXHR.send(data4xdr);\n\n                    } else {\n                        throw new Error(\"CORS not supported\");\n                    }\n                }\n            }\n        );\n\n        return promise;\n    },\n\n    /**\n     * Requete avec parser JSON\n     *\n     * @method __callJSON\n     * @private\n     * @param  {Object} options - options\n     * @return {Object} promise\n     */\n    __callJSON : function (options) {\n        return this.__call(options)\n            .then(JSON.parse)\n            .catch(function (error) {\n                console.log(\"_callJSON failed on : \", options.url, error);\n                // FIXME pas d'exception, laissons le fil se derouler...\n                // throw error;\n            });\n    },\n\n    /**\n     * Requete avec parser XML\n     *\n     * @method __callXML\n     * @private\n     * @param  {Object} options - options\n     * @return {Object} promise\n     */\n    __callXML : function (options) {\n        return this.__call(options)\n            .then(function (response) {\n                var xmlDoc;\n\n                // test on env. nodejs or browser\n                if ( typeof window === \"undefined\" ) {\n                    var DOMParser = __webpack_require__(20).DOMParser; // __xmldom.DOMParser\n                    xmlDoc = new DOMParser().parseFromString(response, \"text/xml\");\n                } else {\n                    if (window.DOMParser) {\n                        var parser = new window.DOMParser();\n                        xmlDoc = parser.parseFromString(response, \"text/xml\");\n                    } else { // IE\n                        xmlDoc = new window.ActiveXObject(\"Microsoft.XMLDOM\");\n                        xmlDoc.async = false;\n                        xmlDoc.loadXML(response);\n                    }\n                }\n\n                return xmlDoc;\n            })\n            .catch(function (error) {\n                console.log(\"__callXML failed on : \", options.url, error);\n                // FIXME pas d'exception, laissons le fil se derouler...\n                // throw error;\n            });\n    }\n\n};\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (XHR);\n\n\n/***/ }),\n/* 20 */\n/***/ (function(module, exports) {\n\nmodule.exports = __WEBPACK_EXTERNAL_MODULE_20__;\n\n/***/ }),\n/* 21 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__AltiRequest__ = __webpack_require__(22);\n\n\n\n\n/**\n * @classdesc\n *\n * Classe de gestion des param. des requtes de type POINT du service altimetrique.\n *\n * @constructor\n * @alias Gp.Services.Alti.Request.AltiElevationRequest\n * @param {Object} options - options\n * @param {Boolean}  options.zonly - false|true\n *\n * @private\n */\nfunction AltiElevationRequest (options) {\n\n    if (!(this instanceof AltiElevationRequest)) {\n        throw new TypeError(\"AltiElevationRequest constructor cannot be called as a function.\");\n    }\n\n    /**\n     * Nom de la classe (heritage)\n     */\n    this.CLASSNAME = \"AltiElevationRequest\";\n\n    // appel du constructeur par heritage\n    __WEBPACK_IMPORTED_MODULE_1__AltiRequest__[\"a\" /* default */].apply(this, arguments);\n\n    this.logger.trace(\"[Constructeur AltiElevationRequest ()]\");\n\n    /**\n     * Z uniquement.\n     * true|false\n     */\n    this.zonly = this.options.zonly || false; // test des options hrites !\n\n}\n\n/**\n * @lends module:AltiElevationRequest#\n */\n\nAltiElevationRequest.prototype = Object.create(__WEBPACK_IMPORTED_MODULE_1__AltiRequest__[\"a\" /* default */].prototype, {\n\n    /**\n     * Setter/getter pour \"zonly\"\n     */\n    zonly : {\n        /** getter */\n        get : function () {\n            return this._zonly;\n        },\n        /** setter */\n        set : function (z) {\n            this._zonly = z;\n        }\n    }\n\n});\n\n/**\n * Constructeur (alias)\n */\nAltiElevationRequest.prototype.constructor = AltiElevationRequest;\n\n/**\n * Tableau de clefs/valeurs pour param.\n *\n * @returns {Array}\n */\nAltiElevationRequest.prototype.getData = function () {\n\n    // par glop..., appel de AltiRequest::getData () !\n    var map = [];\n    map.push({\n        k : \"lon\",\n        v : this.getLon()\n    });\n    map.push({\n        k : \"lat\",\n        v : this.getLat()\n    });\n    // map.push({k : \"delimiter\", v : this.delimiter}); // FIXME on retire le param \"delimiter\"\n    map.push({\n        k : \"indent\",\n        v : this.indent\n    });\n    map.push({\n        k : \"crs\",\n        v : this.crs\n    });\n    map.push({\n        k : \"zonly\",\n        v : this.zonly\n    });\n    map.push({\n        k : \"format\",\n        v : this.format\n    });\n\n    return map;\n};\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (AltiElevationRequest);\n\n\n/***/ }),\n/* 22 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__ = __webpack_require__(0);\n\n\n\n/**\n * @classdesc\n * Classe de gestion des param. des requtes du service altimetrique.\n *\n * @constructor\n * @alias Gp.Services.Alti.Request.AltiRequest\n * @param {Object} options - options\n * @param {Object}   options.positions - tableau de coordonnes lon/lat\n * @param {String}   options.delimiter - \"|\"\n * @param {Boolean}  options.indent - false|true\n * @param {String}   options.crs - \"CRS:84\"\n * @param {String}   options.format - \"JSON|XML\"\n *\n * @private\n */\nfunction AltiRequest (options) {\n\n    if (!(this instanceof AltiRequest)) {\n        throw new TypeError(\"AltiRequest constructor cannot be called as a function.\");\n    }\n\n    this.logger = __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__[\"a\" /* default */].getLogger();\n    this.logger.trace(\"[Constructeur AltiRequest ()]\");\n\n    /**\n     * Options en paramtres du constructeur.\n     */\n    this.options = options || {};\n\n    /**\n     * Liste des coordonnes.\n     * @example\n     * var c = [{lon : \"\", lat : \"\"}, {lon : \"\", lat : \"\"}];\n     */\n    this.positions = this.options.positions || [];\n\n    /**\n     * Caractre de sparation.\n     * Par defaut, \"|\".\n     */\n    this.delimiter = this.options.delimiter || \"|\";\n\n    /**\n     * Indentation.\n     * true|false\n     */\n    this.indent = this.options.indent || false;\n\n    /**\n     * Projection.\n     * Par defaut, CRS:84.\n     */\n    this.crs = this.options.crs || \"CRS:84\";\n\n    /**\n     * format de sortie.\n     * Par defaut, \"json\".\n     */\n    this.format = this.options.format || \"json\";\n\n}\n\n/**\n * CLASSNAME\n */\nAltiRequest.CLASSNAME = \"AltiRequest\";\n\nAltiRequest.prototype = {\n\n    /**\n     * @lends module:AltiRequest#\n     */\n\n    /**\n     * Constructeur (alias)\n     */\n    constructor : AltiRequest,\n\n    /**\n     * Ajout d\"une liste de coordonnes.\n     *\n     * @param {Object[]} lstPosition - liste de positions\n     * @example\n     * obj.setPositions ([{lon : \"0.15\", lat : \"0.15\"}, {lon : \"1.15\", lat : \"1.15\"}]);\n     */\n    setPositions : function (lstPosition) {\n        var positions = [];\n        for (var i = 0; i < lstPosition.length; i++) {\n            var o = lstPosition[i];\n            if (o.lon && o.lat) {\n                positions.push(o);\n            }\n        }\n\n        this.positions = positions;\n    },\n\n    /**\n     * Liste des coordonnes.\n     *\n     * @param {Int} pos - position\n     * @returns {positions}\n     * @example\n     * obj.getPositions ();  // [{lon : \"\", lat : \"\"}, {lon : \"\", lat : \"\"}]\n     * obj.getPositions (0); // [{lon : \"\", lat : \"\"}]\n     */\n    getPositions : function (pos) {\n\n        // FIXME test if not a number !?\n        if (!pos) {\n            return this.positions;\n        }\n\n        var index = this.positions.length - 1;\n        if (pos > index || pos < index) {\n            this.logger.warn(\"index out of range !\");\n            return this.positions;\n        }\n\n        return this.positions[pos];\n    },\n\n    /**\n     * Ajout d\"une liste de coordonnes.\n     *\n     * @param {Object[]} lstPosition - liste de positions\n     * @example\n     * obj.addPositions ([{lon : \"0.15\", lat : \"0.15\"}, {lon : \"1.15\", lat : \"1.15\"}]);\n     */\n    addPositions : function (lstPosition) {\n\n        for (var i = 0; i < lstPosition.length; i++) {\n            var o = lstPosition[i];\n            if (o.lon && o.lat) {\n                this.positions.push(lstPosition[i]);\n            }\n        }\n    },\n\n    /**\n     * Retourne la liste des longitudes avec un caractre de sparation.\n     *\n     * @returns {String} - une liste de longitudes\n     * @example\n     * // out : 0.2367|2.1570|43.789|...\n     */\n    getLon : function () {\n        var lstLon = [];\n        for (var i = 0; i < this.positions.length; i++) {\n            lstLon.push(this.positions[i].lon);\n        }\n        this.logger.trace(lstLon);\n        return lstLon.join(this.delimiter);\n    },\n\n    /**\n     * Retourne la liste des lattitudes avec un caractre de sparation.\n     *\n     * @returns {String} - une liste de lattitudes\n     * @example\n     * // out : 0.2367|2.1570|43.789|...\n     */\n    getLat : function () {\n        var lstLat = [];\n        for (var i = 0; i < this.positions.length; i++) {\n            lstLat.push(this.positions[i].lat);\n        }\n        this.logger.trace(lstLat);\n        return lstLat.join(this.delimiter);\n    }\n\n};\n\n/**\n * Tableau de clefs/valeurs pour param.\n *\n * @returns {Object[]}\n */\nAltiRequest.prototype.getData = function () {\n\n    var map = [];\n\n    map.push({\n        k : \"lon\",\n        v : this.getLon()\n    });\n    map.push({\n        k : \"lat\",\n        v : this.getLat()\n    });\n    map.push({\n        k : \"delimiter\",\n        v : this.delimiter\n    });\n    map.push({\n        k : \"indent\",\n        v : this.indent\n    });\n    map.push({\n        k : \"crs\",\n        v : this.crs\n    });\n    map.push({\n        k : \"format\",\n        v : this.format\n    });\n\n    return map;\n};\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (AltiRequest);\n\n\n/***/ }),\n/* 23 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__AltiRequest__ = __webpack_require__(22);\n\n\n\n\n/**\n * @classdesc\n * Classe de gestion des param. des requtes de type PROFIL du service altimetrique.\n *\n * @constructor\n * @alias Gp.Services.Alti.Request.AltiProfilRequest\n * @param {Object}   options - options\n * @param {String}   options.sampling - 3\n *\n * @private\n */\nfunction AltiProfilRequest (options) {\n\n    if (!(this instanceof AltiProfilRequest)) {\n        throw new TypeError(\"AltiProfilRequest constructor cannot be called as a function.\");\n    }\n\n    /**\n     * Nom de la classe (heritage)\n     */\n    this.CLASSNAME = \"AltiProfilRequest\";\n\n    // appel du constructeur par heritage\n    __WEBPACK_IMPORTED_MODULE_1__AltiRequest__[\"a\" /* default */].apply(this, arguments);\n\n    this.logger.trace(\"[Constructeur AltiProfilRequest ()]\");\n\n    /**\n     * Sampling\n     * Par defaut, 3\n     */\n    this.sampling = this.options.sampling || 3; // test des options hrites !\n\n}\n\n/**\n * @lends module:AltiProfilRequest#\n */\n\nAltiProfilRequest.prototype = Object.create(__WEBPACK_IMPORTED_MODULE_1__AltiRequest__[\"a\" /* default */].prototype, {\n\n    /**\n     * Setter/getter pour \"sampling\"\n     */\n    sampling : {\n        /** getter */\n        get : function () {\n            return this._sampling;\n        },\n        /** setter */\n        set : function (value) {\n            this._sampling = value;\n        }\n    }\n});\n\n/**\n * Constructeur (alias)\n */\nAltiProfilRequest.prototype.constructor = AltiProfilRequest;\n\n/**\n * Tableau de clefs/valeurs pour param.\n *\n * @returns {Object[]}\n */\nAltiProfilRequest.prototype.getData = function () {\n\n    // par glop..., appel de AltiRequest::getData () !\n    var map = [];\n    map.push({\n        k : \"lon\",\n        v : this.getLon()\n    });\n    map.push({\n        k : \"lat\",\n        v : this.getLat()\n    });\n    // map.push({k : \"delimiter\", v : this.delimiter}); // FIXME on retire le param \"delimiter\"\n    map.push({\n        k : \"indent\",\n        v : this.indent\n    });\n    map.push({\n        k : \"crs\",\n        v : this.crs\n    });\n    map.push({\n        k : \"sampling\",\n        v : this.sampling\n    });\n    map.push({\n        k : \"format\",\n        v : this.format\n    });\n\n    return map;\n};\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (AltiProfilRequest);\n\n\n/***/ }),\n/* 24 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n\n/**\n * Response object for {@link module:Services~getConfig Gp.Services.getConfig ()} invocation when successful. Received as the argument of onSuccess callback function.\n *\n * @property {Object} generalOptions - General properties for default map configuration resources.\n * @property {Object} generalOptions.apiKeys - Object that associates apiKey (s) with an array of resources IDs availables with that key.\n * @property {String} generalOptions.title - Underlying web service Title.\n * @property {String} generalOptions.defaultGMLGFIStyle - XSL URL used by default to translate an XML GetFeatureInfo response into an HTML array.\n * @property {String} generalOptions.theme - default theme (FIXME : for what ?)\n * @property {Array.<Float>} generalOptions.wgs84Resolutions - geographical resolutions Array for each [zoom level of the Geoportal platform]{@link http://api.ign.fr/tech-docs-js/webmaster/layers.html#Geoportal_resolutions} from 0 to 21. Expressed in degrees/pixel.\n * @property {Object} layers - Associative array mapping resources availables IDs (keys) with their properties (values given as {@link Gp.Services.Config.Layer}).\n * @property {Object} territories - Associative array mapping french territories IDs (keys) with their properties (values given as {@link Gp.Services.Config.Territory}).\n * @property {Object} tileMatrixSets - Associative Array mapping TileMatrixSets IDs (keys) availables with their properties (values given as {@link Gp.Services.Config.TileMatrixSet}).\n * @property {Object} services - Associative Array mapping Geoportal web services IDs (keys) availables with their properties (values given as {@link Gp.Services.Config.Service}).\n *\n * @namespace\n * @alias Gp.Services.GetConfigResponse\n */\nfunction AutoConfResponse () {\n\n    if (!(this instanceof AutoConfResponse)) {\n        throw new TypeError(\"AutoConfResponse constructor cannot be called as a function.\");\n    }\n\n    this.generalOptions = {\n        apiKeys : {},\n        title : null,\n        defaultGMLGFIStyle : null,\n        theme : null,\n        wgs84Resolutions : []\n    };\n\n    this.layers = {};\n\n    this.territories = {};\n\n    this.tileMatrixSets = {};\n\n    this.services = {};\n\n}\n\nAutoConfResponse.prototype = {\n\n    /*\n     * Constructor (alias)\n     */\n    constructor : AutoConfResponse,\n\n    /**\n     * Check if config is loaded for a given key\n     *\n     * @param {String} apiKey - Access key to Geoportal platform\n     * @returns {Boolean} isConfLoaded - true if config is already loaded, false otherwise\n     */\n    isConfLoaded : function (apiKey) {\n        if (!apiKey) {\n            return;\n        }\n        if (this.generalOptions.apiKeys[apiKey]) {\n            return true;\n        }\n        return false;\n    },\n\n    /**\n     * Returns an array of Geoportal layers identifiers, corresponding to an API contract key.\n     *\n     * @param {String} apiKey - Access key to Geoportal platform\n     * @returns {Array} apiKeys - Array of geoportal layers identifiers\n     */\n    getLayersId : function (apiKey) {\n        return this.generalOptions.apiKeys[apiKey];\n    },\n\n    /**\n     * Returns an associative array of Geoportal layers configurations, corresponding to an API contract key.\n     * If no key is specified, all layers from configuration are returned.\n     *\n     * @param {String} apiKey - Access key to Geoportal platform\n     * @returns {Object} layers - Object which properties are layers identifiers, and corresponding\n     *      values are instances of <Gp.Services.Config.Layer>.\n     */\n    getLayersConf : function (apiKey) {\n        var layers = {};\n        var layersIdArray = this.getLayersId (apiKey);\n        if (layersIdArray) {\n            for (var i = 0; i < layersIdArray.length; i++) {\n                var lyrId = layersIdArray[i];\n                layers[lyrId] = this.layers[lyrId];\n            }\n        }\n        return layers;\n    },\n\n    /**\n     * Returns a geoportal layer configuration, given its identifier\n     *\n     * @param {String} layerId - Geoportal layer identifier (e.g. \"GEOGRAPHICALGRIDSYSTEMS.MAPS$GEOPORTAIL:OGC:WMTS\")\n     * @return {Object} layer - Layer configuration : instance of {@link Gp.Services.Config.Layer}\n     */\n    getLayerConf : function (layerId) {\n        if (!this.layers) {\n            return;\n        }\n        return this.layers[layerId];\n    },\n\n    /**\n     * Returns an associative array of Tile Matrix Sets configurations.\n     *\n     * @return {Object} tileMatrixSets - Object which properties are TMS identifiers,\n     *      and corresponding values are instances of {@link Gp.Services.Config.TileMatrixSet}.\n     */\n    getTileMatrixSets : function () {\n        return this.tileMatrixSets;\n    },\n\n    /**\n     * Returns a Tile Matrix Sets configuration, given its identifier.\n     *\n     * @param {String} tmsID - Tile Matrix Set identifier (e.g. : \"PM\")\n     * @return {Object} tileMatrixSet - Tile Matrix Set configuration, instance of {@link Gp.Services.Config.TileMatrixSet}\n     */\n    getTMSConf : function (tmsID) {\n        if (!this.tileMatrixSets) {\n            return;\n        }\n        return this.tileMatrixSets[tmsID];\n    },\n\n    /**\n     * Returns an associative array of territories configurations.\n     *\n     * @return {Object} territories - Object which properties are territory identifiers,\n     *      and corresponding values are instances of {@link Gp.Services.Config.Territory}.\n     */\n    getTerritories : function () {\n        return this.territories;\n    },\n\n    /**\n     * Returns a territory configuration, given its identifier.\n     *\n     * @param {String} territoryID - territory identifier (e.g. \"FXX\")\n     * @return {Object} territory - Territory configuration, instance of {@link Gp.Services.Config.Territory}\n     */\n    getTerritoryConf : function (territoryID) {\n        if (!this.territories) {\n            return;\n        }\n        return this.territories[territoryID];\n    },\n\n    /**\n     * Returns an associative array of services configurations.\n     *\n     * @return {Object} services - Object which properties are services identifiers,\n     *      and corresponding values are instances of {@link Gp.Services.Config.Service}.\n     */\n    getServices : function () {\n        return this.services;\n    },\n\n    /**\n     * Returns a service configuration, given its identifier.\n     *\n     * @param {String} serviceID - service identifier (e.g. \"OGC:WMTS\")\n     * @return {Object} service - service configuration, instance of {@link Gp.Services.Config.Service}\n     */\n    getServiceConf : function (serviceID) {\n        if (!this.services) {\n            return;\n        }\n        return this.services[serviceID];\n    }\n\n};\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (AutoConfResponse);\n\n\n/***/ }),\n/* 25 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n\n/**\n *\n * Object used to express a geographical (BBOX, scale) and temporal constraint.\n *\n * @property {String} crs - Coordinates System ID used to express coordinates contraints.\n * @property {Gp.BBox} bbox - Constraint Bounding Box.\n * @property {Number} minScaleDenominator - Minimum scale denominator where constraint applies.\n * @property {Number} maxScaleDenominator - Maximum scale denominator where constraint applies.\n * @property {Array.<String>} temporalExtent - Array expressing the time interval of the constraint [minT, maxT]. Dates are expressed in the [ISO-8601]{@link https://en.wikipedia.org/wiki/ISO_8601} way.\n *\n * @namespace\n * @alias Gp.Services.Config.Constraint\n */\n\nfunction Constraint () {\n\n    if (!(this instanceof Constraint)) {\n        throw new TypeError(\"Constraint constructor cannot be called as a function.\");\n    }\n\n    this.crs = null;\n\n    this.bbox = {\n        left : null,\n        right : null,\n        top : null,\n        bottom : null\n    };\n\n    this.minScaleDenominator = null;\n\n    this.maxScaleDenominator = null;\n\n    this.temporalExtent = [null, null];\n\n}\n\nConstraint.prototype = {\n\n    constructor : Constraint\n\n};\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (Constraint);\n\n\n/***/ }),\n/* 26 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n\n/**\n * Object used to describe a format to use with Geoportal resources.\n *\n * @property {Boolean} current - If true, then this format is used by default.\n * @property {String} name - Format mime-type.\n *\n * @namespace\n * @alias Gp.Services.Config.Format\n */\n\nfunction Format () {\n\n    if (!(this instanceof Format)) {\n        throw new TypeError(\"Format constructor cannot be called as a function.\");\n    }\n\n    this.current = null;\n\n    this.name = null;\n}\n\nFormat.prototype = {\n\n    constructor : Format\n\n};\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (Format);\n\n\n/***/ }),\n/* 27 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n\n/**\n * Object used to describe geoportal resource (WMTS, WMS, WFS layers, geocoding resources or elevation service) parameters. Properties may be used or not depending on the resource type.\n *\n * @property {String} name - name of the resource to use with the webservice that serves it (eg : \"GEOGRAPHICALGRIDSYSTEMS.MAPS\").\n * @property {String} title - Human readable name for the resource.\n * @property {String} description - Resource description.\n * @property {String} layerId - Unique resource Identifier (eg : \"GEOGRAPHICALGRIDSYSTEMS.MAPS$GEOPORTAIL:OGC:WMTS\")\n * @property {String} quicklookUrl - Image URL for the resource.\n * @property {Object} serviceParams - Informations about the webservice that serves the resource (OpenLS, WFS, WMTS)\n * @property {String} serviceParams.id - Web Service identifier (\"OGC:WMTS\", \"OGC:OPENLS;ReverseGeocode\", etc...)\n * @property {Object} serviceParams.serverUrl - Associative array mapping geoportal access key (keys) with their properties (URLs of the web service, with the geoportal access key).\n * @property {String} serviceParams.version - webservice version.\n * @property {String} defaultProjection - coordinates system ID used by default for the resource (WMS or WFS layer) or of the TileMatrixSet used by the WMTS layer.\n * @property {Array.<String>} additionalProjections - additional coordinates systems IDs availables for the resource, others than the default one (see defaultProjection) (WMS and WFS layers only).\n * @property {Array.<Gp.Services.Config.Format>} formats - Formats availables for the resource.\n * @property {Array.<Gp.Services.Config.Legend>} legends - Informations about legends associated to the resource.\n * @property {Array.<Gp.Services.Config.Metadata>} metadata - Informations about metadata associated to the resource.\n * @property {Array.<Gp.Services.Config.Style>} styles - Informations about styles availables for the resources (WMS, WFS and WMTS only).\n * @property {Array.<Gp.Services.Config.Thematic>} thematics - Informations about thematics associated to the resource.\n * @property {Gp.Services.Config.Constraint} globalConstraint - geographical constraint for the resource.\n * @property {Array.<Gp.Services.Config.Constraint>} constraints - additionnal geographical constraints for the resource.\n * @property {Array.<Gp.Services.Config.Originator>} originators - Informations about originator of the resource.\n * @property {Object} wmtsOptions - Informations associated to WMTS resources.\n * @property {String} wmtsOptions.tileMatrixSetLink - TileMatrixSet identifier used by the resource (see {@link Gp.Services.Config.TileMatrixSet})\n * @property {Gp.Services.Config.TileMatrixLimit} wmtsOptions.tileMatrixSetLimits - limits of the resource for that TileMAtrixSet.\n * @property {Boolean} queryable - true if a getFeatureInfo request may be done for the resource (WMS or WMTS only).\n * @property {Boolean} hidden - true if the resource is not visible.\n * @property {Boolean} isAggregate - true if the resource is an aggregate of other resources (@see aggregatedLayers).\n * @property {Array.<String>} aggregatedLayers - Layers IDs composing the being described aggregated layer.\n * @property {Array.<String>} apiKeys - Array of access keys that grant access to that resource.\n * @property {Object} dimensions - Dimensions informations associated with the resource.\n * @property {String} dimensions.type\n * @property {String} dimensions.visibilityRange\n * @property {String} dimensions.visibilityMode\n * @property {String} dimensions.noDataValue\n * @property {String} dimensions.geometricType\n *\n * @namespace\n * @alias Gp.Services.Config.Layer\n */\nfunction Layer () {\n\n    if (!(this instanceof Layer)) {\n        throw new TypeError(\"Layer constructor cannot be called as a function.\");\n    }\n\n    // info : une instance de la classe Layer n'a aucune proprit au dpart,.\n    // les attributs possibles sont documents ci-dessus,\n    // et seront implments au fur et  mesure de la lecture de la rponse de l'autoconf, lorsque l'information est rencontre.\n\n}\n\nLayer.prototype = {\n\n    constructor : Layer,\n\n    /**\n     * Returns the layer name\n     *\n     * @returns {String} name - name of the resource to use with the webservice that serves it (eg : \"GEOGRAPHICALGRIDSYSTEMS.MAPS\").\n     */\n    getName : function () {\n        return this.name;\n    },\n\n    /**\n     * Returns the layer title\n     *\n     * @returns {String} title - Human readable name for the resource.\n     */\n    getTitle : function () {\n        return this.title;\n    },\n\n    /**\n     * Returns the layer description\n     *\n     * @returns {String} description - Resource description.\n     */\n    getDescription : function () {\n        return this.description;\n    },\n\n    /**\n     * Returns the layer identifier\n     *\n     * @returns {String} layerId - Unique resource Identifier (eg : \"GEOGRAPHICALGRIDSYSTEMS.MAPS$GEOPORTAIL:OGC:WMTS\")\n     */\n    getLayerId : function () {\n        return this.layerId;\n    },\n\n    /**\n     * Returns the layer quicklookUrl\n     *\n     * @returns {String} quicklookUrl - Image URL for the resource.\n     */\n    getQuicklookUrl : function () {\n        return this.quicklookUrl;\n    },\n\n    /**\n     * Returns the layer default projection\n     *\n     * @returns {String} defaultProjection - coordinates system ID used by default for the resource (WMS or WFS layer) or of the TileMatrixSet used by the WMTS layer.\n     */\n    getDefaultProjection : function () {\n        return this.defaultProjection;\n    },\n\n    /**\n     * Returns the layer projections\n     *\n     * @returns {Array.<String>} projections - coordinates systems IDs availables for the resource, including the default one.\n     */\n    getProjections : function () {\n        var projections = [];\n        projections.push(this.defaultProjection);\n        var proj = projections.concat(this.additionalProjections);\n        return proj;\n    },\n\n    /**\n     * Returns the global BBOX\n     *\n     * @returns {Gp.BBox} bbox - the layer global bounding box, expressed in CRS system.\n     */\n    getBBOX : function () {\n        if (!this.globalConstraint) {\n            return;\n        }\n        return this.globalConstraint.bbox;\n    },\n\n    /**\n     * Returns the layer minimum scale denominator\n     *\n     * @returns {Number} minScaleDenominator - minimum scale denominator for this layer\n     */\n    getMinScaleDenominator : function () {\n        if (!this.globalConstraint) {\n            return;\n        }\n        return this.globalConstraint.minScaleDenominator;\n    },\n\n    /**\n     * Returns the layer maximum scale denominator\n     *\n     * @returns {Number} maxScaleDenominator - maximum scale denominator for this layer\n     */\n    getMaxScaleDenominator : function () {\n        if (!this.globalConstraint) {\n            return;\n        }\n        return this.globalConstraint.maxScaleDenominator;\n    },\n\n    /**\n     * Returns layer Tile Matrix Set identifier if exists\n     *\n     * @returns {String} tileMatrixSetLink - Tile Matrix Set identifier (for instance : \"PM\")\n     */\n    getTMSID : function () {\n        if (this.wmtsOptions) {\n            return this.wmtsOptions.tileMatrixSetLink;\n        }\n        return;\n    },\n\n    /**\n     * Returns information about the webservice that serves the resource\n     *\n     * @returns {Object} serviceParams - Information about the webservice that serves the resource (OpenLS, WFS, WMTS)\n     */\n    getServiceParams : function () {\n        return this.serviceParams;\n    },\n\n    /**\n     * Returns Geoportal server url for a given key\n     *\n     * @param {String} apiKey - Access key to Geoportal platform\n     * @returns {String} serverUrl - general URL of the web service (with the geoportal access key)\n     */\n    getServerUrl : function (apiKey) {\n        if (!apiKey || !this.serviceParams || !this.serviceParams.serverUrl) {\n            return;\n        }\n        return this.serviceParams.serverUrl[apiKey];\n    },\n\n    /**\n     * Returns information about legends associated to the resource.\n     *\n     * @returns {Array.<Gp.Services.Config.Legend>} legends - Informations about legends associated to the resource.\n     */\n    getLegends : function () {\n        return this.legends;\n    },\n\n    /**\n     * Returns information about metadata associated to the resource.\n     *\n     * @returns {Array.<Gp.Services.Config.Metadata>} metadata - Informations about metadata associated to the resource.\n     */\n    getMetadata : function () {\n        return this.metadata;\n    },\n\n    /**\n     * Returns information about styles availables for the resources (WMS, WFS and WMTS only).\n     *\n     * @returns {Array.<Gp.Services.Config.Style>} styles - Informations about styles availables for the resources (WMS, WFS and WMTS only).\n     */\n    getStyles : function () {\n        return this.styles;\n    },\n\n    /**\n     * Returns layer default style\n     *\n     * @returns {String} styleName - style identifier (eg : \"normal\", \"bdparcellaire\", ...)\n     */\n    getDefaultStyle : function () {\n        if (!this.styles) {\n            return;\n        }\n        var style;\n        var s = this.styles;\n        for (var i = 0; i < s.length; i++) {\n            if (s[i].current === true) {\n                style = s[i].name;\n                break;\n            }\n        }\n        return style;\n    },\n\n    /**\n     * Returns information about thematics associated to the resource.\n     *\n     * @returns {Array.<Gp.Services.Config.Thematic>} thematics - Informations about thematics associated to the resource.\n     */\n    getThematics : function () {\n        return this.thematics;\n    },\n\n    /**\n     * Returns layer default format\n     *\n     * @returns {String} formatName - Format mime-type. (eg. \"image/jpeg\")\n     */\n    getDefaultFormat : function () {\n        if (!this.formats) {\n            return;\n        }\n        var format;\n        var f = this.formats;\n        for (var i = 0; i < f.length; i++) {\n            if (f[i].current === true) {\n                format = f[i].name;\n                break;\n            }\n        }\n        return format;\n    },\n\n    /**\n     * Returns information about geographical or temporal constraints for the resource\n     *\n     * @returns {Array.<Gp.Services.Config.Constraint>} constraints - Informations about geographical or temporal constraints for the resource\n     */\n    getConstraints : function () {\n        return this.constraints;\n    },\n\n    /**\n     * Returns information about originators of this resource\n     *\n     * @returns {Array.<Gp.Services.Config.Originator>} originators - Informations about originators of this resource\n     */\n    getOriginators : function () {\n        return this.originators;\n    },\n\n    /**\n     * Returns information about dimensions associated with this resource\n     *\n     * @returns {Object} dimensions - Dimensions informations associated with the resource.\n     */\n    getDimensions : function () {\n        return this.dimensions;\n    },\n\n    /**\n     * Returns information about aggregated layers composing the being described layer, in case the resource is an aggregate of other resources.\n     *\n     * @returns {Object} aggregatedLayers - Layers IDs composing the being described aggregated layer.\n     */\n    getAggregatedLayers : function () {\n        if (this.isAggregate) {\n            return this.aggregatedLayers;\n        } else {\n            return;\n        }\n    }\n\n};\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (Layer);\n\n\n/***/ }),\n/* 28 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n\n/**\n * Object used to describe a legend file associated with a geoportal resource (WMTS, WMS, WFS layers). \n *\n * @property {String} format - mime-type of the legend file.\n * @property {String} url - legend file URL\n * @property {Number} minScaleDenominator - minimum scale denominator where this legend applies.\n *\n * @namespace\n * @alias Gp.Services.Config.Legend\n */\n\nfunction Legend () {\n\n    if (!(this instanceof Legend)) {\n        throw new TypeError(\"Legend constructor cannot be called as a function.\");\n    }\n\n    this.format = null;\n\n    this.url = null;\n\n    this.minScaleDenominator = null;\n\n}\n\nLegend.prototype = {\n\n    constructor : Legend\n\n};\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (Legend);\n\n\n/***/ }),\n/* 29 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n\n/**\n * Object used to describe a metadata file associated with a geoportal resource. \n *\n * @property {String} format - mime-type of the metadata file.\n * @property {String} url - metadata file URL\n *\n * @namespace\n * @alias Gp.Services.Config.Metadata\n */\n\nfunction Metadata () {\n\n    if (!(this instanceof Metadata)) {\n        throw new TypeError(\"Metadata constructor cannot be called as a function.\");\n    }\n\n    this.format = null;\n\n    this.url = null;\n\n}\n\nMetadata.prototype = {\n\n    constructor : Metadata\n\n};\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (Metadata);\n\n\n/***/ }),\n/* 30 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n\n/**\n * Object used to describe an Originator of geoportal resource. \n *\n * @property {String} name - originator name\n * @property {String} attribution - originator full name\n * @property {String} logo - originator logo file URL\n * @property {String} url - originator web site URL\n * @property {Array.<Gp.Services.Config.Constraint>} constraints - where and when the originator applies for the ressource.\n *\n * @namespace\n * @alias Gp.Services.Config.Originator\n */\n\nfunction Originator () {\n\n    if (!(this instanceof Originator)) {\n        throw new TypeError(\"Originator constructor cannot be called as a function.\");\n    }\n\n    this.name = null;\n\n    this.attribution = null;\n\n    this.logo = null;\n\n    this.url = null;\n\n    this.constraints = [];\n\n}\n\nOriginator.prototype = {\n\n    constructor : Originator\n\n};\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (Originator);\n\n\n/***/ }),\n/* 31 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n\n/**\n * Object used to describe a web service of the geoportal platform.\n *\n * @property {String} title - Web service name\n * @property {Object} serverUrl - Associative array mapping geoportal access key (keys) with their properties (URLs of the web service, with the geoportal access key).\n * @property {String} version - web service version.\n *\n * @namespace\n * @alias Gp.Services.Config.Service\n */\nfunction Service () {\n\n    if (!(this instanceof Service)) {\n        throw new TypeError(\"Service constructor cannot be called as a function.\");\n    }\n\n    this.title = null;\n\n    this.serverUrl = null;\n\n    this.version = null;\n\n}\n\nService.prototype = {\n\n    constructor : Service\n\n};\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (Service);\n\n\n/***/ }),\n/* 32 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n\n/**\n * Object used to describe a style that may be used for a geoportal resource. \n *\n * @property {String} name - Style identifier (eg : \"normal\", \"bdparcellaire\", ...)\n * @property {String} title - human readable name of the style.\n * @property {Boolean} current - true if this is the default style.\n *\n * @namespace\n * @alias Gp.Services.Config.Style\n */\n\nfunction Style () {\n\n    if (!(this instanceof Style)) {\n        throw new TypeError(\"Style constructor cannot be called as a function.\");\n    }\n\n    this.name = null;\n\n    this.title = null;\n\n    this.current = null;\n\n}\n\nStyle.prototype = {\n\n    constructor : Style\n\n};\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (Style);\n\n\n/***/ }),\n/* 33 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n\n/**\n * Object used to describe properties of a french territory covered by geoportal resources.\n *\n * @property {Boolean} isDefault - if this territory is to use by default.\n * @property {String} defaultCRS - Identifier of the coordinates system to use by default for that territory.\n * @property {Array.<String>} additionalCRS - Identifiers of additional coordinates systems availables for that territory.\n * @property {Array.<String>} defaultLayers - Identifiers of layers to load by default for that territory.\n * @property {Object} defaultOptions - options to use by default for that territory.\n * @property {Number} defaultOptions.resolution - resolution to use by default for that territory (in meter per pixel).\n * @property {Number} defaultOptions.minScaleDenominator - minimum scaleDenominator accessible for that territory.\n * @property {Number} defaultOptions.maxScaleDenominator - maximum scaleDenominator accessible for that territory.\n * @property {Gp.BBox} geoBBox - Bounding Box of the territory (expressed in geographical coordinates)\n * @property {Object} geoCenter - center of the territory (expressed in geographical coordinates)\n * @property {Float} geoCenter.lon - center longitude\n * @property {Float} geoCenter.lat - center latitude\n *\n * @namespace\n * @alias Gp.Services.Config.Territory\n */\nfunction Territory () {\n\n    if (!(this instanceof Territory)) {\n        throw new TypeError(\"Territory constructor cannot be called as a function.\");\n    }\n\n    this.isDefault = null;\n\n    this.defaultCRS = null;\n\n    this.additionalCRS = [];\n\n    this.geoBBOX = {\n        left : null,\n        right : null,\n        top : null,\n        bottom : null\n    };\n\n    this.geoCenter = {\n        lon : null,\n        lat : null\n    };\n\n    this.defaultOptions = {\n        resolution : null,\n        minScaleDenominator : null,\n        maxScaleDenominator : null\n    };\n\n    this.defaultLayers = [];\n\n}\n\nTerritory.prototype = {\n\n    constructor : Territory\n\n};\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (Territory);\n\n\n/***/ }),\n/* 34 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n\n/**\n * Object used to describe a thematic\n *\n * @property {String} name - Thematic name\n * @property {Boolean} inspire - true if the thematic name is an [INSPIRE one]{@link http://inspire.ec.europa.eu/index.cfm/pageid/2/list/7}.\n *\n * @namespace\n * @alias Gp.Services.Config.Thematic\n */\n\nfunction Thematic () {\n\n    if (!(this instanceof Thematic)) {\n        throw new TypeError(\"Thematic constructor cannot be called as a function.\");\n    }\n\n    this.inspire = null;\n\n    this.name = null;\n\n}\n\nThematic.prototype = {\n\n    constructor : Thematic\n\n};\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (Thematic);\n\n\n/***/ }),\n/* 35 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n\n/**\n *  \n * Object used to describe a TileMatrix set (for WMTS use). \n *\n * @property {Array.<String>} matrixIds - Array of IDs for each TileMatrix of the set.\n * @property {Array.<Gp.Services.Config.TileMatrix>} tileMatrices - Array of TileMatrix descriptions.\n * @property {Array.<Float>} nativeResolutions - Array of resolutions (in meter per pixel) applying for each TileMatrix of the set.\n * @property {String} projection - Identifier of the Cordinates System used for the tileMatrixSet.\n *\n * @namespace\n * @alias Gp.Services.Config.TileMatrixSet\n */\nfunction TileMatrixSet () {\n\n    if (!(this instanceof TileMatrixSet)) {\n        throw new TypeError(\"TileMatrixSet constructor cannot be called as a function.\");\n    }\n\n    this.projection = null;\n\n    this.nativeResolutions = [];\n\n    this.matrixIds = [];\n\n    this.tileMatrices = {};\n\n}\n\nTileMatrixSet.prototype = {\n\n    constructor : TileMatrixSet,\n\n    /**\n     * Returns Tile Matrix Set resolutions\n     *\n     * @returns {Array} nativeResolutions - Array of resolutions (in meter per pixel) applying for each TileMatrix of the set.\n     */\n    getResolutions : function () {\n        return this.nativeResolutions;\n    },\n\n    /**\n     * Returns Tile Matrix Set identifiers\n     *\n     * @returns {Array} matrixIds - Array of IDs for each TileMatrix of the set.\n     */\n    getMatrixIds : function () {\n        return this.matrixIds;\n    },\n\n    /**\n     * Returns Tile Matrix Set projection\n     *\n     * @returns {String} projection - Identifier of the Cordinates System used for the tileMatrixSet.\n     */\n    getProjection : function () {\n        return this.projection;\n    },\n\n    /**\n     * Returns Tile Matrices descriptions.\n     *\n     * @returns {Array.<Gp.Services.Config.TileMatrix>} tileMatrices - Array of TileMatrix descriptions.\n     */\n    getTileMatrices : function () {\n        return this.tileMatrices;\n    },\n\n    /**\n     * Returns top left corner point of matrices\n     *\n     * @returns {Gp.Point} topLeftCorner - Top Left Corner Point of TMS matrices, expressed in the tileMatrixSet coordinates system.\n     */\n    getTopLeftCorner : function () {\n        var topLeftCorner;\n        var matrices = this.getTileMatrices ();\n        if (matrices) {\n            for (var id in matrices) {\n                if (matrices.hasOwnProperty(id)) {\n                    topLeftCorner = matrices[id].topLeftCorner;\n                    break;\n                }\n            }\n        }\n        return topLeftCorner;\n    }\n\n};\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (TileMatrixSet);\n\n\n/***/ }),\n/* 36 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n\n/**\n * Object used to describe a TileMatrix.\n *\n * @property {String} matrixId - matrix Identifier\n * @property {Number} matrixHeight - Number of tiles from the top to the bottom of the matrix.\n * @property {Number} matrixWidth - Number of tiles from the left to the right of the matrix.\n * @property {Number} scaleDenominator - Scale denominator associated to that matrix.\n * @property {Number} tileHeight - tile height in number of pixels\n * @property {Number} tileWidth - tile width in number of pixels\n * @property {Gp.Point} topLeftCorner - Top Left Corner Point of the matrix expressed in the tileMatrixSet coordinates system.\n *\n * @namespace\n * @alias Gp.Services.Config.TileMatrix\n */\n\nfunction TileMatrix () {\n\n    if (!(this instanceof TileMatrix)) {\n        throw new TypeError(\"TileMatrix constructor cannot be called as a function.\");\n    }\n\n    this.matrixId = null;\n\n    this.matrixHeight = null;\n\n    this.matrixWidth = null;\n\n    this.scaleDenominator = null;\n\n    this.tileHeight = null;\n\n    this.tileWidth = null;\n\n    this.topLeftCorner = null;\n\n}\n\nTileMatrix.prototype = {\n\n    constructor : TileMatrix,\n\n    /**\n     * Returns top left corner point of the matrix\n     *\n     * @returns {Gp.Point} topLeftCorner - Top Left Corner Point of the matrix expressed in the tileMatrixSet coordinates system.\n     */\n    getTopLeftCorner : function () {\n        return this.topLeftCorner;\n    },\n\n    /**\n     * Returns Scale denominator associated to that matrix.\n     *\n     * @returns {Number} scaleDenominator - Scale denominator associated to that matrix.\n     */\n    getScaleDenominator : function () {\n        return this.scaleDenominator;\n    },\n\n    /**\n     * Returns tile height of matrix\n     *\n     * @returns {Number} tileHeight - tile height in number of pixels\n     */\n    getTileHeight : function () {\n        return this.tileHeight;\n    },\n\n    /**\n     * Returns tile width of matrix\n     *\n     * @returns {Number} tileWidth - tile width in number of pixels\n     */\n    getTileWidth : function () {\n        return this.tileWidth;\n    },\n\n    /**\n     * Returns matrix height (number of tiles)\n     *\n     * @returns {Number} matrixHeight - Number of tiles from the top to the bottom of the matrix.\n     */\n    getMatrixHeight : function () {\n        return this.matrixHeight;\n    },\n\n    /**\n     * Returns matrix width (number of tiles)\n     *\n     * @returns {Number} matrixWidth - Number of tiles from the left to the right of the matrix.\n     */\n    getMatrixWidth : function () {\n        return this.matrixWidth;\n    }\n\n};\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (TileMatrix);\n\n\n/***/ }),\n/* 37 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n\n/**\n * Object used to describe a layer extent on a Tile Matrix. \n *\n * @property {Number} minTileCol - minimum column index where tile can be found on the Tile matrix.\n * @property {Number} maxTileCol - maximum column index where tile can be found on the Tile matrix.\n * @property {Number} minTileRow - minimum row index where tile can be found on the Tile matrix.\n * @property {Number} maxTileCol - maximum row index where tile can be found on the Tile matrix.\n *\n * @namespace\n * @alias Gp.Services.Config.TileMatrixLimit\n */\n\nfunction TileMatrixLimit () {\n\n    if (!(this instanceof TileMatrixLimit)) {\n        throw new TypeError(\"TileMatrixLimit constructor cannot be called as a function.\");\n    }\n\n    this.minTileRow = null;\n\n    this.maxTileRow = null;\n\n    this.minTileCol = null;\n\n    this.maxTileCol = null;\n\n}\n\n/**\n * @lends module:Autoconf/Response/TileMatrixLimit\n */\nTileMatrixLimit.prototype = {\n\n    constructor : TileMatrixLimit\n};\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (TileMatrixLimit);\n\n\n/***/ }),\n/* 38 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__AbstractService__ = __webpack_require__(12);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__LocationUtilityService_GeocodeRequest__ = __webpack_require__(67);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__LocationUtilityService_ReverseGeocodeRequest__ = __webpack_require__(69);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__LocationUtilityService_GeocodeFilterExtension__ = __webpack_require__(13);\n\n\n\n\n\n\n/**\n * @classdesc\n *\n * Requte de type LocationUtilityService (LUS)\n * (Factory)\n *\n * @example\n * // encapsule un objet dans une coquille XSL, Factory sur les objets Geocode/ReverseGeocode\n * lus = new LocationUtilityService ();\n * lus.addRequest (req);\n * lus.toString();\n *  ou\n * lus = new LocationUtilityService ({\n *      location : \"saint mand\",\n *      returnFreeForm : true,\n *      filterOptions : {\n *          type :  ['PositionOfInterest']\n *      }\n * });\n * lus.toString();\n *\n * // out ->\n * // <GeocodeRequest>\n * //   <Address countryCode=\"PositionOfInterest\">\n * //     <freeFormAddress>saint mand</freeFormAddress>\n * //   </Address>\n * // </GeocodeRequest>\n *\n * // creation de l'objet Geocode\n * req = new GeocodeRequest ();\n * req.addAddress (new Address (/*todo/*));\n * req.toString();\n * // out ->\n * // <GeocodeRequest>\n * //   <Address countryCode=\"PositionOfInterest\">\n * //     <freeFormAddress>saint mand</freeFormAddress>\n * //   </Address>\n * // </GeocodeRequest>\n *\n * // creation de l'objet ReverseGeocode\n * req = new ReverseGeocodeRequest ();\n * req.addPosition (new Position (position:{x: , y: }));\n * req.addPreference (['StreetAddress']);\n * req.toString();\n * // out ->\n * // <ReverseGeocodeRequest>\n * //     <Position>\n * //       <gml:Point xmlns:gml=\"http://www.opengis.net/gml\">\n * //           <gml:pos>50.347775 3.205098</gml:pos>\n * //       </gml:Point>\n * //     </Position>\n * //     <ReverseGeocodePreference>StreetAddress</ReverseGeocodePreference>\n * //  </ReverseGeocodeRequest>\n *\n * @constructor\n * @alias Gp.Formats.XLS.LocationUtilityService\n * @param {Object} options - options\n * @param {Object}   options.location - location\n * @param {String}   options.position - position : {x : \"\", y : \"\"}\n * @param {String}   options.returnFreeForm - true|false\n * @param {Object}   options.filterOptions - filtres\n * @param {Function} options.onsuccess - function callback success (TODO)\n * @param {Function} options.onerror   - function callback error   (TODO)\n *\n * @private\n */\nfunction LocationUtilityService (options) {\n\n    this.logger = __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__[\"a\" /* default */].getLogger();\n    this.logger.trace(\"[Constructeur LocationUtilityService ()]\");\n\n    if (!(this instanceof LocationUtilityService)) {\n        throw new TypeError(\"LocationUtilityService constructor cannot be called as a function.\");\n    }\n\n    /**\n     * Nom de la classe\n     */\n    this.CLASSNAME = \"LocationUtilityService\";\n\n    /**\n     * Type de classe de geocodage\n     * ex. GeocodeRequest ou ReverseGeocodeRequest\n     */\n    this.CLASSTYPE = null;\n\n    // appel du constructeur par heritage\n    __WEBPACK_IMPORTED_MODULE_1__AbstractService__[\"a\" /* default */].apply(this, arguments);\n\n    // on determine le type de geocodage si les options sont renseignes\n    if (this.options) {\n        this.CLASSTYPE = (this.options.location) ? \"GeocodeRequest\" : (this.options.position) ? \"ReverseGeocodeRequest\" : null;\n    }\n}\n\n/**\n * @lends module:LocationUtilityService#\n */\nLocationUtilityService.prototype = Object.create(__WEBPACK_IMPORTED_MODULE_1__AbstractService__[\"a\" /* default */].prototype, {\n    // todo\n    // getter/setter\n});\n\n/**\n * Constructeur (alias)\n */\nLocationUtilityService.prototype.constructor = LocationUtilityService;\n\n/**\n * (overwrite) Ajout d'un objet de type LUS : GeocodeRequest ou ReverseGeocodeRequest\n *\n * @param {Object} oLUSRequest - objet de type LUS\n */\nLocationUtilityService.prototype.addRequest = function (oLUSRequest) {\n\n    // on determine le type de geocodage\n    this.CLASSTYPE = oLUSRequest.CLASSNAME;\n\n    // on controle les types accepts\n    switch (this.CLASSTYPE) {\n        case \"GeocodeRequest\":\n        case \"ReverseGeocodeRequest\":\n            this.oRequest = oLUSRequest;\n            break;\n        default:\n            throw new Error(\"Ce n'est pas un objet de type 'LUS Request' !?\");\n    }\n\n};\n\n/**\n * (overwrite) Ajout d'un objet de type GeocodeFilterExtension\n *\n * @param {Object} oFilter - objet de type Filtre\n */\nLocationUtilityService.prototype.addFilter = function (oFilter) {\n\n    // FIXME gestion des filtres  partir des tables de geocodages\n    if (oFilter instanceof __WEBPACK_IMPORTED_MODULE_4__LocationUtilityService_GeocodeFilterExtension__[\"a\" /* default */]) {\n        this.oFilter = oFilter;\n    }\n};\n\n/**\n * (overwrite) toString\n *\n * @returns {String}\n */\nLocationUtilityService.prototype.toString = function () {\n\n    // soit, on a un objet LUS Request dj instanci\n    // sinon, il faut le construire  partir des options  disposition\n    if (!this.oRequest) {\n\n        // il nous faut des options\n        if (!this.options) {\n            throw new Error(\"Les options ne sont pas renseignes, impossible de construire la requte !\");\n        }\n\n        // si les options 'location' et 'position' sont renseignes,\n        // on prendra par defaut le choix du geocodage direct\n        if (this.CLASSTYPE === \"GeocodeRequest\") {\n            var settingsDirect = {\n                location : this.options.location,\n                returnFreeForm : this.options.returnFreeForm,\n                filterOptions : this.options.filterOptions || {}\n            };\n            this.oRequest = new __WEBPACK_IMPORTED_MODULE_2__LocationUtilityService_GeocodeRequest__[\"a\" /* default */](settingsDirect);\n            // ajout des filtres spcifiques au service du geocodage direct de l'IGN\n            if (this.oFilter) {\n                this.oRequest.addFilter(this.oFilter);\n            }\n        } else if (this.CLASSTYPE === \"ReverseGeocodeRequest\") {\n            var settingsInv = {\n                position : this.options.position,\n                returnFreeForm : this.options.returnFreeForm,\n                filterOptions : this.options.filterOptions || {}\n            };\n            this.oRequest = new __WEBPACK_IMPORTED_MODULE_3__LocationUtilityService_ReverseGeocodeRequest__[\"a\" /* default */](settingsInv);\n        } else {\n            this.logger.error(\"impossible de determiner le type de geocodage : Direct ou Inverse !?\");\n        }\n    }\n\n    // objet indefini !?\n    if (!this.oRequest) {\n        throw new Error(\"Type de Geocodage indefini !\");\n    }\n\n    this.strRequest = this.oRequest.toString();\n    return this.strRequest;\n};\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (LocationUtilityService);\n\n\n/***/ }),\n/* 39 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__GeocodedLocation__ = __webpack_require__(15);\n\n\n\n/**\n * Single location object returned by the underlying geocoding web service.\n *\n * @property {Float} accuracy - Accuracy of the response towards the requested location between 0 (unaccurate) and 1 (exact match).\n *\n * @namespace\n * @extends {Gp.Services.Geocode.GeocodedLocation}\n * @alias Gp.Services.Geocode.DirectGeocodedLocation\n */\nfunction DirectGeocodedLocation () {\n\n    if (!(this instanceof DirectGeocodedLocation)) {\n        throw new TypeError(\"DirectGeocodedLocation constructor cannot be called as a function.\");\n    }\n\n    // INFO\n    // appel du constructeur de la classe mre\n    // avec passage de param.\n    __WEBPACK_IMPORTED_MODULE_0__GeocodedLocation__[\"a\" /* default */].apply(this, arguments);\n\n    /**\n     * Nom de la classe (heritage) : \"DirectGeocodedLocation\"\n     * @type {String}\n     */\n    this.CLASSNAME = \"DirectGeocodedLocation\";\n\n    this.accuracy = null;\n\n}\n\nDirectGeocodedLocation.prototype = Object.create(__WEBPACK_IMPORTED_MODULE_0__GeocodedLocation__[\"a\" /* default */].prototype);\n\nDirectGeocodedLocation.prototype.constructor = DirectGeocodedLocation;\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (DirectGeocodedLocation);\n\n\n/***/ }),\n/* 40 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__GeocodedLocation__ = __webpack_require__(15);\n\n\n\n/**\n * Single location object returned by the underlying reverse geocoding web service.\n *\n * @property {Float} searchCenterDistance - Distance between the requested point and the location.\n *\n * @namespace\n * @extends {Gp.Services.Geocode.GeocodedLocation}\n * @alias Gp.Services.Geocode.ReverseGeocodedLocation\n */\nfunction ReverseGeocodedLocation () {\n\n    if (!(this instanceof ReverseGeocodedLocation)) {\n        throw new TypeError(\"ReverseGeocodedLocation constructor cannot be called as a function.\");\n    }\n\n    // INFO\n    // appel du constructeur de la classe mre\n    // avec passage de param.\n    __WEBPACK_IMPORTED_MODULE_0__GeocodedLocation__[\"a\" /* default */].apply(this, arguments);\n\n    /**\n     * Nom de la classe (heritage) : \"ReverseGeocodedLocation\"\n     * @type {String}\n     */\n    this.CLASSNAME = \"ReverseGeocodedLocation\";\n\n    this.searchCenterDistance = null;\n\n}\n\nReverseGeocodedLocation.prototype = Object.create(__WEBPACK_IMPORTED_MODULE_0__GeocodedLocation__[\"a\" /* default */].prototype);\n\nReverseGeocodedLocation.prototype.constructor = ReverseGeocodedLocation;\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (ReverseGeocodedLocation);\n\n\n/***/ }),\n/* 41 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/**\n * Response object for {@link module:Services~autoComplete Gp.Services.autoComplete ()} invocation when successful. Received as the argument of onSuccess callback function.\n *\n * @property {Array.<Gp.Services.AutoComplete.SuggestedLocation>} suggestedLocations - SuggestedLocations array.\n *\n * @namespace\n * @alias Gp.Services.AutoCompleteResponse\n */\nfunction AutoCompleteResponse () {\n\n    if (!(this instanceof AutoCompleteResponse)) {\n        throw new TypeError(\"AutoCompleteResponse constructor cannot be called as a function.\");\n    }\n\n    this.suggestedLocations = [];\n\n}\n\nAutoCompleteResponse.prototype = {\n\n    constructor : AutoCompleteResponse\n\n};\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (AutoCompleteResponse);\n\n\n/***/ }),\n/* 42 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n\n/**\n * Single SuggestedLocation Object returned by underlying web service.\n * Each suggested location represents a street address (\"StreetAddress\") or a place name (\"PositionOfInterest\").\n *\n * @property {String} type - Suggested location type : \"StreetAddress\" ou \"PositionOfInterest\"\n * @property {Gp.Point} position - Position of the suggested location given in requested coordinates system.\n * @property {String} commune - Suggested municipality\n * @property {String} fullText - Full text representation of the suggested location.\n * @property {String} postalCode - Suggested location postcode\n * @property {Integer} classification - Number used to classify the importance of the place where is the suggested location from 1 (most important) to 7 (less important).\n * @property {String} street - Street name of the suggested location (\"StreetAddress\" only).\n * @property {String} kind - Nature of the suggested location : \"prefecture\", \"monument\", \"commune\", ... for instance (\"PositionOfInterest\" only).\n * \n * @namespace\n * @alias Gp.Services.AutoComplete.SuggestedLocation\n */\nfunction SuggestedLocation () {\n\n    if (!(this instanceof SuggestedLocation)) {\n        throw new TypeError(\"SuggestedLocation constructor cannot be called as a function.\");\n    }\n\n    /* REPONSE :\n        {  \n           \"status\" : \"OK\",\n           \"results\" : [  \n              {  \n                 \"country\":\"PositionOfInterest\",\n                 \"x\":-1.559185,\n                 \"y\":47.952603,\n                 \"city\":\"Brie\",\n                 \"zipcode\":\"35150\",\n                 \"street\":\"corbe\",\n                 \"kind\":\"Lieu-dit habit\",\n                 \"fulltext\":\"corbe, 35150 Brie\",\n                 \"classification\":6\n              },\n              {  \n                 \"country\":\"StreetAddress\",\n                 \"x\":1.538295,\n                 \"y\":43.19646,\n                 \"city\":\"Brie\",\n                 \"zipcode\":\"09700\",\n                 \"street\":\"courreste\",\n                 \"kind\":\"\",\n                 \"fulltext\":\"courreste, 09700 Brie\",\n                 \"classification\":7\n              }\n           ]\n        }\n    */\n\n    /* REPONSE EN ERREUR \n        {\n            status : \"ERROR\",\n            results : [ ]\n        }\n    */\n\n    /**\n     * Suggested location type : \"StreetAddress\" ou \"PositionOfInterest\"\n     * @type {String}\n     */\n    this.type = null;\n\n    /**\n     * Position of the suggested location given in requested coordinates system.\n     * @type {Gp.Point}\n     */\n    this.position = {\n        x : null,\n        y : null\n    };\n\n    /**\n     * Suggested municipality\n     * @type {String} \n     */\n    this.commune = null;\n\n    /**\n     * Full text representation of the suggested location.\n     * @type {String} \n     */\n    this.fullText = null;\n\n    /**\n     * Suggested location postcode\n     * @type {Number}  \n     */\n    this.postalCode = null;\n\n    /**\n     * Number used to classify the importance of the place where is the suggested location from 1 (most important) to 7 (less important).\n     * @type {Integer} \n     */\n    this.classification = null;\n\n    /**\n     * Street name of the suggested location (\"StreetAddress\" only).\n     * @type {String}\n     */\n    this.street = null;\n\n    /**\n     * Place name of the suggested location (\"PositionOfInterest\" only).\n     * @type {String}\n     */\n    this.poi = null;\n\n    /**\n     * Nature of the suggested location : \"prefecture\", \"monument\", \"commune\", ... for instance (\"PositionOfInterest\" only).\n     * @type {String}\n     */\n    this.kind = null;\n}\n\nSuggestedLocation.prototype = {\n\n    constructor : SuggestedLocation\n};\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (SuggestedLocation);\n\n\n/***/ }),\n/* 43 */\n/***/ (function(module, exports, __webpack_require__) {\n\nmodule.exports = __webpack_require__(44);\n\n\n/***/ }),\n/* 44 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\nObject.defineProperty(__webpack_exports__, \"__esModule\", { value: true });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__Services_Services__ = __webpack_require__(45);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__Services_DefaultUrlService__ = __webpack_require__(6);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__Services_Alti_Response_model_AltiResponse__ = __webpack_require__(9);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__Services_Alti_Response_model_Elevation__ = __webpack_require__(10);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__Services_AutoComplete_Response_model_AutoCompleteResponse__ = __webpack_require__(41);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__Services_AutoComplete_Response_model_SuggestedLocation__ = __webpack_require__(42);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__Services_AutoConf_Response_model_AutoConfResponse__ = __webpack_require__(24);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7__Services_AutoConf_Response_model_Constraint__ = __webpack_require__(25);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8__Services_AutoConf_Response_model_Format__ = __webpack_require__(26);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_9__Services_AutoConf_Response_model_Layer__ = __webpack_require__(27);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_10__Services_AutoConf_Response_model_Legend__ = __webpack_require__(28);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_11__Services_AutoConf_Response_model_Metadata__ = __webpack_require__(29);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_12__Services_AutoConf_Response_model_Originator__ = __webpack_require__(30);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_13__Services_AutoConf_Response_model_Service__ = __webpack_require__(31);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_14__Services_AutoConf_Response_model_Style__ = __webpack_require__(32);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_15__Services_AutoConf_Response_model_Territory__ = __webpack_require__(33);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_16__Services_AutoConf_Response_model_Thematic__ = __webpack_require__(34);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_17__Services_AutoConf_Response_model_TileMatrix__ = __webpack_require__(36);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_18__Services_AutoConf_Response_model_TileMatrixLimit__ = __webpack_require__(37);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_19__Services_AutoConf_Response_model_TileMatrixSet__ = __webpack_require__(35);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_20__Services_Geocode_Response_model_GeocodeResponse__ = __webpack_require__(14);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_21__Services_Geocode_Response_model_GeocodedLocation__ = __webpack_require__(15);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_22__Services_Geocode_Response_model_DirectGeocodedLocation__ = __webpack_require__(39);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_23__Services_Geocode_Response_model_ReverseGeocodedLocation__ = __webpack_require__(40);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_24__Services_ProcessIsoCurve_Response_model_ProcessIsoCurveResponse__ = __webpack_require__(18);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_25__Services_Route_Response_model_RouteResponse__ = __webpack_require__(16);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_26__Services_Route_Response_model_RouteInstruction__ = __webpack_require__(17);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_27__Protocols_XHR__ = __webpack_require__(19);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_28__Exceptions_ErrorService__ = __webpack_require__(2);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_29__Utils_Helper__ = __webpack_require__(5);\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nvar Gp = {\n    servicesVersion : \"2.0.0\" ,\n    servicesDate : \"2018-03-05\",\n    /**\n     * Methode pour rajouter une classe / objet au namespace global.\n     *\n     * @method extend\n     * @param {String} strNS - nom sous lequel on veut prsenter la\n     *        classe / objet (Gp.\"strNS\").\n     * @param {Object} value - la classe / objet  rajouter au NS global.\n     */\n    extend : function (strNS, value) {\n        var parts = strNS.split(\".\");\n        var parent = this;\n        var pl;\n\n        pl = parts.length;\n\n        for (var i = 0; i < pl; i++) {\n            // create a property if it doesn't exist\n            if ( typeof parent[parts[i]] === \"undefined\") {\n                parent[parts[i]] = {};\n            }\n\n            var n = pl - 1;\n            if (i === n) {\n                parent[parts[i]] = value;\n            }\n\n            parent = parent[parts[i]];\n        }\n\n        return this;\n    }\n};\n\n// on declare les ns dans root global\nGp.extend(\"Protocols\", {});\nGp.extend(\"Protocols.XHR\", __WEBPACK_IMPORTED_MODULE_27__Protocols_XHR__[\"a\" /* default */]);\nGp.extend(\"Services\", __WEBPACK_IMPORTED_MODULE_0__Services_Services__[\"a\" /* default */]);\n// Export Alti\nGp.extend(\"Services.AltiResponse\", __WEBPACK_IMPORTED_MODULE_2__Services_Alti_Response_model_AltiResponse__[\"a\" /* default */]);\nGp.extend(\"Services.Alti.Elevation\", __WEBPACK_IMPORTED_MODULE_3__Services_Alti_Response_model_Elevation__[\"a\" /* default */]);\n// Export Autocomplete\nGp.extend(\"Services.AutoCompleteResponse\", __WEBPACK_IMPORTED_MODULE_4__Services_AutoComplete_Response_model_AutoCompleteResponse__[\"a\" /* default */]);\nGp.extend(\"Services.AutoComplete.SuggestedLocation\", __WEBPACK_IMPORTED_MODULE_5__Services_AutoComplete_Response_model_SuggestedLocation__[\"a\" /* default */]);\n// Export Autoconf\nGp.extend(\"Services.GetConfigResponse\", __WEBPACK_IMPORTED_MODULE_6__Services_AutoConf_Response_model_AutoConfResponse__[\"a\" /* default */]);\nGp.extend(\"Services.Config.Constraint\", __WEBPACK_IMPORTED_MODULE_7__Services_AutoConf_Response_model_Constraint__[\"a\" /* default */]);\nGp.extend(\"Services.Config.Format\", __WEBPACK_IMPORTED_MODULE_8__Services_AutoConf_Response_model_Format__[\"a\" /* default */]);\nGp.extend(\"Services.Config.Layer\", __WEBPACK_IMPORTED_MODULE_9__Services_AutoConf_Response_model_Layer__[\"a\" /* default */]);\nGp.extend(\"Services.Config.Legend\", __WEBPACK_IMPORTED_MODULE_10__Services_AutoConf_Response_model_Legend__[\"a\" /* default */]);\nGp.extend(\"Services.Config.Metadata\", __WEBPACK_IMPORTED_MODULE_11__Services_AutoConf_Response_model_Metadata__[\"a\" /* default */]);\nGp.extend(\"Services.Config.Originator\", __WEBPACK_IMPORTED_MODULE_12__Services_AutoConf_Response_model_Originator__[\"a\" /* default */]);\nGp.extend(\"Services.Config.Service\", __WEBPACK_IMPORTED_MODULE_13__Services_AutoConf_Response_model_Service__[\"a\" /* default */]);\nGp.extend(\"Services.Config.Style\", __WEBPACK_IMPORTED_MODULE_14__Services_AutoConf_Response_model_Style__[\"a\" /* default */]);\nGp.extend(\"Services.Config.Territory\", __WEBPACK_IMPORTED_MODULE_15__Services_AutoConf_Response_model_Territory__[\"a\" /* default */]);\nGp.extend(\"Services.Config.Thematic\", __WEBPACK_IMPORTED_MODULE_5__Services_AutoComplete_Response_model_SuggestedLocation__[\"a\" /* default */]);\nGp.extend(\"Services.Config.TileMatrix\", __WEBPACK_IMPORTED_MODULE_17__Services_AutoConf_Response_model_TileMatrix__[\"a\" /* default */]);\nGp.extend(\"Services.Config.TileMatrixLimit\", __WEBPACK_IMPORTED_MODULE_18__Services_AutoConf_Response_model_TileMatrixLimit__[\"a\" /* default */]);\nGp.extend(\"Services.Config.TileMatrixSet\", __WEBPACK_IMPORTED_MODULE_19__Services_AutoConf_Response_model_TileMatrixSet__[\"a\" /* default */]);\n// Export Geocode\nGp.extend(\"Services.GeocodeResponse\", __WEBPACK_IMPORTED_MODULE_20__Services_Geocode_Response_model_GeocodeResponse__[\"a\" /* default */]);\nGp.extend(\"Services.Geocode.GeocodedLocation\", __WEBPACK_IMPORTED_MODULE_21__Services_Geocode_Response_model_GeocodedLocation__[\"a\" /* default */]);\nGp.extend(\"Services.Geocode.DirectGeocodedLocation\", __WEBPACK_IMPORTED_MODULE_22__Services_Geocode_Response_model_DirectGeocodedLocation__[\"a\" /* default */]);\nGp.extend(\"Services.Geocode.ReverseGeocodedLocation\", __WEBPACK_IMPORTED_MODULE_23__Services_Geocode_Response_model_ReverseGeocodedLocation__[\"a\" /* default */]);\n// Export IsoCurve\nGp.extend(\"Services.IsoCurveResponse\", __WEBPACK_IMPORTED_MODULE_24__Services_ProcessIsoCurve_Response_model_ProcessIsoCurveResponse__[\"a\" /* default */]);\n// Export Route\nGp.extend(\"Services.RouteResponse\", __WEBPACK_IMPORTED_MODULE_25__Services_Route_Response_model_RouteResponse__[\"a\" /* default */]);\nGp.extend(\"Services.Route.RouteInstruction\", __WEBPACK_IMPORTED_MODULE_26__Services_Route_Response_model_RouteInstruction__[\"a\" /* default */]);\n// Export Erreurs et Outils\nGp.extend(\"Error\", __WEBPACK_IMPORTED_MODULE_28__Exceptions_ErrorService__[\"a\" /* default */]);\nGp.extend(\"Helper\", __WEBPACK_IMPORTED_MODULE_29__Utils_Helper__[\"a\" /* default */]);\n// Export DefaultUrls\nGp.extend(\"Services.DefaultUrl\", __WEBPACK_IMPORTED_MODULE_1__Services_DefaultUrlService__[\"a\" /* default */]);\n\n/* harmony default export */ __webpack_exports__[\"default\"] = (Gp); // = export { Gp as default };\n\n\n/***/ }),\n/* 45 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__Alti_Alti__ = __webpack_require__(46);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__AutoConf_AutoConf__ = __webpack_require__(60);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__Geocode_Geocode__ = __webpack_require__(63);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__Geocode_ReverseGeocode__ = __webpack_require__(78);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__AutoComplete_AutoComplete__ = __webpack_require__(82);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__Route_Route__ = __webpack_require__(84);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__ProcessIsoCurve_ProcessIsoCurve__ = __webpack_require__(96);\n/**\n* Geoportal web services invocation namespace.\n*\n* @module Services\n* @alias Gp.Services\n*/\n\n\n\n\n\n\n\n\nvar Services = {\n    /**\n     * Access to Geoportal resources metadata availables with one ore several keys, using [Auto-configuration service]{@link https://wxs.ign.fr/APIKEY/autoconf} of the Geoportal platform.\n     *\n     * @method getConfig\n     * @param {Object} options - Options for function call.\n     * @param {String} options.apiKey - Access key to Geoportal platform, obtained [here]{@link http://professionnels.ign.fr/ign/contrats}.\n     * @param {Function} options.onSuccess - Callback function for getting successful service response. Takes a {@link Gp.Services.GetConfigResponse} object as a parameter except if \"rawResponse\" parameter is set to true : a String will be returned.\n     * @param {Function} [options.onFailure] - Callback function for handling unsuccessful service responses (timeOut, missing rights, ...). Takes a {@link Gp.Error} object as parameter.\n     * @param {Number} [options.timeOut=0] - Number of milliseconds above which a timeOut response will be returned with onFailure callback (see above). Default value is 0 which means timeOut will not be handled.\n     * @param {String} [options.serverUrl=http (s)://wxs.ign.fr/APIKEY/autoconf] - Web service URL. If used, options.apiKey parameter is ignored. Only use if you know what you're doing.\n     * @param {String} [options.protocol=JSONP] - Protocol used to handle dialog with web service. Possible values are 'JSONP' ({@link https://en.wikipedia.org/wiki/JSONP}) and 'XHR' ({@link https://en.wikipedia.org/wiki/XMLHttpRequest}). Only XHR protocol is supported in a NodeJS environment. Only use if you know what you're doing.\n     * @param {String} [options.proxyURL] - Proxy URL to use when requesting an underlying web service. Ignored when options.protocol is set to 'JSONP' value. Only use if you know what you're doing.\n     * @param {String} [options.callbackSuffix] - Callback function name suffix to use in case of a JSONP protocol use (see above), to set your own suffix instead of auto-increment. Ignored when options.protocol is set to 'XHR' value. Only use if you know what you're doing.\n     * @param {String} [options.httpMethod=GET] - HTTP method to use when requesting underlying web service in case of a XHR protocol use (see above). Possible values are 'GET' and 'POST'. Ignored when options.protocol is set to 'JSONP' value. Only use if you know what you are doing.\n     * @param {String} [options.contentType=\"application/xml\"] - Content-Type to use when requesting underlying web service in case of a XHR protocol use (see above) and if method HTTP is POST. Ignored when options.protocol is set to 'JSONP' value. Only use if you know what you are doing.\n     * @param {Boolean} [options.rawResponse=false] - Setting this parameter to true implies you want to handle the service response by yourself : it will be returned as an unparsed String in onSuccess callback parameter. Only use if you know what you are doing.\n     * @param {Function} [options.onBeforeParse] - Callback function for handling service response before parsing (as an unparsed String). Takes a String as a parameter (the raw service response). Returns a String that will be parsed as the service response. Ignored when options.protocol is set to 'XHR' value. Only use if you know what you are doing.\n     */\n    getConfig : function (options) {\n        var autoconfService = new __WEBPACK_IMPORTED_MODULE_1__AutoConf_AutoConf__[\"a\" /* default */](options);\n        autoconfService.call();\n    },\n\n    /**\n     * Getting elevations in or along of one or several points on french territories using the [elevation services of the Geoportal Platform]{@link https://geoservices.ign.fr/documentation/geoservices/alti.html}.<br/>\n     * Two use cases are availables :<br/>\n     * 1. getting elevations of the given points : don't use the options.sampling parameter ;<br/>\n     * 2. getting a regular set of elevations along the given points : use the options.sampling parameter.\n     *\n     * @method getAltitude\n     * @param {Object} options - Options for function call.\n     * @param {String} options.apiKey - Access key to Geoportal platform, obtained [here]{@link http://professionnels.ign.fr/ign/contrats}.\n     * @param {Array.<Object>} options.positions - Array of positions ({lon:float, lat:float}) expressed in CRS:84 coordinates system, where to get elevations. 50 positions maximum may be given. 2 positions minimum are required if you use the options.sampling parameter.\n     * @param {Number} [options.sampling] - Number of points to use (between 2 and 5000) in order to compute an elevation path. The points given with the options.positions parameter are used to fix the planimetric path along which the elevations will be computed.<br/>\n     * If not used, only elevations of these positions will be returned.\n     * @param {Boolean} [options.zonly=false] - Set this parameter to true if you only want to have elevations returned without corresponding coordinates.\n     * @param {Function} options.onSuccess - Callback function for getting successful service response. Takes a {@link Gp.Services.AltiResponse} object as a parameter, except if \"rawResponse\" is set to true.\n     * @param {Function} [options.onFailure] - Callback function for handling unsuccessful service responses (timeOut, missing rights, ...). Takes a {@link Gp.Error} object as parameter.\n     * @param {Number} [options.timeOut=0] - Number of milliseconds above which a timeOut response will be returned with onFailure callback (see above). Default value is 0 which means timeOut will not be handled.\n     * @param {String} [options.serverUrl=http (s)://wxs.ign.fr/APIKEY/alti/rest/elevation.json] - Web service URL. If used, options.apiKey parameter is ignored. Only use if you know what you're doing.\n     * @param {String} [options.protocol=XHR] - Protocol used to handle dialog with web service. Possible values are 'JSONP' ({@link https://en.wikipedia.org/wiki/JSONP}) and 'XHR' ({@link https://en.wikipedia.org/wiki/XMLHttpRequest}). Only XHR protocol is supported in a NodeJS environment. Only use if you know what you're doing.\n     * @param {String} [options.proxyURL] - Proxy URL to use when requesting underlying web service. Ignored when options.protocol is set to 'JSONP' value. Only use if you know what you're doing.\n     * @param {String} [options.callbackSuffix] - Callback function name suffix to use in case of a JSONP protocol use (see above), to set your own suffix instead of auto-increment. Ignored when options.protocol is set to 'XHR' value. Only use if you know what you're doing.\n     * @param {String} [options.httpMethod=GET] - HTTP method to use when requesting underlying web service in case of a XHR protocol use (see above). Possible values are 'GET' and 'POST'. Ignored when options.protocol is set to 'JSONP' value. Only use if you know what you are doing.\n     * @param {String} [options.contentType=\"application/xml\"] - Content-Type to use when requesting underlying web service in case of a XHR protocol use (see above) and if method HTTP is POST. Ignored when options.protocol is set to 'JSONP' value. Only use if you know what you are doing.\n     * @param {Boolean} [options.rawResponse=false] - Setting this parameter to true implies you want to handle the service response by yourself : it will be returned as an unparsed String in onSuccess callback parameter. Only use if you know what you are doing.\n     * @param {Function} [options.onBeforeParse] - Callback function for handling service response before parsing (as an unparsed String). Takes a String as a parameter (the raw service response). Returns a String that will be parsed as the service response. Ignored when options.protocol is set to 'XHR' value. Only use if you know what you are doing.\n     * @param {String} [options.api='REST'] - What API to use for interacting with underlying web service : 'REST' or 'WPS'. Only use if you know what you are doing.\n     * @param {String} [options.outputFormat='xml'] - Output format for underlying web service response : 'xml' or 'json'. Only use if you know what you are doing.\n     */\n    getAltitude : function (options) {\n        var altiService = new __WEBPACK_IMPORTED_MODULE_0__Alti_Alti__[\"a\" /* default */](options);\n        altiService.call();\n    },\n    /**\n     * Getting positon of a geographic identifier (places names, address, cadastral parcel, other...) using the [geocoding web service of the Geoportal Platform]{@link https://geoservices.ign.fr/documentation/geoservices/geocodage.html}.\n     *\n     * @example\n     * Gp.Services.geocode ({\n     *     apiKey : \"jhyvi0fgmnuxvfv0zjzorvdn\",\n     *     location : \"73 avenue de Paris, Saint-Mand\",\n     *     // traitement des resultats\n     *     onSuccess  : function (result) {\n     *         console.log(\"found (x:\"+result.position.x+\", y:\"+result.position.y+\")\") ;\n     *     }\n     * }) ;\n     *\n     *\n     * @method geocode\n     * @param {Object} options - Options for function call.\n     * @param {String} options.apiKey - Access key to Geoportal platform, obtained [here]{@link http://professionnels.ign.fr/ign/contrats}.\n     * @param {String|Object} options.location - Geographic identifier to locate. May be provided as a single String or a structured Object for an address search. In this last case, the following properties are availaibles.\n     *      @param {Number} [options.location.number] - Street number.\n     *      @param {String} [options.location.street] - Street name.\n     *      @param {String} [options.location.city] - City name.\n     *      @param {Number} [options.location.postalCode] - Postal Code\n     * @param {Object} [options.filterOptions] - Additional filters to apply to search. The following properties may be given.\n     *      @param {Gp.BBox} [options.filterOptions.bbox] - Bounding box where to perform the search. Properties expressed in options.srs coordinates system.\n     *      @param {Array.<String>} [options.filterOptions.type] - Geographical identifier types to search. Values currently availables are : \"PositionOfInterest\" for place names, \"StreetAddress\" for address search, \"CadastralParcel\" for Cadastral parcels search. Default is \"StreetAddress\".\n     *\n     *      @param {String} [options.filterOptions.[prop]] - Additionnal properties to filter search. Properties depends on options.filterOptions.type, and values type should be \"String\".\n     *      <br/><br/>\n     *      Common Properties availables for all search types :<br/>\n     *      \"municipality\", \"insee\", \"department\".\n     *      <br/><br/>\n     *      Properties availables for address search :<br/>\n     *      \"quality\", \"ID\", \"ID_TR\" and \"territory\".\n     *      <br/><br/>\n     *      Properties availables for place names search :<br/>\n     *      \"importance\", \"nature\" and \"territory\".\n     *      <br/><br/>\n     *      Properties availables for cadastral parcels search :<br/>\n     *      \"sheet\", \"section\", and \"absorbedcity\".\n     * @param {Number} [options.maximumResponses = 25] - Maximum number of responses. Default underlying service value applies (25) if not provided.\n     * @param {Boolean} [options.returnFreeForm = false] - Set this parameter to true if you wish to have an address returned in a single String (unstructured). If unset, default underlying service value (false) applies.\n     * @param {String} [options.srs = EPSG:4326] - Coordinates System used to expres coordinates for parameters and responses. Default underlying service value (EPSG:4326) applies.\n     * @param {Function} options.onSuccess - Callback function for getting successful service response. Takes a {@link Gp.Services.GeocodeResponse} object as a parameter except if \"rawResponse\" is set to true.\n     * @param {Function} [options.onFailure] - Callback function for handling unsuccessful service responses (timeOut, missing rights, ...). Takes a {@link Gp.Error} object as parameter.\n     * @param {Number} [options.timeOut=0] - Number of milliseconds above which a timeOut response will be returned with onFailure callback (see above). Default value is 0 which means timeOut will not be handled.\n     * @param {String} [options.serverUrl=http (s)://wxs.ign.fr/APIKEY/geoportail/ols] - Web service URL. If used, options.apiKey parameter is ignored. Only use if you know what you're doing.\n     * @param {String} [options.protocol=XHR] - Protocol used to handle dialog with web service. Possible values are 'JSONP' ({@link https://en.wikipedia.org/wiki/JSONP}) and 'XHR' ({@link https://en.wikipedia.org/wiki/XMLHttpRequest}). Only XHR protocol is supported in a NodeJS environment. Only use if you know what you're doing.\n     * @param {String} [options.proxyURL] - Proxy URL to use when requesting underlying web service. Ignored when options.protocol is set to 'JSONP' value. Only use if you know what you're doing.\n     * @param {String} [options.callbackSuffix] - Callback function name suffix to use in case of a JSONP protocol use (see above), to set your own suffix instead of auto-increment. Ignored when options.protocol is set to 'XHR' value. Only use if you know what you're doing.\n     * @param {String} [options.httpMethod=GET] - HTTP method to use when requesting underlying web service in case of a XHR protocol use (see above). Possible values are 'GET' and 'POST'. Ignored when options.protocol is set to 'JSONP' value. Only use if you know what you are doing.\n     * @param {String} [options.contentType=\"application/xml\"] - Content-Type to use when requesting underlying web service in case of a XHR protocol use (see above) and if method HTTP is POST. Ignored when options.protocol is set to 'JSONP' value. Only use if you know what you are doing.\n     * @param {Boolean} [options.rawResponse=false] - Setting this parameter to true implies you want to handle the service response by yourself : it will be returned as an unparsed String in onSuccess callback parameter. Only use if you know what you are doing.\n     * @param {Function} [options.onBeforeParse] - Callback function for handling service response before parsing (as an unparsed String). Takes a String as a parameter (the raw service response). Returns a String that will be parsed as the service response. Ignored when options.protocol is set to 'XHR' value. Only use if you know what you are doing.\n     */\n    geocode : function (options) {\n        var geocodeService = new __WEBPACK_IMPORTED_MODULE_2__Geocode_Geocode__[\"a\" /* default */](options);\n        geocodeService.call();\n    },\n    /**\n     * Retrieving geographical identifiers (place names, address, cadastral parcels, ...) near a given position, using the [reverse geocoding web service of the Geoportal Platform]{@link https://geoservices.ign.fr/documentation/geoservices/geocodage-inverse.html}.\n     *\n     * @method reverseGeocode\n     * @param {Object} options - Options for function call.\n     * @param {String} options.apiKey - Access key to Geoportal platform, obtained [here]{@link http://professionnels.ign.fr/ign/contrats}.\n     * @param {Gp.Point} options.position - Reference position where to search geographical identifiers. Its coordinates are expressed in the coordinates system given with options.srs parameter. (default is CRS:84, that means position.x is the longitude and position.y the latitude)\n     * @param {Object} [options.filterOptions] - Additional filters to apply to search. The following properties may be given.\n     *      @param {Array.<String>} [options.filterOptions.type] - Geographical identifier types to search. Values currently availables are : \"PositionOfInterest\" for place names, \"StreetAddress\" for address search, \"CadastralParcel\" for Cadastral parcels search. Default is \"StreetAddress\".\n     *      @param {Gp.BBox} [options.filterOptions.bbox] - Bounding box where to perform the search. Expressed in options.srs coordinates system.\n     *      @param {Gp.Circle} [options.filterOptions.circle] - Circle where to perform the search. Expressed in options.srs coordinates system.\n     * @param {Array.<Gp.Point>} [options.filterOptions.polygon] - Polygon where to perform the search. Expressed in options.srs coordinates system.\n     * @param {Number} [options.maximumResponses] - Maximum number of responses. Default underlying service value applies (25) if not provided.\n     * @param {Boolean} [options.returnFreeForm = false] - Set this parameter to true if you wish to have an address returned in a single String (unstructured). If unset, default underlying service value (false) applies.\n     * @param {String} [options.srs = CRS:84] - Coordinates System used to express coordinates for parameters and responses. Only WGS 84 geographical positioning is supported. Therefore, two values are allowed : \"CRS:84\" (position.x is the longitude and position.y the latitude) and \"EPSG:4326\" (position.x is the latitude and position.y the longitude) . Default is CRS:84.\n     * @param {Function} options.onSuccess - Callback function for getting successful service response. Takes a {@link Gp.Services.GeocodeResponse} object as a parameter except if \"rawResponse\" is set to true.\n     * @param {Function} [options.onFailure] - Callback function for handling unsuccessful service responses (timeOut, missing rights, ...). Takes a {@link Gp.Error} object as parameter.\n     * @param {Number} [options.timeOut=0] - Number of milliseconds above which a timeOut response will be returned with onFailure callback (see above). Default value is 0 which means timeOut will not be handled.\n     * @param {String} [options.serverUrl=http (s)://wxs.ign.fr/APIKEY/geoportail/ols] - Web service URL. If used, options.apiKey parameter is ignored. Only use if you know what you're doing.\n     * @param {String} [options.protocol=XHR] - Protocol used to handle dialog with web service. Possible values are 'JSONP' ({@link https://en.wikipedia.org/wiki/JSONP}) and 'XHR' ({@link https://en.wikipedia.org/wiki/XMLHttpRequest}). Only XHR protocol is supported in a NodeJS environment. Only use if you know what you're doing.\n     * @param {String} [options.proxyURL] - Proxy URL to use when requesting underlying web service. Ignored when options.protocol is set to 'JSONP' value. Only use if you know what you're doing.\n     * @param {String} [options.callbackSuffix] - Callback function name suffix to use in case of a JSONP protocol use (see above), to set your own suffix instead of auto-increment. Ignored when options.protocol is set to 'XHR' value. Only use if you know what you're doing.\n     * @param {String} [options.httpMethod=GET] - HTTP method to use when requesting underlying web service in case of a XHR protocol use (see above). Possible values are 'GET' and 'POST'. Ignored when options.protocol is set to 'JSONP' value. Only use if you know what you are doing.\n     * @param {String} [options.contentType=\"application/xml\"] - Content-Type to use when requesting underlying web service in case of a XHR protocol use (see above) and if method HTTP is POST. Ignored when options.protocol is set to 'JSONP' value. Only use if you know what you are doing.\n     * @param {Boolean} [options.rawResponse=false] - Setting this parameter to true implies you want to handle the service response by yourself : it will be returned as an unparsed String in onSuccess callback parameter. Only use if you know what you are doing.\n     * @param {Function} [options.onBeforeParse] - Callback function for handling service response before parsing (as an unparsed String). Takes a String as a parameter (the raw service response). Returns a String that will be parsed as the service response. Ignored when options.protocol is set to 'XHR' value. Only use if you know what you are doing.\n     */\n    reverseGeocode : function (options) {\n        var reverseGeocodeService = new __WEBPACK_IMPORTED_MODULE_3__Geocode_ReverseGeocode__[\"a\" /* default */](options);\n        reverseGeocodeService.call();\n    },\n    /**\n     * Getting suggestions of probable places names or address based on uncomplete texts, using the [autocompletion service of the Geoportal Platform]{@link https://geoservices.ign.fr/documentation/geoservices/autocompletion.html}\n     *\n     * @method autoComplete\n     * @param {Object} options - Options for function call.\n     * @param {String} options.apiKey - Access key to Geoportal platform, obtained [here]{@link http://professionnels.ign.fr/ign/contrats}.\n     * @param {String} options.text - Text input to complete.\n     * @param {Array.<String>} [options.filterOptions.type = \"StreetAddress\"] - Suggestion types to provide : address (\"StreetAddress\") and/or place name (\"PositionOfInterest\").\n     * @param {Array.<String>} [options.filterOptions.territory] - Places where to limit the search of suggestions : \"METROPOLE\" (Corsica and metropolitan France), \"DOMTOM\" (French overseas departments and territories), or an INSEE code of a department. No limitation by default. For instance : ['METROPOLE', '31']\n     * @param {Number} [options.maximumResponses = 10] - Maximum number of responses.\n     * @param {Function} options.onSuccess - Callback function for getting successful service response. Takes a {@link Gp.Services.AutoCompleteResponse} object as a parameter except if \"rawResponse\" is set to true.\n     * @param {Function} [options.onFailure] - Callback function for handling unsuccessful service responses (timeOut, missing rights, ...). Takes a {@link Gp.Error} object as parameter.\n     * @param {Number} [options.timeOut=0] - Number of milliseconds above which a timeOut response will be returned with onFailure callback (see above). Default value is 0 which means timeOut will not be handled.\n     * @param {String} [options.serverUrl=http (s)://wxs.ign.fr/APIKEY/ols/apis/completion] - Web service URL. If used, options.apiKey parameter is ignored. Only use if you know what you're doing.\n     * @param {String} [options.protocol=XHR] - Protocol used to handle dialog with web service. Possible values are 'JSONP' ({@link https://en.wikipedia.org/wiki/JSONP}) and 'XHR' ({@link https://en.wikipedia.org/wiki/XMLHttpRequest}). Only XHR protocol is supported in a NodeJS environment. Only use if you know what you're doing.\n     * @param {String} [options.proxyURL] - Proxy URL to use when requesting underlying web service. Ignored when options.protocol is set to 'JSONP' value. Only use if you know what you're doing.\n     * @param {String} [options.callbackSuffix] - Callback function name suffix to use in case of a JSONP protocol use (see above), to set your own suffix instead of auto-increment. Ignored when options.protocol is set to 'XHR' value. Only use if you know what you're doing.\n     * @param {String} [options.httpMethod=GET] - HTTP method to use when requesting underlying web service in case of a XHR protocol use (see above). Possible values are 'GET' and 'POST'. Ignored when options.protocol is set to 'JSONP' value. Only use if you know what you are doing.\n     * @param {String} [options.contentType=\"application/xml\"] - Content-Type to use when requesting underlying web service in case of a XHR protocol use (see above) and if method HTTP is POST. Ignored when options.protocol is set to 'JSONP' value. Only use if you know what you are doing.\n     * @param {Boolean} [options.rawResponse=false] - Setting this parameter to true implies you want to handle the service response by yourself : it will be returned as an unparsed String in onSuccess callback parameter. Only use if you know what you are doing.\n     * @param {Function} [options.onBeforeParse] - Callback function for handling service response before parsing (as an unparsed String). Takes a String as a parameter (the raw service response). Returns a String that will be parsed as the service response. Ignored when options.protocol is set to 'XHR' value. Only use if you know what you are doing.\n     */\n    autoComplete : function (options) {\n        var autoCompleteService = new __WEBPACK_IMPORTED_MODULE_4__AutoComplete_AutoComplete__[\"a\" /* default */](options);\n        autoCompleteService.call();\n    },\n    /**\n     * Getting a route from one point to another using the [route service of the Geoportal Platform]{@link https://geoservices.ign.fr/documentation/geoservices/itineraires.html}.\n     *\n     * @method route\n     * @param {Object} options - Options for function call.\n     * @param {String} options.apiKey - Access key to Geoportal platform, obtained [here]{@link http://professionnels.ign.fr/ign/contrats}.\n     * @param {String} [options.routePreference = \"fastest\"] - Indicates the way to compute the route : \"fastest\" (time optimisation) or \"shortest\" (distance optimisation).\n     * @param {Gp.Point} options.startPoint - Start point of the route. Expressed in CRS:84 coordinates system (startPoint.x corresponds to longitude, startPoint.y corresponds to latitude).\n     * @param {Gp.Point} options.endPoint - End point of the route. Expressed in CRS:84 coordinates system (endPoint.x corresponds to longitude, endPoint.y corresponds to latitude).\n     * @param {Array.<Gp.Point>} [options.viaPoints] - Ordered via Points of the route. Expressed in CRS:84 coordinates system (viaPoints[i].x corresponds to longitude, viaPoints[i].y corresponds to latitude).\n     * @param {String} [options.graph = \"Voiture\"] - User profile to use to compute the route : \"Voiture\" (using a vehicule) or \"Pieton\" (pedestrian). Has an influence on the kind of roads the route may use and the average speed.\n     * @param {Array.<String>} [options.exclusions] - Indicates if route has to avoid some features (\"toll\", \"bridge\" or \"tunnel\").\n     * @param {Boolean} [options.geometryInInstructions = false] - Indicates if route geometry has to be also returned with route instructions.\n     * @param {Boolean} [options.provideBoundingBox = true] - Indicates if route instructions has to be localised with a BBOX in the response.\n     * @param {String} [options.distanceUnit = \"km\"] - The unit used to provide distances in the response (\"m\" or \"km\").\n     * @param {Function} options.onSuccess - Callback function for getting successful service response. Takes a {@link Gp.Services.RouteResponse} object as a parameter except if \"rawResponse\" is set to true.\n     * @param {Function} [options.onFailure] - Callback function for handling unsuccessful service responses (timeOut, missing rights, ...). Takes a {@link Gp.Error} object as parameter.\n     * @param {Number} [options.timeOut=0] - Number of milliseconds above which a timeOut response will be returned with onFailure callback (see above). Default value is 0 which means timeOut will not be handled.\n     * @param {String} [options.outputFormat='json'] - Output format (\"json\" or \"xml\") to use for underlying webService. Only use if you know what you are doing.\n     * @param {String} [options.serverUrl=http (s)://wxs.ign.fr/APIKEY/itineraire/rest/route.json] - Web service URL. If used, options.apiKey parameter is ignored. Only use if you know what you're doing.\n     * @param {String} [options.protocol=XHR] - Protocol used to handle dialog with web service. Possible values are 'JSONP' ({@link https://en.wikipedia.org/wiki/JSONP}) and 'XHR' ({@link https://en.wikipedia.org/wiki/XMLHttpRequest}). Only XHR protocol is supported in a NodeJS environment. Only use if you know what you're doing.\n     * @param {String} [options.proxyURL] - Proxy URL to use when requesting underlying web service. Ignored when options.protocol is set to 'JSONP' value. Only use if you know what you're doing.\n     * @param {String} [options.callbackSuffix] - Callback function name suffix to use in case of a JSONP protocol use (see above), to set your own suffix instead of auto-increment. Ignored when options.protocol is set to 'XHR' value. Only use if you know what you're doing.\n     * @param {String} [options.httpMethod=GET] - HTTP method to use when requesting underlying web service in case of a XHR protocol use (see above). Possible values are 'GET' and 'POST'. Ignored when options.protocol is set to 'JSONP' value. Only use if you know what you are doing.\n     * @param {String} [options.contentType=\"application/xml\"] - Content-Type to use when requesting underlying web service in case of a XHR protocol use (see above) and if method HTTP is POST. Ignored when options.protocol is set to 'JSONP' value. Only use if you know what you are doing.\n     * @param {Boolean} [options.rawResponse=false] - Setting this parameter to true implies you want to handle the service response by yourself : it will be returned as an unparsed String in onSuccess callback parameter. Only use if you know what you are doing.\n     * @param {Function} [options.onBeforeParse] - Callback function for handling service response before parsing (as an unparsed String). Takes a String as a parameter (the raw service response). Returns a String that will be parsed as the service response. Ignored when options.protocol is set to 'XHR' value. Only use if you know what you are doing.\n     */\n    route : function (options) {\n        var routeService = new __WEBPACK_IMPORTED_MODULE_5__Route_Route__[\"a\" /* default */](options);\n        routeService.call();\n    },\n    /**\n     * Computing a set of places (curve) reachable from a given point (or from where to start to reach a given point) within a time or distance constraint using the [isochrone service of the Geoportal Platform]{@link https://geoservices.ign.fr/documentation/geoservices/isochrones.html}.\n     *\n     * @method isoCurve\n     * @param {Object} options - Options for function call.\n     * @param {String} options.apiKey - Access key to Geoportal platform, obtained [here]{@link http://professionnels.ign.fr/ign/contrats}.\n     * @param {Gp.Point} options.position - Start or Arrival (options.reverse==true) Point for the computing. Expressed in CRS:84 coordinates system (position.x corresponds to longitude, position.y corresponds to latitude).\n     * @param {String} [options.graph = \"Voiture\"] - User profile to use to compute the isoCurve : \"Voiture\" (using a vehicule) or \"Pieton\" (pedestrian). Has an influence on the kind of roads to use and the average speed.\n     * @param {Array.<String>} [options.exclusions] - Indicates if route has to avoid some features (\"toll\", \"bridge\" or \"tunnel\").\n     * @param {String} [options.method = \"time\"] - Computing method to use : \"time\" (using a duration as a constraint) or \"distance\" (using a distance as a constraint).\n     * @param {Float} options.time - Maximum duration (expressed in seconds) to use when options.method is set to \"time\".\n     * @param {Float} options.distance - Maximum distance (expressed in meters) to use when options.method is set to \"distance\".\n     * @param {Boolean} [options.reverse = false] - Set this parameter to true if you want options.position to be the destination (instead of departure) for the computing.\n     * @param {Boolean} [options.smoothing = false] - Set this parameter to true if you want the resulting geometry to be smoothed.\n     * @param {Boolean} [options.holes = false] - Set this parameter to true if you want the resulting geometry (polygon) to have holes if pertinent.\n     * @param {Function} options.onSuccess - Callback function for getting successful service response. Takes a {@link Gp.Services.IsoCurveResponse} object as a parameter except if \"rawResponse\" is set to true.\n     * @param {Function} [options.onFailure] - Callback function for handling unsuccessful service responses (timeOut, missing rights, ...). Takes a {@link Gp.Error} object as parameter.\n     * @param {Number} [options.timeOut=0] - Number of milliseconds above which a timeOut response will be returned with onFailure callback (see above). Default value is 0 which means timeOut will not be handled.\n     * @param {String} [options.outputFormat='json'] - Output format (\"json\" or \"xml\") to use for underlying webService. Only use if you know what you are doing.\n     * @param {String} [options.serverUrl=http (s)://wxs.ign.fr/APIKEY/isochrone/isochrone.json] - Web service URL. If used, options.apiKey parameter is ignored. Only use if you know what you're doing.\n     * @param {String} [options.protocol=XHR] - Protocol used to handle dialog with web service. Possible values are 'JSONP' ({@link https://en.wikipedia.org/wiki/JSONP}) and 'XHR' ({@link https://en.wikipedia.org/wiki/XMLHttpRequest}). Only XHR protocol is supported in a NodeJS environment. Only use if you know what you're doing.\n     * @param {String} [options.proxyURL] - Proxy URL to use when requesting underlying web service. Ignored when options.protocol is set to 'JSONP' value. Only use if you know what you're doing.\n     * @param {String} [options.callbackSuffix] - Callback function name suffix to use in case of a JSONP protocol use (see above), to set your own suffix instead of auto-increment. Ignored when options.protocol is set to 'XHR' value. Only use if you know what you're doing.\n     * @param {String} [options.httpMethod=GET] - HTTP method to use when requesting underlying web service in case of a XHR protocol use (see above). Possible values are 'GET' and 'POST'. Ignored when options.protocol is set to 'JSONP' value. Only use if you know what you are doing.\n     * @param {String} [options.contentType=\"application/xml\"] - Content-Type to use when requesting underlying web service in case of a XHR protocol use (see above) and if method HTTP is POST. Ignored when options.protocol is set to 'JSONP' value. Only use if you know what you are doing.\n     * @param {Boolean} [options.rawResponse=false] - Setting this parameter to true implies you want to handle the service response by yourself : it will be returned as an unparsed String in onSuccess callback parameter. Only use if you know what you are doing.\n     * @param {Function} [options.onBeforeParse] - Callback function for handling service response before parsing (as an unparsed String). Takes a String as a parameter (the raw service response). Returns a String that will be parsed as the service response. Ignored when options.protocol is set to 'XHR' value. Only use if you know what you are doing.\n     */\n    isoCurve : function (options) {\n        var processIsoCurveService = new __WEBPACK_IMPORTED_MODULE_6__ProcessIsoCurve_ProcessIsoCurve__[\"a\" /* default */](options);\n        processIsoCurveService.call();\n    }\n};\n\n/**\n * Point object.\n *\n * @namespace\n * @alias Gp.Point\n *\n * @property {Float} x - Point abscissa\n * @property {Float} y - Point ordinate\n */\nvar point = {};\n\n/**\n * Circle object.\n *\n * @namespace\n * @alias Gp.Circle\n *\n * @property {Float} x - Circle center abscissa.\n * @property {Float} y - Circle center ordinate.\n * @property {Float} radius - Circle radius.\n */\nvar circle = {};\n\n/**\n * Bounding box object, expressed with four coordinates.\n *\n * @namespace\n * @alias Gp.BBox\n *\n * @property {Float} left - minimum abscissa\n * @property {Float} right - maximum abscissa\n * @property {Float} bottom - minimum ordinate\n * @property {Float} top - maximum ordinate\n */\nvar bbox = {};\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (Services);\n\n\n/***/ }),\n/* 46 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__ = __webpack_require__(1);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__Exceptions_ErrorService__ = __webpack_require__(2);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__CommonService__ = __webpack_require__(3);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__DefaultUrlService__ = __webpack_require__(6);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__Request_AltiRequestFactory__ = __webpack_require__(54);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__Response_AltiResponseFactory__ = __webpack_require__(58);\n\n\n\n\n\n\n\n\n\n/**\n * @classdesc\n *\n * Appel du service d'altimtrie du Goportail\n *\n * @todo gestion du parma. output et callback\n * @todo outputFormat (REST) et format (WPS)\n * @todo La reponse JSON peut encapsuler un XML !\n *\n * @constructor\n * @extends {Gp.Services.CommonService}\n * @alias Gp.Services.Alti\n * @param {Object} options - options spcifiques au service (+ les options herites)\n *\n * @param {Array.<Object>} options.positions - Tableau ({lon:float,lat:float}) contenant les coordonnes des points (CRS:84)\n *      dont on veut connatre les altitudes (ou  partir desquelles on va calculer le profil).\n *      Chaque lment du tableau est un objet JavaScript avec deux attributs : lon et lat, qui sont des flottants.\n *      Minimum 2 lments si on souhaite calculer un profil altimtrique (ElevationLine).\n *      Maximum 50 lments.\n *\n * @param {String} options.outputFormat - Le format de la rponse du service alti : 'xml' ou 'json'.\n *      Ce paramtre dterminera l'extension '.xml' ou '.json' du service dans le cas de l'API REST,\n *      ou la valeur du paramtre 'format' dans le cas de la norme WPS.\n *      Ncessaire si serverUrl est renseign, et qu'on souhaite passer par l'API REST,\n *      pour connatre le format dans lequel sera fournie la rponse (pour son traitement).\n *      Non ncessaire pour la norme WPS. Par dfaut, ce paramtre vaut 'json'.\n *\n * @param {Number} [options.sampling] - Nombre de points  utiliser pour dterminer le trac d'un profil altimtrique, compris entre 2 et 5000.\n *      A spcifier lorsqu'on souhaite accder  cette fonctionnalit.\n *      Dans ce cas, les points fournis en entre (au minimum de deux) servent  dterminer l'axe planimtrique\n *      le long duquel le profil doit tre calcul.\n *      Si le paramtre sampling n'est pas spcifi ou moins de deux points sont fournis,\n *      c'est le service Elevation qui sera interrog (altitudes simples calcules pour les points fournis).\n *      Une valeur de sampling strictement infrieure  2 dclenchera un chantillonnage avec la valeur par dfaut du service (3 points).\n *\n * @param {String} [options.api] - Manire d'accder au service : 'REST' (via l'API REST) ou 'WPS' (via la norme WPS).\n *      Par dfaut, on utilise l'API REST.\n *\n * @param {Boolean} [options.zonly] - Permet de ne rcuprer que les altitudes en sortie s'il vaut 'true'.\n *      Vaut 'false' par dfaut.\n *\n * @example\n *   var options = {\n *      apiKey : null,\n *      serverUrl : 'http://localhost/service/',\n *      protocol : 'JSONP', // JSONP|XHR\n *      proxyURL : null,\n *      httpMethod : 'GET', // GET|POST\n *      timeOut : 10000, // ms\n *      rawResponse : false, // true|false\n *      scope : null, // this\n *      onSuccess : function (response) {},\n *      onFailure : function (error) {},\n *      // spcifique au service\n *      positions : [{lon:, lat:}, {lon:, lat:}],\n *      outputFormat : 'json' // json|xml\n *      sampling : 3,\n *      api : 'REST', // REST|WPS\n *      zonly : false // false|true\n *   };\n *\n * @private\n */\nfunction Alti (options) {\n\n    if (!(this instanceof Alti)) {\n        throw new TypeError(__WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__[\"a\" /* default */].getMessage(\"CLASS_CONSTRUCTOR\", \"Alti\"));\n    }\n\n    /**\n     * Nom de la classe (heritage)\n     * FIXME instance ou classe ?\n     */\n    this.CLASSNAME = \"Alti\";\n\n    // appel du constructeur par heritage\n    __WEBPACK_IMPORTED_MODULE_3__CommonService__[\"a\" /* default */].apply(this, arguments);\n\n    this.logger = __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__[\"a\" /* default */].getLogger(\"Gp.Services.Alti\");\n    this.logger.trace(\"[Constructeur Alti (options)]\");\n\n    // #####################\n    // analyse des options\n    // #####################\n\n    if (!options.positions) {\n        throw new Error(__WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__[\"a\" /* default */].getMessage(\"PARAM_MISSING\", \"positions\"));\n    }\n\n    if (options.positions.length === 0) {\n        throw new Error(__WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__[\"a\" /* default */].getMessage(\"PARAM_EMPTY\", \"positions\"));\n    }\n\n    // ajout des options spcifiques au service\n    this.options.positions = options.positions;\n\n    // format de rponse du service : \"json\" ou \"xml\" (valeur par dfaut), en minuscule !\n    this.options.outputFormat = ( typeof options.outputFormat === \"string\") ? options.outputFormat.toLowerCase() : \"xml\";\n\n    // sampling\n    this.options.sampling = options.sampling || null;\n\n    // type d'api utilis pour requeter le service, en majuscule !\n    this.options.api = ( typeof options.api === \"string\") ? options.api.toUpperCase() : \"REST\";\n\n    // l'api ne peut tre interroge qu'en GET.\n    if (this.options.api === \"REST\") {\n        this.options.httpMethod = \"GET\";\n    }\n\n    // param. zonly\n    this.options.zonly = options.zonly || false;\n\n    // gestion de l'url du service par defaut\n    // si l'url n'est pas renseigne, il faut utiliser les urls par defaut\n    // en fonction du type d'api, REST ou WPS, du format de reponse demand (outputFormat)\n    // ainsi que sur le type de service (profil ou elevation)\n    if (!this.options.serverUrl) {\n\n        var lstUrlByDefault = __WEBPACK_IMPORTED_MODULE_4__DefaultUrlService__[\"a\" /* default */].Alti.url(this.options.apiKey);\n        var urlFound = null;\n        switch (this.options.api) {\n            case \"WPS\":\n                urlFound = lstUrlByDefault.wps;\n                break;\n            case \"REST\":\n                var key = (options.sampling ? \"profil\" : \"elevation\") + \"-\" + this.options.outputFormat;\n                urlFound = lstUrlByDefault[key];\n                break;\n            default:\n                throw new Error(__WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__[\"a\" /* default */].getMessage(\"PARAM_UNKNOWN\", \"api\"));\n        }\n\n        if (!urlFound) {\n            throw new Error(\"Url by default not found !\");\n        }\n        this.options.serverUrl = urlFound;\n        this.logger.trace(\"Server URL by default : \" + this.options.serverUrl);\n    }\n\n    // gestion du type de service\n    // si l'extension de l'url est .json ou .xml, on surcharge le format de sortie (outputFormat)\n    var idx = this.options.serverUrl.lastIndexOf(\".\");\n    if (idx !== -1) {\n        var extension = this.options.serverUrl.substring(idx + 1);\n        if (extension && extension.length < 5) { // FIXME extension de moins de 4 car. ...\n            this.logger.trace(\"Server Extension URL : \" + extension);\n            switch (extension.toLowerCase()) {\n                case \"json\":\n                case \"xml\":\n                    this.options.outputFormat = extension.toLowerCase();\n                    break;\n                default:\n                    throw new Error(\"type of service : unknown or unsupported (json or xml) !\");\n            }\n        }\n    }\n}\n\n/**\n * @lends module:Alti#\n */\nAlti.prototype = Object.create(__WEBPACK_IMPORTED_MODULE_3__CommonService__[\"a\" /* default */].prototype, {\n    // todo\n    // getter/setter\n});\n\n/**\n * Constructeur (alias)\n */\nAlti.prototype.constructor = Alti;\n\n/**\n * Cration de la requte (overwrite)\n *\n * @param {Function} error   - callback des erreurs\n * @param {Function} success - callback\n */\nAlti.prototype.buildRequest = function (error, success) {\n\n    // utilisation en mode callback\n    var options = {\n        httpMethod : this.options.httpMethod,\n        /** callback */\n        onSuccess : function (result) {\n            // sauvegarde de la requete !\n            this.request = result;\n            success.call(this, this.request);\n        },\n        onError : error,\n        scope : this,\n        // spcifique au service :\n        positions : this.options.positions,\n        outputFormat : this.options.outputFormat,\n        sampling : this.options.sampling,\n        api : this.options.api,\n        zonly : this.options.zonly\n    };\n\n    __WEBPACK_IMPORTED_MODULE_5__Request_AltiRequestFactory__[\"a\" /* default */].build(options);\n};\n\n/**\n * Analyse de la reponse (overwrite)\n *\n * @param {Function} error   - callback des erreurs\n * @param {Function} success - callback\n */\nAlti.prototype.analyzeResponse = function (error, success) {\n\n    // INFO\n    // Factory pour masquer la complexit du retour du service qui renvoie soit\n    //  - une 'string' qui contient du XML ou JSON natif en mode XHR\n    //  - un objet JSON qui est natif ou encapsul\n\n    if (this.response) {\n\n        var options = {\n            response : this.response,\n            outputFormat : this.options.outputFormat, // utile pour parser la string en mode XHR : JSON ou XML !\n            rawResponse : this.options.rawResponse,\n            onError : error,\n            onSuccess : success,\n            scope : this\n        };\n\n        __WEBPACK_IMPORTED_MODULE_6__Response_AltiResponseFactory__[\"a\" /* default */].build(options);\n\n    } else {\n        error.call(this, new __WEBPACK_IMPORTED_MODULE_2__Exceptions_ErrorService__[\"a\" /* default */](__WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__[\"a\" /* default */].getMessage(\"SERVICE_RESPONSE_EMPTY\")));\n    }\n};\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (Alti);\n\n\n/***/ }),\n/* 47 */\n/***/ (function(module, exports, __webpack_require__) {\n\nvar __WEBPACK_AMD_DEFINE_FACTORY__, __WEBPACK_AMD_DEFINE_RESULT__;/*\n* loglevel - https://github.com/pimterry/loglevel\n*\n* Copyright (c) 2013 Tim Perry\n* Licensed under the MIT license.\n*/\n(function (root, definition) {\n    \"use strict\";\n    if (true) {\n        !(__WEBPACK_AMD_DEFINE_FACTORY__ = (definition),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ = (typeof __WEBPACK_AMD_DEFINE_FACTORY__ === 'function' ?\n\t\t\t\t(__WEBPACK_AMD_DEFINE_FACTORY__.call(exports, __webpack_require__, exports, module)) :\n\t\t\t\t__WEBPACK_AMD_DEFINE_FACTORY__),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\n    } else if (typeof module === 'object' && module.exports) {\n        module.exports = definition();\n    } else {\n        root.log = definition();\n    }\n}(this, function () {\n    \"use strict\";\n\n    // Slightly dubious tricks to cut down minimized file size\n    var noop = function() {};\n    var undefinedType = \"undefined\";\n\n    var logMethods = [\n        \"trace\",\n        \"debug\",\n        \"info\",\n        \"warn\",\n        \"error\"\n    ];\n\n    // Cross-browser bind equivalent that works at least back to IE6\n    function bindMethod(obj, methodName) {\n        var method = obj[methodName];\n        if (typeof method.bind === 'function') {\n            return method.bind(obj);\n        } else {\n            try {\n                return Function.prototype.bind.call(method, obj);\n            } catch (e) {\n                // Missing bind shim or IE8 + Modernizr, fallback to wrapping\n                return function() {\n                    return Function.prototype.apply.apply(method, [obj, arguments]);\n                };\n            }\n        }\n    }\n\n    // Build the best logging method possible for this env\n    // Wherever possible we want to bind, not wrap, to preserve stack traces\n    function realMethod(methodName) {\n        if (methodName === 'debug') {\n            methodName = 'log';\n        }\n\n        if (typeof console === undefinedType) {\n            return false; // No method possible, for now - fixed later by enableLoggingWhenConsoleArrives\n        } else if (console[methodName] !== undefined) {\n            return bindMethod(console, methodName);\n        } else if (console.log !== undefined) {\n            return bindMethod(console, 'log');\n        } else {\n            return noop;\n        }\n    }\n\n    // These private functions always need `this` to be set properly\n\n    function replaceLoggingMethods(level, loggerName) {\n        /*jshint validthis:true */\n        for (var i = 0; i < logMethods.length; i++) {\n            var methodName = logMethods[i];\n            this[methodName] = (i < level) ?\n                noop :\n                this.methodFactory(methodName, level, loggerName);\n        }\n\n        // Define log.log as an alias for log.debug\n        this.log = this.debug;\n    }\n\n    // In old IE versions, the console isn't present until you first open it.\n    // We build realMethod() replacements here that regenerate logging methods\n    function enableLoggingWhenConsoleArrives(methodName, level, loggerName) {\n        return function () {\n            if (typeof console !== undefinedType) {\n                replaceLoggingMethods.call(this, level, loggerName);\n                this[methodName].apply(this, arguments);\n            }\n        };\n    }\n\n    // By default, we use closely bound real methods wherever possible, and\n    // otherwise we wait for a console to appear, and then try again.\n    function defaultMethodFactory(methodName, level, loggerName) {\n        /*jshint validthis:true */\n        return realMethod(methodName) ||\n               enableLoggingWhenConsoleArrives.apply(this, arguments);\n    }\n\n    function Logger(name, defaultLevel, factory) {\n      var self = this;\n      var currentLevel;\n      var storageKey = \"loglevel\";\n      if (name) {\n        storageKey += \":\" + name;\n      }\n\n      function persistLevelIfPossible(levelNum) {\n          var levelName = (logMethods[levelNum] || 'silent').toUpperCase();\n\n          if (typeof window === undefinedType) return;\n\n          // Use localStorage if available\n          try {\n              window.localStorage[storageKey] = levelName;\n              return;\n          } catch (ignore) {}\n\n          // Use session cookie as fallback\n          try {\n              window.document.cookie =\n                encodeURIComponent(storageKey) + \"=\" + levelName + \";\";\n          } catch (ignore) {}\n      }\n\n      function getPersistedLevel() {\n          var storedLevel;\n\n          if (typeof window === undefinedType) return;\n\n          try {\n              storedLevel = window.localStorage[storageKey];\n          } catch (ignore) {}\n\n          // Fallback to cookies if local storage gives us nothing\n          if (typeof storedLevel === undefinedType) {\n              try {\n                  var cookie = window.document.cookie;\n                  var location = cookie.indexOf(\n                      encodeURIComponent(storageKey) + \"=\");\n                  if (location !== -1) {\n                      storedLevel = /^([^;]+)/.exec(cookie.slice(location))[1];\n                  }\n              } catch (ignore) {}\n          }\n\n          // If the stored level is not valid, treat it as if nothing was stored.\n          if (self.levels[storedLevel] === undefined) {\n              storedLevel = undefined;\n          }\n\n          return storedLevel;\n      }\n\n      /*\n       *\n       * Public logger API - see https://github.com/pimterry/loglevel for details\n       *\n       */\n\n      self.name = name;\n\n      self.levels = { \"TRACE\": 0, \"DEBUG\": 1, \"INFO\": 2, \"WARN\": 3,\n          \"ERROR\": 4, \"SILENT\": 5};\n\n      self.methodFactory = factory || defaultMethodFactory;\n\n      self.getLevel = function () {\n          return currentLevel;\n      };\n\n      self.setLevel = function (level, persist) {\n          if (typeof level === \"string\" && self.levels[level.toUpperCase()] !== undefined) {\n              level = self.levels[level.toUpperCase()];\n          }\n          if (typeof level === \"number\" && level >= 0 && level <= self.levels.SILENT) {\n              currentLevel = level;\n              if (persist !== false) {  // defaults to true\n                  persistLevelIfPossible(level);\n              }\n              replaceLoggingMethods.call(self, level, name);\n              if (typeof console === undefinedType && level < self.levels.SILENT) {\n                  return \"No console available for logging\";\n              }\n          } else {\n              throw \"log.setLevel() called with invalid level: \" + level;\n          }\n      };\n\n      self.setDefaultLevel = function (level) {\n          if (!getPersistedLevel()) {\n              self.setLevel(level, false);\n          }\n      };\n\n      self.enableAll = function(persist) {\n          self.setLevel(self.levels.TRACE, persist);\n      };\n\n      self.disableAll = function(persist) {\n          self.setLevel(self.levels.SILENT, persist);\n      };\n\n      // Initialize with the right level\n      var initialLevel = getPersistedLevel();\n      if (initialLevel == null) {\n          initialLevel = defaultLevel == null ? \"WARN\" : defaultLevel;\n      }\n      self.setLevel(initialLevel, false);\n    }\n\n    /*\n     *\n     * Top-level API\n     *\n     */\n\n    var defaultLogger = new Logger();\n\n    var _loggersByName = {};\n    defaultLogger.getLogger = function getLogger(name) {\n        if (typeof name !== \"string\" || name === \"\") {\n          throw new TypeError(\"You must supply a name when creating a logger.\");\n        }\n\n        var logger = _loggersByName[name];\n        if (!logger) {\n          logger = _loggersByName[name] = new Logger(\n            name, defaultLogger.getLevel(), defaultLogger.methodFactory);\n        }\n        return logger;\n    };\n\n    // Grab the current global log variable in case of overwrite\n    var _log = (typeof window !== undefinedType) ? window.log : undefined;\n    defaultLogger.noConflict = function() {\n        if (typeof window !== undefinedType &&\n               window.log === defaultLogger) {\n            window.log = _log;\n        }\n\n        return defaultLogger;\n    };\n\n    defaultLogger.getLoggers = function getLoggers() {\n        return _loggersByName;\n    };\n\n    return defaultLogger;\n}));\n\n\n/***/ }),\n/* 48 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__Utils_Helper__ = __webpack_require__(5);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__XHR__ = __webpack_require__(19);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__JSONP__ = __webpack_require__(53);\n/**\n * Protocols : Interface de dialogue avec les webservices\n *\n * @module Protocols\n * @private\n * @alias Gp.Protocols.Protocols\n */\n\n\n\n\nvar Protocol = {\n\n    /**\n     * Interface unique d\"envoi d\"une requte.\n     *\n     * @method send\n     * @static\n     * @param {Object} options - options generales\n     * @param {String} options.url      - url du service\n     * @param {String} options.method   - GET, POST, PUT, DELETE\n     * @param {String} options.protocol - XHR | JSONP\n     * @param {String} options.format   - format de la reponse du service : json, xml ou null (brute)...\n     * @param {String} options.wrap     - encapsuler la reponse du service dans du JSON : true|false (true par defaut sur le protocole JSONP)\n     * @param {String} options.callbackSuffix - suffixe de la fonction de callback (JSONP uniquement) (ex: si callbackSuffix=\"\", la fonction s'appellera \"callback\")\n     * @param {String} options.timeOut  - 0 ms\n     * @param {Boolean} options.nocache  - true|false\n     * @param {Object|String} options.data        - content (post) ou param (get)\n     * @param {Object|String} options.headers     - (post) ex. referer\n     * @param {Object|String} options.content - (post) ex. \"application/json\"\n     * @param {String} options.scope       - this (TODO)\n     * @param {Function} options.onResponse - callback\n     * @param {Function} options.onFailure - callback\n     * @param {Function} options.onTimeOut - callback\n     * @param {String} options.proxyUrl -  (TODO)\n     */\n    send : function (options) {\n\n        // INFO\n        // \"output\" - param est interne  la classe \"Protocol\" (parametrable via \"wrap\"), et  ajouter  l\"url\n        //      ce param est independant du service car il est gr par le filtre LUA :\n        //          ex. json|xml (json par defaut).\n        //          Ce param. permet d\"encapsuler du XML dans du JSON :\n        //              {http : {status:200, error:null},xml :\"rponse du service\"}\n        //          Utile pour les services qui ne repondent que du XML (ex. Geocodage)\n        //\n        // |-------------------------------------------------|\n        // |      \\service |      |     |                    |\n        // | output\\ format| json | xml |     remarques      |\n        // |--------\\------|------|-----|--------------------|\n        // |    json       | json | json| json/xml encapsul |\n        // |    xml        | json | xml | param inactif      |\n        // |-------------------------------------------------|\n        // ex. le service demande une reponse native au \"format\" json et avec un \"output\" json.\n        // on a donc une reponse json encapsul dans un json : ce qu'on ne souhaite pas !\n        // dans ce cas on ne renseigne pas output=json\n\n        // INFO\n        // \"wrap\" - choix d\"encapsuler ou non les reponses dans du JSON.\n        //      Par defaut, on encapsule uniquement les reponses sur le protocole JSONP (et qui sont en xml) !\n\n        // INFO\n        // \"callback\" - param est interne  la classe \"Protocol\" (non parametrable), et  ajouter  l\"url\n        //      ce param est independant du service car il est gr aussi par le filtre LUA :\n        //          ex. callback|null\n        //          Ce param. permet de renvoyer une reponse javascript :\n        //              callback ({http : {status:200, error:null},xml :\"rponse du service\"})\n        //          Ce param. est non renseign par defaut car pour du JSONP, on utilise le\n        //          le protocol JSONP, et ce dernier implemente dj le callback !\n\n        // settings par defaut\n        var settings = options || {\n            method : \"GET\",\n            // protocol : \"JSONP\",\n            protocol : \"XHR\",\n            timeOut : 0,\n            format : null,\n            wrap : true,\n            nocache : true,\n            output : \"json\",\n            callback : null,\n            callbackSuffix : null\n        };\n\n        // on determine l'environnement d'execution : browser ou non ?\n        // et on stoppe pour nodeJS... sur un protocole JSONP !\n        if ( typeof window === \"undefined\" && options.protocol === \"JSONP\") {\n            console.log(\"Value (s) for parameter (s) 'protocol=JSONP (instead use XHR)' not supported to NodeJS\");\n            return;\n        }\n\n        if (options.protocol === \"XHR\" || options.format === \"json\") {\n            settings.wrap = false;\n        } else if (options.protocol === \"JSONP\" && options.format === \"xml\") {\n            settings.wrap = true;\n        }\n\n        settings.callback = (options.protocol == \"JSONP\") ? null : null; // FIXME non gr !?\n        settings.output = settings.wrap ? \"json\" : null;\n\n        // on encapsule les reponses dans un objet JSON\n        if (settings.wrap) {\n            var params = {};\n            params.output = settings.output;\n            params.callback = settings.callback;\n            delete params.callback; // FIXME non gr !?\n            settings.url = __WEBPACK_IMPORTED_MODULE_0__Utils_Helper__[\"a\" /* default */].normalyzeUrl(options.url, params);\n        }\n\n        // choix de l\"implementation :\n        // XHR ou JSONP\n        switch (settings.protocol) {\n            case \"XHR\":\n                // on normalise l'url (gestion du cache)\n                if (options.method === \"GET\" && options.nocache) {\n                    settings.url = __WEBPACK_IMPORTED_MODULE_0__Utils_Helper__[\"a\" /* default */].normalyzeUrl(settings.url, {\n                        t : new Date().getTime()\n                    });\n                }\n                // appel du service en XHR\n                __WEBPACK_IMPORTED_MODULE_1__XHR__[\"a\" /* default */].call(settings);\n                break;\n            case \"JSONP\":\n\n                // on normalise l'url si les params. sont renseigns dans la string|object \"data\"\n                if (settings.data) {\n                    settings.url = __WEBPACK_IMPORTED_MODULE_0__Utils_Helper__[\"a\" /* default */].normalyzeUrl(settings.url, settings.data);\n                }\n\n                // appel du service en JSONP\n                __WEBPACK_IMPORTED_MODULE_2__JSONP__[\"a\" /* default */].call(settings);\n                break;\n            default:\n                throw new Error(\"protocol not supported (XHR|JSONP) !\");\n        }\n    }\n\n};\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (Protocol);\n\n\n/***/ }),\n/* 49 */\n/***/ (function(module, exports, __webpack_require__) {\n\n/* WEBPACK VAR INJECTION */(function(process, global) {/*!\n * @overview es6-promise - a tiny implementation of Promises/A+.\n * @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors (Conversion to ES6 API by Jake Archibald)\n * @license   Licensed under MIT license\n *            See https://raw.githubusercontent.com/stefanpenner/es6-promise/master/LICENSE\n * @version   v4.2.4+314e4831\n */\n\n(function (global, factory) {\n\t true ? module.exports = factory() :\n\ttypeof define === 'function' && define.amd ? define(factory) :\n\t(global.ES6Promise = factory());\n}(this, (function () { 'use strict';\n\nfunction objectOrFunction(x) {\n  var type = typeof x;\n  return x !== null && (type === 'object' || type === 'function');\n}\n\nfunction isFunction(x) {\n  return typeof x === 'function';\n}\n\n\n\nvar _isArray = void 0;\nif (Array.isArray) {\n  _isArray = Array.isArray;\n} else {\n  _isArray = function (x) {\n    return Object.prototype.toString.call(x) === '[object Array]';\n  };\n}\n\nvar isArray = _isArray;\n\nvar len = 0;\nvar vertxNext = void 0;\nvar customSchedulerFn = void 0;\n\nvar asap = function asap(callback, arg) {\n  queue[len] = callback;\n  queue[len + 1] = arg;\n  len += 2;\n  if (len === 2) {\n    // If len is 2, that means that we need to schedule an async flush.\n    // If additional callbacks are queued before the queue is flushed, they\n    // will be processed by this flush that we are scheduling.\n    if (customSchedulerFn) {\n      customSchedulerFn(flush);\n    } else {\n      scheduleFlush();\n    }\n  }\n};\n\nfunction setScheduler(scheduleFn) {\n  customSchedulerFn = scheduleFn;\n}\n\nfunction setAsap(asapFn) {\n  asap = asapFn;\n}\n\nvar browserWindow = typeof window !== 'undefined' ? window : undefined;\nvar browserGlobal = browserWindow || {};\nvar BrowserMutationObserver = browserGlobal.MutationObserver || browserGlobal.WebKitMutationObserver;\nvar isNode = typeof self === 'undefined' && typeof process !== 'undefined' && {}.toString.call(process) === '[object process]';\n\n// test for web worker but not in IE10\nvar isWorker = typeof Uint8ClampedArray !== 'undefined' && typeof importScripts !== 'undefined' && typeof MessageChannel !== 'undefined';\n\n// node\nfunction useNextTick() {\n  // node version 0.10.x displays a deprecation warning when nextTick is used recursively\n  // see https://github.com/cujojs/when/issues/410 for details\n  return function () {\n    return process.nextTick(flush);\n  };\n}\n\n// vertx\nfunction useVertxTimer() {\n  if (typeof vertxNext !== 'undefined') {\n    return function () {\n      vertxNext(flush);\n    };\n  }\n\n  return useSetTimeout();\n}\n\nfunction useMutationObserver() {\n  var iterations = 0;\n  var observer = new BrowserMutationObserver(flush);\n  var node = document.createTextNode('');\n  observer.observe(node, { characterData: true });\n\n  return function () {\n    node.data = iterations = ++iterations % 2;\n  };\n}\n\n// web worker\nfunction useMessageChannel() {\n  var channel = new MessageChannel();\n  channel.port1.onmessage = flush;\n  return function () {\n    return channel.port2.postMessage(0);\n  };\n}\n\nfunction useSetTimeout() {\n  // Store setTimeout reference so es6-promise will be unaffected by\n  // other code modifying setTimeout (like sinon.useFakeTimers())\n  var globalSetTimeout = setTimeout;\n  return function () {\n    return globalSetTimeout(flush, 1);\n  };\n}\n\nvar queue = new Array(1000);\nfunction flush() {\n  for (var i = 0; i < len; i += 2) {\n    var callback = queue[i];\n    var arg = queue[i + 1];\n\n    callback(arg);\n\n    queue[i] = undefined;\n    queue[i + 1] = undefined;\n  }\n\n  len = 0;\n}\n\nfunction attemptVertx() {\n  try {\n    var vertx = Function('return this')().require('vertx');\n    vertxNext = vertx.runOnLoop || vertx.runOnContext;\n    return useVertxTimer();\n  } catch (e) {\n    return useSetTimeout();\n  }\n}\n\nvar scheduleFlush = void 0;\n// Decide what async method to use to triggering processing of queued callbacks:\nif (isNode) {\n  scheduleFlush = useNextTick();\n} else if (BrowserMutationObserver) {\n  scheduleFlush = useMutationObserver();\n} else if (isWorker) {\n  scheduleFlush = useMessageChannel();\n} else if (browserWindow === undefined && \"function\" === 'function') {\n  scheduleFlush = attemptVertx();\n} else {\n  scheduleFlush = useSetTimeout();\n}\n\nfunction then(onFulfillment, onRejection) {\n  var parent = this;\n\n  var child = new this.constructor(noop);\n\n  if (child[PROMISE_ID] === undefined) {\n    makePromise(child);\n  }\n\n  var _state = parent._state;\n\n\n  if (_state) {\n    var callback = arguments[_state - 1];\n    asap(function () {\n      return invokeCallback(_state, child, callback, parent._result);\n    });\n  } else {\n    subscribe(parent, child, onFulfillment, onRejection);\n  }\n\n  return child;\n}\n\n/**\n  `Promise.resolve` returns a promise that will become resolved with the\n  passed `value`. It is shorthand for the following:\n\n  ```javascript\n  let promise = new Promise(function(resolve, reject){\n    resolve(1);\n  });\n\n  promise.then(function(value){\n    // value === 1\n  });\n  ```\n\n  Instead of writing the above, your code now simply becomes the following:\n\n  ```javascript\n  let promise = Promise.resolve(1);\n\n  promise.then(function(value){\n    // value === 1\n  });\n  ```\n\n  @method resolve\n  @static\n  @param {Any} value value that the returned promise will be resolved with\n  Useful for tooling.\n  @return {Promise} a promise that will become fulfilled with the given\n  `value`\n*/\nfunction resolve$1(object) {\n  /*jshint validthis:true */\n  var Constructor = this;\n\n  if (object && typeof object === 'object' && object.constructor === Constructor) {\n    return object;\n  }\n\n  var promise = new Constructor(noop);\n  resolve(promise, object);\n  return promise;\n}\n\nvar PROMISE_ID = Math.random().toString(36).substring(2);\n\nfunction noop() {}\n\nvar PENDING = void 0;\nvar FULFILLED = 1;\nvar REJECTED = 2;\n\nvar TRY_CATCH_ERROR = { error: null };\n\nfunction selfFulfillment() {\n  return new TypeError(\"You cannot resolve a promise with itself\");\n}\n\nfunction cannotReturnOwn() {\n  return new TypeError('A promises callback cannot return that same promise.');\n}\n\nfunction getThen(promise) {\n  try {\n    return promise.then;\n  } catch (error) {\n    TRY_CATCH_ERROR.error = error;\n    return TRY_CATCH_ERROR;\n  }\n}\n\nfunction tryThen(then$$1, value, fulfillmentHandler, rejectionHandler) {\n  try {\n    then$$1.call(value, fulfillmentHandler, rejectionHandler);\n  } catch (e) {\n    return e;\n  }\n}\n\nfunction handleForeignThenable(promise, thenable, then$$1) {\n  asap(function (promise) {\n    var sealed = false;\n    var error = tryThen(then$$1, thenable, function (value) {\n      if (sealed) {\n        return;\n      }\n      sealed = true;\n      if (thenable !== value) {\n        resolve(promise, value);\n      } else {\n        fulfill(promise, value);\n      }\n    }, function (reason) {\n      if (sealed) {\n        return;\n      }\n      sealed = true;\n\n      reject(promise, reason);\n    }, 'Settle: ' + (promise._label || ' unknown promise'));\n\n    if (!sealed && error) {\n      sealed = true;\n      reject(promise, error);\n    }\n  }, promise);\n}\n\nfunction handleOwnThenable(promise, thenable) {\n  if (thenable._state === FULFILLED) {\n    fulfill(promise, thenable._result);\n  } else if (thenable._state === REJECTED) {\n    reject(promise, thenable._result);\n  } else {\n    subscribe(thenable, undefined, function (value) {\n      return resolve(promise, value);\n    }, function (reason) {\n      return reject(promise, reason);\n    });\n  }\n}\n\nfunction handleMaybeThenable(promise, maybeThenable, then$$1) {\n  if (maybeThenable.constructor === promise.constructor && then$$1 === then && maybeThenable.constructor.resolve === resolve$1) {\n    handleOwnThenable(promise, maybeThenable);\n  } else {\n    if (then$$1 === TRY_CATCH_ERROR) {\n      reject(promise, TRY_CATCH_ERROR.error);\n      TRY_CATCH_ERROR.error = null;\n    } else if (then$$1 === undefined) {\n      fulfill(promise, maybeThenable);\n    } else if (isFunction(then$$1)) {\n      handleForeignThenable(promise, maybeThenable, then$$1);\n    } else {\n      fulfill(promise, maybeThenable);\n    }\n  }\n}\n\nfunction resolve(promise, value) {\n  if (promise === value) {\n    reject(promise, selfFulfillment());\n  } else if (objectOrFunction(value)) {\n    handleMaybeThenable(promise, value, getThen(value));\n  } else {\n    fulfill(promise, value);\n  }\n}\n\nfunction publishRejection(promise) {\n  if (promise._onerror) {\n    promise._onerror(promise._result);\n  }\n\n  publish(promise);\n}\n\nfunction fulfill(promise, value) {\n  if (promise._state !== PENDING) {\n    return;\n  }\n\n  promise._result = value;\n  promise._state = FULFILLED;\n\n  if (promise._subscribers.length !== 0) {\n    asap(publish, promise);\n  }\n}\n\nfunction reject(promise, reason) {\n  if (promise._state !== PENDING) {\n    return;\n  }\n  promise._state = REJECTED;\n  promise._result = reason;\n\n  asap(publishRejection, promise);\n}\n\nfunction subscribe(parent, child, onFulfillment, onRejection) {\n  var _subscribers = parent._subscribers;\n  var length = _subscribers.length;\n\n\n  parent._onerror = null;\n\n  _subscribers[length] = child;\n  _subscribers[length + FULFILLED] = onFulfillment;\n  _subscribers[length + REJECTED] = onRejection;\n\n  if (length === 0 && parent._state) {\n    asap(publish, parent);\n  }\n}\n\nfunction publish(promise) {\n  var subscribers = promise._subscribers;\n  var settled = promise._state;\n\n  if (subscribers.length === 0) {\n    return;\n  }\n\n  var child = void 0,\n      callback = void 0,\n      detail = promise._result;\n\n  for (var i = 0; i < subscribers.length; i += 3) {\n    child = subscribers[i];\n    callback = subscribers[i + settled];\n\n    if (child) {\n      invokeCallback(settled, child, callback, detail);\n    } else {\n      callback(detail);\n    }\n  }\n\n  promise._subscribers.length = 0;\n}\n\nfunction tryCatch(callback, detail) {\n  try {\n    return callback(detail);\n  } catch (e) {\n    TRY_CATCH_ERROR.error = e;\n    return TRY_CATCH_ERROR;\n  }\n}\n\nfunction invokeCallback(settled, promise, callback, detail) {\n  var hasCallback = isFunction(callback),\n      value = void 0,\n      error = void 0,\n      succeeded = void 0,\n      failed = void 0;\n\n  if (hasCallback) {\n    value = tryCatch(callback, detail);\n\n    if (value === TRY_CATCH_ERROR) {\n      failed = true;\n      error = value.error;\n      value.error = null;\n    } else {\n      succeeded = true;\n    }\n\n    if (promise === value) {\n      reject(promise, cannotReturnOwn());\n      return;\n    }\n  } else {\n    value = detail;\n    succeeded = true;\n  }\n\n  if (promise._state !== PENDING) {\n    // noop\n  } else if (hasCallback && succeeded) {\n    resolve(promise, value);\n  } else if (failed) {\n    reject(promise, error);\n  } else if (settled === FULFILLED) {\n    fulfill(promise, value);\n  } else if (settled === REJECTED) {\n    reject(promise, value);\n  }\n}\n\nfunction initializePromise(promise, resolver) {\n  try {\n    resolver(function resolvePromise(value) {\n      resolve(promise, value);\n    }, function rejectPromise(reason) {\n      reject(promise, reason);\n    });\n  } catch (e) {\n    reject(promise, e);\n  }\n}\n\nvar id = 0;\nfunction nextId() {\n  return id++;\n}\n\nfunction makePromise(promise) {\n  promise[PROMISE_ID] = id++;\n  promise._state = undefined;\n  promise._result = undefined;\n  promise._subscribers = [];\n}\n\nfunction validationError() {\n  return new Error('Array Methods must be provided an Array');\n}\n\nvar Enumerator = function () {\n  function Enumerator(Constructor, input) {\n    this._instanceConstructor = Constructor;\n    this.promise = new Constructor(noop);\n\n    if (!this.promise[PROMISE_ID]) {\n      makePromise(this.promise);\n    }\n\n    if (isArray(input)) {\n      this.length = input.length;\n      this._remaining = input.length;\n\n      this._result = new Array(this.length);\n\n      if (this.length === 0) {\n        fulfill(this.promise, this._result);\n      } else {\n        this.length = this.length || 0;\n        this._enumerate(input);\n        if (this._remaining === 0) {\n          fulfill(this.promise, this._result);\n        }\n      }\n    } else {\n      reject(this.promise, validationError());\n    }\n  }\n\n  Enumerator.prototype._enumerate = function _enumerate(input) {\n    for (var i = 0; this._state === PENDING && i < input.length; i++) {\n      this._eachEntry(input[i], i);\n    }\n  };\n\n  Enumerator.prototype._eachEntry = function _eachEntry(entry, i) {\n    var c = this._instanceConstructor;\n    var resolve$$1 = c.resolve;\n\n\n    if (resolve$$1 === resolve$1) {\n      var _then = getThen(entry);\n\n      if (_then === then && entry._state !== PENDING) {\n        this._settledAt(entry._state, i, entry._result);\n      } else if (typeof _then !== 'function') {\n        this._remaining--;\n        this._result[i] = entry;\n      } else if (c === Promise$1) {\n        var promise = new c(noop);\n        handleMaybeThenable(promise, entry, _then);\n        this._willSettleAt(promise, i);\n      } else {\n        this._willSettleAt(new c(function (resolve$$1) {\n          return resolve$$1(entry);\n        }), i);\n      }\n    } else {\n      this._willSettleAt(resolve$$1(entry), i);\n    }\n  };\n\n  Enumerator.prototype._settledAt = function _settledAt(state, i, value) {\n    var promise = this.promise;\n\n\n    if (promise._state === PENDING) {\n      this._remaining--;\n\n      if (state === REJECTED) {\n        reject(promise, value);\n      } else {\n        this._result[i] = value;\n      }\n    }\n\n    if (this._remaining === 0) {\n      fulfill(promise, this._result);\n    }\n  };\n\n  Enumerator.prototype._willSettleAt = function _willSettleAt(promise, i) {\n    var enumerator = this;\n\n    subscribe(promise, undefined, function (value) {\n      return enumerator._settledAt(FULFILLED, i, value);\n    }, function (reason) {\n      return enumerator._settledAt(REJECTED, i, reason);\n    });\n  };\n\n  return Enumerator;\n}();\n\n/**\n  `Promise.all` accepts an array of promises, and returns a new promise which\n  is fulfilled with an array of fulfillment values for the passed promises, or\n  rejected with the reason of the first passed promise to be rejected. It casts all\n  elements of the passed iterable to promises as it runs this algorithm.\n\n  Example:\n\n  ```javascript\n  let promise1 = resolve(1);\n  let promise2 = resolve(2);\n  let promise3 = resolve(3);\n  let promises = [ promise1, promise2, promise3 ];\n\n  Promise.all(promises).then(function(array){\n    // The array here would be [ 1, 2, 3 ];\n  });\n  ```\n\n  If any of the `promises` given to `all` are rejected, the first promise\n  that is rejected will be given as an argument to the returned promises's\n  rejection handler. For example:\n\n  Example:\n\n  ```javascript\n  let promise1 = resolve(1);\n  let promise2 = reject(new Error(\"2\"));\n  let promise3 = reject(new Error(\"3\"));\n  let promises = [ promise1, promise2, promise3 ];\n\n  Promise.all(promises).then(function(array){\n    // Code here never runs because there are rejected promises!\n  }, function(error) {\n    // error.message === \"2\"\n  });\n  ```\n\n  @method all\n  @static\n  @param {Array} entries array of promises\n  @param {String} label optional string for labeling the promise.\n  Useful for tooling.\n  @return {Promise} promise that is fulfilled when all `promises` have been\n  fulfilled, or rejected if any of them become rejected.\n  @static\n*/\nfunction all(entries) {\n  return new Enumerator(this, entries).promise;\n}\n\n/**\n  `Promise.race` returns a new promise which is settled in the same way as the\n  first passed promise to settle.\n\n  Example:\n\n  ```javascript\n  let promise1 = new Promise(function(resolve, reject){\n    setTimeout(function(){\n      resolve('promise 1');\n    }, 200);\n  });\n\n  let promise2 = new Promise(function(resolve, reject){\n    setTimeout(function(){\n      resolve('promise 2');\n    }, 100);\n  });\n\n  Promise.race([promise1, promise2]).then(function(result){\n    // result === 'promise 2' because it was resolved before promise1\n    // was resolved.\n  });\n  ```\n\n  `Promise.race` is deterministic in that only the state of the first\n  settled promise matters. For example, even if other promises given to the\n  `promises` array argument are resolved, but the first settled promise has\n  become rejected before the other promises became fulfilled, the returned\n  promise will become rejected:\n\n  ```javascript\n  let promise1 = new Promise(function(resolve, reject){\n    setTimeout(function(){\n      resolve('promise 1');\n    }, 200);\n  });\n\n  let promise2 = new Promise(function(resolve, reject){\n    setTimeout(function(){\n      reject(new Error('promise 2'));\n    }, 100);\n  });\n\n  Promise.race([promise1, promise2]).then(function(result){\n    // Code here never runs\n  }, function(reason){\n    // reason.message === 'promise 2' because promise 2 became rejected before\n    // promise 1 became fulfilled\n  });\n  ```\n\n  An example real-world use case is implementing timeouts:\n\n  ```javascript\n  Promise.race([ajax('foo.json'), timeout(5000)])\n  ```\n\n  @method race\n  @static\n  @param {Array} promises array of promises to observe\n  Useful for tooling.\n  @return {Promise} a promise which settles in the same way as the first passed\n  promise to settle.\n*/\nfunction race(entries) {\n  /*jshint validthis:true */\n  var Constructor = this;\n\n  if (!isArray(entries)) {\n    return new Constructor(function (_, reject) {\n      return reject(new TypeError('You must pass an array to race.'));\n    });\n  } else {\n    return new Constructor(function (resolve, reject) {\n      var length = entries.length;\n      for (var i = 0; i < length; i++) {\n        Constructor.resolve(entries[i]).then(resolve, reject);\n      }\n    });\n  }\n}\n\n/**\n  `Promise.reject` returns a promise rejected with the passed `reason`.\n  It is shorthand for the following:\n\n  ```javascript\n  let promise = new Promise(function(resolve, reject){\n    reject(new Error('WHOOPS'));\n  });\n\n  promise.then(function(value){\n    // Code here doesn't run because the promise is rejected!\n  }, function(reason){\n    // reason.message === 'WHOOPS'\n  });\n  ```\n\n  Instead of writing the above, your code now simply becomes the following:\n\n  ```javascript\n  let promise = Promise.reject(new Error('WHOOPS'));\n\n  promise.then(function(value){\n    // Code here doesn't run because the promise is rejected!\n  }, function(reason){\n    // reason.message === 'WHOOPS'\n  });\n  ```\n\n  @method reject\n  @static\n  @param {Any} reason value that the returned promise will be rejected with.\n  Useful for tooling.\n  @return {Promise} a promise rejected with the given `reason`.\n*/\nfunction reject$1(reason) {\n  /*jshint validthis:true */\n  var Constructor = this;\n  var promise = new Constructor(noop);\n  reject(promise, reason);\n  return promise;\n}\n\nfunction needsResolver() {\n  throw new TypeError('You must pass a resolver function as the first argument to the promise constructor');\n}\n\nfunction needsNew() {\n  throw new TypeError(\"Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.\");\n}\n\n/**\n  Promise objects represent the eventual result of an asynchronous operation. The\n  primary way of interacting with a promise is through its `then` method, which\n  registers callbacks to receive either a promise's eventual value or the reason\n  why the promise cannot be fulfilled.\n\n  Terminology\n  -----------\n\n  - `promise` is an object or function with a `then` method whose behavior conforms to this specification.\n  - `thenable` is an object or function that defines a `then` method.\n  - `value` is any legal JavaScript value (including undefined, a thenable, or a promise).\n  - `exception` is a value that is thrown using the throw statement.\n  - `reason` is a value that indicates why a promise was rejected.\n  - `settled` the final resting state of a promise, fulfilled or rejected.\n\n  A promise can be in one of three states: pending, fulfilled, or rejected.\n\n  Promises that are fulfilled have a fulfillment value and are in the fulfilled\n  state.  Promises that are rejected have a rejection reason and are in the\n  rejected state.  A fulfillment value is never a thenable.\n\n  Promises can also be said to *resolve* a value.  If this value is also a\n  promise, then the original promise's settled state will match the value's\n  settled state.  So a promise that *resolves* a promise that rejects will\n  itself reject, and a promise that *resolves* a promise that fulfills will\n  itself fulfill.\n\n\n  Basic Usage:\n  ------------\n\n  ```js\n  let promise = new Promise(function(resolve, reject) {\n    // on success\n    resolve(value);\n\n    // on failure\n    reject(reason);\n  });\n\n  promise.then(function(value) {\n    // on fulfillment\n  }, function(reason) {\n    // on rejection\n  });\n  ```\n\n  Advanced Usage:\n  ---------------\n\n  Promises shine when abstracting away asynchronous interactions such as\n  `XMLHttpRequest`s.\n\n  ```js\n  function getJSON(url) {\n    return new Promise(function(resolve, reject){\n      let xhr = new XMLHttpRequest();\n\n      xhr.open('GET', url);\n      xhr.onreadystatechange = handler;\n      xhr.responseType = 'json';\n      xhr.setRequestHeader('Accept', 'application/json');\n      xhr.send();\n\n      function handler() {\n        if (this.readyState === this.DONE) {\n          if (this.status === 200) {\n            resolve(this.response);\n          } else {\n            reject(new Error('getJSON: `' + url + '` failed with status: [' + this.status + ']'));\n          }\n        }\n      };\n    });\n  }\n\n  getJSON('/posts.json').then(function(json) {\n    // on fulfillment\n  }, function(reason) {\n    // on rejection\n  });\n  ```\n\n  Unlike callbacks, promises are great composable primitives.\n\n  ```js\n  Promise.all([\n    getJSON('/posts'),\n    getJSON('/comments')\n  ]).then(function(values){\n    values[0] // => postsJSON\n    values[1] // => commentsJSON\n\n    return values;\n  });\n  ```\n\n  @class Promise\n  @param {Function} resolver\n  Useful for tooling.\n  @constructor\n*/\n\nvar Promise$1 = function () {\n  function Promise(resolver) {\n    this[PROMISE_ID] = nextId();\n    this._result = this._state = undefined;\n    this._subscribers = [];\n\n    if (noop !== resolver) {\n      typeof resolver !== 'function' && needsResolver();\n      this instanceof Promise ? initializePromise(this, resolver) : needsNew();\n    }\n  }\n\n  /**\n  The primary way of interacting with a promise is through its `then` method,\n  which registers callbacks to receive either a promise's eventual value or the\n  reason why the promise cannot be fulfilled.\n   ```js\n  findUser().then(function(user){\n    // user is available\n  }, function(reason){\n    // user is unavailable, and you are given the reason why\n  });\n  ```\n   Chaining\n  --------\n   The return value of `then` is itself a promise.  This second, 'downstream'\n  promise is resolved with the return value of the first promise's fulfillment\n  or rejection handler, or rejected if the handler throws an exception.\n   ```js\n  findUser().then(function (user) {\n    return user.name;\n  }, function (reason) {\n    return 'default name';\n  }).then(function (userName) {\n    // If `findUser` fulfilled, `userName` will be the user's name, otherwise it\n    // will be `'default name'`\n  });\n   findUser().then(function (user) {\n    throw new Error('Found user, but still unhappy');\n  }, function (reason) {\n    throw new Error('`findUser` rejected and we're unhappy');\n  }).then(function (value) {\n    // never reached\n  }, function (reason) {\n    // if `findUser` fulfilled, `reason` will be 'Found user, but still unhappy'.\n    // If `findUser` rejected, `reason` will be '`findUser` rejected and we're unhappy'.\n  });\n  ```\n  If the downstream promise does not specify a rejection handler, rejection reasons will be propagated further downstream.\n   ```js\n  findUser().then(function (user) {\n    throw new PedagogicalException('Upstream error');\n  }).then(function (value) {\n    // never reached\n  }).then(function (value) {\n    // never reached\n  }, function (reason) {\n    // The `PedgagocialException` is propagated all the way down to here\n  });\n  ```\n   Assimilation\n  ------------\n   Sometimes the value you want to propagate to a downstream promise can only be\n  retrieved asynchronously. This can be achieved by returning a promise in the\n  fulfillment or rejection handler. The downstream promise will then be pending\n  until the returned promise is settled. This is called *assimilation*.\n   ```js\n  findUser().then(function (user) {\n    return findCommentsByAuthor(user);\n  }).then(function (comments) {\n    // The user's comments are now available\n  });\n  ```\n   If the assimliated promise rejects, then the downstream promise will also reject.\n   ```js\n  findUser().then(function (user) {\n    return findCommentsByAuthor(user);\n  }).then(function (comments) {\n    // If `findCommentsByAuthor` fulfills, we'll have the value here\n  }, function (reason) {\n    // If `findCommentsByAuthor` rejects, we'll have the reason here\n  });\n  ```\n   Simple Example\n  --------------\n   Synchronous Example\n   ```javascript\n  let result;\n   try {\n    result = findResult();\n    // success\n  } catch(reason) {\n    // failure\n  }\n  ```\n   Errback Example\n   ```js\n  findResult(function(result, err){\n    if (err) {\n      // failure\n    } else {\n      // success\n    }\n  });\n  ```\n   Promise Example;\n   ```javascript\n  findResult().then(function(result){\n    // success\n  }, function(reason){\n    // failure\n  });\n  ```\n   Advanced Example\n  --------------\n   Synchronous Example\n   ```javascript\n  let author, books;\n   try {\n    author = findAuthor();\n    books  = findBooksByAuthor(author);\n    // success\n  } catch(reason) {\n    // failure\n  }\n  ```\n   Errback Example\n   ```js\n   function foundBooks(books) {\n   }\n   function failure(reason) {\n   }\n   findAuthor(function(author, err){\n    if (err) {\n      failure(err);\n      // failure\n    } else {\n      try {\n        findBoooksByAuthor(author, function(books, err) {\n          if (err) {\n            failure(err);\n          } else {\n            try {\n              foundBooks(books);\n            } catch(reason) {\n              failure(reason);\n            }\n          }\n        });\n      } catch(error) {\n        failure(err);\n      }\n      // success\n    }\n  });\n  ```\n   Promise Example;\n   ```javascript\n  findAuthor().\n    then(findBooksByAuthor).\n    then(function(books){\n      // found books\n  }).catch(function(reason){\n    // something went wrong\n  });\n  ```\n   @method then\n  @param {Function} onFulfilled\n  @param {Function} onRejected\n  Useful for tooling.\n  @return {Promise}\n  */\n\n  /**\n  `catch` is simply sugar for `then(undefined, onRejection)` which makes it the same\n  as the catch block of a try/catch statement.\n  ```js\n  function findAuthor(){\n  throw new Error('couldn't find that author');\n  }\n  // synchronous\n  try {\n  findAuthor();\n  } catch(reason) {\n  // something went wrong\n  }\n  // async with promises\n  findAuthor().catch(function(reason){\n  // something went wrong\n  });\n  ```\n  @method catch\n  @param {Function} onRejection\n  Useful for tooling.\n  @return {Promise}\n  */\n\n\n  Promise.prototype.catch = function _catch(onRejection) {\n    return this.then(null, onRejection);\n  };\n\n  /**\n    `finally` will be invoked regardless of the promise's fate just as native\n    try/catch/finally behaves\n  \n    Synchronous example:\n  \n    ```js\n    findAuthor() {\n      if (Math.random() > 0.5) {\n        throw new Error();\n      }\n      return new Author();\n    }\n  \n    try {\n      return findAuthor(); // succeed or fail\n    } catch(error) {\n      return findOtherAuther();\n    } finally {\n      // always runs\n      // doesn't affect the return value\n    }\n    ```\n  \n    Asynchronous example:\n  \n    ```js\n    findAuthor().catch(function(reason){\n      return findOtherAuther();\n    }).finally(function(){\n      // author was either found, or not\n    });\n    ```\n  \n    @method finally\n    @param {Function} callback\n    @return {Promise}\n  */\n\n\n  Promise.prototype.finally = function _finally(callback) {\n    var promise = this;\n    var constructor = promise.constructor;\n\n    return promise.then(function (value) {\n      return constructor.resolve(callback()).then(function () {\n        return value;\n      });\n    }, function (reason) {\n      return constructor.resolve(callback()).then(function () {\n        throw reason;\n      });\n    });\n  };\n\n  return Promise;\n}();\n\nPromise$1.prototype.then = then;\nPromise$1.all = all;\nPromise$1.race = race;\nPromise$1.resolve = resolve$1;\nPromise$1.reject = reject$1;\nPromise$1._setScheduler = setScheduler;\nPromise$1._setAsap = setAsap;\nPromise$1._asap = asap;\n\n/*global self*/\nfunction polyfill() {\n  var local = void 0;\n\n  if (typeof global !== 'undefined') {\n    local = global;\n  } else if (typeof self !== 'undefined') {\n    local = self;\n  } else {\n    try {\n      local = Function('return this')();\n    } catch (e) {\n      throw new Error('polyfill failed because global object is unavailable in this environment');\n    }\n  }\n\n  var P = local.Promise;\n\n  if (P) {\n    var promiseToString = null;\n    try {\n      promiseToString = Object.prototype.toString.call(P.resolve());\n    } catch (e) {\n      // silently ignored\n    }\n\n    if (promiseToString === '[object Promise]' && !P.cast) {\n      return;\n    }\n  }\n\n  local.Promise = Promise$1;\n}\n\n// Strange compat..\nPromise$1.polyfill = polyfill;\nPromise$1.Promise = Promise$1;\n\nreturn Promise$1;\n\n})));\n\n\n\n//# sourceMappingURL=es6-promise.map\n\n/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(50), __webpack_require__(51)))\n\n/***/ }),\n/* 50 */\n/***/ (function(module, exports) {\n\n// shim for using process in browser\nvar process = module.exports = {};\n\n// cached from whatever global is present so that test runners that stub it\n// don't break things.  But we need to wrap it in a try catch in case it is\n// wrapped in strict mode code which doesn't define any globals.  It's inside a\n// function because try/catches deoptimize in certain engines.\n\nvar cachedSetTimeout;\nvar cachedClearTimeout;\n\nfunction defaultSetTimout() {\n    throw new Error('setTimeout has not been defined');\n}\nfunction defaultClearTimeout () {\n    throw new Error('clearTimeout has not been defined');\n}\n(function () {\n    try {\n        if (typeof setTimeout === 'function') {\n            cachedSetTimeout = setTimeout;\n        } else {\n            cachedSetTimeout = defaultSetTimout;\n        }\n    } catch (e) {\n        cachedSetTimeout = defaultSetTimout;\n    }\n    try {\n        if (typeof clearTimeout === 'function') {\n            cachedClearTimeout = clearTimeout;\n        } else {\n            cachedClearTimeout = defaultClearTimeout;\n        }\n    } catch (e) {\n        cachedClearTimeout = defaultClearTimeout;\n    }\n} ())\nfunction runTimeout(fun) {\n    if (cachedSetTimeout === setTimeout) {\n        //normal enviroments in sane situations\n        return setTimeout(fun, 0);\n    }\n    // if setTimeout wasn't available but was latter defined\n    if ((cachedSetTimeout === defaultSetTimout || !cachedSetTimeout) && setTimeout) {\n        cachedSetTimeout = setTimeout;\n        return setTimeout(fun, 0);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedSetTimeout(fun, 0);\n    } catch(e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't trust the global object when called normally\n            return cachedSetTimeout.call(null, fun, 0);\n        } catch(e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error\n            return cachedSetTimeout.call(this, fun, 0);\n        }\n    }\n\n\n}\nfunction runClearTimeout(marker) {\n    if (cachedClearTimeout === clearTimeout) {\n        //normal enviroments in sane situations\n        return clearTimeout(marker);\n    }\n    // if clearTimeout wasn't available but was latter defined\n    if ((cachedClearTimeout === defaultClearTimeout || !cachedClearTimeout) && clearTimeout) {\n        cachedClearTimeout = clearTimeout;\n        return clearTimeout(marker);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedClearTimeout(marker);\n    } catch (e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't  trust the global object when called normally\n            return cachedClearTimeout.call(null, marker);\n        } catch (e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error.\n            // Some versions of I.E. have different rules for clearTimeout vs setTimeout\n            return cachedClearTimeout.call(this, marker);\n        }\n    }\n\n\n\n}\nvar queue = [];\nvar draining = false;\nvar currentQueue;\nvar queueIndex = -1;\n\nfunction cleanUpNextTick() {\n    if (!draining || !currentQueue) {\n        return;\n    }\n    draining = false;\n    if (currentQueue.length) {\n        queue = currentQueue.concat(queue);\n    } else {\n        queueIndex = -1;\n    }\n    if (queue.length) {\n        drainQueue();\n    }\n}\n\nfunction drainQueue() {\n    if (draining) {\n        return;\n    }\n    var timeout = runTimeout(cleanUpNextTick);\n    draining = true;\n\n    var len = queue.length;\n    while(len) {\n        currentQueue = queue;\n        queue = [];\n        while (++queueIndex < len) {\n            if (currentQueue) {\n                currentQueue[queueIndex].run();\n            }\n        }\n        queueIndex = -1;\n        len = queue.length;\n    }\n    currentQueue = null;\n    draining = false;\n    runClearTimeout(timeout);\n}\n\nprocess.nextTick = function (fun) {\n    var args = new Array(arguments.length - 1);\n    if (arguments.length > 1) {\n        for (var i = 1; i < arguments.length; i++) {\n            args[i - 1] = arguments[i];\n        }\n    }\n    queue.push(new Item(fun, args));\n    if (queue.length === 1 && !draining) {\n        runTimeout(drainQueue);\n    }\n};\n\n// v8 likes predictible objects\nfunction Item(fun, array) {\n    this.fun = fun;\n    this.array = array;\n}\nItem.prototype.run = function () {\n    this.fun.apply(null, this.array);\n};\nprocess.title = 'browser';\nprocess.browser = true;\nprocess.env = {};\nprocess.argv = [];\nprocess.version = ''; // empty string to avoid regexp issues\nprocess.versions = {};\n\nfunction noop() {}\n\nprocess.on = noop;\nprocess.addListener = noop;\nprocess.once = noop;\nprocess.off = noop;\nprocess.removeListener = noop;\nprocess.removeAllListeners = noop;\nprocess.emit = noop;\nprocess.prependListener = noop;\nprocess.prependOnceListener = noop;\n\nprocess.listeners = function (name) { return [] }\n\nprocess.binding = function (name) {\n    throw new Error('process.binding is not supported');\n};\n\nprocess.cwd = function () { return '/' };\nprocess.chdir = function (dir) {\n    throw new Error('process.chdir is not supported');\n};\nprocess.umask = function() { return 0; };\n\n\n/***/ }),\n/* 51 */\n/***/ (function(module, exports) {\n\nvar g;\r\n\r\n// This works in non-strict mode\r\ng = (function() {\r\n\treturn this;\r\n})();\r\n\r\ntry {\r\n\t// This works if eval is allowed (see CSP)\r\n\tg = g || Function(\"return this\")() || (1,eval)(\"this\");\r\n} catch(e) {\r\n\t// This works if the window reference is available\r\n\tif(typeof window === \"object\")\r\n\t\tg = window;\r\n}\r\n\r\n// g can still be undefined, but nothing to do about it...\r\n// We return undefined, instead of nothing here, so it's\r\n// easier to handle this case. if(!global) { ...}\r\n\r\nmodule.exports = g;\r\n\n\n/***/ }),\n/* 52 */\n/***/ (function(module, exports) {\n\nmodule.exports = __WEBPACK_EXTERNAL_MODULE_52__;\n\n/***/ }),\n/* 53 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__ = __webpack_require__(0);\n/**\n * JSONP : Implmentation du protocole JSONP de la plateforme Goportail (cf. {@link https://github.com/sobstel/jsonp.js}).\n *\n * @module JSONP\n * @private\n * @alias Gp.Protocols.JSONP\n */\n\n\nvar JSONP = {\n\n    /**\n     * Construction d'un identifiant statique bas sur le timestamp,\n     * et qui s'incremente de +1  chaque appel\n     */\n    uuid : (function () {\n        var id = Math.floor(Date.now());\n        return function () {\n            return id++;\n        };\n    })(),\n\n    /**\n     * Cette fonction ralise l'appel du service fourni via le paramtre \"options.url\"\n     * en mettant en uvre le protocole JSONP.\n     *\n     * @method call\n     * @static\n     * @param {Object} options - parametres d'invocation du service en JSONP\n     * @param {String} options.url - URL du service  invoquer (indpendamment du protocole JSONP).\n     *  Cette URL contient dj les paramtres du service.\n     *  Si le paramtre ddi  la mise en oeuvre du protocole JSONP (callback=xxx) n'est pas prsent, il est rajout par la fonction ;\n     *  sa valeur est dtermine en fonction du paramtre callbackName.\n     * @param {Number} [options.timeOut = 0] - Nombre de ms au bout duquel on considre que le service n'a pas rpondu.\n     *  Une valeur de 0 pour ce paramtre permet de dsactiver la gestion du timeOut.\n     * @param {String} [options.callbackSuffix = null] - Suffixe de la fonction de callback  rajouter sur l'URL.\n     *  Si aucun suffixe n'est spcifi (cas par dfaut), on utilisera l'identifiant this.uuid () comme suffixe. Ex: \"callback1458574396582 ()\"\n     * @param {String} [options.callbackName = gp.protocol.jsonp] - Valeur du paramtre callback  rajouter sur l'URL.\n     *  Si l'URL fournie contient dj le paramtre callback, le paramtre callbackName ne sera pas pris en compte.\n     *  La fonction de callback est cre dynamiquement par la fonction JSONP ;\n     *  elle a deux fonctions :\n     *    elle annule la condition de timeOut\n     *    puis appelle la fonction fournie par l'utilisateur via le paramtre onResponse.\n     * @param {Function} options.onResponse - Nom de la fonction qui sera appele lors de la rception des rsultats du service.\n     *  Ce paramtre sera ignor si l'URL contient dj le paramtre callback.\n     *  La fonction de rappel appele sera alors celle ayant pour nom la valeur de ce paramtre.\n     * @param {Function} [options.onTimeOut] - Nom de la fonction qui sera appele en cas de non rponse du service.\n     *  Le temps au bout duquel on considre que le service n'a pas rpondu est dtermin par le paramtre timeOut.\n     *  @example\n     *  var options = {\n     *      url : 'http://localhost/some/test.json&callback=myResults',\n     *      timeOut : 100,\n     *      callbackName : 'myResults',\n     *      callbackSuffix : \"\",\n     *      onResponse : function (response) {\n     *          console.log('results : ', response);\n     *      },\n     *\n     *   };\n     *   JSONP.call(options);\n     */\n    call : function (options) {\n\n        // logger\n        var logger = __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__[\"a\" /* default */].getLogger(\"JSONP\");\n        logger.trace(\"[JSONP::call ()]\");\n\n        // analyse parametres\n\n        if (!options) {\n            logger.error(\"missing parameter : options !\");\n            throw new Error(\"missing parameter : options !\");\n        }\n\n        if (!options.url) {\n            logger.error(\"missing parameter : options.url !\");\n            throw new Error(\"missing parameter : options.url !\");\n        }\n\n        if (!options.timeOut) {\n            logger.info(\"setting 'options.timeOut' default value\");\n            options.timeOut = 0;\n        }\n\n        // FIXME si un callback cot client a t mis en place,\n        // cette condition sur cette methode n'a pas de sens !?\n        if (!options.onResponse) {\n            logger.error(\"missing parameter : options.onResponse !\");\n            throw new Error(\"missing parameter : options.onResponse !\");\n            // FIXME doit on definir un callback interne par defaut !?\n            // options.onResponse = function (data) {\n            //    console.log(\"response callback (inner) : \", data);\n            // };\n        }\n\n        // ID du callback  utiliser : null ou string.\n        // si l'utilisateur a spcifi un suffixe pour le callback, on le rcupre comme un ID (ex: options.callbackSuffix = \"\")\n        // sinon, on utilise un timestamp : this.uuid ()\n        var callbackId = ( typeof options.callbackSuffix === \"string\") ? options.callbackSuffix : this.uuid();\n\n        // on recherche le parametre callback et son nom de fonction dans l'url\n        var urlHasCallbackKey = false;\n        var urlHasCallbackName = false;\n\n        var idx = options.url.indexOf(\"callback=\");\n\n        if (idx != -1) {\n            urlHasCallbackKey = true;\n            // extraction callbackName de l'url : entre \"callback=\" et \"&\" ou fin de ligne\n            var j = options.url.indexOf(\"&\", idx);\n            if (j === -1) {\n                j = options.url.length;\n            }\n\n            // on ecrase le parametre options.callbackName s'il avait t dfini\n            var callbackName = options.url.substring(idx + 9, j);\n\n            if (callbackName) {\n                urlHasCallbackName = true;\n                options.callbackName = callbackName;\n                logger.info(\"setting 'options.callbackName' value (\" + options.callbackName + \") from 'options.url' parameter\");\n            }\n        }\n\n        // on ajoute le parametre callback dans l'URL s'il n'existe pas\n        if (!urlHasCallbackKey) {\n            // gestion des autres param. et \"?\"\n            var k = options.url.indexOf(\"?\");\n            if (k === -1) {\n                // aucun param., ni de '?'\n                options.url = options.url + \"?\" + \"callback=\";\n            } else if (k === options.url.length) {\n                // uniquement le '?'\n                options.url = options.url + \"callback=\";\n            } else {\n                // le '?' et les param. existent\n                options.url = options.url + \"&\" + \"callback=\";\n            }\n            logger.info(\"setting callback default key in 'options.url' : \" + options.url);\n        }\n\n        // utilisation de la fonction callback cot client ?\n        var HasCallbackName = options.callbackName ? true : urlHasCallbackName;\n\n        // on ajoute le nom de la fonction callback dans l'URL si elle n'existe pas\n        if (!urlHasCallbackName) {\n            // fonction callback par defaut\n            if (!options.callbackName) {\n                logger.info(\"setting 'options.callbackName' default value\");\n                options.callbackName = \"callback\"; // ou \"gp.protocol.jsonp\" ?\n                // info : si on ne veut pas gerer d'ID dans le callback,\n                // options.callbackSuffix = \"\"\n                if (callbackId || callbackId === \"\") {\n                    options.callbackName += callbackId;\n                }\n            }\n            options.url = options.url.replace(\"callback=\", \"callback=\" + options.callbackName);\n            logger.info(\"setting callback function name in 'options.url' : \" + options.url);\n        }\n\n        // timeOut par defaut\n        if (!options.onTimeOut) {\n            logger.info(\"setting 'options.onTimeOut' default value\");\n            /** callback timeout par defaut */\n            options.onTimeOut = function ( /* error */ ) {\n                console.log(\"TimeOut while invoking url : \" + options.url);\n            };\n        }\n\n        if (!HasCallbackName) {\n\n            var self = this;\n\n            // event du timeout\n            var onTimeOutTrigger = null;\n\n            // declenche le timeout si >  0 !\n            if (options.timeOut > 0) {\n                onTimeOutTrigger = window.setTimeout(\n                    function () {\n                        /** fonction de reponse du service */\n                        window[options.callbackName] = function () {};\n                        options.onTimeOut();\n                        self._deleteScript(callbackId);\n                    }, options.timeOut);\n            }\n\n            // FIXME le nom de la fonction n'accepte pas de namespace !\n            // ex. Gp.Function.callback\n            /** fonction de reponse du service */\n            window[options.callbackName] = function (data) {\n                window.clearTimeout(onTimeOutTrigger);\n                options.onResponse(data);\n                self._deleteScript(callbackId);\n            };\n        }\n\n        this._createScript(callbackId, options.url);\n    },\n\n    /** create Script */\n    _createScript : function (callbackId, url) {\n\n        var scriptu;\n        var scripto = document.getElementById(\"results\" + callbackId);\n\n        scriptu = document.createElement(\"script\");\n        scriptu.setAttribute(\"type\", \"text/javascript\");\n        scriptu.setAttribute(\"src\", url);\n        scriptu.setAttribute(\"charset\", \"UTF-8\");\n        scriptu.setAttribute(\"id\", \"results\" + callbackId);\n        scriptu.setAttribute(\"async\", \"true\"); // FIXME async ?\n        // head ou body ou autres ?\n        var node = document.documentElement || document.getElementsByTagName(\"head\")[0];\n        if (scripto === null) {\n            node.appendChild(scriptu);\n        } else {\n            // s'il existe dj, on le remplace !\n            node.replaceChild(scriptu, scripto);\n        }\n\n    },\n\n    /** delete Script */\n    _deleteScript : function (callbackId) {\n\n        var script = document.getElementById(\"results\" + callbackId);\n        if (script) {\n            var node = script.parentNode || document.documentElement;\n            if (!node) {\n                return;\n            }\n            node.removeChild(script);\n        }\n    }\n};\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (JSONP);\n\n\n/***/ }),\n/* 54 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__Exceptions_ErrorService__ = __webpack_require__(2);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__AltiRequestREST__ = __webpack_require__(55);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__AltiRequestWPS__ = __webpack_require__(56);\n/**\n * Creation d'une requte en REST ou WPS\n * (Factory)\n *\n * @module AltiRequestFactory\n * @alias Gp.Services.Alti.Request.AltiRequestFactory\n * @private\n */\n\n\n\n\n\nvar AltiRequestFactory = {\n\n    /**\n     * interface unique\n     *\n     * @method build\n     * @static\n     * @param {Object} options - options definies dans le composant Alti\n     *\n     * @example\n     *   var options = {\n     *      httpMethod : 'GET', // GET|POST\n     *      onSuccess : function (response) {},\n     *      onError : function (error) {},\n     *      scope : this,\n     *      positions : [{lon:, lat:}, {lon:, lat:}],\n     *      outputFormat : 'json' // json|xml\n     *      sampling : 3,\n     *      api : 'REST', // REST|WPS\n     *      zonly : false // false|true\n     *   };\n     *\n     */\n    build : function (options) {\n\n        // logger\n        var logger = __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__[\"a\" /* default */].getLogger(\"AltiRequestFactory\");\n        logger.trace([\"AltiRequestFactory::build()\"]);\n\n        var request = null;\n\n        // on factorise les options par groupe;\n        // - global,\n        // - param, les params pour les data inputs\n        // - wps, les param du service\n        // - callback\n\n        var settings = {\n            // ajout des valeurs par defaut spcifiques au service\n            type : options.sampling ? \"Profil\" : \"Elevation\",\n            method : options.httpMethod,\n            param : {\n                positions : null,\n                delimiter : null, // FIXME par defaut, on ne le met pas en place car a fait planter la requte !?\n                indent : null, // par defaut\n                crs : null, // par defaut\n                format : null, // (only to POST)\n                sampling : null, // (only use by Profil)\n                zonly : null // (only use by Elevation)\n            }\n        };\n\n        // surcharge des valeurs obligatoires\n        settings.param.positions = options.positions;\n        settings.param.format = options.outputFormat;\n        settings.param.sampling = options.sampling;\n        settings.param.zonly = options.zonly;\n\n        // gestion des callback\n        var bOnError = (options.onError !== null && typeof options.onError === \"function\") ? true : false;\n        var bOnSuccess = (options.onSuccess !== null && typeof options.onSuccess === \"function\") ? true : false;\n\n        var message = null;\n        switch (options.api) {\n            case \"REST\":\n                // FIXME les exceptions ne sont pas 'catches' sur le constructeur !\n                var myReq = new __WEBPACK_IMPORTED_MODULE_2__AltiRequestREST__[\"a\" /* default */](settings);\n                if (!myReq.processRequestString()) {\n                    message = \"Error in process request (rest) !\";\n                    if (bOnError) {\n                        options.onError.call(options.scope, new __WEBPACK_IMPORTED_MODULE_1__Exceptions_ErrorService__[\"a\" /* default */](message));\n                        return;\n                    }\n                    throw new Error(message);\n                }\n                request = myReq.requestString;\n                break;\n            case \"WPS\":\n                // ajout des valeurs par defaut spcifiques au service WPS\n                settings.wps = {\n                    service : null, // par defaut\n                    version : null, // par defaut\n                    identifier : null, // par defaut\n                    rawdataoutput : null, // par defaut\n                    request : null // par defaut\n                };\n\n                request = __WEBPACK_IMPORTED_MODULE_3__AltiRequestWPS__[\"a\" /* default */].build(settings);\n                if (!request) {\n                    message = \"Error in process request (wps) !\";\n                    if (bOnError) {\n                        options.onError.call(options.scope, new __WEBPACK_IMPORTED_MODULE_1__Exceptions_ErrorService__[\"a\" /* default */](message));\n                        return;\n                    }\n                    throw new Error(message);\n                }\n                break;\n            default:\n                message = \"Type of API is not supported by service (REST or WPS) !\";\n                if (bOnError) {\n                    options.onError.call(options.scope, new __WEBPACK_IMPORTED_MODULE_1__Exceptions_ErrorService__[\"a\" /* default */](message));\n                    return;\n                }\n                throw new Error(message);\n        }\n\n        if (bOnSuccess) {\n            options.onSuccess.call(options.scope, request);\n        }\n\n        return request;\n    }\n};\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (AltiRequestFactory);\n\n\n/***/ }),\n/* 55 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__ = __webpack_require__(1);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__model_AltiElevationRequest__ = __webpack_require__(21);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__model_AltiProfilRequest__ = __webpack_require__(23);\n/* jshint multistr : true */\n\n\n\n\n\n\n/**\n * @classdesc\n * Classe de gestion des requtes de type REST sur le service altimetrique.\n *\n * @todo Le service Alti n'implemente pas le POST !?\n * @constructor\n * @alias Gp.Services.Alti.Request.AltiRequestREST\n * @param {Object} options - options\n * @param {Object}   options.param.positions - tableau de coordonnes lon/lat\n * @param {String}   options.param.delimiter - '|'\n * @param {Boolean}  options.param.indent - false|true\n * @param {String}   options.param.crs - 'CRS:84'\n * @param {String}   options.param.sampling - 3\n * @param {Boolean}  options.param.zonly - false|true\n * @param {String}   options.param.format - \"JSON|XML\"\n * @param {String}   options.type - \"Profil|Elevation\"\n * @param {String}   options.method - GET|POST\n *\n * @example\n *      var options = {\n *           type : 'Profil', // Elevation\n *           method : 'GET',  // par defaut\n *           param : {\n *               positions : [\n *                   {lon:'1.11', lat:'1.11'},\n *                   {lon:'1.10', lat:'1.10'},\n *                   {lon:'1.12', lat:'1.12'}\n *               ],\n *               delimiter : \";\",         // par defaut\n *               indent    : true,        // par defaut\n *               crs       : 'EPSG:4326', // par defaut\n *               format    : 'json',      // par defaut (only to POST)\n *               sampling  : 3 ,          // par defaut (only use by Profil)\n *               zonly     : false        // par defaut (only use by Elevation)\n *           }\n *      };\n *\n *      var result;\n *      try {\n *          var obj = new AltiRequestREST (options);\n *          if (! obj.processRequestString ()) {\n *              throw new Error(\"Request empty !?\")\n *          }\n *          result = obj.requestString;\n *      } catch (e) {\n *          // exceptions...\n *      }\n * @private\n */\nfunction AltiRequestREST (options) {\n\n    this.logger = __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__[\"a\" /* default */].getLogger(\"AltiRequestREST\");\n    this.logger.trace(\"[Constructeur AltiRequestREST ()]\");\n\n    if (!(this instanceof AltiRequestREST)) {\n        throw new TypeError(\"AltiRequestREST constructor cannot be called as a function.\");\n    }\n\n    this.options = options || {};\n\n    // existance des options\n    if (!this.options) {\n        throw new Error(__WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__[\"a\" /* default */].getMessage(\"PARAM_EMPTY\", \"options\"));\n    }\n\n    // type de requete : Altitude ou Profil\n    // (param.  determiner en fonction des parametres d'entre)\n    if (!this.options.type) {\n        throw new Error(__WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__[\"a\" /* default */].getMessage(\"PARAM_EMPTY\", \"type (Elevation or Profil)\"));\n    }\n\n    // construction du modele de requte\n    // (test du type d'objet candidat)\n    this.DataObject = null;\n    switch (this.options.type) {\n        case \"Elevation\":\n            this.DataObject = new __WEBPACK_IMPORTED_MODULE_2__model_AltiElevationRequest__[\"a\" /* default */](this.options.param);\n            break;\n        case \"Profil\":\n            this.DataObject = new __WEBPACK_IMPORTED_MODULE_3__model_AltiProfilRequest__[\"a\" /* default */](this.options.param);\n            break;\n        default:\n            throw new Error(__WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__[\"a\" /* default */].getMessage(\"PARAM_TYPE\", \"type (Elevation or Profil)\"));\n    }\n\n    /**\n     * methode.\n     * Par defaut, \"GET\".\n     */\n    this.method = this.options.method || \"GET\";\n\n}\n\nAltiRequestREST.prototype = {\n\n    /**\n     * request\n     * @type {String}\n     */\n    requestString : null,\n\n    /**\n     * Constructeur (alias)\n     */\n    constructor : AltiRequestREST,\n\n    /**\n     * Template de la requte.\n     */\n    template : {\n        get : {\n            // FIXME on retire le param 'delimiter' : &delimiter='__DELIMITER__'\n            value : \"lon=__LON__&lat=__LAT__&indent=__INDENT__&crs='__CRS__'\",\n            input : {\n                point : \"&zonly=__ZONLY__\",\n                profil : \"&sampling=__SAMPLING__\"\n            }\n        },\n        post : {\n            // FIXME on retire le param 'delimiter' : delimiter='__DELIMITER__'\\n\\\n            value : \"lon=__LON__\\n\" +\n                \"lat=__LAT__\\n\" +\n                \"indent=__INDENT__\\n\" +\n                \"crs='__CRS__'\\n\",\n            input : {\n                point : \"zonly=__ZONLY__\",\n                profil : \"sampling=__SAMPLING__\"\n            }\n        }\n    },\n\n    /**\n     * Construction de la requte.\n     *\n     * @example\n     * // GET  out : lon=0.2367,2.1570&lat=48.0551,46.6077&delimiter=,&indent=true&zonly=true&crs='CRS:84'\n     * // POST out : Not yet supported method POST !\n     * @returns {String}\n     */\n    processRequestString : function () {\n\n        this.logger.trace(\"AltiRequestREST::processRequestString ()\");\n\n        var template = \"\";\n        if (this.method == \"POST\") {\n            template = this.template.post.value;\n        } else if (this.method == \"GET\") {\n            template = this.template.get.value;\n        }\n\n        template = template.replace(/__LON__/g, this.DataObject.getLon());\n        template = template.replace(/__LAT__/g, this.DataObject.getLat());\n        // FIXME on retire le param 'delimiter'\n        // template = template.replace(/__DELIMITER__/g, this.DataObject.delimiter);\n        template = template.replace(/__INDENT__/g, this.DataObject.indent);\n        template = template.replace(/__CRS__/g, this.DataObject.crs);\n\n        // ajout +\n        template = template + this.__addDataInputs();\n        this.logger.trace(\"traduction tmpl\", template);\n\n        // sauvegarde\n        this.requestString = template;\n\n        return this.requestString;\n    },\n\n    /**\n     * Ajout de parametres spcifiques (ex. zonly)\n     *\n     * @returns {String}\n     */\n    __addDataInputs : function () {\n\n        this.logger.trace(\"AltiRequestREST::addDataInput ()\");\n\n        var myTemplate;\n        if (this.method == \"POST\") {\n            myTemplate = this.template.post;\n        } else if (this.method == \"GET\") {\n            myTemplate = this.template.get;\n        } else {\n            throw new Error(\"No other HTTP method supported by the service !\");\n        }\n\n        var tmpl = null;\n        if (this.DataObject.CLASSNAME == \"AltiElevationRequest\") {\n            tmpl = myTemplate.input.point;\n            return tmpl.replace(/__ZONLY__/g, this.DataObject.zonly);\n        } else if (this.DataObject.CLASSNAME == \"AltiProfilRequest\") {\n            tmpl = myTemplate.input.profil;\n            return tmpl.replace(/__SAMPLING__/g, this.DataObject.sampling);\n        } else {\n            throw new Error(\"No other object supported than elevation or profil !?\");\n        }\n    }\n};\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (AltiRequestREST);\n\n\n/***/ }),\n/* 56 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__ = __webpack_require__(1);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__Formats_WPS__ = __webpack_require__(57);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__model_AltiElevationRequest__ = __webpack_require__(21);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__model_AltiProfilRequest__ = __webpack_require__(23);\n/**\n * Classe d'interface des requtes de type WPS sur le service altimetrique.\n * (Factory)\n *\n * @module Gp.Services.Alti.Request.AltiRequestWPS\n * @alias Gp.Services.Alti.Request.AltiRequestWPS\n * @private\n */\n\n\n\n\n\n\nvar AltiRequestWPS = {\n\n    /**\n     * Interface unique de construction de la requte.\n     *\n     * @method build\n     * @param {Object} options - options\n     * @param {Object}   options.param.positions - tableau de coordonnes lon/lat\n     * @param {String}   options.param.delimiter - '|'\n     * @param {Boolean}  options.param.indent - false|true\n     * @param {String}   options.param.crs - 'CRS:84'\n     * @param {String}   options.param.sampling - 3\n     * @param {Boolean}  options.param.zonly - false|true\n     * @param {String}   options.param.format - \"JSON|XML\" (only to POST)\n     * @param {String}   options.wps.service - \"WPS\"\n     * @param {String}   options.wps.version - \"1.0.0\"\n     * @param {String}   options.wps.identifier - \"gs:WPSElevation|gs:WPSLineElevation\"\n     * @param {String}   options.wps.rawdataoutput - \"result\"\n     * @param {String}   options.wps.request - \"Execute\"\n     * @param {String}   options.type - \"Profil|Elevation\"\n     * @param {String}   options.method - GET|POST\n     * @example\n     *      var options = {\n     *           type : 'Profil', // Elevation\n     *           method : 'GET',  // par defaut\n     *           param : {\n     *               positions : [\n     *                   {lon:'1.11', lat:'1.11'},\n     *                   {lon:'1.10', lat:'1.10'},\n     *                   {lon:'1.12', lat:'1.12'}\n     *               ],\n     *               delimiter : \";\",         // par defaut\n     *               indent    : true,        // par defaut\n     *               crs       : 'EPSG:4326', // par defaut\n     *               format    : 'json',      // par defaut (only to POST)\n     *               sampling  : 3 ,          // par defaut (only use by Profil)\n     *               zonly     : false,       // par defaut (only use by Elevation)\n     *           },\n     *           wps : {\n     *                 service : 'WPS',         // par defaut\n     *                 version : '1.0.0',       // par defaut\n     *                 identifier : 'gs:WPS',   // par defaut, Elevation = gs:WPSElevation, Profil = gs:WPSLineElevation\n     *                 rawdataoutput : 'result',// par defaut\n     *                 request : 'Execute'      // par defaut\n     *           }\n     *       };\n     */\n    build : function (options) {\n        // logger\n        var logger = __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__[\"a\" /* default */].getLogger(\"AltiRequestWPS\");\n        logger.trace([\"AltiRequestWPS::build()\"]);\n\n        // existance des options\n        if (!options) {\n            throw new Error(__WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__[\"a\" /* default */].getMessage(\"PARAM_EMPTY\", \"options\"));\n        }\n\n        // type de requete : Altitude ou Profil\n        // (param.  determiner en fonction des parametres d'entre)\n        if (!options.type) {\n            throw new Error(__WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__[\"a\" /* default */].getMessage(\"PARAM_EMPTY\", \"type (Elevation or Profil)\"));\n        }\n\n        // construction du modele de requte\n        // (test du type d'objet candidat)\n        var DataObject = null;\n        switch (options.type) {\n            case \"Elevation\":\n                // surcharge\n                options.wps.identifier = \"gs:WPSElevation\";\n                DataObject = new __WEBPACK_IMPORTED_MODULE_3__model_AltiElevationRequest__[\"a\" /* default */](options.param);\n                break;\n            case \"Profil\":\n                // surcharge\n                options.wps.identifier = \"gs:WPSLineElevation\";\n                DataObject = new __WEBPACK_IMPORTED_MODULE_4__model_AltiProfilRequest__[\"a\" /* default */](options.param);\n                break;\n            default:\n                throw new Error(__WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__[\"a\" /* default */].getMessage(\"PARAM_TYPE\", \"type (Elevation or Profil)\"));\n        }\n\n        // construction de la requte WPS\n        var settings = {\n            data : DataObject,\n            method : options.method,\n            param : options.wps\n        };\n\n        var rqstWPS = new __WEBPACK_IMPORTED_MODULE_2__Formats_WPS__[\"a\" /* default */](settings);\n\n        if (!rqstWPS.processRequestString()) {\n            throw new Error(\"Enable to process request !\");\n        }\n\n        return rqstWPS.requestString;\n    }\n};\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (AltiRequestWPS);\n\n\n/***/ }),\n/* 57 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__ = __webpack_require__(0);\n/* FIXME : faire sauter proprement le warning lie au closure ci-dessous */\n/*jshint loopfunc: true*/\n\n\n/**\n * @classdesc\n * Standard WPS\n *\n * @constructor\n * @alias Gp.Formats.WPS\n * @param {Object} options - options\n * @param {Object}   options.data - objet\n * @param {String}   options.method - POST|GET\n * @param {String}   options.param.service - \"WPS\"\n * @param {String}   options.param.version - \"1.0.0\"\n * @param {String}   options.param.identifier - \"gs:WPSElevation|gs:WPSLineElevation\"\n * @param {String}   options.param.rawdataoutput - \"result\"\n * @param {String}   options.param.request - \"Execute\"\n * @param {Function} options.onsuccess - function callback success (TODO)\n * @param {Function} options.onerror   - function callback error   (TODO)\n * @private\n */\nfunction WPS (options) {\n\n    this.logger = __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__[\"a\" /* default */].getLogger();\n    this.logger.trace(\"[Constructeur WPS()]\");\n\n    if (!(this instanceof WPS)) {\n        throw new TypeError(\"WPS constructor cannot be called as a function.\");\n    }\n\n    this.options = options || {};\n\n    /**\n     * Objet DATA\n     */\n    this.DataObject = this.options.data;\n\n    if (!this.DataObject) {\n        throw new TypeError(\"This data object is not defined !\");\n    }\n\n    /**\n     * param service.\n     * Par defaut, \"WPS\".\n     */\n    this.paramservice = this.options.param.service || \"WPS\";\n\n    /**\n     * param version.\n     * Par defaut, \"1.0.0\".\n     */\n    this.paramversion = this.options.param.version || \"1.0.0\";\n\n    /**\n     * param identifier\n     * Par defaut, \"gs:WPS\"\n     */\n    this.paramidentifier = this.options.param.identifier || \"gs:WPS\";\n\n    /**\n     * param rawdataoutput\n     * Par defaut, \"result\".\n     */\n    this.paramrawdataoutput = this.options.param.rawdataoutput || \"result\";\n\n    /**\n     * param request\n     * Par defaut, \"Execute\".\n     */\n    this.paramrequest = this.options.param.request || \"Execute\";\n\n    /**\n     * methode.\n     * Par defaut, \"GET\".\n     */\n    this.method = this.options.method || \"GET\";\n}\n\nWPS.prototype = {\n\n    /**\n     * @lends module:WPS#\n     */\n\n    /**\n     * request\n     * @type {String}\n     */\n    requestString : null,\n\n    /**\n     * Constructeur (alias)\n     */\n    constructor : WPS,\n\n    /**\n     * Template de la requte.\n     */\n    template : {\n        get : {\n            value : \"service=__SERVICE__\" +\n                \"&version=__VERSION__\" +\n                \"&rawdataoutput=__RAWDATAOUTPUT__\" +\n                \"&identifier=__IDENTIFIER__\" +\n                \"&request=__REQUEST__\" +\n                \"&datainputs=<!-- __DATAINPUTS__ -->\",\n\n            input : \"__KEY__=__DATA__\"\n\n        },\n        post : {\n\n            value : \"<?xml version=\\\"1.0\\\" encoding=\\\"UTF-8\\\"?>\" +\n                \"<wps:__REQUEST__ version=\\\"__VERSION__\\\" service=\\\"__SERVICE__\\\" \" +\n                \"__NAMESPACE__ __SCHEMALOCATION__>\" +\n                \"<ows:Identifier>__IDENTIFIER__</ows:Identifier>\" +\n                \"<wps:DataInputs>\" +\n                \"<!-- __DATAINPUTS__ -->\" +\n                \"</wps:DataInputs>\" +\n                \"<wps:ResponseForm>\" +\n                \"<wps:RawDataOutput>\" +\n                \"<ows:Identifier>__RAWDATAOUTPUT__</ows:Identifier>\" +\n                \"</wps:RawDataOutput>\" +\n                \"</wps:ResponseForm>\" +\n                \"</wps:__REQUEST__>\",\n\n            input : \"<wps:Input>\" +\n                \"<ows:Identifier>__KEY__</ows:Identifier>\" +\n                \"<wps:Data>\" +\n                \"<wps:LiteralData>__DATA__</wps:LiteralData>\" +\n                \"</wps:Data>\" +\n                \"</wps:Input>\"\n        }\n    },\n\n    /**\n     * Namespace par defaut de la requete POST.\n     *\n     * @returns {String}\n     */\n    namespaceByDefault : function () {\n        var ns = [\n            \"xmlns:xsi=\\\"http://www.w3.org/2001/XMLSchema-instance\\\"\",\n            \"xmlns=\\\"http://www.opengis.net/wps/1.0.0\\\"\",\n            \"xmlns:wfs=\\\"http://www.opengis.net/wfs\\\"\",\n            \"xmlns:wps=\\\"http://www.opengis.net/wps/1.0.0\\\"\",\n            \"xmlns:ows=\\\"http://www.opengis.net/ows/1.1\\\"\",\n            \"xmlns:gml=\\\"http://www.opengis.net/gml\\\"\",\n            \"xmlns:ogc=\\\"http://www.opengis.net/ogc\\\"\",\n            \"xmlns:wcs=\\\"http://www.opengis.net/wcs/1.1.1\\\"\",\n            \"xmlns:xlink=\\\"http://www.w3.org/1999/xlink\\\"\"\n        ];\n\n        return ns.join(\" \");\n    },\n\n    /**\n     * Schemalocation par defaut.\n     *\n     * @returns {String}\n     */\n    schemaLocationByDefault : function () {\n        return \"xsi:schemaLocation=\\\"http://www.opengis.net/wps/1.0.0 http://schemas.opengis.net/wps/1.0.0/wpsAll.xsd\\\"\";\n    },\n\n    /**\n     * Construction de la requte.\n     *\n     * @example\n     * // GET  out :\n     * //  service=__SERVICE__\n     * //  &version=__VERSION__\n     * //  &rawdataoutput=__RAWDATAOUTPUT__\n     * //  &identifier=__IDENTIFIER__\n     * //  &request=__REQUEST__\n     * //  &datainputs=\"__DATAINPUTS__\"\n     * //  avec __DATAINPUTS__ = __KEY__=__DATA__;...\n     *\n     * // POST out :\n     * //      <?xml version=\\\"1.0\\\" encoding=\\\"UTF-8\\\"?>\n     * //      <wps:__REQUEST__ version=\\\"__VERSION__\\\" service=\\\"__SERVICE__\\\"\n     * //         __NAMESPACE__ __SCHEMALOCATION__>\n     * //          <ows:Identifier>__IDENTIFIER__</ows:Identifier>\n     * //          <wps:DataInputs>\n     * //              <!-- __DATAINPUTS__ -->\n     * //          </wps:DataInputs>\n     * //          <wps:ResponseForm>\n     * //              <wps:RawDataOutput>\n     * //              <ows:Identifier>__RAWDATAOUTPUT__</ows:Identifier>\n     * //              </wps:RawDataOutput>\n     * //          </wps:ResponseForm>\n     * //      </wps:__REQUEST__>\",\n     * //      avec __DATAINPUTS__\n     * //             <wps:Input>\n     * //                  <ows:Identifier>__KEY__</ows:Identifier>\n     * //                  <wps:Data>\n     * //                    <wps:LiteralData>__DATA__</wps:LiteralData>\n     * //                  </wps:Data>\n     * //              </wps:Input>\n     *\n     * @returns {Boolean}\n     */\n    processRequestString : function () {\n\n        this.logger.trace(\"WPS::processRequestString ()\");\n\n        var template = \"\";\n        if (this.method == \"POST\") {\n            template = this.template.post.value;\n        } else if (this.method == \"GET\") {\n            template = this.template.get.value;\n        } else {\n            this.logger.error(\"No other method supported by the service !\");\n            return false;\n        }\n\n        template = template.replace(/__SERVICE__/g, this.paramservice);\n        template = template.replace(/__VERSION__/g, this.paramversion);\n        template = template.replace(/__RAWDATAOUTPUT__/g, this.paramrawdataoutput);\n        template = template.replace(/__IDENTIFIER__/g, this.paramidentifier);\n        template = template.replace(/__REQUEST__/g, this.paramrequest);\n\n        // ajout +\n        if (this.method == \"POST\") {\n            template = template.replace(/__NAMESPACE__/g, this.namespaceByDefault);\n            template = template.replace(/__SCHEMALOCATION__/g, this.schemaLocationByDefault);\n        }\n\n        // ajout des datainputs\n        template = template.replace(/<!-- __DATAINPUTS__ -->/g, this.__addDataInputs());\n\n        if (!template) {\n            this.logger.warn(\"traduction tmpl : empty request !?\");\n            return false;\n        }\n\n        this.requestString = template;\n        this.logger.trace(\"traduction tmpl\", template);\n\n        return true;\n    },\n\n    /**\n     * Ajout des donnes\n     *\n     * @returns {String}\n     */\n    __addDataInputs : function () {\n\n        this.logger.trace(\"WPS::__addDataInputs ()\");\n\n        // c'est un peu grossier...\n        var tmpl = this.method == \"GET\" ? this.template.get.input : this.template.post.input;\n        var sep = this.method == \"GET\" ? \";\" : \"\";\n\n        var result = \"\";\n        var that = this;\n        var map = this.DataObject.getData();\n        for (var i = 0; i < map.length; i++) {\n            // FIXME closure ?\n            (function (j) {\n                if (sep) {\n                    sep = (j == map.length - 1) ? \"\" : \";\";\n                }\n                result = result.concat(that.__addDataInput(tmpl, map[j].k, map[j].v), sep);\n            })(i);\n        }\n\n        return result;\n    },\n\n    /**\n     * Ajout d'une donnes.\n     *\n     * @param {String} tmpl - template\n     * @param {String} key - clef\n     * @param {String} data - valeur\n     * @returns {String}\n     */\n    __addDataInput : function (tmpl, key, data) {\n        var tmp = tmpl;\n        tmp = tmp.replace(/__KEY__/g, key);\n        tmp = tmp.replace(/__DATA__/g, data);\n        return tmp;\n    },\n\n    /**\n     * Definir le mode de requte\n     *\n     * @param {String} method - GET|POST\n     */\n    setMethod : function (method) {\n        if (method == \"GET\" || method == \"POST\") {\n            this.method = method;\n        } else {\n            this.logger.warn(\"support only GET and POST method !\");\n        }\n    },\n\n    /**\n     * Retourne le mode de requete (GET|POST).\n     *\n     * @returns {AltiRequest.options.mode|String}\n     */\n    getMethod : function () {\n        return this.method;\n    }\n};\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (WPS);\n\n\n/***/ }),\n/* 58 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__ = __webpack_require__(1);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__Exceptions_ErrorService__ = __webpack_require__(2);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__Formats_XML__ = __webpack_require__(4);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__Formats_AltiResponseReader__ = __webpack_require__(59);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__model_AltiResponse__ = __webpack_require__(9);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__model_Elevation__ = __webpack_require__(10);\n/**\n * Factory pour gnrer une reponse JSON  partir d'un XML ou d'un JSON\n * (Factory)\n *\n * @module AltiResponseFactory\n * @private\n * @alias Gp.Services.Alti.Response.AltiResponseFactory\n */\n\n\n\n\n\n\n\n\nvar AltiResponseFactory = {\n\n    /**\n     * interface unique\n     *\n     * @method build\n     * @static\n     * @param {Object} options - options definies dans le composant Alti\n     *\n     * @example\n     *   var options = {\n     *      response :\n     *      outputFormat :\n     *      rawResponse :\n     *      scope :\n     *      onSuccess :\n     *      onError :\n     *   };\n     *\n     */\n    build : function (options) {\n\n        // logger\n        var logger = __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__[\"a\" /* default */].getLogger(\"AltiResponseFactory\");\n        logger.trace([\"AltiResponseFactory::build()\"]);\n\n        var data = null;\n\n        if (options.response) {\n            if (options.rawResponse) {\n                logger.trace(\"analyze response : raw\");\n                data = options.response;\n            } else {\n                switch (options.outputFormat) {\n\n                    case \"xml\":\n                        logger.trace(\"analyze response : xml\");\n\n                        try {\n\n                            var p = new __WEBPACK_IMPORTED_MODULE_3__Formats_XML__[\"a\" /* default */]({\n                                reader : __WEBPACK_IMPORTED_MODULE_4__Formats_AltiResponseReader__[\"a\" /* default */]\n                            });\n\n                            if ( typeof options.response === \"string\") {\n                                p.setXMLString(options.response);\n                            } else {\n                                p.setXMLDoc(options.response);\n                            }\n\n                            data = p.parse();\n\n                            if (!data) {\n                                throw new Error(__WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__[\"a\" /* default */].getMessage(\"SERVICE_RESPONSE_EXCEPTION_2\"));\n                            }\n\n                        } catch (e) {\n\n                            var message = e.message;\n                            options.onError.call(options.scope, new __WEBPACK_IMPORTED_MODULE_2__Exceptions_ErrorService__[\"a\" /* default */]({\n                                message : __WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__[\"a\" /* default */].getMessage(\"SERVICE_RESPONSE_EXCEPTION\", message),\n                                status : 200,\n                                type : __WEBPACK_IMPORTED_MODULE_2__Exceptions_ErrorService__[\"a\" /* default */].TYPE_SRVERR\n                            }));\n                            return;\n                        }\n\n                        break;\n\n                    case \"json\":\n                        logger.trace(\"analyze response : json\");\n                        logger.trace(\"analyze response : \", typeof options.response);\n\n                        var JSONResponse;\n                        if ( typeof options.response === \"string\") {\n                            JSONResponse = JSON.parse(options.response);\n                        } else {\n                            JSONResponse = options.response;\n                        }\n\n                        // le service renvoie t il une erreur ?\n                        if (JSONResponse.error) {\n                            // ex. {\"error\": {\"code\": \"BAD_PARAMETER\",\"description\": \"The values () cannot be parsed as a valid longitude (double value such as -180 < lat < 180).\"}}\n                            options.onError.call(options.scope, new __WEBPACK_IMPORTED_MODULE_2__Exceptions_ErrorService__[\"a\" /* default */]({\n                                message : __WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__[\"a\" /* default */].getMessage(\"SERVICE_RESPONSE_EXCEPTION\", JSONResponse.error.description),\n                                status : 200,\n                                type : __WEBPACK_IMPORTED_MODULE_2__Exceptions_ErrorService__[\"a\" /* default */].TYPE_SRVERR\n                            }));\n                            return;\n                        }\n\n                        // analyse de la reponse\n                        if (JSONResponse) {\n                            var elevations = JSONResponse.elevations;\n                            var altiResponse = new __WEBPACK_IMPORTED_MODULE_5__model_AltiResponse__[\"a\" /* default */]();\n                            var elevation;\n                            if (Array.isArray(elevations) && elevations.length) {\n                                for (var i = 0; i < elevations.length; i++) {\n                                    elevation = new __WEBPACK_IMPORTED_MODULE_6__model_Elevation__[\"a\" /* default */]();\n\n                                    if ( typeof elevations[i] === \"object\") {\n                                        // elevations[i] est un objet elevation\n                                        if (elevations[i].lon) {\n                                            elevation.lon = elevations[i].lon;\n                                        }\n                                        if (elevations[i].lat) {\n                                            elevation.lat = elevations[i].lat;\n                                        }\n                                        if (elevations[i].z) {\n                                            elevation.z = elevations[i].z;\n                                        }\n                                        if (elevations[i].acc) {\n                                            elevation.acc = elevations[i].acc;\n                                        }\n                                    } else if ( typeof elevations[i] === \"number\") {\n                                        // elevations[i] est un nombre, dans le cas de zonly=true notamment\n                                        elevation.z = elevations[i];\n                                    }\n\n                                    if (Array.isArray(altiResponse.elevations)) {\n                                        altiResponse.elevations.push(elevation);\n                                    }\n                                }\n                            }\n                            data = altiResponse;\n                        }\n\n                        if (!data) {\n                            options.onError.call(options.scope, new __WEBPACK_IMPORTED_MODULE_2__Exceptions_ErrorService__[\"a\" /* default */]({\n                                message : __WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__[\"a\" /* default */].getMessage(\"SERVICE_RESPONSE_ANALYSE_2\"),\n                                type : __WEBPACK_IMPORTED_MODULE_2__Exceptions_ErrorService__[\"a\" /* default */].TYPE_UNKERR,\n                                status : -1\n                            }));\n                            return;\n                        }\n                        break;\n\n                    default:\n                        options.onError.call(options.scope, new __WEBPACK_IMPORTED_MODULE_2__Exceptions_ErrorService__[\"a\" /* default */]({\n                            message : __WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__[\"a\" /* default */].getMessage(\"SERVICE_RESPONSE_FORMAT_2\"),\n                            type : __WEBPACK_IMPORTED_MODULE_2__Exceptions_ErrorService__[\"a\" /* default */].TYPE_UNKERR,\n                            status : -1\n                        }));\n                        return;\n                }\n\n                // Si la rponse contenait une exception renvoye par le service\n                if (data.exceptionReport) {\n                    options.onError.call(options.scope, new __WEBPACK_IMPORTED_MODULE_2__Exceptions_ErrorService__[\"a\" /* default */]({\n                        message : __WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__[\"a\" /* default */].getMessage(\"SERVICE_RESPONSE_EXCEPTION\", data.exceptionReport),\n                        type : __WEBPACK_IMPORTED_MODULE_2__Exceptions_ErrorService__[\"a\" /* default */].TYPE_SRVERR,\n                        status : 200\n                    }));\n                    return;\n                } else if (data.error) {\n                    var errorMess = data.error.description;\n                    options.onError.call(options.scope, new __WEBPACK_IMPORTED_MODULE_2__Exceptions_ErrorService__[\"a\" /* default */]({\n                        message : __WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__[\"a\" /* default */].getMessage(\"SERVICE_RESPONSE_EXCEPTION\", errorMess),\n                        type : __WEBPACK_IMPORTED_MODULE_2__Exceptions_ErrorService__[\"a\" /* default */].TYPE_SRVERR,\n                        status : 200\n                    }));\n                    return;\n                }\n            }\n        } else {\n            options.onError.call(options.scope, new __WEBPACK_IMPORTED_MODULE_2__Exceptions_ErrorService__[\"a\" /* default */](__WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__[\"a\" /* default */].getMessage(\"SERVICE_RESPONSE_EMPTY\")));\n            return;\n        }\n\n        options.onSuccess.call(options.scope, data);\n        return;\n    }\n};\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (AltiResponseFactory);\n\n\n/***/ }),\n/* 59 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__Response_model_AltiResponse__ = __webpack_require__(9);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__Response_model_Elevation__ = __webpack_require__(10);\n\n/**\n * Fonction retournant un objet contenant des cls de lecture (readers)\n *      qui permettent de parser des rponses XML du service Altimtrique du Goportail\n *      (calcul altimtrique simple ou profil altimtrique d'une courbe),\n *      lorsque le paramtre output = xml,\n *      afin de rcuprer les lvations retournes.\n *\n * @module AltiResponseReader\n * @alias Gp.Services.Alti.Formats.AltiResponseReader\n * @private\n */\n\n\n\n\n\n/**\n *\n * Objet AltiResponseReader\n *\n * @member {Object} AltiResponseReader\n *\n * @property {Object} AltiResponseReader.READERS - Objet contenant des fonctions de lecture, appeles \"readers\"\n *      dont chaque cl correspond au nom d'un tag du XML que l'on souhaite lire\n *      et la valeur associe est une fonction (node, data)\n *      o node est un noeud du document DOM\n *      et data est un objet o l'on stocke les informations lues dans le XML.\n *\n * @property {Method} AltiResponseReader.READERS.elevations -  Lecture d'un noeud \"elevations\" de la rponse XML\n *      du service alti, correspondant logiquement  la racine du document\n *      (contient un ou plusieurs childNodes correspondant chacun  une lvation retourne)\n *\n * @property {Method} AltiResponseReader.READERS.elevation - ecture d'un noeud \"elevation\" de la rponse xml du service alti.\n *      (contient un ou 4 childNode (s) correspondant  l'altitude (z) et ventuellement lat, lon, et acc)\n *\n * @property {Method} AltiResponseReader.READERS.lat - Lecture d'un noeud \"lat\" de la rponse xml du service alti.\n *      (contient une valeur de latitude, qui est un flottant)\n *\n * @property {Method} AltiResponseReader.READERS.lon - Lecture d'un noeud \"lon\" de la rponse xml du service alti.\n *      (contient une valeur de longitude, qui est un flottant)\n *\n * @property {Method} AltiResponseReader.READERS.z - Lecture d'un noeud \"z\" de la rponse xml du service alti.\n *      (contient une valeur d'altitude, qui est un flottant)\n *\n * @property {Method} AltiResponseReader.READERS.acc - Lecture d'un noeud \"acc\" de la rponse xml du service alti.\n *      (contient une valeur de prcision, qui est un flottant)\n *\n * @property {Method} AltiResponseReader.READERS.exceptionreport - Lecture d'un noeud \"ExceptionReport\" de la rponse xml du service alti.\n *\n * @property {Method} AltiResponseReader.READERS.exception - Lecture d'un noeud \"Exception\" de la rponse xml du service alti.\n *\n * @property {Method} AltiResponseReader.read - Mthode permettant de lancer la lecture d'une rponse XML du service altimtrique,\n *       l'aide des readers de la classe.\n *\n */\nvar AltiResponseReader = {};\n\nAltiResponseReader.READERS = {\n\n    /**\n     * Lecture d'un noeud \"elevations\" de la rponse XML du service alti, correspondant logiquement  la racine du document\n     *      (contient un ou plusieurs childNodes correspondant chacun  une lvation retourne)\n     *\n     * @param {DOMElement} root - racine de la rponse XML\n     * @static\n     * @memberof AltiResponseReader\n     */\n    elevations : function (root) {\n\n        // INFO : on passe en paramtre l'objet en entre elevations, vide,  remplir.\n        var altiResponse = new __WEBPACK_IMPORTED_MODULE_1__Response_model_AltiResponse__[\"a\" /* default */]();\n\n        if (root.hasChildNodes()) {\n\n            var children = root.childNodes;\n            var child;\n            var elevation;\n\n            for (var i = 0; i < children.length; i++) {\n                child = children[i];\n\n                if (AltiResponseReader.READERS[child.nodeName]) {\n                    elevation = AltiResponseReader.READERS[child.nodeName](child);\n                    altiResponse.elevations.push(elevation);\n                }\n            }\n        }\n\n        return altiResponse;\n    },\n\n    /**\n     * Lecture d'un noeud \"elevation\" de la rponse xml du service alti.\n     *      (contient un ou 4 childNode (s) correspondant  l'altitude (z) et ventuellement lat, lon, et acc)\n     *\n     * @param {DOMElement} node - noeud elevation  lire pour rcuprer les informations de l'lvation retourne (z [, lon, lat, acc])\n     * @return {Array} elevationResponse - format de la rponse en sortie, instance de AltiResponse\n     * @static\n     * @memberof AltiResponseReader\n     */\n    elevation : function (node) {\n\n        var elevation = new __WEBPACK_IMPORTED_MODULE_2__Response_model_Elevation__[\"a\" /* default */]();\n\n        if (node.hasChildNodes()) {\n            var children = node.childNodes;\n            var child;\n            for (var i = 0; i < children.length; i++) {\n                child = children[i];\n                if (AltiResponseReader.READERS[child.nodeName]) {\n                    // INFO : on passe en paramtre l'objet en entre elevation, vide,  remplir.\n                    AltiResponseReader.READERS[child.nodeName](child, elevation);\n                }\n            }\n\n        }\n        return elevation;\n    },\n\n    /**\n     * Lecture d'un noeud \"lat\" de la rponse xml du service alti.\n     *      (contient une valeur de latitude, qui est un flottant)\n     *\n     * @param {DOMElement} node - noeud  lire pour rcuprer la latitude\n     * @param {Object} elevation - objet dans lequel stocker la latitude retourne\n     * @static\n     * @memberof AltiResponseReader\n     */\n    lat : function (node, elevation) {\n        var textNode = node.firstChild;\n        if (textNode && textNode.nodeType === 3) { // 3 == node.TEXT_NODE\n            elevation.lat = parseFloat(textNode.nodeValue);\n        } else {\n            throw new Error(\"Erreur dans la lecture de la rponse du service : latitude attendue mais absente\");\n        }\n    },\n\n    /**\n     * Lecture d'un noeud \"lon\" de la rponse xml du service alti.\n     *      (contient une valeur de longitude, qui est un flottant)\n     *\n     * @param {DOMElement} node - noeud  lire pour rcuprer la longitude\n     * @param {Object} elevation - objet dans lequel stocker la longitude retourne\n     * @static\n     * @memberof AltiResponseReader\n     */\n    lon : function (node, elevation) {\n        var textNode = node.firstChild;\n        if (textNode && textNode.nodeType === 3) { // 3 == node.TEXT_NODE\n            elevation.lon = parseFloat(textNode.nodeValue);\n        } else {\n            throw new Error(\"Erreur dans la lecture de la rponse du service : longitude attendue mais absente\");\n        }\n    },\n\n    /**\n     * Lecture d'un noeud \"z\" de la rponse xml du service alti.\n     *      (contient une valeur d'altitude, qui est un flottant)\n     *\n     * @param {DOMElement} node - noeud  lire pour rcuprer l'altitude\n     * @param {Object} elevation - objet dans lequel stocker l'altitude retourne\n     * @static\n     * @memberof AltiResponseReader\n     */\n    z : function (node, elevation) {\n        var textNode = node.firstChild;\n        if (textNode && textNode.nodeType === 3) { // 3 == node.TEXT_NODE\n            if (elevation) {\n                elevation.z = parseFloat(textNode.nodeValue);\n            } else {\n                elevation = new __WEBPACK_IMPORTED_MODULE_2__Response_model_Elevation__[\"a\" /* default */]();\n                elevation.z = parseFloat(textNode.nodeValue);\n                return elevation;\n            }\n        } else {\n            throw new Error(\"Erreur dans la lecture de la rponse du service : altitude attendue mais absente\");\n        }\n    },\n\n    /**\n     * Lecture d'un noeud \"acc\" de la rponse xml du service alti.\n     *      (contient une valeur de prcision, qui est un flottant)\n     *\n     * @param {DOMElement} node - noeud  lire pour rcuprer la prcision\n     * @param {Object} elevation - objet dans lequel stocker la prcision retourne\n     * @static\n     * @memberof AltiResponseReader\n     */\n    acc : function (node, elevation) {\n        var textNode = node.firstChild;\n        if (textNode && textNode.nodeType === 3) { // 3 == node.TEXT_NODE\n            elevation.acc = parseFloat(textNode.nodeValue);\n        } else {\n            throw new Error(\"Erreur dans la lecture de la rponse du service : prcision (acc) attendue mais absente\");\n        }\n    },\n\n    /**\n     * Lecture d'un noeud \"ExceptionReport\" de la rponse xml du service alti.\n     *\n     * @param {DOMElement} node - noeud  lire pour rcuprer l'exception\n     * @return {Object} exceptionReport - objet contenant l'exception\n     * @static\n     * @memberof AltiResponseReader\n     */\n    exceptionreport : function (node) {\n\n        var response = {};\n\n        if (node.hasChildNodes()) {\n            var children = node.childNodes;\n            var child;\n            for (var i = 0; i < children.length; i++) {\n                child = children[i];\n                if (child.nodeName === \"Exception\") {\n                    response.exceptionReport = AltiResponseReader.READERS.exception(child);\n                }\n            }\n        }\n\n        return response;\n    },\n\n    /**\n     * Lecture d'un noeud \"Exception\" de la rponse xml du service alti.\n     *\n     * @param {DOMElement} node - noeud  lire pour rcuprer l'exception\n     * @return {Object} exceptionReport - objet contenant l'exception, avec deux attributs :\n     *      {String} exceptionReport.exceptionCode - qui contient l'identifiant du code de l'exception\n     *      {String} exceptionReport.exception - qui contient le message de l'exception\n     * @static\n     * @memberof AltiResponseReader\n     */\n    exception : function (node) {\n        var exceptionReport = {};\n\n        // get exception code\n        var exceptionCode = node.getAttribute(\"exceptionCode\");\n        if (exceptionCode) {\n            exceptionReport.exceptionCode = exceptionCode;\n        }\n\n        // get exception message\n        var textNode = node.firstChild;\n        if (textNode && textNode.nodeType === 3) { // 3 == node.TEXT_NODE\n            exceptionReport.exception = textNode.nodeValue;\n        }\n\n        return exceptionReport;\n    },\n\n    /**\n     * Lecture d'un noeud \"Error\" de la rponse xml du service alti.\n     *\n     * @param {DOMElement} node - noeud  lire pour rcuprer l'exception\n     * @return {Object} error - objet contenant l'exception\n     * @static\n     */\n    error : function (node) {\n        var response = {\n            error : {}\n        };\n        // get error code and description\n        if (node.hasChildNodes()) {\n            var children = node.childNodes;\n            var child;\n            for (var i = 0; i < children.length; i++) {\n                child = children[i];\n                var textNode;\n                // get error code\n                if (child.nodeType === 1 && child.nodeName === \"code\") { // 1 == node.ELEMENT_NODE\n                    textNode = child.firstChild;\n                    if (textNode && textNode.nodeType === 3) { // 3 == node.TEXT_NODE\n                        response.error.code = textNode.nodeValue;\n                    }\n                }\n                // get error description\n                if (child.nodeType === 1 && child.nodeName === \"description\") { // 1 == node.ELEMENT_NODE\n                    textNode = child.firstChild;\n                    if (textNode && textNode.nodeType === 3) { // 3 == node.TEXT_NODE\n                        response.error.description = textNode.nodeValue;\n                    }\n                }\n            }\n        }\n        return response;\n    }\n\n};\n\n/**\n * Mthode permettant de lancer la lecture d'une rponse XML du service altimtrique,\n *       l'aide des readers de la classe.\n *\n * @method AltiResponseReader.read\n * @param {DOMElement} root - racine de la rponse XML  lire\n * @static\n * @memberof AltiResponseReader\n */\nAltiResponseReader.read = function (root) {\n    if (root.nodeName === \"elevations\") {\n        var altiResponse = AltiResponseReader.READERS.elevations(root);\n        return altiResponse;\n    } else if (root.nodeName === \"ExceptionReport\") {\n        var exceptionReport = AltiResponseReader.READERS.exceptionreport(root);\n        return exceptionReport;\n    } else if (root.nodeName === \"error\") {\n        var error = AltiResponseReader.READERS.error(root);\n        return error;\n    } else {\n        throw new Error(\"Erreur lors de la lecture de la rponse : elle n'est pas au format attendu.\");\n    }\n};\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (AltiResponseReader);\n\n\n/***/ }),\n/* 60 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__ = __webpack_require__(1);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__Utils_Helper__ = __webpack_require__(5);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__Exceptions_ErrorService__ = __webpack_require__(2);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__DefaultUrlService__ = __webpack_require__(6);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__CommonService__ = __webpack_require__(3);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__Response_AutoConfResponseFactory__ = __webpack_require__(61);\n\n\n\n\n\n\n\n\n\n/**\n * @classdesc\n * Appel du service d'autoconfiguration du Goportail\n *\n * @private\n * @constructor\n * @extends {Gp.Services.CommonService}\n * @alias Gp.Services.AutoConf\n *\n * @param {Object} options - options spcifiques au service (+ les options herites)\n *\n * @param {String} [options.layerId] - Le nom de l'agrgat (couche) dont on veut connatre les informations dtailles.\n *      La prsence de cette proprit implique l'utilisation de la deuxime opration du service pour accder aux informations d'une couche aggrge.\n *      Dans ce cas, la fonction effectuera quand mme dans un premier temps la rcupration des informations de l'auto-\n *      configuration complte, sauf si un premier appel  l'autoconf a dj t fait avec cette cl (i.e. si la variable globale est dfinie\n *      pour la cl de contrat). Elle ira ensuite chercher les informations des couches agrges, qui seront ajoutes  la variable globale Gp.Config.\n *\n * @example\n *   var options = {\n *      // options communes aux services\n *      apiKey : \"apikey\",\n *      protocol : 'JSONP', // JSONP|XHR\n *      timeOut : 10000, // ms\n *      rawResponse : false, // true|false\n *      scope : null, // this\n *      onSuccess : function (response) {},\n *      onFailure : function (error) {},\n *      layerId : \"ORTHOIMAGERY.ORTHOPHOTOS.3D$GEOPORTAIL:OGC:WMTS@aggregate\"\n *   };\n */\nfunction AutoConf (options) {\n\n    if (!(this instanceof AutoConf)) {\n        throw new TypeError(__WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__[\"a\" /* default */].getMessage(\"CLASS_CONSTRUCTOR\", \"AutoConf\"));\n    }\n\n    /**\n     * Nom de la classe (heritage)\n     * FIXME instance ou classe ?\n     */\n    this.CLASSNAME = \"AutoConf\";\n\n    // Autoconf default protocol remains JSONP (#see http://ignf.github.io/geoportal-access-lib/latest/jsdoc/tutorial-optimize-getconfig.html)\n    if (!options) {\n        options = {};\n    }\n    options.protocol = options.protocol || \"JSONP\";\n\n    // appel du constructeur par heritage\n    __WEBPACK_IMPORTED_MODULE_5__CommonService__[\"a\" /* default */].apply(this, arguments);\n\n    this.logger = __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__[\"a\" /* default */].getLogger(\"Gp.Services.AutoConf\");\n    this.logger.trace(\"[Constructeur AutoConf (options)]\");\n\n    // #####################\n    // analyse des options\n    // #####################\n\n    // gestion de l'url du service par defaut\n    if (!this.options.serverUrl) {\n        // si l'url n'est pas renseigne, il faut utiliser les urls par defaut\n        // en fonction du nombre de cls en entre et du paramtre layerId\n        if (!this.options.serverUrl) {\n            var lstUrlByDefault = __WEBPACK_IMPORTED_MODULE_4__DefaultUrlService__[\"a\" /* default */].AutoConf.url(this.options.apiKey);\n\n            if (!this.options.layerId) {\n                // cas d'une autoconf simple\n                if (Array.isArray(this.options.apiKey) && this.options.apiKey.length > 0) {\n                    // cas d'un tableau de cls en entre\n                    this.options.serverUrl = lstUrlByDefault.apiKeys;\n                } else {\n                    this.options.serverUrl = lstUrlByDefault.apiKey;\n                }\n            } else {\n                // cas d'une autoconf pour des couches aggrges\n                this.options.serverUrl = lstUrlByDefault.aggregate + this.options.layerId;\n            }\n        }\n    }\n\n    // INFO\n    // le service ne repond pas en mode POST (405 Method Not Allowed)\n    if (this.options.protocol === \"XHR\" && this.options.httpMethod === \"POST\") {\n        this.logger.warn(\"Le service ne gre pas le mode d'interrogation en POST, on bascule sur du GET !\");\n        this.options.httpMethod = \"GET\"; // on surcharge !\n    }\n\n    // #####################\n    // attributs d'instances\n    // #####################\n\n    /**\n     * Format forc de la rponse du service : \"xml\"\n     * sauf si l'on souhaite une reponse brute (options.rawResponse)\n     */\n    this.options.outputFormat = (this.options.rawResponse) ? \"\" : \"xml\";\n\n};\n\n/**\n * @lends module:AutoConf#\n */\n\nAutoConf.prototype = Object.create(__WEBPACK_IMPORTED_MODULE_5__CommonService__[\"a\" /* default */].prototype, {\n    // todo\n    // getter/setter\n});\n\n/*\n * Constructeur (alias)\n */\nAutoConf.prototype.constructor = AutoConf;\n\n/**\n * Cration de la requte (overwrite)\n *\n * @param {Function} error   - callback des erreurs\n * @param {Function} success - callback de succs de la cration de la requte\n */\nAutoConf.prototype.buildRequest = function (error, success) {\n\n    var scope = typeof window !== \"undefined\" ? window : {};\n\n    if (scope.Gp && scope.Gp.Config && scope.Gp.Config.generalOptions && scope.Gp.Config.layers) {\n        if (scope.Gp.Config.generalOptions.apiKeys[this.options.apiKey]) {\n\n            if (this.options.layerId) { // cas d'une autoconf + dtaille sur une couche agrge\n                if (scope.Gp.Config.layers[this.options.layerId] && scope.Gp.Config.layers[this.options.layerId].aggregatedLayers) {\n                    this.logger.warn(\"Gp.Config existe dj pour cette cl et cette couche\");\n                    this.options.onSuccess.call(this, scope.Gp.Config);\n                    return;\n                }\n            } else {\n                this.logger.warn(\"Gp.Config existe dj pour cette cl\");\n                this.options.onSuccess.call(this, scope.Gp.Config);\n                return;\n            }\n        }\n    }\n\n    // requete par defaut\n    this.request = \"\";\n\n    // gestion de l'autoconf local\n    // Le fichier en local doit respecter le format de sortie du service.\n    //  - En XHR, le format est en xml\n    //  - En JSONP, le format est en xml encapsul dans un json avec une fonction de callback\n    //    ex. callback ({\"http\":{\"status\":200,\"error\":null},\"xml\":\"...\"})\n    var bLocal;\n    if (this.options.serverUrl.indexOf(\"http://\") === -1) {\n        bLocal = true;\n    } else {\n        bLocal = false;\n    }\n\n    // FIXME param. KVP optionnel sur un service uniquement (pas sur un autoconf local !)\n    if (!bLocal && this.layerId) {\n        this.request = __WEBPACK_IMPORTED_MODULE_2__Utils_Helper__[\"a\" /* default */].normalyzeParameters({\n            layerId : this.layerId\n        });\n    }\n\n    success.call(this, this.request);\n};\n\n/**\n * Analyse de la reponse (overwrite)\n *\n * @param {Function} error   - callback des erreurs\n * @param {Function} success - callback de succs de l'analyse de la rponse\n */\nAutoConf.prototype.analyzeResponse = function (error, success) {\n\n    if (this.response) {\n\n        var options = {\n            layerId : this.options.layerId,\n            response : this.response,\n            rawResponse : this.options.rawResponse,\n            onSuccess : success,\n            onError : error,\n            scope : this\n        };\n\n        __WEBPACK_IMPORTED_MODULE_6__Response_AutoConfResponseFactory__[\"a\" /* default */].build(options);\n\n    } else {\n        error.call(this, new __WEBPACK_IMPORTED_MODULE_3__Exceptions_ErrorService__[\"a\" /* default */](__WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__[\"a\" /* default */].getMessage(\"SERVICE_RESPONSE_EMPTY\")));\n    }\n\n};\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (AutoConf);\n\n\n/***/ }),\n/* 61 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__ = __webpack_require__(1);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__Exceptions_ErrorService__ = __webpack_require__(2);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__Formats_XML__ = __webpack_require__(4);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__Formats_AutoConfResponseReader__ = __webpack_require__(62);\n/**\n * Factory pour gnrer une reponse JSON  partir d'un XML\n *\n * @module AutoConfReponseFactory\n * @private\n * @alias Gp.Services.AutoConf.Response.AutoConfResponseFactory\n * @todo grer le cas du JSONP qui encapsule du XML ?\n */\n\n\n\n\n\n\nvar AutoConfReponseFactory = {\n\n    /**\n     * interface unique\n     * Fabrique d'analyse des rponses (xml) du service d'autoconfiguration.\n     * Cration d'un format XML, auquel on associe un reader et une chane XML, et qui renverra un objet JavaScript correspondant.\n     * Si une erreur est leve lors de l'analyse, ou si l'objet est vide ou contient une exception : appel de la fonction de callback onError\n     * Sinon, appel de la fonction de callback onSuccess (dfinies dans Autoconf.analyzeResponse)\n     *\n     * @method build\n     * @static\n     * @param {Object} options - options definies dans le composant AutoConf\n     *\n     * @example\n     *   var options = {\n     *      layerId :\n     *      response :\n     *      rawResponse :\n     *      scope :\n     *      onSuccess :\n     *      onError :\n     *   };\n     */\n    build : function (options) {\n\n        // logger\n        var logger = __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__[\"a\" /* default */].getLogger(\"AutoConfResponseFactory\");\n        logger.trace([\"AutoConfResponseFactory::build()\"]);\n\n        // data de type AutoConfResponse\n        var data = null;\n\n        if (options.response) {\n\n            if (options.rawResponse) {\n                data = options.response;\n\n            } else {\n\n                try {\n\n                    var p = new __WEBPACK_IMPORTED_MODULE_3__Formats_XML__[\"a\" /* default */]({\n                        reader : __WEBPACK_IMPORTED_MODULE_4__Formats_AutoConfResponseReader__[\"a\" /* default */]\n                    });\n\n                    if ( typeof options.response === \"string\") {\n                        p.setXMLString(options.response);\n                    } else {\n                        p.setXMLDoc(options.response);\n                    }\n\n                    data = p.parse();\n\n                } catch (e) {\n\n                    // si une exception a t leve, on appelle le callback d'erreur avec le message renvoy\n                    var message = e.message;\n                    if ( typeof options.response === \"string\") {\n                        message += \"\\n (raw response service'\" + options.response + \"')\";\n                    } else {\n                        message += \"\\n (raw response service'\" + options.response.documentElement.innerHTML + \"')\";\n                    }\n\n                    options.onError.call(options.scope, new __WEBPACK_IMPORTED_MODULE_2__Exceptions_ErrorService__[\"a\" /* default */]({\n                        message : __WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__[\"a\" /* default */].getMessage(\"SERVICE_RESPONSE_EXCEPTION\", message),\n                        status : 200,\n                        type : __WEBPACK_IMPORTED_MODULE_2__Exceptions_ErrorService__[\"a\" /* default */].TYPE_SRVERR\n                    }));\n                    return;\n                }\n\n                // Si la rponse est vide, on appelle le callback d'erreur\n                var isEmpty = true;\n                for (var key in data) {\n                    if (data.hasOwnProperty(key)) {\n                        isEmpty = false;\n                    }\n                }\n                if (isEmpty) {\n                    options.onError.call(options.scope, new __WEBPACK_IMPORTED_MODULE_2__Exceptions_ErrorService__[\"a\" /* default */](__WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__[\"a\" /* default */].getMessage(\"SERVICE_RESPONSE_EMPTY_2\")));\n                    return;\n                }\n\n                // Si la rponse contenait une exception renvoye par le service, on appelle le callback d'erreur\n                if (data.exceptionReport) {\n                    options.onError.call(options.scope, new __WEBPACK_IMPORTED_MODULE_2__Exceptions_ErrorService__[\"a\" /* default */]({\n                        message : __WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__[\"a\" /* default */].getMessage(\"SERVICE_RESPONSE_EXCEPTION\", data.exceptionReport),\n                        type : __WEBPACK_IMPORTED_MODULE_2__Exceptions_ErrorService__[\"a\" /* default */].TYPE_SRVERR,\n                        status : 200\n                    }));\n                    return;\n                }\n            }\n\n        } else {\n            // si la rponse (xmlString) est vide, on appelle le callback d'erreur\n            options.onError.call(options.scope, new __WEBPACK_IMPORTED_MODULE_2__Exceptions_ErrorService__[\"a\" /* default */](__WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__[\"a\" /* default */].getMessage(\"SERVICE_RESPONSE_EMPTY\")));\n            return;\n        }\n\n        // dfinition de la variable globale Gp.Config  partir de la rponse\n        var scope = typeof window !== \"undefined\" ? window : {};\n\n        if (!scope.Gp) {\n            scope.Gp = {};\n        }\n        if (!scope.Gp.Config) {\n            scope.Gp.Config = data;\n        } else {\n            this.mergeConfig(scope.Gp.Config, data, options.layerId);\n        }\n\n        // si tout s'est bien pass, on appelle le callback de succs\n        options.onSuccess.call(options.scope, scope.Gp.Config);\n        return;\n    },\n\n    /**\n     * Fonction utilise dans le cas o l'autoconfiguration est appele plusieurs fois\n     * (par exemple pour des cls diffrentes ou pour des infos sur une couche agrge)\n     *\n     * @method mergeConfig\n     * @static\n     * @param {Object} GpConfig - Variable Gp.Config prexistante\n     * @param {Object} data - la nouvelle rponse de l'autoconf,  fusionner avec GpConfig\n     * @param {String} [layerId] - l'identifiant d'une couche agrge dans le cas d'une 2 opration de l'autoconf\n     */\n    mergeConfig : function (GpConfig, data, layerId) {\n\n        if (data && GpConfig) {\n\n            // on boucle sur les proprits (generalOptions, layers, projections, services, tileMatrixSets, territories)\n            for (var prop in data) {\n                if (data.hasOwnProperty(prop)) {\n                    // on rcupre la nouvelle cl dans generalOptions\n                    if (prop == \"generalOptions\") {\n                        for (var key in data[prop].apiKeys) {\n                            if (data[prop].apiKeys.hasOwnProperty(key) && !GpConfig.generalOptions.apiKeys[key]) {\n                                GpConfig.generalOptions.apiKeys[key] = data[prop].apiKeys[key];\n                            }\n                        }\n                        // on rcupre les nouveaux objets (TMS, layers, projections...)\n                    } else {\n                        if (GpConfig[prop]) {\n                            for (var obj in data[prop]) {\n                                if (data[prop].hasOwnProperty(obj) && !GpConfig[prop][obj]) {\n                                    GpConfig[prop][obj] = data[prop][obj];\n                                }\n                            }\n                        }\n                    }\n                }\n            }\n\n            // dans le cas d'une autoconf pour une couche agrge, on rcupre l'info\n            if (layerId) {\n                var aggregatedLayers = [];\n\n                for (var lyr in data.layers) {\n                    if (data.layers.hasOwnProperty(lyr)) {\n                        aggregatedLayers.push(lyr);\n                    }\n                }\n\n                if (GpConfig.layers[layerId]) {\n                    GpConfig.layers[layerId].aggregatedLayers = aggregatedLayers;\n                }\n            }\n        }\n    }\n};\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (AutoConfReponseFactory);\n\n\n/***/ }),\n/* 62 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__Response_model_AutoConfResponse__ = __webpack_require__(24);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__Response_model_Constraint__ = __webpack_require__(25);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__Response_model_Format__ = __webpack_require__(26);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__Response_model_Layer__ = __webpack_require__(27);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__Response_model_Legend__ = __webpack_require__(28);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__Response_model_Metadata__ = __webpack_require__(29);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7__Response_model_Originator__ = __webpack_require__(30);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8__Response_model_Service__ = __webpack_require__(31);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_9__Response_model_Style__ = __webpack_require__(32);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_10__Response_model_Territory__ = __webpack_require__(33);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_11__Response_model_Thematic__ = __webpack_require__(34);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_12__Response_model_TileMatrixSet__ = __webpack_require__(35);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_13__Response_model_TileMatrix__ = __webpack_require__(36);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_14__Response_model_TileMatrixLimit__ = __webpack_require__(37);\n\n/**\n * Fonction retournant un objet contenant des cls de lecture (readers)\n *      qui permettent de parser des rponses XML du service d'autoconfiguration du Goportail\n *      afin de rcuprer les informations retournes.\n * @module AutoConfResponseReader\n * @private\n * @alias Gp.Services.AutoConf.Formats.AutoConfResponseReader\n */\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nvar AutoConfResponseReader = {};\n\n/**\n * version du service d'autoconf\n */\nAutoConfResponseReader.VERSION = \"1.1.0\";\n\n/**\n * Objet stockant les diffrents namespaces et les URI associes\n */\nAutoConfResponseReader.NAMESPACES = {\n    xmlns : \"http://www.opengis.net/context\",\n    gpp : \"http://api.ign.fr/geoportail\",\n    ows : \"http://www.opengis.net/ows/1.1\",\n    sld : \"http://www.opengis.net/sld\",\n    wmts : \"http://www.opengis.net/wmts/1.0\",\n    xlink : \"http://www.w3.org/1999/xlink\",\n    xsi : \"http://www.w3.org/2001/XMLSchema-instance\"\n};\n\n/**\n * Localisation (URL) du schema de dfinition du XML (XSD)\n */\nAutoConfResponseReader.SCHEMALOCATION = [\n    \"http://www.opengis.net/context http://gpp3-wxs.ign.fr/schemas/extContext.xsd http://api.ign.fr/geoportail http://wxs.ign.fr/schemas/autoconf/autoconf.xsd\",\n    \"http://www.opengis.net/context http://gpp3-wxs.ign.fr/schemas/extContext.xsd http://api.ign.fr/geoportail http://gpp3-wxs.ign.fr/schemas/autoconf.xsd\"\n];\n\n/**\n * Namespace par dfaut du format\n */\nAutoConfResponseReader.DEFAULTPREFIX = \"context\";\n\n/**\n * Objet contenant des fonctions de lecture, appeles \"READERS\"\n *      dont chaque cl correspond au nom d'un tag du XML que l'on souhaite lire\n *      et la valeur associe est une fonction (node, data)\n *      o node est un noeud du document DOM\n *      et data est un objet o l'on stocke les informations lues dans le XML.\n */\nAutoConfResponseReader.READERS = {\n\n    context : {\n\n        /** ViewContext */\n        ViewContext : function (viewContextNode) {\n            // info : balise \"racine\" de la rponse de l'autoconf\n\n            // vrification de la version du service, et des namespaces de l'en-tte\n            __checkServiceAttributes(viewContextNode);\n\n            // create AutoConfResponse\n            var config = new __WEBPACK_IMPORTED_MODULE_1__Response_model_AutoConfResponse__[\"a\" /* default */]();\n\n            __getChildNodes(viewContextNode, config);\n\n            return config;\n        },\n\n        // info : /General/Title\n        // ou : /LayerList/Layer/Title\n        /** Title */\n        Title : function (titleNode, data) {\n            if (data && data.generalOptions) { // cas de la variable config gnrale\n                data.generalOptions.title = __getChildValue(titleNode);\n            } else if (data && data.lyr) { // cas d'une layer\n                data.lyr.title = __getChildValue(titleNode);\n            }\n        },\n\n        // info : /LayerList/Layer/Abstract\n        /** Abstract */\n        Abstract : function (node, data) {\n            if (data && data.lyr) {\n                data.lyr.description = __getChildValue(node);\n            }\n        },\n\n        // info : /General/Extension/gpp:General/gpp:Services/Server\n        // ou : /LayerList/Server\n        /** Server */\n        Server : function (node, data) {\n            var serverId = node.getAttribute(\"service\");\n            var title = node.getAttribute(\"title\");\n            var version = node.getAttribute(\"version\");\n            if (serverId) {\n                if (data && data.services && typeof data.services === \"object\" && !data.services[serverId]) {\n                    // on est dans la balise Services\n                    var s = new __WEBPACK_IMPORTED_MODULE_8__Response_model_Service__[\"a\" /* default */]();\n                    s.title = title;\n                    s.version = version;\n                    // rcupration de l'url du service, dans une balise enfant \"OnlineResource\"\n                    __getChildNodes(node, s);\n                    // ajout du service  la variable config\n                    data.services[serverId] = s;\n                } else if (data && data.lyr) {\n                    // on est dans la balise Layer\n                    if (!data.lyr.serviceParams) {\n                        // si l'objet serviceParams n'a pas encore t cr, on le cre.\n                        data.lyr.serviceParams = {};\n                    }\n                    data.lyr.serviceParams.id = serverId;\n                    data.lyr.serviceParams.version = version;\n                }\n            }\n        },\n\n        // info : /General/Extension/gpp:General/gpp:Services/Server/OnlineResource\n        // ou : /LayerList/Layer/Server/OnlineResource\n        // ou : /LayerList/Layer/Extention/gpp:Layer/gpp:QuickLook/OnlineResource\n        // ou : /LayerList/Layer/Extension/gpp:Layer/gpp:Legends/gpp:Legend/gpp:LegendURL/OnlineResource\n        // ou : /LayerList/Layer/Extension/gpp:Layer/gpp:MetadataURL/OnlineResource\n        /** OnlineResource */\n        OnlineResource : function (node, service) {\n            if (service && service.hasOwnProperty(\"serverUrl\")) {\n                service.serverUrl = node.getAttribute(\"xlink:href\");\n            }\n        },\n\n        // info : /LayerList\n        /** LayerList */\n        LayerList : function (layerListNode, config) {\n            // liste de balises \"layer\"\n            __getChildNodes(layerListNode, config);\n\n            if (config && config.layers && config.generalOptions && config.services) {\n                // rcupration des cls et des couches associes\n                for (var lyr in config.layers) {\n                    if (config.layers.hasOwnProperty(lyr)) {\n                        var layerConfig = config.layers[lyr];\n\n                        // rcupration de la cl associe\n                        var apiKeys = layerConfig.apiKeys;\n                        if (apiKeys && Array.isArray(apiKeys)) {\n                            for (var i = 0; i < apiKeys.length; i++) {\n                                // pour chaque cl API, on ajoute la couche\n                                var key = apiKeys[i];\n                                if (config.generalOptions.apiKeys) {\n                                    if (!config.generalOptions.apiKeys[key] || !Array.isArray(config.generalOptions.apiKeys[key])) {\n                                        config.generalOptions.apiKeys[key] = [];\n                                    }\n                                    config.generalOptions.apiKeys[key].push(lyr);\n                                }\n                            }\n                        }\n\n                        // rcupration du service associ\n                        var serviceParams = layerConfig.serviceParams;\n                        if (serviceParams && serviceParams.id) {\n                            if (!config.services[serviceParams.id]) {\n                                var s = new __WEBPACK_IMPORTED_MODULE_8__Response_model_Service__[\"a\" /* default */]();\n                                if (serviceParams.serverUrl) {\n                                    s.serverUrl = serviceParams.serverUrl;\n                                }\n                                if (serviceParams.version) {\n                                    s.version = serviceParams.version;\n                                }\n                                config.services[serviceParams.id] = s;\n                            }\n                        }\n\n                        // rcupration de la projection associe (dans le cas d'une couche WMTS)\n                        if (layerConfig.wmtsOptions && layerConfig.wmtsOptions.tileMatrixSetLink && config.tileMatrixSets) {\n                            var tmsLink = layerConfig.wmtsOptions.tileMatrixSetLink;\n                            var tileMatrixSets = config.tileMatrixSets;\n                            for (var tms in tileMatrixSets) {\n                                if (tileMatrixSets.hasOwnProperty(tms) && tms === tmsLink) {\n                                    layerConfig.defaultProjection = tileMatrixSets[tms].projection;\n                                }\n                            }\n                        }\n                    }\n                }\n            }\n        },\n\n        // info : /LayerList/Layer\n        /** Layer */\n        Layer : function (layerNode, config) {\n            if (config && config.layers) {\n                var lyrData = {\n                    lyr : new __WEBPACK_IMPORTED_MODULE_4__Response_model_Layer__[\"a\" /* default */](),\n                    lyrId : null\n                };\n\n                var hidden = layerNode.getAttribute(\"hidden\");\n                if (hidden === \"1\") {\n                    lyrData.lyr.hidden = true;\n                } else {\n                    lyrData.lyr.hidden = false;\n                }\n\n                var queryable = layerNode.getAttribute(\"queryable\");\n                if (queryable === \"1\") {\n                    lyrData.lyr.queryable = true;\n                } else {\n                    lyrData.lyr.queryable = false;\n                }\n\n                // on peut avoir les balises : Server, Name, Title, Abstract, DataURL, MetadataURL,\n                // sld:MinScaleDenominator, sld:MaxScaleDenominator, SRS, FormatList, StyleList\n                // DimensionList, Extension\n                __getChildNodes(layerNode, lyrData);\n\n                // si on a bien rcupr l'identifiant de la couche, on s'en sert pour l'ajouter au tableau associatif des couches disponibles\n                if (lyrData.lyrId) {\n                    // Dans le cas des services, on modifie le contexte de l'identifiant.\n                    if (lyrData.lyr.serviceParams && lyrData.lyr.serviceParams.id) {\n                        var serviceid = lyrData.lyr.serviceParams.id;\n                        if (serviceid.toUpperCase().indexOf(\"OPENLS\") !== -1 || serviceid.toUpperCase().indexOf(\"ELEVATION\") !== -1) {\n                            // Il faut changer l'identifiant de la ressource.\n                            var resourceId = lyrData.lyrId.split(\"$\")[0];\n                            lyrData.lyrId = resourceId + \"$\" + serviceid;\n                        }\n                    }\n\n                    // on ajoute l'information dans les attributs de la couche\n                    lyrData.lyr.layerId = lyrData.lyrId;\n                    // et dans le tableau Gp.Config.layers\n                    config.layers[lyrData.lyrId] = lyrData.lyr;\n                }\n            }\n        },\n\n        // info : /LayerList/Layer/Name\n        /** TODO : jsdoc block */\n        Name : function (node, lyrData) {\n            if (lyrData && lyrData.lyr) {\n                lyrData.lyr.name = __getChildValue(node);\n            }\n        },\n\n        // info : /LayerList/Layer/SRS (dans le cas des couches WMS ou WFS)\n        /** TODO : jsdoc block */\n        SRS : function (node, lyrData) {\n            // on rcupre la projection de la couche (SRS)\n            if (lyrData && lyrData.lyr) {\n                lyrData.lyr.defaultProjection = __getChildValue(node);\n            }\n        },\n\n        // info : /LayerList/Layer/FormatList/Format\n        /** TODO : jsdoc block */\n        Format : function (node, lyrData) {\n            if (lyrData && lyrData.lyr) {\n                var f = new __WEBPACK_IMPORTED_MODULE_3__Response_model_Format__[\"a\" /* default */]();\n                var current = node.getAttribute(\"current\");\n                if (current === \"1\") {\n                    f.current = true;\n                } else {\n                    f.current = false;\n                }\n                f.name = __getChildValue(node);\n                // si on n'a pas encore ajout de format, on cre le tableau vide\n                if (!lyrData.lyr.formats || !Array.isArray(lyrData.lyr.formats)) {\n                    lyrData.lyr.formats = [];\n                }\n                lyrData.lyr.formats.push(f);\n            }\n        },\n\n        // info : /LayerList/Layer/StyleList/Style\n        /** TODO : jsdoc block */\n        Style : function (node, lyrData) {\n            if (lyrData && lyrData.lyr) {\n                var s = new __WEBPACK_IMPORTED_MODULE_9__Response_model_Style__[\"a\" /* default */]();\n                var current = node.getAttribute(\"current\");\n                if (current === \"1\" || current === 1) {\n                    s.current = true;\n                } else {\n                    s.current = false;\n                }\n                if (node.hasChildNodes) {\n                    var children = node.childNodes;\n                    var child;\n                    var childName;\n                    for (var i = 0; i < children.length; i++) {\n                        child = children[i];\n                        if (child.nodeType === 1) { // 1 == node.ELEMENT_NODE\n                            childName = child.localName || child.baseName || child.nodeName;\n                            if (childName === \"Name\") {\n                                s.name = __getChildValue(child);\n                            } else if (childName === \"Title\") {\n                                s.title = __getChildValue(child);\n                            }\n                        }\n                    }\n                }\n                // si on n'a pas encore ajout de style, on cre le tableau vide\n                if (!lyrData.lyr.styles || !Array.isArray(lyrData.lyr.styles)) {\n                    lyrData.lyr.styles = [];\n                }\n                lyrData.lyr.styles.push(s);\n            }\n        },\n\n        // info : /LayerList/Layer/DimensionList/Dimension\n        /** TODO : jsdoc block */\n        Dimension : function (node, lyrData) {\n            // possde des attributs obligatoires : name, units, unitSymbol et userValue\n            // et d'autres attributs facultatifs : default, multipleValues, nearestValue, current\n            var name = node.getAttribute(\"name\");\n            var dim = __getChildValue(node);\n            if (lyrData && lyrData.lyr) {\n                // si on n'a pas encore ajout de dimension, on cre l'objet vide\n                if (!lyrData.lyr.dimensions) {\n                    lyrData.lyr.dimensions = {};\n                }\n                if (name === \"Type\") {\n                    lyrData.lyr.dimensions.type = dim;\n                } else if (name === \"VisibilityRange\") {\n                    lyrData.lyr.dimensions.visibilityRange = dim;\n                } else if (name === \"VisibilityMode \") {\n                    lyrData.lyr.dimensions.visibilityMode = dim;\n                } else if (name === \"GeometricType\") {\n                    lyrData.lyr.dimensions.geometricType = dim;\n                } else if (name === \"NoDataValue\") {\n                    lyrData.lyr.dimensions.noDataValue = dim;\n                }\n            }\n        }\n\n    },\n\n    gpp : {\n\n        // info : /General/Extension/gpp:General/gpp:Theme\n        /** TODO : jsdoc block */\n        Theme : function (themeNode, config) {\n            if (config && config.generalOptions && config.generalOptions.hasOwnProperty(\"theme\")) {\n                config.generalOptions.theme = __getChildValue(themeNode);\n            }\n        },\n\n        // info : /General/Extension/gpp:General/gpp:defaultGMLGFIStyleUrl\n        /** TODO : jsdoc block */\n        defaultGMLGFIStyleUrl : function (node, config) {\n            if (config && config.generalOptions && config.generalOptions.hasOwnProperty(\"defaultGMLGFIStyle\")) {\n                config.generalOptions.defaultGMLGFIStyle = __getChildValue(node);\n            }\n        },\n\n        // info : /General/Extension/gpp:General/gpp:Territories/gpp:Territory\n        /** TODO : jsdoc block */\n        Territory : function (territoryNode, config) {\n            // info : Information to configure the API for this territory\n            var tid = territoryNode.getAttribute(\"id\");\n            if (tid) {\n                // create a new Territory\n                var t = new __WEBPACK_IMPORTED_MODULE_10__Response_model_Territory__[\"a\" /* default */]();\n\n                var isDefault = territoryNode.getAttribute(\"default\");\n                if (isDefault === \"1\") {\n                    t.isDefault = true;\n                } else {\n                    t.isDefault = false;\n                }\n                // read territory informations\n                __getChildNodes(territoryNode, t);\n                // add territory to config\n                if (config && config.territories && typeof config.territories === \"object\") {\n                    config.territories[tid] = t;\n                }\n            }\n        },\n\n        // info : /General/Extension/gpp:General/gpp:Territories/gpp:Territory/gpp:defaultCRS\n        /** TODO : jsdoc block */\n        defaultCRS : function (node, territory) {\n            // info : Identifier for the default Coordinate Reference System (CRS).\n            if (territory && territory.hasOwnProperty(\"defaultCRS\")) {\n                territory.defaultCRS = __getChildValue(node);\n            }\n        },\n\n        // info : /General/Extension/gpp:General/gpp:Territories/gpp:Territory/gpp:AdditionalCRS\n        // ou : /LayerList/Extension/gpp:Layer/gpp:AdditionalCRS\n        /** TODO : jsdoc block */\n        AdditionalCRS : function (node, data) {\n            // info : Identifier for additional Coordinate Reference System (CRS).\n            // info : data peut tre une instance de Territory.js, ou une instance de Layer.js\n            var addCRS = __getChildValue(node);\n            if (addCRS && data) {\n                if (Array.isArray(data.additionalCRS)) { // cas d'un territoire\n                    data.additionalCRS.push(addCRS);\n                } else { // cas d'une couche\n                    // si le tableau n'est pas encore cr\n                    if (!data.additionalProjections || !Array.isArray(data.additionalProjections)) {\n                        data.additionalProjections = [];\n                    }\n                    data.additionalProjections.push(addCRS);\n                }\n            }\n        },\n\n        // info : /General/Extension/gpp:General/gpp:Territories/gpp:Territory/gpp:DefaultLayer\n        /** TODO : jsdoc block */\n        DefaultLayer : function (node, territory) {\n            var lyr = node.getAttribute(\"layerId\");\n            if (lyr && territory && Array.isArray(territory.defaultLayers)) {\n                territory.defaultLayers.push(lyr);\n            }\n        },\n\n        // info : /General/Extension/gpp:General/gpp:Territories/gpp:Territory/gpp:BoundingBox\n        // ou : /LayerList/Extension/gpp:Layer/gpp:BoundingBox\n        // ou : /LayerList/Layer/Extension/gpp:Layer/gpp:Constraints/gpp:Constraint/gpp:BoundingBox\n        // ou : /LayerList/Extension/gpp:Layer/gpp:Originators/gpp:Originator/gpp:Constraints/gpp:Constraint/gpp:BoundingBox\n        /** TODO : jsdoc block */\n        BoundingBox : function (node, data) {\n            if (data) {\n                var values = __getChildValue(node).split(\",\");\n                if (values.length === 4) {\n\n                    // get bbox coordinates (wgs84)\n                    var bbox = {\n                        left : parseFloat(values[0]),\n                        right : parseFloat(values[2]),\n                        top : parseFloat(values[3]),\n                        bottom : parseFloat(values[1])\n                    };\n                    // get temporal extent params (constraint or layer)\n                    var minT = node.getAttribute(\"minT\");\n                    var maxT = node.getAttribute(\"maxT\");\n\n                    if (data.hasOwnProperty(\"geoBBOX\")) { // cas d'un territoire\n                        data.geoBBOX = bbox;\n\n                    } else if (data.hasOwnProperty(\"bbox\")) { // cas d'une constraint\n                        if (data.bbox.left || data.bbox.right || data.bbox.top || data.bbox.bottom) {\n                            // si on a dj une bbox, il faut stocker d'autres contraintes\n                            if (!data.multiConstraints) {\n                                data.multiConstraints = [];\n                            }\n                            var newConstraint = new __WEBPACK_IMPORTED_MODULE_2__Response_model_Constraint__[\"a\" /* default */]();\n                            newConstraint.bbox = bbox;\n                            newConstraint.temporalExtent = [minT, maxT];\n                            data.multiConstraints.push(newConstraint);\n\n                        } else {\n                            // contrainte classique\n                            data.bbox = bbox;\n                            data.temporalExtent = [minT, maxT];\n                        }\n\n                    } else { // cas d'une layer\n                        if (!data.globalConstraint) {\n                            data.globalConstraint = new __WEBPACK_IMPORTED_MODULE_2__Response_model_Constraint__[\"a\" /* default */]();\n                        }\n                        data.globalConstraint.bbox = bbox;\n                        data.globalConstraint.temporalExtent = [minT, maxT];\n                    }\n\n                }\n            }\n        },\n\n        // info : /General/Extension/gpp:General/gpp:Territories/gpp:Territory/gpp:Resolution\n        /** TODO : jsdoc block */\n        Resolution : function (node, territory) {\n            // info : The default resolution to display on this territory, in CRS coordinate system\n            var res = __getChildValue(node);\n            if (res && territory && territory.defaultOptions && territory.defaultOptions.hasOwnProperty(\"resolution\")) {\n                territory.defaultOptions.resolution = parseFloat(res);\n            }\n        },\n\n        // info : /General/Extension/gpp:General/gpp:Territories/gpp:Territory/gpp:Center/gpp:x\n        /** TODO : jsdoc block */\n        x : function (node, territory) {\n            var lon = __getChildValue(node);\n            if (lon && territory && territory.geoCenter && territory.geoCenter.hasOwnProperty(\"lon\")) {\n                territory.geoCenter.lon = parseFloat(lon);\n            }\n        },\n\n        // info : /General/Extension/gpp:General/gpp:Territories/gpp:Territory/gpp:Center/gpp:y\n        /** TODO : jsdoc block */\n        y : function (node, territory) {\n            var lat = __getChildValue(node);\n            if (lat && territory && territory.geoCenter && territory.geoCenter.hasOwnProperty(\"lat\")) {\n                territory.geoCenter.lat = parseFloat(lat);\n            }\n        },\n\n        // info : /General/Extension/gpp:General/gpp:Resolutions\n        /** TODO : jsdoc block */\n        Resolutions : function (resNode, config) {\n            // info : List of resolutions in CRS:84 (comma separated values)\n            if (config && config.generalOptions && config.generalOptions.hasOwnProperty(\"wgs84Resolutions\")) {\n                config.generalOptions.wgs84Resolutions = __getChildValue(resNode).split(\",\");\n            }\n        },\n\n        // info : /LayerList/Layer/Extension/gpp:Layer\n        /** TODO : jsdoc block */\n        Layer : function (node, lyrData) {\n            // attributs : id, opacity, order, visibleInCatalog, aggregate, more\n            if (lyrData && lyrData.hasOwnProperty(\"lyrId\") && lyrData.lyr) {\n                lyrData.lyrId = node.getAttribute(\"id\");\n                var aggregate = node.getAttribute(\"aggregate\");\n                var more = node.getAttribute(\"more\");\n                if (aggregate || more) {\n                    lyrData.lyr.isAggregate = true;\n                }\n                __getChildNodes(node, lyrData.lyr);\n            }\n        },\n\n        // info : /LayerList/Layer/Extension/gpp:Layer/gpp:Constraints/gpp:Constraint\n        // ou : /LayerList/Extension/gpp:Layer/gpp:Originators/gpp:Originator/gpp:Constraints/gpp:Constraint\n        /** TODO : jsdoc block */\n        Constraint : function (node, data) {\n            var c = new __WEBPACK_IMPORTED_MODULE_2__Response_model_Constraint__[\"a\" /* default */]();\n            __getChildNodes(node, c);\n            if (data) {\n\n                // on peut tre dans le cas d'un originator ou d'une layer, tous les deux ont l'attribut constraints\n                if (!data.constraints || !Array.isArray(data.constraints)) {\n                    data.constraints = [];\n                }\n\n                // cas de plusieurs contraintes (par ex diffrents territoires)\n                if (c.multiConstraints && Array.isArray(c.multiConstraints)) {\n\n                    // on rcupre la premire contrainte, stocke normalement\n                    var constraint = new __WEBPACK_IMPORTED_MODULE_2__Response_model_Constraint__[\"a\" /* default */]();\n                    constraint.crs = c.crs;\n                    constraint.bbox = c.bbox;\n                    constraint.minScaleDenominator = c.minScaleDenominator;\n                    constraint.maxScaleDenominator = c.maxScaleDenominator;\n                    constraint.temporalExtent = c.temporalExtent;\n                    data.constraints.push(constraint);\n\n                    // puis on rcupre les autres contraintes,  partir de multiConstraints\n                    for (var i = 0; i < c.multiConstraints.length; i++) {\n                        constraint = new __WEBPACK_IMPORTED_MODULE_2__Response_model_Constraint__[\"a\" /* default */]();\n                        constraint.crs = c.crs;\n                        constraint.minScaleDenominator = c.minScaleDenominator;\n                        constraint.maxScaleDenominator = c.maxScaleDenominator;\n                        constraint.bbox = c.multiConstraints[i].bbox;\n                        constraint.temporalExtent = c.multiConstraints[i].temporalExtent;\n                        data.constraints.push(constraint);\n                    }\n                } else {\n                    // cas d'une contrainte classique\n                    data.constraints.push(c);\n                }\n            }\n        },\n\n        // info : /LayerList/Layer/Extension/gpp:Layer/gpp:Originators/gpp:Originator/gpp:Constraints/gpp:Constraint/gpp:CRS\n        // ou : /LayerList/Layer/Extension/gpp:Layer/gpp:Constraints/gpp:Constraint/gpp:CRS\n        /** TODO : jsdoc block */\n        CRS : function (node, data) {\n            // nothing to do.\n            if (data && data.hasOwnProperty(\"crs\")) {\n                data.crs = __getChildValue(node);\n            }\n        },\n\n        // info : /LayerList/Layer/Extension/gpp:Layer/gpp:Thematics/gpp:Thematic\n        /** TODO : jsdoc block */\n        Thematic : function (node, lyr) {\n            if (lyr) {\n                var t = new __WEBPACK_IMPORTED_MODULE_11__Response_model_Thematic__[\"a\" /* default */]();\n                t.inspire = false;\n                t.name = __getChildValue(node);\n                // si aucune thmatique n'a t ajoute, on cre le tableau vide\n                if (!lyr.thematics || !Array.isArray(lyr.thematics)) {\n                    lyr.thematics = [];\n                }\n                lyr.thematics.push(t);\n            }\n        },\n\n        // info : /LayerList/Layer/Extension/gpp:Layer/gpp:Thematics/gpp:InspireThematic\n        /** TODO : jsdoc block */\n        InspireThematic : function (node, lyr) {\n            if (lyr) {\n                var t = new __WEBPACK_IMPORTED_MODULE_11__Response_model_Thematic__[\"a\" /* default */]();\n                t.inspire = true;\n                t.name = __getChildValue(node);\n                // si aucune thmatique n'a t ajoute, on cre le tableau vide\n                if (!lyr.thematics || !Array.isArray(lyr.thematics)) {\n                    lyr.thematics = [];\n                }\n                lyr.thematics.push(t);\n            }\n        },\n\n        // info : /LayerList/Layer/Extension/gpp:Layer/gpp:Originators/gpp:Originator\n        /** TODO : jsdoc block */\n        Originator : function (node, lyr) {\n            if (lyr) {\n                // info : contient des balises Attribution, Logo, URL, et Constraints\n                var o = new __WEBPACK_IMPORTED_MODULE_7__Response_model_Originator__[\"a\" /* default */]();\n                o.name = node.getAttribute(\"name\");\n                __getChildNodes(node, o);\n                // si aucun originator n'a t ajout, on cre le tableau vide\n                if (!lyr.originators || !Array.isArray(lyr.originators)) {\n                    lyr.originators = [];\n                }\n                lyr.originators.push(o);\n            }\n        },\n\n        // info : /LayerList/Layer/Extension/gpp:Layer/gpp:Originators/gpp:Originator/gpp:Attribution\n        /** TODO : jsdoc block */\n        Attribution : function (node, originator) {\n            if (originator && originator.hasOwnProperty(\"attribution\")) {\n                originator.attribution = __getChildValue(node);\n            }\n        },\n\n        // info : /LayerList/Layer/Extension/gpp:Layer/gpp:Originators/gpp:Originator/gpp:Logo\n        /** TODO : jsdoc block */\n        Logo : function (node, originator) {\n            if (originator && originator.hasOwnProperty(\"logo\")) {\n                originator.logo = __getChildValue(node);\n            }\n        },\n\n        // info : /LayerList/Layer/Extension/gpp:Layer/gpp:Originators/gpp:Originator/gpp:URL\n        /** TODO : jsdoc block */\n        URL : function (node, originator) {\n            if (originator && originator.hasOwnProperty(\"url\")) {\n                originator.url = __getChildValue(node);\n            }\n        },\n\n        // info : /LayerList/Layer/Extension/gpp:Layer/gpp:Legends/gpp:Legend\n        /** TODO : jsdoc block */\n        Legend : function (node, lyr) {\n            // 2 balises : sld:MinScaleDenominator et gpp:LegendURL\n            var l = new __WEBPACK_IMPORTED_MODULE_5__Response_model_Legend__[\"a\" /* default */]();\n            __getChildNodes(node, l);\n            if (lyr) {\n                // si aucune lgende n'a encore t ajoute, on cre le tableau vide\n                if (!lyr.legends || !Array.isArray(lyr.legends)) {\n                    lyr.legends = [];\n                }\n                lyr.legends.push(l);\n            }\n        },\n\n        // info : /LayerList/Layer/Extension/gpp:Layer/gpp:Legends/gpp:Legend/gpp:LegendURL\n        /** TODO : jsdoc block */\n        LegendURL : function (node, legend) {\n            if (legend && legend.hasOwnProperty(\"format\")) {\n                legend.format = node.getAttribute(\"format\");\n                if (node.hasChildNodes) {\n                    var child = node.childNodes[0];\n                    var childName = child.localName || child.baseName || child.nodeName;\n                    if (childName === \"OnlineResource\" && legend.hasOwnProperty(\"url\")) {\n                        legend.url = child.getAttribute(\"xlink:href\");\n                    }\n                }\n            }\n        },\n\n        // info : /LayerList/Layer/Extension/gpp:Layer/gpp:QuickLook\n        /** TODO : jsdoc block */\n        QuickLook : function (node, lyr) {\n            // info : contient une balise OnlineResource avec l'url dans l'attribut \"xlink:href\"\n            if (node.hasChildNodes) {\n                var child = node.childNodes[0];\n                var childName = child.localName || child.baseName || child.nodeName;\n                if (childName === \"OnlineResource\" && lyr) {\n                    lyr.quicklookUrl = child.getAttribute(\"xlink:href\");\n                }\n            }\n        },\n\n        // info : /LayerList/Layer/Extension/gpp:Layer/gpp:MetadataURL\n        /** TODO : jsdoc block */\n        MetadataURL : function (node, lyr) {\n            if (lyr) {\n                // info : contient une balise OnlineResource avec l'url dans l'attribut \"xlink:href\"\n                var m = new __WEBPACK_IMPORTED_MODULE_6__Response_model_Metadata__[\"a\" /* default */]();\n                m.format = node.getAttribute(\"format\");\n                if (node.hasChildNodes) {\n                    var child = node.childNodes[0];\n                    var childName = child.localName || child.baseName || child.nodeName;\n                    if (childName === \"OnlineResource\") {\n                        m.url = child.getAttribute(\"xlink:href\");\n                    }\n                }\n                // si aucune metadata n'a t ajoute, on cre le tableau vide\n                if (!lyr.metadata && !Array.isArray(lyr.metadata)) {\n                    lyr.metadata = [];\n                }\n                lyr.metadata.push(m);\n            }\n        },\n\n        // info : /LayerList/Layer/Extension/gpp:Layer/gpp:Keys/gpp:Key\n        /** TODO : jsdoc block */\n        Key : function (node, lyr) {\n            if (lyr) {\n\n                // rcupration de la cl API\n                var key = node.getAttribute(\"id\");\n                // si on n'a pas encore ajout de cl, on cre le tableau vide\n                if (!lyr.apiKeys || !Array.isArray(lyr.apiKeys)) {\n                    lyr.apiKeys = [];\n                }\n                lyr.apiKeys.push(key);\n\n                // rcupration de l'url du service avec la cl API\n                var serverUrl = __getChildValue(node);\n                if (!lyr.serviceParams) {\n                    lyr.serviceParams = {};\n                }\n                if (!lyr.serviceParams.serverUrl) {\n                    lyr.serviceParams.serverUrl = {};\n                }\n                if (!lyr.serviceParams.serverUrl[key]) {\n                    lyr.serviceParams.serverUrl[key] = serverUrl;\n                }\n            }\n        }\n\n    },\n\n    ows : {\n        /** TODO : jsdoc block */\n        Identifier : function (node, data) {\n            if (data && data.hasOwnProperty(\"TMS\")) { // dans le cas d'un TileMatrixSet\n                data.identifier = __getChildValue(node);\n            } else if (data && data.hasOwnProperty(\"matrixId\")) { // dans le cas d'une TileMatrix\n                data.matrixId = __getChildValue(node);\n            }\n        },\n\n        /** TODO : jsdoc block */\n        SupportedCRS : function (node, tmsData) {\n            if (tmsData && tmsData.TMS && tmsData.TMS.hasOwnProperty(\"projection\")) {\n                tmsData.TMS.projection = __getChildValue(node);\n            }\n        }\n    },\n\n    sld : {\n        // info : /General/Extension/gpp:General/gpp:Territories/gpp:Territory/sld:MinScaleDenominator\n        // ou : /LayerList/Layer/sld:MinScaleDenominator\n        // ou : /LayerList/Layer/Extension/gpp:Layer/gpp:Originators/gpp:Originator/gpp:Constraints/sld:MinScaleDenominator\n        // ou : /LayerList/Layer/Extension/gpp:Layer/gpp:Legends/gpp:Legend/sld:MinScaleDenominator\n        /** TODO : jsdoc block */\n        MinScaleDenominator : function (node, data) {\n            var minScale = __getChildValue(node);\n            if (minScale && data) {\n                if (data.hasOwnProperty(\"defaultOptions\")) { // cas d'un territoire\n                    data.defaultOptions.minScaleDenominator = parseFloat(minScale);\n                } else if (data.lyr) { // cas d'une layer\n                    if (!data.lyr.globalConstraint) {\n                        data.lyr.globalConstraint = new __WEBPACK_IMPORTED_MODULE_2__Response_model_Constraint__[\"a\" /* default */]();\n                    }\n                    data.lyr.globalConstraint.minScaleDenominator = parseFloat(minScale);\n                } else if (data.hasOwnProperty(\"minScaleDenominator\")) { // cas d'une contrainte ou d'une lgende\n                    data.minScaleDenominator = parseFloat(minScale);\n                }\n            }\n        },\n\n        // info : /General/Extension/gpp:General/gpp:Territories/gpp:Territory/sld:MaxScaleDenominator\n        // ou : /LayerList/Layer/sld:MaxScaleDenominator\n        // ou : /LayerList/Layer/Extension/gpp:Layer/gpp:Originators/gpp:Originator/gpp:Constraints/sld:MaxScaleDenominator\n        /** TODO : jsdoc block */\n        MaxScaleDenominator : function (node, data) {\n            var maxScale = __getChildValue(node);\n            if (maxScale && data) {\n                if (data.hasOwnProperty(\"defaultOptions\")) { // cas d'un territoire\n                    data.defaultOptions.maxScaleDenominator = parseFloat(maxScale);\n                } else if (data.lyr) { // cas d'une layer\n                    if (!data.lyr.globalConstraint) {\n                        data.lyr.globalConstraint = new __WEBPACK_IMPORTED_MODULE_2__Response_model_Constraint__[\"a\" /* default */]();\n                    }\n                    data.lyr.globalConstraint.maxScaleDenominator = parseFloat(maxScale);\n                } else if (data.hasOwnProperty(\"maxScaleDenominator\")) { // cas d'une contrainte\n                    data.maxScaleDenominator = parseFloat(maxScale);\n                }\n            }\n        }\n    },\n\n    wmts : {\n\n        // info : /LayerList/Layer/Extension/gpp:Layer/wmts:TileMatrixSetLink/wmts:TileMatrixSetLimits\n        /** TODO : jsdoc block */\n        TileMatrixSetLimits : function (node, lyr) {\n            // info : contient des balises wmts:TileMatrixLimits\n            if (lyr) {\n                var limits = {};\n                // on rcupre les limites dans les balises TileMatrixLimits\n                __getChildNodes(node, limits);\n\n                if (!lyr.wmtsOptions) {\n                    lyr.wmtsOptions = {};\n                }\n                lyr.wmtsOptions.tileMatrixSetLimits = limits;\n            }\n        },\n\n        // info : /LayerList/Layer/Extension/gpp:Layer/wmts:TileMatrixSetLink/wmts:TileMatrixSetLimits/wmts:TileMatrixLimits\n        /** TODO : jsdoc block */\n        TileMatrixLimits : function (node, limits) {\n            var limit = new __WEBPACK_IMPORTED_MODULE_14__Response_model_TileMatrixLimit__[\"a\" /* default */]();\n            var limitId;\n            if (node.hasChildNodes) {\n                var children = node.childNodes;\n                for (var i = 0; i < children.length; i++) {\n                    var child = children[i];\n                    var childName = child.localName || child.baseName || child.nodeName;\n                    if (childName === \"TileMatrix\") {\n                        limitId = __getChildValue(child);\n                    } else if (childName === \"MinTileRow\") {\n                        limit.minTileRow = __getChildValue(child);\n                    } else if (childName === \"MaxTileRow\") {\n                        limit.maxTileRow = __getChildValue(child);\n                    } else if (childName === \"MinTileCol\") {\n                        limit.minTileCol = __getChildValue(child);\n                    } else if (childName === \"MaxTileCol\") {\n                        limit.maxTileCol = __getChildValue(child);\n                    }\n                }\n                if (limitId && limits && !limits[limitId]) {\n                    limits[limitId] = limit;\n                }\n            }\n        },\n\n        // info : /General/Extension/gpp:General/gpp:TileMatrixSets/wmts:TileMatrixSet\n        // ou : // info : /LayerList/Layer/Extension/gpp:Layer/wmts:TileMatrixSetLink/wmts:TileMatrixSet\n        /** TODO : jsdoc block */\n        TileMatrixSet : function (node, data) {\n            // info : Describes a particular set of tile matrices.\n\n            if (data && data.tileMatrixSets) { // les tileMatrixSets de General\n                // nouvel objet TileMatrixSet\n                var tmsData = {};\n                tmsData.TMS = new __WEBPACK_IMPORTED_MODULE_12__Response_model_TileMatrixSet__[\"a\" /* default */]();\n                tmsData.resolutions = [];\n\n                // lecture des informations du TMS\n                __getChildNodes(node, tmsData);\n\n                // rcupration des identifiants des niveaux de matrice (pour faciliter l'accs au WMTS via les API carto)\n                var tileMatrices = tmsData.TMS.tileMatrices;\n                for (var tm in tileMatrices) {\n                    if (tileMatrices.hasOwnProperty(tm)) {\n                        tmsData.TMS.matrixIds.push(tm);\n                    }\n                }\n\n                if (tmsData.TMS.getProjection() === \"IGNF:WGS84G\" || tmsData.TMS.getProjection() === \"EPSG:4326\") {\n                    if (data.generalOptions && Array.isArray(data.generalOptions.wgs84Resolutions)) {\n                        var wgs84Resolutions = data.generalOptions.wgs84Resolutions;\n                        for (var i = 0; i < wgs84Resolutions.length; i++) {\n                            // info : les rsolutions stockes dans wgs84Resolutions, issues de l'autoconf, sont des string\n                            tmsData.resolutions[i] = parseFloat(wgs84Resolutions[i]);\n                        }\n                    }\n                }\n\n                // tri des rsolutions (par ordre dcroissant cette fois)\n                if (Array.isArray(tmsData.resolutions) && tmsData.resolutions.sort !== undefined) {\n                    tmsData.resolutions.sort(\n                        function (x, y) {\n                            return y - x;\n                        }\n                    );\n                }\n                tmsData.TMS.nativeResolutions = tmsData.resolutions;\n\n                // ajout du TileMatrixSet  la variable config\n                data.tileMatrixSets[tmsData.identifier] = tmsData.TMS;\n\n            } else { // le TileMatrixSetLink d'une couche (layer)\n                if (data && !data.wmtsOptions) {\n                    data.wmtsOptions = {};\n                }\n                // ajout du lien vers le TMS\n                data.wmtsOptions.tileMatrixSetLink = __getChildValue(node);\n            }\n        },\n\n        // info : /General/Extension/gpp:General/gpp:TileMatrixSets/wmts:TileMatrixSet/wmts:TileMatrix\n        /** TODO : jsdoc block */\n        TileMatrix : function (node, tmsData) {\n            // info : Describes a particular tile matrix.\n\n            if (tmsData) {\n                // nouveau niveau de matrice : TileMatrix\n                var tileMatrix = new __WEBPACK_IMPORTED_MODULE_13__Response_model_TileMatrix__[\"a\" /* default */]();\n\n                // lecture des information du TileMatrix\n                __getChildNodes(node, tileMatrix);\n\n                // calcul de la rsolution associe au dnominateur d'chelle du niveau de pyramide, selon la projection.\n                if (tmsData.TMS && tmsData.TMS.getProjection()) {\n                    var proj = tmsData.TMS.getProjection();\n                    if (proj === \"EPSG:3857\" || proj === \"EPSG:2154\") {\n                        // calcul de la rsolution associe, en m/px\n                        // en se basant sur une \"taille standard de pixel\" de 0.28mm*0.28mm (standard WMTS 1.0)\n                        var r = tileMatrix.scaleDenominator * 0.00028;\n                        if (tmsData.resolutions && Array.isArray(tmsData.resolutions)) {\n                            tmsData.resolutions.push(r);\n                        }\n                    }\n                }\n\n                // ajout du TileMatrix au TileMatrixSet\n                if (tmsData.TMS && tmsData.TMS.tileMatrices) {\n                    tmsData.TMS.tileMatrices[tileMatrix.matrixId] = tileMatrix;\n                }\n            }\n        },\n\n        // info : /General/Extension/gpp:General/gpp:TileMatrixSets/wmts:TileMatrixSet/wmts:TileMatrix/wmts:ScaleDenominator\n        /** TODO : jsdoc block */\n        ScaleDenominator : function (node, tileMatrix) {\n            var scale = __getChildValue(node);\n            if (scale && tileMatrix && tileMatrix.hasOwnProperty(\"scaleDenominator\")) {\n                tileMatrix.scaleDenominator = parseFloat(scale);\n            }\n        },\n\n        // info : /General/Extension/gpp:General/gpp:TileMatrixSets/wmts:TileMatrixSet/wmts:TileMatrix/wmts:TopLeftCorner\n        /** TODO : jsdoc block */\n        TopLeftCorner : function (node, tileMatrix) {\n            var values = __getChildValue(node).split(\" \");\n            if (values && tileMatrix) {\n                tileMatrix.topLeftCorner = {};\n                tileMatrix.topLeftCorner.x = parseFloat(values[0]);\n                tileMatrix.topLeftCorner.y = parseFloat(values[1]);\n            }\n        },\n\n        // info : /General/Extension/gpp:General/gpp:TileMatrixSets/wmts:TileMatrixSet/wmts:TileMatrix/wmts:TileWidth\n        /** TODO : jsdoc block */\n        TileWidth : function (node, tileMatrix) {\n            var value = __getChildValue(node);\n            if (value && tileMatrix && tileMatrix.hasOwnProperty(\"tileWidth\")) {\n                tileMatrix.tileWidth = parseInt(value, 10);\n            }\n        },\n\n        // info : /General/Extension/gpp:General/gpp:TileMatrixSets/wmts:TileMatrixSet/wmts:TileMatrix/wmts:TileHeight\n        /** TODO : jsdoc block */\n        TileHeight : function (node, tileMatrix) {\n            var value = __getChildValue(node);\n            if (value && tileMatrix && tileMatrix.hasOwnProperty(\"tileHeight\")) {\n                tileMatrix.tileHeight = parseInt(value, 10);\n            }\n        },\n\n        // info : /General/Extension/gpp:General/gpp:TileMatrixSets/wmts:TileMatrixSet/wmts:TileMatrix/wmts:MatrixWidth\n        /** TODO : jsdoc block */\n        MatrixWidth : function (node, tileMatrix) {\n            var value = __getChildValue(node);\n            if (value && tileMatrix && tileMatrix.hasOwnProperty(\"matrixWidth\")) {\n                tileMatrix.matrixWidth = parseInt(value, 10);\n            }\n        },\n\n        // info : /General/Extension/gpp:General/gpp:TileMatrixSets/wmts:TileMatrixSet/wmts:TileMatrix/wmts:MatrixHeight\n        /** TODO : jsdoc block */\n        MatrixHeight : function (node, tileMatrix) {\n            var value = __getChildValue(node);\n            if (value && tileMatrix && tileMatrix.hasOwnProperty(\"matrixHeight\")) {\n                tileMatrix.matrixHeight = parseInt(value, 10);\n            }\n        }\n    },\n\n    /** TODO : jsdoc block */\n    serviceException : function (node) {\n        var response = {};\n        if (node.hasChildNodes()) {\n            var children = node.childNodes;\n            var child;\n            for (var i = 0; i < children.length; i++) {\n                child = children[i];\n                if (child.nodeName === \"exception\") {\n                    response.exceptionReport = AutoConfResponseReader.READERS[\"exception\"](child);\n                }\n            }\n        }\n        return response;\n    },\n\n    /** TODO : jsdoc block */\n    exception : function (node) {\n        var exceptionReport = {};\n\n        // get exception code\n        var exceptionCode = node.getAttribute(\"code\");\n        if (exceptionCode) {\n            exceptionReport.exceptionCode = exceptionCode;\n        }\n\n        // get exception message\n        var textNode = node.firstChild;\n        if (textNode && textNode.nodeType === 3) { // 3 == node.TEXT_NODE\n            exceptionReport.exception = textNode.nodeValue;\n        }\n\n        return exceptionReport;\n    }\n\n};\n\n/**\n * Mthode permettant de lancer la lecture d'une rponse XML du service d'autoconf,\n *       l'aide des READERS de la classe.\n *\n * @method AutoConfResponseReader.read\n * @param {DOMElement} root - racine de la rponse XML  lire\n * @return {Object} config|exceptionReport : l'objet contenant les informations de la rponse XML,\n *      sous la forme d'un objet AutoConfResponse, ou un objet littral exceptionReport si le service a renvoy une exception.\n * @static\n * @memberof AutoConfResponseReader\n */\nAutoConfResponseReader.read = function (root) {\n\n    if (root.nodeName === \"ViewContext\") {\n        var nsPrefix = root.prefix || AutoConfResponseReader.DEFAULTPREFIX;\n        var config = AutoConfResponseReader.READERS[nsPrefix][root.nodeName](root);\n        return config;\n\n    } else if (root.nodeName === \"serviceException\") {\n        var exceptionReport = AutoConfResponseReader.READERS[root.nodeName](root);\n        return exceptionReport;\n\n    } else {\n        throw new Error(\"Erreur lors de la lecture de la rponse : elle n'est pas au format attendu.\");\n    }\n};\n\n/**\n * Rcupration des attributs d'un noeud lment\n *\n * @private\n * @memberof AutoConfResponseReader\n * @method __getAttributes\n * @param {DOMElement} node - noeud contenant l'attribut recherch\n * @return {Object} nodeAttributes - objet contenant les noms et valeurs des diffrents attributs\n */\nfunction __getAttributes (node) {\n    if (node.attributes.length > 0) {\n        var nodeAttributes = {};\n        var attributes = node.attributes;\n        for (var i = 0; i < attributes.length; i++) {\n            var attribute = attributes[i];\n            nodeAttributes[attribute.nodeName] = attribute.nodeValue;\n        }\n        return nodeAttributes;\n    }\n}\n\n/**\n * Rcupration des noeuds enfants (seulement de type ELEMENT),  partir d'un noeud donn, pour lecture (readNode).\n *\n * @private\n * @memberof AutoConfResponseReader\n * @method __getChildNodes\n * @param {DOMElement} node - a DOM node\n * @param {Array|Object} [data] - an object to be filled with node data\n */\nfunction __getChildNodes (node, data) {\n\n    if (node.hasChildNodes()) {\n\n        var children = node.childNodes;\n        var child;\n        var childName;\n        var childPrefix;\n\n        for (var i = 0; i < children.length; i++) {\n            child = children[i];\n\n            if (child.nodeType === 1) { // 1 == node.ELEMENT_NODE\n                childName = child.localName || child.baseName || child.nodeName;\n                childPrefix = child.prefix || AutoConfResponseReader.DEFAULTPREFIX;\n\n                if (AutoConfResponseReader.READERS[childPrefix][childName]) {\n                    var reader = AutoConfResponseReader.READERS[childPrefix][childName];\n                    reader(child, data);\n                } else {\n                    __getChildNodes(child, data);\n                }\n            }\n        }\n    }\n}\n\n/**\n * Lecture de la valeur du premier child d'un noeud, si elle existe.\n *\n * @private\n * @memberof AutoConfResponseReader\n * @method __getChildValue\n * @param {DOMElement} node - a DOM node\n * @return {String} value - valeur du firstChild du noeud en entre, ou chane vide.\n */\nfunction __getChildValue(node) {\n\n    var textNode;\n    var value = \"\";\n\n    if (node.hasChildNodes()) {\n        textNode = node.firstChild;\n        if (textNode.nodeType === 3 || textNode.nodeType === 4) { // 3 == node.TEXT_NODE\n            value = textNode.nodeValue;\n        }\n    }\n    return value;\n}\n\n/**\n * Vrification des attributs du service, dans la balise XLS de la rponse :\n *      version, namespaces, et namespace par dfaut doivent correspondre  ceux attendus.\n *\n * @private\n * @memberof AutoConfResponseReader\n * @method __checkServiceAttributes\n * @param {DOMElement} viewContextNode - a DOM node, corresponding to XLS first tag.\n */\nfunction __checkServiceAttributes (viewContextNode) {\n\n    if (viewContextNode.attributes.length > 0) {\n\n        // on rcupre et parcourt les attributs de la balise XLS de la rponse\n        var xlsAttributes = __getAttributes(viewContextNode);\n        for (var att in xlsAttributes) {\n            if (xlsAttributes.hasOwnProperty(att)) {\n\n                // vrification de la version\n                if (att === \"version\") {\n                    if (xlsAttributes[\"version\"] !== AutoConfResponseReader.VERSION) {\n                        console.log(\"[AutoConfResponseReader] autoconf version is not the expected one : there may be errors in parsing\");\n                        return;\n                    }\n                }\n\n                // on vrifie que l'uri du namespace par dfaut est bien celle que l'on attend\n                if (att === \"xmlns\") {\n                    if (xlsAttributes[att] !== AutoConfResponseReader.NAMESPACES.xmlns) {\n                        console.log(\"[AutoConfResponseReader] autoconf response default namespace is not the expected one\");\n                        return;\n                    }\n                    continue;\n                }\n\n                var prefix = att.split(\":\")[0];\n                var ns = att.split(\":\")[1];\n\n                // si on a un autre xmlns, on vrifie aussi les URI\n                if (prefix === \"xmlns\" && ns) {\n                    // si l'attribut correspond  un namespace dfini dans le reader\n                    if (AutoConfResponseReader.NAMESPACES[ns]) {\n                        // il faut que les URI correspondent aussi.\n                        if (AutoConfResponseReader.NAMESPACES[ns] !== xlsAttributes[att]) {\n                            console.log(\"[AutoConfResponseReader] autoconf response \" + att + \" namespace is not the expected one\");\n                            return;\n                        }\n                    }\n                }\n\n                // pour finir on vrifie la localisation du schema XSD du service\n                if (ns === \"schemaLocation\") {\n                    if (xlsAttributes[att] !== AutoConfResponseReader.SCHEMALOCATION[0] && xlsAttributes[att] !== AutoConfResponseReader.SCHEMALOCATION[1]) {\n                        console.log(\"[AutoConfResponseReader] autoconf response schema location is not the expected one\");\n                        return;\n                    }\n                }\n\n            }\n        }\n    }\n}\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (AutoConfResponseReader);\n\n\n/***/ }),\n/* 63 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__ = __webpack_require__(1);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__Exceptions_ErrorService__ = __webpack_require__(2);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__CommonService__ = __webpack_require__(3);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__Request_DirectGeocodeRequestFactory__ = __webpack_require__(64);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__Response_DirectGeocodeResponseFactory__ = __webpack_require__(76);\n\n\n\n\n\n\n\n\n/**\n * @classdesc\n * Appel du service de gocodage direct du Goportail :\n *     envoi de la requte construite selon les paramtres en options,\n *     ventuellement parsing et analyse  de la rponse,\n *     retour d'une rponse en paramtre de la fonction onSuccess.\n *\n *\n * @constructor\n * @extends {Gp.Services.CommonService}\n * @alias Gp.Services.Geocode\n *\n * @param {Object} options - options spcifiques au service (+ les options herites)\n *\n * @param {String|Object} options.location - Nom de l'adresse, du toponyme, de l'unit administrative ou de la parcelle cadastrale recherche.\n *      Sous forme de String, la proprit permet de faire une recherche dstructure.\n *      Sous forme d'objet, la proprit permet de structurer la recherche.\n *      Dans ce cas, les proprits possibles de cet objet sont dcrites ci-aprs.\n *      @param {Number} [options.location.number] - Numro du btiment de l'adresse recherche, dans le cas d'une recherche structure\n *      (si options.location est un objet Javascript).\n *      @param {String} [options.location.street] - Nom de la rue de l'adresse recherche, dans le cas d'une recherche structure\n *      (si options.location est un objet Javascript).\n *      @param {String} [options.location.city] - Nom de la ville de l'adresse recherche, dans le cas d'une recherche structure\n *      (si options.location est un objet Javascript).\n *      @param {Number} [options.location.postalCode] - Numro du code postal de l'adresse recherche, dans le cas d'une recherche structure\n *      (si options.location est un objet Javascript).\n *\n * @param {Object} [options.filterOptions] - Les proprits possibles de cet objet sont dcrites ci-aprs.\n * @param {Object} [options.filterOptions.bbox] - Emprise dans laquelle on souhaite effectuer la recherche.\n *      Les proprits possibles de cet objet sont dcrites ci-aprs.\n *      @param {Float} options.filterOptions.bbox.left - Abscisse du ct gauche de la BBOX\n *      @param {Float} options.filterOptions.bbox.right - Abscisse du ct droit de la BBOX\n *      @param {Float} options.filterOptions.bbox.top - Ordonne suprieure de la BBOX\n *      @param {Float} options.filterOptions.bbox.bottom - Ordonne infrieure de la BBOX\n *\n * @param {Array.<String>} [options.filterOptions.type = \"StreetAddress\"] - Type de l'objet recherch.\n *      Le service de gocodage du Goportail permet de rechercher des 'PostionOfInterest' pour des toponymes, des 'StreetAddress'\n *      pour des adresses postales, et/ou des 'CadastralParcel' pour des parcelles cadastrales.\n *      D'autres types pourront tre rajouts selon l'volution du service.\n *      Par dfaut, type = ['StreetAddress'].\n *\n * @param {String} [options.filterOptions.[proprietes du filtre]] - Critre supplmentaire pour filtrer la recherche sous la forme\n *      d'un couple cl/valeur  dfinir selon les possibilits du serveur ajout  la requte.\n *      Le service de gocodage du Goportail permet de filtrer tous les rsultats avec les proprits :\n *          \"municipality\", \"insee\", et \"department\".\n *      Il permet aussi de filtrer les adresses postales avec les proprits :\n *          \"quality\", \"ID\", \"ID_TR\" et \"territory\".\n *      Il permet de filtrer les toponymes avec les proprits :\n *          \"importance\", \"nature\" et \"territory\".\n *      Enfin, il permet de filtrer les parcelles cadastrales avec les proprits :\n *          \"sheet\", \"section\", et \"absorbedcity\". Pas de valeur par dfaut.\n *\n * @param {Number} [options.maximumResponses] - Nombre de rponses maximal que l'on souhaite recevoir.\n *      Pas de valeur par dfaut.\n *      Si le serveur consult est celui du Goportail, la valeur par dfaut sera donc celle du service : 25.\n *\n * @param {Boolean} [options.returnFreeForm] - Indique si l'on souhaite en rponse un localisant concatne plutt que structur.\n *      Pas de valeur par dfaut. Si le serveur consult est celui du Goportail, la valeur par dfaut sera donc celle du service : 'false'.\n *\n * @param {String} [options.srs] - Systme de coordonnes dans lequel les paramtres gographiques en entre et la rponse du service sont exprims.\n *      Pas de valeur par dfaut. Si le serveur consult est celui du Goportail, la valeur par dfaut sera donc celle du service : 'EPSG:4326'.\n *\n * @example\n *   var options = {\n *      apiKey : null,\n *      serverUrl : 'http://localhost/service/',\n *      protocol : 'JSONP', // JSONP|XHR\n *      proxyURL : null,\n *      httpMethod : 'GET', // GET|POST\n *      timeOut : 10000, // ms\n *      rawResponse : false, // true|false\n *      scope : null, // this\n *      onSuccess : function (response) {},\n *      onFailure : function (error) {},\n *      // spcifique au service\n *      positions : [{lon:, lat:}, {lon:, lat:}],\n *      (...)\n *   };\n * @private\n */\nfunction Geocode (options) {\n\n    if (!(this instanceof Geocode)) {\n        throw new TypeError(__WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__[\"a\" /* default */].getMessage(\"CLASS_CONSTRUCTOR\", \"Geocode\"));\n    }\n\n    /**\n     * Nom de la classe (heritage)\n     * FIXME instance ou classe ?\n     */\n    this.CLASSNAME = \"Geocode\";\n\n    // appel du constructeur par heritage\n    __WEBPACK_IMPORTED_MODULE_3__CommonService__[\"a\" /* default */].apply(this, arguments);\n\n    this.logger = __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__[\"a\" /* default */].getLogger(\"Gp.Services.Geocode\");\n    this.logger.trace(\"[Constructeur Geocode (options)]\");\n\n    if (!options.location) {\n        throw new Error(__WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__[\"a\" /* default */].getMessage(\"PARAM_MISSING\", \"location\"));\n    }\n\n    // FIXME ECMAScript 5 support\n    if ( typeof options.location === \"object\" && Object.keys(options.location).length === 0) {\n        throw new Error(__WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__[\"a\" /* default */].getMessage(\"PARAM_EMPTY\", \"location\"));\n    } else if ( typeof options.location === \"string\" && options.location.length === 0) {\n        throw new Error(__WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__[\"a\" /* default */].getMessage(\"PARAM_EMPTY\", \"location\"));\n    }\n\n    // ajout des options spcifiques au service\n    this.options.location = options.location;\n\n    // on definit des filtres apr defaut\n    if (!options.filterOptions || typeof options.filterOptions !== \"object\") {\n        this.options.filterOptions = options.filterOptions = {\n            type : [\"StreetAddress\"]\n        };\n    }\n\n    // FIXME ECMAScript 5 support (valable pour un objet uniquement !)\n    // ceci permet de tester le cas o 'options.filterOptions' : {}\n    if (Object.keys(options.filterOptions).length === 0) {\n        this.options.filterOptions = {\n            type : [\"StreetAddress\"]\n        };\n    }\n\n    var filter = Object.keys(options.filterOptions);\n    for (var i = 0; i < filter.length; i++) {\n        var key = filter[i];\n        // on transforme certains filtres qui pourraient tre numriques en string\n        var filtersCouldBeNumberList = [\"department\", \"number\", \"postalCode\", \"insee\", \"importance\", \"ID\", \"IDTR\", \"absorbedCity\", \"sheet\", \"section\", \"inseeRegion\", \"inseeDepartment\"];\n        if (filtersCouldBeNumberList.indexOf(key) !== -1 && typeof options.filterOptions[key] !== \"string\") {\n            options.filterOptions[key] = options.filterOptions[key].toString();\n        }\n        // on supprime les filtres vides\n        if (!options.filterOptions[key]) {\n            delete this.options.filterOptions[key];\n        }\n    }\n\n    this.options.filterOptions.type = options.filterOptions.type || [\"StreetAddress\"];\n    this.options.maximumResponses = options.maximumResponses || 25;\n    this.options.returnFreeForm = options.returnFreeForm || false;\n    this.options.srs = options.srs || \"EPSG:4326\";\n\n    // attributs d'instances\n\n    /**\n     * Format forc de la rponse du service : \"xml\"\n     * sauf si l'on souhaite une reponse brute (options.rawResponse)\n     */\n    this.options.outputFormat = (this.options.rawResponse) ? \"\" : \"xml\";\n}\n\n/**\n * @lends module:Geocode#\n */\nGeocode.prototype = Object.create(__WEBPACK_IMPORTED_MODULE_3__CommonService__[\"a\" /* default */].prototype, {\n    // todo\n    // getter/setter\n});\n\n/*\n * Constructeur (alias)\n */\nGeocode.prototype.constructor = Geocode;\n\n/**\n * Cration de la requte (overwrite)\n *\n * @param {Function} error   - callback des erreurs\n * @param {Function} success - callback\n */\nGeocode.prototype.buildRequest = function (error, success) {\n\n    var options = {\n        httpMethod : this.options.httpMethod,\n        // options specifiques du service\n        location : this.options.location,\n        returnFreeForm : this.options.returnFreeForm,\n        filterOptions : this.options.filterOptions,\n        srs : this.options.srs,\n        maximumResponses : this.options.maximumResponses\n    };\n\n    this.request = __WEBPACK_IMPORTED_MODULE_4__Request_DirectGeocodeRequestFactory__[\"a\" /* default */].build(options);\n\n    // on teste si la requete a bien t construite !\n    if (!this.request) {\n        error.call(this, new __WEBPACK_IMPORTED_MODULE_2__Exceptions_ErrorService__[\"a\" /* default */](__WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__[\"a\" /* default */].getMessage(\"SERVICE_REQUEST_BUILD\")));\n    } else {\n        success.call(this, this.request);\n    }\n};\n\n/**\n * Analyse de la reponse (overwrite)\n *\n * @param {Function} error   - callback des erreurs\n * @param {Function} success - callback\n */\nGeocode.prototype.analyzeResponse = function (error, success) {\n\n    /* INFO :\n         Etape 1 : Cration de la requte\n            -> Appel du format OpenLS pour crer une requte  partir des paramtres (par exemple)\n              (soit directement une URL si GET, soit une requte XML si POST)\n            /!\\ tester si apiKey && serverUrl => on ne garde que serverUrl\n            -> stockage de la requte dans this.request\n         Etape 2 : Envoi de la requte selon le bon protocole\n            -> appel du protocol JSONP ou XHR, et envoi (par ex send ()) (this.protocol)\n            -> rcupration de la rponse xml dans la fonction onSuccess () (this.response)\n            -> si code HTTP 200 et pas de message d'erreur : etape 3\n            -> si code HTTP != 200 : lancement de la fonction de callback onFailure avec le message d'erreur\n         Etape 3 : Analyse de la rponse xml et construction du JSON (si rawResponse == false )\n            -> appel du parser pour rcuprer le xmlDocument\n            -> appel du reader OpenLS pour lire les lments et rcuprer l'objet JSON\n               correspondant au type de gocodage (dfini dans les specs)\n         Etape 4 : Lancement de la fonction de callback onSuccess avec la rponse :\n            -> xmlResponse (si rawResponse == true)\n            -> ou geocodedLocations\n    */\n\n    if (this.response) {\n\n        var options = {\n            response : this.response,\n            rawResponse : this.options.rawResponse,\n            onError : error,\n            onSuccess : success,\n            scope : this\n        };\n\n        __WEBPACK_IMPORTED_MODULE_5__Response_DirectGeocodeResponseFactory__[\"a\" /* default */].build(options);\n\n    } else {\n        error.call(this, new __WEBPACK_IMPORTED_MODULE_2__Exceptions_ErrorService__[\"a\" /* default */](__WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__[\"a\" /* default */].getMessage(\"SERVICE_RESPONSE_EMPTY\")));\n    }\n\n};\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (Geocode);\n\n\n/***/ }),\n/* 64 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__Formats_XLS__ = __webpack_require__(11);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__Formats_XLS_LocationUtilityService__ = __webpack_require__(38);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__Formats_XLS_LocationUtilityService_GeocodeFilterExtension__ = __webpack_require__(13);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__Request_model_StreetAddress__ = __webpack_require__(72);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__Request_model_PositionOfInterest__ = __webpack_require__(73);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__Request_model_CadastralParcel__ = __webpack_require__(74);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7__Request_model_Administratif__ = __webpack_require__(75);\n/**\n * Creation d'une requte OpenLS en mode POST ou GET\n * (Factory)\n *\n * @module DirectGeocodeRequestFactory\n * @alias Gp.Services.Geocode.Request.DirectGeocodeRequestFactory\n * @private\n */\n\n\n\n\n\n\n\n\n\nvar DirectGeocodeRequestFactory = {\n\n    /**\n     * interface unique\n     *\n     * @method build\n     * @static\n     * @param {Object} options - options definies dans le composant Geocode\n     *\n     * @example\n     *   var options = {\n     *      httpMethod:\n     *      // options specifiques du service\n     *      location:\n     *      returnFreeForm:\n     *      filterOptions:\n     *      srs:\n     *      maximumResponses:\n     *   };\n     *   var result = DirectGeocodeRequestFactory.build(options);\n     *   if (!result) {\n     *       // error...\n     *   }\n     * @returns {String} request\n     */\n    build : function (options) {\n\n        // logger\n        var logger = __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__[\"a\" /* default */].getLogger(\"DirectGeocodeRequestFactory\");\n        logger.trace([\"DirectGeocodeRequestFactory::build()\"]);\n\n        var request = null;\n\n        // gestion des filtres (table de geocodage) !\n        // par defaut, on les ajoute toute ...\n        var oFilter = new __WEBPACK_IMPORTED_MODULE_3__Formats_XLS_LocationUtilityService_GeocodeFilterExtension__[\"a\" /* default */]();\n        oFilter.addFilterExtensions(new __WEBPACK_IMPORTED_MODULE_7__Request_model_Administratif__[\"a\" /* default */]());\n        oFilter.addFilterExtensions(new __WEBPACK_IMPORTED_MODULE_4__Request_model_StreetAddress__[\"a\" /* default */]());\n        oFilter.addFilterExtensions(new __WEBPACK_IMPORTED_MODULE_5__Request_model_PositionOfInterest__[\"a\" /* default */]());\n        oFilter.addFilterExtensions(new __WEBPACK_IMPORTED_MODULE_6__Request_model_CadastralParcel__[\"a\" /* default */]());\n\n        // objet LUS\n        // on peut aussi par un objet XLS::GeocodeRequest\n        var oLUS = new __WEBPACK_IMPORTED_MODULE_2__Formats_XLS_LocationUtilityService__[\"a\" /* default */]({\n            location : options.location,\n            returnFreeForm : options.returnFreeForm,\n            filterOptions : options.filterOptions\n        });\n        oLUS.addFilter(oFilter);\n\n        // Format XLS\n        var oXLS = new __WEBPACK_IMPORTED_MODULE_1__Formats_XLS__[\"a\" /* default */]({\n            srsName : options.srs,\n            maximumResponses : options.maximumResponses\n        });\n        oXLS.namespace = true;\n        oXLS.setService(oLUS);\n\n        // request brute !\n        request = oXLS.build();\n\n        // en mode GET, la requte est encode\n        // et le param. 'qxml' est ajout\n        if (options.httpMethod == \"GET\") {\n            var myRequest = \"qxml=\" +\n                encodeURIComponent(request)\n                .replace(/\\-/g, \"%2D\")\n                .replace(/\\_/g, \"%5F\")\n                .replace(/\\./g, \"%2E\")\n                .replace(/\\!/g, \"%21\")\n                .replace(/\\~/g, \"%7E\")\n                .replace(/\\*/g, \"%2A\")\n                .replace(/\\'/g, \"%27\")\n                .replace(/\\(/g, \"%28\")\n                .replace(/\\)/g, \"%29\");\n            request = myRequest;\n        }\n\n        logger.trace(request);\n\n        return request;\n    }\n};\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (DirectGeocodeRequestFactory);\n\n\n/***/ }),\n/* 65 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__ = __webpack_require__(0);\n\n\n/**\n * @classdesc\n *\n * Entte de la requte XSL\n *\n * @example\n * // header XSL\n * header = new RequestHeader ();\n * header.srsName = \"epsg:4326\";\n * header.toString();\n * // out ->\n * // <RequestHeader srsName=\"epsg:4326\"/>\n *\n * @constructor\n * @alias Gp.Formats.XLS.RequestHeader\n * @param {Object} options - options\n * @param {Object}   options.srsName - projection\n * @param {Function} options.onsuccess - function callback success (TODO)\n * @param {Function} options.onerror   - function callback error   (TODO)\n *\n * @private\n */\nfunction RequestHeader (options) {\n\n    this.logger = __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__[\"a\" /* default */].getLogger();\n    this.logger.trace(\"[Constructeur RequestHeader ()]\");\n\n    if (!(this instanceof RequestHeader)) {\n        throw new TypeError(\"RequestHeader constructor cannot be called as a function.\");\n    }\n\n    // options par defaut\n    this.options = options || {\n        srsName : \"EPSG:4326\"\n    };\n\n    // et on ajoute les options en paramtre aux options par dfaut\n    for (var opt in options) {\n        if (options.hasOwnProperty(opt)) {\n            this.options[opt] = options[opt];\n        }\n    }\n}\n\nRequestHeader.prototype = {\n\n    /**\n     * @lends module:RequestHeader#\n     */\n\n    /**\n     * request (out)\n     * @type {String}\n     */\n    requestString : null,\n\n    /**\n     * Template de la requte.\n     * substitution des valeurs suivantes :\n     * __SRSNAME__\n     */\n    template : \"<RequestHeader srsName=\\\"__SRSNAME__\\\"/>\",\n\n    /**\n     * Constructeur (alias)\n     */\n    constructor : RequestHeader,\n\n    /**\n     * toString\n     */\n    toString : function () {\n\n        var template = null;\n        template = this.template;\n        template = template.replace(/__SRSNAME__/g, this.options.srsName);\n        this.requestString = template;\n        return this.requestString;\n    }\n};\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (RequestHeader);\n\n\n/***/ }),\n/* 66 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__ = __webpack_require__(0);\n/*jshint bitwise: false*/\n\n\n/**\n * @classdesc\n *\n * Requte XLS\n *\n * @example\n * // request XSL\n * request = new Request ();\n * request.maximumResponses = 26;\n * request.methodName = \"GeocodeRequest\";\n * request.version = \"1.2\";\n * request.toString();\n * // out ->\n * // <Request maximumResponses=\"26\" methodName=\"GeocodeRequest\" requestID=\"uid1349081498314_388\" version=\"1.2\">\n * //   <!-- __LUS__ -->\n * //  </Request>\n *\n * @constructor\n * @alias Gp.Formats.XLS.Request\n * @param {Object} options - options\n * @param {Object}   options.maximumResponses - 25\n * @param {String}   options.methodName - nom de l'objet LUS, \"GeocodeRequest\" | \"ReverseGeocodeRequest\"\n * @param {String}   options.version - '1.2'\n * @param {Function} options.onsuccess - function callback success (TODO)\n * @param {Function} options.onerror   - function callback error   (TODO)\n *\n * @private\n */\nfunction Request (options) {\n\n    this.logger = __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__[\"a\" /* default */].getLogger();\n    this.logger.trace(\"[Constructeur Request ()]\");\n\n    if (!(this instanceof Request)) {\n        throw new TypeError(\"Request constructor cannot be called as a function.\");\n    }\n\n    // options par defaut\n    this.options = options || {\n        maximumResponses : 25,\n        methodName : null,\n        version : \"1.2\"\n    };\n\n    // et on ajoute les options en paramtre aux options par dfaut\n    for (var opt in options) {\n        if (options.hasOwnProperty(opt)) {\n            this.options[opt] = options[opt];\n        }\n    }\n}\n\nRequest.prototype = {\n\n    /**\n     * @lends module:Request#\n     */\n\n    /**\n     * request (out)\n     * @type {String}\n     */\n    requestString : null,\n\n    /**\n     * Template de la requte.\n     * substitution des valeurs suivantes :\n     * __MAXRESPONSES__, __METHODNAME__, __UUID__, __VERSION__\n     * __REQUESTSERVICE__\n     */\n    template : \"<Request maximumResponses=\\\"__MAXRESPONSES__\\\" methodName=\\\"__METHODNAME__\\\" requestID=\\\"__UUID__\\\" version=\\\"__VERSION__\\\">\" +\n        \"<!-- __REQUESTSERVICE__ -->\" +\n        \"</Request>\",\n\n    /**\n     * Constructeur (alias)\n     */\n    constructor : Request,\n\n    /**\n     * an rfc4122 version 4 compliant guid\n     */\n    guid : function () {\n        // INFO\n        // cf. http://byronsalau.com/blog/how-to-create-a-guid-uuid-in-javascript/\n        return \"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx\".replace(/[xy]/g, function (c) {\n            var r = Math.random() * 16 | 0;\n            var v = c === \"x\" ? r : (r & 0x3 | 0x8);\n            return v.toString(16);\n        });\n    },\n\n    /**\n     * toString\n     */\n    toString : function () {\n\n        var template = null;\n        template = this.template;\n        template = template.replace(/__MAXRESPONSES__/g, this.options.maximumResponses);\n        template = template.replace(/__METHODNAME__/g, this.options.methodName);\n        template = template.replace(/__UUID__/g, this.guid());\n        template = template.replace(/__VERSION__/g, this.options.version);\n\n        this.requestString = template;\n        return this.requestString;\n    }\n};\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (Request);\n\n\n/***/ }),\n/* 67 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__model_Address__ = __webpack_require__(68);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__GeocodeFilterExtension__ = __webpack_require__(13);\n\n\n\n\n/**\n * @classdesc\n * Requte de geocodage direct\n *\n * ```\n * XSD\n * Geocodage direct (balise xsd) :\n *   element ref=\"RequestHeader\" [ (attribute name=\"clientName\" attribute name=\"clientPassword\" attribute name=\"sessionID\" attribute name=\"srsName\" attribute name=\"MSID\") ]\n *     element name=\"Request\" attribute name=\"methodName\" attribute name=\"version\" attribute name=\"requestID\" [ attribute name=\"maximumResponses\" ]\n *       element name=\"GeocodeRequest\" attribute name=\"returnFreeForm\"\n *         element ref=\"xls:Address\"\n * ```\n *\n * @example\n * // creation de l'objet Geocode an ajoutant un objet Address\n * req = new GeocodeRequest ();\n * req.returnFreeForm = true; // TODO !\n * req.addAddress (new Address ({\n *      location : \"saint mand\",\n *      type : ['PositionOfInterest'],\n *      filter : {\n *          (...)\n *      }\n * }));\n * req.toString();\n * // out ->\n * // <GeocodeRequest>\n * //   <Address countryCode=\"PositionOfInterest\">\n * //     <freeFormAddress>saint mand</freeFormAddress>\n * //   </Address>\n * // </GeocodeRequest>\n *\n * // creation de l'objet Geocode avec les options uniquement\n * req = new GeocodeRequest ({\n *      location : \"saint mand\",\n *      returnFreeForm : true,\n *      filterOptions : {\n *          type : ['PositionOfInterest'],\n *          (...)\n *      }\n * });\n * req.toString();\n * // out ->\n * // <GeocodeRequest>\n * //   <Address countryCode=\"PositionOfInterest\">\n * //     <freeFormAddress>saint mand</freeFormAddress>\n * //   </Address>\n * // </GeocodeRequest>\n * @constructor\n *\n * @alias Gp.Formats.XLS.LocationUtilityService.GeocodeRequest\n * @param {Object} options - options\n * @param {Object}   options.location - location\n * @param {String}   options.returnFreeForm - returnFreeForm\n * @param {String}   options.filterOptions - filtres\n * @param {Function} options.onsuccess - function callback success (TODO)\n * @param {Function} options.onerror   - function callback error   (TODO)\n *\n * @private\n */\nfunction GeocodeRequest (options) {\n\n    this.logger = __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__[\"a\" /* default */].getLogger();\n    this.logger.trace(\"[Constructeur GeocodeRequest ()]\");\n\n    if (!(this instanceof GeocodeRequest)) {\n        throw new TypeError(\"GeocodeRequest constructor cannot be called as a function.\");\n    }\n\n    // options par defaut\n    this.options = options || {};\n\n    // et on ajoute les options en paramtre aux options par dfaut\n    for (var opt in options) {\n        if (options.hasOwnProperty(opt)) {\n            this.options[opt] = options[opt];\n        }\n    }\n\n    // TODO\n    // gestion de l'option 'returnFreeForm' si elle n'est pas renseigne dans les options !\n\n    /**\n     * Nom de la classe (heritage)\n     */\n    this.CLASSNAME = \"GeocodeRequest\";\n}\n\nGeocodeRequest.prototype = {\n\n    /**\n     * @lends module:GeocodeRequest#\n     */\n\n    /**\n     * request (out)\n     * @type {String}\n     */\n    strRequest : null,\n\n    /**\n     * Addresse\n     * @type {Address}\n     */\n    oAddress : null,\n\n    /**\n     * Filter\n     * @type {GeocodeFilterExtension}\n     */\n    oFilter : null,\n\n    /**\n     * Template de la requte.\n     * substitution des valeurs suivantes :\n     * __ADDRESS__, __RETURNFREEFORM__\n     */\n    template : \"<GeocodeRequest returnFreeForm=\\\"__RETURNFREEFORM__\\\">\" +\n        \"__ADDRESS__\" +\n        \"</GeocodeRequest>\",\n\n    /**\n     * Ajout d'un objet de type Adresse\n     *\n     * @param {Object} oAddress - Adresse\n     */\n    addAddress : function (oAddress) {\n\n        if (oAddress instanceof __WEBPACK_IMPORTED_MODULE_1__model_Address__[\"a\" /* default */]) {\n            this.oAddress = oAddress;\n        }\n    },\n\n    /**\n     * Ajout d'un objet de type GeocodeFilterExtension\n     *\n     * @param {Object} oFilter - GeocodeFilterExtension\n     */\n    addFilter : function (oFilter) {\n        // FIXME gestion des filtres  partir des tables de geocodages\n        if (oFilter instanceof __WEBPACK_IMPORTED_MODULE_2__GeocodeFilterExtension__[\"a\" /* default */]) {\n            this.oFilter = oFilter;\n        }\n    },\n\n    /**\n     * Constructeur (alias)\n     */\n    constructor : GeocodeRequest,\n\n    /**\n     * toString\n     *\n     * @returns {String}\n     */\n    toString : function () {\n\n        var template = \"\";\n        template = this.template;\n\n        // soit on a dj un objet Address instanci,\n        // sinon, on le fabrique via les options\n        if (!this.oAddress) {\n\n            var settings = {};\n            settings.location = this.options.location;\n            settings.type = this.options.filterOptions.type || [\"StreetAddress\"];\n            settings.filter = this.options.filterOptions;\n            delete settings.filter.type; // on ne met pas le 'type' dans les filtres...\n\n            // gestion des filtres\n            if (this.oFilter) {\n\n                // on reconstruit les filtres\n                settings.filter = {};\n\n                // on determine la liste des filtres possibles\n                // pour chaque table de geocodage en param\n                for (var idx in settings.type) {\n                    var filter = settings.type[idx];\n                    var oFilter = this.oFilter.getFilter(filter);\n\n                    if (!oFilter) {\n                        this.logger.warn(\"Le filtre '\" + filter + \"' n'existe pas !?\");\n                        continue;\n                    }\n\n                    var mFilter = this.options.filterOptions;\n\n                    // correspondances des attributs de filtres possibles avec ceux qui sont en options\n                    var attributs = oFilter.attributesList;\n                    for (var idxe = 0; idxe < attributs.length; idxe++) {\n                        var key = attributs[idxe];\n                        if (mFilter[key]) {\n                            var matchingKey = oFilter.serviceAttributes[idxe];\n                            oFilter.placeAttributes[matchingKey] = mFilter[key];\n                            this.logger.trace(\"Selection du filtre '\" + key + \"' sur le type '\" + filter + \"'.\");\n                        }\n                    }\n\n                    // ajout des valeurs des filtres\n                    var places = oFilter.placeAttributes;\n                    for (var kplace in places) {\n                        if (places.hasOwnProperty(kplace)) {\n                            settings.filter[kplace] = places[kplace];\n                        }\n                    }\n                }\n            }\n\n            this.oAddress = new __WEBPACK_IMPORTED_MODULE_1__model_Address__[\"a\" /* default */](settings);\n            if (!this.oAddress) {\n                throw new Error(\"La construction de l'adresse n'est pas correctement definie !?\");\n            }\n\n        }\n\n        // FIXME gestion des filtres pour un objet Address dj instanci ?\n\n        template = template.replace(/__ADDRESS__/g, this.oAddress.toString());\n        template = template.replace(/__RETURNFREEFORM__/g, (this.options.returnFreeForm) ? \"true\" : \"false\");\n\n        this.strRequest = template;\n        return this.strRequest;\n    }\n};\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (GeocodeRequest);\n\n\n/***/ }),\n/* 68 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__ = __webpack_require__(0);\n\n\n\n/**\n * @classdesc\n *\n * Location type \"Address\".\n *\n * Modles de classes :\n * ------------------\n * ```\n *\n *                Address\n *            (est compos de)\n *           ______ | _________ _________________\n *          /       |          \\                 \\\n *      Place (StreetAddress ou FreeFormAddress) PostalCode\n *       (*)       _|_\n *                /   \\\n *           Street   Building\n * ```\n * ```\n * XSD\n * Address (balise xsd) :\n *   ex. <Address countryCode=\"StreetAddress\"><freeFormAddress>1 r de paris saint denis</freeFormAddress></Address>\n *   attribute name=\"countryCode\"\n *     element name=\"freeFormAddress\"\n *     element ref=\"xls:Place\"\n *     element ref=\"gml:Envelope\"\n *  ou\n *   ex. <Address countryCode=\"StreetAddress\"><StreetAddress><Street>1 rue Marconi</Street></StreetAddress><Place type=\"Municipality\">Metz</Place><PostalCode>57000</PostalCode></Address>\n *   attribute name=\"countryCode\"\n *     element ref=\"xls:StreetAddress\"\n *     element ref=\"xls:PostalCode\"\n *     element ref=\"xls:Place\"\n *     element ref=\"gml:Envelope\"\n * ```\n *\n * @example\n * // simple\n * adr = new Address ({\n *    location : \"2 av pasteur, Saint-Mande\",\n *    type : [\"StreetAddress\"],\n *    filter : {}\n * });\n * adr.toString();\n * // -> out\n * // <Address countryCode=\"StreetAddress\">\n * //   <freeFormAddress>2 av pasteur, Saint-Mande</freeFormAddress>\n * // </Address>\n *\n * // avec filtre\n * adr = new Address ({\n *    location : {\n *      number : 2,\n *      street : \"av pasteur\",\n *      city : \"Saint-Mande\", // FIXME filter Place \"commune\" ou \"municipality\" ?\n *      postalCode : \"94166\"   // FIXME filter Place ou balise PostalCode ?\n *    },\n *    type : [\"StreetAddress\"],\n *    filter : {\n *      territory : \"FR\",\n *      department : \"94\"\n *    }\n * });\n * adr.toString();\n * // -> out\n * // <Address countryCode=\"StreetAddress\">\n * //   <StreetAddress>\n * //   <Building number=\"2\"/>\n * //   <Street>2 av pasteur</Street>\n * // </StreetAddress>\n * // <Place type=\"municipality\">Saint-Mande</Place>\n * // <Place type=\"departement\">94</Place>\n * // <Place type=\"territoire\">FR</Place>\n * // <PostalCode>94166</PostalCode>\n * // </Address>\n *\n * // avec bbox\n * adr = new Address ({\n *    location : \"2 av pasteur, Saint-Mande\",\n *    type : [\"StreetAddress\"],\n *    filter : {\n *      bbox : {left:1, right:2, top:2, bottom:0}\n *    }\n * });\n * adr.toString();\n * // -> out\n * // <Address countryCode=\"StreetAddress\">\n * //   <freeFormAddress>2 av pasteur, Saint-Mande</freeFormAddress>\n * //   <gml:Envelope>\n * //     <gml:lowerCorner>1 0</gml:lowerCorner>\n * //     <gml:upperCorner>2 2</gml:upperCorner>\n * //   </gl:Envelope>\n * // </Address>\n *\n * @constructor\n * @alias Gp.Formats.XLS.LocationUtilityService.Address\n * @param {Object} options - options\n * @param {Object} options.location - location\n * @param {String} options.type - type\n * @param {String} options.filter - filtres\n * @param {String} options.filter.* - Filtr en fonction des tables de geocodage interroges\n *\n * @private\n */\nfunction Address (options) {\n\n    this.logger = __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__[\"a\" /* default */].getLogger(\"Address\");\n    this.logger.trace(\"[Constructeur Address ()]\");\n\n    if (!(this instanceof Address)) {\n        throw new TypeError(\"Address constructor cannot be called as a function.\");\n    }\n\n    // param par defaut\n    this.options = options || {\n        location : {},\n        type : [\"StreetAddress\"],\n        filter : {}\n    };\n\n    // param obligatoire\n    if (!options.location) {\n        throw new Error(\"l'option 'location' n'est pas renseigne !\");\n    }\n\n    // et on ajoute les options en paramtre aux options par dfaut\n    for (var opt in options) {\n        if (options.hasOwnProperty(opt)) {\n            this.options[opt] = options[opt];\n        }\n    }\n}\n\n/**\n * @lends module:Address#\n */\nAddress.prototype = {\n\n    /**\n     * Constructeur (alias)\n     */\n    constructor : Address,\n\n    /**\n     * request (out)\n     * @type {String}\n     */\n    requestString : null,\n\n    /**\n     * Template de la requte.\n     *\n     * substitution des valeurs suivantes :\n     * - address :  __COUNTRYCODE__, __LOCATION__, __PLACE__, __POSTALCODE__, __ENVELOPE__\n     * - freeFormAddress : __FREEFORMADDRESSVALUE__\n     * - streetAddress : __STREET__, __BUILDING__\n     * - street : __STREETVALUE__\n     * - building : __BUILDINGVALUE__\n     * - place : __PLACEATYPE__, __PLACEVALUE__\n     * - postalCode : __POSTALCODEVALUE__\n     * - gml:envelope : __LEFT__ __BOTTOM__ __RIGHT__ __TOP__\n     *\n     * @todo gestion de l\"indentation\n     */\n    template : {\n        address : \"<Address countryCode=\\\"__COUNTRYCODE__\\\">\" +\n            \"__LOCATION__\" +\n            \"__PLACE__\" +\n            \"__POSTALCODE__\" +\n            \"__ENVELOPE__\" +\n            \"</Address>\",\n        location : {\n            freeFormAddress : \"<freeFormAddress>__FREEFORMADDRESSVALUE__</freeFormAddress>\",\n            streetAddress : {\n                container : \"<StreetAddress>\" +\n                    \"__STREET__\" +\n                    \"__BUILDING__\" +\n                    \"</StreetAddress>\",\n                building : \"<Building number=\\\"__BUILDINGVALUE__\\\"/>\",\n                street : \"<Street>__STREETVALUE__</Street>\"\n            }\n        },\n        place : \"<Place type=\\\"__PLACETYPE__\\\">__PLACEVALUE__</Place>\",\n        postalCode : \"<PostalCode>__POSTALCODEVALUE__</PostalCode>\",\n        envelope : \"<gml:Envelope>\" +\n            \"<gml:lowerCorner>__LEFT__ __BOTTOM__</gml:lowerCorner>\" +\n            \"<gml:upperCorner>__RIGHT__ __TOP__</gml:upperCorner>\" +\n            \"</gml:Envelope>\"\n    }\n\n};\n\n/**\n * toString\n *\n * @returns {String}\n */\nAddress.prototype.toString = function () {\n\n    var template = null;\n    template = this.template.address;\n    template = template.replace(/__COUNTRYCODE__/g, this.options.type);\n\n    // on a une adresse structure ou libre ?\n    if ( typeof this.options.location === \"string\") {\n        // balise freeFormeAddress\n        var tmplFreeFormAddress = this.template.location.freeFormAddress;\n        tmplFreeFormAddress = tmplFreeFormAddress.replace(/__FREEFORMADDRESSVALUE__/g, this.options.location);\n        template = template.replace(/__LOCATION__/g, tmplFreeFormAddress);\n    } else {\n        // balises Street et Building\n        var tmplBuilding = \"\";\n        var tmplStreet = \"\";\n\n        if (this.options.location.number) {\n            tmplBuilding = this.template.location.streetAddress.building;\n            tmplBuilding = tmplBuilding.replace(/__BUILDINGVALUE__/g, this.options.location.number);\n        }\n\n        if (this.options.location.street) {\n            tmplStreet = this.template.location.streetAddress.street;\n            tmplStreet = tmplStreet.replace(/__STREETVALUE__/g, this.options.location.street);\n        }\n\n        // balise streetAddress\n        var tmplStreetAddress = this.template.location.streetAddress.container;\n        tmplStreetAddress = tmplStreetAddress.replace(/__STREET__/g, tmplStreet);\n        tmplStreetAddress = tmplStreetAddress.replace(/__BUILDING__/g, tmplBuilding);\n        template = template.replace(/__LOCATION__/g, tmplStreetAddress);\n    }\n\n    // a t on un filtre de type PostalCode ?\n    var tmplPostalCode = \"\";\n    if (this.options.location.postalCode) {\n        tmplPostalCode = this.template.postalCode;\n        tmplPostalCode = tmplPostalCode.replace(/__POSTALCODEVALUE__/g, this.options.location.postalCode);\n\n    }\n\n    // a t on un filtre de type GML::Envelope ?\n    var tmplEnvelope = \"\";\n    if (this.options.filter) {\n        var bbox = this.options.filter.bbox;\n        if (bbox) {\n            tmplEnvelope = this.template.envelope;\n            tmplEnvelope = tmplEnvelope.replace(/__LEFT__/g, bbox.left);\n            tmplEnvelope = tmplEnvelope.replace(/__BOTTOM__/g, bbox.bottom);\n            tmplEnvelope = tmplEnvelope.replace(/__RIGHT__/g, bbox.right);\n            tmplEnvelope = tmplEnvelope.replace(/__TOP__/g, bbox.top);\n        }\n    }\n\n    // liste des filtres Place\n    var Places = [];\n\n    // a t on des filtres de type Place ?\n    var tmplPlace = \"\";\n    if (this.options.filter) {\n\n        var filters = this.options.filter;\n        for (var filter in filters) {\n            if (filter === \"bbox\") {\n                continue;\n            }\n            // FIXME gestion des filtres spcifiques IGN ?\n            tmplPlace = this.template.place;\n            tmplPlace = tmplPlace.replace(/__PLACETYPE__/g, filter);\n            tmplPlace = tmplPlace.replace(/__PLACEVALUE__/g, filters[filter]);\n            Places.push(tmplPlace);\n        }\n    }\n\n    // a t on un filtre de type Place dans location ?\n    var tmplPlaceCity = \"\";\n    if (this.options.location.city) {\n        tmplPlaceCity = this.template.place;\n        tmplPlaceCity = tmplPlaceCity.replace(/__PLACETYPE__/g, \"Municipality\");\n        tmplPlaceCity = tmplPlaceCity.replace(/__PLACEVALUE__/g, this.options.location.city);\n        Places.push(tmplPlaceCity);\n    }\n\n    template = template.replace(/__POSTALCODE__/g, tmplPostalCode);\n    template = template.replace(/__PLACE__/g, Places.join(\"\\n\"));\n    template = template.replace(/__ENVELOPE__/g, tmplEnvelope);\n\n    this.requestString = template;\n    return this.requestString;\n};\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (Address);\n\n\n/***/ }),\n/* 69 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__model_Position__ = __webpack_require__(70);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__model_Preference__ = __webpack_require__(71);\n\n\n\n\n\n/**\n * @classdesc\n *\n * Requte de geocodage inverse\n *\n * XSD\n * ```\n * Geocodage inverse (balise xsd) :\n *   element ref=\"RequestHeader\" [ (attribute name=\"clientName\" attribute name=\"clientPassword\" attribute name=\"sessionID\" attribute name=\"srsName\" attribute name=\"MSID\") ]\n *     element name=\"Request\" attribute name=\"methodName\" attribute name=\"version\" attribute name=\"requestID\" [ attribute name=\"maximumResponses\" ]\n *       element name=\"ReverseGeocodeRequest\"\n *         element ref=\"xls:Position\"\n *         element name=\"ReverseGeocodePreference\" (enumeration)\n * ```\n *\n * @example\n * // creation de l\"objet ReverseGeocode\n * req = new ReverseGeocodeRequest ();\n * req.addPosition (new Position (position:{x: , y: }));\n * req.addPreference ([\"StreetAddress\"]);\n * req.toString();\n * // out ->\n * // <ReverseGeocodeRequest>\n * //     <Position>\n * //       <gml:Point xmlns:gml=\"http://www.opengis.net/gml\">\n * //           <gml:pos>50.347775 3.205098</gml:pos>\n * //       </gml:Point>\n * //     </Position>\n * //     <ReverseGeocodePreference>StreetAddress</ReverseGeocodePreference>\n * //  </ReverseGeocodeRequest>\n * @constructor\n * @alias Gp.Formats.XLS.ReverseGeocodeRequest\n * @param {Object} options - options\n * @param {Object}   options.position - position\n * @param {String}   options.returnFreeForm - returnFreeForm\n * @param {String}   options.filterOptions - filtres\n * @param {Function} options.onsuccess - function callback success (TODO)\n * @param {Function} options.onerror   - function callback error   (TODO)\n *\n * @private\n */\nfunction ReverseGeocodeRequest (options) {\n\n    this.logger = __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__[\"a\" /* default */].getLogger();\n    this.logger.trace(\"[Constructeur ReverseGeocodeRequest ()]\");\n\n    if (!(this instanceof ReverseGeocodeRequest)) {\n        throw new TypeError(\"ReverseGeocodeRequest constructor cannot be called as a function.\");\n    }\n\n    // options par defaut\n    this.options = options || {};\n\n    // et on ajoute les options en paramtre aux options par dfaut\n    for (var opt in options) {\n        if (options.hasOwnProperty(opt)) {\n            this.options[opt] = options[opt];\n        }\n    }\n\n    /**\n     * Nom de la classe (heritage)\n     */\n    this.CLASSNAME = \"ReverseGeocodeRequest\";\n}\n\nReverseGeocodeRequest.prototype = {\n\n    /**\n     * @lends module:ReverseGeocodeRequest#\n     */\n\n    /**\n     * request (out)\n     * @type {String}\n     */\n    strRequest : null,\n\n    /**\n     * Position\n     * @type {Position}\n     */\n    oPosition : null,\n\n    /**\n     * Preference\n     * @type {Preference}\n     */\n    oPreference : null,\n\n    /**\n     * Constructeur (alias)\n     */\n    constructor : ReverseGeocodeRequest,\n\n    /**\n     * Template de la requte.\n     * substitution des valeurs suivantes :\n     * __POSITION__, __PREFERENCE__, __RETURNFREEFORM__\n     */\n    template : \"<ReverseGeocodeRequest returnFreeForm=\\\"__RETURNFREEFORM__\\\">\" +\n        \"__POSITION__\" +\n        \"__PREFERENCE__\" +\n        \"</ReverseGeocodeRequest>\",\n\n    /**\n     * Ajout d\"un objet de type Position\n     *\n     * @param {Object} oPosition - Position\n     */\n    addPosition : function (oPosition) {\n\n        if (oPosition instanceof __WEBPACK_IMPORTED_MODULE_1__model_Position__[\"a\" /* default */]) {\n            this.oPosition = oPosition;\n        }\n    },\n\n    /**\n     * Ajout d\"une liste de table de rfrence LUS :\n     * [StreetAddress, PointOfInterest, CadastralParcel, Administrativ]\n     *\n     * @param {Object} oPreference - Preference\n     */\n    addPreferences : function (oPreference) {\n\n        if (oPreference instanceof __WEBPACK_IMPORTED_MODULE_2__model_Preference__[\"a\" /* default */]) {\n            this.oPreference = oPreference;\n        }\n    },\n\n    /**\n     * toString\n     */\n    toString : function () {\n\n        var template = \"\";\n        template = this.template;\n\n        // si on a dj un objet Preference instanci,\n        // sinon, on le fabrique via les options\n        if (!this.oPreference) {\n\n            this.oPreference = new __WEBPACK_IMPORTED_MODULE_2__model_Preference__[\"a\" /* default */](this.options.filterOptions.type || [\"StreetAddress\"]);\n            if (!this.oPreference) {\n                throw new Error(\"Les preferences ne sont pas definies !?\");\n            }\n        }\n        template = template.replace(/__PREFERENCE__/g, this.oPreference.toString());\n\n        // si on a dj un objet Position instanci,\n        // sinon, on le fabrique via les options\n        if (!this.oPosition) {\n            var settings = {\n                position : this.options.position,\n                filter : {}\n            };\n\n            // FIXME gestion des filtres ?\n            if (this.options.filterOptions) {\n                settings.filter = this.options.filterOptions;\n                delete settings.filter.type; // pas besoin ?\n            }\n            this.oPosition = new __WEBPACK_IMPORTED_MODULE_1__model_Position__[\"a\" /* default */](settings);\n            if (!this.oPosition) {\n                throw new Error(\"La position et ses filtres ne sont pas definis !?\");\n            }\n\n        }\n        template = template.replace(/__POSITION__/g, this.oPosition.toString());\n        template = template.replace(/__RETURNFREEFORM__/g, (this.options.returnFreeForm) ? \"true\" : \"false\");\n\n        this.strRequest = template;\n        return this.strRequest;\n    }\n};\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (ReverseGeocodeRequest);\n\n\n/***/ }),\n/* 70 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__ = __webpack_require__(0);\n\n\n/**\n * @classdesc\n * Location de type Position\n *\n * ```\n * XSD\n * Position (balise xsd) :\n *   ex. <Position><gml:Point xmlns:gml=\"http://www.opengis.net/gml\"><gml:pos>50.347775 3.205098</gml:pos></gml:Point></Position>\n *   ex. <Position><gml:CircleByCenterPoint xmlns:gml=\"http://www.opengis.net/gml\"><gml:pos>48.85978570614691 2.2913572761128878</gml:pos><gml:radius>1000</gml:radius></gml:CircleByCenterPoint></Position>\n *   (au choix)\n *   element ref=\"gml:Point\"\n *   element ref=\"gml:CircleByCenterPoint\"\n *   element ref=\"gml:Polygon\"\n *   element ref=\"gml:MultiPolygon\"\n * ```\n *\n * FIXME les autres elements ne sont pas implments (QoP, Speed, Direction, Time, ...) ?\n *\n * ```\n * template : \"<Position>\n *                  __GMLPOINT__\n *                  __GMLFILTER__\n *             </Position>\"\n * ```\n * ```\n * GML : {\n *  pos     : \"<gml:pos>__X__ __Y__</gml:pos>\",\n *  point   : \"<gml:Point xmlns:gml=\\\"http://www.opengis.net/gml\\\">__POS__</gml:Point>\",\n *  circle  : \"<gml:CircleByCenterPoint xmlns:gml=\\\"http://www.opengis.net/gml\\\">__POS__<gml:radius>__RADIUS__</gml:radius></gml:CircleByCenterPoint>\",\n *  // not yet implemented !\n *  polygon      : \"\",\n *  multipolygon : \"\"\n * }\n * ```\n *\n * @constructor\n * @alias Gp.Formats.XLS.LocationUtilityService.Position\n * @param {Object} options - options donnes en entre\n * @param {Object} options.position - x/y\n * @param {Object} options.filter - filtre\n * @param {Object} options.filter.circle - un cercle\n * @param {Object} options.filter.polygon - un polygone\n *\n * @private\n */\nfunction Position (options) {\n\n    this.logger = __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__[\"a\" /* default */].getLogger(\"Position\");\n    this.logger.trace(\"[Constructeur Position ()]\");\n\n    if (!(this instanceof Position)) {\n        throw new TypeError(\"Position constructor cannot be called as a function.\");\n    }\n\n    // param par defaut\n    this.options = options || {};\n\n    // param obligatoire\n    if (!options.position) {\n        throw new Error(\"l'option 'position' n'est pas renseigne !\");\n    }\n\n    // et on ajoute les options en paramtre aux options par dfaut\n    for (var opt in options) {\n        if (options.hasOwnProperty(opt)) {\n            this.options[opt] = options[opt];\n        }\n    }\n}\n\n/**\n * @lends module:Position#\n */\nPosition.prototype = {\n\n    /**\n     * Constructeur (alias)\n     */\n    constructor : Position,\n\n    /**\n     * request (out)\n     * @type {String}\n     */\n    requestString : null,\n\n    /**\n     * Template de la requte.\n     *\n     * substitution des valeurs suivantes :\n     * __GMLPOINT__ __GMLFILTER__\n     * __X__ __Y__ __RADIUS__\n     * __XY__\n     * @todo indentation XML\n     * @todo implementation classe GML\n     */\n    template : {\n        position : \"<Position>\" +\n            \"__GMLPOINT__\" +\n            \"__GMLFILTER__\" +\n            \"</Position>\",\n        gml : {\n            point : \"<gml:Point xmlns:gml=\\\"http://www.opengis.net/gml\\\"><gml:pos>__X__ __Y__</gml:pos></gml:Point>\",\n            pos : null,\n            filter : {\n                bbox : \"<gml:Envelope xmlns:gml=\\\"http://www.opengis.net/gml\\\">\" +\n                    \"<gml:lowerCorner>__LEFT__ __BOTTOM__</gml:lowerCorner>\" +\n                    \"<gml:upperCorner>__RIGHT__ __TOP__</gml:upperCorner>\" +\n                    \"</gml:Envelope>\",\n                circle : \"<gml:CircleByCenterPoint xmlns:gml=\\\"http://www.opengis.net/gml\\\"><gml:pos>__X__ __Y__</gml:pos><gml:radius>__RADIUS__</gml:radius></gml:CircleByCenterPoint>\",\n                polygon : \"<gml:Polygon xmlns:gml=\\\"http://www.opengis.net/gml\\\"><gml:exterior><gml:LinearRing><gml:posList>__XY__</gml:posList></gml:LinearRing></gml:exterior></gml:Polygon>\",\n                multipolygon : null\n            }\n        }\n    }\n};\n\n/**\n * toString\n *\n * @returns {String}\n */\nPosition.prototype.toString = function () {\n\n    var template = this.template.position;\n\n    var tmplGmlPoint = this.template.gml.point;\n    tmplGmlPoint = tmplGmlPoint.replace(/__X__/g, this.options.position.x);\n    tmplGmlPoint = tmplGmlPoint.replace(/__Y__/g, this.options.position.y);\n\n    var tmplGmlFilter = \"\";\n    if (this.options.filter) {\n\n        var filter = this.options.filter;\n\n        for (var name in filter) {\n\n            switch (name) {\n                case \"circle\":\n                    tmplGmlFilter = this.template.gml.filter[name];\n                    tmplGmlFilter = tmplGmlFilter.replace(/__X__/g, filter[name].x);\n                    tmplGmlFilter = tmplGmlFilter.replace(/__Y__/g, filter[name].y);\n                    tmplGmlFilter = tmplGmlFilter.replace(/__RADIUS__/g, filter[name].radius);\n                    break;\n                case \"bbox\":\n                    tmplGmlFilter = this.template.gml.filter[name];\n                    tmplGmlFilter = tmplGmlFilter.replace(/__LEFT__/g, filter[name].left);\n                    tmplGmlFilter = tmplGmlFilter.replace(/__BOTTOM__/g, filter[name].bottom);\n                    tmplGmlFilter = tmplGmlFilter.replace(/__RIGHT__/g, filter[name].right);\n                    tmplGmlFilter = tmplGmlFilter.replace(/__TOP__/g, filter[name].top);\n                    break;\n                case \"polygon\":\n                    // FIXME implementation simple du polygone !\n                    // aucun test de fermeture du polygone, ni de gestion des trous !\n                    tmplGmlFilter = this.template.gml.filter[name];\n                    var strPoints = \"\";\n                    var lstPoints = filter[name];\n                    for (var i = 0; i < lstPoints.length; i++) {\n                        var coord = lstPoints[i];\n                        if (Array.isArray(coord)) {\n                            this.logger.error(\"Holes are not implemented !\");\n                            break;\n                        }\n                        if ((coord.x && coord.y) || (coord.x === 0 || coord.y === 0)) {\n                            strPoints += coord.x + \" \" + coord.y;\n                        }\n                        if (lstPoints.length !== i + 1) {\n                            strPoints += \" \";\n                        }\n                    }\n                    tmplGmlFilter = tmplGmlFilter.replace(/__XY__/g, strPoints);\n                    break;\n                case \"multipolygon\":\n                    this.logger.warn(\"Filter '\" + name + \"' is not yet implemented !\");\n                    break;\n                default:\n                    this.logger.error(\"This filter '\" + name + \"' is not useful !\");\n            }\n        }\n    }\n\n    template = template.replace(/__GMLPOINT__/g, tmplGmlPoint);\n    template = template.replace(/__GMLFILTER__/g, tmplGmlFilter);\n\n    this.requestString = template;\n    return this.requestString;\n};\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (Position);\n\n\n/***/ }),\n/* 71 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__ = __webpack_require__(0);\n\n\n/**\n * @classdesc\n *\n * Preference (Reverse)\n *\n * FIXME liste des types de tables de geocodage\n *\n * ```\n * template : \"<ReverseGeocodePreference>__TYPE__</ReverseGeocodePreference>\"\n * ```\n *\n * @constructor\n * @alias Gp.Formats.XLS.LocationUtilityService.Preference\n * @param {String} type - type de table de geocodage\n *\n * @private\n *\n */\n\nfunction Preference (type) {\n\n    this.logger = __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__[\"a\" /* default */].getLogger(\"Preference\");\n    this.logger.trace(\"[Constructeur Preference ()]\");\n\n    if (!(this instanceof Preference)) {\n        throw new TypeError(\"Preference constructor cannot be called as a function.\");\n    }\n\n    /**\n     * type de table de geocodage\n     * @type {Array.<String>}\n     */\n    this.type = type;\n}\n\n/**\n * @lends module:Preference#\n */\nPreference.prototype = {\n\n    /**\n     * Constructeur (alias)\n     */\n    constructor : Preference,\n\n    /**\n     * request (out)\n     * @type {String}\n     */\n    requestString : null,\n\n    /**\n     * Template de la requte.\n     *\n     * substitution des valeurs suivantes :\n     *  __TYPE__\n     *\n     */\n    template : \"<ReverseGeocodePreference>__TYPE__</ReverseGeocodePreference>\"\n};\n\n/**\n * toString\n *\n * @returns {String}\n */\nPreference.prototype.toString = function () {\n\n    var Preferences = [];\n    var tmplPreference = \"\";\n    for (var idx = 0; idx < this.type.length; idx++) {\n        tmplPreference = this.template;\n        tmplPreference = tmplPreference.replace(/__TYPE__/g, this.type[idx]);\n        Preferences.push(tmplPreference);\n    }\n\n    this.strRequest = Preferences.join(\"\\n\");\n    return this.strRequest;\n};\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (Preference);\n\n\n/***/ }),\n/* 72 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__GeocodeLocation__ = __webpack_require__(7);\n\n\n\n/**\n * @classdesc\n * Format des attributs d'un rsultat de gocodage de type StreetAddress.\n *\n * @constructor\n * @alias Gp.Services.Geocode.Request.StreetAddress\n * @private\n */\nfunction StreetAddress () {\n\n    if (!(this instanceof StreetAddress)) {\n        throw new TypeError(\"StreetAddress constructor cannot be called as a function.\");\n    }\n\n    // INFO\n    // appel du constructeur de la classe mre\n    // avec passage de param.\n    __WEBPACK_IMPORTED_MODULE_0__GeocodeLocation__[\"a\" /* default */].apply(this, arguments);\n\n    /**\n     * Nom de la classe (heritage)\n     * @type {String}\n     */\n    this.CLASSNAME = \"StreetAddress\";\n\n    /**\n     * Liste des attributs possibles pour une GeocodeLocation de type StreetAddress\n     * - **bbox** : Emprise de l'adresse dans le systme de coordonnes demand {left, right, top, bottom}. *{Object}*\n     * - **ID** : Identifiant BD ADRESSE dans le cas o le rsultat est une adresse. *{String}*\n     * - **IDTR** : Identifiant \"Route Adresse\" de la voie portant l'adresse dans la base BD ADRESSE. *{String}*\n     * - **quality** : Indicateur de qualit du gocodage (pour plus d'infos : http://api.ign.fr/tech-docs-js/fr/developpeur/search.html *{String}*\n     * - **territory** : Code du territoire franais o se situe l'adresse *{String}*\n     * - **commune** : Ville l'adresse. *{String}*\n     * - **department** : Dpartement l'adresse. *{String}*\n     * - **insee** : Code INSEE de l'adresse. *{Number}*\n     * - **municipality** : Municipalit de l'adresse. *{String}*\n     */\n\n    this.attributesList = [\"bbox\", \"ID\", \"IDTR\", \"quality\", \"territory\", \"commune\", \"department\", \"insee\", \"municipality\"];\n\n    this.serviceAttributes = [\"bbox\", \"ID\", \"IDTR\", \"Qualite\", \"Territoire\", \"Commune\", \"Departement\", \"INSEE\", \"Municipality\"];\n\n}\n\n/**\n * @lends module:StreetAdress#\n */\nStreetAddress.prototype = Object.create(__WEBPACK_IMPORTED_MODULE_0__GeocodeLocation__[\"a\" /* default */].prototype);\n\n/**\n * Constructeur (alias)\n */\nStreetAddress.prototype.constructor = StreetAddress;\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (StreetAddress);\n\n\n/***/ }),\n/* 73 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__GeocodeLocation__ = __webpack_require__(7);\n\n\n\n/**\n * @classdesc\n * Format des attributs d'un rsultat de gocodage de type PositionOfInterest\n *\n * @constructor\n * @alias Gp.Services.Geocode.Request.PositionOfInterest\n * @private\n */\nfunction PositionOfInterest () {\n\n    if (!(this instanceof PositionOfInterest)) {\n        throw new TypeError(\"PositionOfInterest constructor cannot be called as a function.\");\n    }\n\n    // INFO\n    // appel du constructeur de la classe mre\n    // avec passage de param.\n    __WEBPACK_IMPORTED_MODULE_0__GeocodeLocation__[\"a\" /* default */].apply(this, arguments);\n\n    /**\n     * Nom de la classe (heritage)\n     * @type {String}\n     */\n    this.CLASSNAME = \"PositionOfInterest\";\n\n    /**\n     * Liste des attributs possibles pour une GeocodeLocation de type PositionOfInterest\n     * - **bbox** : Emprise du toponyme dans le systme de coordonnes demand {left, right, top, bottom} *{Object}*\n     * - **importance** : Importance du toponyme *{number}*\n     * - **nature** : Nature du toponyme. *{String}*\n     * - **territory** : Code du territoire franais o se situe le toponyme *{String}*\n     * - **commune** : Ville du toponyme. *{String}*\n     * - **department** : Dpartement du toponyme. *{String}*\n     * - **insee** : Code INSEE de la commune o se situe le toponyme. *{Number}*\n     * - **municipality** : Municipalit du toponyme. *{String}*\n     */\n\n    this.attributesList = [\"bbox\", \"importance\", \"nature\", \"territory\", \"commune\", \"department\", \"insee\", \"municipality\"];\n\n    this.serviceAttributes = [\"bbox\", \"Importance\", \"Nature\", \"Territoire\", \"Commune\", \"Departement\", \"INSEE\", \"Municipality\"];\n\n}\n\n/**\n * @lends module:PositionOfInterest#\n */\nPositionOfInterest.prototype = Object.create(__WEBPACK_IMPORTED_MODULE_0__GeocodeLocation__[\"a\" /* default */].prototype);\n\n/**\n * Constructeur (alias)\n */\nPositionOfInterest.prototype.constructor = PositionOfInterest;\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (PositionOfInterest);\n\n\n/***/ }),\n/* 74 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__GeocodeLocation__ = __webpack_require__(7);\n\n\n\n/**\n * @classdesc\n * Format des attributs d'un filtre de gocodage de type CadastralParcel.\n *\n * @constructor\n * @alias Gp.Services.Geocode.Request.CadastralParcel\n * @private\n */\nfunction CadastralParcel () {\n\n    if (!(this instanceof CadastralParcel)) {\n        throw new TypeError(\"CadastralParcel constructor cannot be called as a function.\");\n    }\n\n    // INFO\n    // appel du constructeur de la classe mre\n    // avec passage de param.\n    __WEBPACK_IMPORTED_MODULE_0__GeocodeLocation__[\"a\" /* default */].apply(this, arguments);\n\n    /**\n     * Nom de la classe (heritage)\n     */\n    this.CLASSNAME = \"CadastralParcel\";\n\n    /**\n     * Liste des attributs possibles pour une GeocodeLocation de type CadastralParcel\n     * - **absorbedCity** : Code commune absorbe de la parcelle :\n     *      lorsqu'une parcelle est issue p d'une ancienne commune qui a fusionn avec une autre.\n     *      Sinon, le code vaut '000'. *{String}*\n     * - **sheet** : Feuille de la parcelle (ex 1). *{String}*\n     * - **number** : Numro de la parcelle (ex. 0041) *{String}*\n     * - **section** : Section de la parcelle (ex 0D). *{String}*\n     * - **commune** : Ville du filtre. *{String}*\n     * - **department** : Dpartement du filtre. *{String}*\n     * - **insee** : Code INSEE du filtre. *{Number}*\n     * - **municipality** : Municipalit du filtre. *{String}*\n     * - **origin** : L'origine de l'objet parcellaire renvoy\n     *      (correspond  l'attribut \"type\" dans la rponse XML)\n     *      Pour plus d'informations : http://api.ign.fr/tech-docs-js/fr/developpeur/search.html#Recherche_par_parcelles_cadastrales *{Number}*\n     *\n     */\n\n    this.attributesList = [\"absorbedCity\", \"sheet\", \"number\", \"section\", \"commune\", \"department\", \"insee\", \"municipality\", \"origin\"];\n\n    this.serviceAttributes = [\"CommuneAbsorbee\", \"Feuille\", \"Numero\", \"Section\", \"Commune\", \"Departement\", \"INSEE\", \"Municipality\", \"Type\"];\n\n}\n\n/**\n * @lends module:CadastralParcel#\n */\nCadastralParcel.prototype = Object.create(__WEBPACK_IMPORTED_MODULE_0__GeocodeLocation__[\"a\" /* default */].prototype);\n\n/**\n * Constructeur (alias)\n */\nCadastralParcel.prototype.constructor = CadastralParcel;\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (CadastralParcel);\n\n\n/***/ }),\n/* 75 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__GeocodeLocation__ = __webpack_require__(7);\n\n\n\n/**\n * @classdesc\n * Format des attributs d'un filtre de gocodage de type Administratif.\n * @constructor\n * @alias Gp.Services.Geocode.Request.Administratif\n * @private\n */\nfunction Administratif () {\n\n    if (!(this instanceof Administratif)) {\n        throw new TypeError(\"Administratif constructor cannot be called as a function.\");\n    }\n\n    // INFO\n    // appel du constructeur de la classe mre\n    // avec passage de param.\n    __WEBPACK_IMPORTED_MODULE_0__GeocodeLocation__[\"a\" /* default */].apply(this, arguments);\n\n    /**\n     * Nom de la classe (heritage)\n     * @type {String}\n     */\n    this.CLASSNAME = \"Administratif\";\n\n    /**\n     * Liste des attributs possibles pour une GeocodedLocation de type Administratif\n     * - **bbox** : Emprise de l'unit administrative dans le systme de coordonnes demand *{left, right, top, bottom}*\n     * - **prefecture** - Nom de la prfcture de la rgion ou du dpartement *{String}*\n     * - **inseeRegion** - Numro INSEE de la rgion *{String}*\n     * - **inseeDepartment** - Numro INSEE du dpartement *{String}*\n     * - **municipality** - Nom de l'unit administrative *{String}*\n     *\n     */\n\n    this.attributesList = [\"bbox\", \"prefecture\", \"inseeRegion\", \"inseeDepartment\", \"municipality\"];\n\n    this.serviceAttributes = [\"bbox\", \"Prefecture\", \"InseeRegion\", \"InseeDepartement\", \"Municipality\"];\n\n}\n\n/**\n * @lends module:Administratif#\n */\nAdministratif.prototype = Object.create(__WEBPACK_IMPORTED_MODULE_0__GeocodeLocation__[\"a\" /* default */].prototype);\n\n/**\n * Constructeur (alias)\n */\nAdministratif.prototype.constructor = Administratif;\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (Administratif);\n\n\n/***/ }),\n/* 76 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__Exceptions_ErrorService__ = __webpack_require__(2);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__Utils_MessagesResources__ = __webpack_require__(1);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__Formats_XML__ = __webpack_require__(4);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__Formats_DirectGeocodeResponseReader__ = __webpack_require__(77);\n/**\n * Factory pour gnrer une reponse JSON  partir d'un XML\n * ou d'un JSON encapsulant du XML\n * (Factory)\n *\n * @module GeocodeResponseFactory\n * @alias Gp.Services.Geocode.Response.GeocodeResponseFactory\n * @todo La reponse JSON peut encapsuler un XML !\n * @private\n */\n\n\n\n\n\n\nvar DirectGeocodeReponseFactory = {\n\n    /**\n     * interface unique\n     *\n     * @method build\n     * @static\n     * @param {Object} options - options definies dans le composant Geocode\n     *\n     * @example\n     *   var options = {\n     *      response :\n     *      rawResponse :\n     *      scope :\n     *      onSuccess :\n     *      onError :\n     *   };\n     *\n     */\n    build : function (options) {\n\n        // data de type GeocodeResponse\n        var data = null;\n\n        if (options.response) {\n            if (options.rawResponse) {\n                data = options.response;\n            } else {\n\n                try {\n\n                    var p = new __WEBPACK_IMPORTED_MODULE_3__Formats_XML__[\"a\" /* default */]({\n                        reader : __WEBPACK_IMPORTED_MODULE_4__Formats_DirectGeocodeResponseReader__[\"a\" /* default */]\n                    });\n\n                    if ( typeof options.response === \"string\") {\n                        p.setXMLString(options.response);\n                    } else {\n                        p.setXMLDoc(options.response);\n                    }\n\n                    data = p.parse();\n\n                    if (!data) {\n                        throw new Error(\"L'analyse de la rponse du service !?\");\n                    }\n                } catch (e) {\n\n                    var message = e.message;\n                    if ( typeof options.response === \"string\") {\n                        message += \"('\" + options.response + \"')\";\n                    } else {\n                        message += \"('\" + options.response.documentElement.innerHTML + \"')\";\n                    }\n                    options.onError.call(options.scope, new __WEBPACK_IMPORTED_MODULE_1__Exceptions_ErrorService__[\"a\" /* default */]({\n                        message : __WEBPACK_IMPORTED_MODULE_2__Utils_MessagesResources__[\"a\" /* default */].getMessage(\"SERVICE_RESPONSE_ANALYSE\", message),\n                        type : __WEBPACK_IMPORTED_MODULE_1__Exceptions_ErrorService__[\"a\" /* default */].TYPE_UNKERR,\n                        status : -1\n                    }));\n                    return;\n                }\n\n                // Si la rponse contenait une exception renvoye par le service\n                if (data.exceptionReport) {\n                    options.onError.call(options.scope, new __WEBPACK_IMPORTED_MODULE_1__Exceptions_ErrorService__[\"a\" /* default */]({\n                        message : __WEBPACK_IMPORTED_MODULE_2__Utils_MessagesResources__[\"a\" /* default */].getMessage(\"SERVICE_RESPONSE_EXCEPTION\", data.exceptionReport),\n                        type : __WEBPACK_IMPORTED_MODULE_1__Exceptions_ErrorService__[\"a\" /* default */].TYPE_SRVERR,\n                        status : 200 // FIXME : 200 ?\n                    }));\n                    return;\n                }\n            }\n        } else {\n            options.onError.call(options.scope, new __WEBPACK_IMPORTED_MODULE_1__Exceptions_ErrorService__[\"a\" /* default */]({\n                message : __WEBPACK_IMPORTED_MODULE_2__Utils_MessagesResources__[\"a\" /* default */].getMessage(\"SERVICE_RESPONSE_EMPTY\"),\n                type : __WEBPACK_IMPORTED_MODULE_1__Exceptions_ErrorService__[\"a\" /* default */].TYPE_SRVERR,\n                status : -1 // FIXME : status response\n            }));\n            return;\n        }\n\n        options.onSuccess.call(options.scope, data);\n        return;\n    }\n};\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (DirectGeocodeReponseFactory);\n\n\n/***/ }),\n/* 77 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__ = __webpack_require__(1);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__Exceptions_ErrorService__ = __webpack_require__(2);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__Response_model_GeocodeResponse__ = __webpack_require__(14);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__Response_model_DirectGeocodedLocation__ = __webpack_require__(39);\n\n/**\n * Fonction retournant un objet contenant des cls de lecture (readers)\n *      qui permettent de parser des rponses XML du service de gocodage direct du Goportail\n *      afin de rcuprer les rsultats retourns.\n * @module DirectGeocodeResponseReader\n * @alias Gp.Services.Geocode.Formats.DirectGeocodeResponseReader\n * @private\n */\n\n\n\n\n\n\n\n/**\n * @member DirectGeocodeResponseReader\n */\nvar DirectGeocodeResponseReader = {};\n\n/**\n * @property {String} DirectGeocodeResponseReader.VERSION - version du service de gocodage\n */\nDirectGeocodeResponseReader.VERSION = \"1.2\";\n\n/**\n * Objet stockant les diffrents namespaces et les URI associes\n */\nDirectGeocodeResponseReader.NAMESPACES = {\n    xmlns : \"http://www.opengis.net/xls\",\n    gml : \"http://www.opengis.net/gml\",\n    xls : \"http://www.opengis.net/xls\",\n    xlsext : \"http://www.opengis.net/xlsext\",\n    xsi : \"http://www.w3.org/2001/XMLSchema-instance\"\n};\n\n/**\n * Localisation (URL) du schema de dfinition du XML (XSD)\n */\nDirectGeocodeResponseReader.SCHEMALOCATION = \"http://wxs.ign.fr/schemas/olsAll.xsd\";\n\n/**\n * Namespace par dfaut du format\n */\nDirectGeocodeResponseReader.DEFAULTPREFIX = \"xls\";\n\n/**\n * Objet contenant des fonctions de lecture, appeles \"READERS\"\n *      dont chaque cl correspond au nom d'un tag du XML que l'on souhaite lire\n *      et la valeur associe est une fonction (node, data)\n *      o node est un noeud du document DOM\n *      et data est un objet o l'on stocke les informations lues dans le XML.\n */\nDirectGeocodeResponseReader.READERS = {\n\n    xls : {\n\n        /** TODO : jsdoc block */\n        XLS : function (root) {\n\n            var geocodeResponse = new __WEBPACK_IMPORTED_MODULE_3__Response_model_GeocodeResponse__[\"a\" /* default */]();\n\n            // vrification de la version du service, et des namespaces de l'en-tte\n            __checkServiceAttributes(root);\n\n            // puis lancement de la lecture de l'ensemble des noeuds, en bouclant sur les childNodes\n            __getChildNodes(root, geocodeResponse);\n\n            return geocodeResponse;\n        },\n\n        /** TODO : jsdoc block */\n        GeocodedAddress : function (node, geocodeResponse) {\n\n            var geocodedLocation = new __WEBPACK_IMPORTED_MODULE_4__Response_model_DirectGeocodedLocation__[\"a\" /* default */]();\n\n            __getChildNodes(node, geocodedLocation);\n\n            // Ajout du rsultat au tableau geocodedLocations de geocodeReponse\n            if (geocodeResponse && Array.isArray(geocodeResponse.locations)) {\n                geocodeResponse.locations.push(geocodedLocation);\n            }\n        },\n\n        /** TODO : jsdoc block */\n        GeocodeMatchCode : function (node, geocodedLocation) {\n            var acc = node.getAttribute(\"accuracy\");\n            if (acc && geocodedLocation) {\n                geocodedLocation.accuracy = parseFloat(acc);\n            }\n            var matchType = node.getAttribute(\"matchType\");\n            if (matchType && geocodedLocation) {\n                geocodedLocation.matchType = matchType;\n            }\n        },\n\n        /** TODO : jsdoc block */\n        Address : function (node, geocodedLocation) {\n            var countrycode = node.getAttribute(\"countryCode\");\n            if (geocodedLocation && countrycode) {\n                geocodedLocation.type = countrycode;\n            }\n            // on va rcuprer les autres informations (StreetAddress, place, postalCode...)\n            __getChildNodes(node, geocodedLocation);\n        },\n\n        /** TODO : jsdoc block */\n        freeFormAddress : function (node, geocodedLocation) {\n            if (geocodedLocation && geocodedLocation.hasOwnProperty(\"placeAttributes\")) {\n                geocodedLocation.placeAttributes.freeform = __getChildValue(node);\n            }\n        },\n\n        /** TODO : jsdoc block */\n        Building : function (node, geocodedLocation) {\n            var num = node.getAttribute(\"number\");\n            if (geocodedLocation && geocodedLocation.hasOwnProperty(\"placeAttributes\")) {\n                if (num) {\n                    geocodedLocation.placeAttributes.number = num;\n                } else if (node.getAttribute(\"buildingName\")) {\n                    geocodedLocation.placeAttributes.number = node.getAttribute(\"buildingName\");\n                } else if (node.getAttribute(\"subdivision\")) {\n                    geocodedLocation.placeAttributes.number = node.getAttribute(\"subdivision\");\n                }\n            }\n        },\n\n        /** TODO : jsdoc block */\n        Street : function (node, geocodedLocation) {\n            if (geocodedLocation && geocodedLocation.hasOwnProperty(\"placeAttributes\")) {\n                // in case of a streetAddress result : street represents the street name\n                if (geocodedLocation.type === \"StreetAddress\") {\n                    geocodedLocation.placeAttributes.street = __getChildValue(node);\n\n                    // in case of a cadastral parcel result : street represents the cadastral parcel identifier\n                } else if (geocodedLocation.type === \"CadastralParcel\") {\n                    geocodedLocation.placeAttributes.cadastralParcel = __getChildValue(node);\n                }\n            }\n        },\n\n        /** TODO : jsdoc block */\n        Place : function (node, geocodedLocation) {\n            var placeType = node.getAttribute(\"type\");\n            var placeName = __getChildValue(node);\n\n            if (geocodedLocation && geocodedLocation.hasOwnProperty(\"placeAttributes\")) {\n\n                if (placeType === \"Municipality\") {\n                    geocodedLocation.placeAttributes.municipality = placeName;\n\n                } else if (placeType === \"Bbox\") {\n                    var values = placeName.split(\";\");\n                    if (values.length === 4) {\n                        geocodedLocation.placeAttributes.bbox = {\n                            left : parseFloat(values[0]),\n                            right : parseFloat(values[2]),\n                            top : parseFloat(values[1]),\n                            bottom : parseFloat(values[3])\n                        };\n                    }\n\n                } else if (placeType === \"Commune\") {\n                    geocodedLocation.placeAttributes.commune = placeName;\n\n                } else if (placeType === \"Departement\") {\n                    geocodedLocation.placeAttributes.department = placeName;\n\n                } else if (placeType === \"INSEE\") {\n                    geocodedLocation.placeAttributes.insee = placeName;\n\n                } else if (placeType === \"Qualite\") {\n                    geocodedLocation.placeAttributes.quality = placeName;\n\n                } else if (placeType === \"Territoire\") {\n                    geocodedLocation.placeAttributes.territory = placeName;\n\n                } else if (placeType === \"ID\") {\n                    geocodedLocation.placeAttributes.ID = placeName;\n\n                } else if (placeType === \"ID_TR\") {\n                    geocodedLocation.placeAttributes.IDTR = placeName;\n\n                } else if (placeType === \"Importance\") {\n                    geocodedLocation.placeAttributes.importance = parseInt(placeName, 10);\n\n                } else if (placeType === \"Nature\") {\n                    geocodedLocation.placeAttributes.nature = placeName;\n\n                } else if (placeType === \"Numero\") {\n                    geocodedLocation.placeAttributes.number = placeName;\n\n                } else if (placeType === \"Feuille\") {\n                    geocodedLocation.placeAttributes.sheet = placeName;\n\n                } else if (placeType === \"Section\") {\n                    geocodedLocation.placeAttributes.section = placeName;\n\n                } else if (placeType === \"CommuneAbsorbee\") {\n                    geocodedLocation.placeAttributes.absorbedCity = placeName;\n\n                } else if (placeType === \"Arrondissement\") {\n                    if (placeName) {\n                        geocodedLocation.placeAttributes.arrondissement = placeName;\n                    }\n\n                } else if (placeType === \"Type\") {\n                    geocodedLocation.placeAttributes.origin = placeName;\n\n                } else if (placeType === \"Prefecture\") {\n                    geocodedLocation.placeAttributes.prefecture = placeName;\n\n                } else if (placeType === \"InseeRegion\") {\n                    geocodedLocation.placeAttributes.inseeRegion = placeName;\n\n                } else if (placeType === \"InseeDepartment\") {\n                    geocodedLocation.placeAttributes.inseeDepartment = placeName;\n\n                }\n            }\n        },\n\n        /** TODO : jsdoc block */\n        PostalCode : function (node, geocodedLocation) {\n            if (geocodedLocation && geocodedLocation.hasOwnProperty(\"placeAttributes\")) {\n                geocodedLocation.placeAttributes.postalCode = __getChildValue(node);\n            }\n        },\n\n        /** TODO : jsdoc block */\n        Error : function (node) {\n            // on imagine qu'on a une balise ainsi :\n            // <Error message=\"Message...\" errorCode=\"InternalServerError\"/>\n            var srvMess = node.getAttribute(\"message\");\n            var errorCode = node.getAttribute(\"errorCode\");\n            var message = __WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__[\"a\" /* default */].getMessage(\"SERVICE_RESPONSE_EXCEPTION\",\n                \"(\" + errorCode + \") : \" + srvMess);\n            throw new __WEBPACK_IMPORTED_MODULE_2__Exceptions_ErrorService__[\"a\" /* default */]({\n                message : message,\n                type : __WEBPACK_IMPORTED_MODULE_2__Exceptions_ErrorService__[\"a\" /* default */].TYPE_SRVERR\n            });\n        }\n    },\n\n    gml : {\n\n        /** TODO : jsdoc block */\n        pos : function (node, geocodedLocation) {\n            var pos = __getChildValue(node);\n            if (geocodedLocation && pos) {\n                geocodedLocation.position = {\n                    x : parseFloat(pos.split(\" \")[0]),\n                    y : parseFloat(pos.split(\" \")[1])\n                };\n            }\n        }\n    },\n\n    /** TODO : jsdoc block */\n    ExceptionReport : function (node) {\n        var response = {};\n        if (node.hasChildNodes()) {\n            var children = node.childNodes;\n            var child;\n            for (var i = 0; i < children.length; i++) {\n                child = children[i];\n                if (child.nodeName === \"Exception\") {\n                    response.exceptionReport = DirectGeocodeResponseReader.READERS[\"Exception\"](child);\n                }\n            }\n        }\n        return response;\n    },\n\n    /** TODO : jsdoc block */\n    Exception : function (node) {\n        var exceptionReport = {};\n\n        // get exception code\n        var exceptionCode = node.getAttribute(\"exceptionCode\");\n        if (exceptionCode) {\n            exceptionReport.exceptionCode = exceptionCode;\n        }\n\n        // get exception message\n        var textNode = node.firstChild;\n        if (textNode && textNode.nodeType === 3) { // 3 == node.TEXT_NODE\n            exceptionReport.exception = textNode.nodeValue;\n        }\n\n        return exceptionReport;\n    }\n\n};\n\n/**\n * Mthode permettant de lancer la lecture d'une rponse XML du service de gocodage,\n *       l'aide des READERS de la classe.\n *\n * @method DirectGeocodeResponseReader.read\n * @param {DOMElement} root - racine de la rponse XML  lire\n * @return {Object} geocodeResponse|exceptionReport : l'objet contenant les informations de la rponse XML,\n *      sous la forme d'un objet GeocodeResponse, ou un objet littral exceptionReport si le service a renvoy une exception.\n * @static\n * @memberof DirectGeocodeResponseReader\n */\nDirectGeocodeResponseReader.read = function (root) {\n\n    if (root.nodeName === \"XLS\") {\n        var nsPrefix = root.prefix;\n        if (!nsPrefix) {\n            nsPrefix = DirectGeocodeResponseReader.DEFAULTPREFIX;\n        }\n        var geocodeResponse = DirectGeocodeResponseReader.READERS[nsPrefix][root.nodeName](root);\n        return geocodeResponse;\n\n    } else if (root.nodeName === \"ExceptionReport\") {\n        var exceptionReport = DirectGeocodeResponseReader.READERS[root.nodeName](root);\n        return exceptionReport;\n\n    } else {\n        var mess = __WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__[\"a\" /* default */].getMessage(\"SERVICE_RESPONSE_ANALYSE\", root.nodeName);\n        throw new __WEBPACK_IMPORTED_MODULE_2__Exceptions_ErrorService__[\"a\" /* default */]({\n            message : mess,\n            type : __WEBPACK_IMPORTED_MODULE_2__Exceptions_ErrorService__[\"a\" /* default */].TYPE_UNKERR,\n            status : 200\n        });\n    }\n};\n\n/**\n * Rcupration des attributs d'un noeud lment\n *\n * @private\n * @memberof DirectGeocodeResponseReader\n * @method __getAttributes\n * @param {DOMElement} node - noeud contenant l'attribut recherch\n * @return {Object} nodeAttributes - objet contenant les noms et valeurs des diffrents attributs\n */\nfunction __getAttributes (node) {\n    if (node.attributes.length > 0) {\n        var nodeAttributes = {};\n        var attributes = node.attributes;\n        for (var i = 0; i < attributes.length; i++) {\n            var attribute = attributes[i];\n            nodeAttributes[attribute.nodeName] = attribute.nodeValue;\n        }\n        return nodeAttributes;\n    }\n}\n\n/**\n * Rcupration des noeuds enfants  partir d'un noeud donn, pour lecture (readNode).\n *\n * @private\n * @memberof DirectGeocodeResponseReader\n * @method __getChildNodes\n * @param {DOMElement} node - a DOM node\n * @param {Array|Object} [data] - an object to be filled with node data\n */\nfunction __getChildNodes (node, data) {\n\n    if (node.hasChildNodes()) {\n\n        var children = node.childNodes;\n        var child;\n        var childName;\n        var childPrefix;\n\n        for (var i = 0; i < children.length; i++) {\n            child = children[i];\n\n            if (child.nodeType === 1) { // 1 == node.ELEMENT_NODE\n                childName = child.localName || child.baseName || child.nodeName;\n                childPrefix = child.prefix || DirectGeocodeResponseReader.DEFAULTPREFIX;\n\n                if (DirectGeocodeResponseReader.READERS[childPrefix][childName]) {\n                    var reader = DirectGeocodeResponseReader.READERS[childPrefix][childName];\n                    reader(child, data);\n                } else {\n                    __getChildNodes(child, data);\n                }\n            }\n        }\n    }\n}\n\n/**\n * Lecture de la valeur du premier child d'un noeud, si elle existe.\n *\n * @private\n * @memberof DirectGeocodeResponseReader\n * @method __getChildValue\n * @param {DOMElement} node - a DOM node\n * @return {String} value - valeur du firstChild du noeud en entre, ou chane vide.\n */\nfunction __getChildValue (node) {\n\n    var textNode;\n    var value = \"\";\n\n    if (node.hasChildNodes()) {\n        textNode = node.firstChild;\n        if (textNode.nodeType === 3) { // 3 == node.TEXT_NODE\n            value = textNode.nodeValue;\n        }\n    }\n    return value;\n}\n\n/**\n * Vrification des attributs du service, dans la balise XLS de la rponse :\n *      version, namespaces, et namespace par dfaut doivent correspondre  ceux attendus.\n *\n * @private\n * @memberof DirectGeocodeResponseReader\n * @method __checkServiceAttributes\n * @param {DOMElement} XLSNode - a DOM node, corresponding to XLS first tag.\n */\nfunction __checkServiceAttributes (XLSNode) {\n\n    if (XLSNode.attributes.length > 0) {\n\n        // on rcupre et parcourt les attributs de la balise XLS de la rponse\n        var xlsAttributes = __getAttributes(XLSNode);\n        for (var att in xlsAttributes) {\n            if (xlsAttributes.hasOwnProperty(att)) {\n\n                // vrification de la version\n                if (att === \"version\") {\n                    if (xlsAttributes[\"version\"] !== DirectGeocodeResponseReader.VERSION) {\n                        console.log(\"[DirectGeocodeResponseReader] geocode version is not the expected one : there may be errors in parsing\");\n                        return;\n                    }\n                }\n\n                // on vrifie que l'uri du namespace par dfaut est bien celle que l'on attend\n                if (att === \"xmlns\") {\n                    if (xlsAttributes[att] !== DirectGeocodeResponseReader.NAMESPACES[DirectGeocodeResponseReader.DEFAULTPREFIX]) {\n                        console.log(\"[DirectGeocodeResponseReader] geocode response default namespace is not the expected one\");\n                        return;\n                    }\n                    continue;\n                }\n\n                var prefix = att.split(\":\")[0];\n                var ns = att.split(\":\")[1];\n\n                // si on a un autre xmlns, on vrifie aussi les URI\n                if (prefix === \"xmlns\" && ns) {\n                    // si l'attribut correspond  un namespace dfini dans le reader\n                    if (DirectGeocodeResponseReader.NAMESPACES[ns]) {\n                        // il faut que les URI correspondent aussi.\n                        if (DirectGeocodeResponseReader.NAMESPACES[ns] !== xlsAttributes[att]) {\n                            console.log(\"[DirectGeocodeResponseReader] geocode response \" + att + \" namespace is not the expected one\");\n                            return;\n                        }\n                    }\n                }\n\n                // pour finir on vrifie la localisation du schema XSD du service\n                if (ns === \"schemaLocation\") {\n                    if (DirectGeocodeResponseReader.SCHEMALOCATION !== xlsAttributes[att]) {\n                        console.log(\"[DirectGeocodeResponseReader] geocode response schema location is not the expected one\");\n                        return;\n                    }\n                }\n\n            }\n        }\n    }\n}\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (DirectGeocodeResponseReader);\n\n\n/***/ }),\n/* 78 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__ = __webpack_require__(1);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__Exceptions_ErrorService__ = __webpack_require__(2);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__CommonService__ = __webpack_require__(3);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__Request_ReverseGeocodeRequestFactory__ = __webpack_require__(79);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__Response_ReverseGeocodeResponseFactory__ = __webpack_require__(80);\n\n\n\n\n\n\n\n\n/**\n * @classdesc\n * Appel du service de gocodage inverse du Goportail :\n *     envoi de la requte construite selon les paramtres en options,\n *     ventuellement parsing et analyse  de la rponse,\n *     retour d'une rponse en paramtre de la fonction onSuccess.\n * @constructor\n * @extends {Gp.Services.CommonService}\n * @alias Gp.Services.ReverseGeocode\n *\n * @param {Object} options - options spcifiques au service (+ les options herites)\n *\n * @param {Object} options.position - Position du point de rfrence pour le calcul de proximit exprime dans le systme de rfrence spcifi par le srs.\n *      @param {Float} options.position.x - Abcisse du point de rfrence pour le calcul de proximit exprime dans le systme de rfrence spcifi par le srs. (= longitude si srs = \"CRS:84\", latitude si srs = \"EPSG:4326\")\n *      @param {Float} options.position.y - Ordonne du point de rfrence pour le calcul de proximit exprime dans le systme de rfrence spcifi par le srs. (= latitude si srs = \"CRS:84\", longitude si srs = \"EPSG:4326\")\n *\n * @param {Object} [options.filterOptions] - Les proprits possibles de cet objet sont dcrites ci-aprs.\n * @param {Object} [options.filterOptions.bbox] - Emprise dans laquelle on souhaite effectuer la recherche.\n *      Les proprits possibles de cet objet sont dcrites ci-aprs.\n *      @param {Float} options.filterOptions.bbox.left   - Abscisse du ct gauche de la BBOX\n *      @param {Float} options.filterOptions.bbox.right  - Abscisse du ct droit de la BBOX\n *      @param {Float} options.filterOptions.bbox.top    - Ordonne suprieure de la BBOX\n *      @param {Float} options.filterOptions.bbox.bottom - Ordonne infrieure de la BBOX\n *\n * @param {Object} [options.filterOptions.circle] - Cercle dans lequel on souhaite effectuer la recherche.\n *      Les proprits possibles de cet objet sont dcrites ci-aprs.\n *      @param {Float} options.filterOptions.circle.x      - Abscisse du centre du cercle de recherche.\n *      @param {Float} options.filterOptions.circle.y      - Ordonne du centre du cercle de recherche.\n *      @param {Float} options.filterOptions.circle.radius - Rayon du cercle de recherche.\n *\n * @param {Array.<Object>} [options.filterOptions.polygon] - Polygone dans lequel on souhaite effectuer la recherche.\n *      Liste des couples x et y pour chaque point constituant le polygone.\n *\n * @param {Array.<String>} [options.filterOptions.type = \"StreetAddress\"] - Type de l'objet recherch.\n *      Le service de gocodage du Goportail permet de rechercher des 'PostionOfInterest' pour des toponymes, des 'StreetAddress'\n *      pour des adresses postales et/ou des 'CadastralParcel' pour des parcelles cadastrales.\n *      D'autres types pourront tre rajouts selon l'volution du service.\n *      Par dfaut, type = ['StreetAddress'].\n *\n * @param {Number} [options.maximumResponses] - Nombre de rponses maximal que l'on souhaite recevoir.\n *      Pas de valeur par dfaut. Si le serveur consult est celui du Goportail, la valeur par dfaut sera donc celle du service : 25.\n *\n * @param {String} [options.srs = CRS:84] - Systme de coordonnes dans lequel les paramtres gographiques en entre et la rponse du service sont exprims.\n *      Pas de valeur par dfaut.\n *      Si le serveur consult est celui du Goportail, la valeur par dfaut est : \"CRS:84\".\n *\n * @example\n *   var options = {\n *      apiKey : null,\n *      serverUrl : 'http://localhost/service/',\n *      protocol : 'JSONP', // JSONP|XHR\n *      proxyURL : null,\n *      httpMethod : 'GET', // GET|POST\n *      timeOut : 10000, // ms\n *      rawResponse : false, // true|false\n *      scope : null, // this\n *      onSuccess : function (response) {},\n *      onFailure : function (error) {},\n *      // spcifique au service\n *      position : {x:0 , y:0},\n *      filterOptions :{\n *          bbox : {left : 0, right : 1, top : 1, bottom : 0},\n *          [circle : {\n *              x : 0,\n *              y : 0,\n *              radius : 100\n *          }]\n *          [polygon  : [{x:0,y:0}, {x:1,y:1}, {x:2,y:2}, {x:3,y:2}, {x:4,y:1}, {x:0,y:0}]]\n *          type : ['StreetAddress']\n *      },\n *      maximumResponses : 25,\n *      srs : 'EPSG:4326'\n *   };\n *\n * @private\n */\nfunction ReverseGeocode (options) {\n\n    if (!(this instanceof ReverseGeocode)) {\n        throw new TypeError(__WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__[\"a\" /* default */].getMessage(\"CLASS_CONSTRUCTOR\", \"ReverseGeocode\"));\n    }\n\n    /**\n     * Nom de la classe (heritage)\n     * FIXME instance ou classe ?\n     */\n    this.CLASSNAME = \"ReverseGeocode\";\n\n    // appel du constructeur par heritage\n    __WEBPACK_IMPORTED_MODULE_3__CommonService__[\"a\" /* default */].apply(this, arguments);\n\n    this.logger = __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__[\"a\" /* default */].getLogger(\"Gp.Services.ReverseGeocode\");\n    this.logger.trace(\"[Constructeur ReverseGeocode (options)]\");\n\n    if (!options.position) {\n        throw new Error(__WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__[\"a\" /* default */].getMessage(\"PARAM_MISSING\", \"position\"));\n    }\n\n    // on lance une exception afin d'eviter au service de le faire...\n    if (options.position.x == null) {\n        throw new Error(__WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__[\"a\" /* default */].getMessage(\"PARAM_MISSING\", \"position.x\"));\n    }\n\n    if (options.position.y == null) {\n        throw new Error(__WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__[\"a\" /* default */].getMessage(\"PARAM_MISSING\", \"position.y\"));\n    }\n\n    // ajout des options spcifiques au service\n    this.options.position = options.position;\n\n    // on definit des filtres par defaut\n    if (!options.filterOptions || typeof options.filterOptions !== \"object\") {\n        this.options.filterOptions = options.filterOptions = {\n            type : [\"StreetAddress\"]\n        };\n    }\n\n    // FIXME ECMAScript 5 support (valable pour un objet uniquement !)\n    // ceci permet de tester le cas o : object = {}\n    if (Object.keys(options.filterOptions).length === 0) {\n        this.options.filterOptions = {\n            type : [\"StreetAddress\"]\n        };\n    }\n\n    // on teste pour chaque filtre, les conditions suivantes : null ou vide !\n    var filter = Object.keys(options.filterOptions);\n    for (var i = 0; i < filter.length; i++) {\n        var key = filter[i];\n        if (!options.filterOptions[key] || Object.keys(options.filterOptions[key]).length === 0) {\n            delete this.options.filterOptions[key];\n        }\n    }\n\n    this.options.filterOptions.type = options.filterOptions.type || [\"StreetAddress\"];\n    // on vrifie que le type est bien dans un tableau\n    if (!Array.isArray(this.options.filterOptions.type)) {\n        throw new Error(__WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__[\"a\" /* default */].getMessage(\"PARAM_TYPE\", \"filterOptions.type\"));\n    }\n\n    this.options.maximumResponses = options.maximumResponses || 25;\n\n    // FIXME : cet attribut (returnFreeForm) n'est pas spcifi dans la doc du constructeur ?\n    // Il est inutile en effet, mais prsent dans les specs...\n    this.options.returnFreeForm = options.returnFreeForm || false;\n    // info : en ralit le service ne reconnait que EPSG:4326. this.options.srs permet essentiellement de diffrencier EPSG:4326 (lat,lon) et CRS:84 (lon,lat)\n    this.options.srs = options.srs || \"CRS:84\";\n\n    // si on n'a pas un systeme de coordonnes EPSG gographique, il faut inverser les coordonnes\n    // (car elles sont en lon, lat alors que le service attend une position en lat, lon).\n    // dans le cas d'EPSG:4326 par exemple, les coordonnes sont bien en lat, lon donc on ne fait rien.\n    if (ReverseGeocode.geoEPSG.indexOf(this.options.srs) === -1) {\n        // pour la position\n        this.options.position = {\n            x : this.options.position.y,\n            y : this.options.position.x\n        };\n        // pour les filtres spatiaux s'ils sont spcifis\n        if (this.options.filterOptions && this.options.filterOptions.circle) {\n            var circle = this.options.filterOptions.circle;\n            this.options.filterOptions.circle = {\n                x : circle.y,\n                y : circle.x,\n                radius : circle.radius\n            };\n        }\n        if (this.options.filterOptions && this.options.filterOptions.polygon) {\n            var polygon = this.options.filterOptions.polygon;\n            for (i = 0; i < polygon.length; i++) {\n                var coords = polygon[i];\n                this.options.filterOptions.polygon[i] = {\n                    x : coords.y,\n                    y : coords.x\n                };\n            }\n        }\n    }\n\n    // attributs d'instances\n\n    /**\n     * Format forc de la rponse du service : \"xml\"\n     * sauf si l'on souhaite une reponse brute (options.rawResponse)\n     */\n    this.options.outputFormat = (this.options.rawResponse) ? \"\" : \"xml\";\n}\n\n/**\n * @lends module:ReverseGeocode#\n */\nReverseGeocode.prototype = Object.create(__WEBPACK_IMPORTED_MODULE_3__CommonService__[\"a\" /* default */].prototype, {\n    // todo\n    // getter/setter\n});\n\n/*\n * Constructeur (alias)\n */\nReverseGeocode.prototype.constructor = ReverseGeocode;\n\n/**\n * (overwrite)\n * Cration de la requte\n *\n * @param {Function} error   - callback des erreurs\n * @param {Function} success - callback\n */\nReverseGeocode.prototype.buildRequest = function (error, success) {\n\n    var options = {\n        httpMethod : this.options.httpMethod,\n        // options specifiques du service\n        position : this.options.position,\n        returnFreeForm : this.options.returnFreeForm,\n        filterOptions : this.options.filterOptions,\n        srs : \"EPSG:4326\", // info : en ralit le service ne reconnait que EPSG:4326. this.options.srs permet essentiellement de diffrencier EPSG:4326 (lat,lon) et CRS:84 (lon,lat)\n        maximumResponses : this.options.maximumResponses\n    };\n\n    this.request = __WEBPACK_IMPORTED_MODULE_4__Request_ReverseGeocodeRequestFactory__[\"a\" /* default */].build(options);\n\n    // on teste si la requete a bien t construite !\n    if (!this.request) {\n        error.call(this, new __WEBPACK_IMPORTED_MODULE_2__Exceptions_ErrorService__[\"a\" /* default */](__WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__[\"a\" /* default */].getMessage(\"SERVICE_REQUEST_BUILD\")));\n    } else {\n        success.call(this, this.request);\n    }\n};\n\n/**\n * (overwrite)\n * Analyse de la reponse\n *\n * @param {Function} error   - callback des erreurs\n * @param {Function} success - callback\n */\nReverseGeocode.prototype.analyzeResponse = function (error, success) {\n\n    if (this.response) {\n\n        var options = {\n            response : this.response,\n            rawResponse : this.options.rawResponse,\n            onError : error,\n            onSuccess : success,\n            scope : this\n        };\n\n        __WEBPACK_IMPORTED_MODULE_5__Response_ReverseGeocodeResponseFactory__[\"a\" /* default */].build(options);\n\n    } else {\n        error.call(this, new __WEBPACK_IMPORTED_MODULE_2__Exceptions_ErrorService__[\"a\" /* default */](__WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__[\"a\" /* default */].getMessage(\"SERVICE_RESPONSE_EMPTY\")));\n    }\n\n};\n\n/**\n * Codes EPSG gographiques (lat/lon). Utiles car les coordonnes doivent tre inverses.\n */\nReverseGeocode.geoEPSG = [\"EPSG:4326\"];\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (ReverseGeocode);\n\n\n/***/ }),\n/* 79 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__Formats_XLS__ = __webpack_require__(11);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__Formats_XLS_LocationUtilityService__ = __webpack_require__(38);\n/**\n * Creation d'une requte OpenLS en mode POST ou GET\n * (Factory)\n *\n * @module ReverseGeocodeRequestFactory\n * @alias Gp.Services.Geocode.Request.ReverseGeocodeRequestFactory\n * @private\n */\n\n\n\n\nvar ReverseGeocodeRequestFactory = {\n\n    /**\n     * interface unique\n     *\n     * @method build\n     * @static\n     * @param {Object} options - options definies dans le composant Geocode\n     *\n     * @example\n     *   var options = {\n     *      httpMethod :\n     *      // options specifiques du service\n     *      position :\n     *      returnFreeForm :\n     *      filterOptions :\n     *      srs :\n     *      maximumResponses :\n     *   };\n     *   var result = ReverseGeocodeRequestFactory.build(options);\n     *   if (!result) {\n     *       // error...\n     *   }\n     * @returns {String} request\n     */\n    build : function (options) {\n\n        // logger\n        var logger = __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__[\"a\" /* default */].getLogger(\"ReverseGeocodeRequestFactory\");\n        logger.trace([\"ReverseGeocodeRequestFactory::build()\"]);\n\n        // options non definies\n        var settings = options || {};\n\n        var request = null;\n\n        // objet LUS\n        var oLUS = new __WEBPACK_IMPORTED_MODULE_2__Formats_XLS_LocationUtilityService__[\"a\" /* default */]({\n            position : settings.position,\n            returnFreeForm : settings.returnFreeForm,\n            filterOptions : settings.filterOptions\n        });\n\n        // Format XLS\n        var oXLS = new __WEBPACK_IMPORTED_MODULE_1__Formats_XLS__[\"a\" /* default */]({\n            srsName : settings.srs,\n            maximumResponses : settings.maximumResponses\n        });\n        oXLS.namespace = true;\n        oXLS.setService(oLUS);\n\n        // request brute !\n        request = oXLS.build();\n\n        // en mode GET, la requte est encode\n        // et le param. 'qxml' est ajout\n        if (settings.httpMethod == \"GET\") {\n            var myRequest = \"qxml=\" +\n                encodeURIComponent(request)\n                .replace(/\\-/g, \"%2D\")\n                .replace(/\\_/g, \"%5F\")\n                .replace(/\\./g, \"%2E\")\n                .replace(/\\!/g, \"%21\")\n                .replace(/\\~/g, \"%7E\")\n                .replace(/\\*/g, \"%2A\")\n                .replace(/\\'/g, \"%27\")\n                .replace(/\\(/g, \"%28\")\n                .replace(/\\)/g, \"%29\");\n            request = myRequest;\n        }\n\n        logger.trace(request);\n\n        return request;\n    }\n};\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (ReverseGeocodeRequestFactory);\n\n\n/***/ }),\n/* 80 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__ = __webpack_require__(1);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__Exceptions_ErrorService__ = __webpack_require__(2);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__Formats_XML__ = __webpack_require__(4);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__Formats_ReverseGeocodeResponseReader__ = __webpack_require__(81);\n/**\n * Factory pour gnrer une reponse JSON  partir d'un XML\n * ou d'un JSON encapsulant du XML\n * (Factory)\n *\n * @module ReverseGeocodeResponseFactory\n * @alias Gp.Services.ReverseGeocode.Response.ReverseGeocodeResponseFactory\n * @todo La reponse JSON peut encapsuler un XML !\n * @private\n */\n\n\n\n\n\n\nvar ReverseGeocodeReponseFactory = {\n\n    /**\n     * interface unique\n     *\n     * @method build\n     * @static\n     * @param {Object} options - options definies dans le composant ReverseGeocode\n     *\n     * @example\n     *   var options = {\n     *      response :\n     *      rawResponse :\n     *      scope :\n     *      onSuccess :\n     *      onError :\n     *   };\n     *\n     */\n    build : function (options) {\n\n        // data de type ReverseGeocodeResponse\n        var data = null;\n\n        if (options.response) {\n            if (options.rawResponse) {\n                data = options.response;\n            } else {\n\n                try {\n\n                    var p = new __WEBPACK_IMPORTED_MODULE_3__Formats_XML__[\"a\" /* default */]({\n                        reader : __WEBPACK_IMPORTED_MODULE_4__Formats_ReverseGeocodeResponseReader__[\"a\" /* default */]\n                    });\n\n                    if ( typeof options.response === \"string\") {\n                        p.setXMLString(options.response);\n                    } else {\n                        p.setXMLDoc(options.response);\n                    }\n\n                    data = p.parse();\n\n                    if (!data) {\n                        throw new Error(\"L'analyse de la rponse du service !?\");\n                    }\n                } catch (e) {\n                    // on relaye l'erreur reue\n                    e.status = 200;\n                    options.onError.call(options.scope, e);\n                    return;\n                }\n\n                // Si la rponse contenait une exception renvoye par le service\n                // TODO : quand cela arrive-t-il ?\n                if (data.exceptionReport) {\n                    options.onError.call(options.scope, new __WEBPACK_IMPORTED_MODULE_2__Exceptions_ErrorService__[\"a\" /* default */]({\n                        message : __WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__[\"a\" /* default */].getMessage(\"SERVICE_RESPONSE_EXCEPTION\", data.exceptionReport),\n                        type : __WEBPACK_IMPORTED_MODULE_2__Exceptions_ErrorService__[\"a\" /* default */].TYPE_SRVERR,\n                        status : 200\n                    }));\n                    return;\n                }\n\n                // dans le cas d'un srs non EPSG gographique, il faut rinverser les coordonnes (lat,lon => lon,lat)\n                if (options.scope && options.scope.options && options.scope.options.srs && options.scope.options.srs !== \"EPSG:4326\") {\n                    var location;\n                    var pos;\n                    if (data || data.locations || data.locations.length) {\n                        for (var i = 0; i < data.locations.length; i++) {\n                            location = data.locations[i];\n                            if (location) {\n                                pos = location.position;\n                                if (pos) {\n                                    // on inverse les 2 coordonnes\n                                    location.position = {\n                                        x : pos.y,\n                                        y : pos.x\n                                    };\n                                }\n                            }\n                        }\n                    }\n                }\n\n            }\n        } else {\n            options.onError.call(options.scope, new __WEBPACK_IMPORTED_MODULE_2__Exceptions_ErrorService__[\"a\" /* default */]({\n                message : __WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__[\"a\" /* default */].getMessage(\"SERVICE_RESPONSE_EMPTY\"),\n                type : __WEBPACK_IMPORTED_MODULE_2__Exceptions_ErrorService__[\"a\" /* default */].TYPE_SRVERR,\n                status : -1 // FIXME : status response\n            }));\n            return;\n        }\n\n        options.onSuccess.call(options.scope, data);\n        return;\n    }\n};\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (ReverseGeocodeReponseFactory);\n\n\n/***/ }),\n/* 81 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__ = __webpack_require__(1);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__Exceptions_ErrorService__ = __webpack_require__(2);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__Response_model_GeocodeResponse__ = __webpack_require__(14);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__Response_model_ReverseGeocodedLocation__ = __webpack_require__(40);\n\n/**\n * Fonction retournant un objet contenant des cls de lecture (readers)\n *      qui permettent de parser des rponses XML du service de gocodage inverse du Goportail\n *      afin de rcuprer les rsultats retourns.\n * @module ReverseGeocodeResponseReader\n * @alias Gp.Services.Geocode.Formats.ReverseGeocodeResponseReader\n * @private\n */\n\n\n\n\n\n\n\n/**\n * Objet ReverseGeocodeResponseReader\n * @member {Object} ReverseGeocodeResponseReader\n *\n * @property {String} ReverseGeocodeResponseReader.VERSION - Version du service de gocodage\n *\n * @property {Object} ReverseGeocodeResponseReader.NAMESPACES - Objet stockant les diffrents namespaces et les URI associes\n *\n * @property {String} ReverseGeocodeResponseReader.SCHEMALOCATION - Localisation (URL) du schema de dfinition du XML (XSD)\n *\n * @property {String} ReverseGeocodeResponseReader.DEFAULTPREFIX - Namespace par dfaut du format\n *\n * @property {Object} ReverseGeocodeResponseReader.READERS - Objet contenant des fonctions de lecture, appeles \"READERS\"\n *      dont chaque cl correspond au nom d'un tag du XML que l'on souhaite lire\n *      et la valeur associe est une fonction (node, data)\n *      o node est un noeud du document DOM\n *      et data est un objet o l'on stocke les informations lues dans le XML.\n *\n * @property {Method} ReverseGeocodeResponseReader.read - Mthode permettant de lancer la lecture d'une rponse XML du service de gocodage,\n *       l'aide des READERS de la classe.\n *\n */\n\nvar ReverseGeocodeResponseReader = {};\n\n/**\n * version du service de gocodage\n */\nReverseGeocodeResponseReader.VERSION = \"1.2\";\n\n/**\n * Objet stockant les diffrents namespaces et les URI associes\n */\nReverseGeocodeResponseReader.NAMESPACES = {\n    xmlns : \"http://www.opengis.net/xls\",\n    gml : \"http://www.opengis.net/gml\",\n    xls : \"http://www.opengis.net/xls\",\n    xlsext : \"http://www.opengis.net/xlsext\",\n    xsi : \"http://www.w3.org/2001/XMLSchema-instance\"\n};\n\n/**\n * Localisation (URL) du schema de dfinition du XML (XSD)\n */\nReverseGeocodeResponseReader.SCHEMALOCATION = \"http://wxs.ign.fr/schemas/olsAll.xsd\";\n\n/**\n * Namespace par dfaut du format\n */\nReverseGeocodeResponseReader.DEFAULTPREFIX = \"xls\";\n\n/**\n * Objet contenant des fonctions de lecture, appeles \"READERS\"\n *      dont chaque cl correspond au nom d'un tag du XML que l'on souhaite lire\n *      et la valeur associe est une fonction (node, data)\n *      o node est un noeud du document DOM\n *      et data est un objet o l'on stocke les informations lues dans le XML.\n */\nReverseGeocodeResponseReader.READERS = {\n\n    xls : {\n\n        /** TODO : jsdoc block */\n        XLS : function (root) {\n\n            var reverseGeocodeResponse = new __WEBPACK_IMPORTED_MODULE_3__Response_model_GeocodeResponse__[\"a\" /* default */] ();\n\n            // vrification de la version du service, et des namespaces de l'en-tte\n            __checkServiceAttributes (root);\n\n            // puis lancement de la lecture de l'ensemble des noeuds, en bouclant sur les childNodes\n            __getChildNodes (root, reverseGeocodeResponse);\n\n            return reverseGeocodeResponse;\n        },\n\n        /** TODO : jsdoc block */\n        ReverseGeocodedLocation : function (node, reverseGeocodeResponse) {\n\n            var reverseGeocodedLocation = new __WEBPACK_IMPORTED_MODULE_4__Response_model_ReverseGeocodedLocation__[\"a\" /* default */] ();\n\n            __getChildNodes (node, reverseGeocodedLocation);\n\n            // Ajout du rsultat au tableau locations de reverseGeocodeResponse\n            if (reverseGeocodeResponse && Array.isArray(reverseGeocodeResponse.locations)) {\n                reverseGeocodeResponse.locations.push(reverseGeocodedLocation);\n            }\n        },\n\n        /** TODO : jsdoc block */\n        Address : function (node, reverseGeocodedLocation) {\n            var countrycode = node.getAttribute (\"countryCode\");\n            if (reverseGeocodedLocation && countrycode) {\n                reverseGeocodedLocation.type = countrycode;\n            }\n            // on va rcuprer les autres informations (StreetAddress, place, postalCode...)\n            __getChildNodes (node, reverseGeocodedLocation);\n        },\n\n        /** TODO : jsdoc block */\n        Building : function (node, reverseGeocodedLocation) {\n            var num = node.getAttribute (\"number\");\n            if (reverseGeocodedLocation && reverseGeocodedLocation.hasOwnProperty(\"placeAttributes\")) {\n                if (num) {\n                    reverseGeocodedLocation.placeAttributes.number = num;\n                } else if (node.getAttribute (\"buildingName\")) {\n                    reverseGeocodedLocation.placeAttributes.number = node.getAttribute (\"buildingName\");\n                } else if (node.getAttribute (\"subdivision\")) {\n                    reverseGeocodedLocation.placeAttributes.number = node.getAttribute (\"subdivision\");\n                }\n            }\n        },\n\n        /** TODO : jsdoc block */\n        Street : function (node, reverseGeocodedLocation) {\n            // in case of a streetAddress result : street represents the street name\n            if (reverseGeocodedLocation.type === \"StreetAddress\") {\n                reverseGeocodedLocation.placeAttributes.street = __getChildValue(node);\n\n                // in case of a cadastral parcel result : street represents the cadastral parcel identifier\n            } else if (reverseGeocodedLocation.type === \"CadastralParcel\") {\n                reverseGeocodedLocation.placeAttributes.cadastralParcel = __getChildValue(node);\n            }\n        },\n\n        /** TODO : jsdoc block */\n        Place : function (node, reverseGeocodedLocation) {\n            var placeType = node.getAttribute (\"type\");\n            var placeName = __getChildValue(node);\n\n            if (reverseGeocodedLocation && reverseGeocodedLocation.hasOwnProperty(\"placeAttributes\")) {\n\n                if (placeType === \"Municipality\") {\n                    reverseGeocodedLocation.placeAttributes.municipality = placeName;\n\n                } else if (placeType === \"Bbox\") {\n                    var values = placeName.split(\";\");\n                    if (values.length === 4) {\n                        reverseGeocodedLocation.placeAttributes.bbox = {\n                            left : parseFloat(values[0]),\n                            right : parseFloat(values[2]),\n                            top : parseFloat(values[1]),\n                            bottom : parseFloat(values[3])\n                        };\n                    }\n\n                } else if (placeType === \"Commune\") {\n                    reverseGeocodedLocation.placeAttributes.commune = placeName;\n\n                } else if (placeType === \"Departement\") {\n                    reverseGeocodedLocation.placeAttributes.department = placeName;\n\n                } else if (placeType === \"INSEE\") {\n                    reverseGeocodedLocation.placeAttributes.insee = placeName;\n\n                } else if (placeType === \"Qualite\") {\n                    reverseGeocodedLocation.placeAttributes.quality = placeName;\n\n                } else if (placeType === \"Territoire\") {\n                    reverseGeocodedLocation.placeAttributes.territory = placeName;\n\n                } else if (placeType === \"ID\") {\n                    reverseGeocodedLocation.placeAttributes.ID = placeName;\n\n                } else if (placeType === \"ID_TR\") {\n                    reverseGeocodedLocation.placeAttributes.IDTR = placeName;\n\n                } else if (placeType === \"Importance\") {\n                    reverseGeocodedLocation.placeAttributes.importance = parseInt (placeName, 10);\n\n                } else if (placeType === \"Nature\") {\n                    reverseGeocodedLocation.placeAttributes.nature = placeName;\n\n                } else if (placeType === \"Numero\") {\n                    reverseGeocodedLocation.placeAttributes.number = placeName;\n\n                } else if (placeType === \"Feuille\") {\n                    reverseGeocodedLocation.placeAttributes.sheet = placeName;\n\n                } else if (placeType === \"Section\") {\n                    reverseGeocodedLocation.placeAttributes.section = placeName;\n\n                } else if (placeType === \"CommuneAbsorbee\") {\n                    reverseGeocodedLocation.placeAttributes.absorbedCity = placeName;\n\n                } else if (placeType === \"Arrondissement\") {\n                    if (placeName) {\n                        reverseGeocodedLocation.placeAttributes.arrondissement = placeName;\n                    }\n\n                } else if (placeType === \"Type\") {\n                    reverseGeocodedLocation.placeAttributes.origin = placeName;\n\n                } else if (placeType === \"Prefecture\") {\n                    reverseGeocodedLocation.placeAttributes.prefecture = placeName;\n\n                } else if (placeType === \"InseeRegion\") {\n                    reverseGeocodedLocation.placeAttributes.inseeRegion = placeName;\n\n                } else if (placeType === \"InseeDepartment\") {\n                    reverseGeocodedLocation.placeAttributes.inseeDepartment = placeName;\n\n                }\n            }\n        },\n\n        /** TODO : jsdoc block */\n        PostalCode : function (node, reverseGeocodedLocation) {\n            if (reverseGeocodedLocation && reverseGeocodedLocation.hasOwnProperty(\"placeAttributes\")) {\n                reverseGeocodedLocation.placeAttributes.postalCode = __getChildValue(node);\n            }\n        },\n\n        /** TODO : jsdoc block */\n        SearchCentreDistance : function (node, reverseGeocodedLocation) {\n            if (reverseGeocodedLocation) {\n                reverseGeocodedLocation.searchCenterDistance = parseFloat(node.getAttribute (\"value\"));\n            }\n        },\n\n        /** TODO : jsdoc block */\n        Error : function (node) {\n            // <Error message=\"For input string : &quot;2,45&quot;\" errorCode=\"InternalServerError\"/>\n            var srvMess = node.getAttribute (\"message\");\n            var errorCode = node.getAttribute (\"errorCode\");\n            var message = __WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__[\"a\" /* default */].getMessage(\"SERVICE_RESPONSE_EXCEPTION\",\n                \"(\" + errorCode + \") : \" + srvMess);\n            throw new __WEBPACK_IMPORTED_MODULE_2__Exceptions_ErrorService__[\"a\" /* default */] ({\n                message : message,\n                type : __WEBPACK_IMPORTED_MODULE_2__Exceptions_ErrorService__[\"a\" /* default */].TYPE_SRVERR\n            });\n        }\n    },\n\n    gml : {\n\n        /** TODO : jsdoc block */\n        pos : function (node, reverseGeocodedLocation) {\n            var pos = __getChildValue(node);\n            if (reverseGeocodedLocation && pos) {\n                reverseGeocodedLocation.position = {\n                    x : parseFloat(pos.split(\" \")[0]),\n                    y : parseFloat(pos.split(\" \")[1])\n                };\n            }\n        }\n    },\n\n    xlsext : {\n        /** TODO : jsdoc block */\n        ExtendedGeocodeMatchCode : function (node, reverseGeocodedLocation) {\n            if (reverseGeocodedLocation) {\n                reverseGeocodedLocation.matchType = __getChildValue(node);\n            }\n        }\n    },\n\n    /** TODO : jsdoc block */\n    ExceptionReport : function (node) {\n        var response = {};\n        if (node.hasChildNodes()) {\n            var children = node.childNodes;\n            var child;\n            for (var i = 0; i < children.length; i++) {\n                child = children[i];\n                if (child.nodeName === \"Exception\") {\n                    response.exceptionReport = ReverseGeocodeResponseReader.READERS[\"Exception\"](child);\n                }\n            }\n        }\n        return response;\n    },\n\n    /** TODO : jsdoc block */\n    Exception : function (node) {\n        var exceptionReport = {};\n\n        // get exception code\n        var exceptionCode = node.getAttribute (\"exceptionCode\");\n        if (exceptionCode) {\n            exceptionReport.exceptionCode = exceptionCode;\n        }\n\n        // get exception message\n        var textNode = node.firstChild;\n        if (textNode && textNode.nodeType === 3) { // 3 == node.TEXT_NODE\n            exceptionReport.exception = textNode.nodeValue;\n        }\n\n        return exceptionReport;\n    }\n\n};\n\n/**\n * Mthode permettant de lancer la lecture d'une rponse XML du service de gocodage,\n *       l'aide des READERS de la classe.\n *\n * @method ReverseGeocodeResponseReader.read\n * @param {DOMElement} root - racine de la rponse XML  lire\n * @return {Object} geocodeResponse|exceptionReport : l'objet contenant les informations de la rponse XML,\n *      sous la forme d'un objet GeocodeResponse, ou un objet littral exceptionReport si le service a renvoy une exception.\n * @static\n * @memberof ReverseGeocodeResponseReader\n */\nReverseGeocodeResponseReader.read = function (root) {\n\n    if (root.nodeName === \"XLS\") {\n        var nsPrefix = root.prefix;\n        if (!nsPrefix) {\n            nsPrefix = ReverseGeocodeResponseReader.DEFAULTPREFIX;\n        }\n        var geocodeResponse = ReverseGeocodeResponseReader.READERS[nsPrefix][root.nodeName](root);\n        return geocodeResponse;\n\n    } else if (root.nodeName === \"ExceptionReport\") {\n        var exceptionReport = ReverseGeocodeResponseReader.READERS[root.nodeName](root);\n        return exceptionReport;\n\n    } else {\n        throw new Error(\"Erreur lors de la lecture de la rponse : elle n'est pas au format attendu.\");\n    }\n};\n\n/**\n * Rcupration des attributs d'un noeud lment\n *\n * @private\n * @memberof ReverseGeocodeResponseReader\n * @method __getAttributes\n * @param {DOMElement} node - noeud contenant l'attribut recherch\n * @return {Object} nodeAttributes - objet contenant les noms et valeurs des diffrents attributs\n */\nfunction __getAttributes (node) {\n    if (node.attributes.length > 0) {\n        var nodeAttributes = {};\n        var attributes = node.attributes;\n        for (var i = 0; i < attributes.length; i++) {\n            var attribute = attributes[i];\n            nodeAttributes[attribute.nodeName] = attribute.nodeValue;\n        }\n        return nodeAttributes;\n    }\n}\n\n/**\n * Rcupration des noeuds enfants  partir d'un noeud donn, pour lecture (readNode).\n *\n * @private\n * @memberof ReverseGeocodeResponseReader\n * @method __getChildNodes\n * @param {DOMElement} node - a DOM node\n * @param {Array|Object} [data] - an object to be filled with node data\n */\nfunction __getChildNodes (node, data) {\n\n    if (node.hasChildNodes()) {\n\n        var children = node.childNodes;\n        var child;\n        var childName;\n        var childPrefix;\n\n        for (var i = 0; i < children.length; i++) {\n            child = children[i];\n\n            if (child.nodeType === 1) { // 1 == node.ELEMENT_NODE\n                childName = child.localName || child.baseName || child.nodeName;\n                childPrefix = child.prefix || ReverseGeocodeResponseReader.DEFAULTPREFIX;\n\n                if (ReverseGeocodeResponseReader.READERS[childPrefix][childName]) {\n                    var reader = ReverseGeocodeResponseReader.READERS[childPrefix][childName];\n                    reader (child, data);\n                } else {\n                    __getChildNodes (child, data);\n                }\n            }\n        }\n    }\n}\n\n/**\n * Lecture de la valeur du premier child d'un noeud, si elle existe.\n *\n * @private\n * @memberof ReverseGeocodeResponseReader\n * @method __getChildValue\n * @param {DOMElement} node - a DOM node\n * @return {String} value - valeur du firstChild du noeud en entre, ou chane vide.\n */\nfunction __getChildValue(node) {\n\n    var textNode;\n    var value = \"\";\n\n    if (node.hasChildNodes()) {\n        textNode = node.firstChild;\n        if (textNode.nodeType === 3) { // 3 == node.TEXT_NODE\n            value = textNode.nodeValue;\n        }\n    }\n    return value;\n}\n\n/**\n * Vrification des attributs du service, dans la balise XLS de la rponse :\n *      version, namespaces, et namespace par dfaut doivent correspondre  ceux attendus.\n *\n * @private\n * @memberof ReverseGeocodeResponseReader\n * @method __checkServiceAttributes\n * @param {DOMElement} XLSNode - a DOM node, corresponding to XLS first tag.\n */\nfunction __checkServiceAttributes (XLSNode) {\n\n    if (XLSNode.attributes.length > 0) {\n\n        // on rcupre et parcourt les attributs de la balise XLS de la rponse\n        var xlsAttributes = __getAttributes (XLSNode);\n        for (var att in xlsAttributes) {\n            if (xlsAttributes.hasOwnProperty(att)) {\n\n                // vrification de la version\n                if (att === \"version\") {\n                    if (xlsAttributes[\"version\"] !== ReverseGeocodeResponseReader.VERSION) {\n                        console.log(\"[ReverseGeocodeResponseReader] geocode version is not the expected one : there may be errors in parsing\");\n                        return;\n                    }\n                }\n\n                // on vrifie que l'uri du namespace par dfaut est bien celle que l'on attend\n                if (att === \"xmlns\") {\n                    if (xlsAttributes[att] !== ReverseGeocodeResponseReader.NAMESPACES[ReverseGeocodeResponseReader.DEFAULTPREFIX]) {\n                        console.log(\"[ReverseGeocodeResponseReader] geocode response default namespace is not the expected one\");\n                        return;\n                    }\n                    continue;\n                }\n\n                var prefix = att.split(\":\")[0];\n                var ns = att.split(\":\")[1];\n\n                // si on a un autre xmlns, on vrifie aussi les URI\n                if (prefix === \"xmlns\" && ns) {\n                    // si l'attribut correspond  un namespace dfini dans le reader\n                    if (ReverseGeocodeResponseReader.NAMESPACES[ns]) {\n                        // il faut que les URI correspondent aussi.\n                        if (ReverseGeocodeResponseReader.NAMESPACES[ns] !== xlsAttributes[att]) {\n                            console.log(\"[ReverseGeocodeResponseReader] geocode response \" + att + \" namespace is not the expected one\");\n                            return;\n                        }\n                    }\n                }\n\n                // pour finir on vrifie la localisation du schema XSD du service\n                if (ns === \"schemaLocation\") {\n                    if (ReverseGeocodeResponseReader.SCHEMALOCATION !== xlsAttributes[att]) {\n                        console.log(\"[ReverseGeocodeResponseReader] geocode response schema location is not the expected one\");\n                        return;\n                    }\n                }\n\n            }\n        }\n    }\n}\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (ReverseGeocodeResponseReader);\n\n\n/***/ }),\n/* 82 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__CommonService__ = __webpack_require__(3);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__Response_AutoCompleteResponseFactory__ = __webpack_require__(83);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__Utils_LoggerByDefault__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__Utils_MessagesResources__ = __webpack_require__(1);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__Utils_Helper__ = __webpack_require__(5);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__Exceptions_ErrorService__ = __webpack_require__(2);\n\n\n\n\n\n\n\n/**\n * @classdesc\n * Appel du service d'autocompltion du Goportail :\n * envoi de la requte construite selon les paramtres en options,\n * ventuellement parsing et analyse  de la rponse,\n * retour d'une rponse en paramtre de la fonction onSuccess.\n * @constructor\n * @extends {Gp.Services.CommonService}\n * @alias Gp.Services.AutoComplete\n *\n * @param {Object} options - options spcifiques au service (+ les options herites)\n *\n * @param {String} options.text - La chane de caractre  complter.\n *      Cette chane n'est pas \"URL encode\".\n *      C'est l'API qui s'occupe de l'encoder pour l'inclure dans la requte.\n *\n * @param {Array.<String>} [options.filterOptions.type = \"StreetAddress\"] - Type de l'objet recherch.\n *      Le service d'autocompltion du Goportail permet de rechercher des toponymes 'PostionOfInterest' et/ou des adresses postales 'StreetAddress'.\n *      D'autres types pourront tre rajouts selon l'volution du service.\n *      Par dfaut, type = ['StreetAddress'].\n *\n * @param {Array.<String>} [options.filterOptions.territory] - Limitation de la zone de recherche de localisants.\n *      Le service d'autocompltion du Goportail permet de limiter la recherche  la mtropole et la Corse : options.filterOptions.territory = ['METROPOLE'],\n *      DOMS TOMS : options.filterOptions.territory = ['DOMTOM'], ou  une liste de dpartements : options.filterOptions.territory = ['31', '34']\n *      Pas de valeur par dfaut.\n *      La valeur par dfaut est donc celle du service.\n *      Le service d'autocompltion du Goportail renvoie toutes les informations quand aucun territoire n'est spcifi.\n *\n * @param {Number} [options.maximumResponses = 10] - Nombre de rponses maximal que l'on souhaite recevoir.\n *      Pas de valeur par dfaut.\n *      La valeur par dfaut sera donc celle du service : 10.\n *\n * @example\n *   var options = {\n *      // options communes aux services\n *      apiKey : null,\n *      serverUrl : 'http://localhost/service/',\n *      protocol : 'JSONP', // JSONP|XHR\n *      proxyURL : null,\n *      httpMethod : 'GET', // GET|POST\n *      timeOut : 10000, // ms\n *      rawResponse : false, // true|false\n *      scope : null, // this\n *      onSuccess : function (response) {},\n *      onFailure : function (error) {},\n *      // spcifique au service\n *      text : \"\",\n *      filterOptions : {\n *          type : [\"StreetAddress\"],\n *          territory : ['METROPOLE', 'DOMTOM', '31']\n *      },\n *      maximumResponses : 10\n *   };\n * @private\n */\nfunction AutoComplete (options) {\n\n    if (!(this instanceof AutoComplete)) {\n        throw new TypeError(__WEBPACK_IMPORTED_MODULE_3__Utils_MessagesResources__[\"a\" /* default */].getMessage(\"CLASS_CONSTRUCTOR\", \"AutoComplete\"));\n    }\n\n    /**\n     * Nom de la classe (heritage)\n     * FIXME instance ou classe ?\n     */\n    this.CLASSNAME = \"AutoComplete\";\n\n    // appel du constructeur par heritage\n    __WEBPACK_IMPORTED_MODULE_0__CommonService__[\"a\" /* default */].apply(this, arguments);\n\n    this.logger = __WEBPACK_IMPORTED_MODULE_2__Utils_LoggerByDefault__[\"a\" /* default */].getLogger(\"Gp.Services.AutoComplete\");\n    this.logger.trace(\"[Constructeur AutoComplete (options)]\");\n\n    if (!options.text) {\n        throw new Error(__WEBPACK_IMPORTED_MODULE_3__Utils_MessagesResources__[\"a\" /* default */].getMessage(\"PARAM_MISSING\", \"text\"));\n    }\n\n    // ajout des options spcifiques au service\n    this.options.text = options.text;\n\n    // on definit des filtres par defaut\n    if (!options.filterOptions || typeof options.filterOptions !== \"object\") {\n        this.options.filterOptions = options.filterOptions = {\n            territory : [],\n            type : [\"StreetAddress\"]\n        };\n    }\n\n    // FIXME ECMAScript 5 support (valable pour un objet uniquement !)\n    // ceci permet de tester le cas o : object = {}\n    if (Object.keys(options.filterOptions).length === 0) {\n        this.options.filterOptions = {\n            territory : [],\n            type : [\"StreetAddress\"]\n        };\n    }\n\n    this.options.filterOptions.type = options.filterOptions.type || [\"StreetAddress\"];\n    this.options.filterOptions.territory = options.filterOptions.territory || [];\n    this.options.maximumResponses = options.maximumResponses || 10;\n\n    // INFO\n    // le service ne repond pas en mode POST (405 Method Not Allowed)\n    if (this.options.protocol === \"XHR\" && this.options.httpMethod === \"POST\") {\n        this.logger.warn(\"Le service ne gre pas le mode d'interrogation en POST, on bascule sur du GET !\");\n        this.options.httpMethod = \"GET\"; // on surcharge !\n    }\n\n    // attributs d'instances\n\n    /**\n     * Format forc de la rponse du service : \"json\"\n     * sauf si l'on souhaite une reponse brute (options.rawResponse)\n     */\n    this.options.outputFormat = (this.options.rawResponse) ? \"\" : \"json\";\n\n}\n\n/**\n * @lends module:AutoComplete#\n */\n\nAutoComplete.prototype = Object.create(__WEBPACK_IMPORTED_MODULE_0__CommonService__[\"a\" /* default */].prototype, {\n    // todo\n    // getter/setter\n});\n\n/*\n * Constructeur (alias)\n */\nAutoComplete.prototype.constructor = AutoComplete;\n\n/**\n * (overwrite)\n * Cration de la requte\n *\n * @param {Function} error   - callback des erreurs\n * @param {Function} success - callback\n */\nAutoComplete.prototype.buildRequest = function (error, success) {\n\n    // ex.\n    // http://wxs.ign.fr/CLEF/ols/apis/completion?\n    // text=Brie-Comt&\n    // type=StreetAddress,PositionOfInterest&\n    // territory=METROPOLE&\n    // maximumResponses=10\n\n    // traitement des param KPV sous forme de tableau\n    var territories = \"\";\n    if (this.options.filterOptions.territory) {\n        territories = this.options.filterOptions.territory.join(\";\");\n    }\n\n    var types = \"\";\n    if (this.options.filterOptions.type) {\n        types = this.options.filterOptions.type.join(\",\");\n    }\n\n    // normalisation de la requete avec param KPV\n    this.request = __WEBPACK_IMPORTED_MODULE_4__Utils_Helper__[\"a\" /* default */].normalyzeParameters({\n        text : encodeURIComponent(this.options.text),\n        type : types,\n        terr : territories,\n        maximumResponses : this.options.maximumResponses\n    });\n\n    success.call(this, this.request);\n};\n\n/**\n * (overwrite)\n * Analyse de la reponse\n *\n * @param {Function} error   - callback des erreurs\n * @param {Function} success - callback de succs de l'analyse de la rponse\n */\nAutoComplete.prototype.analyzeResponse = function (error, success) {\n\n    if (this.response) {\n\n        var options = {\n            response : this.response,\n            rawResponse : this.options.rawResponse,\n            onSuccess : success,\n            onError : error,\n            scope : this\n        };\n\n        __WEBPACK_IMPORTED_MODULE_1__Response_AutoCompleteResponseFactory__[\"a\" /* default */].build(options);\n\n    } else {\n        error.call(this, new __WEBPACK_IMPORTED_MODULE_5__Exceptions_ErrorService__[\"a\" /* default */](__WEBPACK_IMPORTED_MODULE_3__Utils_MessagesResources__[\"a\" /* default */].getMessage(\"SERVICE_RESPONSE_EMPTY\")));\n    }\n\n};\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (AutoComplete);\n\n\n/***/ }),\n/* 83 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__ = __webpack_require__(1);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__Exceptions_ErrorService__ = __webpack_require__(2);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__Formats_XML__ = __webpack_require__(4);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__model_AutoCompleteResponse__ = __webpack_require__(41);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__model_SuggestedLocation__ = __webpack_require__(42);\n/**\n * Factory pour gnrer une reponse JSON  partir d'un XML ou d'un JSON\n * (Factory)\n *\n * @module AutoCompleteResponseFactory\n * @private\n * @alias Gp.Services.AutoComplete.Response.AutoCompleteResponseFactory\n */\n\n\n\n\n\n\n\nvar AutoCompleteResponseFactory = {\n\n    /**\n     * interface unique\n     *\n     * @method build\n     * @static\n     * @param {Object} options - options definies dans le composant Alti\n     *\n     * @example\n     *   var options = {\n     *      response :\n     *      outputFormat :\n     *      rawResponse :\n     *      scope :\n     *      onSuccess :\n     *      onError :\n     *   };\n     *\n     */\n    build : function (options) {\n\n        // logger\n        var logger = __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__[\"a\" /* default */].getLogger(\"AutoCompleteResponseFactory\");\n        logger.trace([\"AutoCompleteResponseFactory::build()\"]);\n\n        var data = null;\n\n        if (options.response) {\n\n            if (options.rawResponse) {\n                logger.trace(\"analyze response : raw\");\n                data = options.response;\n\n            } else {\n\n                var JSONResponse;\n                if ( typeof options.response === \"string\") {\n                    JSONResponse = JSON.parse(options.response);\n                } else {\n                    JSONResponse = options.response;\n                }\n\n                // analyse de la rponse\n                if (JSONResponse) {\n\n                    // le service renvoie t il une erreur ?\n                    if (JSONResponse.error) {\n                        // ex. ?\n                        options.onError.call(options.scope, new __WEBPACK_IMPORTED_MODULE_2__Exceptions_ErrorService__[\"a\" /* default */]({\n                            message : __WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__[\"a\" /* default */].getMessage(\"SERVICE_RESPONSE_EXCEPTION\", JSONResponse.error.description),\n                            status : JSONResponse.error.code,\n                            type : __WEBPACK_IMPORTED_MODULE_2__Exceptions_ErrorService__[\"a\" /* default */].TYPE_SRVERR\n                        }));\n                        return;\n                    }\n\n                    // cration de l'objet rponse\n                    data = new __WEBPACK_IMPORTED_MODULE_4__model_AutoCompleteResponse__[\"a\" /* default */]();\n\n                    // boucle sur les rsultats de l'autocompltion\n                    if (JSONResponse.results && Array.isArray(JSONResponse.results)) {\n                        var suggestedLocation;\n\n                        for (var i = 0; i < JSONResponse.results.length; i++) {\n                            var result = JSONResponse.results[i];\n                            suggestedLocation = new __WEBPACK_IMPORTED_MODULE_5__model_SuggestedLocation__[\"a\" /* default */]();\n\n                            if (suggestedLocation) {\n\n                                if (result && result.country === \"StreetAddress\") {\n                                    suggestedLocation.street = result.street;\n                                    suggestedLocation.type = \"StreetAddress\";\n                                } else if (result && result.country === \"PositionOfInterest\") {\n                                    suggestedLocation.poi = result.street;\n                                    suggestedLocation.kind = result.kind;\n                                    suggestedLocation.type = \"PositionOfInterest\";\n                                }\n\n                                if (suggestedLocation.position) {\n                                    suggestedLocation.position.x = result.x;\n                                    suggestedLocation.position.y = result.y;\n                                }\n\n                                suggestedLocation.commune = result.city;\n                                suggestedLocation.fullText = result.fulltext;\n                                suggestedLocation.postalCode = result.zipcode;\n                                suggestedLocation.classification = result.classification;\n\n                            }\n                            // Ajout du rsultat au tableau reverseGeocodedLocations de geocodedLocation\n                            data.suggestedLocations.push(suggestedLocation);\n                        }\n\n                    } else {\n                        options.onError.call(options.scope, new __WEBPACK_IMPORTED_MODULE_2__Exceptions_ErrorService__[\"a\" /* default */](__WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__[\"a\" /* default */].getMessage(\"SERVICE_RESPONSE_FORMAT_3\")));\n                        return;\n                    }\n\n                    if (!data.suggestedLocations.length) {\n                        options.onError.call(options.scope, new __WEBPACK_IMPORTED_MODULE_2__Exceptions_ErrorService__[\"a\" /* default */](__WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__[\"a\" /* default */].getMessage(\"SERVICE_RESPONSE_FORMAT_3\")));\n                        return;\n                    }\n                }\n\n                if (!data) {\n                    options.onError.call(options.scope, new __WEBPACK_IMPORTED_MODULE_2__Exceptions_ErrorService__[\"a\" /* default */]({\n                        message : __WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__[\"a\" /* default */].getMessage(\"SERVICE_RESPONSE_ANALYSE_2\"),\n                        type : __WEBPACK_IMPORTED_MODULE_2__Exceptions_ErrorService__[\"a\" /* default */].TYPE_UNKERR,\n                        status : -1\n                    }));\n                    return;\n                }\n\n                // Si la rponse contenait une exception renvoye par le service\n                if (data.exceptionReport) {\n                    options.onError.call(options.scope, new __WEBPACK_IMPORTED_MODULE_2__Exceptions_ErrorService__[\"a\" /* default */]({\n                        message : __WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__[\"a\" /* default */].getMessage(\"SERVICE_RESPONSE_EXCEPTION\", data.exceptionReport),\n                        type : __WEBPACK_IMPORTED_MODULE_2__Exceptions_ErrorService__[\"a\" /* default */].TYPE_SRVERR,\n                        status : 200\n                    }));\n                    return;\n                }\n            }\n        } else {\n            // si la rponse (xmlString) est vide, on appelle le callback d'erreur\n            options.onError.call(options.scope, new __WEBPACK_IMPORTED_MODULE_2__Exceptions_ErrorService__[\"a\" /* default */](__WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__[\"a\" /* default */].getMessage(\"SERVICE_RESPONSE_EMPTY\")));\n            return;\n        }\n\n        // si tout s'est bien pass, on appelle le callback de succs\n        options.onSuccess.call(options.scope, data);\n        return;\n    }\n};\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (AutoCompleteResponseFactory);\n\n\n/***/ }),\n/* 84 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__ = __webpack_require__(1);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__Exceptions_ErrorService__ = __webpack_require__(2);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__CommonService__ = __webpack_require__(3);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__DefaultUrlService__ = __webpack_require__(6);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__Request_RouteRequestFactory__ = __webpack_require__(85);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__Response_RouteResponseFactory__ = __webpack_require__(93);\n\n\n\n\n\n\n\n\n\n/**\n * @classdesc\n * Appel du service d'itinraire du Goportail :\n *     envoi de la requte construite selon les paramtres en options,\n *     ventuellement parsing et analyse  de la rponse,\n *     retour d'une rponse en paramtre de la fonction onSuccess.\n *\n * @alias Gp.Services.Route\n * @constructor\n * @extends {Gp.Services.CommonService}\n * @param {Object} options - options spcifiques au service (+ les options herites)\n *\n * @param {String} [options.api] - Manire d'accder au service : 'REST' (via l'API REST) ou 'OLS' (via la norme XLS).\n * Par dfaut, on utilise l'API REST.\n *\n * @param {String} options.outputFormat - Le format de la rponse du service itineraire : 'xml' ou 'json'.\n *      Ce paramtre dterminera l'extension '.xml' ou '.json' du service dans le cas de l'API REST.\n *      Ncessaire si serverUrl est renseign, et qu'on souhaite passer par l'API REST,\n *      pour connatre le format dans lequel sera fournie la rponse (pour son traitement).\n *      Non ncessaire pour la norme OLS. Par dfaut, ce paramtre vaut 'json'.\n *\n * @param {String} [options.routePreference = \"fastest\"] - Mode de calcul  utiliser :\n * - le plus rapide  fastest \n * - le plus court  shortest \n * Par dfaut :  fastest .\n *\n * @param {Object} options.startPoint - Point de dpart du calcul. Coordonnes exprimes en longitudes, latitudes (EPSG:4326)\n * @param {Float} options.startPoint.x - Abcisse du point de dpart du calcul d'itinraire.\n * @param {Float} options.startPoint.y - Ordonne du point de dpart du calcul d'itinraire.\n *\n * @param {Object} options.endPoint - Point d'arrive du calcul. Coordonnes exprimes en longitudes, latitudes (EPSG:4326)\n * @param {Float} options.endPoint.x - Abcisse du point d'arrive du calcul d'itinraire.\n * @param {Float} options.endPoint.y - Ordonne du point d'arrive du calcul d'itinraire.\n *\n * @param {Object[]} [options.viaPoints] - Liste de point ({x:Float,y:Float}) intermdaires que l'itinraire doit emprunter dans l'ordre du tableau.\n *      Coordonnes exprimes en longitudes, latitudes (EPSG:4326) :{x:float, y:float}\n *\n * @param {String} [options.graph = \"voiture\"] - Type de graphe utilis : \"Voiture\" ou \"Pieton\".\n *      Dtermine le profil de vitesses utilis pour le calcul ainsi que les tronons autoriss ou non.\n *      Par dfaut, c'est la valeur \"Voiture\" qui sera utilise.\n *\n * @param {String[]} [options.exclusions] - Critres d'exclusions  appliquer pour le calcul. (correspond au paramtre \"avoidFeature\" d'OpenLS)\n *      On prcise ici le type de tronons que l'on ne veut pas que l'itinraire emprunte\n *      (valeurs possibles :  toll  (viter les pages),  bridge ,  tunnel ).\n *\n * @param {Boolean} [options.geometryInInstructions = false] - Indique si la gomtrie de l'itinraire doit tre reprise morceau par morceau dans les instructions.\n *      (correspond au paramtre \"provideGeometry\" d'OpenLS) Par dfaut : false.\n *\n * @param {Boolean} [options.provideBbox = true] - Indique si les instructions doivent tre localises par une bbox dans la rponse.\n *      Par dfaut : true.\n *\n * @param {String} [options.distanceUnit = \"km\"] - Indique si la distance doit tre exprime en km ou m dans la rponse.\n *      Par dfaut : km.\n *\n * @param {String} [options.srs] - Systme de coordonnes dans lequel les paramtres gographiques en entre et la rponse du service sont exprims.\n *      Pas de valeur par dfaut. Si le serveur consult est celui du Goportail, la valeur par dfaut sera donc celle du service : 'EPSG:4326'.\n *\n * @example\n *  var options = {\n *      // options communes aux services\n *      apiKey : null,\n *      serverUrl : 'http://localhost/service/',\n *      protocol : 'JSONP', // JSONP|XHR\n *      proxyURL : null,\n *      httpMethod : 'GET', // GET|POST\n *      timeOut : 10000, // ms\n *      rawResponse : false, // true|false\n *      scope : null, // this\n *      onSuccess : function (response) {},\n *      onFailure : function (error) {},\n *      // spcifique au service\n *      api : 'OLS',\n *      outputFormat : 'xml',\n *      startPoint : {\n *          x : 42.1121,\n *          y : 1.5557\n *      },\n *      endPoint : {\n *          x : 42.1121,\n *          y : 1.5557\n *      },\n *      provideBbox : false,\n *      exclusions : [\"Bridge\", \"Tunnel\", \"Toll\"],\n *      distanceUnit : \"km\",\n *      graph : \"Voiture\",\n *      geometryInInstructions : false,\n *      routePreference : \"fastest\"\n *  };\n *\n * @private\n */\nfunction Route (options) {\n\n    if (!(this instanceof Route)) {\n        throw new TypeError(__WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__[\"a\" /* default */].getMessage(\"CLASS_CONSTRUCTOR\", \"Route\"));\n    }\n\n    /**\n     * Nom de la classe (heritage)\n     * FIXME instance ou classe ?\n     */\n    this.CLASSNAME = \"Route\";\n\n    // appel du constructeur par heritage\n    __WEBPACK_IMPORTED_MODULE_3__CommonService__[\"a\" /* default */].apply(this, arguments);\n\n    this.logger = __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__[\"a\" /* default */].getLogger(\"Gp.Services.Route\");\n    this.logger.trace(\"[Constructeur Route (options)]\");\n\n    if (!options.startPoint) {\n        throw new Error(__WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__[\"a\" /* default */].getMessage(\"PARAM_MISSING\", \"startPoint\"));\n    }\n\n    // on lance une exception afin d'eviter au service de le faire...\n    if (options.startPoint.x == null) {\n        throw new Error(__WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__[\"a\" /* default */].getMessage(\"PARAM_MISSING\", \"startPoint.x\"));\n    }\n\n    if (options.startPoint.y == null) {\n        throw new Error(__WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__[\"a\" /* default */].getMessage(\"PARAM_MISSING\", \"startPoint.y\"));\n    }\n\n    if (!options.endPoint) {\n        throw new Error(__WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__[\"a\" /* default */].getMessage(\"PARAM_MISSING\", \"endPoint\"));\n    }\n\n    // on lance une exception afin d'eviter au service de le faire...\n    if (options.endPoint.x == null) {\n        throw new Error(__WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__[\"a\" /* default */].getMessage(\"PARAM_MISSING\", \"endPoint.x\"));\n    }\n\n    if (options.endPoint.y == null) {\n        throw new Error(__WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__[\"a\" /* default */].getMessage(\"PARAM_MISSING\", \"endPoint.y\"));\n    }\n\n    // options par defaut\n    // on passe l'option api en majuscules afin d'viter des exceptions.\n    this.options.api = ( typeof options.api == \"string\") ? options.api.toUpperCase() : \"REST\";\n\n    // on passe l'option outputFormat en minuscules afin d'viter des exceptions.\n    this.options.outputFormat = ( typeof options.outputFormat == \"string\") ? options.outputFormat.toLowerCase() : \"json\";\n\n    this.options.startPoint = options.startPoint;\n    this.options.endPoint = options.endPoint;\n    this.options.viaPoints = options.viaPoints || null; // INFO mapping viaPoints <=> xls:viaPoint\n    this.options.exclusions = options.exclusions || null; // INFO mapping exclusions <=> xls:avoidFeature\n    this.options.routePreference = options.routePreference || \"fastest\";\n    this.options.graph = options.graph || \"Voiture\";\n    this.options.geometryInInstructions = options.geometryInInstructions || false; // INFO mapping geometryInInstructions <=> xls:provideGeometry\n    this.options.provideBbox = options.provideBbox || true; // INFO mapping provideBbox <=> xls:provideBoundingBox\n    this.options.distanceUnit = options.distanceUnit || \"km\";\n    this.options.expectedStartTime = null; // FIXME not yet implemented !\n    this.options.srs = options.srs || \"EPSG:4326\";\n\n    // FIXME : les readers OLS ne sont pas implments. on utilise donc l'API REST.\n    this.options.api = \"REST\";\n    this.logger.warn(\"FIXME : Surcharge option 'api' : REST\");\n    if (this.options.protocol === \"XHR\") {\n        this.options.httpMethod = \"GET\";\n        this.logger.trace(\"Surcharge option 'HttpMethod' : \" + this.options.httpMethod);\n    }\n\n    // gestion de l'url du service par defaut\n    // si l'url n'est pas renseigne, il faut utiliser les urls par defaut\n    // en fonction du type d'api, REST ou OLS\n    if (!this.options.serverUrl) {\n\n        var lstUrlByDefault = __WEBPACK_IMPORTED_MODULE_4__DefaultUrlService__[\"a\" /* default */].Route.url(this.options.apiKey);\n        var urlFound = null;\n        switch (this.options.api) {\n            case \"OLS\":\n                urlFound = lstUrlByDefault.ols;\n                break;\n            case \"REST\":\n                var key = \"route\" + \"-\" + this.options.outputFormat;\n                urlFound = lstUrlByDefault[key];\n                break;\n            default:\n                throw new Error(__WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__[\"a\" /* default */].getMessage(\"PARAM_UNKNOWN\", \"api\"));\n        }\n\n        if (!urlFound) {\n            throw new Error(\"Url by default not found !\");\n        }\n        this.options.serverUrl = urlFound;\n        this.logger.trace(\"Serveur URL par defaut : \" + this.options.serverUrl);\n    }\n\n    // gestion du type de service\n    // si l'extension de l'url est .json ou .xml, on surcharge le format de sortie (outputFormat)\n    var idx = this.options.serverUrl.lastIndexOf(\".\");\n    if (idx !== -1) {\n        var extension = this.options.serverUrl.substring(idx + 1);\n        if (extension && extension.length < 5) { // FIXME extension de moins de 4 car. ...\n            this.logger.trace(\"Serveur Extension URL : \" + extension);\n            switch (extension.toLowerCase()) {\n                case \"json\":\n                case \"xml\":\n                    this.options.outputFormat = extension.toLowerCase();\n                    break;\n                default:\n                    throw new Error(\"type of service : unknown or unsupported (json or xml) !\");\n            }\n        }\n    }\n}\n\n/**\n * @lends module:Route#\n */\nRoute.prototype = Object.create(__WEBPACK_IMPORTED_MODULE_3__CommonService__[\"a\" /* default */].prototype, {\n    // todo\n    // getter/setter\n});\n\n/*\n * Constructeur (alias)\n */\nRoute.prototype.constructor = Route;\n\n/**\n * (overwrite)\n * Cration de la requte\n *\n * @param {Function} error   - callback des erreurs\n * @param {Function} success - callback\n */\nRoute.prototype.buildRequest = function (error, success) {\n\n    var options = {\n        // spcifique au service\n        api : this.options.api,\n        startPoint : this.options.startPoint,\n        endPoint : this.options.endPoint,\n        viaPoints : this.options.viaPoints,\n        provideBbox : this.options.provideBbox,\n        exclusions : this.options.exclusions,\n        distanceUnit : this.options.distanceUnit,\n        graph : this.options.graph,\n        geometryInInstructions : this.options.geometryInInstructions,\n        routePreference : this.options.routePreference,\n        srs : this.options.srs\n    };\n\n    this.request = __WEBPACK_IMPORTED_MODULE_5__Request_RouteRequestFactory__[\"a\" /* default */].build(options);\n\n    // on teste si la requete a bien t construite !\n    if (!this.request) {\n        error.call(this, new __WEBPACK_IMPORTED_MODULE_2__Exceptions_ErrorService__[\"a\" /* default */](__WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__[\"a\" /* default */].getMessage(\"SERVICE_REQUEST_BUILD\")));\n    } else {\n        success.call(this, this.request);\n    }\n};\n\n/**\n * (overwrite)\n * Analyse de la reponse\n *\n * @param {Function} error   - callback des erreurs\n * @param {Function} success - callback\n */\nRoute.prototype.analyzeResponse = function (error, success) {\n\n    // INFO\n    // Factory pour masquer la complexit du retour du service qui renvoie soit\n    //  - une 'string' qui contient du XML ou JSON natif en mode XHR\n    //  - un objet JSON qui est natif ou encapsul\n\n    if (this.response) {\n\n        var options = {\n            distanceUnit : this.options.distanceUnit, // FIXME ce parametre nous permet de choisir le type d'unit dans la reponse !\n            response : this.response,\n            outputFormat : this.options.outputFormat, // utile pour parser la string en mode XHR : JSON ou XML !\n            api : this.options.api, // utile de connaitre le type d'API car la reponse est differente !\n            rawResponse : this.options.rawResponse,\n            onError : error,\n            onSuccess : success,\n            scope : this\n        };\n\n        __WEBPACK_IMPORTED_MODULE_6__Response_RouteResponseFactory__[\"a\" /* default */].build(options);\n\n    } else {\n        error.call(this, new __WEBPACK_IMPORTED_MODULE_2__Exceptions_ErrorService__[\"a\" /* default */](__WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__[\"a\" /* default */].getMessage(\"SERVICE_RESPONSE_EMPTY\")));\n    }\n\n};\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (Route);\n\n\n/***/ }),\n/* 85 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__Exceptions_ErrorService__ = __webpack_require__(2);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__RouteRequestOLS__ = __webpack_require__(86);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__RouteRequestREST__ = __webpack_require__(91);\n/**\n * Creation d'une requte OpenLS ou REST en mode POST ou GET\n * (Factory)\n *\n * @module RouteRequestFactory\n * @alias Gp.Services.Route.Request.RouteRequestFactory\n * @private\n */\n\n\n\n\n\nvar RouteRequestFactory = {\n\n    /**\n     * interface unique\n     *\n     * @method build\n     * @static\n     * @param {Object} options - options definies dans le composant Route\n     *\n     * @example\n     *   // utilisation avec les callback\n     *   var options = {\n     *      (...)\n     *      onSuccess : function (response) {},\n     *      onError : function (error) {},\n     *      // spcifique au service\n     *      api : 'OLS',\n     *      startPoint : {\n     *          x : 42.1121,\n     *          y : 1.5557\n     *      },\n     *      endPoint : {\n     *          x : 42.1121,\n     *          y : 1.5557\n     *      },\n     *      provideBbox : false,\n     *      exclusions : [\"Bridge\", \"Tunnel\", \"Toll\"],\n     *      distanceUnit : \"km\",\n     *      graph : \"Voiture\",\n     *      geometryInInstructions : false,\n     *      routePreference : \"fastest\"\n     *   };\n     *   RouteRequestFactory.build(options);\n     *\n     *   // utilisation sans callback\n     *   var options = {...};\n     *   try {\n     *      var result = RouteRequestFactory.build(options);\n     *      if (! result) { throw new Error(\"...\"):}\n     *   } catch (e) {\n     *      // todo\n     *   }\n     * @returns {String} request\n     */\n    build : function (options) {\n\n        // logger\n        var logger = __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__[\"a\" /* default */].getLogger(\"RouteRequestFactory\");\n        logger.trace([\"RouteRequestFactory::build()\"]);\n\n        var request = null;\n\n        var settings = options || {};\n\n        // gestion des callback\n        var bOnError = (options.onError !== null && typeof options.onError === \"function\") ? true : false;\n\n        var message = null;\n        // choix entre les 2 types d'API pour consulter le service\n        switch (options.api) {\n            case \"REST\":\n                // FIXME les exceptions ne sont pas 'catches' sur le constructeur !\n                var myReq = new __WEBPACK_IMPORTED_MODULE_3__RouteRequestREST__[\"a\" /* default */](settings);\n                if (!myReq.processRequestString()) {\n                    message = \"Error process request (rest) !\";\n                    if (bOnError) {\n                        options.onError.call(options.scope, new __WEBPACK_IMPORTED_MODULE_1__Exceptions_ErrorService__[\"a\" /* default */](message));\n                        return;\n                    }\n                    throw new Error(message);\n                }\n                request = myReq.requestString;\n                break;\n            case \"OLS\":\n                request = __WEBPACK_IMPORTED_MODULE_2__RouteRequestOLS__[\"a\" /* default */].build(settings);\n                if (!request) {\n                    message = \"Error process request (ols) !\";\n                    if (bOnError) {\n                        options.onError.call(options.scope, new __WEBPACK_IMPORTED_MODULE_1__Exceptions_ErrorService__[\"a\" /* default */](message));\n                        return;\n                    }\n                    throw new Error(message);\n                }\n                break;\n            default:\n                message = \"Type of API is not supported by service (REST or OLS) !\";\n                if (bOnError) {\n                    options.onError.call(options.scope, new __WEBPACK_IMPORTED_MODULE_1__Exceptions_ErrorService__[\"a\" /* default */](message));\n                    return;\n                }\n                throw new Error(message);\n        }\n\n        return request;\n    }\n};\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (RouteRequestFactory);\n\n\n/***/ }),\n/* 86 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__Formats_XLS__ = __webpack_require__(11);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__Formats_XLS_RouteService__ = __webpack_require__(87);\n/**\n * Creation d'une requte OpenLS en mode POST ou GET\n * (Factory)\n *\n * @module RouteRequestOLS\n * @alias Gp.Services.Route.Request.RouteRequestOLS\n * @private\n */\n\n\n\n\nvar RouteRequestOLS = {\n\n    /**\n     * interface unique\n     *\n     * @method build\n     * @static\n     * @param {Object} options - options definies dans le composant Route\n     *\n     * @example\n     *   var options = {\n     *      (...)\n     *   };\n     *\n     * @returns {String} request\n     */\n    build : function (options) {\n\n        // logger\n        var logger = __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__[\"a\" /* default */].getLogger(\"RouteRequestOLS\");\n        logger.trace([\"RouteRequestOLS::build()\"]);\n\n        var request = null;\n\n        // spcifique au service\n        var settings = {\n            startPoint : options.startPoint,\n            endPoint : options.endPoint,\n            viaPoint : options.viaPoints, // mapping OLS et options\n            provideBoundingBox : options.provideBbox, // mapping OLS et options\n            avoidFeature : options.exclusions, // mapping OLS et options\n            expectedStartTime : options.expectedStartTime, // TODO format ?\n            distanceUnit : options.distanceUnit,\n            graph : options.graph,\n            provideGeometry : options.geometryInInstructions, // mapping OLS et options\n            routePreference : options.routePreference\n        };\n\n        // objet RouteService\n        var oRS = new __WEBPACK_IMPORTED_MODULE_2__Formats_XLS_RouteService__[\"a\" /* default */](settings);\n\n        // Format XLS\n        var oXLS = new __WEBPACK_IMPORTED_MODULE_1__Formats_XLS__[\"a\" /* default */]({\n            srsName : options.srs,\n            maximumResponses : options.maximumResponses\n        });\n        oXLS.namespace = true;\n        oXLS.setService(oRS);\n\n        // request brute !\n        request = oXLS.build();\n\n        // en mode GET, la requte est encode\n        // et le param. 'qxml' est ajout\n        if (options.httpMethod == \"GET\") {\n            var myRequest = \"qxml=\" +\n                encodeURIComponent(request)\n                .replace(/\\-/g, \"%2D\")\n                .replace(/\\_/g, \"%5F\")\n                .replace(/\\./g, \"%2E\")\n                .replace(/\\!/g, \"%21\")\n                .replace(/\\~/g, \"%7E\")\n                .replace(/\\*/g, \"%2A\")\n                .replace(/\\'/g, \"%27\")\n                .replace(/\\(/g, \"%28\")\n                .replace(/\\)/g, \"%29\");\n            request = myRequest;\n        }\n\n        return request;\n    }\n};\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (RouteRequestOLS);\n\n\n/***/ }),\n/* 87 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__AbstractService__ = __webpack_require__(12);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__RouteService_DetermineRouteRequest__ = __webpack_require__(88);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__RouteService_RouteRequestExtension__ = __webpack_require__(90);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__RouteService_RouteRequestExtension___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3__RouteService_RouteRequestExtension__);\n\n\n\n\n\n/**\n * @classdesc\n *\n * Requte de type RouteService\n * (Factory)\n *\n * XSD :\n * ----\n * [] => non implement !\n *\n * ```\n * element name=\"DetermineRouteRequest\"\n *  [attribute name=\"provideRouteHandle\" default=\"false\"]\n *  attribute name=\"distanceUnit\"       default=\"M\"\n *      [element ref=\"xls:RouteHandle\" || element ref=\"xls:RoutePlan\"]\n *      element ref=\"xls:RoutePlan\"\n *      element ref=\"xls:RouteInstructionsRequest\"\n *      [element ref=\"xls:RouteGeometryRequest\"]\n *      [element ref=\"xls:RouteMapRequest\"]\n * ```\n * ```\n * element name=\"RoutePlan\"\n *  [attribute name=\"useRealTimeTraffic\" default=\"false\"]\n *  [attribute name=\"expectedStartTime\"  type=\"dateTime\"]\n *  [attribute name=\"expectedEndTime\"    type=\"dateTime\"]\n *      element ref=\"xls:RoutePreference\"\n *      element ref=\"xls:WayPointList\"\n *      element ref=\"xls:AvoidList\"\n * ```\n * ```\n * element name=\"RoutePreference\" => value = Fastest | Shortest | Pedestrian\n * ```\n * ```\n * element name=\"WayPointList\"\n *      element ref=\"xls:StartPoint\"\n *      element ref=\"xls:ViaPoint\" minOccurs=\"0\"\n *      element ref=\"xls:EndPoint\"\n * ```\n * ```\n * element name=\"StartPoint\"\n *    [element name=\"GeocodeMatchCode\"]\n *      [attribute name=\"accuracy\"]\n *      [attribute name=\"matchType\"] => value = City, Street, Street number, Street enhanced, ...\n *    element name=\"Position\"\n *      element ref=\"gml:Point\"\n * ```\n * ```\n * element name=\"ViaPoint\"\n *    [element name=\"GeocodeMatchCode\"]\n *      [attribute name=\"accuracy\"]\n *      [attribute name=\"matchType\"] => value = City, Street, Street number, Street enhanced, ...\n *    element name=\"Position\"\n *      element ref=\"gml:Point\"\n * ```\n * ```\n * element name=\"EndPoint\"\n *    [element name=\"GeocodeMatchCode\"]\n *      [attribute name=\"accuracy\"]\n *      [attribute name=\"matchType\"] => value = City, Street, Street number, Street enhanced, ...\n *    element name=\"Position\"\n *      element ref=\"gml:Point\"\n * ```\n * ```\n * element name=\"AvoidList\"\n *      [element ref=\"xls:AOI\"]\n *      [element ref=\"xls:_Location\"] (cf. element name=\"Position\")\n *      element ref=\"xls:AvoidFeature\"\n * ```\n * ```\n * [element name=\"AOI\"]\n *      [element ref=\"gml:CircleByCenterPoint\" || element ref=\"gml:Polygon\" || element ref=\"gml:Envelope\"]\n * ```\n * ```\n * element name=\"AvoidFeature\" => value = highway | tollway | tunnel | bridge\n * ```\n * ```\n * [element name=\"RouteMapRequest\"]\n *      [element name=\"Output\"]\n *          attribute name=\"width\"\n *          attribute name=\"height\"\n *          attribute name=\"format\"\n *          attribute name=\"BGcolor\"\n *          attribute name=\"transparent\"\n *          attribute name=\"style\" => value = Overview | Maneuver\n *          element name=\"BBoxContext\" type=\"gml:EnvelopeType\"\n * ```\n * ```\n * element name=\"RouteInstructionsRequest\"\n *  [attribute name=\"format\"]           default=\"text/plain\"\n *  attribute name=\"provideGeometry\"    default=\"false\"\n *  attribute name=\"provideBoundingBox\" default=\"false\"\n * ```\n * ```\n * [element name=\"RouteGeometryRequest\"]\n *  [attribute name=\"scale\"]                  default=\"1\"\n *  [attribute name=\"provideStartingPortion\"] default=\"false\"\n *  [attribute name=\"maxPoints\"]              default=\"100\"\n *      [element name=\"BoundingBox\" type=\"gml:EnvelopeType\" ]\n * ```\n *\n * --------\n * Requte :\n * --------\n * ```\n * <?xml version=\"1.0\" encoding=\"UTF-8\"?>\n * <XLS\n * xmlns:xls=\"http://www.opengis.net/xls\"\n * xmlns:sch=\"http://www.ascc.net/xml/schematron\"\n * xmlns:gml=\"http://www.opengis.net/gml\"\n * xmlns:xlsext=\"http://www.opengis.net/xlsext\"\n * xmlns:xlink=\"http://www.w3.org/1999/xlink\"\n * xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n * xsi:schemaLocation=\"http://www.opengis.net/xls http://schemas.opengis.net/ols/1.1.0/RouteService.xsd\"\n * version=\"1.1\" xls:lang=\"en\">\n * <RequestHeader/>\n * <Request methodName=\"RouteRequest\" requestID=\"123456789\" version=\"1.1\">\n *   <DetermineRouteRequest distanceUnit=\"KM\">\n *     <RoutePlan>\n *       <RoutePreference>Fastest</RoutePreference>\n *       <xlsext:vehicle name=\"Car\" />\n *       <WayPointList>\n *         <StartPoint>\n *           <Position><gml:Point srsName=\"EPSG:4326\"><gml:pos>2.29993 48.87228</gml:pos></gml:Point></Position>\n *         </StartPoint>\n *         <EndPoint>\n *           <Position><gml:Point srsName=\"EPSG:4326\"><gml:pos>-1.53604 47.21548</gml:pos></gml:Point></Position>\n *         </EndPoint>\n *       </WayPointList>\n *     </RoutePlan>\n *     <RouteInstructionsRequest provideGeometry=\"true\"/>\n *     <RouteGeometryRequest/>\n *   </DetermineRouteRequest>\n * </Request>\n * </XLS\n * ```\n * -----------\n * References :\n * -----------\n * - {@link https://geoportail.forge.ign.fr/jira/browse/GPP-CI}\n * - {@link https://geoportail.forge.ign.fr/jira/browse/GPP-CI-1 Specif. ols}\n * - {@link https://geoportail.forge.ign.fr/jira/browse/GPP-CI-9 Extension}\n * - {@link https://github.com/Emergya/openlayers/blob/master/lib/OpenLayers/Format/XLS/v1_2_0.js}\n *\n * @example\n * // encapsule un objet dans une coquille XSL, Factory sur les objets ''\n * rs = new RouteService ();\n * rs.addRequest (req);\n * rs.toString();\n *  ou\n * rs = new RouteService ({\n *      ...\n * });\n * rs.toString();\n *\n * @extends {Gp.Formats.XLS}\n * @constructor\n * @alias Gp.Formats.XLS.RouteService\n * @param {Object} options - options\n * @param {Object}   options.routePreference -  fastest ,  shortest  ou  pedestrian \n * @param {String}   options.startPoint - Point de dpart (coordonnes exprimes en WGS84G)\n * @param {String}   options.viaPoint - Liste de points intermdiaires\n * @param {String}   options.endPoint - Point d'arrive (coordonnes)\n * @param {Object}   options.avoidFeature -  highway ,  tollway ,  tunnel  ou  bridge \n * @param {Object}   options.graph -  car \n * @param {Object}   options.expectedStartTime - Date et heure de dpart\n * @param {Object}   options.provideGeometry - true | false\n * @param {Object}   options.provideBoundingBox - true | false\n * @param {Object}   options.distanceUnit - Unit dans lesquelles la distance est exprime ( m  ou  km )\n * @param {Function} options.onsuccess - function callback success (TODO)\n * @param {Function} options.onerror   - function callback error   (TODO)\n *\n * @example\n * var options = {\n *      // spcifique au service\n *      startPoint: {\n *          x: 42.1121,\n *          y: 1.5557\n *      },\n *      endPoint: {\n *          x: 42.1121,\n *          y: 1.5557\n *      },\n *      viaPoint : [\n *          {x: 42.1121,y: 1.5557},\n *          {x: 42.1121,y: 1.5557},\n *          {x: 42.1121,y: 1.5557}\n *      ],\n *      provideBoundingBox : false,\n *      avoidFeature : [\"bridge\", \"tunnel\", \"tollway\"],\n *      expectedStartTime : \"2015-12-23\", // YYYY-MM-DDThh:mm:ssZ\n *      distanceUnit : \"km\",\n *      vehicle: \"car\",\n *      provideGeometry : false,\n *      routePreference : \"fastest\"\n * };\n *\n * @private\n */\nfunction RouteService (options) {\n\n    this.logger = __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__[\"a\" /* default */].getLogger();\n    this.logger.trace(\"[Constructeur RouteService ()]\");\n\n    if (!(this instanceof RouteService)) {\n        throw new TypeError(\"RouteService constructor cannot be called as a function.\");\n    }\n\n    /**\n     * Nom de la classe\n     */\n    this.CLASSNAME = \"RouteService\";\n\n    /**\n     * Type de classe\n     * RouteRequest par defaut\n     */\n    this.CLASSTYPE = \"RouteRequest\";\n\n    // appel du constructeur par heritage\n    __WEBPACK_IMPORTED_MODULE_1__AbstractService__[\"a\" /* default */].apply(this, arguments);\n\n}\n\n/**\n * @lends module:RouteService#\n */\nRouteService.prototype = Object.create(__WEBPACK_IMPORTED_MODULE_1__AbstractService__[\"a\" /* default */].prototype, {\n    // todo\n    // getter/setter\n});\n\n/**\n * Constructeur (alias)\n */\nRouteService.prototype.constructor = RouteService;\n\n/**\n * (overwrite) Ajout d'un objet de type  : RouteRequest\n *\n * @param {Object} oRequest - RouteRequest\n */\nRouteService.prototype.addRequest = function (oRequest) {\n\n    // on controle les types accepts\n    if (oRequest.CLASSNAME === \"DetermineRouteRequest\") {\n        this.oRequest = oRequest;\n    } else {\n        throw new Error(\"Ce n'est pas un objet de type 'Route Request' !?\");\n    }\n\n};\n\n/**\n * (overwrite) Ajout d'un objet de type RouteFilterExtension\n *\n * @param {Object} oFilter - RouteFilterExtension\n */\nRouteService.prototype.addFilter = function (oFilter) {\n\n    // gestion des extensions (vehicle)\n    if (oFilter instanceof __WEBPACK_IMPORTED_MODULE_3__RouteService_RouteRequestExtension___default.a) {\n        this.oFilter = oFilter;\n    }\n};\n\n/**\n * (overwrite) toString\n *\n * @returns {String}\n */\nRouteService.prototype.toString = function () {\n\n    // soit, on a un objet Request dj instanci\n    // sinon, il faut le construire  partir des options  disposition\n    if (!this.oRequest) {\n\n        // il nous faut des options\n        if (!this.options) {\n            throw new Error(\"Les options ne sont pas renseignes, impossible de construire la requte !\");\n        }\n\n        if (this.CLASSTYPE === \"RouteRequest\") {\n            var settings = {\n                distanceUnit : this.options.distanceUnit || null,\n                provideGeometry : this.options.provideGeometry || null,\n                provideBoundingBox : this.options.provideBoundingBox || null,\n                route : {\n                    routePreference : this.options.routePreference || null,\n                    startPoint : this.options.startPoint,\n                    viaPoint : this.options.viaPoint || null,\n                    endPoint : this.options.endPoint,\n                    avoidFeature : this.options.avoidFeature || null,\n                    graph : this.options.graph || null,\n                    expectedStartTime : this.options.expectedStartTime || null\n                }\n            };\n            this.oRequest = new __WEBPACK_IMPORTED_MODULE_2__RouteService_DetermineRouteRequest__[\"a\" /* default */](settings);\n            // ajout des filtres spcifiques au service\n            if (this.oFilter) {\n                this.oRequest.addFilter(this.oFilter);\n            }\n        }\n    }\n\n    // objet indefini !?\n    if (!this.oRequest) {\n        throw new Error(\"Type de requte indefini !\");\n    }\n\n    this.strRequest = this.oRequest.toString();\n    return this.strRequest;\n};\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (RouteService);\n\n\n/***/ }),\n/* 88 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__model_RoutePlan__ = __webpack_require__(89);\n\n\n\n/**\n * @classdesc\n *\n * Requte de calcul d'itinraire\n *\n * ----\n * XSD :\n * ----\n * [] => non implement !\n *\n * ```\n * element name=\"DetermineRouteRequest\"\n *  [attribute name=\"provideRouteHandle\" default=\"false\"]\n *  attribute name=\"distanceUnit\"       default=\"M\"\n *      [element ref=\"xls:RouteHandle\" || element ref=\"xls:RoutePlan\"]\n *      element ref=\"xls:RoutePlan\"\n *      element ref=\"xls:RouteInstructionsRequest\"\n *      [element ref=\"xls:RouteGeometryRequest\"]\n *      [element ref=\"xls:RouteMapRequest\"]\n * ```\n * ```\n * element name=\"RouteInstructionsRequest\"\n *  [attribute name=\"format\"]           default=\"text/plain\"\n *  attribute name=\"provideGeometry\"    default=\"false\"\n *  attribute name=\"provideBoundingBox\" default=\"false\"\n * ```\n * ```\n * element name=\"RouteGeometryRequest\"\n *  [attribute name=\"scale\"]                  default=\"1\"\n *  [attribute name=\"provideStartingPortion\"] default=\"false\"\n *  [attribute name=\"maxPoints\"]              default=\"100\"\n *      [element name=\"BoundingBox\" type=\"gml:EnvelopeType\" ]\n * ```\n * ```\n * [element name=\"RouteMapRequest\"]\n *      [element name=\"Output\"]\n *          [attribute name=\"width\"]\n *          [attribute name=\"height\"]\n *          [attribute name=\"format\"]\n *          [attribute name=\"BGcolor\"]\n *          [attribute name=\"transparent\"]\n *          [attribute name=\"style\"] => value = Overview | Maneuver\n *          [element name=\"BBoxContext\" type=\"gml:EnvelopeType\"]\n * ```\n *\n * --------\n * Requte :\n * --------\n * ```\n *   <DetermineRouteRequest distanceUnit=\"KM\">\n *     <RoutePlan>\n *              <RoutePreference>Fastest</RoutePreference>\n *              <xlsext:vehicle name=\"Car\" />\n *              <WayPointList>\n *                  <StartPoint>\n *                      <Position><gml:Point srsName=\"EPSG:4326\"><gml:pos>2.29993 48.87228</gml:pos></gml:Point></Position>\n *                  </StartPoint>\n *                  <EndPoint>\n *                      <Position><gml:Point srsName=\"EPSG:4326\"><gml:pos>-1.53604 47.21548</gml:pos></gml:Point></Position>\n *                  </EndPoint>\n *              </WayPointList>\n *     </RoutePlan>\n *     <RouteInstructionsRequest provideGeometry=\"true\"/>\n *     <RouteGeometryRequest/>\n *   </DetermineRouteRequest>\n * ```\n *\n * @constructor\n * @alias Gp.Formats.XLS.RouteService.DetermineRouteRequest\n * @param {Object} options - options\n * @param {Object}   options.route.routePreference -  fastest ,  shortest  ou  pedestrian \n * @param {String}   options.route.startPoint - Point de dpart (coordonnes exprimes en WGS84G)\n * @param {String}   options.route.viaPoint - Liste de points intermdiaires\n * @param {String}   options.route.endPoint - Point d'arrive (coordonnes)\n * @param {Object}   options.route.avoidFeature -  highway ,  tollway ,  tunnel  ou  bridge \n * @param {Object}   options.route.vehicle -  car \n * @param {Object}   options.route.expectedStartTime - Date et heure de dpart\n * @param {Object}   options.provideGeometry - true | false\n * @param {Object}   options.provideBoundingBox - true | false\n * @param {Object}   options.distanceUnit - Unit dans lesquelles la distance est exprime ( m  ou  km )\n * @param {Function} options.onsuccess - function callback success (TODO)\n * @param {Function} options.onerror   - function callback error   (TODO)\n *\n * @private\n */\nfunction DetermineRouteRequest (options) {\n\n    this.logger = __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__[\"a\" /* default */].getLogger();\n    this.logger.trace(\"[Constructeur DetermineRouteRequest ()]\");\n\n    if (!(this instanceof DetermineRouteRequest)) {\n        throw new TypeError(\"DetermineRouteRequest constructor cannot be called as a function.\");\n    }\n\n    // options par defaut\n    this.options = options || {};\n\n    // et on ajoute les options en paramtre aux options par dfaut\n    for (var opt in options) {\n        if (options.hasOwnProperty(opt)) {\n            this.options[opt] = options[opt];\n        }\n    }\n\n    /**\n     * Nom de la classe (heritage)\n     */\n    this.CLASSNAME = \"DetermineRouteRequest\";\n}\n\nDetermineRouteRequest.prototype = {\n\n    /**\n     * @lends module:DetermineRouteRequest#\n     */\n\n    /**\n     * request (out)\n     * @type {String}\n     */\n    strRequest : null,\n\n    /**\n     * RoutePlan\n     * @type {Address}\n     */\n    oRoutePlan : null,\n\n    /**\n     * Template de la requte.\n     * substitution des valeurs suivantes :\n     * __DISTANCEUNIT__,\n     * __ROUTEPLAN__, __ROUTEINSTRUCTIONREQUEST__, __ROUTEGEOMETRYREQUEST__, __ROUTEMAPREQUEST__\n     * __PROVIDEGEOMETRY__, __PROVIDEBBOX__\n     */\n    template : {\n        determineRouteRequest : \"<DetermineRouteRequest distanceUnit=\\\"__DISTANCEUNIT__\\\">\" +\n            \"__ROUTEPLAN__\" +\n            \"__ROUTEINSTRUCTIONREQUEST__\" +\n            \"__ROUTEGEOMETRYREQUEST__\" +\n            \"__ROUTEMAPREQUEST__\" +\n            \"</DetermineRouteRequest>\",\n        routeInstructionRequest : \"<RouteInstructionsRequest \" +\n            \"provideGeometry=\\\"__PROVIDEGEOMETRY__\\\" \" +\n            \"provideBoundingBox=\\\"__PROVIDEBBOX__\\\" />\",\n        routeGeometryRequest : \"<RouteGeometryRequest />\",\n        routeMapRequest : \"\" // FIXME <RouteMapRequest/> not yet implemented !\n    },\n\n    /**\n     * Ajout d'un objet de type RoutePlan\n     *\n     * @param {Object} oRoutePlan - RoutePlan\n     */\n    addRoute : function (oRoutePlan) {\n\n        if (oRoutePlan instanceof __WEBPACK_IMPORTED_MODULE_1__model_RoutePlan__[\"a\" /* default */]) {\n            this.oRoutePlan = oRoutePlan;\n        }\n    },\n\n    /**\n     * Constructeur (alias)\n     */\n    constructor : DetermineRouteRequest,\n\n    /**\n     * toString\n     *\n     * @returns {String}\n     */\n    toString : function () {\n\n        var template = \"\";\n        template = this.template.determineRouteRequest;\n        template = template.replace(/__DISTANCEUNIT__/g, this.options.distanceUnit || \"KM\");\n\n        // soit on a dj un objet RoutePlan instanci,\n        // sinon, on le fabrique via les options\n        if (!this.oRoutePlan) {\n\n            var settings = this.options.route;\n\n            this.oRoutePlan = new __WEBPACK_IMPORTED_MODULE_1__model_RoutePlan__[\"a\" /* default */](settings);\n            if (!this.oRoutePlan) {\n                throw new Error(\"La construction du calcul d'initineraire n'est pas correctement definie !?\");\n            }\n\n        }\n\n        // routeplan\n        template = template.replace(/__ROUTEPLAN__/g, this.oRoutePlan.toString());\n\n        // instruction\n        var tmplInstruction = this.template.routeInstructionRequest;\n        tmplInstruction = tmplInstruction.replace(/__PROVIDEGEOMETRY__/g, this.options.provideGeometry || false);\n        tmplInstruction = tmplInstruction.replace(/__PROVIDEBBOX__/g, this.options.provideBoundingBox || false);\n        template = template.replace(/__ROUTEINSTRUCTIONREQUEST__/g, tmplInstruction);\n\n        // geometry\n        var tmplGeometry = this.template.routeGeometryRequest;\n        template = template.replace(/__ROUTEGEOMETRYREQUEST__/g, tmplGeometry);\n\n        // map\n        var tmplMap = this.template.routeMapRequest;\n        template = template.replace(/__ROUTEMAPREQUEST__/g, tmplMap);\n\n        this.strRequest = template;\n        return this.strRequest;\n    }\n};\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (DetermineRouteRequest);\n\n\n/***/ }),\n/* 89 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__ = __webpack_require__(0);\n\n\n/**\n * @classdesc\n *  * lment regroupant l'ensemble des donnes et paramtres pour le calcul d'itinraire : points de navigation, configuration.\n *\n * ----\n * XSD :\n * ----\n * [] => non implement !\n *\n * ```\n * element name=\"RoutePlan\"\n *  [attribute name=\"useRealTimeTraffic\" default=\"false\"]\n *  [attribute name=\"expectedStartTime\"  type=\"dateTime\"]\n *  [attribute name=\"expectedEndTime\"    type=\"dateTime\"]\n *      element ref=\"xls:RoutePreference\"\n *      element ref=\"xls:WayPointList\"\n *      element ref=\"xls:AvoidList\"\n * ```\n * ```\n * element name=\"RoutePreference\"\n *  => value = fastest | shortest | pedestrian\n * ```\n * ```\n * element name=\"WayPointList\"\n *      element ref=\"xls:StartPoint\"\n *      element ref=\"xls:ViaPoint\" minOccurs=\"0\"\n *      element ref=\"xls:EndPoint\"\n * ```\n * ```\n * element name=\"StartPoint\"\n *    [element name=\"GeocodeMatchCode\"]\n *      [attribute name=\"accuracy\"]\n *      [attribute name=\"matchType\"] => value = City, Street, Street number, Street enhanced, ...\n *    element name=\"Position\"\n *      element ref=\"gml:Point\"\n * ```\n * ```\n * element name=\"ViaPoint\"\n *    [element name=\"GeocodeMatchCode\"]\n *      [attribute name=\"accuracy\"]\n *      [attribute name=\"matchType\"] => value = City, Street, Street number, Street enhanced, ...\n *    element name=\"Position\"\n *      element ref=\"gml:Point\"\n * ```\n * ```\n * element name=\"EndPoint\"\n *    [element name=\"GeocodeMatchCode\"]\n *      [attribute name=\"accuracy\"]\n *      [attribute name=\"matchType\"] => value = City, Street, Street number, Street enhanced, ...\n *    element name=\"Position\"\n *      element ref=\"gml:Point\"\n * ```\n * ```\n * element name=\"AvoidList\"\n *      [element ref=\"xls:AOI\"]\n *      [element ref=\"xls:_Location\"] (cf. element name=\"Position\")\n *      element ref=\"xls:AvoidFeature\"\n * ```\n * ```\n * [element name=\"AOI\"]\n *      [element ref=\"gml:CircleByCenterPoint\" || element ref=\"gml:Polygon\" || element ref=\"gml:Envelope\"]\n * ```\n * ```\n * element name=\"AvoidFeature\" => value = highway | tollway | tunnel | bridge\n * ```\n *\n * --------\n * Requte :\n * --------\n * ```\n *     <RoutePlan>\n *       <RoutePreference>Fastest</RoutePreference>\n *       <xlsext:vehicle name=\"Car\" />\n *       <WayPointList>\n *         <StartPoint>\n *           <Position><gml:Point srsName=\"EPSG:4326\"><gml:pos>2.29993 48.87228</gml:pos></gml:Point></Position>\n *         </StartPoint>\n *         <EndPoint>\n *           <Position><gml:Point srsName=\"EPSG:4326\"><gml:pos>-1.53604 47.21548</gml:pos></gml:Point></Position>\n *         </EndPoint>\n *       </WayPointList>\n *       <AvoidList>\n *          <AvoidFeature>highway</AvoidFeature>\n *          <AvoidFeature>tollway</AvoidFeature>\n *          <AvoidFeature>tunnel</AvoidFeature>\n *       </AvoidList>\n *     </RoutePlan>\n * ```\n * @constructor\n * @alias Gp.Formats.XLS.RouteService.RoutePlan\n * @param {Object} options - options\n *\n * @private\n */\nfunction RoutePlan (options) {\n\n    this.logger = __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__[\"a\" /* default */].getLogger(\"RoutePlan\");\n    this.logger.trace(\"[Constructeur RoutePlan ()]\");\n\n    if (!(this instanceof RoutePlan)) {\n        throw new TypeError(\"RoutePlan constructor cannot be called as a function.\");\n    }\n\n    // param par defaut\n    this.options = options || {};\n\n    // param obligatoire\n    if (!options.startPoint) {\n        throw new Error(\"l'option 'startPoint' n'est pas renseigne !\");\n    }\n\n    if (!options.endPoint) {\n        throw new Error(\"l'option 'endPoint' n'est pas renseigne !\");\n    }\n\n    // et on ajoute les options en paramtre aux options par dfaut\n    for (var opt in options) {\n        if (options.hasOwnProperty(opt)) {\n            this.options[opt] = options[opt];\n        }\n    }\n}\n\nRoutePlan.prototype = {\n\n    /**\n     * Constructeur (alias)\n     */\n    constructor : RoutePlan,\n\n    /**\n     * request (out)\n     * @type {String}\n     */\n    requestString : null,\n\n    /**\n     * Template de la requte.\n     * substitution des valeurs suivantes :\n     * - __ROUTEPREFERENCE__, __VALUEROUTEPREFERENCE__\n     * - __GRAPH__, __VALUEGRAPH__\n     * - __WAYPOINTLIST__ (lst?), __STARTPOINT__, __VIAPOINT__, __ENDPOINT__, __POINT__, __X__, __Y__\n     * - __AVOIDLIST__ (lst!), __AVOIDFEATURE__, __VALUEAVOIDFEATURE__\n     */\n    template : {\n        routePlan : \"<RoutePlan>\" +\n            \"__ROUTEPREFERENCE__\" +\n            \"__GRAPH__\" +\n            \"__WAYPOINTLIST__\" +\n            \"__AVOIDLIST__\" +\n            \"</RoutePlan>\",\n        routePreference : \"<RoutePreference>__VALUEROUTEPREFERENCE__</RoutePreference>\",\n        graph : \"<xlsext:graphName xmlns:xlsext=\\\"http://www.opengis.net/xlsext\\\" name=\\\"__VALUEGRAPH__\\\"/>\",\n        wayPointList : {\n            container : \"<WayPointList>\" +\n                \"__STARTPOINT__\" +\n                \"__VIAPOINT__\" +\n                \"__ENDPOINT__\" +\n                \"</WayPointList>\",\n            point : \"<Position><gml:Point xmlns:gml=\\\"http://www.opengis.net/gml\\\"><gml:pos>__X__ __Y__</gml:pos></gml:Point></Position>\",\n            startPoint : \"<StartPoint>\" +\n                \"__POINT__\" +\n                \"</StartPoint>\",\n            endPoint : \"<EndPoint>\" +\n                \"__POINT__\" +\n                \"</EndPoint>\",\n            viaPoint : \"<ViaPoint>\" +\n                \"__POINT__\" +\n                \"</ViaPoint>\" // implmentation de plusieurs tapes...\n        },\n        avoidList : {\n            container : \"<AvoidList>\" +\n                \"__AVOIDFEATURE__\" +\n                \"</AvoidList>\",\n            avoidFeature : \"<AvoidFeature>__VALUEAVOIDFEATURE__</AvoidFeature>\"\n        }\n    },\n\n    /**\n     * toString\n     *\n     * @returns {String}\n     */\n    toString : function () {\n\n        var template = \"\";\n        template = this.template.routePlan;\n\n        // preference\n        if (this.options.routePreference) {\n            var tmplPreference = this.template.routePreference;\n            tmplPreference = tmplPreference.replace(/__VALUEROUTEPREFERENCE__/, this.options.routePreference);\n            template = template.replace(/__ROUTEPREFERENCE__/g, tmplPreference);\n        }\n        // clean preference\n        template = template.replace(/__ROUTEPREFERENCE__/g, \"\");\n\n        // exclusions\n        if (this.options.avoidFeature) {\n            var tmplAvoidList = this.template.avoidList.container;\n            var avoidFeatures = [];\n            for (var i = 0; i < this.options.avoidFeature.length; i++) {\n                var tmplAvoidFeature = this.template.avoidList.avoidFeature;\n                tmplAvoidFeature = tmplAvoidFeature.replace(/__VALUEAVOIDFEATURE__/, this.options.avoidFeature[i]);\n                avoidFeatures.push(tmplAvoidFeature);\n            }\n            tmplAvoidList = tmplAvoidList.replace(/__AVOIDFEATURE__/, avoidFeatures.join(\"\\n\"));\n            template = template.replace(/__AVOIDLIST__/g, tmplAvoidList);\n        }\n        // clean exclusions\n        template = template.replace(/__AVOIDLIST__/g, \"\");\n\n        // graph\n        if (this.options.graph) {\n            var tmplVehicle = this.template.graph;\n            tmplVehicle = tmplVehicle.replace(/__VALUEGRAPH__/, this.options.graph);\n            template = template.replace(/__GRAPH__/g, tmplVehicle);\n        }\n        // clean vehicle\n        template = template.replace(/__GRAPH__/g, \"\");\n\n        // points\n        var tmplWayPointList = this.template.wayPointList.container;\n        var tmplPoint = \"\";\n        // start\n        tmplPoint = this.template.wayPointList.point;\n        tmplPoint = tmplPoint.replace(/__X__/, this.options.startPoint.x);\n        tmplPoint = tmplPoint.replace(/__Y__/, this.options.startPoint.y);\n        tmplWayPointList = tmplWayPointList.replace(/__STARTPOINT__/,\n            this.template.wayPointList.startPoint.replace(/__POINT__/, tmplPoint));\n        // end\n        tmplPoint = this.template.wayPointList.point;\n        tmplPoint = tmplPoint.replace(/__X__/, this.options.endPoint.x);\n        tmplPoint = tmplPoint.replace(/__Y__/, this.options.endPoint.y);\n        tmplWayPointList = tmplWayPointList.replace(/__ENDPOINT__/,\n            this.template.wayPointList.endPoint.replace(/__POINT__/, tmplPoint));\n        // via\n        if (this.options.viaPoint) {\n            var points = [];\n            for (var j = 0; j < this.options.viaPoint.length; j++) {\n                var p = this.options.viaPoint[j];\n                tmplPoint = this.template.wayPointList.point;\n                tmplPoint = tmplPoint.replace(/__X__/, p.x);\n                tmplPoint = tmplPoint.replace(/__Y__/, p.y);\n                points.push(tmplPoint);\n            }\n\n            tmplWayPointList = tmplWayPointList.replace(/__VIAPOINT__/,\n                this.template.wayPointList.viaPoint.replace(/__POINT__/, points.join(\"\\n\")));\n        } else {\n            // clean viaPoint\n            tmplWayPointList = tmplWayPointList.replace(/__VIAPOINT__/, \"\");\n        }\n\n        template = template.replace(/__WAYPOINTLIST__/g, tmplWayPointList);\n\n        this.requestString = template;\n        return this.requestString;\n    }\n};\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (RoutePlan);\n\n\n/***/ }),\n/* 90 */\n/***/ (function(module, exports) {\n\n/**\n * not implemented ! \n * \n * Extension de type 'graphName' de l'objet RoutePlan'\n * \n * FIXME L'extension 'graphName' est intgr comme tant du standard OLS.\n *       La balise <xlsext:GraphName> viendrait surcharger le comportement de RoutePreference...\n * \n * ex. <xlsext:graphName name=\"Voiture\" />\n */\n\n\n/***/ }),\n/* 91 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__ = __webpack_require__(1);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__model_RouteParamREST__ = __webpack_require__(92);\n\n\n\n\n\n/**\n * @classdesc\n * Classe de gestion des requtes de type REST sur le service de calcul d'itineraire\n * (uniquement en GET)\n *\n * @constructor\n * @alias Gp.Services.Route.Request.RouteRequestREST\n * @param {Object} options - options definies dans le composant Route\n *\n * @example\n * var options = {\n *      (...)\n * };\n *\n * @private\n */\nfunction RouteRequestREST (options) {\n\n    this.logger = __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__[\"a\" /* default */].getLogger(\"RouteRequestREST\");\n    this.logger.trace(\"[Constructeur RouteRequestREST ()]\");\n\n    if (!(this instanceof RouteRequestREST)) {\n        throw new TypeError(\"RouteRequestREST constructor cannot be called as a function.\");\n    }\n\n    // existance des options\n    if (!options) {\n        throw new Error(__WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__[\"a\" /* default */].getMessage(\"PARAM_EMPTY\", \"options\"));\n    }\n\n    /** liste des options */\n    this.settings = options;\n}\n\nRouteRequestREST.prototype = {\n\n    /**\n     * @lends module:RouteRequestREST#\n     */\n\n    /**\n     * request\n     * @type {String}\n     */\n    requestString : null,\n\n    /**\n     * Constructeur (alias)\n     */\n    constructor : RouteRequestREST,\n\n    /**\n     * Construction de la requte.\n     *\n     * @example\n     * // GET  out : origin=2.416907353809513,48.8465772142297&destination=2.4248037771493673,48.84591353161838\n     * // POST out : Not yet supported method POST !\n     * @returns {String}\n     */\n    processRequestString : function () {\n        // INFO\n        // construction simple sans template...,\n        // mais en attendant que les services soient fixs, on taggue ce composant en mode PROTOTYPE !\n        this.logger.warn(\"FIXME : PROTOTYPE !\");\n\n        // Mapping des options avec le service de l'API REST\n        var oParams = new __WEBPACK_IMPORTED_MODULE_2__model_RouteParamREST__[\"a\" /* default */](this.settings);\n        var params = oParams.getParams();\n\n        var request = \"\";\n        for (var i = 0; i < params.length; i++) {\n            var o = params[i];\n            if (request) {\n                request += \"&\";\n            }\n            request += o.k + \"=\" + o.v;\n        }\n\n        // Exemple :\n        //  http://wxs.ign.fr/KEY/itineraire/rest/route.json?\n        //  origin=&\n        //  destination=&\n        //  waypoints=&\n        //  method=DISTANCE&\n        //  graph=Pieton&\n        //  graphName=Pieton&\n        //  exclusions=&\n        //  tolerance=10&\n        //  srs=\n\n        this.logger.trace(request);\n        this.requestString = request;\n\n        return this.requestString;\n    }\n};\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (RouteRequestREST);\n\n\n/***/ }),\n/* 92 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__ = __webpack_require__(0);\n\n\n\n/**\n * @classdesc\n * Classe de gestion des param. des requtes du service de calcul d'itineraire (REST).\n *      Permet le mapping avec les options du service.\n * @constructor\n * @alias Gp.Services.Route.Request.RouteParamREST\n * @param {Object} options - options\n *\n * @private\n */\nfunction RouteParamREST (options) {\n\n    if (!(this instanceof RouteParamREST)) {\n        throw new TypeError(\"RouteParamREST constructor cannot be called as a function.\");\n    }\n\n    this.logger = __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__[\"a\" /* default */].getLogger();\n    this.logger.trace(\"[Constructeur RouteParamREST ()]\");\n\n    /**\n     * Options en paramtres du constructeur.\n     */\n    this.options = options || {};\n\n    // mapping des options avec l'API REST\n\n    /** Coordonnes du point de dpart. */\n    this.origin = this.options.startPoint.x + \",\" + this.options.startPoint.y;\n\n    /** Coordonnes du point darrive. */\n    this.destination = this.options.endPoint.x + \",\" + this.options.endPoint.y;\n\n    /** Coordonnes des tapes point de dpart. */\n    this.waypoints = this.options.viaPoints || null;\n\n    /** Date et heure de dpart */\n    this.startDateTime = this.options.expectedStartTime || null; // TODO format !?\n\n    /** Nom du graphe  utiliser */\n    this.graphName = this.options.graph;\n\n    /** projection (code EPSG comme epsg:4326 ou wgs84) */\n    this.srs = this.options.srs;\n\n    /** Liste des rgles de restrictions  utiliser, spars pas le caractre , ou ; (Exemple : Toll, Tunnel, Bridge) */\n    this.exclusions = this.options.exclusions;\n\n    /**\n     * itinraire le plus court (DISTANCE) ou le plus rapide (TIME)\n     * Par defaut, DISTANCE...\n     * cf. mapping ci dessous\n     */\n    this.method = \"TIME\";\n\n    // mapping particulier sur l'option 'routePreference'\n    if (this.options.routePreference) {\n        var value = this.options.routePreference;\n        switch (value) {\n            case \"fastest\":\n                this.method = \"TIME\";\n                break;\n            case \"shortest\":\n                this.method = \"DISTANCE\";\n                break;\n            default:\n                this.logger.warn(\"Par defaut, on prend l'itinraire le plus rapide !\");\n                this.method = \"TIME\";\n        }\n    }\n\n    /** Format de sortie (rsum de litinraire) */\n    this.format = (this.options.geometryInInstructions) ? \"STANDARDEXT\" : \"STANDARD\";\n\n    // y'a t-il d'autres options  ajouter (par defaut) ?\n\n    /** Distance de tolrance (en mtre) de simplification de la gomtrie. */\n    this.tolerance = 10;\n\n    /** identifiant du vhicule (enregistr dans les profils de vhicule)  utiliser */\n    this.profileId = null;\n\n    /** Profil du vhicule (enregistr dans les profils de vhicule)  utiliser */\n    this.profileName = null;\n\n    // options dont le mapping n'est pas possible :\n    // - distanceUnit\n    // - provideBoundingBox\n}\n\n/**\n * CLASSNAME\n */\nRouteParamREST.CLASSNAME = \"RouteParamREST\";\n\nRouteParamREST.prototype = {\n\n    /**\n     * @lends module:RouteParamREST#\n     */\n\n    /**\n     * Constructeur (alias)\n     */\n    constructor : RouteParamREST,\n\n    /**\n     * Retourne une liste de points\n     */\n    getWaypoints : function () {\n        if (!this.waypoints) {\n            return;\n        }\n        var array = [];\n        for (var i = 0; i < this.waypoints.length; i++) {\n            var obj = this.waypoints[i];\n            array.push(obj.x + \",\" + obj.y);\n        }\n\n        return array.join(\";\");\n    },\n\n    /**\n     * Retourne la liste des exclusions\n     */\n    getExclusions : function () {\n        return this.exclusions.join(\";\");\n    }\n};\n\n/**\n * Tableau de clefs/valeurs pour param.\n *\n * @returns {Array}\n */\nRouteParamREST.prototype.getParams = function () {\n\n    var map = [];\n\n    map.push({\n        k : \"origin\",\n        v : this.origin\n    });\n\n    map.push({\n        k : \"destination\",\n        v : this.destination\n    });\n\n    map.push({\n        k : \"method\",\n        v : this.method\n    });\n\n    if (this.waypoints) {\n        map.push({\n            k : \"waypoints\",\n            v : this.getWaypoints()\n        });\n    }\n\n    if (this.startDateTime) {\n        map.push({\n            k : \"startDateTime\",\n            v : this.startDateTime\n        });\n    }\n\n    if (this.graphName) {\n        map.push({\n            k : \"graphName\",\n            v : this.graphName\n        });\n    }\n\n    if (this.exclusions) {\n        map.push({\n            k : \"exclusions\",\n            v : this.getExclusions()\n        });\n    }\n\n    if (this.srs) {\n        map.push({\n            k : \"srs\",\n            v : this.srs\n        });\n    }\n\n    if (this.format) {\n        map.push({\n            k : \"format\",\n            v : this.format\n        });\n    }\n\n    return map;\n};\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (RouteParamREST);\n\n\n/***/ }),\n/* 93 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__ = __webpack_require__(1);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__Exceptions_ErrorService__ = __webpack_require__(2);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__Formats_XML__ = __webpack_require__(4);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__Formats_WKT__ = __webpack_require__(8);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__Formats_RouteResponseRESTReader__ = __webpack_require__(94);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__Formats_RouteResponseOLSReader__ = __webpack_require__(95);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7__model_RouteResponse__ = __webpack_require__(16);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8__model_RouteInstruction__ = __webpack_require__(17);\n/**\n * Factory pour gnrer une reponse JSON  partir d'un XML ou d'un JSON\n * (Factory)\n *\n * @module RouteResponseFactory\n * @alias Gp.Services.Route.Response.RouteResponseFactory\n * @private\n */\n\n\n\n\n\n\n\n\n\n\nvar RouteResponseFactory = {\n\n    /**\n     * interface unique\n     *\n     * @method build\n     * @static\n     * @param {Object} options - options definies dans le composant Alti\n     *\n     * @example\n     *   var options = {\n     *      response :\n     *      outputFormat :\n     *      rawResponse :\n     *      scope :\n     *      onSuccess :\n     *      onError :\n     *   };\n     *\n     */\n    build : function (options) {\n\n        // logger\n        var logger = __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__[\"a\" /* default */].getLogger(\"RouteResponseFactory\");\n        logger.trace(\"RouteResponseFactory::build()\");\n\n        var data = null;\n\n        if (options.response) {\n            if (options.rawResponse) {\n                logger.trace(\"analyze response : raw\");\n                data = options.response;\n            } else {\n                switch (options.outputFormat) {\n\n                    case \"xml\":\n                        logger.trace(\"analyze response : xml\");\n\n                        // type de reader en fonction de l'API\n                        var routeReader = options.api === \"REST\" ? __WEBPACK_IMPORTED_MODULE_5__Formats_RouteResponseRESTReader__[\"a\" /* default */] : __WEBPACK_IMPORTED_MODULE_6__Formats_RouteResponseOLSReader__[\"a\" /* default */];\n\n                        try {\n\n                            var p = new __WEBPACK_IMPORTED_MODULE_3__Formats_XML__[\"a\" /* default */]({\n                                reader : routeReader\n                            });\n\n                            // FIXME : mode XHR ne retourne que des string ? JSONP aussi  ce niveau ?\n                            if ( typeof options.response === \"string\") {\n                                p.setXMLString(options.response);\n                            } else {\n                                p.setXMLDoc(options.response);\n                            }\n\n                            data = p.parse();\n\n                            if (!data) {\n                                throw new __WEBPACK_IMPORTED_MODULE_2__Exceptions_ErrorService__[\"a\" /* default */](__WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__[\"a\" /* default */].getMessage(\"SERVICE_RESPONSE_FORMAT\", \"xml\"));\n                            }\n\n                        } catch (e) {\n                            options.onError.call(options.scope, new __WEBPACK_IMPORTED_MODULE_2__Exceptions_ErrorService__[\"a\" /* default */](__WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__[\"a\" /* default */].getMessage(\"SERVICE_RESPONSE_ANALYSE\", options.response)));\n                            return;\n                        }\n\n                        break;\n\n                    case \"json\":\n                        logger.trace(\"analyze response : json\");\n\n                        var JSONResponse;\n                        if ( typeof options.response === \"string\") {\n                            JSONResponse = JSON.parse(options.response);\n                        } else {\n                            JSONResponse = options.response;\n                        }\n\n                        // le service renvoie t il une erreur ?\n                        if (JSONResponse.message) {\n                            // ex. {\"message\":\"message not null\", \"status\":\"ERROR\"}\n                            options.onError.call(options.scope, new __WEBPACK_IMPORTED_MODULE_2__Exceptions_ErrorService__[\"a\" /* default */](__WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__[\"a\" /* default */].getMessage(\"SERVICE_RESPONSE_EXCEPTION\", JSONResponse.message)));\n                            return;\n                        }\n\n                        // construction de l'objet rponse JSON\n                        if (JSONResponse) {\n                            var legs = [];\n                            var legSteps = [];\n                            var steps = [];\n\n                            data = new __WEBPACK_IMPORTED_MODULE_7__model_RouteResponse__[\"a\" /* default */]();\n\n                            if (data.hasOwnProperty(\"totalTime\")) {\n                                // info : il y a aussi JSONResponse.duration, qui donne la dure en hh:mm:ss.\n                                data.totalTime = parseFloat(JSONResponse.durationSeconds);\n                            }\n                            if (data.hasOwnProperty(\"totalDistance\")) {\n                                data.totalDistance = (options.distanceUnit === \"m\") ? JSONResponse.distanceMeters : JSONResponse.distance;\n                            }\n\n                            if (data.hasOwnProperty(\"bbox\")) {\n                                var coords = JSONResponse.bounds.split(/[,;]/);\n                                data.bbox.left = parseFloat(coords[0]);\n                                data.bbox.bottom = parseFloat(coords[1]);\n                                data.bbox.right = parseFloat(coords[2]);\n                                data.bbox.top = parseFloat(coords[3]);\n                            }\n                            /** callback success */\n                            var onWKTSuccess = function (json) {\n                                data.routeGeometry = json;\n                            };\n                            /** callback failed */\n                            var onWKTError = function (e) {\n                                console.log(e);\n                                options.onError.call(options.scope, new __WEBPACK_IMPORTED_MODULE_2__Exceptions_ErrorService__[\"a\" /* default */](__WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__[\"a\" /* default */].getMessage(\"PARAM_FORMAT\", [\"geometryWkt\"])));\n                            };\n\n                            if (data.hasOwnProperty(\"routeGeometry\")) {\n                                var geometry = JSONResponse.geometryWkt || JSONResponse.simplifiedWkt;\n                                if (geometry) {\n                                    __WEBPACK_IMPORTED_MODULE_4__Formats_WKT__[\"a\" /* default */].toJson(geometry, onWKTSuccess, onWKTError);\n                                    if (!data.routeGeometry) {\n                                        return;\n                                    }\n                                }\n                            }\n\n                            if (data.hasOwnProperty(\"routeInstructions\")) {\n                                var legList = JSONResponse.legs;\n                                var i;\n                                if (Array.isArray(legList) && legList.length) {\n                                    for (i = 0; i < legList.length; i++) {\n                                        legs.push(legList[i]);\n                                    }\n                                }\n                                if (Array.isArray(legs) && legs.length) {\n                                    for (i = 0; i < legs.length; i++) {\n                                        legSteps.push(legs[i].steps);\n                                    }\n                                }\n                                if (Array.isArray(legSteps) && legSteps.length) {\n                                    for (i = 0; i < legSteps.length; i++) {\n                                        steps = steps.concat(legSteps[i]);\n                                    }\n                                }\n\n                                steps.forEach(function (step) {\n                                    data.routeInstructions.push(new __WEBPACK_IMPORTED_MODULE_8__model_RouteInstruction__[\"a\" /* default */]());\n                                    data.routeInstructions[data.routeInstructions.length - 1].duration = step.durationSeconds;\n                                    data.routeInstructions[data.routeInstructions.length - 1].distance = (options.distanceUnit === \"m\") ? step.distanceMeters : step.distance;\n                                    data.routeInstructions[data.routeInstructions.length - 1].code = step.navInstruction;\n                                    // geometrie en geojson\n                                    var points = [];\n                                    for (var i = 0; i < step.points.length; i++) {\n                                        var point = step.points[i].split(\",\");\n                                        if (point) {\n                                            points.push(point);\n                                        }\n                                    }\n                                    if (points && points.length !== 0) {\n                                        data.routeInstructions[data.routeInstructions.length - 1].geometry = {\n                                            coordinates : points,\n                                            type : \"LineString\"\n                                        };\n                                    } else {\n                                        data.routeInstructions[data.routeInstructions.length - 1].geometry = null;\n                                    }\n\n                                    /*\n                                    Traduction du code en instruction\n                                    * - F : tout droit\n                                    * - B : demi-tour\n                                    * - L : tourner  gauche\n                                    * - R : tourner  droite\n                                    * - BL : tourner trs  gauche\n                                    * - BR : tourner trs  droite\n                                    * - FL : tourner lgrement  gauche\n                                    * - FR : tourner lgrement  droite\n                                    * - round_about_entry : entre rond-point\n                                    * - round_about_exit : sortie rond-point\n                                    */\n\n                                    // on ne souhaite pas de ce type de valeur...\n                                    if (step.name == \"Valeur non renseigne\") {\n                                        step.name = \"\";\n                                    }\n\n                                    switch (step.navInstruction) {\n                                        case \"F\":\n                                            if (step.name) {\n                                                data.routeInstructions[data.routeInstructions.length - 1].instruction = \"Tout droit \" + step.name;\n                                            } else {\n                                                data.routeInstructions[data.routeInstructions.length - 1].instruction = \"Continuer tout droit \";\n                                            }\n                                            break;\n                                        case \"B\":\n                                            data.routeInstructions[data.routeInstructions.length - 1].instruction = \"Demi-tour \" + step.name;\n                                            break;\n                                        case \"L\":\n                                            data.routeInstructions[data.routeInstructions.length - 1].instruction = \"Tourner  gauche \" + step.name;\n                                            break;\n                                        case \"R\":\n                                            data.routeInstructions[data.routeInstructions.length - 1].instruction = \"Tourner  droite \" + step.name;\n                                            break;\n                                        case \"BL\":\n                                            data.routeInstructions[data.routeInstructions.length - 1].instruction = \"Tourner trs  gauche \" + step.name;\n                                            break;\n                                        case \"BR\":\n                                            data.routeInstructions[data.routeInstructions.length - 1].instruction = \"Tourner trs  droite \" + step.name;\n                                            break;\n                                        case \"FL\":\n                                            data.routeInstructions[data.routeInstructions.length - 1].instruction = \"Tourner lgrement  gauche \" + step.name;\n                                            break;\n                                        case \"FR\":\n                                            data.routeInstructions[data.routeInstructions.length - 1].instruction = \"Tourner lgrement  droite \" + step.name;\n                                            break;\n                                        case \"round_about_entry\":\n                                            data.routeInstructions[data.routeInstructions.length - 1].instruction = \"Entre rond-point \" + step.name;\n                                            break;\n                                        case \"round_about_exit\":\n                                            data.routeInstructions[data.routeInstructions.length - 1].instruction = \"Sortie rond-point \" + step.name;\n                                            break;\n                                        case null:\n                                            data.routeInstructions[data.routeInstructions.length - 1].instruction = \"Prendre tout droit \" + step.name;\n                                            break;\n                                        default:\n                                            data.routeInstructions[data.routeInstructions.length - 1].instruction = \"?\" + step.navInstruction + \"? \" + step.name;\n                                            break;\n                                    }\n                                });\n                            }\n                        }\n\n                        if (!data) {\n                            options.onError.call(options.scope, new __WEBPACK_IMPORTED_MODULE_2__Exceptions_ErrorService__[\"a\" /* default */](__WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__[\"a\" /* default */].getMessage(\"SERVICE_RESPONSE_ANALYSE\", \"json\")));\n                            return;\n                        }\n                        break;\n\n                    default:\n                        options.onError.call(options.scope, new __WEBPACK_IMPORTED_MODULE_2__Exceptions_ErrorService__[\"a\" /* default */](__WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__[\"a\" /* default */].getMessage(\"SERVICE_RESPONSE_FORMAT\", \"json\", \"xml\")));\n                        return;\n                }\n\n                // Si la rponse contenait une exception renvoye par le service\n                if (data && data.exceptionReport) {\n                    options.onError.call(options.scope, new __WEBPACK_IMPORTED_MODULE_2__Exceptions_ErrorService__[\"a\" /* default */](__WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__[\"a\" /* default */].getMessage(\"SERVICE_RESPONSE_EXCEPTION_2\")));\n                    return;\n                }\n            }\n        } else {\n            options.onError.call(options.scope, new __WEBPACK_IMPORTED_MODULE_2__Exceptions_ErrorService__[\"a\" /* default */](__WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__[\"a\" /* default */].getMessage(\"SERVICE_RESPONSE_EMPTY\")));\n            return;\n        }\n\n        options.onSuccess.call(options.scope, data);\n        return;\n    }\n};\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (RouteResponseFactory);\n\n\n/***/ }),\n/* 94 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__ = __webpack_require__(1);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__Formats_WKT__ = __webpack_require__(8);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__Exceptions_ErrorService__ = __webpack_require__(2);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__Response_model_RouteResponse__ = __webpack_require__(16);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__Response_model_RouteInstruction__ = __webpack_require__(17);\n/**\n * Analyse de la reponse REST\n *\n * @module RouteResponseRESTReader\n * @alias Gp.Services.Route.Formats.RouteResponseRESTReader\n * @todo not yet implemented !\n * @private\n */\n\n\n\n\n\n\n\n\n/**\n * Objet RouteResponseRestReader\n * @member {Object} RouteResponseRestReader\n *\n * @property {Object} RouteResponseRestReader.READERS - Objet contenant des fonctions de lecture, appeles \"readers\"\n *      dont chaque cl correspond au nom d'un tag du XML que l'on souhaite lire\n *      et la valeur associe est une fonction (node, data)\n *      o node est un noeud du document DOM\n *      et data est un objet o l'on stocke les informations lues dans le XML.\n *\n * @property {Method} RouteResponseRestReader.read - Mthode permettant de lancer la lecture d'une rponse XML du\n *      service de calcul d'itineraire,  l'aide des readers de la classe.\n *\n */\n\nvar RouteResponseRESTReader = {};\n\nRouteResponseRESTReader.READERS = {\n\n    /** TODO : jsdoc block */\n    routeResult : function (node) {\n        var response = new __WEBPACK_IMPORTED_MODULE_4__Response_model_RouteResponse__[\"a\" /* default */]();\n\n        // on boucle sur les balises \"enfant\" de la rponse :\n        // status, distance, duration, distanceMeters, durationSeconds, bounds, geometryWkt, simplifiedWkt, leg\n        __getChildNodes(node, response);\n\n        if (response.status === \"error\") {\n            var message = __WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__[\"a\" /* default */].getMessage(\"SERVICE_RESPONSE_EXCEPTION\",\n                response.message);\n            throw new __WEBPACK_IMPORTED_MODULE_3__Exceptions_ErrorService__[\"a\" /* default */]({\n                message : message,\n                type : __WEBPACK_IMPORTED_MODULE_3__Exceptions_ErrorService__[\"a\" /* default */].TYPE_SRVERR\n            });\n        }\n\n        return response;\n    },\n\n    /** TODO : jsdoc block */\n    status : function (node, response) {\n        var status = __getChildValue(node);\n        if (status === \"ERROR\" || status === \"error\") {\n            if (response) {\n                response.status = \"error\";\n            }\n        }\n    },\n\n    /** TODO : jsdoc block */\n    message : function (node, response) {\n        if (response) {\n            response.message = __getChildValue(node);\n        }\n    },\n\n    /** TODO : jsdoc block */\n    distance : function (node, response) {\n        if (response) {\n            response.totalDistance = __getChildValue(node);\n        }\n    },\n\n    /** TODO : jsdoc block */\n    durationSeconds : function (node, response) {\n        if (response) {\n            response.totalTime = parseFloat(__getChildValue(node));\n        }\n    },\n\n    /** TODO : jsdoc block */\n    bounds : function (node, response) {\n        // get value et split et parseFloat\n        if (response && response.bbox) {\n            var coords = __getChildValue(node).split(/[,;]/);\n            response.bbox.left = parseFloat(coords[0]);\n            response.bbox.bottom = parseFloat(coords[1]);\n            response.bbox.right = parseFloat(coords[2]);\n            response.bbox.top = parseFloat(coords[3]);\n        }\n    },\n\n    /** TODO : jsdoc block */\n    geometryWkt : function (node, response) {\n        if (response) {\n            var geomWkt = node.innerHTML;\n\n            /** TODO : jsdoc block */\n            var onWKTSuccess = function (json) {\n                response.routeGeometry = json;\n            };\n\n            /** TODO : jsdoc block */\n            var onWKTError = function () {\n                var msg = __WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__[\"a\" /* default */].getMessage(\"PARAM_FORMAT\", [\"geometryWkt\"]);\n                throw new Error(msg);\n            };\n            // get WKT Geometry from string\n            __WEBPACK_IMPORTED_MODULE_2__Formats_WKT__[\"a\" /* default */].toJson(geomWkt, onWKTSuccess, onWKTError);\n        }\n    },\n\n    /** TODO : jsdoc block */\n    step : function (node, response) {\n        // cration d'une nouvelle instruction\n        var routeInstruction = new __WEBPACK_IMPORTED_MODULE_5__Response_model_RouteInstruction__[\"a\" /* default */]();\n        var name;\n\n        // lecture des informations de l'instruction (balises enfants)\n        if (node.hasChildNodes) {\n            var children = node.childNodes;\n            var child;\n            var childName;\n\n            for (var i = 0; i < children.length; i++) {\n                child = children[i];\n\n                if (child.nodeType === 1) { // 1 == node.ELEMENT_NODE\n                    childName = child.localName || child.baseName || child.nodeName;\n\n                    if (childName === \"durationSeconds\") {\n                        routeInstruction.duration = __getChildValue(child);\n                    } else if (childName === \"distance\") {\n                        routeInstruction.distance = __getChildValue(child);\n                    } else if (childName === \"navInstruction\") {\n                        routeInstruction.code = __getChildValue(child);\n                    } else if (childName === \"name\") {\n                        name = __getChildValue(child);\n                    }\n                }\n            }\n        }\n\n        // on teste le code de l'instruction pour y ajouter la bonne description\n        if (routeInstruction.code) {\n            switch (routeInstruction.code) {\n                case \"F\":\n                    if (name != \"Valeur non renseigne\") {\n                        routeInstruction.instruction = \"Tout droit \" + name;\n                    } else {\n                        routeInstruction.instruction = \"Continuer tout droit \";\n                    }\n                    break;\n                case \"B\":\n                    routeInstruction.instruction = \"Demi-tour \" + name;\n                    break;\n                case \"L\":\n                    routeInstruction.instruction = \"Tourner  gauche \" + name;\n                    break;\n                case \"R\":\n                    routeInstruction.instruction = \"Tourner  droite \" + name;\n                    break;\n                case \"BL\":\n                    routeInstruction.instruction = \"Tourner trs  gauche \" + name;\n                    break;\n                case \"BR\":\n                    routeInstruction.instruction = \"Tourner trs  droite \" + name;\n                    break;\n                case \"FL\":\n                    routeInstruction.instruction = \"Tourner lgrement  gauche \" + name;\n                    break;\n                case \"FR\":\n                    routeInstruction.instruction = \"Tourner lgrement  droite \" + name;\n                    break;\n                case \"round_about_entry\":\n                    routeInstruction.instruction = \"Entre rond-point \" + name;\n                    break;\n                case \"round_about_exit\":\n                    routeInstruction.instruction = \"Sortie rond-point \" + name;\n                    break;\n                case null:\n                    routeInstruction.instruction = \"Prendre \" + name;\n                    break;\n                default:\n                    routeInstruction.instruction = \"?\" + routeInstruction.code + \"? \" + name;\n                    break;\n            }\n        }\n\n        if (Array.isArray(response.routeInstructions)) {\n            response.routeInstructions.push(routeInstruction);\n        }\n    }\n\n};\n\n/** TODO : jsdoc block */\nRouteResponseRESTReader.read = function (root) {\n\n    var response;\n\n    if (root.nodeName === \"routeResult\") {\n        response = RouteResponseRESTReader.READERS[\"routeResult\"](root);\n        return response;\n    } else {\n        throw new Error(\"Erreur lors de la lecture de la rponse : elle n'est pas au format attendu.\");\n    }\n\n};\n\n/**\n * Lecture de la valeur du premier child d'un noeud, si elle existe.\n *\n * @private\n * @memberof RouteResponseRESTReader\n * @method __getChildValue\n * @param {DOMElement} node - a DOM node\n * @return {String} value - valeur du firstChild du noeud en entre, ou chane vide.\n */\nfunction __getChildValue(node) {\n\n    var textNode;\n    var value = \"\";\n\n    if (node.hasChildNodes()) {\n        textNode = node.firstChild;\n        if (textNode && textNode.nodeType === 3) { // 3 == node.TEXT_NODE\n            value = textNode.nodeValue;\n        }\n    }\n    return value;\n}\n\n/**\n * Rcupration des noeuds enfants  partir d'un noeud donn, pour lecture (readNode).\n *\n * @private\n * @memberof RouteResponseRESTReader\n * @method __getChildNodes\n * @param {DOMElement} node - a DOM node\n * @param {Array|Object} [data] - an object to be filled with node data\n */\nfunction __getChildNodes (node, data) {\n\n    if (node.hasChildNodes()) {\n\n        var children = node.childNodes;\n        var child;\n        var childName;\n\n        for (var i = 0; i < children.length; i++) {\n            child = children[i];\n\n            if (child.nodeType === 1) { // 1 == node.ELEMENT_NODE\n                childName = child.localName || child.baseName || child.nodeName;\n\n                if (RouteResponseRESTReader.READERS[childName]) {\n                    var reader = RouteResponseRESTReader.READERS[childName];\n                    reader(child, data);\n                } else {\n                    __getChildNodes(child, data);\n                }\n            }\n        }\n    }\n}\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (RouteResponseRESTReader);\n\n\n/***/ }),\n/* 95 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__ = __webpack_require__(0);\n/**\n * Analyse de la reponse OLS\n *\n * @module RouteResponseOLSReader\n * @alias Gp.Services.Route.Formats.RouteResponseOLSReader\n * @todo not yet implemented !\n * @private\n */\n\n\n\n/**\n * Objet RouteResponseOLSReader\n * @member {Object} RouteResponseOLSReader\n *\n * @property {Object} RouteResponseOLSReader.READERS - Objet contenant des fonctions de lecture, appeles \"readers\"\n *      dont chaque cl correspond au nom d'un tag du XML que l'on souhaite lire\n *      et la valeur associe est une fonction (node, data)\n *      o node est un noeud du document DOM\n *      et data est un objet o l'on stocke les informations lues dans le XML.\n *\n * @property {Method} RouteResponseOLSReader.read -  Mthode permettant de lancer la lecture d'une rponse\n *      XML du service de calcul d'itineraire,  l'aide des readers de la classe.\n */\nvar RouteResponseOLSReader = {};\n\n/**\n * Objet contenant des fonctions de lecture, appeles \"readers\"\n *      dont chaque cl correspond au nom d'un tag du XML que l'on souhaite lire\n *      et la valeur associe est une fonction (node, data)\n *      o node est un noeud du document DOM\n *      et data est un objet o l'on stocke les informations lues dans le XML.\n * @static\n * @memberof RouteResponseOLSReader\n */\nRouteResponseOLSReader.READERS = {\n    /*\n        // INFO\n        // pas de reponse en JSON pour l'API OLS, uniquement du XML !\n\n        // INFO\n        // Exemple d'erreur du service\n        // <?xml version= \"1.0\" encoding= \"UTF-8\" standalone= \"yes\" ?>\n        // <XLS version=\"1.2\" xsi : schemaLocation = \"http://www.opengis.net/xls http://schemas.opengis.net/ols/1.2/olsAll.xsd\" xmlns : xls = \"http://www.opengis.net/xls\" xmlns= \"http://www.opengis.net/xls\" xmlns : xlsext = \"http://www.opengis.net/xlsext\" xmlns : gml = \"http://www.opengis.net/gml\" // xmlns : xsi = \"http://www.w3.org/2001/XMLSchema-instance\" >\n        // <ResponseHeader>\n        //     <ErrorList>\n        //         <Error message=\"Routing error : Error in smartrouting com.geoconcept.smartrouting.SmartRoutingNativeException : failed to connect waypoint { 48.846577, 2.416907, 0.000000 } failed to connect waypoint { 48.846577, 2.416907, 0.000000 } \" errorCode=\"InternalServerError\"/>\n        //     </ErrorList>\n        // </ResponseHeader>\n        // <Response version= \"1.2\" requestID= \"f8358c74-8aee-4203-90b9-2c70db5996a1\" />\n        // </XLS>\n\n        // INFO\n        // Exemple d'erreur NGinx\n        // <ExceptionReport><Exception exceptionCode=\"MissingParameter\">Resource parameter not found</Exception></ExceptionReport>\n    */\n};\n\n/**\n * Mthode permettant de lancer la lecture d'une rponse XML du service de calcul d'itineraire,\n *  l'aide des readers de la classe.\n *\n * @method RouteResponseOLSReader.read\n * @param {DOMElement} root - racine de la rponse XML  lire\n * @static\n * @memberof RouteResponseOLSReader\n */\nRouteResponseOLSReader.read = function (root) {\n    // logger\n    var logger = __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__[\"a\" /* default */].getLogger(\"RouteResponseOLSReader\");\n    logger.error(\"not yet implemented !\");\n};\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (RouteResponseOLSReader);\n\n\n/***/ }),\n/* 96 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__ = __webpack_require__(1);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__Exceptions_ErrorService__ = __webpack_require__(2);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__CommonService__ = __webpack_require__(3);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__DefaultUrlService__ = __webpack_require__(6);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__Request_ProcessIsoCurveRequest__ = __webpack_require__(97);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__Response_ProcessIsoCurveResponseFactory__ = __webpack_require__(99);\n\n\n\n\n\n\n\n\n\n/**\n * @classdesc\n * Appel du service d'isochrone/distance du Goportail :\n *     envoi de la requte construite selon les paramtres en options,\n *     ventuellement parsing et analyse  de la rponse,\n *     retour d'une rponse en paramtre de la fonction onSuccess.\n * @constructor\n * @extends {Gp.Services.CommonService}\n * @alias Gp.Services.ProcessIsoCurve\n * @param {Object} options - options spcifiques au service (+ les options herites)\n *\n * @param {String} options.outputFormat - Le format de la rponse du service iso : 'xml' ou 'json'.\n *      Ce paramtre dterminera l'extension '.xml' ou '.json' du service.\n *      Ncessaire si serverUrl est renseign pour connatre le format dans lequel sera fournie la rponse (pour son traitement).\n *      Par dfaut, ce paramtre vaut 'json'.\n *\n * @param {Object} options.position - Point de dpart du calcul.\n *      Coordonnes exprimes en longitudes, latitudes (EPSG:4326)\n *      @param {Float} options.position.x - Abcisse du point de dpart du calcul d'isochrone/distance.\n *      @param {Float} options.position.y - Ordonne du point de dpart du calcul d'isochrone/distance.\n *\n * @param {String} options.srs - Projection.\n *      Systme de coordonnes dans lequel les coordonnes du point  location  sont exprimes et\n *      dans lequel la gomtrie de la courbe rsultante sera exprime.\n *      Par dfaut, le systme de coordonnes utilis sera  EPSG:4326 .\n *\n * @param {String} [options.graph = \"voiture\"] - Nom du graphe  utiliser pour le calcul ( Pieton  ou  Voiture ).\n *      La valeur par dfaut est : voiture\n *\n * @param {Array.<String>} [options.exclusions] - Critres d'exclusions  appliquer pour le calcul.\n *      On prcise ici le type de tronons que l'on ne veut pas que l'isochrone/distance emprunte\n *      (valeurs possibles :  toll  (viter les pages),  bridge ,  tunnel ).\n *\n * @param {String} [options.method = \"time\"] - Mthode utilise pour le calcul de la courbe iso.\n *      Les valeurs possible sont \"time\" pour un calcul d'isochrone, \"distance\" pour un calcul d'isodistance.\n *      Pas de valeur spcifi quivaut  un calcul d'isochrone.\n *\n * @param {Float} options.time - Dure maximum (exprime en secondes)  utiliser pour le calcul de la courbe  partir du ou jusqu'au point  location .\n *      Ce paramtre doit tre renseign si l'option \"mthod\" a la valeur \"time\".\n *      Si l'option method n'est pas renseigne, ce paramtre doit tre renseign.\n *\n * @param {Float} options.distance - Distance maximum (exprime en metres)  utiliser pour le calcul de la courbe  partir du ou j'usqu'au point  location .\n *      Ce paramtre doit tre renseign si l'option \"mthod\" a la valeur \"DISTANCE\".\n *      Si l'option \"method\" n'est pas renseigne, ce paramtre sera ignor.\n *\n * @param {Boolean} [options.reverse = false] - Indique si la gomtrie rsultante doit tre lisse ( true ) pour ne pas avoir d'effet d'escalier.\n *      Par dfaut, la valeur  false  est applique.\n *\n * @param {Boolean} [options.smoothing = false] - Indique si la gomtrie rsultante doit tre lisse ( true ) pour ne pas avoir d'effet d'escalier.\n *      Par dfaut, la valeur  false  est applique.\n *\n * @param {Boolean} [options.holes = false] - Indique si la gomtrie rsultante (surface) doit tre retourne avec des trous ( true ).\n *      Par dfaut, la valeur  false  est applique.\n *\n * @example\n *   var options = {\n *      // options communes aux services\n *      apiKey : null,\n *      serverUrl : 'http://localhost/service/',\n *      protocol : 'JSONP', // JSONP|XHR\n *      proxyURL : null,\n *      httpMethod : 'GET', // GET|POST\n *      timeOut : 10000, // ms\n *      rawResponse : false, // true|false\n *      scope : null, // this\n *      onSuccess : function (response) {},\n *      onFailure : function (error) {},\n *      // spcifique au service\n *      position : {\n *           x : 2.3242664298058053,\n *           y : 48.86118017324745\n *      },\n *      distance : 200,\n *      [time : ]\n *      method : \"distance\",\n *      exclusions : [\"Bridge\", \"Tunnel\", \"Toll\"],\n *      graph : \"voiture\",\n *      reverse : false,\n *      smoothing : false,\n *      holes : false\n *  };\n * @private\n */\n\nfunction ProcessIsoCurve (options) {\n\n    if (!(this instanceof ProcessIsoCurve)) {\n        throw new TypeError(__WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__[\"a\" /* default */].getMessage(\"CLASS_CONSTRUCTOR\", \"ProcessIsoCurve\"));\n    }\n\n    /**\n     * Nom de la classe (heritage)\n     * FIXME instance ou classe ?\n     */\n    this.CLASSNAME = \"ProcessIsoCurve\";\n\n    // appel du constructeur par heritage\n    __WEBPACK_IMPORTED_MODULE_3__CommonService__[\"a\" /* default */].apply(this, arguments);\n\n    this.logger = __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__[\"a\" /* default */].getLogger(\"Gp.Services.ProcessIsoCurve\");\n    this.logger.trace(\"[Constructeur ProcessIsoCurve (options)]\");\n\n    if (!options.position) {\n        throw new Error(__WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__[\"a\" /* default */].getMessage(\"PARAM_MISSING\", \"position\"));\n    }\n\n    // on lance une exception afin d'eviter au service de le faire...\n    if (options.position.x == null) {\n        throw new Error(__WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__[\"a\" /* default */].getMessage(\"PARAM_MISSING\", \"position.x\"));\n    }\n\n    if (options.position.y == null) {\n        throw new Error(__WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__[\"a\" /* default */].getMessage(\"PARAM_MISSING\", \"position.y\"));\n    }\n\n    if (!options.time && !options.distance) {\n        throw new Error(\"Parameter (s) 'distance' missing. Parameter time to calculate an isochrone, parameter distance for an isodistance\");\n    }\n\n    // si on a que le paramtre \"distance\" en entre, on calcule une isodistance.\n    // Le paramtre \"mthode\" doit pour avoir une rponse du service, tre pass  \"distance\"\n    if (!options.time && options.distance) {\n        this.options.method = \"distance\";\n        // on supprime l'ventuel attribut time, rsidu d'un appel antrieur\n        if (this.options.time) {\n            delete this.options.time;\n        }\n    }\n\n    // si on a que le paramtre \"time\" en entre, on calcule une isochrone.\n    // Le paramtre \"mthode\" doit pour avoir une rponse du service, tre pass  \"time\"\n    if (options.time && !options.distance) {\n        this.options.method = \"time\";\n        // on supprime l'ventuel attribut time, rsidu d'un appel antrieur\n        if (this.options.distance) {\n            delete this.options.distance;\n        }\n    }\n\n    // au cas o on a ni l'un, ni l'autre...\n    this.options.method = this.options.method || \"time\";\n\n    // options par defaut du service\n    this.options.exclusions = options.exclusions || null;\n    this.options.graph = options.graph || \"Voiture\"; // TODO test de la valeur  faire !\n    this.options.reverse = options.reverse || false;\n    this.options.smoothing = options.smoothing || false;\n    this.options.holes = options.holes || false;\n    this.options.srs = options.srs || \"EPSG:4326\";\n\n    // on passe l'option outputFormat en minuscules afin d'viter des exceptions.\n    this.options.outputFormat = ( typeof options.outputFormat == \"string\") ? options.outputFormat.toLowerCase() : \"json\";\n\n    // gestion de l'url du service par defaut\n    // si l'url n'est pas renseigne, il faut utiliser les urls par defaut\n    if (!this.options.serverUrl) {\n\n        var lstUrlByDefault = __WEBPACK_IMPORTED_MODULE_4__DefaultUrlService__[\"a\" /* default */].ProcessIsoCurve.url(this.options.apiKey);\n\n        var urlFound = lstUrlByDefault[\"iso\" + \"-\" + this.options.outputFormat];\n        if (!urlFound) {\n            throw new Error(\"Url by default not found !\");\n        }\n        this.options.serverUrl = urlFound;\n        this.logger.trace(\"Serveur URL par defaut : \" + this.options.serverUrl);\n    }\n\n    // gestion du type de service\n    // si l'extension de l'url est .json ou .xml, on surcharge le format de sortie (outputFormat)\n    var idx = this.options.serverUrl.lastIndexOf(\".\");\n    if (idx !== -1) {\n        var extension = this.options.serverUrl.substring(idx + 1);\n        if (extension && extension.length < 5) { // FIXME extension de moins de 4 car. ...\n            this.logger.trace(\"Serveur Extension URL : \" + extension);\n            switch (extension.toLowerCase()) {\n                case \"json\":\n                case \"xml\":\n                    this.options.outputFormat = extension.toLowerCase();\n                    break;\n                default:\n                    throw new Error(\"type of service : unknown or unsupported (json or xml) !\");\n            }\n        }\n    }\n}\n\n/**\n * @lends module:ProcessIsoCurve#\n */\nProcessIsoCurve.prototype = Object.create(__WEBPACK_IMPORTED_MODULE_3__CommonService__[\"a\" /* default */].prototype, {\n    // todo\n    // getter/setter\n});\n\n/*\n * Constructeur (alias)\n */\nProcessIsoCurve.prototype.constructor = ProcessIsoCurve;\n\n/**\n * Cration de la requte (overwrite)\n *\n * @param {Function} error   - callback des erreurs\n * @param {Function} success - callback\n */\nProcessIsoCurve.prototype.buildRequest = function (error, success) {\n\n    try {\n\n        var oIsoCurve = new __WEBPACK_IMPORTED_MODULE_5__Request_ProcessIsoCurveRequest__[\"a\" /* default */](this.options);\n        if (!oIsoCurve.processRequestString()) {\n            throw new Error(__WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__[\"a\" /* default */].getMessage(\"SERVICE_REQUEST_BUILD\"));\n        }\n\n        this.request = oIsoCurve.requestString;\n\n    } catch (e) {\n        error.call(this, new __WEBPACK_IMPORTED_MODULE_2__Exceptions_ErrorService__[\"a\" /* default */](e.message));\n        return;\n    }\n\n    success.call(this, this.request);\n};\n\n/**\n * (overwrite)\n * Analyse de la reponse\n *\n * @param {Function} onError   - callback des erreurs\n * @param {Function} onSuccess - callback de succs de l'analyse de la rponse\n */\nProcessIsoCurve.prototype.analyzeResponse = function (onError, onSuccess) {\n\n    if (this.response) {\n\n        var options = {\n            response : this.response,\n            outputFormat : this.options.outputFormat,\n            rawResponse : this.options.rawResponse,\n            onSuccess : onSuccess,\n            onError : onError,\n            scope : this\n        };\n\n        __WEBPACK_IMPORTED_MODULE_6__Response_ProcessIsoCurveResponseFactory__[\"a\" /* default */].build(options);\n\n    } else {\n\n        onError.call(this, new __WEBPACK_IMPORTED_MODULE_2__Exceptions_ErrorService__[\"a\" /* default */](__WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__[\"a\" /* default */].getMessage(\"SERVICE_RESPONSE_EMPTY\")));\n    }\n};\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (ProcessIsoCurve);\n\n\n/***/ }),\n/* 97 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__ = __webpack_require__(1);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__model_ProcessIsoCurveParam__ = __webpack_require__(98);\n\n\n\n\n\n/**\n * @classdesc\n * Classe de gestion des requtes sur le service de calcul d'isoschrone/isodistance.\n *  Les requtes peuvent tre en mode GET ou POST,\n *  et le format de sorti est en JSON ou en XML.\n *\n * @constructor\n * @alias Gp.Services.ProcessIsoCurve.Request.ProcessIsoCurveRequest\n * @param {Object} options - options\n *\n * @example\n * var options = {\n *      httpMethod : 'GET', // GET|POST\n *      // spcifique au service\n *      exclusions : ['Bridge', 'Tunnel'],\n *      position : {\n *          x : 2.3242664298058053,\n *          y : 48.86118017324745\n *      },\n *      graph : \"Voiture\",\n *      method : 'time',\n *      time : 1000, //distance : 200\n *      reverse : false,\n *      smoothing : false,\n *      holes : false,\n *      srs : 'EPSG:4326'\n *  };\n *\n * try {\n *\n *      var oIsoCurve = new ProcessIsoCurveRequest (options);\n *      if (!oIsoCurve.processRequestString ()) {\n *          // error\n *      }\n *\n *      var request = oIsoCurve.requestString;\n *\n * } catch (e) {\n *      // error\n * }\n * @private\n */\nfunction ProcessIsoCurveRequest (options) {\n\n    this.logger = __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__[\"a\" /* default */].getLogger(\"ProcessIsoCurveRequest\");\n    this.logger.trace(\"[Constructeur ProcessIsoCurveRequest ()]\");\n\n    if (!(this instanceof ProcessIsoCurveRequest)) {\n        throw new TypeError(\"ProcessIsoCurveRequest constructor cannot be called as a function.\");\n    }\n\n    // existance des options\n    if (!options) {\n        throw new Error(__WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__[\"a\" /* default */].getMessage(\"PARAM_EMPTY\", \"options\"));\n    }\n\n    /**\n     * Liste des options\n     */\n    this.settings = options;\n\n    /**\n     * Mode HTPP.\n     * Par defaut, \"GET\".\n     * @type {String}\n     */\n    this.mode = this.settings.httpMethod || \"GET\";\n}\n\nProcessIsoCurveRequest.prototype = {\n\n    /**\n     * @lends module:ProcessIsoCurveRequest#\n     */\n\n    /**\n     * Requte\n     * @type {String}\n     */\n    requestString : null,\n\n    /**\n     * Constructeur (alias)\n     */\n    constructor : ProcessIsoCurveRequest,\n\n    /**\n     * Template de la requte (POST)\n     * * __X__ __Y__ __SRS__ __GRAPHNAME__ __METHOD__  (obligatoire)\n     * * __REVERSE__ __SMOOTHING__ __HOLES__           (par defaut)\n     * * __TIME__ __TIMEVALUE__                        (choix)\n     * * __DISTANCE__ __DISTANCEVALUE__                (choix)\n     * * __EXCLUSIONS__ __EXCLUSIONFEATURE__ __EXCLUSIONVALUE__ (optionnel)\n     * * __PROFIL__ __PROFILID__ __PROFILNAME__                 (trs optionnel)\n     * * __ID__ __IDVALUE__                                     (trs optionnel)\n     */\n    template : {\n        container : \"<?xml version=\\\"1.0\\\" encoding=\\\"UTF-8\\\"?>\\n\" +\n            \"<isochroneRequest>\\n\" +\n            \"__ID__\" +\n            \"\\t<location>\\n\" +\n            \"\\t\\t<x>__X__</x>\\n\" +\n            \"\\t\\t<y>__Y__</y>\\n\" +\n            \"\\t</location>\\n\" +\n            \"\\t<srs>__SRS__</srs>\\n\" +\n            \"\\t<graphName>__GRAPHNAME__</graphName>\\n\" +\n            \"__PROFIL__\" +\n            \"__EXCLUSIONS__\" +\n            \"\\t<method>__METHOD__</method>\\n\" +\n            \"__TIME__\" +\n            \"__DISTANCE__\" +\n            \"\\t<reverse>__REVERSE__</reverse>\\n\" +\n            \"\\t<smoothing>__SMOOTHING__</smoothing>\\n\" +\n            \"\\t<holes>__HOLES__</holes>\\n\" +\n            \"</isochroneRequest>\",\n        id : \"\\t<id>__IDVALUE__</id>\\n\",\n        profil : \"\\t<profileId>__PROFILID__</profileId>\\n\" + \"\\t<profileName>__PROFILNAME__</profileName>\\n\",\n        exclusions : {\n            container : \"\\t<exclusions>\\n\" +\n                \"__EXCLUSIONFEATURE__\\n\" +\n                \"\\t</exclusions>\\n\",\n            feature : \"\\t\\t<exclusion>__EXCLUSIONVALUE__</exclusion>\"\n        },\n        time : \"\\t<time>__TIMEVALUE__</time>\\n\",\n        distance : \"\\t<distance>__DISTANCEVALUE__</distance>\\n\"\n    },\n\n    /**\n     * Construction de la requte.\n     *\n     * @example\n     * // GET  out :\n     *   //  (http://wxs.ign.fr/KEY/isochrone/isochrone.json?)\n     *   //  location=&\n     *   //  time=& ou distance=&\n     *   //  method=\"DISTANCE|TIME\"&\n     *   //  graph=Pieton&\n     *   //  graphName=Pieton&\n     *   //  exclusions=&\n     *   //  reverse=10&\n     *   //  smoothing=&\n     *   //  holes=&\n     *   //  srs=\n     *\n     * // POST out :\n     *   // <?xml version=\"1.0\" encoding=\"UTF-8\"?>\n     *   // <isochroneRequest>\n     *   //   <id>1</id>\n     *   //   <location>\n     *   //     <x>-1.557189</x>\n     *   //     <y>47.217122</y>\n     *   //   </location>\n     *   //   <srs></srs>\n     *   //   <graphName></graphName>\n     *   //   <profileId></profileId>\n     *   //   <profileName></profileName>\n     *   //   <exclusions>\n     *   //     <exclusion></exclusion>\n     *   //     <exclusion></exclusion>\n     *   //   </exclusions>\n     *   //   <method></method>\n     *   //   <time>50</time>\n     *   //   <distance></distance>\n     *   //   <reverse></reverse>\n     *   //   <smoothing></smoothing>\n     *   //   <holes></holes>\n     *   // </isochroneRequest>\n     *\n     * @returns {String}\n     */\n    processRequestString : function () {\n\n        var request = \"\";\n        var i = 0;\n\n        switch (this.mode) {\n\n            case \"GET\":\n                this.logger.trace(\"Process GET Request\");\n\n                // Mapping des options avec le service de l'API REST\n                var oParams = new __WEBPACK_IMPORTED_MODULE_2__model_ProcessIsoCurveParam__[\"a\" /* default */](this.settings);\n                var params = oParams.getParams();\n\n                for (i = 0; i < params.length; i++) {\n                    var o = params[i];\n                    if (request) {\n                        request += \"&\";\n                    }\n                    request += o.k + \"=\" + o.v;\n                }\n\n                break;\n\n            case \"POST\":\n                this.logger.trace(\"Process POST Request\");\n\n                request = this.template.container;\n\n                // options non prises en compte car non implmentes !\n                // clean : id\n                request = request.replace(/__ID__/g, \"\");\n                // clean : profil\n                request = request.replace(/__PROFIL__/g, \"\");\n\n                // options obligatoires\n                request = request.replace(/__X__/g, this.settings.position.x);\n                request = request.replace(/__Y__/g, this.settings.position.y);\n                request = request.replace(/__GRAPHNAME__/g, this.settings.graph);\n\n                // options par defaut\n                request = request.replace(/__SRS__/g, this.settings.srs);\n                request = request.replace(/__SMOOTHING__/g, this.settings.smoothing);\n                request = request.replace(/__HOLES__/g, this.settings.holes);\n                request = request.replace(/__REVERSE__/g, this.settings.reverse);\n\n                // options conditionnelles\n\n                // exclusions\n                if (this.settings.exclusions) {\n                    var tmplExclusions = this.template.exclusions.container;\n                    var exclusions = [];\n                    for (i = 0; i < this.settings.exclusions.length; i++) {\n                        var tmplFeature = this.template.exclusions.feature;\n                        tmplFeature = tmplFeature.replace(/__EXCLUSIONVALUE__/, this.settings.exclusions[i]);\n                        exclusions.push(tmplFeature);\n                    }\n                    tmplExclusions = tmplExclusions.replace(/__EXCLUSIONFEATURE__/, exclusions.join(\"\\n\"));\n                    request = request.replace(/__EXCLUSIONS__/g, tmplExclusions);\n                }\n                // clean exclusions\n                request = request.replace(/__EXCLUSIONS__/g, \"\");\n\n                // distance\n                if (this.settings.distance) {\n                    var tmplDistance = this.template.distance;\n                    tmplDistance = tmplDistance.replace(/__DISTANCEVALUE__/g, this.settings.distance);\n                    request = request.replace(/__DISTANCE__/g, tmplDistance);\n                    // method\n                    request = request.replace(/__METHOD__/g, \"distance\");\n                }\n                // clean\n                request = request.replace(/__DISTANCE__/g, \"\");\n\n                // time\n                if (this.settings.time) {\n                    var tmplTime = this.template.time;\n                    tmplTime = tmplTime.replace(/__TIMEVALUE__/g, this.settings.time);\n                    request = request.replace(/__TIME__/g, tmplTime);\n                    // method\n                    request = request.replace(/__METHOD__/g, \"time\");\n                }\n                // clean\n                request = request.replace(/__TIME__/g, \"\");\n                break;\n\n            default:\n                this.logger.error(\"No other HTTP method supported by the service !\");\n        }\n\n        this.logger.trace(request);\n        this.requestString = request;\n\n        return this.requestString;\n    }\n};\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (ProcessIsoCurveRequest);\n\n\n/***/ }),\n/* 98 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__ = __webpack_require__(0);\n\n\n\n/**\n * @classdesc\n *\n * Classe de gestion des param. des requtes du service de calcul des iso.\n * Permet le mapping avec les options du service.\n *\n * @constructor\n * @alias Gp.Services.ProcessIsoCurve.Request.ProcessIsoCurveParam\n * @param {Object} options - options\n * @private\n *\n */\nfunction ProcessIsoCurveParam (options) {\n\n    if (!(this instanceof ProcessIsoCurveParam)) {\n        throw new TypeError(\"ProcessIsoCurveParam constructor cannot be called as a function.\");\n    }\n\n    this.logger = __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__[\"a\" /* default */].getLogger();\n    this.logger.trace(\"[Constructeur ProcessIsoCurveParam ()]\");\n\n    /**\n     * Options en paramtres du constructeur.\n     */\n    this.options = options || {};\n\n    // mapping des options avec l'API REST\n\n    /** Identifiant de lisochrone */\n    this.id = this.options.id;\n\n    /** Coordonnes de dpart (ou arrive si le reverse est  true). */\n    this.location = this.options.position;\n\n    /** projection (code EPSG comme epsg:4326 ou wgs84) */\n    this.srs = this.options.srs;\n\n    /**\n     * Profil de vhicule  utiliser pour le calcul.\n     * Voiture ou Pieton\n     */\n    this.graphName = this.options.graph;\n\n    /**\n     * Identifiant et nom du vhicule\n     * FIXME non utilis\n     */\n    this.profileId = this.options.profileId || null; // TODO !\n    this.profileName = this.options.profileName || null; // TODO !\n\n    /** Liste des rgles de restrictions  utiliser */\n    this.exclusions = this.options.exclusions;\n\n    this.reverse = this.options.reverse;\n    this.smoothing = this.options.smoothing;\n    this.holes = this.options.holes;\n\n    /**\n     * \"time\" pour isochrone ou \"distance\" for isodistance.\n     * Par defaut, time...\n     */\n    var value = this.options.method;\n    switch (value) {\n        case \"time\":\n            this.method = \"time\";\n            this.time = this.options.time;\n            break;\n        case \"distance\":\n            this.method = \"distance\";\n            this.distance = this.options.distance;\n            break;\n        default:\n            this.logger.warn(\"Par defaut, on calcule un isochrone !\");\n            this.method = \"time\";\n    }\n}\n\n/**\n * CLASSNAME\n */\nProcessIsoCurveParam.CLASSNAME = \"ProcessIsoCurveParam\";\n\nProcessIsoCurveParam.prototype = {\n\n    /**\n     * @lends module:ProcessIsoCurveParam#\n     */\n\n    /**\n     * Constructeur (alias)\n     */\n    constructor : ProcessIsoCurveParam,\n\n    /**\n     * Retourne la liste des exclusions\n     */\n    getLocation : function () {\n        return this.location.x + \",\" + this.location.y;\n    },\n\n    /**\n     * Retourne la liste des exclusions\n     */\n    getExclusions : function () {\n        return this.exclusions.join(\";\");\n    }\n};\n\n/**\n * Tableau de clefs/valeurs pour param.\n *\n * @returns {Object[]}\n */\nProcessIsoCurveParam.prototype.getParams = function () {\n\n    var map = [];\n\n    map.push({\n        k : \"location\",\n        v : this.getLocation()\n    });\n\n    map.push({\n        k : \"smoothing\",\n        v : this.smoothing\n    });\n\n    map.push({\n        k : \"holes\",\n        v : this.holes\n    });\n\n    map.push({\n        k : \"reverse\",\n        v : this.reverse\n    });\n\n    map.push({\n        k : \"method\",\n        v : this.method\n    });\n\n    if (this.time) {\n        map.push({\n            k : \"time\",\n            v : this.time\n        });\n    }\n\n    if (this.distance) {\n        map.push({\n            k : \"distance\",\n            v : this.distance\n        });\n    }\n\n    map.push({\n        k : \"graphName\",\n        v : this.graphName\n    });\n\n    if (this.exclusions) {\n        map.push({\n            k : \"exclusions\",\n            v : this.getExclusions()\n        });\n    }\n\n    if (this.srs) {\n        map.push({\n            k : \"srs\",\n            v : this.srs\n        });\n    }\n\n    return map;\n};\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (ProcessIsoCurveParam);\n\n\n/***/ }),\n/* 99 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__ = __webpack_require__(1);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__Exceptions_ErrorService__ = __webpack_require__(2);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__Formats_XML__ = __webpack_require__(4);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__Formats_WKT__ = __webpack_require__(8);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__Formats_ProcessIsoCurveResponseReader__ = __webpack_require__(100);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__model_ProcessIsoCurveResponse__ = __webpack_require__(18);\n/**\n * Factory pour gnrer une reponse JSON  partir d'un XML ou d'un JSON\n * (Factory)\n *\n * @module ProcessIsoCurveResponseFactory\n * @alias Gp.Services.ProcessIsoCurve.Response.ProcessIsoCurveResponseFactory\n * @private\n */\n\n\n\n\n\n\n\n\nvar ProcessIsoCurveResponseFactory = {\n\n    /**\n     * interface unique\n     *\n     * @method build\n     * @static\n     * @param {Object} options - options definies dans le composant ProcessIsoCurve\n     *\n     * @example\n     *   var options = {\n     *      response :\n     *      outputFormat :\n     *      rawResponse :\n     *      scope :\n     *      onSuccess :\n     *      onError :\n     *   };\n     *\n     */\n    build : function (options) {\n\n        // logger\n        var logger = __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__[\"a\" /* default */].getLogger(\"ProcessIsoCurveResponseFactory\");\n        logger.trace([\"ProcessIsoCurveResponseFactory::build()\"]);\n\n        var data = null;\n\n        if (options.response) {\n\n            if (options.rawResponse) {\n                logger.trace(\"analyze response : raw\");\n                data = options.response;\n\n            } else {\n                switch (options.outputFormat) {\n\n                    case \"xml\":\n                        logger.trace(\"analyze response : xml\");\n\n                        try {\n\n                            var p = new __WEBPACK_IMPORTED_MODULE_3__Formats_XML__[\"a\" /* default */]({\n                                reader : __WEBPACK_IMPORTED_MODULE_5__Formats_ProcessIsoCurveResponseReader__[\"a\" /* default */]\n                            });\n\n                            // FIXME : mode XHR ne retourne que des string ? JSONP aussi  ce niveau ?\n                            if ( typeof options.response === \"string\") {\n                                p.setXMLString(options.response);\n                            } else {\n                                p.setXMLDoc(options.response);\n                            }\n\n                            data = p.parse();\n\n                            if (!data) {\n                                throw new Error(__WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__[\"a\" /* default */].getMessage(\"SERVICE_RESPONSE_EXCEPTION_2\"));\n                            }\n\n                        } catch (e) {\n\n                            var message = e.message;\n                            message += \"\\n (raw response service : '\" + options.response + \"')\";\n                            options.onError.call(options.scope, new __WEBPACK_IMPORTED_MODULE_2__Exceptions_ErrorService__[\"a\" /* default */]({\n                                message : __WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__[\"a\" /* default */].getMessage(\"SERVICE_RESPONSE_EXCEPTION\", message),\n                                status : 200,\n                                type : __WEBPACK_IMPORTED_MODULE_2__Exceptions_ErrorService__[\"a\" /* default */].TYPE_SRVERR\n                            }));\n                            return;\n                        }\n\n                        break;\n\n                    case \"json\":\n                        logger.trace(\"analyze response : json\");\n\n                        var JSONResponse;\n                        if ( typeof options.response === \"string\") {\n                            JSONResponse = JSON.parse(options.response);\n                        } else {\n                            JSONResponse = options.response;\n                        }\n\n                        // analyse de la reponse\n                        if (JSONResponse.status === \"OK\" || JSONResponse.status === \"ok\") {\n\n                            // cration de l'objet de rponse\n                            data = new __WEBPACK_IMPORTED_MODULE_6__model_ProcessIsoCurveResponse__[\"a\" /* default */]();\n\n                            // remplissage de l'objet cr avec les attribtuts de la rponse du service\n                            if (data) {\n                                data.time = JSONResponse.time;\n                                data.distance = JSONResponse.distance;\n                                data.message = JSONResponse.message;\n                                data.id = JSONResponse.id;\n                                data.srs = JSONResponse.srs;\n                                /** callback de la reponse */\n                                var onWKTSuccess = function (json) {\n                                    data.geometry = json;\n                                };\n                                /** callback d'erreur */\n                                var onWKTError = function () {\n                                    options.onError.call(options.scope, new __WEBPACK_IMPORTED_MODULE_2__Exceptions_ErrorService__[\"a\" /* default */]({\n                                        message : __WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__[\"a\" /* default */].getMessage(\"PARAM_FORMAT\", \"wktGeometry\")\n                                    }));\n                                };\n                                if (data.hasOwnProperty(\"geometry\")) {\n                                    __WEBPACK_IMPORTED_MODULE_4__Formats_WKT__[\"a\" /* default */].toJson(JSONResponse.wktGeometry, onWKTSuccess, onWKTError);\n                                    if (!data.geometry) {\n                                        return;\n                                    }\n                                }\n                                var coords = JSONResponse.location.split(\",\");\n                                if (data.location) {\n                                    data.location.x = coords[0];\n                                    data.location.y = coords[1];\n                                }\n                            } else {\n                                options.onError.call(options.scope, new __WEBPACK_IMPORTED_MODULE_2__Exceptions_ErrorService__[\"a\" /* default */](__WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__[\"a\" /* default */].getMessage(\"SERVICE_RESPONSE_ANALYSE\", options.response)));\n                                return;\n                            }\n\n                        } else if (JSONResponse.status === \"ERROR\" || JSONResponse.status === \"error\") {\n                            // JSHint bug if var message is used !?\n                            var mess = JSONResponse.message;\n                            mess += \"\\n (raw response service : '\" + JSONResponse + \"')\";\n                            options.onError.call(options.scope, new __WEBPACK_IMPORTED_MODULE_2__Exceptions_ErrorService__[\"a\" /* default */](__WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__[\"a\" /* default */].getMessage(\"SERVICE_RESPONSE_EXCEPTION\", mess)));\n                            return;\n\n                        }\n                        break;\n\n                    default:\n                        options.onError.call(options.scope, new __WEBPACK_IMPORTED_MODULE_2__Exceptions_ErrorService__[\"a\" /* default */](__WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__[\"a\" /* default */].getMessage(\"SERVICE_RESPONSE_FORMAT\", \"json\", \"xml\")));\n                        return;\n\n                }\n\n                // info : en cas de problmes de droits (cl invalide ou autre), la rponse est au format XML !!\n                // ex. <ExceptionReport><Exception exceptionCode=\"MissingParameter\">Key does not exist or has expired</Exception></ExceptionReport>\n                // mais le statut est 403, l'erreur est donc remonte plus tt.\n                if (data && data.exceptionReport) {\n                    options.onError.call(options.scope, new __WEBPACK_IMPORTED_MODULE_2__Exceptions_ErrorService__[\"a\" /* default */]({\n                        message : __WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__[\"a\" /* default */].getMessage(\"SERVICE_RESPONSE_EXCEPTION\", data.exceptionReport),\n                        type : __WEBPACK_IMPORTED_MODULE_2__Exceptions_ErrorService__[\"a\" /* default */].TYPE_SRVERR,\n                        status : 200\n                    }));\n                    return;\n                }\n\n            }\n        } else {\n            // si la rponse est vide, on appelle le callback d'erreur\n            options.onError.call(options.scope, new __WEBPACK_IMPORTED_MODULE_2__Exceptions_ErrorService__[\"a\" /* default */](__WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__[\"a\" /* default */].getMessage(\"SERVICE_RESPONSE_EMPTY\")));\n            return;\n        }\n\n        // si tout s'est bien pass, on appelle le callback de succs\n        options.onSuccess.call(options.scope, data);\n        return;\n    }\n};\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (ProcessIsoCurveResponseFactory);\n\n\n/***/ }),\n/* 100 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__ = __webpack_require__(1);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__Formats_WKT__ = __webpack_require__(8);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__Exceptions_ErrorService__ = __webpack_require__(2);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__Response_model_ProcessIsoCurveResponse__ = __webpack_require__(18);\n/**\n * Analyse de la reponse XML\n *\n * @module ProcessIsoCurveResponseReader\n * @alias Gp.Services.ProcessIsoCurve.Formats.ProcessIsoCurveResponseReader\n * @todo not yet implemented !\n * @private\n */\n\n\n\n\n\n\n\n/**\n * Objet ProcessIsoCurveResponseReader\n *\n * @member {Object} ProcessIsoCurveResponseReader\n *\n * @property {Object} ProcessIsoCurveResponseReader.READERS - Objet contenant des fonctions de lecture, appeles \"readers\"\n *      dont chaque cl correspond au nom d'un tag du XML que l'on souhaite lire\n *      et la valeur associe est une fonction (node, data)\n *      o node est un noeud du document DOM\n *      et data est un objet o l'on stocke les informations lues dans le XML.\n *\n * @property {Method} ProcessIsoCurveResponseReader.read -  Mthode permettant de lancer la lecture d'une rponse XML\n *       du service de calcul isochrone/isodistance,  l'aide des readers de la classe.\n *\n */\n\nvar ProcessIsoCurveResponseReader = {};\n\n/*\n    // INFO\n    // Exemple d'erreur du service\n    // <?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\" ?>\n    // <isochroneResult>\n    //  <message>Location point must have 2 components separated with a ,</message>\n    //  <status>ERROR</status>\n    // </isochroneResult>\n\n    // <?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\" ?>\n    // <serviceResult>\n    //   <message>ServiceException : Error in isochron computation Error in smartrouting null</message>\n    //   <status>ERROR</status>\n    // </serviceResult>\n\n    // INFO\n    // Exemple d'erreur NGinx\n    // <ExceptionReport><Exception exceptionCode=\"MissingParameter\">Resource parameter not found</Exception></ExceptionReport>\n*/\n\n/*\n    // INFO\n    // Exemple de rponse du service\n\n     // <IsochroneResult>\n     //    <status>OK</status>\n     //    <id/>\n     //    <location>-1.557189,47.217122</location>\n     //    <srs/>\n     //    <distance>5000</distance>\n     //    <wktGeometry>POLYGON ((-1.545312 47.178178, -1.545312 47.180418, ...))</wktGeometry>\n     // </IsochroneResult>\n\n    // <isochronResult>\n    //    <status>OK</status>\n    //    <id>1</id>\n    //    <location>-1.557189,47.217122</location>\n    //    <srs/>\n    //    <time>50</time>\n    //    <wktGeometry>POLYGON ((-1.556864 47.216487, -1.556864 47.216948, ...))</wktGeometry>\n    // </isochronResult>\n*/\n\nProcessIsoCurveResponseReader.READERS = {\n\n    /** TODO : jsdoc block */\n    isochronResult : function (root) {\n        // racine de la rponse XML : on cre l'objet de rponse\n        var response = new __WEBPACK_IMPORTED_MODULE_4__Response_model_ProcessIsoCurveResponse__[\"a\" /* default */]();\n\n        if (root.hasChildNodes()) {\n\n            var children = root.childNodes;\n            var child;\n\n            for (var i = 0; i < children.length; i++) {\n                child = children[i];\n\n                if (ProcessIsoCurveResponseReader.READERS[child.nodeName]) {\n                    ProcessIsoCurveResponseReader.READERS[child.nodeName](child, response);\n                }\n            }\n        }\n\n        if (response.status === \"error\") {\n            var message = __WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__[\"a\" /* default */].getMessage(\"SERVICE_RESPONSE_EXCEPTION\",\n                response.message);\n            throw new __WEBPACK_IMPORTED_MODULE_3__Exceptions_ErrorService__[\"a\" /* default */]({\n                message : message,\n                type : __WEBPACK_IMPORTED_MODULE_3__Exceptions_ErrorService__[\"a\" /* default */].TYPE_SRVERR\n            });\n        }\n        return response;\n    },\n\n    /** TODO : jsdoc block */\n    message : function (node, response) {\n        if (response) {\n            response.message = __getChildValue(node);\n        }\n    },\n\n    /** TODO : jsdoc block */\n    status : function (node, response) {\n        var status = __getChildValue(node);\n        if (status === \"ERROR\" || status === \"error\") {\n            if (response) {\n                response.status = \"error\";\n            }\n        }\n    },\n\n    /** TODO : jsdoc block */\n    id : function (node, response) {\n        if (response) {\n            response.id = __getChildValue(node);\n        }\n    },\n\n    /** TODO : jsdoc block */\n    location : function (node, response) {\n        var coords = __getChildValue(node);\n        if (response && response.location) {\n            response.location.x = parseFloat(coords.split(\",\")[0]);\n            response.location.y = parseFloat(coords.split(\",\")[1]);\n        }\n    },\n\n    /** TODO : jsdoc block */\n    srs : function (node, response) {\n        if (response) {\n            response.srs = __getChildValue(node);\n        }\n    },\n\n    /** TODO : jsdoc block */\n    distance : function (node, response) {\n        if (response) {\n            response.distance = parseFloat(__getChildValue(node));\n        }\n    },\n\n    /** TODO : jsdoc block */\n    time : function (node, response) {\n        if (response) {\n            response.time = parseFloat(__getChildValue(node));\n        }\n    },\n\n    /** TODO : jsdoc block */\n    wktGeometry : function (node, response) {\n        if (response) {\n            var wktGeometry = node.innerHTML;\n            /** TODO : jsdoc block */\n            var onWKTSuccess = function (json) {\n                response.geometry = json;\n            };\n            /** TODO : jsdoc block */\n            var onWKTError = function () {\n                var msg = __WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__[\"a\" /* default */].getMessage(\"PARAM_FORMAT\", [\"wktGeometry\"]);\n                throw new Error(msg);\n            };\n            if (response.hasOwnProperty(\"geometry\")) {\n                __WEBPACK_IMPORTED_MODULE_2__Formats_WKT__[\"a\" /* default */].toJson(wktGeometry, onWKTSuccess, onWKTError);\n            }\n        }\n    },\n\n    /** TODO : jsdoc block */\n    serviceResult : function (node) {\n        // en cas d'exception du service\n        var response = {};\n        if (node.hasChildNodes()) {\n            var children = node.childNodes;\n            var child;\n            for (var i = 0; i < children.length; i++) {\n                child = children[i];\n                if (ProcessIsoCurveResponseReader.READERS[child.nodeName]) {\n                    ProcessIsoCurveResponseReader.READERS[child.nodeName](child, response);\n                }\n            }\n        }\n        return response;\n    },\n\n    /** TODO : jsdoc block */\n    ExceptionReport : function (node) {\n        var response = {};\n        if (node.hasChildNodes()) {\n            var children = node.childNodes;\n            var child;\n            for (var i = 0; i < children.length; i++) {\n                child = children[i];\n                if (child.nodeName === \"Exception\") {\n                    response.exceptionReport = ProcessIsoCurveResponseReader.READERS[\"Exception\"](child);\n                }\n            }\n        }\n        return response;\n    },\n\n    /** TODO : jsdoc block */\n    Exception : function (node) {\n        var exceptionReport = {};\n\n        // get exception code\n        var exceptionCode = node.getAttribute(\"exceptionCode\");\n        if (exceptionCode) {\n            exceptionReport.exceptionCode = exceptionCode;\n        }\n\n        // get exception message\n        var textNode = node.firstChild;\n        if (textNode && textNode.nodeType === 3) { // 3 == node.TEXT_NODE\n            exceptionReport.exception = textNode.nodeValue;\n        }\n\n        return exceptionReport;\n    }\n};\n\n/** TODO : jsdoc block */\nProcessIsoCurveResponseReader.read = function (root) {\n\n    var response;\n\n    if (root.nodeName === \"isochronResult\" || root.nodeName === \"isochroneResult\" || root.nodeName === \"IsochroneResult\") {\n        response = ProcessIsoCurveResponseReader.READERS[\"isochronResult\"](root);\n        return response;\n\n    } else if (root.nodeName === \"ExceptionReport\") {\n        response = ProcessIsoCurveResponseReader.READERS[root.nodeName](root);\n        return response;\n\n    } else if (ProcessIsoCurveResponseReader.READERS[root.nodeName]) {\n        response = ProcessIsoCurveResponseReader.READERS[root.nodeName](root);\n        if (response.status === \"error\") {\n            var errMsg = __WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__[\"a\" /* default */].getMessage(\"SERVICE_RESPONSE_EXCEPTION\",\n                response.message);\n            throw new __WEBPACK_IMPORTED_MODULE_3__Exceptions_ErrorService__[\"a\" /* default */]({\n                message : errMsg,\n                type : __WEBPACK_IMPORTED_MODULE_3__Exceptions_ErrorService__[\"a\" /* default */].TYPE_SRVERR\n            });\n        }\n        return response;\n\n    } else {\n        throw new __WEBPACK_IMPORTED_MODULE_3__Exceptions_ErrorService__[\"a\" /* default */]({\n            message : __WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__[\"a\" /* default */].getMessage(\"SERVICE_RESPONSE_ANALYSE\", root.nodeName),\n            type : __WEBPACK_IMPORTED_MODULE_3__Exceptions_ErrorService__[\"a\" /* default */].TYPE_UNKERR\n        });\n    }\n};\n\n/**\n * Lecture de la valeur du premier child d'un noeud, si elle existe.\n *\n * @private\n * @memberof ProcessIsoCurveResponseReader\n * @method __getChildValue\n * @param {DOMElement} node - a DOM node\n * @return {String} value - valeur du firstChild du noeud en entre, ou chane vide.\n */\nfunction __getChildValue (node) {\n\n    var textNode;\n    var value = \"\";\n\n    if (node.hasChildNodes()) {\n        textNode = node.firstChild;\n        if (textNode && textNode.nodeType === 3) { // 3 == node.TEXT_NODE\n            value = textNode.nodeValue;\n        }\n    }\n    return value;\n}\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (ProcessIsoCurveResponseReader);\n\n\n/***/ })\n/******/ ])[\"default\"];\n});\n//# sourceMappingURL=GpServices-src.js.map\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/geoportal-access-lib/dist/GpServices-src.js\n// module id = 4\n// module chunks = 0","var LayerUtils = {\n\n    /**\n     * Obtenir le ZoomLevel  partir du ScaleDenominator\n     */\n    getZoomLevelFromScaleDenominator: function(scaleDenominator, crs) {\n\n        // ------------------------------------------------- //\n        // Code issu de l'API Geoportal/Catalogue/Config.js  //\n        // ------------------------------------------------- //\n        //     var configuration = Gp.Config;\n        //     var general = configuration.generalOptions;\n        //     var layers  = configuration.layersContext;\n        //\n        //     for (var tms in general.tileMatrixSets) {\n        //         var tileMatrixSet = general.tileMatrixSets[tms];\n        //         // IGN's WMTS bug : epsg:nnnn instead of EPSG:nnnn\n        //         var crs = tileMatrixSet.supportedCRS = tileMatrixSet.supportedCRS.replace(/epsg/,\"EPSG\");\n        //\n        //         if (!Geoportal.Catalogue.CRSRESOLUTIONS.hasOwnProperty(crs)) {\n        //             var p= new OpenLayers.Projection(crs);\n        //             Geoportal.Catalogue.CRSRESOLUTIONS[crs]= [];\n        //             var matrixIds= tileMatrixSet.matrixIds;\n        //             for (var i= 0, li= matrixIds.length; i<li; ++i) {\n        //                 var mid= matrixIds[i];\n        //                 Geoportal.Catalogue.CRSRESOLUTIONS[crs].push(\n        //                     0.00028*mid.scaleDenominator\n        //                     /(OpenLayers.METERS_PER_INCH*OpenLayers.INCHES_PER_UNIT[p.getUnits()]));\n        //                     mid.supportedCRS= mid.supportedCRS.replace(/epsg/,\"EPSG\");\n        //                 }\n        //                 Geoportal.Catalogue.CRSRESOLUTIONS[crs].sort(function (a,b){ return b-a; });\n        //             }\n        //         }\n        //         var llR= Geoportal.Catalogue.CRSRESOLUTIONS['CRS:84'];\n        //         if (!llR) {\n        //             llR= Geoportal.Catalogue.CRSRESOLUTIONS['CRS:84']= general.resolutions.slice();\n        //         }\n        //         var wmR= Geoportal.Catalogue.CRSRESOLUTIONS['EPSG:3857'];\n        //         if (!wmR) {//FIXME : should never happened !!\n        //             // reproject resolutions from CRS84 to WebMercator (transform resolutions from degree/px to meter/px)\n        //             wmR= Geoportal.Catalogue.CRSRESOLUTIONS['EPSG:3857']= new Array(llR.length);\n        //             for (var i= 0, len= llR.length; i<len; i++) {\n        //                 var pt= new OpenLayers.LonLat(llR[i], 0);\n        //                 pt.transform(OpenLayers.Projection.CRS84, OpenLayers.Projection.WebMercator);\n        //                 wmR[i]= pt.lon;\n        //             }\n        //         }\n        //         Geoportal.Catalogue.RESOLUTIONS= wmR;\n        //\n        //         var getResolutionsFromCRS= function(crs) {\n        //             if (OpenLayers.Projection.WebMercator.isAliasOf(crs)) {\n        //                 return wmR;\n        //             }\n        //             if (OpenLayers.Projection.CRS84.isAliasOf(crs)) {\n        //                 return llR;\n        //             }\n        //             return Geoportal.Catalogue.CRSRESOLUTIONS[crs]?Geoportal.Catalogue.CRSRESOLUTIONS[crs]:null ;\n        //         };\n        //\n        //         var retrieveZoomFromResolution= function(resolutions, resolution) {\n        //             for (var i= 0, li= resolutions.length; i<li; i++) {\n        //                 if (resolutions[i]-resolution <= resolutions[li-1]) {\n        //                     return i;\n        //                 }\n        //             }\n        //             return -1;\n        //         };\n        //\n        //         var getZoomLevelFromScaleDenominator= function(scaleDenominator,crs) {\n        //             var resolution= scaleDenominator * 0.00028;\n        //             var R= getResolutionsFromCRS(crs);\n        //             if (R) {\n        //                 return retrieveZoomFromResolution(R,resolution);\n        //             }\n        //             resolution= resolution/(OpenLayers.METERS_PER_INCH * OpenLayers.INCHES_PER_UNIT[\"degrees\"]);\n        //             return retrieveZoomFromResolution(llR,resolution);\n        //         };\n        //\n        //         var getZoomLevelFromResolution= function(resolution,crs){\n        //             var R= getResolutionsFromCRS(crs);\n        //             if (R) {\n        //                 return retrieveZoomFromResolution(R,resolution);\n        //             }\n        //             var pt0= new OpenLayers.LonLat(0, 0);\n        //             var pt1= new OpenLayers.LonLat(1, 0);\n        //             pt0.transform(new OpenLayers.Projection(crs),OpenLayers.Projection.CRS84);\n        //             pt1.transform(new OpenLayers.Projection(crs),OpenLayers.Projection.CRS84);\n        //             resolution= resolution*(Math.abs(pt1.lon-pt0.lon));\n        //             return retrieveZoomFromResolution(llR,resolution);\n        //         };\n\n        // par defaut, on utilise la projection WebMercator (EPSG:3857 = PM)\n        // soit la liste des resolutions natives\n        var resolutionsNatives = {};\n        switch (crs) {\n            case \"EPSG:2154\":\n                resolutionsNatives = {\n                    0: 104579.224549894,\n                    1: 52277.5323537905,\n                    2: 26135.4870785954,\n                    3: 13066.8913818,\n                    4: 6533.2286041135,\n                    5: 3266.5595244627,\n                    6: 1633.2660045974,\n                    7: 816.629554986,\n                    8: 408.3139146768,\n                    9: 204.1567415109,\n                    10: 102.0783167832,\n                    11: 51.0391448966,\n                    12: 25.5195690743,\n                    13: 12.7597836936,\n                    14: 6.379891636,\n                    15: 3.1899457653,\n                    16: 1.5949728695,\n                    17: 0.7974864315,\n                    18: 0.3987432149,\n                    19: 0.1993716073,\n                    20: 0.0996858037,\n                    21: 0.0498429018\n                };\n                break;\n            default:\n                resolutionsNatives = {\n                    0: 156543.033928041,\n                    1: 78271.51696402048,\n                    2: 39135.758482010235,\n                    3: 19567.87924100512,\n                    4: 9783.93962050256,\n                    5: 4891.96981025128,\n                    6: 2445.98490512564,\n                    7: 1222.99245256282,\n                    8: 611.49622628141,\n                    9: 305.7481131407048,\n                    10: 152.8740565703525,\n                    11: 76.43702828517624,\n                    12: 38.21851414258813,\n                    13: 19.10925707129406,\n                    14: 9.554628535647032,\n                    15: 4.777314267823516,\n                    16: 2.388657133911758,\n                    17: 1.194328566955879,\n                    18: 0.5971642834779395,\n                    19: 0.2985821417389697,\n                    20: 0.1492910708694849,\n                    21: 0.0746455354347424\n                };\n                break;\n        }\n\n        // gestion des autres SRS\n        // TODO\n        // if (crs) {\n        // }\n\n        var resolution = scaleDenominator * 0.00028;\n\n        for (var index in resolutionsNatives) {\n            if (resolutionsNatives.hasOwnProperty(index)) {\n                if (resolutionsNatives[index] <= resolution) {\n                    index = parseInt(index, 10);\n                    return index;\n                }\n            }\n        }\n\n        return 0; // -1 ?\n    },\n\n    /**\n     * Get attributions list for a layer, based on current zoom and extent\n     *\n     * @param {Object} params - function params\n     * @param {Array.<Float>} params.extent - map current geographical extent (EPSG:4326) : [top, left, bottom, right] = [maxy, minx, miny, maxx]\n     * @param {Number} params.zoom - map current zoom\n     * @param {String} params.crs - map current projection code (ex \"EPSG:2154\")\n     * @param {Boolean} params.visibility - layer visibility\n     * @param {Gp.Services.Config.Originator} params.originators - resource originators (from Gp.Config.layers[].originators)\n     * @returns {Object} attributions - associative array, mapping originators url (keys) with their properties : html attributions elements\n     */\n    getAttributions: function(params) {\n\n        var zoom = params.zoom;\n\n        var attributions = [];\n\n        if (params.originators != null && params.visibility) {\n\n            // drawLogo = boolean, true if attribution should be displayed (zoom, extent), false otherwise\n            var drawLogo;\n            for (var j = 0, jl = params.originators.length; j < jl; j++) {\n                drawLogo = true;\n                var originator = params.originators[j];\n\n                var constraints = params.originators[j].constraints || [];\n                for (var k = 0, kl = constraints.length; k < kl; k++) {\n\n                    var constraint = constraints[k];\n                    drawLogo = true;\n\n                    var minZoomLevel = this.getZoomLevelFromScaleDenominator(constraint.maxScaleDenominator, params.crs);\n                    var maxZoomLevel = this.getZoomLevelFromScaleDenominator(constraint.minScaleDenominator, params.crs) || 21;\n\n                    // min zoom constraints\n                    if (minZoomLevel && (minZoomLevel > zoom)) {\n                        drawLogo = false;\n                    }\n\n                    // max zoom constraints\n                    if (drawLogo && maxZoomLevel !== null && (maxZoomLevel < zoom)) {\n                        drawLogo = false;\n                    }\n\n                    // bbox constraints\n                    var bbox = constraint.bbox;\n                    if (drawLogo && bbox) {\n                        drawLogo = false;\n                        var viewExtent = params.extent;\n                        if (viewExtent) {\n                            var bounds = [bbox.top, bbox.left, bbox.bottom, bbox.right];\n                            if (this.intersects(viewExtent, bounds)) {\n                                // at least one constraint matches the map ones\n                                drawLogo = true;\n                                break;\n                            }\n                        }\n                    }\n                }\n\n                if (drawLogo) {\n                    // on a un originator qui correspond au zoom et  l'tendue.\n\n                    var logo = originator.logo;\n                    var url = originator.url;\n                    var name = originator.name ? originator.name : \"\";\n                    var text = originator.attribution;\n\n                    var container = document.createElement(\"div\");\n                    container.className = \"gp-control-attribution\";\n\n                    // on cre un lien dans tous les cas (mme s'il ne pointe pas vers une rfrence), pour avoir accs  la class CSS (pour surcharge)\n                    var link = null;\n                    link = document.createElement(\"a\");\n                    link.className = \"gp-control-attribution-link\";\n                    link.target = \"_blank\";\n                    container.appendChild(link);\n                    if (url) {\n                        link.href = url;\n                    }\n\n                    var bImage = (logo) ? true : false;\n                    var image = null;\n                    // si on a un logo, on l'affiche  l'interieur du lien\n                    if (bImage) {\n                        image = document.createElement(\"img\");\n                        if (link) {\n                            image.className = \"gp-control-attribution-image\";\n                            link.appendChild(image);\n                        } else {\n                            image.className = \"\";\n                            container.appendChild(image);\n                        }\n                        image.src = logo; // FIXME : mixContent ! \n                        image.title = text || name;\n                        image.style.height = \"30px\";\n                        image.style.width = \"30px\";\n                    } else {\n                        // sinon, on affiche le nom de l'originator, ou sa description ou l'url.\n                        if (name) {\n                            link.textContent = name;\n                        } else if (text) {\n                            link.textContent = text;\n                        } else if (url) {\n                            link.textContent = url;\n                        } else {\n                            link.textContent = \"\";\n                        }\n                    }\n\n                    attributions.push(container.innerHTML + \" \");\n                }\n            }\n        }\n\n        return attributions;\n    },\n\n    /**\n     * Determines if one extent (extent1) intersects another (extent2)\n     *\n     * @param {Array.<Float>} extent1 - First extent : [top, left, bottom, right] = [maxy, minx, miny, maxx]\n     * @param {Array.<Float>} extent2 - Second extent : [top, left, bottom, right] = [maxy, minx, miny, maxx]\n     * @return {Boolean} intersects - True if the two extents intersect, false otherwise.\n     */\n    intersects: function(extent1, extent2) {\n        var intersectsX = (extent1[1] <= extent2[3]) && (extent2[1] <= extent1[3]);\n        var intersectsY = (extent1[2] <= extent2[0]) && (extent2[2] <= extent1[0]);\n        return intersectsX && intersectsY;\n    }\n};\n\nexport default LayerUtils;\n\n\n\n// WEBPACK FOOTER //\n// ./src/Common/Utils/LayerUtils.js","import Logger from \"../../Common/Utils/LoggerByDefault\";\nimport Config from \"./Config\";\n\nexport default {\n    /**\n     * Contrle des droits sur les ressources.\n     *\n     * @param {Object} options - liste des options\n     * @param {String} options.key - clef API\n     * @param {Array} options.resources - liste des ressources\n     * @param {Array} options.services - liste des services\n     * @returns {Object} rightManagement - undefined ou {\n     *       key : \"\",\n     *       service-1 : [resource-1, resource-2],\n     *       service-2 : [resource-1, resource-2]\n     * }\n     */\n    check: function(options) {\n\n        // logger\n\n        var logger = Logger.getLogger(\"checkrightmanagement\");\n\n        // si aucune option n'est renseigne...\n        if (!options) {\n            // message orient pour le developpeur !\n            logger.error(\"WARNING : \" +\n                \"no parameter specified !\");\n            return;\n        }\n\n        // les options\n        var _key = options.key;\n        var _resources = options.resources || [];\n        var _services = options.services || [];\n\n        // si aucune information sur les ressources,\n        // il est impossible de controler quelquechose !!!\n        if (!_resources || _resources.length === 0) {\n            // message orient pour le developpeur !\n            logger.error(\"WARNING : \" +\n                \"no parameter 'resources' specified !\");\n            return;\n        }\n\n        // si aucune information sur les services,\n        // il est impossible de controler quelquechose !!!\n        if (!_services || _services.length === 0) {\n            // message orient pour le developpeur !\n            logger.error(\"WARNING : \" +\n                \"no parameter 'services' specified !\");\n            return;\n        }\n\n        // les ressources controles :\n        // Ex.\n        // {\n        //   \"Itineraire\"     : [\"Pieton\", \"Voiture\"],\n        //   \"Geocode\"        : [\"PositionOfInterest\", \"StreetAddress\", \"CadastralParcel\", \"Administratif\"],\n        //   \"AutoCompletion\" : [\"PositionOfInterest\", \"StreetAddress\", \"CadastralParcel\", \"Administratif\"],\n        //   \"Elevation\"      : [\"SERVICE_CALCUL_ALTIMETRIQUE_RSC\"]\n        // }\n        var _rightManagement = {};\n\n        // la clef API n'est pas renseigne\n        if (!_key) {\n\n            // on verifie si l'autoconfiguration est disponible\n\n            if (!Config.isConfigLoaded()) {\n                // si l'autoconfiguration n'est pas charge,\n                // aucune vrification des droits est possible...\n\n                console.log(\"WARNING : \" +\n                    \"The 'apiKey' parameter is missing, \" +\n                    \"and the contract key configuration has not been loaded, \" +\n                    \"so impossible to check yours rights !\");\n\n                return;\n\n            } else {\n                // si l'autoconfiguration est charge,\n                // on recupere la clef API, et on en profitera ensuite pour controler\n                // les droits sur les ressources.\n\n                // FIXME par defaut, on recupere toujours la premire...\n                _key = Object.keys(Config.configuration.generalOptions.apiKeys)[0];\n                logger.log(_key);\n            }\n        }\n\n        // la clef API est renseigne ou recupere de l'autoconfiguration\n        if (_key) {\n\n            // on verifie si l'autoconfiguration est disponible\n\n            if (!Config.isConfigLoaded()) {\n                // si l'autoconfiguration n'est pas charge,\n                // il est toujours possible de requeter le service avec une clef API,\n                // mais les droits sur les ressources ne sont pas garantis, on risque\n                // d'obtenir des erreurs 403 forbidden...\n                // la responsabilit revient  l'utilisateur (message d'information)...\n\n                console.log(\"WARNING : \" +\n                    \"the contract key configuration has not been loaded, \" +\n                    \"so be carefull !\");\n\n                // les ressouces non controles\n                var _noRightManagement = {};\n\n                for (var i = 0; i < _services.length; i++) {\n                    var service = _services[i];\n                    _noRightManagement[service] = [];\n\n                    for (var j = 0; j < _resources.length; j++) {\n                        var resource = _resources[j];\n                        _noRightManagement[service].push(resource);\n                    }\n                }\n\n                // on ajoute la clef\n                _noRightManagement.key = _key;\n\n                logger.log(\"right management not checked\", _noRightManagement);\n\n                return _noRightManagement;\n\n            } else {\n                // si l'autoconf est charge,\n                // on verifie la correspondance entre la clef et l'autoconfiguration,\n                // on previent l'utilisateur (message d'information) s'il n'a\n                // pas de droits sur certaines ressources ...\n\n                // doit on ecarter les ressources sans droit ?\n                // oui, si possible avec un message d'information pour l'utilisateur...\n\n                for (var k = 0; k < _resources.length; k++) {\n                    var _resource = _resources[k];\n\n                    for (var l = 0; l < _services.length; l++) {\n                        var _service = _services[l];\n\n                        var params = Config.getServiceParams(_resource, _service, _key);\n                        if (!params || Object.keys(params).length === 0) {\n                            console.log(\"WARNING : \" +\n                                \"The contract key configuration has no rights to load this geoportal \" +\n                                \"resource (\" + _resource + \") \" +\n                                \"for this service (\" + _service + \") \");\n                            continue;\n                        }\n\n                        if (!_rightManagement[_service]) {\n                            _rightManagement[_service] = [];\n                        }\n\n                        _rightManagement[_service].push(_resource);\n                    }\n                }\n\n                if (!_rightManagement || Object.keys(_rightManagement).length === 0) {\n                    console.log(\"WARNING : \" +\n                        \"The contract key configuration has been loaded, \" +\n                        \"and the 'apiKey' parameter has been set, \" +\n                        \"but, there is a problem on the mapping between the contract and the key !\");\n                    return;\n                }\n\n                // on ajoute la clef\n                _rightManagement.key = _key;\n\n                logger.log(\"right management checked\", _rightManagement);\n\n                return _rightManagement;\n\n            }\n        }\n    }\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/Common/Utils/CheckRightManagement.js","var Marker = {\n    lightOrange: \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADMAAAAmCAYAAABpuqMCAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAN1wAADdcBQiibeAAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAARDSURBVFiF3ZndaxxVGMZ/Z/YjX00Nadpo1qrFBgu56D9QbAtiLoRC7ywSNK1NURRREBKRFlSwFBW0gnSrJXY1CmISgyjFiyYSFC9ajE3MmpjdjWlMUtNos9lN9mteLzbRuCbZmTMTBB+Yi51znvd5n3nPnjnnjBIR/i/wuh4xpCpI0ojiENAA1AE1wCzwKzCE0EM5l2iShJvSyrXKnFVb8dOK4hmg3AIjifAmaU7ztMy7kYI7Zs6rQwjvka+AXcyiOMZx6XGahuE0AEHVitCFnhGAGoQugqrVaSrOKpNP4FWnSaxCGy1yWpesbyY/tLpwo7p/w0RxWHfI6Zk5q7ZSwhj6Q2sjzJLiXp1JQe+p+mllc4wA1CzHtw37lQmpCha5gbXpVxdJythh9z1kvzJJGrFixPBmOXixl+Z4mONmguZ4mIMXezG8WQsq5cs6tmDfTP7NXiSqN0vTzBD1TQfwbdmDUhX4tuyhvukATTNDlgxZ0SmUtUsgv0TZGPsv9FNSvXfNtpLqvey/0O+KTgF0zNQV7XHP4dsdtVvVKYCOmeqiPbwVOx21W9UpgI6ZWNEe2cSEo3arOgWwb0YYLp5G17Sjdqs6BdCZzYqL9B3dR2puYM221NwAfUf3uaJTAB0zaye5GmbWS6i2gdFQL5mFMCIJMgthRkO9hGobMLPFN4VWdAoptlcAQeUDRoG77YrZwDhQT4tk7JDsV6ZFMggv2+bZwyt2jYDuQnOa94GIFrc4IkzRrkPUM3NKsijatLjF0copsbJ++xec7TTPqw6EI/oB/glT+PC+13Y/aSQNv/Is+tNer09lMn7DMHwAYppp8fvTIpISkVQsFrslqww4M9OuqkgzANzl1MhCyrjZGAycm573pK1yFCyi5FoWvo/FYlPOT2fOqftRXMbB9lkEs+3zbe2f/FD5i3YMj2p3vn8/IV8DZ5yE+Gqkot+JEQCPada5dRhxEriiQ5ya90w+272916F+KpnJDLhjpkUy5HgESNqhZU2Vfr5ne+dSFtOBeso06J6cnEy6d0z0hPwEPGeH8sGVykvfjpfe1NZUci2+mHg7Go2G8z/d/goQVJ9B8S1veMYffujduo/thl+ZwUzDuBqJRGZWt7n/FcDH46lFNVLilar1uiTTxsJTnTssH/QpJVlMNQa5wbGJiWERya3Vz30zzfLb3OveY3dU5j5dp4e80Xdbd3TOu/H/yyAtpjnqgeGS8crRQRks+v5xf5gtY/KM/6NAVebhwvv90bLvHu2o/XId2pJSMmIaxo/RaHRMxN6yZtPM0K5K/7hl/FxVZgZWbs0mPDceeKcuGE95/kpSKUmaImHDNIfHrl+PiIj2zOb+MFvBY7IUOVl2ZG9g6bJH4ckJuRe/2NYZT3myKIkrGM4pNRyLjY+LW09URDb1+uaF0pfm3zJ+7zhRGdq1c9eDuwOBOzdLa/OG2X+APwE8DU64Y/5gfAAAAABJRU5ErkJggg==\",\n    darkOrange: \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADMAAAAmCAYAAABpuqMCAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAN1wAADdcBQiibeAAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAQ+SURBVFiF3ZlLaFxlGIaf/5zJpJNpaoxpYieoCxULEYK7Lqp0IWQhFLooKNKEtNIULxWlQoJgQQWLFMEg0lQMuXgD0dRSkNJFgoy0IrYNSTpj08xMmoxNYhLUyUwyt/O5mFbjmGTOLS58d3O+y/u95/vnvx0lIvxf4HE9Y7PyU0ETwl6gAQgANcA88AswhuIsKc7TJ0k3qZVrnTmqtpGhHeFloMJERArF+3g5Qaf84UYJ7og5rPai+JhCB6xiHuEQp+Ws0zI0pwloU+0oBrAnBKAGxQBtqt1pKc46UyjgHadFrEIHXXLCbrB9MYWhNYAb3f0bBsI+u0POnpijahtpJrA/tDbCPOU8aGdSsPdWM7SzOUIAam7ntwzrnWlWfnzMYW76tYsUy9RaXYesd6aCJswI0Tw5WvuG6EyEOWUk6UyEae0bQvPkTLEUeCzBupjCyl4iqyfHydkxdh3YQ/nWnSjlp3zrTnYd2MPJ2TFTgszwFNNaDaCwRdkYLd1B/NWNa9r81Y20dAdd4SmCHTGBkh6P7bvXkd0sTxHsiKku6eH13+fIbpanCHbExEp6ZJJTjuxmeYpgXYwiVNLnysCMI7tZniLYmc1Kk/Qe3E1ycXhNW3JxmN6Du13hKYIdMWsXuRpGzsOxugYu9Q+RXgojkiS9FOZS/xDH6howcqUPhWZ4imB9B9CmyoBx4AGrZBYwCTxMl2StBFnvTJdkUbxlOc4a3rYqBOxuNHfQC0RsxZZGhAA9dgLtiTkuOYQOW7Gl0c5xMbN/+xecnTQPq89QPGM/wT9hCJ8+MvjQ81pK8yp92ZvxeMpUNuvVNK0MQAwjI15vRkTSIpKOxWK/yyoBzsS0qiq8DAP3OxWylNMWmoL1XTMresZsjIJllIzk4GosFrvl/HbmiHoCYRAHx2cBo2Pknp4v45U3befQVY/z8/sp+Q5410mKC7P+oBMhALphBNy6jHgDxU92Am+t6PFXhrcPOeRPp7LZYXfEdEkWjWeBlJWwnKEyr41s/3rFwHDAnjY0zsTj8ZR710Qfys/Aq1ZCPrlZef7iwpYF25xKRhLLyQ+i0Wi48NPtrwBt6hsofeQNJ7zhp74PfGE1/Z0ZzNC0y5FIZHa1zf2vAFmeS2vqerkuVeu5pPLa0otXa01f9CklOQw1AfnRiampkIjk1/JzX0y3/LrY7Dm0w5f/ah0Pee/GXWeiSc/G/y+NjBjGuA6h8snK8VEZLbn+uD/MbiPe7P283pd9uvh5cMH3Q8uPdd+uE7ailFw3NO1aNBqdELG2rdk0MbSqLb8p7UZVmVF/59F8Wp97Mhg4ncjqfxWplKQMkbBmGKGJ6emIiNie2TZPDHB5v+/xxrtXBnWFnhfyL1yp/ejCXMUMShIKQnmlQrFYbFJcKmJTxQBc3O9789FtmZfOzfjPvT5S068bmWvj09PTm8G16WL+S/wJLybNu1V6htkAAAAASUVORK5CYII=\",\n    red: \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADMAAAAmCAYAAABpuqMCAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAN1wAADdcBQiibeAAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAQxSURBVFiF3ZldaBxVFMd/d2ayTRtjQpo2mlilWBEMshoj+FAERZIHIdA3iw+V1icRREFIQAKNgsUHQfBFwZI2WgWxqYUiVTDBBj9ILC5Nu2tjdjemsR+mSZNNNvsxO8eHTTRuk+zMnQmCf9iHnXvO+Z//nDvn3rmjRIT/C6zAI4ZVFRbtKDpQNCM0AvXANIo/EC4inMbmLBFZDJJaBVaZJ9Sd2HQCrwDbXHikgfewOMKPMh9ECsGIeVx1IHxEsQJeMY3iEMNy2m8aht8AtKpOhH70hADUI/TTqjr9puKvMsUE3vabxCp0MSJHdJ31xRSnVj9BVPcfOCj26U45PTHFh30c/am1EaaxuF+nKejd1WLX2gwhAPXL8T3De2XCqooKbuCu/eoiTZ6dXtch75WxaMeNENOyOXx8kHOpGMPOIudSMQ4fH8S0bBcs25Z5PMF7ZVpVL3BgQxvTsvn6+kVq6sK3jc3NRGhraKZgl9t9HGNEXvCSmvfKKJrL2nQfHVpTCEBNXZjuo0OB8JTAu5jiXmtjPL3vLl/jbnlKoNPN6spaVFbt8jXulqcEOmKSZS0yi5O+xt3ylEBHTLSsxbf913yNu+UpgU4DKE/Sc3AvczORNcfmZiL0HNwbCE8JvItxWDvJ1SjYFm0NzZzpG2RpIYbIIksLMc70Dbpsy+54SqCzzlQAY8B9Xsk8YAJ4gBHJe3HyXpkRyaN407OfN7zlVQjobjTv4BgQ1/ItjzjV9Oo46okZEBuhS8u3PDoZEDf7t9vg903zBLBfP8C/4cAnD87teclIGyFlLoVyllWh8vmQYRgVAOI4OQmFciKSFZFsMpmck1UC/Il5VNViEgHu9StkQYyb7bNNH1wrmDm3PgqWUHLBhl+SyeRV/6czLepJDAbw8fos4HTNb+/9PFv9u3YMU/X6f38/L98B7/gJ8U2uasiPEADTcRqDOozoBn7WcbzqmFOvpnYM+uTPpvP5SDBiimvP8xRPKV3DFpV7fX7HyYyD44M96xicmpqaSgd3TDQsv6J4zYvLx5nqsz/kK29qcyq5kFpafD+RSMSKf4P+CvCY+hJFRzmzmB2KPTvb+JnX8CsdzDGM8/F4/PrqseC/AggvZlGXtyipXc8kLcbCy6mdrg/6lBIbR41DYXR8cjIqIoW17IIXc17+nHnEOnS3VfhiHQt5d7HmVMK2Nn6+DHLiOGMmRLdMVI+NymjZ9Sf4abaMqZbQp01G/rnS60P5rT8duNXw1TpuGaXksmMYlxKJxLiIt23NponhKVV5a874rdZwmlYuTTvmjWdmGj9Mifl3kkpJ2hGJGY4THb9yJS4i2p0t+Gm2ggHJxMNb94eNzIAJZgEKbyxsP5kS00ZJSkG0oFQ0mZyYkKDuqIhs6u/7hyt75luM2RMPVfft3rW7bU9T0z2bxbV50+w/wF8f81R5OpwBhwAAAABJRU5ErkJggg==\",\n    turquoiseBlue: \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADMAAAAmCAYAAABpuqMCAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAN1wAADdcBQiibeAAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAASxSURBVFiF3ZhdbBRVGIafc2Z2210hbeWnpcQVUC8kwBUJXJBIgwkgBEPEC1GMxhgE4gUJJsYERMWI3orYaiqgrYSWH/mvMaQLciE1RAKUkrLbbhMobQ20/LT7N3OOF0CC0O7szGwv9L3c73u/93vnnD3zzYH/EUTBKx6sHUvQWgR6GTAdmASMA26A6AYuofUhQnYTVevuFlK6cGaObC9DGh8i9PtAKA/GEIKvSRZtZfnbA4VooTBmjlWvQFADPOmBfRN4l8Xv7ffbhvTF1lpwrHoTgga8GeE+by9NNRvR2tfDNfyQmVv5MYJP8L/CAqgidtai/sgpP0W84d7WavBV43Eo0CtYvOaAF7K3Rg7sKKU4Hcf71sqFfmz1DEvX9rslevvPFKc/YnSMAJRhyA+8EN2vzMHasQSzveR3/HrFEMV2udv3kOlaJmgtIg8jYcMcqpu1oGXJhMi0oJQVGaV6Dvd1day62DwnaWWd+GHSciGwz01rHraZXuaUETbMoe6qVR3Ly6fMD0oZAYJBKSOvVEyd3z3/jVjIDCSddYSjzqPwYEY875RRN2tBS4kZnDFcrNQMztw144UzjjKa6W4787IylU4ZSyZEpuWKv1w+dWohdB6Fl9NsnFNCUMqKnHGRO34PYnz+Ld2DFzN3nBIySvXkjGt1PQ+d23l3dB9ezPQ6JRzu6+rIFT/Q25lwVNHkfCDDwYuZFqeEVReb5wxYmQvDxfqz6QtvnW+e69yZcNR5jOKWgKbZKSVpZUOV0bpnG3vi0YxWXUAmo1XXnp54tLL5p+dSyi52FlJRt625nwCavxlDyrgKlLjm5o9byPBkFr456IbkfmWq1t1FsMM1zx1q3RoBr4OmpT4F+jxxndGHrbZ4IXozs3RtP0Ks98R1ghDrvYz/4PfD6ti39Qix0leNh6H07siaL9ZJKYuKtA6lhSgKaC0sWwYATENlLSmVECIZTKcHZ167NtAI9gO6PzO/1ZRg6XPAFF91AJnKDES21NaYN26l8uVoLWyhSZhS/345kUj4/+Q9XjMPdBR/9wl6Qn3TjyWnzyW88i3Y5e92BmDx6tPAV35KjDnXftqHEQBhKDXZvxmA4p5NCJzH+mFg3rxzvXzn0ZN+5BUoW8p4YcxUbbZQ4nXyGEIfhrDt7MS6o/tEOm07Z48ArTPCMPYnEomewpgBeGl1HMQGN5SSk381hdsSNzwqag1tRbZdHY/HL8JoXJwfr24AXnVKK7rae/mpz3fs8aCQ1FqfxzTPxuPxf7243V9oOMESa4XOvqgDZtlIKTKVHpz4w6Ej+ZbUWlgIHdNStkYikbZoNGoNl1f4lQGM3V8us0tLfhmhvh6/98Tu0hN/XslVQ2uRlahOIWWrMozLsVgs7aQ7KmYAAnVb67PjSh+bDsKtHX9Ubmv4dQRaEiE6JLQHwuG21tbWjBvNwm+z+8hmU+/Iu8l5akwo8uA34/bg3+W1B088nKdhCK2vmFJemjV7dqyxsdHzyTZqKwMQ2r55bmpK+SktRABb2ZO+2//9E+djvcAthIgZ0P5aZ+eVzaAKoTeqZgCKt238LP10xYaxZy7tq/j5+E5Ms629vb0b0KOt/Z/GP4jqqfL5oxVsAAAAAElFTkSuQmCC\",\n    defaultOffset: [-25.5, -38]\n};\n\nexport default Marker;\n\n\n\n// WEBPACK FOOTER //\n// ./src/OpenLayers/Controls/Utils/Markers.js","import Logger from \"../Common/Utils/LoggerByDefault\";\n\n\nvar logger = Logger.getLogger(\"GlobeViewExtended\");\n\n/**\n * @classdesc\n *\n * Extended itowns.GlobeView.\n *\n * @constructor\n * @extends {itowns.GlobeView}\n */\nfunction GlobeViewExtended(viewerDiv, coordCarto, options) {\n\n    viewerDiv.style.position = \"relative\";\n\n    //itowns\n    var scope = typeof window !== \"undefined\" ? window : {};\n    this._itowns = scope.itowns;\n\n    // stockage de l'lment html porteur du globe\n    this._viewerDiv = viewerDiv;\n\n    // widget container\n    this._widgets = [];\n\n    // mapping des evenements\n    this._initEventMap();\n\n    // pour savoir si le globe est initialise\n    this._isInitialized = false;\n\n    // call constructor\n    this._globeView = new this._itowns.GlobeView(viewerDiv, coordCarto, options);\n\n    var self = this;\n    this.listen(GlobeViewExtended.EVENTS.GLOBE_INITIALIZED, function() {\n        self._isInitialized = true;\n    });\n\n    this._globeView.addFrameRequester(this._itowns.MAIN_LOOP_EVENTS.BEFORE_RENDER, (function() {\n        clearTimeout(this._preRenderTimer);\n        self._preRenderTimer = setTimeout(function() {\n            if (self._fetchVisibleColorLayers || self._fetchVisibleElevationLayers || self._fetchExtent) {\n\n                var event = {\n                    type: GlobeViewExtended.EVENTS.PRE_RENDER\n                };\n                if (self._fetchExtent) {\n                    event.extent = new self._itowns.Extent(\"EPSG:4326\", 180, -180, 90, -90);\n                }\n                if (self._fetchVisibleColorLayers) {\n                    event.colorLayersId = [];\n                }\n                if (self._fetchVisibleElevationLayers) {\n                    event.elevationLayersId = [];\n                }\n\n                self._getCurrentSceneInfos(self._globeView.scene, event);\n\n                self._globeView.dispatchEvent(event);\n            }\n        }, 100);\n    }).bind(this));\n\n    this.freezeControl();\n\n}\n\n/**\n * intializes the evenements map\n */\nGlobeViewExtended.prototype._initEventMap = function() {\n    if (!GlobeViewExtended.EVENTS) {\n        GlobeViewExtended.EVENTS = {\n            RANGE_CHANGED: this._itowns.CONTROL_EVENTS.RANGE_CHANGED,\n            CENTER_CHANGED: this._itowns.CONTROL_EVENTS.CAMERA_TARGET_CHANGED,\n            ORIENTATION_CHANGED: this._itowns.CONTROL_EVENTS.ORIENTATION_CHANGED,\n            LAYER_ADDED: this._itowns.GLOBE_VIEW_EVENTS.LAYER_ADDED,\n            LAYER_REMOVED: this._itowns.GLOBE_VIEW_EVENTS.LAYER_REMOVED,\n            LAYERS_ORDER_CHANGED: this._itowns.GLOBE_VIEW_EVENTS.COLOR_LAYERS_ORDER_CHANGED,\n            GLOBE_INITIALIZED: this._itowns.GLOBE_VIEW_EVENTS.GLOBE_INITIALIZED,\n            VIEW_INITIALIZED: \"viewinitialized\",\n            PRE_RENDER: \"prerender\",\n            MOUSE_MOVE: \"mousemove\",\n            AFTER_RENDER: this._itowns.MAIN_LOOP_EVENTS.AFTER_RENDER,\n            OPACITY_PROPERTY_CHANGED: \"opacity-property-changed\",\n            VISIBLE_PROPERTY_CHANGED: \"visible-property-changed\",\n            SEQUENCE_PROPERTY_CHANGED: \"sequence-property-changed\"\n        };\n    }\n};\n\n/**\n * Constructor (alias)\n */\nGlobeViewExtended.prototype.constructor = GlobeViewExtended;\n\n/**\n * Get GlobeViex Object (parent)\n */\nGlobeViewExtended.prototype.getGlobeView = function() {\n    return this._globeView;\n};\n\n/**\n * Indicates if the globe is initialized or not\n *\n * @return {Boolean} isInitialized\n *\n */\nGlobeViewExtended.prototype.isInitialized = function() {\n    return this._isInitialized;\n};\n\n/**\n * Disables globe controls until the globe rendering is completed\n */\nGlobeViewExtended.prototype.freezeControl = function() {\n    // disable navigation\n    this._globeView.controls.enabled = false;\n\n    var self = this;\n    /**\n     * afterRenderHandler function (duplicated code from itowns?)\n     */\n    var afterRenderHandlerFunction = function afterRenderHandler() {\n        if (self._globeView.mainLoop.scheduler.commandsWaitingExecutionCount() == 0 && self._globeView._changeSources.size == 0) {\n            // enable navigation\n            self._globeView.controls.enabled = true;\n            self._globeView.removeFrameRequester(self._itowns.MAIN_LOOP_EVENTS.AFTER_RENDER, afterRenderHandler);\n        }\n    };\n    this._globeView.addFrameRequester(this._itowns.MAIN_LOOP_EVENTS.AFTER_RENDER, afterRenderHandlerFunction);\n};\n\n/**\n * Associates a function to trigger when an event is received.\n *\n * @param {String} type - the event type. Can be any of {@link EVENTS}\n * @param {Function} callback - The function to execute when the event occures.\n * @return {Object} key - The event key\n *\n */\nGlobeViewExtended.prototype.listen = function(type, callback) {\n    if (typeof(callback) != \"function\") {\n        console.log(\"no callback provided for event : \" + type);\n        return null;\n    }\n\n    var target = this._getEventTarget(type);\n    if (!target) {\n        return null;\n    }\n\n    if (type === GlobeViewExtended.EVENTS.AFTER_RENDER) {\n        target.addFrameRequester(type, callback);\n    } else {\n        target.addEventListener(type, callback);\n    }\n\n    return {\n        target: target,\n        callback: callback,\n        type: type\n    };\n};\n\n/**\n * Associates a function to trigger when a layer event is received.\n *\n * @param {Object} layer - The itowns layer.\n * @param {String} type - the event type. Can be any of {@link EVENTS}.\n * @param {Function} callback - The function to execute when the event occures.\n * @return {Object} key - The event key\n *\n */\nGlobeViewExtended.prototype.addLayerListener = function(layer, type, callback) {\n    if (typeof(callback) != \"function\") {\n        console.log(\"no callback provided for event : \" + type);\n        return null;\n    }\n    layer.addEventListener(type, callback);\n    return {\n        target: layer,\n        callback: callback,\n        type: type\n    };\n};\n\n/**\n * Returns the target of a given event type\n *\n * @param {String} type - the event type. Can be any of {@link EVENTS}\n * @return {Object} target - The event target.\n *\n */\nGlobeViewExtended.prototype._getEventTarget = function(type) {\n    switch (type) {\n        case GlobeViewExtended.EVENTS.RANGE_CHANGED:\n        case GlobeViewExtended.EVENTS.CENTER_CHANGED:\n        case GlobeViewExtended.EVENTS.ORIENTATION_CHANGED:\n            return this.getGlobeView().controls;\n        case GlobeViewExtended.EVENTS.LAYER_ADDED:\n        case GlobeViewExtended.EVENTS.LAYER_REMOVED:\n        case GlobeViewExtended.EVENTS.LAYERS_ORDER_CHANGED:\n        case GlobeViewExtended.EVENTS.GLOBE_INITIALIZED:\n        case GlobeViewExtended.EVENTS.PRE_RENDER:\n        case GlobeViewExtended.EVENTS.AFTER_RENDER:\n        case GlobeViewExtended.EVENTS.VIEW_INITIALIZED:\n            return this.getGlobeView();\n        case GlobeViewExtended.EVENTS.MOUSE_MOVE:\n            return this._viewerDiv;\n        default:\n            console.log(\"unhandled event : \" + type);\n            return null;\n    }\n};\n\n/**\n * Cancels an event listening\n *\n * @param {Object} key - The event key.\n *\n */\nGlobeViewExtended.prototype.forgetByKey = function(key) {\n    if (key.type === GlobeViewExtended.EVENTS.AFTER_RENDER) {\n        key.target.removeFrameRequester(key.type, key.callback);\n    } else {\n        key.target.removeEventListener(key.type, key.callback);\n    }\n};\n\n/**\n * Cancels an layer event listening\n *\n * @param {Object} layer - The itowns layer.\n * @param {String} type - the event type.\n * @param {Function} callback - The function to execute when the event occures.\n *\n */\nGlobeViewExtended.prototype.removeLayerListener = function(layer, type, callback) {\n    this.forgetByKey({\n        target: layer,\n        callback: callback,\n        type: type\n    });\n};\n\n/**\n * Cancels an event listening\n *\n * @param {Object} type - The event type.\n *\n */\nGlobeViewExtended.prototype.forget = function(type, callback) {\n    var target = this._getEventTarget(type);\n    if (!target) {\n        return null;\n    }\n\n    this.forgetByKey({\n        target: target,\n        callback: callback,\n        type: type\n    });\n};\n\n/**\n * Overload itowns.GlobeView addLayer method\n */\nGlobeViewExtended.prototype.addLayer = function(layer) {\n    this.getGlobeView().addLayer(layer);\n    this.getGlobeView().notifyChange(true);\n};\n\n/**\n * Overload itowns.GlobeView removeLayer method\n */\nGlobeViewExtended.prototype.removeLayer = function(layerId) {\n    this.getGlobeView().removeLayer(layerId);\n    this.getGlobeView().notifyChange(true);\n};\n\n/**\n * Set layer opacity\n *\n * @param {String} layerId - Layer id\n * @param {Number} opacityValue - opacity value in [0 1]\n */\nGlobeViewExtended.prototype.setLayerOpacity = function(layerId, opacityValue) {\n    this.getColorLayerById(layerId).opacity = opacityValue;\n    this.getGlobeView().notifyChange(true);\n};\n\n/**\n * Set layer visibility\n *\n * @param {String} layerId - Layer id\n * @param {Boolean} visible - New visibility of the layer\n */\nGlobeViewExtended.prototype.setLayerVisibility = function(layerId, visible) {\n    this.getColorLayerById(layerId).visible = visible;\n    this.getGlobeView().notifyChange(true);\n};\n\n/**\n * Move layer to the specified index\n *\n * @param {String} layerId - Layer id\n * @param {Boolean} index - new index of the layer\n */\nGlobeViewExtended.prototype.moveLayerToIndex = function(layerId, index) {\n    this._itowns.ColorLayersOrdering.moveLayerToIndex(this.getGlobeView(), layerId, index);\n    this.getGlobeView().notifyChange(true);\n};\n\n/**\n * Remove event listener from the globe\n *\n * @param {String} type - event type\n * @param {Boolean} callback - event handler\n */\nGlobeViewExtended.prototype.removeEventListener = function(type, callback) {\n    switch (type) {\n        case \"mousemove\":\n            this._viewerDiv.removeEventListener(type, callback);\n            break;\n        case \"centerchanged\":\n            this.getGlobeView().controls.removeEventListener(type, callback);\n            break;\n        default:\n            this.getGlobeView().removeEventListener(type, callback);\n            break;\n    }\n};\n\n/**\n * Defines if the current view extent have to be computed on pre-render event\n */\nGlobeViewExtended.prototype.preRenderEventFetchViewExtent = function(b) {\n    if (typeof b === \"undefined\") {\n        b = true;\n    }\n    this._fetchExtent = b;\n};\n\n/**\n * Defines if the list of the color layers displayed have to be computed on pre-render event\n */\nGlobeViewExtended.prototype.preRenderEventFetchColorLayersDisplayed = function(b) {\n    if (typeof b === \"undefined\") {\n        b = true;\n    }\n    this._fetchVisibleColorLayers = b;\n};\n\n/**\n * Defines if the list of the elevation layers displayed have to be computed on pre-render event\n */\nGlobeViewExtended.prototype.preRenderEventFetchElevationLayersDisplayed = function(b) {\n    if (typeof b === \"undefined\") {\n        b = true;\n    }\n    this._fetchVisibleElevationLayers = b;\n};\n\n/**\n * Defines if the list of the layers of all types displayed have to be computed on pre-render event\n */\nGlobeViewExtended.prototype.preRenderEventFetchLayersDisplayed = function(b) {\n    if (typeof b === \"undefined\") {\n        b = true;\n    }\n    this._fetchVisibleColorLayers = b;\n    this._fetchVisibleElevationLayers = b;\n};\n\n/**\n * Get layer by its id\n *\n * @param {String} layerId - Layer id\n * @return {Object} layer Object\n */\nGlobeViewExtended.prototype.getLayerById = function(layerId) {\n    var layer = this.getGlobeView().getLayers(function(l) {\n        if (l.id === layerId) {\n            return l;\n        }\n    })[0];\n    if (!layer) {\n        logger.trace(\"[GlobeViewExtended]  : no Layer found for the id '\" + layerId + \"'\");\n        return;\n    }\n    return layer;\n};\n\n/**\n * Get color layer by its id\n *\n * @param {String} layerId - Color layer id\n * @return {Object} layer Object\n */\nGlobeViewExtended.prototype.getColorLayerById = function(layerId) {\n    var layer = this.getGlobeView().getLayers(function(l) {\n        if (l.id === layerId && l.type === \"color\") {\n            return l;\n        }\n    })[0];\n    if (!layer) {\n        logger.trace(\"[GlobeViewExtended]  : no colorLayer found for the id '\" + layerId + \"'\");\n        return;\n    }\n    return layer;\n};\n\n/**\n * Get imagery layers\n *\n * @return {Array} imagery layers\n */\nGlobeViewExtended.prototype.getColorLayers = function() {\n    return this.getGlobeView().getLayers(function(layer) {\n        if (layer.type === \"color\") {\n            return layer;\n        }\n    });\n};\n\n/**\n * Get vector layers\n *\n * @return {Array} vector layers\n */\nGlobeViewExtended.prototype.getVectorLayers = function() {\n    return this.getGlobeView().getLayers(function(layer) {\n        if (layer.protocol === \"rasterizer\") {\n            return layer;\n        }\n    });\n};\n\n/**\n * Get elevation layers\n *\n * @return {Array} elevation layers\n */\nGlobeViewExtended.prototype.getElevationLayers = function() {\n    return this.getGlobeView().getLayers(function(layer) {\n        if (layer.type === \"elevation\") {\n            return layer;\n        }\n    });\n};\n\n/**\n * Get the current view extent\n *\n * @return {Array} current view extent\n */\nGlobeViewExtended.prototype.getExtent = function() {\n    var options = {\n        extent: new this._itowns.Extent(\"EPSG:4326\", 180, -180, 90, -90)\n    };\n\n    this._getCurrentSceneInfos(this.scene, options);\n\n    return options.extent;\n};\n\n/**\n * Recursive method to fetch information about the current view (extent, layers displayed...)\n *\n * @private\n */\nGlobeViewExtended.prototype._getCurrentSceneInfos = function(node, options) {\n    if (!node || !node.visible) {\n        return;\n    }\n    if (node.level) {\n        if (node.material.visible) {\n            if (options.colorLayersId) {\n                for (var i = 0; i < node.material.colorLayersId.length; ++i) {\n                    if (options.colorLayersId.indexOf(node.material.colorLayersId[i]) < 0) {\n                        options.colorLayersId.push(node.material.colorLayersId[i]);\n                    }\n                }\n            }\n            if (options.elevationLayersId) {\n                for (var j = 0; j < node.material.elevationLayersId.length; ++j) {\n                    if (options.elevationLayersId.indexOf(node.material.elevationLayersId[j]) < 0) {\n                        options.elevationLayersId.push(node.material.elevationLayersId[j]);\n                    }\n                }\n            }\n            if (options.extent) {\n                options.extent.union(node.extent);\n            }\n        }\n    }\n    if (node.children) {\n        for (var child in node.children) {\n            this._getCurrentSceneInfos(node.children[child], options);\n        }\n    }\n};\n\n/**\n * Add a widget to the globe\n *\n * @param {Object} widget - The Widget object to add\n */\nGlobeViewExtended.prototype.addWidget = function(widget) {\n    if (!widget.getTarget()) {\n        widget.setTarget(this._viewerDiv, \"absolute\");\n    }\n    widget.setGlobe(this);\n    this._widgets.push(widget);\n};\n\n/**\n * Returns all widgets.\n *\n * @return {Array} widgets - The array of widgets.\n */\nGlobeViewExtended.prototype.getWidgets = function() {\n    return this._widgets;\n};\n\n/**\n * Removes a widget.\n *\n * @param {Object} widget - The Widget object to remove\n */\nGlobeViewExtended.prototype.removeWidget = function(widget) {\n    widget.setGlobe();\n    for (var idx = 0; idx < this._widgets.length; idx++) {\n        if (this._widgets[idx] === widget) {\n            this._widgets.splice(idx, 1);\n        }\n    }\n\n};\n\n/**\n * Get html target element\n *\n * @return {HTMLElement} Globe container element\n */\nGlobeViewExtended.prototype.getTargetElement = function() {\n    return this._viewerDiv;\n};\n\n/**\n * Returns current view scale\n *\n * @return {Number} Scale\n */\nGlobeViewExtended.prototype.getScale = function() {\n    return this.getGlobeView().controls.getScale();\n};\n\n/**\n * Sets tilt\n *\n * @param {Number} tilt - Tilt value\n */\nGlobeViewExtended.prototype.setTilt = function(tilt) {\n    this.getGlobeView().controls.setTilt(tilt, false);\n};\n\n/**\n * Returns tilt\n *\n * @return {Number} - Tilt\n */\nGlobeViewExtended.prototype.getTilt = function() {\n    return this.getGlobeView().controls.getCameraOrientation()[0];\n};\n\n/**\n * Sets azimuth\n *\n * @param {Number} azimuth - Azimuth value\n */\nGlobeViewExtended.prototype.setAzimuth = function(azimuth) {\n    this.getGlobeView().controls.setHeading(azimuth, false);\n};\n\n/**\n * Returns azimuth\n *\n * @return {Number} azimuth\n */\nGlobeViewExtended.prototype.getAzimuth = function() {\n    return this.getGlobeView().controls.getCameraOrientation()[1];\n};\n\n/**\n * Gets the coordinate in lat,lon for a given pixel.\n *\n * @param {Number} x - The pixel x-position inside the Globe element.\n * @param {Number} y - The pixel y-position inside the Globe element.\n * @return {Coordinates} position\n */\nGlobeViewExtended.prototype.getCoordinateFromPixel = function(x, y) {\n    return this.getGlobeView().controls.pickGeoPosition({\n        x: x,\n        y: y\n    });\n};\n\n/**\n * Gets the coordinate in lat,lon for a given mouse position.\n *\n * @param {MouseEvent} mouseEvent - A mouse event.\n * @return {Coordinates} position\n */\nGlobeViewExtended.prototype.getCoordinateFromMouseEvent = function(mouseEvent) {\n    var coords = this.getGlobeView().eventToViewCoords(mouseEvent);\n    return this.getGlobeView().controls.pickGeoPosition(coords);\n};\n\n/**\n * Get all visible features that intersect a pixel\n *\n * @param {MouseEvent} mouseEvent - A mouse event.\n * @return {Array} visibleFeatures - The array of visible features.\n */\nGlobeViewExtended.prototype.getFeaturesAtMousePosition = function(mouseEvent) {\n    var vectorLayers = this.getVectorLayers();\n    if (!vectorLayers) {\n        return;\n    }\n    // array of the visible features on the clicker coord\n    var visibleFeatures = [];\n    var geoCoord = this.getCoordinateFromMouseEvent(mouseEvent);\n    if (geoCoord) {\n        // buffer around the click inside we retrieve the features\n        var precision = this.getGlobeView().controls.pixelsToDegrees(5);\n        for (var i = 0; i < vectorLayers.length; i++) {\n            var idx;\n            var layer = vectorLayers[i];\n            // if the layer is not visible, we ignore it\n            if (!layer.visible) {\n                continue;\n            }\n            var result = this._itowns.FeaturesUtils.filterFeaturesUnderCoordinate(geoCoord, layer.feature, precision);\n            // we add the features to the visible features array\n            for (idx = 0; idx < result.length; idx++) {\n                visibleFeatures.push(result[idx]);\n            }\n        }\n    }\n    return visibleFeatures;\n};\n\n/**\n * Changes the center of the scene on screen to the specified in lat, lon.\n *\n * @param {Object} center - Center object\n * @param {Number} center.longitude - Coordinate longitude WGS84 in degree\n * @param {Number} center.latitude - Coordinate latitude WGS84 in degree\n */\nGlobeViewExtended.prototype.setCameraTargetGeoPosition = function(center) {\n    this.getGlobeView().controls.setCameraTargetGeoPositionAdvanced(center, false);\n};\n\n/**\n * Retuns the coordinates of the central point on screen in lat,lon and alt\n *\n * @return {Object} center\n */\nGlobeViewExtended.prototype.getCenter = function() {\n    var cameraCenter = this.getGlobeView().controls.getCameraTargetGeoPosition();\n    var center = {\n        lon: cameraCenter.longitude(),\n        lat: cameraCenter.latitude(),\n        alt: cameraCenter.altitude()\n    };\n    return center;\n};\n\n/**\n * Returns the actual zoom.\n *\n * @return {Number} zoom\n */\nGlobeViewExtended.prototype.getZoom = function() {\n    return this.getGlobeView().controls.getZoom();\n};\n\n/**\n * Sets the current zoom.\n *\n * @param {Number} zoom - The zoom\n */\nGlobeViewExtended.prototype.setZoom = function(zoom) {\n    this.getGlobeView().controls.setZoom(zoom, false);\n};\n\n/**\n * To convert the projection in meters on the globe of a number of pixels of screen\n * @param {Number} pixels - count pixels to project\n * @return {Number} projection in meters on globe\n */\nGlobeViewExtended.prototype.pixelsToMeters = function(pixels) {\n    return this.getGlobeView().controls.pixelsToMeters(pixels);\n};\n\n/**\n * Projection on screen in pixels of length in meter on globe\n * @param {Number} value - Length in meter on globe\n * @return {Number} projection in pixels on screen\n */\nGlobeViewExtended.prototype.metersToPixels = function(value) {\n    return this.getGlobeView().controls.metersToPixels(value);\n};\n\n/**\n * Returns the \"range\": the distance in meters between the camera and the current central point on the screen.\n * @return {Number} number\n */\nGlobeViewExtended.prototype.getRange = function() {\n    return this.getGlobeView().controls.getRange();\n};\n\n/**\n * @return {THREE.Vector3} position\n */\nGlobeViewExtended.prototype.moveTarget = function() {\n    return this.getGlobeView().controls.moveTarget();\n};\n\n/**\n * To get the layer event infos\n */\nGlobeViewExtended.prototype.getLayerEventInfos = function(evt) {\n    var propertyName = evt.type.replace(\"-property-changed\", \"\");\n    return {\n        propertyName: propertyName,\n        previousValue: evt.previous[propertyName],\n        newValue: evt.new[propertyName]\n    };\n};\n\nexport default GlobeViewExtended;\n\n\n\n// WEBPACK FOOTER //\n// ./src/Itowns/GlobeViewExtended.js","(function (global, factory) {\n\ttypeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() :\n\ttypeof define === 'function' && define.amd ? define(factory) :\n\t(global.proj4 = factory());\n}(this, (function () { 'use strict';\n\n\tvar globals = function(defs) {\n\t  defs('EPSG:4326', \"+title=WGS 84 (long/lat) +proj=longlat +ellps=WGS84 +datum=WGS84 +units=degrees\");\n\t  defs('EPSG:4269', \"+title=NAD83 (long/lat) +proj=longlat +a=6378137.0 +b=6356752.31414036 +ellps=GRS80 +datum=NAD83 +units=degrees\");\n\t  defs('EPSG:3857', \"+title=WGS 84 / Pseudo-Mercator +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +no_defs\");\n\n\t  defs.WGS84 = defs['EPSG:4326'];\n\t  defs['EPSG:3785'] = defs['EPSG:3857']; // maintain backward compat, official code is 3857\n\t  defs.GOOGLE = defs['EPSG:3857'];\n\t  defs['EPSG:900913'] = defs['EPSG:3857'];\n\t  defs['EPSG:102113'] = defs['EPSG:3857'];\n\t};\n\n\tvar PJD_3PARAM = 1;\n\tvar PJD_7PARAM = 2;\n\tvar PJD_WGS84 = 4; // WGS84 or equivalent\n\tvar PJD_NODATUM = 5; // WGS84 or equivalent\n\tvar SEC_TO_RAD = 4.84813681109535993589914102357e-6;\n\tvar HALF_PI = Math.PI/2;\n\t// ellipoid pj_set_ell.c\n\tvar SIXTH = 0.1666666666666666667;\n\t/* 1/6 */\n\tvar RA4 = 0.04722222222222222222;\n\t/* 17/360 */\n\tvar RA6 = 0.02215608465608465608;\n\tvar EPSLN = 1.0e-10;\n\t// you'd think you could use Number.EPSILON above but that makes\n\t// Mollweide get into an infinate loop.\n\n\tvar D2R = 0.01745329251994329577;\n\tvar R2D = 57.29577951308232088;\n\tvar FORTPI = Math.PI/4;\n\tvar TWO_PI = Math.PI * 2;\n\t// SPI is slightly greater than Math.PI, so values that exceed the -180..180\n\t// degree range by a tiny amount don't get wrapped. This prevents points that\n\t// have drifted from their original location along the 180th meridian (due to\n\t// floating point error) from changing their sign.\n\tvar SPI = 3.14159265359;\n\n\tvar exports$1 = {};\n\texports$1.greenwich = 0.0; //\"0dE\",\n\texports$1.lisbon = -9.131906111111; //\"9d07'54.862\\\"W\",\n\texports$1.paris = 2.337229166667; //\"2d20'14.025\\\"E\",\n\texports$1.bogota = -74.080916666667; //\"74d04'51.3\\\"W\",\n\texports$1.madrid = -3.687938888889; //\"3d41'16.58\\\"W\",\n\texports$1.rome = 12.452333333333; //\"12d27'8.4\\\"E\",\n\texports$1.bern = 7.439583333333; //\"7d26'22.5\\\"E\",\n\texports$1.jakarta = 106.807719444444; //\"106d48'27.79\\\"E\",\n\texports$1.ferro = -17.666666666667; //\"17d40'W\",\n\texports$1.brussels = 4.367975; //\"4d22'4.71\\\"E\",\n\texports$1.stockholm = 18.058277777778; //\"18d3'29.8\\\"E\",\n\texports$1.athens = 23.7163375; //\"23d42'58.815\\\"E\",\n\texports$1.oslo = 10.722916666667; //\"10d43'22.5\\\"E\"\n\n\tvar units = {\n\t  ft: {to_meter: 0.3048},\n\t  'us-ft': {to_meter: 1200 / 3937}\n\t};\n\n\tvar ignoredChar = /[\\s_\\-\\/\\(\\)]/g;\n\tfunction match(obj, key) {\n\t  if (obj[key]) {\n\t    return obj[key];\n\t  }\n\t  var keys = Object.keys(obj);\n\t  var lkey = key.toLowerCase().replace(ignoredChar, '');\n\t  var i = -1;\n\t  var testkey, processedKey;\n\t  while (++i < keys.length) {\n\t    testkey = keys[i];\n\t    processedKey = testkey.toLowerCase().replace(ignoredChar, '');\n\t    if (processedKey === lkey) {\n\t      return obj[testkey];\n\t    }\n\t  }\n\t}\n\n\tvar parseProj = function(defData) {\n\t  var self = {};\n\t  var paramObj = defData.split('+').map(function(v) {\n\t    return v.trim();\n\t  }).filter(function(a) {\n\t    return a;\n\t  }).reduce(function(p, a) {\n\t    var split = a.split('=');\n\t    split.push(true);\n\t    p[split[0].toLowerCase()] = split[1];\n\t    return p;\n\t  }, {});\n\t  var paramName, paramVal, paramOutname;\n\t  var params = {\n\t    proj: 'projName',\n\t    datum: 'datumCode',\n\t    rf: function(v) {\n\t      self.rf = parseFloat(v);\n\t    },\n\t    lat_0: function(v) {\n\t      self.lat0 = v * D2R;\n\t    },\n\t    lat_1: function(v) {\n\t      self.lat1 = v * D2R;\n\t    },\n\t    lat_2: function(v) {\n\t      self.lat2 = v * D2R;\n\t    },\n\t    lat_ts: function(v) {\n\t      self.lat_ts = v * D2R;\n\t    },\n\t    lon_0: function(v) {\n\t      self.long0 = v * D2R;\n\t    },\n\t    lon_1: function(v) {\n\t      self.long1 = v * D2R;\n\t    },\n\t    lon_2: function(v) {\n\t      self.long2 = v * D2R;\n\t    },\n\t    alpha: function(v) {\n\t      self.alpha = parseFloat(v) * D2R;\n\t    },\n\t    lonc: function(v) {\n\t      self.longc = v * D2R;\n\t    },\n\t    x_0: function(v) {\n\t      self.x0 = parseFloat(v);\n\t    },\n\t    y_0: function(v) {\n\t      self.y0 = parseFloat(v);\n\t    },\n\t    k_0: function(v) {\n\t      self.k0 = parseFloat(v);\n\t    },\n\t    k: function(v) {\n\t      self.k0 = parseFloat(v);\n\t    },\n\t    a: function(v) {\n\t      self.a = parseFloat(v);\n\t    },\n\t    b: function(v) {\n\t      self.b = parseFloat(v);\n\t    },\n\t    r_a: function() {\n\t      self.R_A = true;\n\t    },\n\t    zone: function(v) {\n\t      self.zone = parseInt(v, 10);\n\t    },\n\t    south: function() {\n\t      self.utmSouth = true;\n\t    },\n\t    towgs84: function(v) {\n\t      self.datum_params = v.split(\",\").map(function(a) {\n\t        return parseFloat(a);\n\t      });\n\t    },\n\t    to_meter: function(v) {\n\t      self.to_meter = parseFloat(v);\n\t    },\n\t    units: function(v) {\n\t      self.units = v;\n\t      var unit = match(units, v);\n\t      if (unit) {\n\t        self.to_meter = unit.to_meter;\n\t      }\n\t    },\n\t    from_greenwich: function(v) {\n\t      self.from_greenwich = v * D2R;\n\t    },\n\t    pm: function(v) {\n\t      var pm = match(exports$1, v);\n\t      self.from_greenwich = (pm ? pm : parseFloat(v)) * D2R;\n\t    },\n\t    nadgrids: function(v) {\n\t      if (v === '@null') {\n\t        self.datumCode = 'none';\n\t      }\n\t      else {\n\t        self.nadgrids = v;\n\t      }\n\t    },\n\t    axis: function(v) {\n\t      var legalAxis = \"ewnsud\";\n\t      if (v.length === 3 && legalAxis.indexOf(v.substr(0, 1)) !== -1 && legalAxis.indexOf(v.substr(1, 1)) !== -1 && legalAxis.indexOf(v.substr(2, 1)) !== -1) {\n\t        self.axis = v;\n\t      }\n\t    }\n\t  };\n\t  for (paramName in paramObj) {\n\t    paramVal = paramObj[paramName];\n\t    if (paramName in params) {\n\t      paramOutname = params[paramName];\n\t      if (typeof paramOutname === 'function') {\n\t        paramOutname(paramVal);\n\t      }\n\t      else {\n\t        self[paramOutname] = paramVal;\n\t      }\n\t    }\n\t    else {\n\t      self[paramName] = paramVal;\n\t    }\n\t  }\n\t  if(typeof self.datumCode === 'string' && self.datumCode !== \"WGS84\"){\n\t    self.datumCode = self.datumCode.toLowerCase();\n\t  }\n\t  return self;\n\t};\n\n\tvar NEUTRAL = 1;\n\tvar KEYWORD = 2;\n\tvar NUMBER = 3;\n\tvar QUOTED = 4;\n\tvar AFTERQUOTE = 5;\n\tvar ENDED = -1;\n\tvar whitespace = /\\s/;\n\tvar latin = /[A-Za-z]/;\n\tvar keyword = /[A-Za-z84]/;\n\tvar endThings = /[,\\]]/;\n\tvar digets = /[\\d\\.E\\-\\+]/;\n\t// const ignoredChar = /[\\s_\\-\\/\\(\\)]/g;\n\tfunction Parser(text) {\n\t  if (typeof text !== 'string') {\n\t    throw new Error('not a string');\n\t  }\n\t  this.text = text.trim();\n\t  this.level = 0;\n\t  this.place = 0;\n\t  this.root = null;\n\t  this.stack = [];\n\t  this.currentObject = null;\n\t  this.state = NEUTRAL;\n\t}\n\tParser.prototype.readCharicter = function() {\n\t  var char = this.text[this.place++];\n\t  if (this.state !== QUOTED) {\n\t    while (whitespace.test(char)) {\n\t      if (this.place >= this.text.length) {\n\t        return;\n\t      }\n\t      char = this.text[this.place++];\n\t    }\n\t  }\n\t  switch (this.state) {\n\t    case NEUTRAL:\n\t      return this.neutral(char);\n\t    case KEYWORD:\n\t      return this.keyword(char)\n\t    case QUOTED:\n\t      return this.quoted(char);\n\t    case AFTERQUOTE:\n\t      return this.afterquote(char);\n\t    case NUMBER:\n\t      return this.number(char);\n\t    case ENDED:\n\t      return;\n\t  }\n\t};\n\tParser.prototype.afterquote = function(char) {\n\t  if (char === '\"') {\n\t    this.word += '\"';\n\t    this.state = QUOTED;\n\t    return;\n\t  }\n\t  if (endThings.test(char)) {\n\t    this.word = this.word.trim();\n\t    this.afterItem(char);\n\t    return;\n\t  }\n\t  throw new Error('havn\\'t handled \"' +char + '\" in afterquote yet, index ' + this.place);\n\t};\n\tParser.prototype.afterItem = function(char) {\n\t  if (char === ',') {\n\t    if (this.word !== null) {\n\t      this.currentObject.push(this.word);\n\t    }\n\t    this.word = null;\n\t    this.state = NEUTRAL;\n\t    return;\n\t  }\n\t  if (char === ']') {\n\t    this.level--;\n\t    if (this.word !== null) {\n\t      this.currentObject.push(this.word);\n\t      this.word = null;\n\t    }\n\t    this.state = NEUTRAL;\n\t    this.currentObject = this.stack.pop();\n\t    if (!this.currentObject) {\n\t      this.state = ENDED;\n\t    }\n\n\t    return;\n\t  }\n\t};\n\tParser.prototype.number = function(char) {\n\t  if (digets.test(char)) {\n\t    this.word += char;\n\t    return;\n\t  }\n\t  if (endThings.test(char)) {\n\t    this.word = parseFloat(this.word);\n\t    this.afterItem(char);\n\t    return;\n\t  }\n\t  throw new Error('havn\\'t handled \"' +char + '\" in number yet, index ' + this.place);\n\t};\n\tParser.prototype.quoted = function(char) {\n\t  if (char === '\"') {\n\t    this.state = AFTERQUOTE;\n\t    return;\n\t  }\n\t  this.word += char;\n\t  return;\n\t};\n\tParser.prototype.keyword = function(char) {\n\t  if (keyword.test(char)) {\n\t    this.word += char;\n\t    return;\n\t  }\n\t  if (char === '[') {\n\t    var newObjects = [];\n\t    newObjects.push(this.word);\n\t    this.level++;\n\t    if (this.root === null) {\n\t      this.root = newObjects;\n\t    } else {\n\t      this.currentObject.push(newObjects);\n\t    }\n\t    this.stack.push(this.currentObject);\n\t    this.currentObject = newObjects;\n\t    this.state = NEUTRAL;\n\t    return;\n\t  }\n\t  if (endThings.test(char)) {\n\t    this.afterItem(char);\n\t    return;\n\t  }\n\t  throw new Error('havn\\'t handled \"' +char + '\" in keyword yet, index ' + this.place);\n\t};\n\tParser.prototype.neutral = function(char) {\n\t  if (latin.test(char)) {\n\t    this.word = char;\n\t    this.state = KEYWORD;\n\t    return;\n\t  }\n\t  if (char === '\"') {\n\t    this.word = '';\n\t    this.state = QUOTED;\n\t    return;\n\t  }\n\t  if (digets.test(char)) {\n\t    this.word = char;\n\t    this.state = NUMBER;\n\t    return;\n\t  }\n\t  if (endThings.test(char)) {\n\t    this.afterItem(char);\n\t    return;\n\t  }\n\t  throw new Error('havn\\'t handled \"' +char + '\" in neutral yet, index ' + this.place);\n\t};\n\tParser.prototype.output = function() {\n\t  while (this.place < this.text.length) {\n\t    this.readCharicter();\n\t  }\n\t  if (this.state === ENDED) {\n\t    return this.root;\n\t  }\n\t  throw new Error('unable to parse string \"' +this.text + '\". State is ' + this.state);\n\t};\n\n\tfunction parseString(txt) {\n\t  var parser = new Parser(txt);\n\t  return parser.output();\n\t}\n\n\tfunction mapit(obj, key, value) {\n\t  if (Array.isArray(key)) {\n\t    value.unshift(key);\n\t    key = null;\n\t  }\n\t  var thing = key ? {} : obj;\n\n\t  var out = value.reduce(function(newObj, item) {\n\t    sExpr(item, newObj);\n\t    return newObj\n\t  }, thing);\n\t  if (key) {\n\t    obj[key] = out;\n\t  }\n\t}\n\n\tfunction sExpr(v, obj) {\n\t  if (!Array.isArray(v)) {\n\t    obj[v] = true;\n\t    return;\n\t  }\n\t  var key = v.shift();\n\t  if (key === 'PARAMETER') {\n\t    key = v.shift();\n\t  }\n\t  if (v.length === 1) {\n\t    if (Array.isArray(v[0])) {\n\t      obj[key] = {};\n\t      sExpr(v[0], obj[key]);\n\t      return;\n\t    }\n\t    obj[key] = v[0];\n\t    return;\n\t  }\n\t  if (!v.length) {\n\t    obj[key] = true;\n\t    return;\n\t  }\n\t  if (key === 'TOWGS84') {\n\t    obj[key] = v;\n\t    return;\n\t  }\n\t  if (!Array.isArray(key)) {\n\t    obj[key] = {};\n\t  }\n\n\t  var i;\n\t  switch (key) {\n\t    case 'UNIT':\n\t    case 'PRIMEM':\n\t    case 'VERT_DATUM':\n\t      obj[key] = {\n\t        name: v[0].toLowerCase(),\n\t        convert: v[1]\n\t      };\n\t      if (v.length === 3) {\n\t        sExpr(v[2], obj[key]);\n\t      }\n\t      return;\n\t    case 'SPHEROID':\n\t    case 'ELLIPSOID':\n\t      obj[key] = {\n\t        name: v[0],\n\t        a: v[1],\n\t        rf: v[2]\n\t      };\n\t      if (v.length === 4) {\n\t        sExpr(v[3], obj[key]);\n\t      }\n\t      return;\n\t    case 'PROJECTEDCRS':\n\t    case 'PROJCRS':\n\t    case 'GEOGCS':\n\t    case 'GEOCCS':\n\t    case 'PROJCS':\n\t    case 'LOCAL_CS':\n\t    case 'GEODCRS':\n\t    case 'GEODETICCRS':\n\t    case 'GEODETICDATUM':\n\t    case 'EDATUM':\n\t    case 'ENGINEERINGDATUM':\n\t    case 'VERT_CS':\n\t    case 'VERTCRS':\n\t    case 'VERTICALCRS':\n\t    case 'COMPD_CS':\n\t    case 'COMPOUNDCRS':\n\t    case 'ENGINEERINGCRS':\n\t    case 'ENGCRS':\n\t    case 'FITTED_CS':\n\t    case 'LOCAL_DATUM':\n\t    case 'DATUM':\n\t      v[0] = ['name', v[0]];\n\t      mapit(obj, key, v);\n\t      return;\n\t    default:\n\t      i = -1;\n\t      while (++i < v.length) {\n\t        if (!Array.isArray(v[i])) {\n\t          return sExpr(v, obj[key]);\n\t        }\n\t      }\n\t      return mapit(obj, key, v);\n\t  }\n\t}\n\n\tvar D2R$1 = 0.01745329251994329577;\n\tfunction rename(obj, params) {\n\t  var outName = params[0];\n\t  var inName = params[1];\n\t  if (!(outName in obj) && (inName in obj)) {\n\t    obj[outName] = obj[inName];\n\t    if (params.length === 3) {\n\t      obj[outName] = params[2](obj[outName]);\n\t    }\n\t  }\n\t}\n\n\tfunction d2r(input) {\n\t  return input * D2R$1;\n\t}\n\n\tfunction cleanWKT(wkt) {\n\t  if (wkt.type === 'GEOGCS') {\n\t    wkt.projName = 'longlat';\n\t  } else if (wkt.type === 'LOCAL_CS') {\n\t    wkt.projName = 'identity';\n\t    wkt.local = true;\n\t  } else {\n\t    if (typeof wkt.PROJECTION === 'object') {\n\t      wkt.projName = Object.keys(wkt.PROJECTION)[0];\n\t    } else {\n\t      wkt.projName = wkt.PROJECTION;\n\t    }\n\t  }\n\t  if (wkt.UNIT) {\n\t    wkt.units = wkt.UNIT.name.toLowerCase();\n\t    if (wkt.units === 'metre') {\n\t      wkt.units = 'meter';\n\t    }\n\t    if (wkt.UNIT.convert) {\n\t      if (wkt.type === 'GEOGCS') {\n\t        if (wkt.DATUM && wkt.DATUM.SPHEROID) {\n\t          wkt.to_meter = wkt.UNIT.convert*wkt.DATUM.SPHEROID.a;\n\t        }\n\t      } else {\n\t        wkt.to_meter = wkt.UNIT.convert, 10;\n\t      }\n\t    }\n\t  }\n\t  var geogcs = wkt.GEOGCS;\n\t  if (wkt.type === 'GEOGCS') {\n\t    geogcs = wkt;\n\t  }\n\t  if (geogcs) {\n\t    //if(wkt.GEOGCS.PRIMEM&&wkt.GEOGCS.PRIMEM.convert){\n\t    //  wkt.from_greenwich=wkt.GEOGCS.PRIMEM.convert*D2R;\n\t    //}\n\t    if (geogcs.DATUM) {\n\t      wkt.datumCode = geogcs.DATUM.name.toLowerCase();\n\t    } else {\n\t      wkt.datumCode = geogcs.name.toLowerCase();\n\t    }\n\t    if (wkt.datumCode.slice(0, 2) === 'd_') {\n\t      wkt.datumCode = wkt.datumCode.slice(2);\n\t    }\n\t    if (wkt.datumCode === 'new_zealand_geodetic_datum_1949' || wkt.datumCode === 'new_zealand_1949') {\n\t      wkt.datumCode = 'nzgd49';\n\t    }\n\t    if (wkt.datumCode === 'wgs_1984') {\n\t      if (wkt.PROJECTION === 'Mercator_Auxiliary_Sphere') {\n\t        wkt.sphere = true;\n\t      }\n\t      wkt.datumCode = 'wgs84';\n\t    }\n\t    if (wkt.datumCode.slice(-6) === '_ferro') {\n\t      wkt.datumCode = wkt.datumCode.slice(0, - 6);\n\t    }\n\t    if (wkt.datumCode.slice(-8) === '_jakarta') {\n\t      wkt.datumCode = wkt.datumCode.slice(0, - 8);\n\t    }\n\t    if (~wkt.datumCode.indexOf('belge')) {\n\t      wkt.datumCode = 'rnb72';\n\t    }\n\t    if (geogcs.DATUM && geogcs.DATUM.SPHEROID) {\n\t      wkt.ellps = geogcs.DATUM.SPHEROID.name.replace('_19', '').replace(/[Cc]larke\\_18/, 'clrk');\n\t      if (wkt.ellps.toLowerCase().slice(0, 13) === 'international') {\n\t        wkt.ellps = 'intl';\n\t      }\n\n\t      wkt.a = geogcs.DATUM.SPHEROID.a;\n\t      wkt.rf = parseFloat(geogcs.DATUM.SPHEROID.rf, 10);\n\t    }\n\t    if (~wkt.datumCode.indexOf('osgb_1936')) {\n\t      wkt.datumCode = 'osgb36';\n\t    }\n\t    if (~wkt.datumCode.indexOf('osni_1952')) {\n\t      wkt.datumCode = 'osni52';\n\t    }\n\t    if (~wkt.datumCode.indexOf('tm65')\n\t      || ~wkt.datumCode.indexOf('geodetic_datum_of_1965')) {\n\t      wkt.datumCode = 'ire65';\n\t    }\n\t  }\n\t  if (wkt.b && !isFinite(wkt.b)) {\n\t    wkt.b = wkt.a;\n\t  }\n\n\t  function toMeter(input) {\n\t    var ratio = wkt.to_meter || 1;\n\t    return input * ratio;\n\t  }\n\t  var renamer = function(a) {\n\t    return rename(wkt, a);\n\t  };\n\t  var list = [\n\t    ['standard_parallel_1', 'Standard_Parallel_1'],\n\t    ['standard_parallel_2', 'Standard_Parallel_2'],\n\t    ['false_easting', 'False_Easting'],\n\t    ['false_northing', 'False_Northing'],\n\t    ['central_meridian', 'Central_Meridian'],\n\t    ['latitude_of_origin', 'Latitude_Of_Origin'],\n\t    ['latitude_of_origin', 'Central_Parallel'],\n\t    ['scale_factor', 'Scale_Factor'],\n\t    ['k0', 'scale_factor'],\n\t    ['latitude_of_center', 'Latitude_of_center'],\n\t    ['lat0', 'latitude_of_center', d2r],\n\t    ['longitude_of_center', 'Longitude_Of_Center'],\n\t    ['longc', 'longitude_of_center', d2r],\n\t    ['x0', 'false_easting', toMeter],\n\t    ['y0', 'false_northing', toMeter],\n\t    ['long0', 'central_meridian', d2r],\n\t    ['lat0', 'latitude_of_origin', d2r],\n\t    ['lat0', 'standard_parallel_1', d2r],\n\t    ['lat1', 'standard_parallel_1', d2r],\n\t    ['lat2', 'standard_parallel_2', d2r],\n\t    ['alpha', 'azimuth', d2r],\n\t    ['srsCode', 'name']\n\t  ];\n\t  list.forEach(renamer);\n\t  if (!wkt.long0 && wkt.longc && (wkt.projName === 'Albers_Conic_Equal_Area' || wkt.projName === 'Lambert_Azimuthal_Equal_Area')) {\n\t    wkt.long0 = wkt.longc;\n\t  }\n\t  if (!wkt.lat_ts && wkt.lat1 && (wkt.projName === 'Stereographic_South_Pole' || wkt.projName === 'Polar Stereographic (variant B)')) {\n\t    wkt.lat0 = d2r(wkt.lat1 > 0 ? 90 : -90);\n\t    wkt.lat_ts = wkt.lat1;\n\t  }\n\t}\n\tvar wkt = function(wkt) {\n\t  var lisp = parseString(wkt);\n\t  var type = lisp.shift();\n\t  var name = lisp.shift();\n\t  lisp.unshift(['name', name]);\n\t  lisp.unshift(['type', type]);\n\t  var obj = {};\n\t  sExpr(lisp, obj);\n\t  cleanWKT(obj);\n\t  return obj;\n\t};\n\n\tfunction defs(name) {\n\t  /*global console*/\n\t  var that = this;\n\t  if (arguments.length === 2) {\n\t    var def = arguments[1];\n\t    if (typeof def === 'string') {\n\t      if (def.charAt(0) === '+') {\n\t        defs[name] = parseProj(arguments[1]);\n\t      }\n\t      else {\n\t        defs[name] = wkt(arguments[1]);\n\t      }\n\t    } else {\n\t      defs[name] = def;\n\t    }\n\t  }\n\t  else if (arguments.length === 1) {\n\t    if (Array.isArray(name)) {\n\t      return name.map(function(v) {\n\t        if (Array.isArray(v)) {\n\t          defs.apply(that, v);\n\t        }\n\t        else {\n\t          defs(v);\n\t        }\n\t      });\n\t    }\n\t    else if (typeof name === 'string') {\n\t      if (name in defs) {\n\t        return defs[name];\n\t      }\n\t    }\n\t    else if ('EPSG' in name) {\n\t      defs['EPSG:' + name.EPSG] = name;\n\t    }\n\t    else if ('ESRI' in name) {\n\t      defs['ESRI:' + name.ESRI] = name;\n\t    }\n\t    else if ('IAU2000' in name) {\n\t      defs['IAU2000:' + name.IAU2000] = name;\n\t    }\n\t    else {\n\t      console.log(name);\n\t    }\n\t    return;\n\t  }\n\n\n\t}\n\tglobals(defs);\n\n\tfunction testObj(code){\n\t  return typeof code === 'string';\n\t}\n\tfunction testDef(code){\n\t  return code in defs;\n\t}\n\t var codeWords = ['PROJECTEDCRS', 'PROJCRS', 'GEOGCS','GEOCCS','PROJCS','LOCAL_CS', 'GEODCRS', 'GEODETICCRS', 'GEODETICDATUM', 'ENGCRS', 'ENGINEERINGCRS']; \n\tfunction testWKT(code){\n\t  return codeWords.some(function (word) {\n\t    return code.indexOf(word) > -1;\n\t  });\n\t}\n\tfunction testProj(code){\n\t  return code[0] === '+';\n\t}\n\tfunction parse(code){\n\t  if (testObj(code)) {\n\t    //check to see if this is a WKT string\n\t    if (testDef(code)) {\n\t      return defs[code];\n\t    }\n\t    if (testWKT(code)) {\n\t      return wkt(code);\n\t    }\n\t    if (testProj(code)) {\n\t      return parseProj(code);\n\t    }\n\t  }else{\n\t    return code;\n\t  }\n\t}\n\n\tvar extend = function(destination, source) {\n\t  destination = destination || {};\n\t  var value, property;\n\t  if (!source) {\n\t    return destination;\n\t  }\n\t  for (property in source) {\n\t    value = source[property];\n\t    if (value !== undefined) {\n\t      destination[property] = value;\n\t    }\n\t  }\n\t  return destination;\n\t};\n\n\tvar msfnz = function(eccent, sinphi, cosphi) {\n\t  var con = eccent * sinphi;\n\t  return cosphi / (Math.sqrt(1 - con * con));\n\t};\n\n\tvar sign = function(x) {\n\t  return x<0 ? -1 : 1;\n\t};\n\n\tvar adjust_lon = function(x) {\n\t  return (Math.abs(x) <= SPI) ? x : (x - (sign(x) * TWO_PI));\n\t};\n\n\tvar tsfnz = function(eccent, phi, sinphi) {\n\t  var con = eccent * sinphi;\n\t  var com = 0.5 * eccent;\n\t  con = Math.pow(((1 - con) / (1 + con)), com);\n\t  return (Math.tan(0.5 * (HALF_PI - phi)) / con);\n\t};\n\n\tvar phi2z = function(eccent, ts) {\n\t  var eccnth = 0.5 * eccent;\n\t  var con, dphi;\n\t  var phi = HALF_PI - 2 * Math.atan(ts);\n\t  for (var i = 0; i <= 15; i++) {\n\t    con = eccent * Math.sin(phi);\n\t    dphi = HALF_PI - 2 * Math.atan(ts * (Math.pow(((1 - con) / (1 + con)), eccnth))) - phi;\n\t    phi += dphi;\n\t    if (Math.abs(dphi) <= 0.0000000001) {\n\t      return phi;\n\t    }\n\t  }\n\t  //console.log(\"phi2z has NoConvergence\");\n\t  return -9999;\n\t};\n\n\tfunction init() {\n\t  var con = this.b / this.a;\n\t  this.es = 1 - con * con;\n\t  if(!('x0' in this)){\n\t    this.x0 = 0;\n\t  }\n\t  if(!('y0' in this)){\n\t    this.y0 = 0;\n\t  }\n\t  this.e = Math.sqrt(this.es);\n\t  if (this.lat_ts) {\n\t    if (this.sphere) {\n\t      this.k0 = Math.cos(this.lat_ts);\n\t    }\n\t    else {\n\t      this.k0 = msfnz(this.e, Math.sin(this.lat_ts), Math.cos(this.lat_ts));\n\t    }\n\t  }\n\t  else {\n\t    if (!this.k0) {\n\t      if (this.k) {\n\t        this.k0 = this.k;\n\t      }\n\t      else {\n\t        this.k0 = 1;\n\t      }\n\t    }\n\t  }\n\t}\n\n\t/* Mercator forward equations--mapping lat,long to x,y\n\t  --------------------------------------------------*/\n\n\tfunction forward(p) {\n\t  var lon = p.x;\n\t  var lat = p.y;\n\t  // convert to radians\n\t  if (lat * R2D > 90 && lat * R2D < -90 && lon * R2D > 180 && lon * R2D < -180) {\n\t    return null;\n\t  }\n\n\t  var x, y;\n\t  if (Math.abs(Math.abs(lat) - HALF_PI) <= EPSLN) {\n\t    return null;\n\t  }\n\t  else {\n\t    if (this.sphere) {\n\t      x = this.x0 + this.a * this.k0 * adjust_lon(lon - this.long0);\n\t      y = this.y0 + this.a * this.k0 * Math.log(Math.tan(FORTPI + 0.5 * lat));\n\t    }\n\t    else {\n\t      var sinphi = Math.sin(lat);\n\t      var ts = tsfnz(this.e, lat, sinphi);\n\t      x = this.x0 + this.a * this.k0 * adjust_lon(lon - this.long0);\n\t      y = this.y0 - this.a * this.k0 * Math.log(ts);\n\t    }\n\t    p.x = x;\n\t    p.y = y;\n\t    return p;\n\t  }\n\t}\n\n\t/* Mercator inverse equations--mapping x,y to lat/long\n\t  --------------------------------------------------*/\n\tfunction inverse(p) {\n\n\t  var x = p.x - this.x0;\n\t  var y = p.y - this.y0;\n\t  var lon, lat;\n\n\t  if (this.sphere) {\n\t    lat = HALF_PI - 2 * Math.atan(Math.exp(-y / (this.a * this.k0)));\n\t  }\n\t  else {\n\t    var ts = Math.exp(-y / (this.a * this.k0));\n\t    lat = phi2z(this.e, ts);\n\t    if (lat === -9999) {\n\t      return null;\n\t    }\n\t  }\n\t  lon = adjust_lon(this.long0 + x / (this.a * this.k0));\n\n\t  p.x = lon;\n\t  p.y = lat;\n\t  return p;\n\t}\n\n\tvar names$1 = [\"Mercator\", \"Popular Visualisation Pseudo Mercator\", \"Mercator_1SP\", \"Mercator_Auxiliary_Sphere\", \"merc\"];\n\tvar merc = {\n\t  init: init,\n\t  forward: forward,\n\t  inverse: inverse,\n\t  names: names$1\n\t};\n\n\tfunction init$1() {\n\t  //no-op for longlat\n\t}\n\n\tfunction identity(pt) {\n\t  return pt;\n\t}\n\tvar names$2 = [\"longlat\", \"identity\"];\n\tvar longlat = {\n\t  init: init$1,\n\t  forward: identity,\n\t  inverse: identity,\n\t  names: names$2\n\t};\n\n\tvar projs = [merc, longlat];\n\tvar names$$1 = {};\n\tvar projStore = [];\n\n\tfunction add(proj, i) {\n\t  var len = projStore.length;\n\t  if (!proj.names) {\n\t    console.log(i);\n\t    return true;\n\t  }\n\t  projStore[len] = proj;\n\t  proj.names.forEach(function(n) {\n\t    names$$1[n.toLowerCase()] = len;\n\t  });\n\t  return this;\n\t}\n\n\tfunction get(name) {\n\t  if (!name) {\n\t    return false;\n\t  }\n\t  var n = name.toLowerCase();\n\t  if (typeof names$$1[n] !== 'undefined' && projStore[names$$1[n]]) {\n\t    return projStore[names$$1[n]];\n\t  }\n\t}\n\n\tfunction start() {\n\t  projs.forEach(add);\n\t}\n\tvar projections = {\n\t  start: start,\n\t  add: add,\n\t  get: get\n\t};\n\n\tvar exports$2 = {};\n\texports$2.MERIT = {\n\t  a: 6378137.0,\n\t  rf: 298.257,\n\t  ellipseName: \"MERIT 1983\"\n\t};\n\n\texports$2.SGS85 = {\n\t  a: 6378136.0,\n\t  rf: 298.257,\n\t  ellipseName: \"Soviet Geodetic System 85\"\n\t};\n\n\texports$2.GRS80 = {\n\t  a: 6378137.0,\n\t  rf: 298.257222101,\n\t  ellipseName: \"GRS 1980(IUGG, 1980)\"\n\t};\n\n\texports$2.IAU76 = {\n\t  a: 6378140.0,\n\t  rf: 298.257,\n\t  ellipseName: \"IAU 1976\"\n\t};\n\n\texports$2.airy = {\n\t  a: 6377563.396,\n\t  b: 6356256.910,\n\t  ellipseName: \"Airy 1830\"\n\t};\n\n\texports$2.APL4 = {\n\t  a: 6378137,\n\t  rf: 298.25,\n\t  ellipseName: \"Appl. Physics. 1965\"\n\t};\n\n\texports$2.NWL9D = {\n\t  a: 6378145.0,\n\t  rf: 298.25,\n\t  ellipseName: \"Naval Weapons Lab., 1965\"\n\t};\n\n\texports$2.mod_airy = {\n\t  a: 6377340.189,\n\t  b: 6356034.446,\n\t  ellipseName: \"Modified Airy\"\n\t};\n\n\texports$2.andrae = {\n\t  a: 6377104.43,\n\t  rf: 300.0,\n\t  ellipseName: \"Andrae 1876 (Den., Iclnd.)\"\n\t};\n\n\texports$2.aust_SA = {\n\t  a: 6378160.0,\n\t  rf: 298.25,\n\t  ellipseName: \"Australian Natl & S. Amer. 1969\"\n\t};\n\n\texports$2.GRS67 = {\n\t  a: 6378160.0,\n\t  rf: 298.2471674270,\n\t  ellipseName: \"GRS 67(IUGG 1967)\"\n\t};\n\n\texports$2.bessel = {\n\t  a: 6377397.155,\n\t  rf: 299.1528128,\n\t  ellipseName: \"Bessel 1841\"\n\t};\n\n\texports$2.bess_nam = {\n\t  a: 6377483.865,\n\t  rf: 299.1528128,\n\t  ellipseName: \"Bessel 1841 (Namibia)\"\n\t};\n\n\texports$2.clrk66 = {\n\t  a: 6378206.4,\n\t  b: 6356583.8,\n\t  ellipseName: \"Clarke 1866\"\n\t};\n\n\texports$2.clrk80 = {\n\t  a: 6378249.145,\n\t  rf: 293.4663,\n\t  ellipseName: \"Clarke 1880 mod.\"\n\t};\n\n\texports$2.clrk58 = {\n\t  a: 6378293.645208759,\n\t  rf: 294.2606763692654,\n\t  ellipseName: \"Clarke 1858\"\n\t};\n\n\texports$2.CPM = {\n\t  a: 6375738.7,\n\t  rf: 334.29,\n\t  ellipseName: \"Comm. des Poids et Mesures 1799\"\n\t};\n\n\texports$2.delmbr = {\n\t  a: 6376428.0,\n\t  rf: 311.5,\n\t  ellipseName: \"Delambre 1810 (Belgium)\"\n\t};\n\n\texports$2.engelis = {\n\t  a: 6378136.05,\n\t  rf: 298.2566,\n\t  ellipseName: \"Engelis 1985\"\n\t};\n\n\texports$2.evrst30 = {\n\t  a: 6377276.345,\n\t  rf: 300.8017,\n\t  ellipseName: \"Everest 1830\"\n\t};\n\n\texports$2.evrst48 = {\n\t  a: 6377304.063,\n\t  rf: 300.8017,\n\t  ellipseName: \"Everest 1948\"\n\t};\n\n\texports$2.evrst56 = {\n\t  a: 6377301.243,\n\t  rf: 300.8017,\n\t  ellipseName: \"Everest 1956\"\n\t};\n\n\texports$2.evrst69 = {\n\t  a: 6377295.664,\n\t  rf: 300.8017,\n\t  ellipseName: \"Everest 1969\"\n\t};\n\n\texports$2.evrstSS = {\n\t  a: 6377298.556,\n\t  rf: 300.8017,\n\t  ellipseName: \"Everest (Sabah & Sarawak)\"\n\t};\n\n\texports$2.fschr60 = {\n\t  a: 6378166.0,\n\t  rf: 298.3,\n\t  ellipseName: \"Fischer (Mercury Datum) 1960\"\n\t};\n\n\texports$2.fschr60m = {\n\t  a: 6378155.0,\n\t  rf: 298.3,\n\t  ellipseName: \"Fischer 1960\"\n\t};\n\n\texports$2.fschr68 = {\n\t  a: 6378150.0,\n\t  rf: 298.3,\n\t  ellipseName: \"Fischer 1968\"\n\t};\n\n\texports$2.helmert = {\n\t  a: 6378200.0,\n\t  rf: 298.3,\n\t  ellipseName: \"Helmert 1906\"\n\t};\n\n\texports$2.hough = {\n\t  a: 6378270.0,\n\t  rf: 297.0,\n\t  ellipseName: \"Hough\"\n\t};\n\n\texports$2.intl = {\n\t  a: 6378388.0,\n\t  rf: 297.0,\n\t  ellipseName: \"International 1909 (Hayford)\"\n\t};\n\n\texports$2.kaula = {\n\t  a: 6378163.0,\n\t  rf: 298.24,\n\t  ellipseName: \"Kaula 1961\"\n\t};\n\n\texports$2.lerch = {\n\t  a: 6378139.0,\n\t  rf: 298.257,\n\t  ellipseName: \"Lerch 1979\"\n\t};\n\n\texports$2.mprts = {\n\t  a: 6397300.0,\n\t  rf: 191.0,\n\t  ellipseName: \"Maupertius 1738\"\n\t};\n\n\texports$2.new_intl = {\n\t  a: 6378157.5,\n\t  b: 6356772.2,\n\t  ellipseName: \"New International 1967\"\n\t};\n\n\texports$2.plessis = {\n\t  a: 6376523.0,\n\t  rf: 6355863.0,\n\t  ellipseName: \"Plessis 1817 (France)\"\n\t};\n\n\texports$2.krass = {\n\t  a: 6378245.0,\n\t  rf: 298.3,\n\t  ellipseName: \"Krassovsky, 1942\"\n\t};\n\n\texports$2.SEasia = {\n\t  a: 6378155.0,\n\t  b: 6356773.3205,\n\t  ellipseName: \"Southeast Asia\"\n\t};\n\n\texports$2.walbeck = {\n\t  a: 6376896.0,\n\t  b: 6355834.8467,\n\t  ellipseName: \"Walbeck\"\n\t};\n\n\texports$2.WGS60 = {\n\t  a: 6378165.0,\n\t  rf: 298.3,\n\t  ellipseName: \"WGS 60\"\n\t};\n\n\texports$2.WGS66 = {\n\t  a: 6378145.0,\n\t  rf: 298.25,\n\t  ellipseName: \"WGS 66\"\n\t};\n\n\texports$2.WGS7 = {\n\t  a: 6378135.0,\n\t  rf: 298.26,\n\t  ellipseName: \"WGS 72\"\n\t};\n\n\tvar WGS84 = exports$2.WGS84 = {\n\t  a: 6378137.0,\n\t  rf: 298.257223563,\n\t  ellipseName: \"WGS 84\"\n\t};\n\n\texports$2.sphere = {\n\t  a: 6370997.0,\n\t  b: 6370997.0,\n\t  ellipseName: \"Normal Sphere (r=6370997)\"\n\t};\n\n\tfunction eccentricity(a, b, rf, R_A) {\n\t  var a2 = a * a; // used in geocentric\n\t  var b2 = b * b; // used in geocentric\n\t  var es = (a2 - b2) / a2; // e ^ 2\n\t  var e = 0;\n\t  if (R_A) {\n\t    a *= 1 - es * (SIXTH + es * (RA4 + es * RA6));\n\t    a2 = a * a;\n\t    es = 0;\n\t  } else {\n\t    e = Math.sqrt(es); // eccentricity\n\t  }\n\t  var ep2 = (a2 - b2) / b2; // used in geocentric\n\t  return {\n\t    es: es,\n\t    e: e,\n\t    ep2: ep2\n\t  };\n\t}\n\tfunction sphere(a, b, rf, ellps, sphere) {\n\t  if (!a) { // do we have an ellipsoid?\n\t    var ellipse = match(exports$2, ellps);\n\t    if (!ellipse) {\n\t      ellipse = WGS84;\n\t    }\n\t    a = ellipse.a;\n\t    b = ellipse.b;\n\t    rf = ellipse.rf;\n\t  }\n\n\t  if (rf && !b) {\n\t    b = (1.0 - 1.0 / rf) * a;\n\t  }\n\t  if (rf === 0 || Math.abs(a - b) < EPSLN) {\n\t    sphere = true;\n\t    b = a;\n\t  }\n\t  return {\n\t    a: a,\n\t    b: b,\n\t    rf: rf,\n\t    sphere: sphere\n\t  };\n\t}\n\n\tvar exports$3 = {};\n\texports$3.wgs84 = {\n\t  towgs84: \"0,0,0\",\n\t  ellipse: \"WGS84\",\n\t  datumName: \"WGS84\"\n\t};\n\n\texports$3.ch1903 = {\n\t  towgs84: \"674.374,15.056,405.346\",\n\t  ellipse: \"bessel\",\n\t  datumName: \"swiss\"\n\t};\n\n\texports$3.ggrs87 = {\n\t  towgs84: \"-199.87,74.79,246.62\",\n\t  ellipse: \"GRS80\",\n\t  datumName: \"Greek_Geodetic_Reference_System_1987\"\n\t};\n\n\texports$3.nad83 = {\n\t  towgs84: \"0,0,0\",\n\t  ellipse: \"GRS80\",\n\t  datumName: \"North_American_Datum_1983\"\n\t};\n\n\texports$3.nad27 = {\n\t  nadgrids: \"@conus,@alaska,@ntv2_0.gsb,@ntv1_can.dat\",\n\t  ellipse: \"clrk66\",\n\t  datumName: \"North_American_Datum_1927\"\n\t};\n\n\texports$3.potsdam = {\n\t  towgs84: \"606.0,23.0,413.0\",\n\t  ellipse: \"bessel\",\n\t  datumName: \"Potsdam Rauenberg 1950 DHDN\"\n\t};\n\n\texports$3.carthage = {\n\t  towgs84: \"-263.0,6.0,431.0\",\n\t  ellipse: \"clark80\",\n\t  datumName: \"Carthage 1934 Tunisia\"\n\t};\n\n\texports$3.hermannskogel = {\n\t  towgs84: \"653.0,-212.0,449.0\",\n\t  ellipse: \"bessel\",\n\t  datumName: \"Hermannskogel\"\n\t};\n\n\texports$3.osni52 = {\n\t  towgs84: \"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15\",\n\t  ellipse: \"airy\",\n\t  datumName: \"Irish National\"\n\t};\n\n\texports$3.ire65 = {\n\t  towgs84: \"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15\",\n\t  ellipse: \"mod_airy\",\n\t  datumName: \"Ireland 1965\"\n\t};\n\n\texports$3.rassadiran = {\n\t  towgs84: \"-133.63,-157.5,-158.62\",\n\t  ellipse: \"intl\",\n\t  datumName: \"Rassadiran\"\n\t};\n\n\texports$3.nzgd49 = {\n\t  towgs84: \"59.47,-5.04,187.44,0.47,-0.1,1.024,-4.5993\",\n\t  ellipse: \"intl\",\n\t  datumName: \"New Zealand Geodetic Datum 1949\"\n\t};\n\n\texports$3.osgb36 = {\n\t  towgs84: \"446.448,-125.157,542.060,0.1502,0.2470,0.8421,-20.4894\",\n\t  ellipse: \"airy\",\n\t  datumName: \"Airy 1830\"\n\t};\n\n\texports$3.s_jtsk = {\n\t  towgs84: \"589,76,480\",\n\t  ellipse: 'bessel',\n\t  datumName: 'S-JTSK (Ferro)'\n\t};\n\n\texports$3.beduaram = {\n\t  towgs84: '-106,-87,188',\n\t  ellipse: 'clrk80',\n\t  datumName: 'Beduaram'\n\t};\n\n\texports$3.gunung_segara = {\n\t  towgs84: '-403,684,41',\n\t  ellipse: 'bessel',\n\t  datumName: 'Gunung Segara Jakarta'\n\t};\n\n\texports$3.rnb72 = {\n\t  towgs84: \"106.869,-52.2978,103.724,-0.33657,0.456955,-1.84218,1\",\n\t  ellipse: \"intl\",\n\t  datumName: \"Reseau National Belge 1972\"\n\t};\n\n\tfunction datum(datumCode, datum_params, a, b, es, ep2) {\n\t  var out = {};\n\n\t  if (datumCode === undefined || datumCode === 'none') {\n\t    out.datum_type = PJD_NODATUM;\n\t  } else {\n\t    out.datum_type = PJD_WGS84;\n\t  }\n\n\t  if (datum_params) {\n\t    out.datum_params = datum_params.map(parseFloat);\n\t    if (out.datum_params[0] !== 0 || out.datum_params[1] !== 0 || out.datum_params[2] !== 0) {\n\t      out.datum_type = PJD_3PARAM;\n\t    }\n\t    if (out.datum_params.length > 3) {\n\t      if (out.datum_params[3] !== 0 || out.datum_params[4] !== 0 || out.datum_params[5] !== 0 || out.datum_params[6] !== 0) {\n\t        out.datum_type = PJD_7PARAM;\n\t        out.datum_params[3] *= SEC_TO_RAD;\n\t        out.datum_params[4] *= SEC_TO_RAD;\n\t        out.datum_params[5] *= SEC_TO_RAD;\n\t        out.datum_params[6] = (out.datum_params[6] / 1000000.0) + 1.0;\n\t      }\n\t    }\n\t  }\n\n\t  out.a = a; //datum object also uses these values\n\t  out.b = b;\n\t  out.es = es;\n\t  out.ep2 = ep2;\n\t  return out;\n\t}\n\n\tfunction Projection$1(srsCode,callback) {\n\t  if (!(this instanceof Projection$1)) {\n\t    return new Projection$1(srsCode);\n\t  }\n\t  callback = callback || function(error){\n\t    if(error){\n\t      throw error;\n\t    }\n\t  };\n\t  var json = parse(srsCode);\n\t  if(typeof json !== 'object'){\n\t    callback(srsCode);\n\t    return;\n\t  }\n\t  var ourProj = Projection$1.projections.get(json.projName);\n\t  if(!ourProj){\n\t    callback(srsCode);\n\t    return;\n\t  }\n\t  if (json.datumCode && json.datumCode !== 'none') {\n\t    var datumDef = match(exports$3, json.datumCode);\n\t    if (datumDef) {\n\t      json.datum_params = datumDef.towgs84 ? datumDef.towgs84.split(',') : null;\n\t      json.ellps = datumDef.ellipse;\n\t      json.datumName = datumDef.datumName ? datumDef.datumName : json.datumCode;\n\t    }\n\t  }\n\t  json.k0 = json.k0 || 1.0;\n\t  json.axis = json.axis || 'enu';\n\t  json.ellps = json.ellps || 'wgs84';\n\t  var sphere_ = sphere(json.a, json.b, json.rf, json.ellps, json.sphere);\n\t  var ecc = eccentricity(sphere_.a, sphere_.b, sphere_.rf, json.R_A);\n\t  var datumObj = json.datum || datum(json.datumCode, json.datum_params, sphere_.a, sphere_.b, ecc.es, ecc.ep2);\n\n\t  extend(this, json); // transfer everything over from the projection because we don't know what we'll need\n\t  extend(this, ourProj); // transfer all the methods from the projection\n\n\t  // copy the 4 things over we calulated in deriveConstants.sphere\n\t  this.a = sphere_.a;\n\t  this.b = sphere_.b;\n\t  this.rf = sphere_.rf;\n\t  this.sphere = sphere_.sphere;\n\n\t  // copy the 3 things we calculated in deriveConstants.eccentricity\n\t  this.es = ecc.es;\n\t  this.e = ecc.e;\n\t  this.ep2 = ecc.ep2;\n\n\t  // add in the datum object\n\t  this.datum = datumObj;\n\n\t  // init the projection\n\t  this.init();\n\n\t  // legecy callback from back in the day when it went to spatialreference.org\n\t  callback(null, this);\n\n\t}\n\tProjection$1.projections = projections;\n\tProjection$1.projections.start();\n\n\tfunction compareDatums(source, dest) {\n\t  if (source.datum_type !== dest.datum_type) {\n\t    return false; // false, datums are not equal\n\t  } else if (source.a !== dest.a || Math.abs(source.es - dest.es) > 0.000000000050) {\n\t    // the tolerance for es is to ensure that GRS80 and WGS84\n\t    // are considered identical\n\t    return false;\n\t  } else if (source.datum_type === PJD_3PARAM) {\n\t    return (source.datum_params[0] === dest.datum_params[0] && source.datum_params[1] === dest.datum_params[1] && source.datum_params[2] === dest.datum_params[2]);\n\t  } else if (source.datum_type === PJD_7PARAM) {\n\t    return (source.datum_params[0] === dest.datum_params[0] && source.datum_params[1] === dest.datum_params[1] && source.datum_params[2] === dest.datum_params[2] && source.datum_params[3] === dest.datum_params[3] && source.datum_params[4] === dest.datum_params[4] && source.datum_params[5] === dest.datum_params[5] && source.datum_params[6] === dest.datum_params[6]);\n\t  } else {\n\t    return true; // datums are equal\n\t  }\n\t} // cs_compare_datums()\n\n\t/*\n\t * The function Convert_Geodetic_To_Geocentric converts geodetic coordinates\n\t * (latitude, longitude, and height) to geocentric coordinates (X, Y, Z),\n\t * according to the current ellipsoid parameters.\n\t *\n\t *    Latitude  : Geodetic latitude in radians                     (input)\n\t *    Longitude : Geodetic longitude in radians                    (input)\n\t *    Height    : Geodetic height, in meters                       (input)\n\t *    X         : Calculated Geocentric X coordinate, in meters    (output)\n\t *    Y         : Calculated Geocentric Y coordinate, in meters    (output)\n\t *    Z         : Calculated Geocentric Z coordinate, in meters    (output)\n\t *\n\t */\n\tfunction geodeticToGeocentric(p, es, a) {\n\t  var Longitude = p.x;\n\t  var Latitude = p.y;\n\t  var Height = p.z ? p.z : 0; //Z value not always supplied\n\n\t  var Rn; /*  Earth radius at location  */\n\t  var Sin_Lat; /*  Math.sin(Latitude)  */\n\t  var Sin2_Lat; /*  Square of Math.sin(Latitude)  */\n\t  var Cos_Lat; /*  Math.cos(Latitude)  */\n\n\t  /*\n\t   ** Don't blow up if Latitude is just a little out of the value\n\t   ** range as it may just be a rounding issue.  Also removed longitude\n\t   ** test, it should be wrapped by Math.cos() and Math.sin().  NFW for PROJ.4, Sep/2001.\n\t   */\n\t  if (Latitude < -HALF_PI && Latitude > -1.001 * HALF_PI) {\n\t    Latitude = -HALF_PI;\n\t  } else if (Latitude > HALF_PI && Latitude < 1.001 * HALF_PI) {\n\t    Latitude = HALF_PI;\n\t  } else if ((Latitude < -HALF_PI) || (Latitude > HALF_PI)) {\n\t    /* Latitude out of range */\n\t    //..reportError('geocent:lat out of range:' + Latitude);\n\t    return null;\n\t  }\n\n\t  if (Longitude > Math.PI) {\n\t    Longitude -= (2 * Math.PI);\n\t  }\n\t  Sin_Lat = Math.sin(Latitude);\n\t  Cos_Lat = Math.cos(Latitude);\n\t  Sin2_Lat = Sin_Lat * Sin_Lat;\n\t  Rn = a / (Math.sqrt(1.0e0 - es * Sin2_Lat));\n\t  return {\n\t    x: (Rn + Height) * Cos_Lat * Math.cos(Longitude),\n\t    y: (Rn + Height) * Cos_Lat * Math.sin(Longitude),\n\t    z: ((Rn * (1 - es)) + Height) * Sin_Lat\n\t  };\n\t} // cs_geodetic_to_geocentric()\n\n\tfunction geocentricToGeodetic(p, es, a, b) {\n\t  /* local defintions and variables */\n\t  /* end-criterium of loop, accuracy of sin(Latitude) */\n\t  var genau = 1e-12;\n\t  var genau2 = (genau * genau);\n\t  var maxiter = 30;\n\n\t  var P; /* distance between semi-minor axis and location */\n\t  var RR; /* distance between center and location */\n\t  var CT; /* sin of geocentric latitude */\n\t  var ST; /* cos of geocentric latitude */\n\t  var RX;\n\t  var RK;\n\t  var RN; /* Earth radius at location */\n\t  var CPHI0; /* cos of start or old geodetic latitude in iterations */\n\t  var SPHI0; /* sin of start or old geodetic latitude in iterations */\n\t  var CPHI; /* cos of searched geodetic latitude */\n\t  var SPHI; /* sin of searched geodetic latitude */\n\t  var SDPHI; /* end-criterium: addition-theorem of sin(Latitude(iter)-Latitude(iter-1)) */\n\t  var iter; /* # of continous iteration, max. 30 is always enough (s.a.) */\n\n\t  var X = p.x;\n\t  var Y = p.y;\n\t  var Z = p.z ? p.z : 0.0; //Z value not always supplied\n\t  var Longitude;\n\t  var Latitude;\n\t  var Height;\n\n\t  P = Math.sqrt(X * X + Y * Y);\n\t  RR = Math.sqrt(X * X + Y * Y + Z * Z);\n\n\t  /*      special cases for latitude and longitude */\n\t  if (P / a < genau) {\n\n\t    /*  special case, if P=0. (X=0., Y=0.) */\n\t    Longitude = 0.0;\n\n\t    /*  if (X,Y,Z)=(0.,0.,0.) then Height becomes semi-minor axis\n\t     *  of ellipsoid (=center of mass), Latitude becomes PI/2 */\n\t    if (RR / a < genau) {\n\t      Latitude = HALF_PI;\n\t      Height = -b;\n\t      return {\n\t        x: p.x,\n\t        y: p.y,\n\t        z: p.z\n\t      };\n\t    }\n\t  } else {\n\t    /*  ellipsoidal (geodetic) longitude\n\t     *  interval: -PI < Longitude <= +PI */\n\t    Longitude = Math.atan2(Y, X);\n\t  }\n\n\t  /* --------------------------------------------------------------\n\t   * Following iterative algorithm was developped by\n\t   * \"Institut for Erdmessung\", University of Hannover, July 1988.\n\t   * Internet: www.ife.uni-hannover.de\n\t   * Iterative computation of CPHI,SPHI and Height.\n\t   * Iteration of CPHI and SPHI to 10**-12 radian resp.\n\t   * 2*10**-7 arcsec.\n\t   * --------------------------------------------------------------\n\t   */\n\t  CT = Z / RR;\n\t  ST = P / RR;\n\t  RX = 1.0 / Math.sqrt(1.0 - es * (2.0 - es) * ST * ST);\n\t  CPHI0 = ST * (1.0 - es) * RX;\n\t  SPHI0 = CT * RX;\n\t  iter = 0;\n\n\t  /* loop to find sin(Latitude) resp. Latitude\n\t   * until |sin(Latitude(iter)-Latitude(iter-1))| < genau */\n\t  do {\n\t    iter++;\n\t    RN = a / Math.sqrt(1.0 - es * SPHI0 * SPHI0);\n\n\t    /*  ellipsoidal (geodetic) height */\n\t    Height = P * CPHI0 + Z * SPHI0 - RN * (1.0 - es * SPHI0 * SPHI0);\n\n\t    RK = es * RN / (RN + Height);\n\t    RX = 1.0 / Math.sqrt(1.0 - RK * (2.0 - RK) * ST * ST);\n\t    CPHI = ST * (1.0 - RK) * RX;\n\t    SPHI = CT * RX;\n\t    SDPHI = SPHI * CPHI0 - CPHI * SPHI0;\n\t    CPHI0 = CPHI;\n\t    SPHI0 = SPHI;\n\t  }\n\t  while (SDPHI * SDPHI > genau2 && iter < maxiter);\n\n\t  /*      ellipsoidal (geodetic) latitude */\n\t  Latitude = Math.atan(SPHI / Math.abs(CPHI));\n\t  return {\n\t    x: Longitude,\n\t    y: Latitude,\n\t    z: Height\n\t  };\n\t} // cs_geocentric_to_geodetic()\n\n\t/****************************************************************/\n\t// pj_geocentic_to_wgs84( p )\n\t//  p = point to transform in geocentric coordinates (x,y,z)\n\n\n\t/** point object, nothing fancy, just allows values to be\n\t    passed back and forth by reference rather than by value.\n\t    Other point classes may be used as long as they have\n\t    x and y properties, which will get modified in the transform method.\n\t*/\n\tfunction geocentricToWgs84(p, datum_type, datum_params) {\n\n\t  if (datum_type === PJD_3PARAM) {\n\t    // if( x[io] === HUGE_VAL )\n\t    //    continue;\n\t    return {\n\t      x: p.x + datum_params[0],\n\t      y: p.y + datum_params[1],\n\t      z: p.z + datum_params[2],\n\t    };\n\t  } else if (datum_type === PJD_7PARAM) {\n\t    var Dx_BF = datum_params[0];\n\t    var Dy_BF = datum_params[1];\n\t    var Dz_BF = datum_params[2];\n\t    var Rx_BF = datum_params[3];\n\t    var Ry_BF = datum_params[4];\n\t    var Rz_BF = datum_params[5];\n\t    var M_BF = datum_params[6];\n\t    // if( x[io] === HUGE_VAL )\n\t    //    continue;\n\t    return {\n\t      x: M_BF * (p.x - Rz_BF * p.y + Ry_BF * p.z) + Dx_BF,\n\t      y: M_BF * (Rz_BF * p.x + p.y - Rx_BF * p.z) + Dy_BF,\n\t      z: M_BF * (-Ry_BF * p.x + Rx_BF * p.y + p.z) + Dz_BF\n\t    };\n\t  }\n\t} // cs_geocentric_to_wgs84\n\n\t/****************************************************************/\n\t// pj_geocentic_from_wgs84()\n\t//  coordinate system definition,\n\t//  point to transform in geocentric coordinates (x,y,z)\n\tfunction geocentricFromWgs84(p, datum_type, datum_params) {\n\n\t  if (datum_type === PJD_3PARAM) {\n\t    //if( x[io] === HUGE_VAL )\n\t    //    continue;\n\t    return {\n\t      x: p.x - datum_params[0],\n\t      y: p.y - datum_params[1],\n\t      z: p.z - datum_params[2],\n\t    };\n\n\t  } else if (datum_type === PJD_7PARAM) {\n\t    var Dx_BF = datum_params[0];\n\t    var Dy_BF = datum_params[1];\n\t    var Dz_BF = datum_params[2];\n\t    var Rx_BF = datum_params[3];\n\t    var Ry_BF = datum_params[4];\n\t    var Rz_BF = datum_params[5];\n\t    var M_BF = datum_params[6];\n\t    var x_tmp = (p.x - Dx_BF) / M_BF;\n\t    var y_tmp = (p.y - Dy_BF) / M_BF;\n\t    var z_tmp = (p.z - Dz_BF) / M_BF;\n\t    //if( x[io] === HUGE_VAL )\n\t    //    continue;\n\n\t    return {\n\t      x: x_tmp + Rz_BF * y_tmp - Ry_BF * z_tmp,\n\t      y: -Rz_BF * x_tmp + y_tmp + Rx_BF * z_tmp,\n\t      z: Ry_BF * x_tmp - Rx_BF * y_tmp + z_tmp\n\t    };\n\t  } //cs_geocentric_from_wgs84()\n\t}\n\n\tfunction checkParams(type) {\n\t  return (type === PJD_3PARAM || type === PJD_7PARAM);\n\t}\n\n\tvar datum_transform = function(source, dest, point) {\n\t  // Short cut if the datums are identical.\n\t  if (compareDatums(source, dest)) {\n\t    return point; // in this case, zero is sucess,\n\t    // whereas cs_compare_datums returns 1 to indicate TRUE\n\t    // confusing, should fix this\n\t  }\n\n\t  // Explicitly skip datum transform by setting 'datum=none' as parameter for either source or dest\n\t  if (source.datum_type === PJD_NODATUM || dest.datum_type === PJD_NODATUM) {\n\t    return point;\n\t  }\n\n\t  // If this datum requires grid shifts, then apply it to geodetic coordinates.\n\n\t  // Do we need to go through geocentric coordinates?\n\t  if (source.es === dest.es && source.a === dest.a && !checkParams(source.datum_type) &&  !checkParams(dest.datum_type)) {\n\t    return point;\n\t  }\n\n\t  // Convert to geocentric coordinates.\n\t  point = geodeticToGeocentric(point, source.es, source.a);\n\t  // Convert between datums\n\t  if (checkParams(source.datum_type)) {\n\t    point = geocentricToWgs84(point, source.datum_type, source.datum_params);\n\t  }\n\t  if (checkParams(dest.datum_type)) {\n\t    point = geocentricFromWgs84(point, dest.datum_type, dest.datum_params);\n\t  }\n\t  return geocentricToGeodetic(point, dest.es, dest.a, dest.b);\n\n\t};\n\n\tvar adjust_axis = function(crs, denorm, point) {\n\t  var xin = point.x,\n\t    yin = point.y,\n\t    zin = point.z || 0.0;\n\t  var v, t, i;\n\t  var out = {};\n\t  for (i = 0; i < 3; i++) {\n\t    if (denorm && i === 2 && point.z === undefined) {\n\t      continue;\n\t    }\n\t    if (i === 0) {\n\t      v = xin;\n\t      t = 'x';\n\t    }\n\t    else if (i === 1) {\n\t      v = yin;\n\t      t = 'y';\n\t    }\n\t    else {\n\t      v = zin;\n\t      t = 'z';\n\t    }\n\t    switch (crs.axis[i]) {\n\t    case 'e':\n\t      out[t] = v;\n\t      break;\n\t    case 'w':\n\t      out[t] = -v;\n\t      break;\n\t    case 'n':\n\t      out[t] = v;\n\t      break;\n\t    case 's':\n\t      out[t] = -v;\n\t      break;\n\t    case 'u':\n\t      if (point[t] !== undefined) {\n\t        out.z = v;\n\t      }\n\t      break;\n\t    case 'd':\n\t      if (point[t] !== undefined) {\n\t        out.z = -v;\n\t      }\n\t      break;\n\t    default:\n\t      //console.log(\"ERROR: unknow axis (\"+crs.axis[i]+\") - check definition of \"+crs.projName);\n\t      return null;\n\t    }\n\t  }\n\t  return out;\n\t};\n\n\tvar toPoint = function (array){\n\t  var out = {\n\t    x: array[0],\n\t    y: array[1]\n\t  };\n\t  if (array.length>2) {\n\t    out.z = array[2];\n\t  }\n\t  if (array.length>3) {\n\t    out.m = array[3];\n\t  }\n\t  return out;\n\t};\n\n\tvar checkSanity = function (point) {\n\t  checkCoord(point.x);\n\t  checkCoord(point.y);\n\t};\n\tfunction checkCoord(num) {\n\t  if (typeof Number.isFinite === 'function') {\n\t    if (Number.isFinite(num)) {\n\t      return;\n\t    }\n\t    throw new TypeError('coordinates must be finite numbers');\n\t  }\n\t  if (typeof num !== 'number' || num !== num || !isFinite(num)) {\n\t    throw new TypeError('coordinates must be finite numbers');\n\t  }\n\t}\n\n\tfunction checkNotWGS(source, dest) {\n\t  return ((source.datum.datum_type === PJD_3PARAM || source.datum.datum_type === PJD_7PARAM) && dest.datumCode !== 'WGS84') || ((dest.datum.datum_type === PJD_3PARAM || dest.datum.datum_type === PJD_7PARAM) && source.datumCode !== 'WGS84');\n\t}\n\n\tfunction transform(source, dest, point) {\n\t  var wgs84;\n\t  if (Array.isArray(point)) {\n\t    point = toPoint(point);\n\t  }\n\t  checkSanity(point);\n\t  // Workaround for datum shifts towgs84, if either source or destination projection is not wgs84\n\t  if (source.datum && dest.datum && checkNotWGS(source, dest)) {\n\t    wgs84 = new Projection$1('WGS84');\n\t    point = transform(source, wgs84, point);\n\t    source = wgs84;\n\t  }\n\t  // DGR, 2010/11/12\n\t  if (source.axis !== 'enu') {\n\t    point = adjust_axis(source, false, point);\n\t  }\n\t  // Transform source points to long/lat, if they aren't already.\n\t  if (source.projName === 'longlat') {\n\t    point = {\n\t      x: point.x * D2R,\n\t      y: point.y * D2R\n\t    };\n\t  }\n\t  else {\n\t    if (source.to_meter) {\n\t      point = {\n\t        x: point.x * source.to_meter,\n\t        y: point.y * source.to_meter\n\t      };\n\t    }\n\t    point = source.inverse(point); // Convert Cartesian to longlat\n\t  }\n\t  // Adjust for the prime meridian if necessary\n\t  if (source.from_greenwich) {\n\t    point.x += source.from_greenwich;\n\t  }\n\n\t  // Convert datums if needed, and if possible.\n\t  point = datum_transform(source.datum, dest.datum, point);\n\n\t  // Adjust for the prime meridian if necessary\n\t  if (dest.from_greenwich) {\n\t    point = {\n\t      x: point.x - dest.from_greenwich,\n\t      y: point.y\n\t    };\n\t  }\n\n\t  if (dest.projName === 'longlat') {\n\t    // convert radians to decimal degrees\n\t    point = {\n\t      x: point.x * R2D,\n\t      y: point.y * R2D\n\t    };\n\t  } else { // else project\n\t    point = dest.forward(point);\n\t    if (dest.to_meter) {\n\t      point = {\n\t        x: point.x / dest.to_meter,\n\t        y: point.y / dest.to_meter\n\t      };\n\t    }\n\t  }\n\n\t  // DGR, 2010/11/12\n\t  if (dest.axis !== 'enu') {\n\t    return adjust_axis(dest, true, point);\n\t  }\n\n\t  return point;\n\t}\n\n\tvar wgs84 = Projection$1('WGS84');\n\n\tfunction transformer(from, to, coords) {\n\t  var transformedArray, out, keys;\n\t  if (Array.isArray(coords)) {\n\t    transformedArray = transform(from, to, coords);\n\t    if (coords.length === 3) {\n\t      return [transformedArray.x, transformedArray.y, transformedArray.z];\n\t    }\n\t    else {\n\t      return [transformedArray.x, transformedArray.y];\n\t    }\n\t  }\n\t  else {\n\t    out = transform(from, to, coords);\n\t    keys = Object.keys(coords);\n\t    if (keys.length === 2) {\n\t      return out;\n\t    }\n\t    keys.forEach(function (key) {\n\t      if (key === 'x' || key === 'y') {\n\t        return;\n\t      }\n\t      out[key] = coords[key];\n\t    });\n\t    return out;\n\t  }\n\t}\n\n\tfunction checkProj(item) {\n\t  if (item instanceof Projection$1) {\n\t    return item;\n\t  }\n\t  if (item.oProj) {\n\t    return item.oProj;\n\t  }\n\t  return Projection$1(item);\n\t}\n\tfunction proj4$1(fromProj, toProj, coord) {\n\t  fromProj = checkProj(fromProj);\n\t  var single = false;\n\t  var obj;\n\t  if (typeof toProj === 'undefined') {\n\t    toProj = fromProj;\n\t    fromProj = wgs84;\n\t    single = true;\n\t  }\n\t  else if (typeof toProj.x !== 'undefined' || Array.isArray(toProj)) {\n\t    coord = toProj;\n\t    toProj = fromProj;\n\t    fromProj = wgs84;\n\t    single = true;\n\t  }\n\t  toProj = checkProj(toProj);\n\t  if (coord) {\n\t    return transformer(fromProj, toProj, coord);\n\t  }\n\t  else {\n\t    obj = {\n\t      forward: function(coords) {\n\t        return transformer(fromProj, toProj, coords);\n\t      },\n\t      inverse: function(coords) {\n\t        return transformer(toProj, fromProj, coords);\n\t      }\n\t    };\n\t    if (single) {\n\t      obj.oProj = toProj;\n\t    }\n\t    return obj;\n\t  }\n\t}\n\n\t/**\n\t * UTM zones are grouped, and assigned to one of a group of 6\n\t * sets.\n\t *\n\t * {int} @private\n\t */\n\tvar NUM_100K_SETS = 6;\n\n\t/**\n\t * The column letters (for easting) of the lower left value, per\n\t * set.\n\t *\n\t * {string} @private\n\t */\n\tvar SET_ORIGIN_COLUMN_LETTERS = 'AJSAJS';\n\n\t/**\n\t * The row letters (for northing) of the lower left value, per\n\t * set.\n\t *\n\t * {string} @private\n\t */\n\tvar SET_ORIGIN_ROW_LETTERS = 'AFAFAF';\n\n\tvar A = 65; // A\n\tvar I = 73; // I\n\tvar O = 79; // O\n\tvar V = 86; // V\n\tvar Z = 90; // Z\n\tvar mgrs = {\n\t  forward: forward$1,\n\t  inverse: inverse$1,\n\t  toPoint: toPoint$1\n\t};\n\t/**\n\t * Conversion of lat/lon to MGRS.\n\t *\n\t * @param {object} ll Object literal with lat and lon properties on a\n\t *     WGS84 ellipsoid.\n\t * @param {int} accuracy Accuracy in digits (5 for 1 m, 4 for 10 m, 3 for\n\t *      100 m, 2 for 1000 m or 1 for 10000 m). Optional, default is 5.\n\t * @return {string} the MGRS string for the given location and accuracy.\n\t */\n\tfunction forward$1(ll, accuracy) {\n\t  accuracy = accuracy || 5; // default accuracy 1m\n\t  return encode(LLtoUTM({\n\t    lat: ll[1],\n\t    lon: ll[0]\n\t  }), accuracy);\n\t}\n\n\t/**\n\t * Conversion of MGRS to lat/lon.\n\t *\n\t * @param {string} mgrs MGRS string.\n\t * @return {array} An array with left (longitude), bottom (latitude), right\n\t *     (longitude) and top (latitude) values in WGS84, representing the\n\t *     bounding box for the provided MGRS reference.\n\t */\n\tfunction inverse$1(mgrs) {\n\t  var bbox = UTMtoLL(decode(mgrs.toUpperCase()));\n\t  if (bbox.lat && bbox.lon) {\n\t    return [bbox.lon, bbox.lat, bbox.lon, bbox.lat];\n\t  }\n\t  return [bbox.left, bbox.bottom, bbox.right, bbox.top];\n\t}\n\n\tfunction toPoint$1(mgrs) {\n\t  var bbox = UTMtoLL(decode(mgrs.toUpperCase()));\n\t  if (bbox.lat && bbox.lon) {\n\t    return [bbox.lon, bbox.lat];\n\t  }\n\t  return [(bbox.left + bbox.right) / 2, (bbox.top + bbox.bottom) / 2];\n\t}\n\t/**\n\t * Conversion from degrees to radians.\n\t *\n\t * @private\n\t * @param {number} deg the angle in degrees.\n\t * @return {number} the angle in radians.\n\t */\n\tfunction degToRad(deg) {\n\t  return (deg * (Math.PI / 180.0));\n\t}\n\n\t/**\n\t * Conversion from radians to degrees.\n\t *\n\t * @private\n\t * @param {number} rad the angle in radians.\n\t * @return {number} the angle in degrees.\n\t */\n\tfunction radToDeg(rad) {\n\t  return (180.0 * (rad / Math.PI));\n\t}\n\n\t/**\n\t * Converts a set of Longitude and Latitude co-ordinates to UTM\n\t * using the WGS84 ellipsoid.\n\t *\n\t * @private\n\t * @param {object} ll Object literal with lat and lon properties\n\t *     representing the WGS84 coordinate to be converted.\n\t * @return {object} Object literal containing the UTM value with easting,\n\t *     northing, zoneNumber and zoneLetter properties, and an optional\n\t *     accuracy property in digits. Returns null if the conversion failed.\n\t */\n\tfunction LLtoUTM(ll) {\n\t  var Lat = ll.lat;\n\t  var Long = ll.lon;\n\t  var a = 6378137.0; //ellip.radius;\n\t  var eccSquared = 0.00669438; //ellip.eccsq;\n\t  var k0 = 0.9996;\n\t  var LongOrigin;\n\t  var eccPrimeSquared;\n\t  var N, T, C, A, M;\n\t  var LatRad = degToRad(Lat);\n\t  var LongRad = degToRad(Long);\n\t  var LongOriginRad;\n\t  var ZoneNumber;\n\t  // (int)\n\t  ZoneNumber = Math.floor((Long + 180) / 6) + 1;\n\n\t  //Make sure the longitude 180.00 is in Zone 60\n\t  if (Long === 180) {\n\t    ZoneNumber = 60;\n\t  }\n\n\t  // Special zone for Norway\n\t  if (Lat >= 56.0 && Lat < 64.0 && Long >= 3.0 && Long < 12.0) {\n\t    ZoneNumber = 32;\n\t  }\n\n\t  // Special zones for Svalbard\n\t  if (Lat >= 72.0 && Lat < 84.0) {\n\t    if (Long >= 0.0 && Long < 9.0) {\n\t      ZoneNumber = 31;\n\t    }\n\t    else if (Long >= 9.0 && Long < 21.0) {\n\t      ZoneNumber = 33;\n\t    }\n\t    else if (Long >= 21.0 && Long < 33.0) {\n\t      ZoneNumber = 35;\n\t    }\n\t    else if (Long >= 33.0 && Long < 42.0) {\n\t      ZoneNumber = 37;\n\t    }\n\t  }\n\n\t  LongOrigin = (ZoneNumber - 1) * 6 - 180 + 3; //+3 puts origin\n\t  // in middle of\n\t  // zone\n\t  LongOriginRad = degToRad(LongOrigin);\n\n\t  eccPrimeSquared = (eccSquared) / (1 - eccSquared);\n\n\t  N = a / Math.sqrt(1 - eccSquared * Math.sin(LatRad) * Math.sin(LatRad));\n\t  T = Math.tan(LatRad) * Math.tan(LatRad);\n\t  C = eccPrimeSquared * Math.cos(LatRad) * Math.cos(LatRad);\n\t  A = Math.cos(LatRad) * (LongRad - LongOriginRad);\n\n\t  M = a * ((1 - eccSquared / 4 - 3 * eccSquared * eccSquared / 64 - 5 * eccSquared * eccSquared * eccSquared / 256) * LatRad - (3 * eccSquared / 8 + 3 * eccSquared * eccSquared / 32 + 45 * eccSquared * eccSquared * eccSquared / 1024) * Math.sin(2 * LatRad) + (15 * eccSquared * eccSquared / 256 + 45 * eccSquared * eccSquared * eccSquared / 1024) * Math.sin(4 * LatRad) - (35 * eccSquared * eccSquared * eccSquared / 3072) * Math.sin(6 * LatRad));\n\n\t  var UTMEasting = (k0 * N * (A + (1 - T + C) * A * A * A / 6.0 + (5 - 18 * T + T * T + 72 * C - 58 * eccPrimeSquared) * A * A * A * A * A / 120.0) + 500000.0);\n\n\t  var UTMNorthing = (k0 * (M + N * Math.tan(LatRad) * (A * A / 2 + (5 - T + 9 * C + 4 * C * C) * A * A * A * A / 24.0 + (61 - 58 * T + T * T + 600 * C - 330 * eccPrimeSquared) * A * A * A * A * A * A / 720.0)));\n\t  if (Lat < 0.0) {\n\t    UTMNorthing += 10000000.0; //10000000 meter offset for\n\t    // southern hemisphere\n\t  }\n\n\t  return {\n\t    northing: Math.round(UTMNorthing),\n\t    easting: Math.round(UTMEasting),\n\t    zoneNumber: ZoneNumber,\n\t    zoneLetter: getLetterDesignator(Lat)\n\t  };\n\t}\n\n\t/**\n\t * Converts UTM coords to lat/long, using the WGS84 ellipsoid. This is a convenience\n\t * class where the Zone can be specified as a single string eg.\"60N\" which\n\t * is then broken down into the ZoneNumber and ZoneLetter.\n\t *\n\t * @private\n\t * @param {object} utm An object literal with northing, easting, zoneNumber\n\t *     and zoneLetter properties. If an optional accuracy property is\n\t *     provided (in meters), a bounding box will be returned instead of\n\t *     latitude and longitude.\n\t * @return {object} An object literal containing either lat and lon values\n\t *     (if no accuracy was provided), or top, right, bottom and left values\n\t *     for the bounding box calculated according to the provided accuracy.\n\t *     Returns null if the conversion failed.\n\t */\n\tfunction UTMtoLL(utm) {\n\n\t  var UTMNorthing = utm.northing;\n\t  var UTMEasting = utm.easting;\n\t  var zoneLetter = utm.zoneLetter;\n\t  var zoneNumber = utm.zoneNumber;\n\t  // check the ZoneNummber is valid\n\t  if (zoneNumber < 0 || zoneNumber > 60) {\n\t    return null;\n\t  }\n\n\t  var k0 = 0.9996;\n\t  var a = 6378137.0; //ellip.radius;\n\t  var eccSquared = 0.00669438; //ellip.eccsq;\n\t  var eccPrimeSquared;\n\t  var e1 = (1 - Math.sqrt(1 - eccSquared)) / (1 + Math.sqrt(1 - eccSquared));\n\t  var N1, T1, C1, R1, D, M;\n\t  var LongOrigin;\n\t  var mu, phi1Rad;\n\n\t  // remove 500,000 meter offset for longitude\n\t  var x = UTMEasting - 500000.0;\n\t  var y = UTMNorthing;\n\n\t  // We must know somehow if we are in the Northern or Southern\n\t  // hemisphere, this is the only time we use the letter So even\n\t  // if the Zone letter isn't exactly correct it should indicate\n\t  // the hemisphere correctly\n\t  if (zoneLetter < 'N') {\n\t    y -= 10000000.0; // remove 10,000,000 meter offset used\n\t    // for southern hemisphere\n\t  }\n\n\t  // There are 60 zones with zone 1 being at West -180 to -174\n\t  LongOrigin = (zoneNumber - 1) * 6 - 180 + 3; // +3 puts origin\n\t  // in middle of\n\t  // zone\n\n\t  eccPrimeSquared = (eccSquared) / (1 - eccSquared);\n\n\t  M = y / k0;\n\t  mu = M / (a * (1 - eccSquared / 4 - 3 * eccSquared * eccSquared / 64 - 5 * eccSquared * eccSquared * eccSquared / 256));\n\n\t  phi1Rad = mu + (3 * e1 / 2 - 27 * e1 * e1 * e1 / 32) * Math.sin(2 * mu) + (21 * e1 * e1 / 16 - 55 * e1 * e1 * e1 * e1 / 32) * Math.sin(4 * mu) + (151 * e1 * e1 * e1 / 96) * Math.sin(6 * mu);\n\t  // double phi1 = ProjMath.radToDeg(phi1Rad);\n\n\t  N1 = a / Math.sqrt(1 - eccSquared * Math.sin(phi1Rad) * Math.sin(phi1Rad));\n\t  T1 = Math.tan(phi1Rad) * Math.tan(phi1Rad);\n\t  C1 = eccPrimeSquared * Math.cos(phi1Rad) * Math.cos(phi1Rad);\n\t  R1 = a * (1 - eccSquared) / Math.pow(1 - eccSquared * Math.sin(phi1Rad) * Math.sin(phi1Rad), 1.5);\n\t  D = x / (N1 * k0);\n\n\t  var lat = phi1Rad - (N1 * Math.tan(phi1Rad) / R1) * (D * D / 2 - (5 + 3 * T1 + 10 * C1 - 4 * C1 * C1 - 9 * eccPrimeSquared) * D * D * D * D / 24 + (61 + 90 * T1 + 298 * C1 + 45 * T1 * T1 - 252 * eccPrimeSquared - 3 * C1 * C1) * D * D * D * D * D * D / 720);\n\t  lat = radToDeg(lat);\n\n\t  var lon = (D - (1 + 2 * T1 + C1) * D * D * D / 6 + (5 - 2 * C1 + 28 * T1 - 3 * C1 * C1 + 8 * eccPrimeSquared + 24 * T1 * T1) * D * D * D * D * D / 120) / Math.cos(phi1Rad);\n\t  lon = LongOrigin + radToDeg(lon);\n\n\t  var result;\n\t  if (utm.accuracy) {\n\t    var topRight = UTMtoLL({\n\t      northing: utm.northing + utm.accuracy,\n\t      easting: utm.easting + utm.accuracy,\n\t      zoneLetter: utm.zoneLetter,\n\t      zoneNumber: utm.zoneNumber\n\t    });\n\t    result = {\n\t      top: topRight.lat,\n\t      right: topRight.lon,\n\t      bottom: lat,\n\t      left: lon\n\t    };\n\t  }\n\t  else {\n\t    result = {\n\t      lat: lat,\n\t      lon: lon\n\t    };\n\t  }\n\t  return result;\n\t}\n\n\t/**\n\t * Calculates the MGRS letter designator for the given latitude.\n\t *\n\t * @private\n\t * @param {number} lat The latitude in WGS84 to get the letter designator\n\t *     for.\n\t * @return {char} The letter designator.\n\t */\n\tfunction getLetterDesignator(lat) {\n\t  //This is here as an error flag to show that the Latitude is\n\t  //outside MGRS limits\n\t  var LetterDesignator = 'Z';\n\n\t  if ((84 >= lat) && (lat >= 72)) {\n\t    LetterDesignator = 'X';\n\t  }\n\t  else if ((72 > lat) && (lat >= 64)) {\n\t    LetterDesignator = 'W';\n\t  }\n\t  else if ((64 > lat) && (lat >= 56)) {\n\t    LetterDesignator = 'V';\n\t  }\n\t  else if ((56 > lat) && (lat >= 48)) {\n\t    LetterDesignator = 'U';\n\t  }\n\t  else if ((48 > lat) && (lat >= 40)) {\n\t    LetterDesignator = 'T';\n\t  }\n\t  else if ((40 > lat) && (lat >= 32)) {\n\t    LetterDesignator = 'S';\n\t  }\n\t  else if ((32 > lat) && (lat >= 24)) {\n\t    LetterDesignator = 'R';\n\t  }\n\t  else if ((24 > lat) && (lat >= 16)) {\n\t    LetterDesignator = 'Q';\n\t  }\n\t  else if ((16 > lat) && (lat >= 8)) {\n\t    LetterDesignator = 'P';\n\t  }\n\t  else if ((8 > lat) && (lat >= 0)) {\n\t    LetterDesignator = 'N';\n\t  }\n\t  else if ((0 > lat) && (lat >= -8)) {\n\t    LetterDesignator = 'M';\n\t  }\n\t  else if ((-8 > lat) && (lat >= -16)) {\n\t    LetterDesignator = 'L';\n\t  }\n\t  else if ((-16 > lat) && (lat >= -24)) {\n\t    LetterDesignator = 'K';\n\t  }\n\t  else if ((-24 > lat) && (lat >= -32)) {\n\t    LetterDesignator = 'J';\n\t  }\n\t  else if ((-32 > lat) && (lat >= -40)) {\n\t    LetterDesignator = 'H';\n\t  }\n\t  else if ((-40 > lat) && (lat >= -48)) {\n\t    LetterDesignator = 'G';\n\t  }\n\t  else if ((-48 > lat) && (lat >= -56)) {\n\t    LetterDesignator = 'F';\n\t  }\n\t  else if ((-56 > lat) && (lat >= -64)) {\n\t    LetterDesignator = 'E';\n\t  }\n\t  else if ((-64 > lat) && (lat >= -72)) {\n\t    LetterDesignator = 'D';\n\t  }\n\t  else if ((-72 > lat) && (lat >= -80)) {\n\t    LetterDesignator = 'C';\n\t  }\n\t  return LetterDesignator;\n\t}\n\n\t/**\n\t * Encodes a UTM location as MGRS string.\n\t *\n\t * @private\n\t * @param {object} utm An object literal with easting, northing,\n\t *     zoneLetter, zoneNumber\n\t * @param {number} accuracy Accuracy in digits (1-5).\n\t * @return {string} MGRS string for the given UTM location.\n\t */\n\tfunction encode(utm, accuracy) {\n\t  // prepend with leading zeroes\n\t  var seasting = \"00000\" + utm.easting,\n\t    snorthing = \"00000\" + utm.northing;\n\n\t  return utm.zoneNumber + utm.zoneLetter + get100kID(utm.easting, utm.northing, utm.zoneNumber) + seasting.substr(seasting.length - 5, accuracy) + snorthing.substr(snorthing.length - 5, accuracy);\n\t}\n\n\t/**\n\t * Get the two letter 100k designator for a given UTM easting,\n\t * northing and zone number value.\n\t *\n\t * @private\n\t * @param {number} easting\n\t * @param {number} northing\n\t * @param {number} zoneNumber\n\t * @return the two letter 100k designator for the given UTM location.\n\t */\n\tfunction get100kID(easting, northing, zoneNumber) {\n\t  var setParm = get100kSetForZone(zoneNumber);\n\t  var setColumn = Math.floor(easting / 100000);\n\t  var setRow = Math.floor(northing / 100000) % 20;\n\t  return getLetter100kID(setColumn, setRow, setParm);\n\t}\n\n\t/**\n\t * Given a UTM zone number, figure out the MGRS 100K set it is in.\n\t *\n\t * @private\n\t * @param {number} i An UTM zone number.\n\t * @return {number} the 100k set the UTM zone is in.\n\t */\n\tfunction get100kSetForZone(i) {\n\t  var setParm = i % NUM_100K_SETS;\n\t  if (setParm === 0) {\n\t    setParm = NUM_100K_SETS;\n\t  }\n\n\t  return setParm;\n\t}\n\n\t/**\n\t * Get the two-letter MGRS 100k designator given information\n\t * translated from the UTM northing, easting and zone number.\n\t *\n\t * @private\n\t * @param {number} column the column index as it relates to the MGRS\n\t *        100k set spreadsheet, created from the UTM easting.\n\t *        Values are 1-8.\n\t * @param {number} row the row index as it relates to the MGRS 100k set\n\t *        spreadsheet, created from the UTM northing value. Values\n\t *        are from 0-19.\n\t * @param {number} parm the set block, as it relates to the MGRS 100k set\n\t *        spreadsheet, created from the UTM zone. Values are from\n\t *        1-60.\n\t * @return two letter MGRS 100k code.\n\t */\n\tfunction getLetter100kID(column, row, parm) {\n\t  // colOrigin and rowOrigin are the letters at the origin of the set\n\t  var index = parm - 1;\n\t  var colOrigin = SET_ORIGIN_COLUMN_LETTERS.charCodeAt(index);\n\t  var rowOrigin = SET_ORIGIN_ROW_LETTERS.charCodeAt(index);\n\n\t  // colInt and rowInt are the letters to build to return\n\t  var colInt = colOrigin + column - 1;\n\t  var rowInt = rowOrigin + row;\n\t  var rollover = false;\n\n\t  if (colInt > Z) {\n\t    colInt = colInt - Z + A - 1;\n\t    rollover = true;\n\t  }\n\n\t  if (colInt === I || (colOrigin < I && colInt > I) || ((colInt > I || colOrigin < I) && rollover)) {\n\t    colInt++;\n\t  }\n\n\t  if (colInt === O || (colOrigin < O && colInt > O) || ((colInt > O || colOrigin < O) && rollover)) {\n\t    colInt++;\n\n\t    if (colInt === I) {\n\t      colInt++;\n\t    }\n\t  }\n\n\t  if (colInt > Z) {\n\t    colInt = colInt - Z + A - 1;\n\t  }\n\n\t  if (rowInt > V) {\n\t    rowInt = rowInt - V + A - 1;\n\t    rollover = true;\n\t  }\n\t  else {\n\t    rollover = false;\n\t  }\n\n\t  if (((rowInt === I) || ((rowOrigin < I) && (rowInt > I))) || (((rowInt > I) || (rowOrigin < I)) && rollover)) {\n\t    rowInt++;\n\t  }\n\n\t  if (((rowInt === O) || ((rowOrigin < O) && (rowInt > O))) || (((rowInt > O) || (rowOrigin < O)) && rollover)) {\n\t    rowInt++;\n\n\t    if (rowInt === I) {\n\t      rowInt++;\n\t    }\n\t  }\n\n\t  if (rowInt > V) {\n\t    rowInt = rowInt - V + A - 1;\n\t  }\n\n\t  var twoLetter = String.fromCharCode(colInt) + String.fromCharCode(rowInt);\n\t  return twoLetter;\n\t}\n\n\t/**\n\t * Decode the UTM parameters from a MGRS string.\n\t *\n\t * @private\n\t * @param {string} mgrsString an UPPERCASE coordinate string is expected.\n\t * @return {object} An object literal with easting, northing, zoneLetter,\n\t *     zoneNumber and accuracy (in meters) properties.\n\t */\n\tfunction decode(mgrsString) {\n\n\t  if (mgrsString && mgrsString.length === 0) {\n\t    throw (\"MGRSPoint coverting from nothing\");\n\t  }\n\n\t  var length = mgrsString.length;\n\n\t  var hunK = null;\n\t  var sb = \"\";\n\t  var testChar;\n\t  var i = 0;\n\n\t  // get Zone number\n\t  while (!(/[A-Z]/).test(testChar = mgrsString.charAt(i))) {\n\t    if (i >= 2) {\n\t      throw (\"MGRSPoint bad conversion from: \" + mgrsString);\n\t    }\n\t    sb += testChar;\n\t    i++;\n\t  }\n\n\t  var zoneNumber = parseInt(sb, 10);\n\n\t  if (i === 0 || i + 3 > length) {\n\t    // A good MGRS string has to be 4-5 digits long,\n\t    // ##AAA/#AAA at least.\n\t    throw (\"MGRSPoint bad conversion from: \" + mgrsString);\n\t  }\n\n\t  var zoneLetter = mgrsString.charAt(i++);\n\n\t  // Should we check the zone letter here? Why not.\n\t  if (zoneLetter <= 'A' || zoneLetter === 'B' || zoneLetter === 'Y' || zoneLetter >= 'Z' || zoneLetter === 'I' || zoneLetter === 'O') {\n\t    throw (\"MGRSPoint zone letter \" + zoneLetter + \" not handled: \" + mgrsString);\n\t  }\n\n\t  hunK = mgrsString.substring(i, i += 2);\n\n\t  var set = get100kSetForZone(zoneNumber);\n\n\t  var east100k = getEastingFromChar(hunK.charAt(0), set);\n\t  var north100k = getNorthingFromChar(hunK.charAt(1), set);\n\n\t  // We have a bug where the northing may be 2000000 too low.\n\t  // How\n\t  // do we know when to roll over?\n\n\t  while (north100k < getMinNorthing(zoneLetter)) {\n\t    north100k += 2000000;\n\t  }\n\n\t  // calculate the char index for easting/northing separator\n\t  var remainder = length - i;\n\n\t  if (remainder % 2 !== 0) {\n\t    throw (\"MGRSPoint has to have an even number \\nof digits after the zone letter and two 100km letters - front \\nhalf for easting meters, second half for \\nnorthing meters\" + mgrsString);\n\t  }\n\n\t  var sep = remainder / 2;\n\n\t  var sepEasting = 0.0;\n\t  var sepNorthing = 0.0;\n\t  var accuracyBonus, sepEastingString, sepNorthingString, easting, northing;\n\t  if (sep > 0) {\n\t    accuracyBonus = 100000.0 / Math.pow(10, sep);\n\t    sepEastingString = mgrsString.substring(i, i + sep);\n\t    sepEasting = parseFloat(sepEastingString) * accuracyBonus;\n\t    sepNorthingString = mgrsString.substring(i + sep);\n\t    sepNorthing = parseFloat(sepNorthingString) * accuracyBonus;\n\t  }\n\n\t  easting = sepEasting + east100k;\n\t  northing = sepNorthing + north100k;\n\n\t  return {\n\t    easting: easting,\n\t    northing: northing,\n\t    zoneLetter: zoneLetter,\n\t    zoneNumber: zoneNumber,\n\t    accuracy: accuracyBonus\n\t  };\n\t}\n\n\t/**\n\t * Given the first letter from a two-letter MGRS 100k zone, and given the\n\t * MGRS table set for the zone number, figure out the easting value that\n\t * should be added to the other, secondary easting value.\n\t *\n\t * @private\n\t * @param {char} e The first letter from a two-letter MGRS 100k zone.\n\t * @param {number} set The MGRS table set for the zone number.\n\t * @return {number} The easting value for the given letter and set.\n\t */\n\tfunction getEastingFromChar(e, set) {\n\t  // colOrigin is the letter at the origin of the set for the\n\t  // column\n\t  var curCol = SET_ORIGIN_COLUMN_LETTERS.charCodeAt(set - 1);\n\t  var eastingValue = 100000.0;\n\t  var rewindMarker = false;\n\n\t  while (curCol !== e.charCodeAt(0)) {\n\t    curCol++;\n\t    if (curCol === I) {\n\t      curCol++;\n\t    }\n\t    if (curCol === O) {\n\t      curCol++;\n\t    }\n\t    if (curCol > Z) {\n\t      if (rewindMarker) {\n\t        throw (\"Bad character: \" + e);\n\t      }\n\t      curCol = A;\n\t      rewindMarker = true;\n\t    }\n\t    eastingValue += 100000.0;\n\t  }\n\n\t  return eastingValue;\n\t}\n\n\t/**\n\t * Given the second letter from a two-letter MGRS 100k zone, and given the\n\t * MGRS table set for the zone number, figure out the northing value that\n\t * should be added to the other, secondary northing value. You have to\n\t * remember that Northings are determined from the equator, and the vertical\n\t * cycle of letters mean a 2000000 additional northing meters. This happens\n\t * approx. every 18 degrees of latitude. This method does *NOT* count any\n\t * additional northings. You have to figure out how many 2000000 meters need\n\t * to be added for the zone letter of the MGRS coordinate.\n\t *\n\t * @private\n\t * @param {char} n Second letter of the MGRS 100k zone\n\t * @param {number} set The MGRS table set number, which is dependent on the\n\t *     UTM zone number.\n\t * @return {number} The northing value for the given letter and set.\n\t */\n\tfunction getNorthingFromChar(n, set) {\n\n\t  if (n > 'V') {\n\t    throw (\"MGRSPoint given invalid Northing \" + n);\n\t  }\n\n\t  // rowOrigin is the letter at the origin of the set for the\n\t  // column\n\t  var curRow = SET_ORIGIN_ROW_LETTERS.charCodeAt(set - 1);\n\t  var northingValue = 0.0;\n\t  var rewindMarker = false;\n\n\t  while (curRow !== n.charCodeAt(0)) {\n\t    curRow++;\n\t    if (curRow === I) {\n\t      curRow++;\n\t    }\n\t    if (curRow === O) {\n\t      curRow++;\n\t    }\n\t    // fixing a bug making whole application hang in this loop\n\t    // when 'n' is a wrong character\n\t    if (curRow > V) {\n\t      if (rewindMarker) { // making sure that this loop ends\n\t        throw (\"Bad character: \" + n);\n\t      }\n\t      curRow = A;\n\t      rewindMarker = true;\n\t    }\n\t    northingValue += 100000.0;\n\t  }\n\n\t  return northingValue;\n\t}\n\n\t/**\n\t * The function getMinNorthing returns the minimum northing value of a MGRS\n\t * zone.\n\t *\n\t * Ported from Geotrans' c Lattitude_Band_Value structure table.\n\t *\n\t * @private\n\t * @param {char} zoneLetter The MGRS zone to get the min northing for.\n\t * @return {number}\n\t */\n\tfunction getMinNorthing(zoneLetter) {\n\t  var northing;\n\t  switch (zoneLetter) {\n\t  case 'C':\n\t    northing = 1100000.0;\n\t    break;\n\t  case 'D':\n\t    northing = 2000000.0;\n\t    break;\n\t  case 'E':\n\t    northing = 2800000.0;\n\t    break;\n\t  case 'F':\n\t    northing = 3700000.0;\n\t    break;\n\t  case 'G':\n\t    northing = 4600000.0;\n\t    break;\n\t  case 'H':\n\t    northing = 5500000.0;\n\t    break;\n\t  case 'J':\n\t    northing = 6400000.0;\n\t    break;\n\t  case 'K':\n\t    northing = 7300000.0;\n\t    break;\n\t  case 'L':\n\t    northing = 8200000.0;\n\t    break;\n\t  case 'M':\n\t    northing = 9100000.0;\n\t    break;\n\t  case 'N':\n\t    northing = 0.0;\n\t    break;\n\t  case 'P':\n\t    northing = 800000.0;\n\t    break;\n\t  case 'Q':\n\t    northing = 1700000.0;\n\t    break;\n\t  case 'R':\n\t    northing = 2600000.0;\n\t    break;\n\t  case 'S':\n\t    northing = 3500000.0;\n\t    break;\n\t  case 'T':\n\t    northing = 4400000.0;\n\t    break;\n\t  case 'U':\n\t    northing = 5300000.0;\n\t    break;\n\t  case 'V':\n\t    northing = 6200000.0;\n\t    break;\n\t  case 'W':\n\t    northing = 7000000.0;\n\t    break;\n\t  case 'X':\n\t    northing = 7900000.0;\n\t    break;\n\t  default:\n\t    northing = -1.0;\n\t  }\n\t  if (northing >= 0.0) {\n\t    return northing;\n\t  }\n\t  else {\n\t    throw (\"Invalid zone letter: \" + zoneLetter);\n\t  }\n\n\t}\n\n\tfunction Point(x, y, z) {\n\t  if (!(this instanceof Point)) {\n\t    return new Point(x, y, z);\n\t  }\n\t  if (Array.isArray(x)) {\n\t    this.x = x[0];\n\t    this.y = x[1];\n\t    this.z = x[2] || 0.0;\n\t  } else if(typeof x === 'object') {\n\t    this.x = x.x;\n\t    this.y = x.y;\n\t    this.z = x.z || 0.0;\n\t  } else if (typeof x === 'string' && typeof y === 'undefined') {\n\t    var coords = x.split(',');\n\t    this.x = parseFloat(coords[0], 10);\n\t    this.y = parseFloat(coords[1], 10);\n\t    this.z = parseFloat(coords[2], 10) || 0.0;\n\t  } else {\n\t    this.x = x;\n\t    this.y = y;\n\t    this.z = z || 0.0;\n\t  }\n\t  console.warn('proj4.Point will be removed in version 3, use proj4.toPoint');\n\t}\n\n\tPoint.fromMGRS = function(mgrsStr) {\n\t  return new Point(toPoint$1(mgrsStr));\n\t};\n\tPoint.prototype.toMGRS = function(accuracy) {\n\t  return forward$1([this.x, this.y], accuracy);\n\t};\n\n\tvar version = \"2.4.4\";\n\n\tvar C00 = 1;\n\tvar C02 = 0.25;\n\tvar C04 = 0.046875;\n\tvar C06 = 0.01953125;\n\tvar C08 = 0.01068115234375;\n\tvar C22 = 0.75;\n\tvar C44 = 0.46875;\n\tvar C46 = 0.01302083333333333333;\n\tvar C48 = 0.00712076822916666666;\n\tvar C66 = 0.36458333333333333333;\n\tvar C68 = 0.00569661458333333333;\n\tvar C88 = 0.3076171875;\n\n\tvar pj_enfn = function(es) {\n\t  var en = [];\n\t  en[0] = C00 - es * (C02 + es * (C04 + es * (C06 + es * C08)));\n\t  en[1] = es * (C22 - es * (C04 + es * (C06 + es * C08)));\n\t  var t = es * es;\n\t  en[2] = t * (C44 - es * (C46 + es * C48));\n\t  t *= es;\n\t  en[3] = t * (C66 - es * C68);\n\t  en[4] = t * es * C88;\n\t  return en;\n\t};\n\n\tvar pj_mlfn = function(phi, sphi, cphi, en) {\n\t  cphi *= sphi;\n\t  sphi *= sphi;\n\t  return (en[0] * phi - cphi * (en[1] + sphi * (en[2] + sphi * (en[3] + sphi * en[4]))));\n\t};\n\n\tvar MAX_ITER = 20;\n\n\tvar pj_inv_mlfn = function(arg, es, en) {\n\t  var k = 1 / (1 - es);\n\t  var phi = arg;\n\t  for (var i = MAX_ITER; i; --i) { /* rarely goes over 2 iterations */\n\t    var s = Math.sin(phi);\n\t    var t = 1 - es * s * s;\n\t    //t = this.pj_mlfn(phi, s, Math.cos(phi), en) - arg;\n\t    //phi -= t * (t * Math.sqrt(t)) * k;\n\t    t = (pj_mlfn(phi, s, Math.cos(phi), en) - arg) * (t * Math.sqrt(t)) * k;\n\t    phi -= t;\n\t    if (Math.abs(t) < EPSLN) {\n\t      return phi;\n\t    }\n\t  }\n\t  //..reportError(\"cass:pj_inv_mlfn: Convergence error\");\n\t  return phi;\n\t};\n\n\t// Heavily based on this tmerc projection implementation\n\t// https://github.com/mbloch/mapshaper-proj/blob/master/src/projections/tmerc.js\n\n\tfunction init$2() {\n\t  this.x0 = this.x0 !== undefined ? this.x0 : 0;\n\t  this.y0 = this.y0 !== undefined ? this.y0 : 0;\n\t  this.long0 = this.long0 !== undefined ? this.long0 : 0;\n\t  this.lat0 = this.lat0 !== undefined ? this.lat0 : 0;\n\n\t  if (this.es) {\n\t    this.en = pj_enfn(this.es);\n\t    this.ml0 = pj_mlfn(this.lat0, Math.sin(this.lat0), Math.cos(this.lat0), this.en);\n\t  }\n\t}\n\n\t/**\n\t    Transverse Mercator Forward  - long/lat to x/y\n\t    long/lat in radians\n\t  */\n\tfunction forward$2(p) {\n\t  var lon = p.x;\n\t  var lat = p.y;\n\n\t  var delta_lon = adjust_lon(lon - this.long0);\n\t  var con;\n\t  var x, y;\n\t  var sin_phi = Math.sin(lat);\n\t  var cos_phi = Math.cos(lat);\n\n\t  if (!this.es) {\n\t    var b = cos_phi * Math.sin(delta_lon);\n\n\t    if ((Math.abs(Math.abs(b) - 1)) < EPSLN) {\n\t      return (93);\n\t    }\n\t    else {\n\t      x = 0.5 * this.a * this.k0 * Math.log((1 + b) / (1 - b)) + this.x0;\n\t      y = cos_phi * Math.cos(delta_lon) / Math.sqrt(1 - Math.pow(b, 2));\n\t      b = Math.abs(y);\n\n\t      if (b >= 1) {\n\t        if ((b - 1) > EPSLN) {\n\t          return (93);\n\t        }\n\t        else {\n\t          y = 0;\n\t        }\n\t      }\n\t      else {\n\t        y = Math.acos(y);\n\t      }\n\n\t      if (lat < 0) {\n\t        y = -y;\n\t      }\n\n\t      y = this.a * this.k0 * (y - this.lat0) + this.y0;\n\t    }\n\t  }\n\t  else {\n\t    var al = cos_phi * delta_lon;\n\t    var als = Math.pow(al, 2);\n\t    var c = this.ep2 * Math.pow(cos_phi, 2);\n\t    var cs = Math.pow(c, 2);\n\t    var tq = Math.abs(cos_phi) > EPSLN ? Math.tan(lat) : 0;\n\t    var t = Math.pow(tq, 2);\n\t    var ts = Math.pow(t, 2);\n\t    con = 1 - this.es * Math.pow(sin_phi, 2);\n\t    al = al / Math.sqrt(con);\n\t    var ml = pj_mlfn(lat, sin_phi, cos_phi, this.en);\n\n\t    x = this.a * (this.k0 * al * (1 +\n\t      als / 6 * (1 - t + c +\n\t      als / 20 * (5 - 18 * t + ts + 14 * c - 58 * t * c +\n\t      als / 42 * (61 + 179 * ts - ts * t - 479 * t))))) +\n\t      this.x0;\n\n\t    y = this.a * (this.k0 * (ml - this.ml0 +\n\t      sin_phi * delta_lon * al / 2 * (1 +\n\t      als / 12 * (5 - t + 9 * c + 4 * cs +\n\t      als / 30 * (61 + ts - 58 * t + 270 * c - 330 * t * c +\n\t      als / 56 * (1385 + 543 * ts - ts * t - 3111 * t)))))) +\n\t      this.y0;\n\t  }\n\n\t  p.x = x;\n\t  p.y = y;\n\n\t  return p;\n\t}\n\n\t/**\n\t    Transverse Mercator Inverse  -  x/y to long/lat\n\t  */\n\tfunction inverse$2(p) {\n\t  var con, phi;\n\t  var lat, lon;\n\t  var x = (p.x - this.x0) * (1 / this.a);\n\t  var y = (p.y - this.y0) * (1 / this.a);\n\n\t  if (!this.es) {\n\t    var f = Math.exp(x / this.k0);\n\t    var g = 0.5 * (f - 1 / f);\n\t    var temp = this.lat0 + y / this.k0;\n\t    var h = Math.cos(temp);\n\t    con = Math.sqrt((1 - Math.pow(h, 2)) / (1 + Math.pow(g, 2)));\n\t    lat = Math.asin(con);\n\n\t    if (y < 0) {\n\t      lat = -lat;\n\t    }\n\n\t    if ((g === 0) && (h === 0)) {\n\t      lon = 0;\n\t    }\n\t    else {\n\t      lon = adjust_lon(Math.atan2(g, h) + this.long0);\n\t    }\n\t  }\n\t  else { // ellipsoidal form\n\t    con = this.ml0 + y / this.k0;\n\t    phi = pj_inv_mlfn(con, this.es, this.en);\n\n\t    if (Math.abs(phi) < HALF_PI) {\n\t      var sin_phi = Math.sin(phi);\n\t      var cos_phi = Math.cos(phi);\n\t      var tan_phi = Math.abs(cos_phi) > EPSLN ? Math.tan(phi) : 0;\n\t      var c = this.ep2 * Math.pow(cos_phi, 2);\n\t      var cs = Math.pow(c, 2);\n\t      var t = Math.pow(tan_phi, 2);\n\t      var ts = Math.pow(t, 2);\n\t      con = 1 - this.es * Math.pow(sin_phi, 2);\n\t      var d = x * Math.sqrt(con) / this.k0;\n\t      var ds = Math.pow(d, 2);\n\t      con = con * tan_phi;\n\n\t      lat = phi - (con * ds / (1 - this.es)) * 0.5 * (1 -\n\t        ds / 12 * (5 + 3 * t - 9 * c * t + c - 4 * cs -\n\t        ds / 30 * (61 + 90 * t - 252 * c * t + 45 * ts + 46 * c -\n\t        ds / 56 * (1385 + 3633 * t + 4095 * ts + 1574 * ts * t))));\n\n\t      lon = adjust_lon(this.long0 + (d * (1 -\n\t        ds / 6 * (1 + 2 * t + c -\n\t        ds / 20 * (5 + 28 * t + 24 * ts + 8 * c * t + 6 * c -\n\t        ds / 42 * (61 + 662 * t + 1320 * ts + 720 * ts * t)))) / cos_phi));\n\t    }\n\t    else {\n\t      lat = HALF_PI * sign(y);\n\t      lon = 0;\n\t    }\n\t  }\n\n\t  p.x = lon;\n\t  p.y = lat;\n\n\t  return p;\n\t}\n\n\tvar names$3 = [\"Transverse_Mercator\", \"Transverse Mercator\", \"tmerc\"];\n\tvar tmerc = {\n\t  init: init$2,\n\t  forward: forward$2,\n\t  inverse: inverse$2,\n\t  names: names$3\n\t};\n\n\tvar sinh = function(x) {\n\t  var r = Math.exp(x);\n\t  r = (r - 1 / r) / 2;\n\t  return r;\n\t};\n\n\tvar hypot = function(x, y) {\n\t  x = Math.abs(x);\n\t  y = Math.abs(y);\n\t  var a = Math.max(x, y);\n\t  var b = Math.min(x, y) / (a ? a : 1);\n\n\t  return a * Math.sqrt(1 + Math.pow(b, 2));\n\t};\n\n\tvar log1py = function(x) {\n\t  var y = 1 + x;\n\t  var z = y - 1;\n\n\t  return z === 0 ? x : x * Math.log(y) / z;\n\t};\n\n\tvar asinhy = function(x) {\n\t  var y = Math.abs(x);\n\t  y = log1py(y * (1 + y / (hypot(1, y) + 1)));\n\n\t  return x < 0 ? -y : y;\n\t};\n\n\tvar gatg = function(pp, B) {\n\t  var cos_2B = 2 * Math.cos(2 * B);\n\t  var i = pp.length - 1;\n\t  var h1 = pp[i];\n\t  var h2 = 0;\n\t  var h;\n\n\t  while (--i >= 0) {\n\t    h = -h2 + cos_2B * h1 + pp[i];\n\t    h2 = h1;\n\t    h1 = h;\n\t  }\n\n\t  return (B + h * Math.sin(2 * B));\n\t};\n\n\tvar clens = function(pp, arg_r) {\n\t  var r = 2 * Math.cos(arg_r);\n\t  var i = pp.length - 1;\n\t  var hr1 = pp[i];\n\t  var hr2 = 0;\n\t  var hr;\n\n\t  while (--i >= 0) {\n\t    hr = -hr2 + r * hr1 + pp[i];\n\t    hr2 = hr1;\n\t    hr1 = hr;\n\t  }\n\n\t  return Math.sin(arg_r) * hr;\n\t};\n\n\tvar cosh = function(x) {\n\t  var r = Math.exp(x);\n\t  r = (r + 1 / r) / 2;\n\t  return r;\n\t};\n\n\tvar clens_cmplx = function(pp, arg_r, arg_i) {\n\t  var sin_arg_r = Math.sin(arg_r);\n\t  var cos_arg_r = Math.cos(arg_r);\n\t  var sinh_arg_i = sinh(arg_i);\n\t  var cosh_arg_i = cosh(arg_i);\n\t  var r = 2 * cos_arg_r * cosh_arg_i;\n\t  var i = -2 * sin_arg_r * sinh_arg_i;\n\t  var j = pp.length - 1;\n\t  var hr = pp[j];\n\t  var hi1 = 0;\n\t  var hr1 = 0;\n\t  var hi = 0;\n\t  var hr2;\n\t  var hi2;\n\n\t  while (--j >= 0) {\n\t    hr2 = hr1;\n\t    hi2 = hi1;\n\t    hr1 = hr;\n\t    hi1 = hi;\n\t    hr = -hr2 + r * hr1 - i * hi1 + pp[j];\n\t    hi = -hi2 + i * hr1 + r * hi1;\n\t  }\n\n\t  r = sin_arg_r * cosh_arg_i;\n\t  i = cos_arg_r * sinh_arg_i;\n\n\t  return [r * hr - i * hi, r * hi + i * hr];\n\t};\n\n\t// Heavily based on this etmerc projection implementation\n\t// https://github.com/mbloch/mapshaper-proj/blob/master/src/projections/etmerc.js\n\n\tfunction init$3() {\n\t  if (this.es === undefined || this.es <= 0) {\n\t    throw new Error('incorrect elliptical usage');\n\t  }\n\n\t  this.x0 = this.x0 !== undefined ? this.x0 : 0;\n\t  this.y0 = this.y0 !== undefined ? this.y0 : 0;\n\t  this.long0 = this.long0 !== undefined ? this.long0 : 0;\n\t  this.lat0 = this.lat0 !== undefined ? this.lat0 : 0;\n\n\t  this.cgb = [];\n\t  this.cbg = [];\n\t  this.utg = [];\n\t  this.gtu = [];\n\n\t  var f = this.es / (1 + Math.sqrt(1 - this.es));\n\t  var n = f / (2 - f);\n\t  var np = n;\n\n\t  this.cgb[0] = n * (2 + n * (-2 / 3 + n * (-2 + n * (116 / 45 + n * (26 / 45 + n * (-2854 / 675 ))))));\n\t  this.cbg[0] = n * (-2 + n * ( 2 / 3 + n * ( 4 / 3 + n * (-82 / 45 + n * (32 / 45 + n * (4642 / 4725))))));\n\n\t  np = np * n;\n\t  this.cgb[1] = np * (7 / 3 + n * (-8 / 5 + n * (-227 / 45 + n * (2704 / 315 + n * (2323 / 945)))));\n\t  this.cbg[1] = np * (5 / 3 + n * (-16 / 15 + n * ( -13 / 9 + n * (904 / 315 + n * (-1522 / 945)))));\n\n\t  np = np * n;\n\t  this.cgb[2] = np * (56 / 15 + n * (-136 / 35 + n * (-1262 / 105 + n * (73814 / 2835))));\n\t  this.cbg[2] = np * (-26 / 15 + n * (34 / 21 + n * (8 / 5 + n * (-12686 / 2835))));\n\n\t  np = np * n;\n\t  this.cgb[3] = np * (4279 / 630 + n * (-332 / 35 + n * (-399572 / 14175)));\n\t  this.cbg[3] = np * (1237 / 630 + n * (-12 / 5 + n * ( -24832 / 14175)));\n\n\t  np = np * n;\n\t  this.cgb[4] = np * (4174 / 315 + n * (-144838 / 6237));\n\t  this.cbg[4] = np * (-734 / 315 + n * (109598 / 31185));\n\n\t  np = np * n;\n\t  this.cgb[5] = np * (601676 / 22275);\n\t  this.cbg[5] = np * (444337 / 155925);\n\n\t  np = Math.pow(n, 2);\n\t  this.Qn = this.k0 / (1 + n) * (1 + np * (1 / 4 + np * (1 / 64 + np / 256)));\n\n\t  this.utg[0] = n * (-0.5 + n * ( 2 / 3 + n * (-37 / 96 + n * ( 1 / 360 + n * (81 / 512 + n * (-96199 / 604800))))));\n\t  this.gtu[0] = n * (0.5 + n * (-2 / 3 + n * (5 / 16 + n * (41 / 180 + n * (-127 / 288 + n * (7891 / 37800))))));\n\n\t  this.utg[1] = np * (-1 / 48 + n * (-1 / 15 + n * (437 / 1440 + n * (-46 / 105 + n * (1118711 / 3870720)))));\n\t  this.gtu[1] = np * (13 / 48 + n * (-3 / 5 + n * (557 / 1440 + n * (281 / 630 + n * (-1983433 / 1935360)))));\n\n\t  np = np * n;\n\t  this.utg[2] = np * (-17 / 480 + n * (37 / 840 + n * (209 / 4480 + n * (-5569 / 90720 ))));\n\t  this.gtu[2] = np * (61 / 240 + n * (-103 / 140 + n * (15061 / 26880 + n * (167603 / 181440))));\n\n\t  np = np * n;\n\t  this.utg[3] = np * (-4397 / 161280 + n * (11 / 504 + n * (830251 / 7257600)));\n\t  this.gtu[3] = np * (49561 / 161280 + n * (-179 / 168 + n * (6601661 / 7257600)));\n\n\t  np = np * n;\n\t  this.utg[4] = np * (-4583 / 161280 + n * (108847 / 3991680));\n\t  this.gtu[4] = np * (34729 / 80640 + n * (-3418889 / 1995840));\n\n\t  np = np * n;\n\t  this.utg[5] = np * (-20648693 / 638668800);\n\t  this.gtu[5] = np * (212378941 / 319334400);\n\n\t  var Z = gatg(this.cbg, this.lat0);\n\t  this.Zb = -this.Qn * (Z + clens(this.gtu, 2 * Z));\n\t}\n\n\tfunction forward$3(p) {\n\t  var Ce = adjust_lon(p.x - this.long0);\n\t  var Cn = p.y;\n\n\t  Cn = gatg(this.cbg, Cn);\n\t  var sin_Cn = Math.sin(Cn);\n\t  var cos_Cn = Math.cos(Cn);\n\t  var sin_Ce = Math.sin(Ce);\n\t  var cos_Ce = Math.cos(Ce);\n\n\t  Cn = Math.atan2(sin_Cn, cos_Ce * cos_Cn);\n\t  Ce = Math.atan2(sin_Ce * cos_Cn, hypot(sin_Cn, cos_Cn * cos_Ce));\n\t  Ce = asinhy(Math.tan(Ce));\n\n\t  var tmp = clens_cmplx(this.gtu, 2 * Cn, 2 * Ce);\n\n\t  Cn = Cn + tmp[0];\n\t  Ce = Ce + tmp[1];\n\n\t  var x;\n\t  var y;\n\n\t  if (Math.abs(Ce) <= 2.623395162778) {\n\t    x = this.a * (this.Qn * Ce) + this.x0;\n\t    y = this.a * (this.Qn * Cn + this.Zb) + this.y0;\n\t  }\n\t  else {\n\t    x = Infinity;\n\t    y = Infinity;\n\t  }\n\n\t  p.x = x;\n\t  p.y = y;\n\n\t  return p;\n\t}\n\n\tfunction inverse$3(p) {\n\t  var Ce = (p.x - this.x0) * (1 / this.a);\n\t  var Cn = (p.y - this.y0) * (1 / this.a);\n\n\t  Cn = (Cn - this.Zb) / this.Qn;\n\t  Ce = Ce / this.Qn;\n\n\t  var lon;\n\t  var lat;\n\n\t  if (Math.abs(Ce) <= 2.623395162778) {\n\t    var tmp = clens_cmplx(this.utg, 2 * Cn, 2 * Ce);\n\n\t    Cn = Cn + tmp[0];\n\t    Ce = Ce + tmp[1];\n\t    Ce = Math.atan(sinh(Ce));\n\n\t    var sin_Cn = Math.sin(Cn);\n\t    var cos_Cn = Math.cos(Cn);\n\t    var sin_Ce = Math.sin(Ce);\n\t    var cos_Ce = Math.cos(Ce);\n\n\t    Cn = Math.atan2(sin_Cn * cos_Ce, hypot(sin_Ce, cos_Ce * cos_Cn));\n\t    Ce = Math.atan2(sin_Ce, cos_Ce * cos_Cn);\n\n\t    lon = adjust_lon(Ce + this.long0);\n\t    lat = gatg(this.cgb, Cn);\n\t  }\n\t  else {\n\t    lon = Infinity;\n\t    lat = Infinity;\n\t  }\n\n\t  p.x = lon;\n\t  p.y = lat;\n\n\t  return p;\n\t}\n\n\tvar names$4 = [\"Extended_Transverse_Mercator\", \"Extended Transverse Mercator\", \"etmerc\"];\n\tvar etmerc = {\n\t  init: init$3,\n\t  forward: forward$3,\n\t  inverse: inverse$3,\n\t  names: names$4\n\t};\n\n\tvar adjust_zone = function(zone, lon) {\n\t  if (zone === undefined) {\n\t    zone = Math.floor((adjust_lon(lon) + Math.PI) * 30 / Math.PI) + 1;\n\n\t    if (zone < 0) {\n\t      return 0;\n\t    } else if (zone > 60) {\n\t      return 60;\n\t    }\n\t  }\n\t  return zone;\n\t};\n\n\tvar dependsOn = 'etmerc';\n\tfunction init$4() {\n\t  var zone = adjust_zone(this.zone, this.long0);\n\t  if (zone === undefined) {\n\t    throw new Error('unknown utm zone');\n\t  }\n\t  this.lat0 = 0;\n\t  this.long0 =  ((6 * Math.abs(zone)) - 183) * D2R;\n\t  this.x0 = 500000;\n\t  this.y0 = this.utmSouth ? 10000000 : 0;\n\t  this.k0 = 0.9996;\n\n\t  etmerc.init.apply(this);\n\t  this.forward = etmerc.forward;\n\t  this.inverse = etmerc.inverse;\n\t}\n\n\tvar names$5 = [\"Universal Transverse Mercator System\", \"utm\"];\n\tvar utm = {\n\t  init: init$4,\n\t  names: names$5,\n\t  dependsOn: dependsOn\n\t};\n\n\tvar srat = function(esinp, exp) {\n\t  return (Math.pow((1 - esinp) / (1 + esinp), exp));\n\t};\n\n\tvar MAX_ITER$1 = 20;\n\tfunction init$6() {\n\t  var sphi = Math.sin(this.lat0);\n\t  var cphi = Math.cos(this.lat0);\n\t  cphi *= cphi;\n\t  this.rc = Math.sqrt(1 - this.es) / (1 - this.es * sphi * sphi);\n\t  this.C = Math.sqrt(1 + this.es * cphi * cphi / (1 - this.es));\n\t  this.phic0 = Math.asin(sphi / this.C);\n\t  this.ratexp = 0.5 * this.C * this.e;\n\t  this.K = Math.tan(0.5 * this.phic0 + FORTPI) / (Math.pow(Math.tan(0.5 * this.lat0 + FORTPI), this.C) * srat(this.e * sphi, this.ratexp));\n\t}\n\n\tfunction forward$5(p) {\n\t  var lon = p.x;\n\t  var lat = p.y;\n\n\t  p.y = 2 * Math.atan(this.K * Math.pow(Math.tan(0.5 * lat + FORTPI), this.C) * srat(this.e * Math.sin(lat), this.ratexp)) - HALF_PI;\n\t  p.x = this.C * lon;\n\t  return p;\n\t}\n\n\tfunction inverse$5(p) {\n\t  var DEL_TOL = 1e-14;\n\t  var lon = p.x / this.C;\n\t  var lat = p.y;\n\t  var num = Math.pow(Math.tan(0.5 * lat + FORTPI) / this.K, 1 / this.C);\n\t  for (var i = MAX_ITER$1; i > 0; --i) {\n\t    lat = 2 * Math.atan(num * srat(this.e * Math.sin(p.y), - 0.5 * this.e)) - HALF_PI;\n\t    if (Math.abs(lat - p.y) < DEL_TOL) {\n\t      break;\n\t    }\n\t    p.y = lat;\n\t  }\n\t  /* convergence failed */\n\t  if (!i) {\n\t    return null;\n\t  }\n\t  p.x = lon;\n\t  p.y = lat;\n\t  return p;\n\t}\n\n\tvar names$7 = [\"gauss\"];\n\tvar gauss = {\n\t  init: init$6,\n\t  forward: forward$5,\n\t  inverse: inverse$5,\n\t  names: names$7\n\t};\n\n\tfunction init$5() {\n\t  gauss.init.apply(this);\n\t  if (!this.rc) {\n\t    return;\n\t  }\n\t  this.sinc0 = Math.sin(this.phic0);\n\t  this.cosc0 = Math.cos(this.phic0);\n\t  this.R2 = 2 * this.rc;\n\t  if (!this.title) {\n\t    this.title = \"Oblique Stereographic Alternative\";\n\t  }\n\t}\n\n\tfunction forward$4(p) {\n\t  var sinc, cosc, cosl, k;\n\t  p.x = adjust_lon(p.x - this.long0);\n\t  gauss.forward.apply(this, [p]);\n\t  sinc = Math.sin(p.y);\n\t  cosc = Math.cos(p.y);\n\t  cosl = Math.cos(p.x);\n\t  k = this.k0 * this.R2 / (1 + this.sinc0 * sinc + this.cosc0 * cosc * cosl);\n\t  p.x = k * cosc * Math.sin(p.x);\n\t  p.y = k * (this.cosc0 * sinc - this.sinc0 * cosc * cosl);\n\t  p.x = this.a * p.x + this.x0;\n\t  p.y = this.a * p.y + this.y0;\n\t  return p;\n\t}\n\n\tfunction inverse$4(p) {\n\t  var sinc, cosc, lon, lat, rho;\n\t  p.x = (p.x - this.x0) / this.a;\n\t  p.y = (p.y - this.y0) / this.a;\n\n\t  p.x /= this.k0;\n\t  p.y /= this.k0;\n\t  if ((rho = Math.sqrt(p.x * p.x + p.y * p.y))) {\n\t    var c = 2 * Math.atan2(rho, this.R2);\n\t    sinc = Math.sin(c);\n\t    cosc = Math.cos(c);\n\t    lat = Math.asin(cosc * this.sinc0 + p.y * sinc * this.cosc0 / rho);\n\t    lon = Math.atan2(p.x * sinc, rho * this.cosc0 * cosc - p.y * this.sinc0 * sinc);\n\t  }\n\t  else {\n\t    lat = this.phic0;\n\t    lon = 0;\n\t  }\n\n\t  p.x = lon;\n\t  p.y = lat;\n\t  gauss.inverse.apply(this, [p]);\n\t  p.x = adjust_lon(p.x + this.long0);\n\t  return p;\n\t}\n\n\tvar names$6 = [\"Stereographic_North_Pole\", \"Oblique_Stereographic\", \"Polar_Stereographic\", \"sterea\",\"Oblique Stereographic Alternative\"];\n\tvar sterea = {\n\t  init: init$5,\n\t  forward: forward$4,\n\t  inverse: inverse$4,\n\t  names: names$6\n\t};\n\n\tfunction ssfn_(phit, sinphi, eccen) {\n\t  sinphi *= eccen;\n\t  return (Math.tan(0.5 * (HALF_PI + phit)) * Math.pow((1 - sinphi) / (1 + sinphi), 0.5 * eccen));\n\t}\n\n\tfunction init$7() {\n\t  this.coslat0 = Math.cos(this.lat0);\n\t  this.sinlat0 = Math.sin(this.lat0);\n\t  if (this.sphere) {\n\t    if (this.k0 === 1 && !isNaN(this.lat_ts) && Math.abs(this.coslat0) <= EPSLN) {\n\t      this.k0 = 0.5 * (1 + sign(this.lat0) * Math.sin(this.lat_ts));\n\t    }\n\t  }\n\t  else {\n\t    if (Math.abs(this.coslat0) <= EPSLN) {\n\t      if (this.lat0 > 0) {\n\t        //North pole\n\t        //trace('stere:north pole');\n\t        this.con = 1;\n\t      }\n\t      else {\n\t        //South pole\n\t        //trace('stere:south pole');\n\t        this.con = -1;\n\t      }\n\t    }\n\t    this.cons = Math.sqrt(Math.pow(1 + this.e, 1 + this.e) * Math.pow(1 - this.e, 1 - this.e));\n\t    if (this.k0 === 1 && !isNaN(this.lat_ts) && Math.abs(this.coslat0) <= EPSLN) {\n\t      this.k0 = 0.5 * this.cons * msfnz(this.e, Math.sin(this.lat_ts), Math.cos(this.lat_ts)) / tsfnz(this.e, this.con * this.lat_ts, this.con * Math.sin(this.lat_ts));\n\t    }\n\t    this.ms1 = msfnz(this.e, this.sinlat0, this.coslat0);\n\t    this.X0 = 2 * Math.atan(this.ssfn_(this.lat0, this.sinlat0, this.e)) - HALF_PI;\n\t    this.cosX0 = Math.cos(this.X0);\n\t    this.sinX0 = Math.sin(this.X0);\n\t  }\n\t}\n\n\t// Stereographic forward equations--mapping lat,long to x,y\n\tfunction forward$6(p) {\n\t  var lon = p.x;\n\t  var lat = p.y;\n\t  var sinlat = Math.sin(lat);\n\t  var coslat = Math.cos(lat);\n\t  var A, X, sinX, cosX, ts, rh;\n\t  var dlon = adjust_lon(lon - this.long0);\n\n\t  if (Math.abs(Math.abs(lon - this.long0) - Math.PI) <= EPSLN && Math.abs(lat + this.lat0) <= EPSLN) {\n\t    //case of the origine point\n\t    //trace('stere:this is the origin point');\n\t    p.x = NaN;\n\t    p.y = NaN;\n\t    return p;\n\t  }\n\t  if (this.sphere) {\n\t    //trace('stere:sphere case');\n\t    A = 2 * this.k0 / (1 + this.sinlat0 * sinlat + this.coslat0 * coslat * Math.cos(dlon));\n\t    p.x = this.a * A * coslat * Math.sin(dlon) + this.x0;\n\t    p.y = this.a * A * (this.coslat0 * sinlat - this.sinlat0 * coslat * Math.cos(dlon)) + this.y0;\n\t    return p;\n\t  }\n\t  else {\n\t    X = 2 * Math.atan(this.ssfn_(lat, sinlat, this.e)) - HALF_PI;\n\t    cosX = Math.cos(X);\n\t    sinX = Math.sin(X);\n\t    if (Math.abs(this.coslat0) <= EPSLN) {\n\t      ts = tsfnz(this.e, lat * this.con, this.con * sinlat);\n\t      rh = 2 * this.a * this.k0 * ts / this.cons;\n\t      p.x = this.x0 + rh * Math.sin(lon - this.long0);\n\t      p.y = this.y0 - this.con * rh * Math.cos(lon - this.long0);\n\t      //trace(p.toString());\n\t      return p;\n\t    }\n\t    else if (Math.abs(this.sinlat0) < EPSLN) {\n\t      //Eq\n\t      //trace('stere:equateur');\n\t      A = 2 * this.a * this.k0 / (1 + cosX * Math.cos(dlon));\n\t      p.y = A * sinX;\n\t    }\n\t    else {\n\t      //other case\n\t      //trace('stere:normal case');\n\t      A = 2 * this.a * this.k0 * this.ms1 / (this.cosX0 * (1 + this.sinX0 * sinX + this.cosX0 * cosX * Math.cos(dlon)));\n\t      p.y = A * (this.cosX0 * sinX - this.sinX0 * cosX * Math.cos(dlon)) + this.y0;\n\t    }\n\t    p.x = A * cosX * Math.sin(dlon) + this.x0;\n\t  }\n\t  //trace(p.toString());\n\t  return p;\n\t}\n\n\t//* Stereographic inverse equations--mapping x,y to lat/long\n\tfunction inverse$6(p) {\n\t  p.x -= this.x0;\n\t  p.y -= this.y0;\n\t  var lon, lat, ts, ce, Chi;\n\t  var rh = Math.sqrt(p.x * p.x + p.y * p.y);\n\t  if (this.sphere) {\n\t    var c = 2 * Math.atan(rh / (0.5 * this.a * this.k0));\n\t    lon = this.long0;\n\t    lat = this.lat0;\n\t    if (rh <= EPSLN) {\n\t      p.x = lon;\n\t      p.y = lat;\n\t      return p;\n\t    }\n\t    lat = Math.asin(Math.cos(c) * this.sinlat0 + p.y * Math.sin(c) * this.coslat0 / rh);\n\t    if (Math.abs(this.coslat0) < EPSLN) {\n\t      if (this.lat0 > 0) {\n\t        lon = adjust_lon(this.long0 + Math.atan2(p.x, - 1 * p.y));\n\t      }\n\t      else {\n\t        lon = adjust_lon(this.long0 + Math.atan2(p.x, p.y));\n\t      }\n\t    }\n\t    else {\n\t      lon = adjust_lon(this.long0 + Math.atan2(p.x * Math.sin(c), rh * this.coslat0 * Math.cos(c) - p.y * this.sinlat0 * Math.sin(c)));\n\t    }\n\t    p.x = lon;\n\t    p.y = lat;\n\t    return p;\n\t  }\n\t  else {\n\t    if (Math.abs(this.coslat0) <= EPSLN) {\n\t      if (rh <= EPSLN) {\n\t        lat = this.lat0;\n\t        lon = this.long0;\n\t        p.x = lon;\n\t        p.y = lat;\n\t        //trace(p.toString());\n\t        return p;\n\t      }\n\t      p.x *= this.con;\n\t      p.y *= this.con;\n\t      ts = rh * this.cons / (2 * this.a * this.k0);\n\t      lat = this.con * phi2z(this.e, ts);\n\t      lon = this.con * adjust_lon(this.con * this.long0 + Math.atan2(p.x, - 1 * p.y));\n\t    }\n\t    else {\n\t      ce = 2 * Math.atan(rh * this.cosX0 / (2 * this.a * this.k0 * this.ms1));\n\t      lon = this.long0;\n\t      if (rh <= EPSLN) {\n\t        Chi = this.X0;\n\t      }\n\t      else {\n\t        Chi = Math.asin(Math.cos(ce) * this.sinX0 + p.y * Math.sin(ce) * this.cosX0 / rh);\n\t        lon = adjust_lon(this.long0 + Math.atan2(p.x * Math.sin(ce), rh * this.cosX0 * Math.cos(ce) - p.y * this.sinX0 * Math.sin(ce)));\n\t      }\n\t      lat = -1 * phi2z(this.e, Math.tan(0.5 * (HALF_PI + Chi)));\n\t    }\n\t  }\n\t  p.x = lon;\n\t  p.y = lat;\n\n\t  //trace(p.toString());\n\t  return p;\n\n\t}\n\n\tvar names$8 = [\"stere\", \"Stereographic_South_Pole\", \"Polar Stereographic (variant B)\"];\n\tvar stere = {\n\t  init: init$7,\n\t  forward: forward$6,\n\t  inverse: inverse$6,\n\t  names: names$8,\n\t  ssfn_: ssfn_\n\t};\n\n\t/*\n\t  references:\n\t    Formules et constantes pour le Calcul pour la\n\t    projection cylindrique conforme  axe oblique et pour la transformation entre\n\t    des systmes de rfrence.\n\t    http://www.swisstopo.admin.ch/internet/swisstopo/fr/home/topics/survey/sys/refsys/switzerland.parsysrelated1.31216.downloadList.77004.DownloadFile.tmp/swissprojectionfr.pdf\n\t  */\n\n\tfunction init$8() {\n\t  var phy0 = this.lat0;\n\t  this.lambda0 = this.long0;\n\t  var sinPhy0 = Math.sin(phy0);\n\t  var semiMajorAxis = this.a;\n\t  var invF = this.rf;\n\t  var flattening = 1 / invF;\n\t  var e2 = 2 * flattening - Math.pow(flattening, 2);\n\t  var e = this.e = Math.sqrt(e2);\n\t  this.R = this.k0 * semiMajorAxis * Math.sqrt(1 - e2) / (1 - e2 * Math.pow(sinPhy0, 2));\n\t  this.alpha = Math.sqrt(1 + e2 / (1 - e2) * Math.pow(Math.cos(phy0), 4));\n\t  this.b0 = Math.asin(sinPhy0 / this.alpha);\n\t  var k1 = Math.log(Math.tan(Math.PI / 4 + this.b0 / 2));\n\t  var k2 = Math.log(Math.tan(Math.PI / 4 + phy0 / 2));\n\t  var k3 = Math.log((1 + e * sinPhy0) / (1 - e * sinPhy0));\n\t  this.K = k1 - this.alpha * k2 + this.alpha * e / 2 * k3;\n\t}\n\n\tfunction forward$7(p) {\n\t  var Sa1 = Math.log(Math.tan(Math.PI / 4 - p.y / 2));\n\t  var Sa2 = this.e / 2 * Math.log((1 + this.e * Math.sin(p.y)) / (1 - this.e * Math.sin(p.y)));\n\t  var S = -this.alpha * (Sa1 + Sa2) + this.K;\n\n\t  // spheric latitude\n\t  var b = 2 * (Math.atan(Math.exp(S)) - Math.PI / 4);\n\n\t  // spheric longitude\n\t  var I = this.alpha * (p.x - this.lambda0);\n\n\t  // psoeudo equatorial rotation\n\t  var rotI = Math.atan(Math.sin(I) / (Math.sin(this.b0) * Math.tan(b) + Math.cos(this.b0) * Math.cos(I)));\n\n\t  var rotB = Math.asin(Math.cos(this.b0) * Math.sin(b) - Math.sin(this.b0) * Math.cos(b) * Math.cos(I));\n\n\t  p.y = this.R / 2 * Math.log((1 + Math.sin(rotB)) / (1 - Math.sin(rotB))) + this.y0;\n\t  p.x = this.R * rotI + this.x0;\n\t  return p;\n\t}\n\n\tfunction inverse$7(p) {\n\t  var Y = p.x - this.x0;\n\t  var X = p.y - this.y0;\n\n\t  var rotI = Y / this.R;\n\t  var rotB = 2 * (Math.atan(Math.exp(X / this.R)) - Math.PI / 4);\n\n\t  var b = Math.asin(Math.cos(this.b0) * Math.sin(rotB) + Math.sin(this.b0) * Math.cos(rotB) * Math.cos(rotI));\n\t  var I = Math.atan(Math.sin(rotI) / (Math.cos(this.b0) * Math.cos(rotI) - Math.sin(this.b0) * Math.tan(rotB)));\n\n\t  var lambda = this.lambda0 + I / this.alpha;\n\n\t  var S = 0;\n\t  var phy = b;\n\t  var prevPhy = -1000;\n\t  var iteration = 0;\n\t  while (Math.abs(phy - prevPhy) > 0.0000001) {\n\t    if (++iteration > 20) {\n\t      //...reportError(\"omercFwdInfinity\");\n\t      return;\n\t    }\n\t    //S = Math.log(Math.tan(Math.PI / 4 + phy / 2));\n\t    S = 1 / this.alpha * (Math.log(Math.tan(Math.PI / 4 + b / 2)) - this.K) + this.e * Math.log(Math.tan(Math.PI / 4 + Math.asin(this.e * Math.sin(phy)) / 2));\n\t    prevPhy = phy;\n\t    phy = 2 * Math.atan(Math.exp(S)) - Math.PI / 2;\n\t  }\n\n\t  p.x = lambda;\n\t  p.y = phy;\n\t  return p;\n\t}\n\n\tvar names$9 = [\"somerc\"];\n\tvar somerc = {\n\t  init: init$8,\n\t  forward: forward$7,\n\t  inverse: inverse$7,\n\t  names: names$9\n\t};\n\n\t/* Initialize the Oblique Mercator  projection\n\t    ------------------------------------------*/\n\tfunction init$9() {\n\t  this.no_off = this.no_off || false;\n\t  this.no_rot = this.no_rot || false;\n\n\t  if (isNaN(this.k0)) {\n\t    this.k0 = 1;\n\t  }\n\t  var sinlat = Math.sin(this.lat0);\n\t  var coslat = Math.cos(this.lat0);\n\t  var con = this.e * sinlat;\n\n\t  this.bl = Math.sqrt(1 + this.es / (1 - this.es) * Math.pow(coslat, 4));\n\t  this.al = this.a * this.bl * this.k0 * Math.sqrt(1 - this.es) / (1 - con * con);\n\t  var t0 = tsfnz(this.e, this.lat0, sinlat);\n\t  var dl = this.bl / coslat * Math.sqrt((1 - this.es) / (1 - con * con));\n\t  if (dl * dl < 1) {\n\t    dl = 1;\n\t  }\n\t  var fl;\n\t  var gl;\n\t  if (!isNaN(this.longc)) {\n\t    //Central point and azimuth method\n\n\t    if (this.lat0 >= 0) {\n\t      fl = dl + Math.sqrt(dl * dl - 1);\n\t    }\n\t    else {\n\t      fl = dl - Math.sqrt(dl * dl - 1);\n\t    }\n\t    this.el = fl * Math.pow(t0, this.bl);\n\t    gl = 0.5 * (fl - 1 / fl);\n\t    this.gamma0 = Math.asin(Math.sin(this.alpha) / dl);\n\t    this.long0 = this.longc - Math.asin(gl * Math.tan(this.gamma0)) / this.bl;\n\n\t  }\n\t  else {\n\t    //2 points method\n\t    var t1 = tsfnz(this.e, this.lat1, Math.sin(this.lat1));\n\t    var t2 = tsfnz(this.e, this.lat2, Math.sin(this.lat2));\n\t    if (this.lat0 >= 0) {\n\t      this.el = (dl + Math.sqrt(dl * dl - 1)) * Math.pow(t0, this.bl);\n\t    }\n\t    else {\n\t      this.el = (dl - Math.sqrt(dl * dl - 1)) * Math.pow(t0, this.bl);\n\t    }\n\t    var hl = Math.pow(t1, this.bl);\n\t    var ll = Math.pow(t2, this.bl);\n\t    fl = this.el / hl;\n\t    gl = 0.5 * (fl - 1 / fl);\n\t    var jl = (this.el * this.el - ll * hl) / (this.el * this.el + ll * hl);\n\t    var pl = (ll - hl) / (ll + hl);\n\t    var dlon12 = adjust_lon(this.long1 - this.long2);\n\t    this.long0 = 0.5 * (this.long1 + this.long2) - Math.atan(jl * Math.tan(0.5 * this.bl * (dlon12)) / pl) / this.bl;\n\t    this.long0 = adjust_lon(this.long0);\n\t    var dlon10 = adjust_lon(this.long1 - this.long0);\n\t    this.gamma0 = Math.atan(Math.sin(this.bl * (dlon10)) / gl);\n\t    this.alpha = Math.asin(dl * Math.sin(this.gamma0));\n\t  }\n\n\t  if (this.no_off) {\n\t    this.uc = 0;\n\t  }\n\t  else {\n\t    if (this.lat0 >= 0) {\n\t      this.uc = this.al / this.bl * Math.atan2(Math.sqrt(dl * dl - 1), Math.cos(this.alpha));\n\t    }\n\t    else {\n\t      this.uc = -1 * this.al / this.bl * Math.atan2(Math.sqrt(dl * dl - 1), Math.cos(this.alpha));\n\t    }\n\t  }\n\n\t}\n\n\t/* Oblique Mercator forward equations--mapping lat,long to x,y\n\t    ----------------------------------------------------------*/\n\tfunction forward$8(p) {\n\t  var lon = p.x;\n\t  var lat = p.y;\n\t  var dlon = adjust_lon(lon - this.long0);\n\t  var us, vs;\n\t  var con;\n\t  if (Math.abs(Math.abs(lat) - HALF_PI) <= EPSLN) {\n\t    if (lat > 0) {\n\t      con = -1;\n\t    }\n\t    else {\n\t      con = 1;\n\t    }\n\t    vs = this.al / this.bl * Math.log(Math.tan(FORTPI + con * this.gamma0 * 0.5));\n\t    us = -1 * con * HALF_PI * this.al / this.bl;\n\t  }\n\t  else {\n\t    var t = tsfnz(this.e, lat, Math.sin(lat));\n\t    var ql = this.el / Math.pow(t, this.bl);\n\t    var sl = 0.5 * (ql - 1 / ql);\n\t    var tl = 0.5 * (ql + 1 / ql);\n\t    var vl = Math.sin(this.bl * (dlon));\n\t    var ul = (sl * Math.sin(this.gamma0) - vl * Math.cos(this.gamma0)) / tl;\n\t    if (Math.abs(Math.abs(ul) - 1) <= EPSLN) {\n\t      vs = Number.POSITIVE_INFINITY;\n\t    }\n\t    else {\n\t      vs = 0.5 * this.al * Math.log((1 - ul) / (1 + ul)) / this.bl;\n\t    }\n\t    if (Math.abs(Math.cos(this.bl * (dlon))) <= EPSLN) {\n\t      us = this.al * this.bl * (dlon);\n\t    }\n\t    else {\n\t      us = this.al * Math.atan2(sl * Math.cos(this.gamma0) + vl * Math.sin(this.gamma0), Math.cos(this.bl * dlon)) / this.bl;\n\t    }\n\t  }\n\n\t  if (this.no_rot) {\n\t    p.x = this.x0 + us;\n\t    p.y = this.y0 + vs;\n\t  }\n\t  else {\n\n\t    us -= this.uc;\n\t    p.x = this.x0 + vs * Math.cos(this.alpha) + us * Math.sin(this.alpha);\n\t    p.y = this.y0 + us * Math.cos(this.alpha) - vs * Math.sin(this.alpha);\n\t  }\n\t  return p;\n\t}\n\n\tfunction inverse$8(p) {\n\t  var us, vs;\n\t  if (this.no_rot) {\n\t    vs = p.y - this.y0;\n\t    us = p.x - this.x0;\n\t  }\n\t  else {\n\t    vs = (p.x - this.x0) * Math.cos(this.alpha) - (p.y - this.y0) * Math.sin(this.alpha);\n\t    us = (p.y - this.y0) * Math.cos(this.alpha) + (p.x - this.x0) * Math.sin(this.alpha);\n\t    us += this.uc;\n\t  }\n\t  var qp = Math.exp(-1 * this.bl * vs / this.al);\n\t  var sp = 0.5 * (qp - 1 / qp);\n\t  var tp = 0.5 * (qp + 1 / qp);\n\t  var vp = Math.sin(this.bl * us / this.al);\n\t  var up = (vp * Math.cos(this.gamma0) + sp * Math.sin(this.gamma0)) / tp;\n\t  var ts = Math.pow(this.el / Math.sqrt((1 + up) / (1 - up)), 1 / this.bl);\n\t  if (Math.abs(up - 1) < EPSLN) {\n\t    p.x = this.long0;\n\t    p.y = HALF_PI;\n\t  }\n\t  else if (Math.abs(up + 1) < EPSLN) {\n\t    p.x = this.long0;\n\t    p.y = -1 * HALF_PI;\n\t  }\n\t  else {\n\t    p.y = phi2z(this.e, ts);\n\t    p.x = adjust_lon(this.long0 - Math.atan2(sp * Math.cos(this.gamma0) - vp * Math.sin(this.gamma0), Math.cos(this.bl * us / this.al)) / this.bl);\n\t  }\n\t  return p;\n\t}\n\n\tvar names$10 = [\"Hotine_Oblique_Mercator\", \"Hotine Oblique Mercator\", \"Hotine_Oblique_Mercator_Azimuth_Natural_Origin\", \"Hotine_Oblique_Mercator_Azimuth_Center\", \"omerc\"];\n\tvar omerc = {\n\t  init: init$9,\n\t  forward: forward$8,\n\t  inverse: inverse$8,\n\t  names: names$10\n\t};\n\n\tfunction init$10() {\n\n\t  // array of:  r_maj,r_min,lat1,lat2,c_lon,c_lat,false_east,false_north\n\t  //double c_lat;                   /* center latitude                      */\n\t  //double c_lon;                   /* center longitude                     */\n\t  //double lat1;                    /* first standard parallel              */\n\t  //double lat2;                    /* second standard parallel             */\n\t  //double r_maj;                   /* major axis                           */\n\t  //double r_min;                   /* minor axis                           */\n\t  //double false_east;              /* x offset in meters                   */\n\t  //double false_north;             /* y offset in meters                   */\n\n\t  if (!this.lat2) {\n\t    this.lat2 = this.lat1;\n\t  } //if lat2 is not defined\n\t  if (!this.k0) {\n\t    this.k0 = 1;\n\t  }\n\t  this.x0 = this.x0 || 0;\n\t  this.y0 = this.y0 || 0;\n\t  // Standard Parallels cannot be equal and on opposite sides of the equator\n\t  if (Math.abs(this.lat1 + this.lat2) < EPSLN) {\n\t    return;\n\t  }\n\n\t  var temp = this.b / this.a;\n\t  this.e = Math.sqrt(1 - temp * temp);\n\n\t  var sin1 = Math.sin(this.lat1);\n\t  var cos1 = Math.cos(this.lat1);\n\t  var ms1 = msfnz(this.e, sin1, cos1);\n\t  var ts1 = tsfnz(this.e, this.lat1, sin1);\n\n\t  var sin2 = Math.sin(this.lat2);\n\t  var cos2 = Math.cos(this.lat2);\n\t  var ms2 = msfnz(this.e, sin2, cos2);\n\t  var ts2 = tsfnz(this.e, this.lat2, sin2);\n\n\t  var ts0 = tsfnz(this.e, this.lat0, Math.sin(this.lat0));\n\n\t  if (Math.abs(this.lat1 - this.lat2) > EPSLN) {\n\t    this.ns = Math.log(ms1 / ms2) / Math.log(ts1 / ts2);\n\t  }\n\t  else {\n\t    this.ns = sin1;\n\t  }\n\t  if (isNaN(this.ns)) {\n\t    this.ns = sin1;\n\t  }\n\t  this.f0 = ms1 / (this.ns * Math.pow(ts1, this.ns));\n\t  this.rh = this.a * this.f0 * Math.pow(ts0, this.ns);\n\t  if (!this.title) {\n\t    this.title = \"Lambert Conformal Conic\";\n\t  }\n\t}\n\n\t// Lambert Conformal conic forward equations--mapping lat,long to x,y\n\t// -----------------------------------------------------------------\n\tfunction forward$9(p) {\n\n\t  var lon = p.x;\n\t  var lat = p.y;\n\n\t  // singular cases :\n\t  if (Math.abs(2 * Math.abs(lat) - Math.PI) <= EPSLN) {\n\t    lat = sign(lat) * (HALF_PI - 2 * EPSLN);\n\t  }\n\n\t  var con = Math.abs(Math.abs(lat) - HALF_PI);\n\t  var ts, rh1;\n\t  if (con > EPSLN) {\n\t    ts = tsfnz(this.e, lat, Math.sin(lat));\n\t    rh1 = this.a * this.f0 * Math.pow(ts, this.ns);\n\t  }\n\t  else {\n\t    con = lat * this.ns;\n\t    if (con <= 0) {\n\t      return null;\n\t    }\n\t    rh1 = 0;\n\t  }\n\t  var theta = this.ns * adjust_lon(lon - this.long0);\n\t  p.x = this.k0 * (rh1 * Math.sin(theta)) + this.x0;\n\t  p.y = this.k0 * (this.rh - rh1 * Math.cos(theta)) + this.y0;\n\n\t  return p;\n\t}\n\n\t// Lambert Conformal Conic inverse equations--mapping x,y to lat/long\n\t// -----------------------------------------------------------------\n\tfunction inverse$9(p) {\n\n\t  var rh1, con, ts;\n\t  var lat, lon;\n\t  var x = (p.x - this.x0) / this.k0;\n\t  var y = (this.rh - (p.y - this.y0) / this.k0);\n\t  if (this.ns > 0) {\n\t    rh1 = Math.sqrt(x * x + y * y);\n\t    con = 1;\n\t  }\n\t  else {\n\t    rh1 = -Math.sqrt(x * x + y * y);\n\t    con = -1;\n\t  }\n\t  var theta = 0;\n\t  if (rh1 !== 0) {\n\t    theta = Math.atan2((con * x), (con * y));\n\t  }\n\t  if ((rh1 !== 0) || (this.ns > 0)) {\n\t    con = 1 / this.ns;\n\t    ts = Math.pow((rh1 / (this.a * this.f0)), con);\n\t    lat = phi2z(this.e, ts);\n\t    if (lat === -9999) {\n\t      return null;\n\t    }\n\t  }\n\t  else {\n\t    lat = -HALF_PI;\n\t  }\n\t  lon = adjust_lon(theta / this.ns + this.long0);\n\n\t  p.x = lon;\n\t  p.y = lat;\n\t  return p;\n\t}\n\n\tvar names$11 = [\"Lambert Tangential Conformal Conic Projection\", \"Lambert_Conformal_Conic\", \"Lambert_Conformal_Conic_2SP\", \"lcc\"];\n\tvar lcc = {\n\t  init: init$10,\n\t  forward: forward$9,\n\t  inverse: inverse$9,\n\t  names: names$11\n\t};\n\n\tfunction init$11() {\n\t  this.a = 6377397.155;\n\t  this.es = 0.006674372230614;\n\t  this.e = Math.sqrt(this.es);\n\t  if (!this.lat0) {\n\t    this.lat0 = 0.863937979737193;\n\t  }\n\t  if (!this.long0) {\n\t    this.long0 = 0.7417649320975901 - 0.308341501185665;\n\t  }\n\t  /* if scale not set default to 0.9999 */\n\t  if (!this.k0) {\n\t    this.k0 = 0.9999;\n\t  }\n\t  this.s45 = 0.785398163397448; /* 45 */\n\t  this.s90 = 2 * this.s45;\n\t  this.fi0 = this.lat0;\n\t  this.e2 = this.es;\n\t  this.e = Math.sqrt(this.e2);\n\t  this.alfa = Math.sqrt(1 + (this.e2 * Math.pow(Math.cos(this.fi0), 4)) / (1 - this.e2));\n\t  this.uq = 1.04216856380474;\n\t  this.u0 = Math.asin(Math.sin(this.fi0) / this.alfa);\n\t  this.g = Math.pow((1 + this.e * Math.sin(this.fi0)) / (1 - this.e * Math.sin(this.fi0)), this.alfa * this.e / 2);\n\t  this.k = Math.tan(this.u0 / 2 + this.s45) / Math.pow(Math.tan(this.fi0 / 2 + this.s45), this.alfa) * this.g;\n\t  this.k1 = this.k0;\n\t  this.n0 = this.a * Math.sqrt(1 - this.e2) / (1 - this.e2 * Math.pow(Math.sin(this.fi0), 2));\n\t  this.s0 = 1.37008346281555;\n\t  this.n = Math.sin(this.s0);\n\t  this.ro0 = this.k1 * this.n0 / Math.tan(this.s0);\n\t  this.ad = this.s90 - this.uq;\n\t}\n\n\t/* ellipsoid */\n\t/* calculate xy from lat/lon */\n\t/* Constants, identical to inverse transform function */\n\tfunction forward$10(p) {\n\t  var gfi, u, deltav, s, d, eps, ro;\n\t  var lon = p.x;\n\t  var lat = p.y;\n\t  var delta_lon = adjust_lon(lon - this.long0);\n\t  /* Transformation */\n\t  gfi = Math.pow(((1 + this.e * Math.sin(lat)) / (1 - this.e * Math.sin(lat))), (this.alfa * this.e / 2));\n\t  u = 2 * (Math.atan(this.k * Math.pow(Math.tan(lat / 2 + this.s45), this.alfa) / gfi) - this.s45);\n\t  deltav = -delta_lon * this.alfa;\n\t  s = Math.asin(Math.cos(this.ad) * Math.sin(u) + Math.sin(this.ad) * Math.cos(u) * Math.cos(deltav));\n\t  d = Math.asin(Math.cos(u) * Math.sin(deltav) / Math.cos(s));\n\t  eps = this.n * d;\n\t  ro = this.ro0 * Math.pow(Math.tan(this.s0 / 2 + this.s45), this.n) / Math.pow(Math.tan(s / 2 + this.s45), this.n);\n\t  p.y = ro * Math.cos(eps) / 1;\n\t  p.x = ro * Math.sin(eps) / 1;\n\n\t  if (!this.czech) {\n\t    p.y *= -1;\n\t    p.x *= -1;\n\t  }\n\t  return (p);\n\t}\n\n\t/* calculate lat/lon from xy */\n\tfunction inverse$10(p) {\n\t  var u, deltav, s, d, eps, ro, fi1;\n\t  var ok;\n\n\t  /* Transformation */\n\t  /* revert y, x*/\n\t  var tmp = p.x;\n\t  p.x = p.y;\n\t  p.y = tmp;\n\t  if (!this.czech) {\n\t    p.y *= -1;\n\t    p.x *= -1;\n\t  }\n\t  ro = Math.sqrt(p.x * p.x + p.y * p.y);\n\t  eps = Math.atan2(p.y, p.x);\n\t  d = eps / Math.sin(this.s0);\n\t  s = 2 * (Math.atan(Math.pow(this.ro0 / ro, 1 / this.n) * Math.tan(this.s0 / 2 + this.s45)) - this.s45);\n\t  u = Math.asin(Math.cos(this.ad) * Math.sin(s) - Math.sin(this.ad) * Math.cos(s) * Math.cos(d));\n\t  deltav = Math.asin(Math.cos(s) * Math.sin(d) / Math.cos(u));\n\t  p.x = this.long0 - deltav / this.alfa;\n\t  fi1 = u;\n\t  ok = 0;\n\t  var iter = 0;\n\t  do {\n\t    p.y = 2 * (Math.atan(Math.pow(this.k, - 1 / this.alfa) * Math.pow(Math.tan(u / 2 + this.s45), 1 / this.alfa) * Math.pow((1 + this.e * Math.sin(fi1)) / (1 - this.e * Math.sin(fi1)), this.e / 2)) - this.s45);\n\t    if (Math.abs(fi1 - p.y) < 0.0000000001) {\n\t      ok = 1;\n\t    }\n\t    fi1 = p.y;\n\t    iter += 1;\n\t  } while (ok === 0 && iter < 15);\n\t  if (iter >= 15) {\n\t    return null;\n\t  }\n\n\t  return (p);\n\t}\n\n\tvar names$12 = [\"Krovak\", \"krovak\"];\n\tvar krovak = {\n\t  init: init$11,\n\t  forward: forward$10,\n\t  inverse: inverse$10,\n\t  names: names$12\n\t};\n\n\tvar mlfn = function(e0, e1, e2, e3, phi) {\n\t  return (e0 * phi - e1 * Math.sin(2 * phi) + e2 * Math.sin(4 * phi) - e3 * Math.sin(6 * phi));\n\t};\n\n\tvar e0fn = function(x) {\n\t  return (1 - 0.25 * x * (1 + x / 16 * (3 + 1.25 * x)));\n\t};\n\n\tvar e1fn = function(x) {\n\t  return (0.375 * x * (1 + 0.25 * x * (1 + 0.46875 * x)));\n\t};\n\n\tvar e2fn = function(x) {\n\t  return (0.05859375 * x * x * (1 + 0.75 * x));\n\t};\n\n\tvar e3fn = function(x) {\n\t  return (x * x * x * (35 / 3072));\n\t};\n\n\tvar gN = function(a, e, sinphi) {\n\t  var temp = e * sinphi;\n\t  return a / Math.sqrt(1 - temp * temp);\n\t};\n\n\tvar adjust_lat = function(x) {\n\t  return (Math.abs(x) < HALF_PI) ? x : (x - (sign(x) * Math.PI));\n\t};\n\n\tvar imlfn = function(ml, e0, e1, e2, e3) {\n\t  var phi;\n\t  var dphi;\n\n\t  phi = ml / e0;\n\t  for (var i = 0; i < 15; i++) {\n\t    dphi = (ml - (e0 * phi - e1 * Math.sin(2 * phi) + e2 * Math.sin(4 * phi) - e3 * Math.sin(6 * phi))) / (e0 - 2 * e1 * Math.cos(2 * phi) + 4 * e2 * Math.cos(4 * phi) - 6 * e3 * Math.cos(6 * phi));\n\t    phi += dphi;\n\t    if (Math.abs(dphi) <= 0.0000000001) {\n\t      return phi;\n\t    }\n\t  }\n\n\t  //..reportError(\"IMLFN-CONV:Latitude failed to converge after 15 iterations\");\n\t  return NaN;\n\t};\n\n\tfunction init$12() {\n\t  if (!this.sphere) {\n\t    this.e0 = e0fn(this.es);\n\t    this.e1 = e1fn(this.es);\n\t    this.e2 = e2fn(this.es);\n\t    this.e3 = e3fn(this.es);\n\t    this.ml0 = this.a * mlfn(this.e0, this.e1, this.e2, this.e3, this.lat0);\n\t  }\n\t}\n\n\t/* Cassini forward equations--mapping lat,long to x,y\n\t  -----------------------------------------------------------------------*/\n\tfunction forward$11(p) {\n\n\t  /* Forward equations\n\t      -----------------*/\n\t  var x, y;\n\t  var lam = p.x;\n\t  var phi = p.y;\n\t  lam = adjust_lon(lam - this.long0);\n\n\t  if (this.sphere) {\n\t    x = this.a * Math.asin(Math.cos(phi) * Math.sin(lam));\n\t    y = this.a * (Math.atan2(Math.tan(phi), Math.cos(lam)) - this.lat0);\n\t  }\n\t  else {\n\t    //ellipsoid\n\t    var sinphi = Math.sin(phi);\n\t    var cosphi = Math.cos(phi);\n\t    var nl = gN(this.a, this.e, sinphi);\n\t    var tl = Math.tan(phi) * Math.tan(phi);\n\t    var al = lam * Math.cos(phi);\n\t    var asq = al * al;\n\t    var cl = this.es * cosphi * cosphi / (1 - this.es);\n\t    var ml = this.a * mlfn(this.e0, this.e1, this.e2, this.e3, phi);\n\n\t    x = nl * al * (1 - asq * tl * (1 / 6 - (8 - tl + 8 * cl) * asq / 120));\n\t    y = ml - this.ml0 + nl * sinphi / cosphi * asq * (0.5 + (5 - tl + 6 * cl) * asq / 24);\n\n\n\t  }\n\n\t  p.x = x + this.x0;\n\t  p.y = y + this.y0;\n\t  return p;\n\t}\n\n\t/* Inverse equations\n\t  -----------------*/\n\tfunction inverse$11(p) {\n\t  p.x -= this.x0;\n\t  p.y -= this.y0;\n\t  var x = p.x / this.a;\n\t  var y = p.y / this.a;\n\t  var phi, lam;\n\n\t  if (this.sphere) {\n\t    var dd = y + this.lat0;\n\t    phi = Math.asin(Math.sin(dd) * Math.cos(x));\n\t    lam = Math.atan2(Math.tan(x), Math.cos(dd));\n\t  }\n\t  else {\n\t    /* ellipsoid */\n\t    var ml1 = this.ml0 / this.a + y;\n\t    var phi1 = imlfn(ml1, this.e0, this.e1, this.e2, this.e3);\n\t    if (Math.abs(Math.abs(phi1) - HALF_PI) <= EPSLN) {\n\t      p.x = this.long0;\n\t      p.y = HALF_PI;\n\t      if (y < 0) {\n\t        p.y *= -1;\n\t      }\n\t      return p;\n\t    }\n\t    var nl1 = gN(this.a, this.e, Math.sin(phi1));\n\n\t    var rl1 = nl1 * nl1 * nl1 / this.a / this.a * (1 - this.es);\n\t    var tl1 = Math.pow(Math.tan(phi1), 2);\n\t    var dl = x * this.a / nl1;\n\t    var dsq = dl * dl;\n\t    phi = phi1 - nl1 * Math.tan(phi1) / rl1 * dl * dl * (0.5 - (1 + 3 * tl1) * dl * dl / 24);\n\t    lam = dl * (1 - dsq * (tl1 / 3 + (1 + 3 * tl1) * tl1 * dsq / 15)) / Math.cos(phi1);\n\n\t  }\n\n\t  p.x = adjust_lon(lam + this.long0);\n\t  p.y = adjust_lat(phi);\n\t  return p;\n\n\t}\n\n\tvar names$13 = [\"Cassini\", \"Cassini_Soldner\", \"cass\"];\n\tvar cass = {\n\t  init: init$12,\n\t  forward: forward$11,\n\t  inverse: inverse$11,\n\t  names: names$13\n\t};\n\n\tvar qsfnz = function(eccent, sinphi) {\n\t  var con;\n\t  if (eccent > 1.0e-7) {\n\t    con = eccent * sinphi;\n\t    return ((1 - eccent * eccent) * (sinphi / (1 - con * con) - (0.5 / eccent) * Math.log((1 - con) / (1 + con))));\n\t  }\n\t  else {\n\t    return (2 * sinphi);\n\t  }\n\t};\n\n\t/*\n\t  reference\n\t    \"New Equal-Area Map Projections for Noncircular Regions\", John P. Snyder,\n\t    The American Cartographer, Vol 15, No. 4, October 1988, pp. 341-355.\n\t  */\n\n\tvar S_POLE = 1;\n\n\tvar N_POLE = 2;\n\tvar EQUIT = 3;\n\tvar OBLIQ = 4;\n\n\t/* Initialize the Lambert Azimuthal Equal Area projection\n\t  ------------------------------------------------------*/\n\tfunction init$13() {\n\t  var t = Math.abs(this.lat0);\n\t  if (Math.abs(t - HALF_PI) < EPSLN) {\n\t    this.mode = this.lat0 < 0 ? this.S_POLE : this.N_POLE;\n\t  }\n\t  else if (Math.abs(t) < EPSLN) {\n\t    this.mode = this.EQUIT;\n\t  }\n\t  else {\n\t    this.mode = this.OBLIQ;\n\t  }\n\t  if (this.es > 0) {\n\t    var sinphi;\n\n\t    this.qp = qsfnz(this.e, 1);\n\t    this.mmf = 0.5 / (1 - this.es);\n\t    this.apa = authset(this.es);\n\t    switch (this.mode) {\n\t    case this.N_POLE:\n\t      this.dd = 1;\n\t      break;\n\t    case this.S_POLE:\n\t      this.dd = 1;\n\t      break;\n\t    case this.EQUIT:\n\t      this.rq = Math.sqrt(0.5 * this.qp);\n\t      this.dd = 1 / this.rq;\n\t      this.xmf = 1;\n\t      this.ymf = 0.5 * this.qp;\n\t      break;\n\t    case this.OBLIQ:\n\t      this.rq = Math.sqrt(0.5 * this.qp);\n\t      sinphi = Math.sin(this.lat0);\n\t      this.sinb1 = qsfnz(this.e, sinphi) / this.qp;\n\t      this.cosb1 = Math.sqrt(1 - this.sinb1 * this.sinb1);\n\t      this.dd = Math.cos(this.lat0) / (Math.sqrt(1 - this.es * sinphi * sinphi) * this.rq * this.cosb1);\n\t      this.ymf = (this.xmf = this.rq) / this.dd;\n\t      this.xmf *= this.dd;\n\t      break;\n\t    }\n\t  }\n\t  else {\n\t    if (this.mode === this.OBLIQ) {\n\t      this.sinph0 = Math.sin(this.lat0);\n\t      this.cosph0 = Math.cos(this.lat0);\n\t    }\n\t  }\n\t}\n\n\t/* Lambert Azimuthal Equal Area forward equations--mapping lat,long to x,y\n\t  -----------------------------------------------------------------------*/\n\tfunction forward$12(p) {\n\n\t  /* Forward equations\n\t      -----------------*/\n\t  var x, y, coslam, sinlam, sinphi, q, sinb, cosb, b, cosphi;\n\t  var lam = p.x;\n\t  var phi = p.y;\n\n\t  lam = adjust_lon(lam - this.long0);\n\t  if (this.sphere) {\n\t    sinphi = Math.sin(phi);\n\t    cosphi = Math.cos(phi);\n\t    coslam = Math.cos(lam);\n\t    if (this.mode === this.OBLIQ || this.mode === this.EQUIT) {\n\t      y = (this.mode === this.EQUIT) ? 1 + cosphi * coslam : 1 + this.sinph0 * sinphi + this.cosph0 * cosphi * coslam;\n\t      if (y <= EPSLN) {\n\t        return null;\n\t      }\n\t      y = Math.sqrt(2 / y);\n\t      x = y * cosphi * Math.sin(lam);\n\t      y *= (this.mode === this.EQUIT) ? sinphi : this.cosph0 * sinphi - this.sinph0 * cosphi * coslam;\n\t    }\n\t    else if (this.mode === this.N_POLE || this.mode === this.S_POLE) {\n\t      if (this.mode === this.N_POLE) {\n\t        coslam = -coslam;\n\t      }\n\t      if (Math.abs(phi + this.phi0) < EPSLN) {\n\t        return null;\n\t      }\n\t      y = FORTPI - phi * 0.5;\n\t      y = 2 * ((this.mode === this.S_POLE) ? Math.cos(y) : Math.sin(y));\n\t      x = y * Math.sin(lam);\n\t      y *= coslam;\n\t    }\n\t  }\n\t  else {\n\t    sinb = 0;\n\t    cosb = 0;\n\t    b = 0;\n\t    coslam = Math.cos(lam);\n\t    sinlam = Math.sin(lam);\n\t    sinphi = Math.sin(phi);\n\t    q = qsfnz(this.e, sinphi);\n\t    if (this.mode === this.OBLIQ || this.mode === this.EQUIT) {\n\t      sinb = q / this.qp;\n\t      cosb = Math.sqrt(1 - sinb * sinb);\n\t    }\n\t    switch (this.mode) {\n\t    case this.OBLIQ:\n\t      b = 1 + this.sinb1 * sinb + this.cosb1 * cosb * coslam;\n\t      break;\n\t    case this.EQUIT:\n\t      b = 1 + cosb * coslam;\n\t      break;\n\t    case this.N_POLE:\n\t      b = HALF_PI + phi;\n\t      q = this.qp - q;\n\t      break;\n\t    case this.S_POLE:\n\t      b = phi - HALF_PI;\n\t      q = this.qp + q;\n\t      break;\n\t    }\n\t    if (Math.abs(b) < EPSLN) {\n\t      return null;\n\t    }\n\t    switch (this.mode) {\n\t    case this.OBLIQ:\n\t    case this.EQUIT:\n\t      b = Math.sqrt(2 / b);\n\t      if (this.mode === this.OBLIQ) {\n\t        y = this.ymf * b * (this.cosb1 * sinb - this.sinb1 * cosb * coslam);\n\t      }\n\t      else {\n\t        y = (b = Math.sqrt(2 / (1 + cosb * coslam))) * sinb * this.ymf;\n\t      }\n\t      x = this.xmf * b * cosb * sinlam;\n\t      break;\n\t    case this.N_POLE:\n\t    case this.S_POLE:\n\t      if (q >= 0) {\n\t        x = (b = Math.sqrt(q)) * sinlam;\n\t        y = coslam * ((this.mode === this.S_POLE) ? b : -b);\n\t      }\n\t      else {\n\t        x = y = 0;\n\t      }\n\t      break;\n\t    }\n\t  }\n\n\t  p.x = this.a * x + this.x0;\n\t  p.y = this.a * y + this.y0;\n\t  return p;\n\t}\n\n\t/* Inverse equations\n\t  -----------------*/\n\tfunction inverse$12(p) {\n\t  p.x -= this.x0;\n\t  p.y -= this.y0;\n\t  var x = p.x / this.a;\n\t  var y = p.y / this.a;\n\t  var lam, phi, cCe, sCe, q, rho, ab;\n\t  if (this.sphere) {\n\t    var cosz = 0,\n\t      rh, sinz = 0;\n\n\t    rh = Math.sqrt(x * x + y * y);\n\t    phi = rh * 0.5;\n\t    if (phi > 1) {\n\t      return null;\n\t    }\n\t    phi = 2 * Math.asin(phi);\n\t    if (this.mode === this.OBLIQ || this.mode === this.EQUIT) {\n\t      sinz = Math.sin(phi);\n\t      cosz = Math.cos(phi);\n\t    }\n\t    switch (this.mode) {\n\t    case this.EQUIT:\n\t      phi = (Math.abs(rh) <= EPSLN) ? 0 : Math.asin(y * sinz / rh);\n\t      x *= sinz;\n\t      y = cosz * rh;\n\t      break;\n\t    case this.OBLIQ:\n\t      phi = (Math.abs(rh) <= EPSLN) ? this.phi0 : Math.asin(cosz * this.sinph0 + y * sinz * this.cosph0 / rh);\n\t      x *= sinz * this.cosph0;\n\t      y = (cosz - Math.sin(phi) * this.sinph0) * rh;\n\t      break;\n\t    case this.N_POLE:\n\t      y = -y;\n\t      phi = HALF_PI - phi;\n\t      break;\n\t    case this.S_POLE:\n\t      phi -= HALF_PI;\n\t      break;\n\t    }\n\t    lam = (y === 0 && (this.mode === this.EQUIT || this.mode === this.OBLIQ)) ? 0 : Math.atan2(x, y);\n\t  }\n\t  else {\n\t    ab = 0;\n\t    if (this.mode === this.OBLIQ || this.mode === this.EQUIT) {\n\t      x /= this.dd;\n\t      y *= this.dd;\n\t      rho = Math.sqrt(x * x + y * y);\n\t      if (rho < EPSLN) {\n\t        p.x = 0;\n\t        p.y = this.phi0;\n\t        return p;\n\t      }\n\t      sCe = 2 * Math.asin(0.5 * rho / this.rq);\n\t      cCe = Math.cos(sCe);\n\t      x *= (sCe = Math.sin(sCe));\n\t      if (this.mode === this.OBLIQ) {\n\t        ab = cCe * this.sinb1 + y * sCe * this.cosb1 / rho;\n\t        q = this.qp * ab;\n\t        y = rho * this.cosb1 * cCe - y * this.sinb1 * sCe;\n\t      }\n\t      else {\n\t        ab = y * sCe / rho;\n\t        q = this.qp * ab;\n\t        y = rho * cCe;\n\t      }\n\t    }\n\t    else if (this.mode === this.N_POLE || this.mode === this.S_POLE) {\n\t      if (this.mode === this.N_POLE) {\n\t        y = -y;\n\t      }\n\t      q = (x * x + y * y);\n\t      if (!q) {\n\t        p.x = 0;\n\t        p.y = this.phi0;\n\t        return p;\n\t      }\n\t      ab = 1 - q / this.qp;\n\t      if (this.mode === this.S_POLE) {\n\t        ab = -ab;\n\t      }\n\t    }\n\t    lam = Math.atan2(x, y);\n\t    phi = authlat(Math.asin(ab), this.apa);\n\t  }\n\n\t  p.x = adjust_lon(this.long0 + lam);\n\t  p.y = phi;\n\t  return p;\n\t}\n\n\t/* determine latitude from authalic latitude */\n\tvar P00 = 0.33333333333333333333;\n\n\tvar P01 = 0.17222222222222222222;\n\tvar P02 = 0.10257936507936507936;\n\tvar P10 = 0.06388888888888888888;\n\tvar P11 = 0.06640211640211640211;\n\tvar P20 = 0.01641501294219154443;\n\n\tfunction authset(es) {\n\t  var t;\n\t  var APA = [];\n\t  APA[0] = es * P00;\n\t  t = es * es;\n\t  APA[0] += t * P01;\n\t  APA[1] = t * P10;\n\t  t *= es;\n\t  APA[0] += t * P02;\n\t  APA[1] += t * P11;\n\t  APA[2] = t * P20;\n\t  return APA;\n\t}\n\n\tfunction authlat(beta, APA) {\n\t  var t = beta + beta;\n\t  return (beta + APA[0] * Math.sin(t) + APA[1] * Math.sin(t + t) + APA[2] * Math.sin(t + t + t));\n\t}\n\n\tvar names$14 = [\"Lambert Azimuthal Equal Area\", \"Lambert_Azimuthal_Equal_Area\", \"laea\"];\n\tvar laea = {\n\t  init: init$13,\n\t  forward: forward$12,\n\t  inverse: inverse$12,\n\t  names: names$14,\n\t  S_POLE: S_POLE,\n\t  N_POLE: N_POLE,\n\t  EQUIT: EQUIT,\n\t  OBLIQ: OBLIQ\n\t};\n\n\tvar asinz = function(x) {\n\t  if (Math.abs(x) > 1) {\n\t    x = (x > 1) ? 1 : -1;\n\t  }\n\t  return Math.asin(x);\n\t};\n\n\tfunction init$14() {\n\n\t  if (Math.abs(this.lat1 + this.lat2) < EPSLN) {\n\t    return;\n\t  }\n\t  this.temp = this.b / this.a;\n\t  this.es = 1 - Math.pow(this.temp, 2);\n\t  this.e3 = Math.sqrt(this.es);\n\n\t  this.sin_po = Math.sin(this.lat1);\n\t  this.cos_po = Math.cos(this.lat1);\n\t  this.t1 = this.sin_po;\n\t  this.con = this.sin_po;\n\t  this.ms1 = msfnz(this.e3, this.sin_po, this.cos_po);\n\t  this.qs1 = qsfnz(this.e3, this.sin_po, this.cos_po);\n\n\t  this.sin_po = Math.sin(this.lat2);\n\t  this.cos_po = Math.cos(this.lat2);\n\t  this.t2 = this.sin_po;\n\t  this.ms2 = msfnz(this.e3, this.sin_po, this.cos_po);\n\t  this.qs2 = qsfnz(this.e3, this.sin_po, this.cos_po);\n\n\t  this.sin_po = Math.sin(this.lat0);\n\t  this.cos_po = Math.cos(this.lat0);\n\t  this.t3 = this.sin_po;\n\t  this.qs0 = qsfnz(this.e3, this.sin_po, this.cos_po);\n\n\t  if (Math.abs(this.lat1 - this.lat2) > EPSLN) {\n\t    this.ns0 = (this.ms1 * this.ms1 - this.ms2 * this.ms2) / (this.qs2 - this.qs1);\n\t  }\n\t  else {\n\t    this.ns0 = this.con;\n\t  }\n\t  this.c = this.ms1 * this.ms1 + this.ns0 * this.qs1;\n\t  this.rh = this.a * Math.sqrt(this.c - this.ns0 * this.qs0) / this.ns0;\n\t}\n\n\t/* Albers Conical Equal Area forward equations--mapping lat,long to x,y\n\t  -------------------------------------------------------------------*/\n\tfunction forward$13(p) {\n\n\t  var lon = p.x;\n\t  var lat = p.y;\n\n\t  this.sin_phi = Math.sin(lat);\n\t  this.cos_phi = Math.cos(lat);\n\n\t  var qs = qsfnz(this.e3, this.sin_phi, this.cos_phi);\n\t  var rh1 = this.a * Math.sqrt(this.c - this.ns0 * qs) / this.ns0;\n\t  var theta = this.ns0 * adjust_lon(lon - this.long0);\n\t  var x = rh1 * Math.sin(theta) + this.x0;\n\t  var y = this.rh - rh1 * Math.cos(theta) + this.y0;\n\n\t  p.x = x;\n\t  p.y = y;\n\t  return p;\n\t}\n\n\tfunction inverse$13(p) {\n\t  var rh1, qs, con, theta, lon, lat;\n\n\t  p.x -= this.x0;\n\t  p.y = this.rh - p.y + this.y0;\n\t  if (this.ns0 >= 0) {\n\t    rh1 = Math.sqrt(p.x * p.x + p.y * p.y);\n\t    con = 1;\n\t  }\n\t  else {\n\t    rh1 = -Math.sqrt(p.x * p.x + p.y * p.y);\n\t    con = -1;\n\t  }\n\t  theta = 0;\n\t  if (rh1 !== 0) {\n\t    theta = Math.atan2(con * p.x, con * p.y);\n\t  }\n\t  con = rh1 * this.ns0 / this.a;\n\t  if (this.sphere) {\n\t    lat = Math.asin((this.c - con * con) / (2 * this.ns0));\n\t  }\n\t  else {\n\t    qs = (this.c - con * con) / this.ns0;\n\t    lat = this.phi1z(this.e3, qs);\n\t  }\n\n\t  lon = adjust_lon(theta / this.ns0 + this.long0);\n\t  p.x = lon;\n\t  p.y = lat;\n\t  return p;\n\t}\n\n\t/* Function to compute phi1, the latitude for the inverse of the\n\t   Albers Conical Equal-Area projection.\n\t-------------------------------------------*/\n\tfunction phi1z(eccent, qs) {\n\t  var sinphi, cosphi, con, com, dphi;\n\t  var phi = asinz(0.5 * qs);\n\t  if (eccent < EPSLN) {\n\t    return phi;\n\t  }\n\n\t  var eccnts = eccent * eccent;\n\t  for (var i = 1; i <= 25; i++) {\n\t    sinphi = Math.sin(phi);\n\t    cosphi = Math.cos(phi);\n\t    con = eccent * sinphi;\n\t    com = 1 - con * con;\n\t    dphi = 0.5 * com * com / cosphi * (qs / (1 - eccnts) - sinphi / com + 0.5 / eccent * Math.log((1 - con) / (1 + con)));\n\t    phi = phi + dphi;\n\t    if (Math.abs(dphi) <= 1e-7) {\n\t      return phi;\n\t    }\n\t  }\n\t  return null;\n\t}\n\n\tvar names$15 = [\"Albers_Conic_Equal_Area\", \"Albers\", \"aea\"];\n\tvar aea = {\n\t  init: init$14,\n\t  forward: forward$13,\n\t  inverse: inverse$13,\n\t  names: names$15,\n\t  phi1z: phi1z\n\t};\n\n\t/*\n\t  reference:\n\t    Wolfram Mathworld \"Gnomonic Projection\"\n\t    http://mathworld.wolfram.com/GnomonicProjection.html\n\t    Accessed: 12th November 2009\n\t  */\n\tfunction init$15() {\n\n\t  /* Place parameters in static storage for common use\n\t      -------------------------------------------------*/\n\t  this.sin_p14 = Math.sin(this.lat0);\n\t  this.cos_p14 = Math.cos(this.lat0);\n\t  // Approximation for projecting points to the horizon (infinity)\n\t  this.infinity_dist = 1000 * this.a;\n\t  this.rc = 1;\n\t}\n\n\t/* Gnomonic forward equations--mapping lat,long to x,y\n\t    ---------------------------------------------------*/\n\tfunction forward$14(p) {\n\t  var sinphi, cosphi; /* sin and cos value        */\n\t  var dlon; /* delta longitude value      */\n\t  var coslon; /* cos of longitude        */\n\t  var ksp; /* scale factor          */\n\t  var g;\n\t  var x, y;\n\t  var lon = p.x;\n\t  var lat = p.y;\n\t  /* Forward equations\n\t      -----------------*/\n\t  dlon = adjust_lon(lon - this.long0);\n\n\t  sinphi = Math.sin(lat);\n\t  cosphi = Math.cos(lat);\n\n\t  coslon = Math.cos(dlon);\n\t  g = this.sin_p14 * sinphi + this.cos_p14 * cosphi * coslon;\n\t  ksp = 1;\n\t  if ((g > 0) || (Math.abs(g) <= EPSLN)) {\n\t    x = this.x0 + this.a * ksp * cosphi * Math.sin(dlon) / g;\n\t    y = this.y0 + this.a * ksp * (this.cos_p14 * sinphi - this.sin_p14 * cosphi * coslon) / g;\n\t  }\n\t  else {\n\n\t    // Point is in the opposing hemisphere and is unprojectable\n\t    // We still need to return a reasonable point, so we project\n\t    // to infinity, on a bearing\n\t    // equivalent to the northern hemisphere equivalent\n\t    // This is a reasonable approximation for short shapes and lines that\n\t    // straddle the horizon.\n\n\t    x = this.x0 + this.infinity_dist * cosphi * Math.sin(dlon);\n\t    y = this.y0 + this.infinity_dist * (this.cos_p14 * sinphi - this.sin_p14 * cosphi * coslon);\n\n\t  }\n\t  p.x = x;\n\t  p.y = y;\n\t  return p;\n\t}\n\n\tfunction inverse$14(p) {\n\t  var rh; /* Rho */\n\t  var sinc, cosc;\n\t  var c;\n\t  var lon, lat;\n\n\t  /* Inverse equations\n\t      -----------------*/\n\t  p.x = (p.x - this.x0) / this.a;\n\t  p.y = (p.y - this.y0) / this.a;\n\n\t  p.x /= this.k0;\n\t  p.y /= this.k0;\n\n\t  if ((rh = Math.sqrt(p.x * p.x + p.y * p.y))) {\n\t    c = Math.atan2(rh, this.rc);\n\t    sinc = Math.sin(c);\n\t    cosc = Math.cos(c);\n\n\t    lat = asinz(cosc * this.sin_p14 + (p.y * sinc * this.cos_p14) / rh);\n\t    lon = Math.atan2(p.x * sinc, rh * this.cos_p14 * cosc - p.y * this.sin_p14 * sinc);\n\t    lon = adjust_lon(this.long0 + lon);\n\t  }\n\t  else {\n\t    lat = this.phic0;\n\t    lon = 0;\n\t  }\n\n\t  p.x = lon;\n\t  p.y = lat;\n\t  return p;\n\t}\n\n\tvar names$16 = [\"gnom\"];\n\tvar gnom = {\n\t  init: init$15,\n\t  forward: forward$14,\n\t  inverse: inverse$14,\n\t  names: names$16\n\t};\n\n\tvar iqsfnz = function(eccent, q) {\n\t  var temp = 1 - (1 - eccent * eccent) / (2 * eccent) * Math.log((1 - eccent) / (1 + eccent));\n\t  if (Math.abs(Math.abs(q) - temp) < 1.0E-6) {\n\t    if (q < 0) {\n\t      return (-1 * HALF_PI);\n\t    }\n\t    else {\n\t      return HALF_PI;\n\t    }\n\t  }\n\t  //var phi = 0.5* q/(1-eccent*eccent);\n\t  var phi = Math.asin(0.5 * q);\n\t  var dphi;\n\t  var sin_phi;\n\t  var cos_phi;\n\t  var con;\n\t  for (var i = 0; i < 30; i++) {\n\t    sin_phi = Math.sin(phi);\n\t    cos_phi = Math.cos(phi);\n\t    con = eccent * sin_phi;\n\t    dphi = Math.pow(1 - con * con, 2) / (2 * cos_phi) * (q / (1 - eccent * eccent) - sin_phi / (1 - con * con) + 0.5 / eccent * Math.log((1 - con) / (1 + con)));\n\t    phi += dphi;\n\t    if (Math.abs(dphi) <= 0.0000000001) {\n\t      return phi;\n\t    }\n\t  }\n\n\t  //console.log(\"IQSFN-CONV:Latitude failed to converge after 30 iterations\");\n\t  return NaN;\n\t};\n\n\t/*\n\t  reference:\n\t    \"Cartographic Projection Procedures for the UNIX Environment-\n\t    A User's Manual\" by Gerald I. Evenden,\n\t    USGS Open File Report 90-284and Release 4 Interim Reports (2003)\n\t*/\n\tfunction init$16() {\n\t  //no-op\n\t  if (!this.sphere) {\n\t    this.k0 = msfnz(this.e, Math.sin(this.lat_ts), Math.cos(this.lat_ts));\n\t  }\n\t}\n\n\t/* Cylindrical Equal Area forward equations--mapping lat,long to x,y\n\t    ------------------------------------------------------------*/\n\tfunction forward$15(p) {\n\t  var lon = p.x;\n\t  var lat = p.y;\n\t  var x, y;\n\t  /* Forward equations\n\t      -----------------*/\n\t  var dlon = adjust_lon(lon - this.long0);\n\t  if (this.sphere) {\n\t    x = this.x0 + this.a * dlon * Math.cos(this.lat_ts);\n\t    y = this.y0 + this.a * Math.sin(lat) / Math.cos(this.lat_ts);\n\t  }\n\t  else {\n\t    var qs = qsfnz(this.e, Math.sin(lat));\n\t    x = this.x0 + this.a * this.k0 * dlon;\n\t    y = this.y0 + this.a * qs * 0.5 / this.k0;\n\t  }\n\n\t  p.x = x;\n\t  p.y = y;\n\t  return p;\n\t}\n\n\t/* Cylindrical Equal Area inverse equations--mapping x,y to lat/long\n\t    ------------------------------------------------------------*/\n\tfunction inverse$15(p) {\n\t  p.x -= this.x0;\n\t  p.y -= this.y0;\n\t  var lon, lat;\n\n\t  if (this.sphere) {\n\t    lon = adjust_lon(this.long0 + (p.x / this.a) / Math.cos(this.lat_ts));\n\t    lat = Math.asin((p.y / this.a) * Math.cos(this.lat_ts));\n\t  }\n\t  else {\n\t    lat = iqsfnz(this.e, 2 * p.y * this.k0 / this.a);\n\t    lon = adjust_lon(this.long0 + p.x / (this.a * this.k0));\n\t  }\n\n\t  p.x = lon;\n\t  p.y = lat;\n\t  return p;\n\t}\n\n\tvar names$17 = [\"cea\"];\n\tvar cea = {\n\t  init: init$16,\n\t  forward: forward$15,\n\t  inverse: inverse$15,\n\t  names: names$17\n\t};\n\n\tfunction init$17() {\n\n\t  this.x0 = this.x0 || 0;\n\t  this.y0 = this.y0 || 0;\n\t  this.lat0 = this.lat0 || 0;\n\t  this.long0 = this.long0 || 0;\n\t  this.lat_ts = this.lat_ts || 0;\n\t  this.title = this.title || \"Equidistant Cylindrical (Plate Carre)\";\n\n\t  this.rc = Math.cos(this.lat_ts);\n\t}\n\n\t// forward equations--mapping lat,long to x,y\n\t// -----------------------------------------------------------------\n\tfunction forward$16(p) {\n\n\t  var lon = p.x;\n\t  var lat = p.y;\n\n\t  var dlon = adjust_lon(lon - this.long0);\n\t  var dlat = adjust_lat(lat - this.lat0);\n\t  p.x = this.x0 + (this.a * dlon * this.rc);\n\t  p.y = this.y0 + (this.a * dlat);\n\t  return p;\n\t}\n\n\t// inverse equations--mapping x,y to lat/long\n\t// -----------------------------------------------------------------\n\tfunction inverse$16(p) {\n\n\t  var x = p.x;\n\t  var y = p.y;\n\n\t  p.x = adjust_lon(this.long0 + ((x - this.x0) / (this.a * this.rc)));\n\t  p.y = adjust_lat(this.lat0 + ((y - this.y0) / (this.a)));\n\t  return p;\n\t}\n\n\tvar names$18 = [\"Equirectangular\", \"Equidistant_Cylindrical\", \"eqc\"];\n\tvar eqc = {\n\t  init: init$17,\n\t  forward: forward$16,\n\t  inverse: inverse$16,\n\t  names: names$18\n\t};\n\n\tvar MAX_ITER$2 = 20;\n\n\tfunction init$18() {\n\t  /* Place parameters in static storage for common use\n\t      -------------------------------------------------*/\n\t  this.temp = this.b / this.a;\n\t  this.es = 1 - Math.pow(this.temp, 2); // devait etre dans tmerc.js mais n y est pas donc je commente sinon retour de valeurs nulles\n\t  this.e = Math.sqrt(this.es);\n\t  this.e0 = e0fn(this.es);\n\t  this.e1 = e1fn(this.es);\n\t  this.e2 = e2fn(this.es);\n\t  this.e3 = e3fn(this.es);\n\t  this.ml0 = this.a * mlfn(this.e0, this.e1, this.e2, this.e3, this.lat0); //si que des zeros le calcul ne se fait pas\n\t}\n\n\t/* Polyconic forward equations--mapping lat,long to x,y\n\t    ---------------------------------------------------*/\n\tfunction forward$17(p) {\n\t  var lon = p.x;\n\t  var lat = p.y;\n\t  var x, y, el;\n\t  var dlon = adjust_lon(lon - this.long0);\n\t  el = dlon * Math.sin(lat);\n\t  if (this.sphere) {\n\t    if (Math.abs(lat) <= EPSLN) {\n\t      x = this.a * dlon;\n\t      y = -1 * this.a * this.lat0;\n\t    }\n\t    else {\n\t      x = this.a * Math.sin(el) / Math.tan(lat);\n\t      y = this.a * (adjust_lat(lat - this.lat0) + (1 - Math.cos(el)) / Math.tan(lat));\n\t    }\n\t  }\n\t  else {\n\t    if (Math.abs(lat) <= EPSLN) {\n\t      x = this.a * dlon;\n\t      y = -1 * this.ml0;\n\t    }\n\t    else {\n\t      var nl = gN(this.a, this.e, Math.sin(lat)) / Math.tan(lat);\n\t      x = nl * Math.sin(el);\n\t      y = this.a * mlfn(this.e0, this.e1, this.e2, this.e3, lat) - this.ml0 + nl * (1 - Math.cos(el));\n\t    }\n\n\t  }\n\t  p.x = x + this.x0;\n\t  p.y = y + this.y0;\n\t  return p;\n\t}\n\n\t/* Inverse equations\n\t  -----------------*/\n\tfunction inverse$17(p) {\n\t  var lon, lat, x, y, i;\n\t  var al, bl;\n\t  var phi, dphi;\n\t  x = p.x - this.x0;\n\t  y = p.y - this.y0;\n\n\t  if (this.sphere) {\n\t    if (Math.abs(y + this.a * this.lat0) <= EPSLN) {\n\t      lon = adjust_lon(x / this.a + this.long0);\n\t      lat = 0;\n\t    }\n\t    else {\n\t      al = this.lat0 + y / this.a;\n\t      bl = x * x / this.a / this.a + al * al;\n\t      phi = al;\n\t      var tanphi;\n\t      for (i = MAX_ITER$2; i; --i) {\n\t        tanphi = Math.tan(phi);\n\t        dphi = -1 * (al * (phi * tanphi + 1) - phi - 0.5 * (phi * phi + bl) * tanphi) / ((phi - al) / tanphi - 1);\n\t        phi += dphi;\n\t        if (Math.abs(dphi) <= EPSLN) {\n\t          lat = phi;\n\t          break;\n\t        }\n\t      }\n\t      lon = adjust_lon(this.long0 + (Math.asin(x * Math.tan(phi) / this.a)) / Math.sin(lat));\n\t    }\n\t  }\n\t  else {\n\t    if (Math.abs(y + this.ml0) <= EPSLN) {\n\t      lat = 0;\n\t      lon = adjust_lon(this.long0 + x / this.a);\n\t    }\n\t    else {\n\n\t      al = (this.ml0 + y) / this.a;\n\t      bl = x * x / this.a / this.a + al * al;\n\t      phi = al;\n\t      var cl, mln, mlnp, ma;\n\t      var con;\n\t      for (i = MAX_ITER$2; i; --i) {\n\t        con = this.e * Math.sin(phi);\n\t        cl = Math.sqrt(1 - con * con) * Math.tan(phi);\n\t        mln = this.a * mlfn(this.e0, this.e1, this.e2, this.e3, phi);\n\t        mlnp = this.e0 - 2 * this.e1 * Math.cos(2 * phi) + 4 * this.e2 * Math.cos(4 * phi) - 6 * this.e3 * Math.cos(6 * phi);\n\t        ma = mln / this.a;\n\t        dphi = (al * (cl * ma + 1) - ma - 0.5 * cl * (ma * ma + bl)) / (this.es * Math.sin(2 * phi) * (ma * ma + bl - 2 * al * ma) / (4 * cl) + (al - ma) * (cl * mlnp - 2 / Math.sin(2 * phi)) - mlnp);\n\t        phi -= dphi;\n\t        if (Math.abs(dphi) <= EPSLN) {\n\t          lat = phi;\n\t          break;\n\t        }\n\t      }\n\n\t      //lat=phi4z(this.e,this.e0,this.e1,this.e2,this.e3,al,bl,0,0);\n\t      cl = Math.sqrt(1 - this.es * Math.pow(Math.sin(lat), 2)) * Math.tan(lat);\n\t      lon = adjust_lon(this.long0 + Math.asin(x * cl / this.a) / Math.sin(lat));\n\t    }\n\t  }\n\n\t  p.x = lon;\n\t  p.y = lat;\n\t  return p;\n\t}\n\n\tvar names$19 = [\"Polyconic\", \"poly\"];\n\tvar poly = {\n\t  init: init$18,\n\t  forward: forward$17,\n\t  inverse: inverse$17,\n\t  names: names$19\n\t};\n\n\t/*\n\t  reference\n\t    Department of Land and Survey Technical Circular 1973/32\n\t      http://www.linz.govt.nz/docs/miscellaneous/nz-map-definition.pdf\n\t    OSG Technical Report 4.1\n\t      http://www.linz.govt.nz/docs/miscellaneous/nzmg.pdf\n\t  */\n\n\t/**\n\t * iterations: Number of iterations to refine inverse transform.\n\t *     0 -> km accuracy\n\t *     1 -> m accuracy -- suitable for most mapping applications\n\t *     2 -> mm accuracy\n\t */\n\n\n\tfunction init$19() {\n\t  this.A = [];\n\t  this.A[1] = 0.6399175073;\n\t  this.A[2] = -0.1358797613;\n\t  this.A[3] = 0.063294409;\n\t  this.A[4] = -0.02526853;\n\t  this.A[5] = 0.0117879;\n\t  this.A[6] = -0.0055161;\n\t  this.A[7] = 0.0026906;\n\t  this.A[8] = -0.001333;\n\t  this.A[9] = 0.00067;\n\t  this.A[10] = -0.00034;\n\n\t  this.B_re = [];\n\t  this.B_im = [];\n\t  this.B_re[1] = 0.7557853228;\n\t  this.B_im[1] = 0;\n\t  this.B_re[2] = 0.249204646;\n\t  this.B_im[2] = 0.003371507;\n\t  this.B_re[3] = -0.001541739;\n\t  this.B_im[3] = 0.041058560;\n\t  this.B_re[4] = -0.10162907;\n\t  this.B_im[4] = 0.01727609;\n\t  this.B_re[5] = -0.26623489;\n\t  this.B_im[5] = -0.36249218;\n\t  this.B_re[6] = -0.6870983;\n\t  this.B_im[6] = -1.1651967;\n\n\t  this.C_re = [];\n\t  this.C_im = [];\n\t  this.C_re[1] = 1.3231270439;\n\t  this.C_im[1] = 0;\n\t  this.C_re[2] = -0.577245789;\n\t  this.C_im[2] = -0.007809598;\n\t  this.C_re[3] = 0.508307513;\n\t  this.C_im[3] = -0.112208952;\n\t  this.C_re[4] = -0.15094762;\n\t  this.C_im[4] = 0.18200602;\n\t  this.C_re[5] = 1.01418179;\n\t  this.C_im[5] = 1.64497696;\n\t  this.C_re[6] = 1.9660549;\n\t  this.C_im[6] = 2.5127645;\n\n\t  this.D = [];\n\t  this.D[1] = 1.5627014243;\n\t  this.D[2] = 0.5185406398;\n\t  this.D[3] = -0.03333098;\n\t  this.D[4] = -0.1052906;\n\t  this.D[5] = -0.0368594;\n\t  this.D[6] = 0.007317;\n\t  this.D[7] = 0.01220;\n\t  this.D[8] = 0.00394;\n\t  this.D[9] = -0.0013;\n\t}\n\n\t/**\n\t    New Zealand Map Grid Forward  - long/lat to x/y\n\t    long/lat in radians\n\t  */\n\tfunction forward$18(p) {\n\t  var n;\n\t  var lon = p.x;\n\t  var lat = p.y;\n\n\t  var delta_lat = lat - this.lat0;\n\t  var delta_lon = lon - this.long0;\n\n\t  // 1. Calculate d_phi and d_psi    ...                          // and d_lambda\n\t  // For this algorithm, delta_latitude is in seconds of arc x 10-5, so we need to scale to those units. Longitude is radians.\n\t  var d_phi = delta_lat / SEC_TO_RAD * 1E-5;\n\t  var d_lambda = delta_lon;\n\t  var d_phi_n = 1; // d_phi^0\n\n\t  var d_psi = 0;\n\t  for (n = 1; n <= 10; n++) {\n\t    d_phi_n = d_phi_n * d_phi;\n\t    d_psi = d_psi + this.A[n] * d_phi_n;\n\t  }\n\n\t  // 2. Calculate theta\n\t  var th_re = d_psi;\n\t  var th_im = d_lambda;\n\n\t  // 3. Calculate z\n\t  var th_n_re = 1;\n\t  var th_n_im = 0; // theta^0\n\t  var th_n_re1;\n\t  var th_n_im1;\n\n\t  var z_re = 0;\n\t  var z_im = 0;\n\t  for (n = 1; n <= 6; n++) {\n\t    th_n_re1 = th_n_re * th_re - th_n_im * th_im;\n\t    th_n_im1 = th_n_im * th_re + th_n_re * th_im;\n\t    th_n_re = th_n_re1;\n\t    th_n_im = th_n_im1;\n\t    z_re = z_re + this.B_re[n] * th_n_re - this.B_im[n] * th_n_im;\n\t    z_im = z_im + this.B_im[n] * th_n_re + this.B_re[n] * th_n_im;\n\t  }\n\n\t  // 4. Calculate easting and northing\n\t  p.x = (z_im * this.a) + this.x0;\n\t  p.y = (z_re * this.a) + this.y0;\n\n\t  return p;\n\t}\n\n\t/**\n\t    New Zealand Map Grid Inverse  -  x/y to long/lat\n\t  */\n\tfunction inverse$18(p) {\n\t  var n;\n\t  var x = p.x;\n\t  var y = p.y;\n\n\t  var delta_x = x - this.x0;\n\t  var delta_y = y - this.y0;\n\n\t  // 1. Calculate z\n\t  var z_re = delta_y / this.a;\n\t  var z_im = delta_x / this.a;\n\n\t  // 2a. Calculate theta - first approximation gives km accuracy\n\t  var z_n_re = 1;\n\t  var z_n_im = 0; // z^0\n\t  var z_n_re1;\n\t  var z_n_im1;\n\n\t  var th_re = 0;\n\t  var th_im = 0;\n\t  for (n = 1; n <= 6; n++) {\n\t    z_n_re1 = z_n_re * z_re - z_n_im * z_im;\n\t    z_n_im1 = z_n_im * z_re + z_n_re * z_im;\n\t    z_n_re = z_n_re1;\n\t    z_n_im = z_n_im1;\n\t    th_re = th_re + this.C_re[n] * z_n_re - this.C_im[n] * z_n_im;\n\t    th_im = th_im + this.C_im[n] * z_n_re + this.C_re[n] * z_n_im;\n\t  }\n\n\t  // 2b. Iterate to refine the accuracy of the calculation\n\t  //        0 iterations gives km accuracy\n\t  //        1 iteration gives m accuracy -- good enough for most mapping applications\n\t  //        2 iterations bives mm accuracy\n\t  for (var i = 0; i < this.iterations; i++) {\n\t    var th_n_re = th_re;\n\t    var th_n_im = th_im;\n\t    var th_n_re1;\n\t    var th_n_im1;\n\n\t    var num_re = z_re;\n\t    var num_im = z_im;\n\t    for (n = 2; n <= 6; n++) {\n\t      th_n_re1 = th_n_re * th_re - th_n_im * th_im;\n\t      th_n_im1 = th_n_im * th_re + th_n_re * th_im;\n\t      th_n_re = th_n_re1;\n\t      th_n_im = th_n_im1;\n\t      num_re = num_re + (n - 1) * (this.B_re[n] * th_n_re - this.B_im[n] * th_n_im);\n\t      num_im = num_im + (n - 1) * (this.B_im[n] * th_n_re + this.B_re[n] * th_n_im);\n\t    }\n\n\t    th_n_re = 1;\n\t    th_n_im = 0;\n\t    var den_re = this.B_re[1];\n\t    var den_im = this.B_im[1];\n\t    for (n = 2; n <= 6; n++) {\n\t      th_n_re1 = th_n_re * th_re - th_n_im * th_im;\n\t      th_n_im1 = th_n_im * th_re + th_n_re * th_im;\n\t      th_n_re = th_n_re1;\n\t      th_n_im = th_n_im1;\n\t      den_re = den_re + n * (this.B_re[n] * th_n_re - this.B_im[n] * th_n_im);\n\t      den_im = den_im + n * (this.B_im[n] * th_n_re + this.B_re[n] * th_n_im);\n\t    }\n\n\t    // Complex division\n\t    var den2 = den_re * den_re + den_im * den_im;\n\t    th_re = (num_re * den_re + num_im * den_im) / den2;\n\t    th_im = (num_im * den_re - num_re * den_im) / den2;\n\t  }\n\n\t  // 3. Calculate d_phi              ...                                    // and d_lambda\n\t  var d_psi = th_re;\n\t  var d_lambda = th_im;\n\t  var d_psi_n = 1; // d_psi^0\n\n\t  var d_phi = 0;\n\t  for (n = 1; n <= 9; n++) {\n\t    d_psi_n = d_psi_n * d_psi;\n\t    d_phi = d_phi + this.D[n] * d_psi_n;\n\t  }\n\n\t  // 4. Calculate latitude and longitude\n\t  // d_phi is calcuated in second of arc * 10^-5, so we need to scale back to radians. d_lambda is in radians.\n\t  var lat = this.lat0 + (d_phi * SEC_TO_RAD * 1E5);\n\t  var lon = this.long0 + d_lambda;\n\n\t  p.x = lon;\n\t  p.y = lat;\n\n\t  return p;\n\t}\n\n\tvar names$20 = [\"New_Zealand_Map_Grid\", \"nzmg\"];\n\tvar nzmg = {\n\t  init: init$19,\n\t  forward: forward$18,\n\t  inverse: inverse$18,\n\t  names: names$20\n\t};\n\n\t/*\n\t  reference\n\t    \"New Equal-Area Map Projections for Noncircular Regions\", John P. Snyder,\n\t    The American Cartographer, Vol 15, No. 4, October 1988, pp. 341-355.\n\t  */\n\n\n\t/* Initialize the Miller Cylindrical projection\n\t  -------------------------------------------*/\n\tfunction init$20() {\n\t  //no-op\n\t}\n\n\t/* Miller Cylindrical forward equations--mapping lat,long to x,y\n\t    ------------------------------------------------------------*/\n\tfunction forward$19(p) {\n\t  var lon = p.x;\n\t  var lat = p.y;\n\t  /* Forward equations\n\t      -----------------*/\n\t  var dlon = adjust_lon(lon - this.long0);\n\t  var x = this.x0 + this.a * dlon;\n\t  var y = this.y0 + this.a * Math.log(Math.tan((Math.PI / 4) + (lat / 2.5))) * 1.25;\n\n\t  p.x = x;\n\t  p.y = y;\n\t  return p;\n\t}\n\n\t/* Miller Cylindrical inverse equations--mapping x,y to lat/long\n\t    ------------------------------------------------------------*/\n\tfunction inverse$19(p) {\n\t  p.x -= this.x0;\n\t  p.y -= this.y0;\n\n\t  var lon = adjust_lon(this.long0 + p.x / this.a);\n\t  var lat = 2.5 * (Math.atan(Math.exp(0.8 * p.y / this.a)) - Math.PI / 4);\n\n\t  p.x = lon;\n\t  p.y = lat;\n\t  return p;\n\t}\n\n\tvar names$21 = [\"Miller_Cylindrical\", \"mill\"];\n\tvar mill = {\n\t  init: init$20,\n\t  forward: forward$19,\n\t  inverse: inverse$19,\n\t  names: names$21\n\t};\n\n\tvar MAX_ITER$3 = 20;\n\tfunction init$21() {\n\t  /* Place parameters in static storage for common use\n\t    -------------------------------------------------*/\n\n\n\t  if (!this.sphere) {\n\t    this.en = pj_enfn(this.es);\n\t  }\n\t  else {\n\t    this.n = 1;\n\t    this.m = 0;\n\t    this.es = 0;\n\t    this.C_y = Math.sqrt((this.m + 1) / this.n);\n\t    this.C_x = this.C_y / (this.m + 1);\n\t  }\n\n\t}\n\n\t/* Sinusoidal forward equations--mapping lat,long to x,y\n\t  -----------------------------------------------------*/\n\tfunction forward$20(p) {\n\t  var x, y;\n\t  var lon = p.x;\n\t  var lat = p.y;\n\t  /* Forward equations\n\t    -----------------*/\n\t  lon = adjust_lon(lon - this.long0);\n\n\t  if (this.sphere) {\n\t    if (!this.m) {\n\t      lat = this.n !== 1 ? Math.asin(this.n * Math.sin(lat)) : lat;\n\t    }\n\t    else {\n\t      var k = this.n * Math.sin(lat);\n\t      for (var i = MAX_ITER$3; i; --i) {\n\t        var V = (this.m * lat + Math.sin(lat) - k) / (this.m + Math.cos(lat));\n\t        lat -= V;\n\t        if (Math.abs(V) < EPSLN) {\n\t          break;\n\t        }\n\t      }\n\t    }\n\t    x = this.a * this.C_x * lon * (this.m + Math.cos(lat));\n\t    y = this.a * this.C_y * lat;\n\n\t  }\n\t  else {\n\n\t    var s = Math.sin(lat);\n\t    var c = Math.cos(lat);\n\t    y = this.a * pj_mlfn(lat, s, c, this.en);\n\t    x = this.a * lon * c / Math.sqrt(1 - this.es * s * s);\n\t  }\n\n\t  p.x = x;\n\t  p.y = y;\n\t  return p;\n\t}\n\n\tfunction inverse$20(p) {\n\t  var lat, temp, lon, s;\n\n\t  p.x -= this.x0;\n\t  lon = p.x / this.a;\n\t  p.y -= this.y0;\n\t  lat = p.y / this.a;\n\n\t  if (this.sphere) {\n\t    lat /= this.C_y;\n\t    lon = lon / (this.C_x * (this.m + Math.cos(lat)));\n\t    if (this.m) {\n\t      lat = asinz((this.m * lat + Math.sin(lat)) / this.n);\n\t    }\n\t    else if (this.n !== 1) {\n\t      lat = asinz(Math.sin(lat) / this.n);\n\t    }\n\t    lon = adjust_lon(lon + this.long0);\n\t    lat = adjust_lat(lat);\n\t  }\n\t  else {\n\t    lat = pj_inv_mlfn(p.y / this.a, this.es, this.en);\n\t    s = Math.abs(lat);\n\t    if (s < HALF_PI) {\n\t      s = Math.sin(lat);\n\t      temp = this.long0 + p.x * Math.sqrt(1 - this.es * s * s) / (this.a * Math.cos(lat));\n\t      //temp = this.long0 + p.x / (this.a * Math.cos(lat));\n\t      lon = adjust_lon(temp);\n\t    }\n\t    else if ((s - EPSLN) < HALF_PI) {\n\t      lon = this.long0;\n\t    }\n\t  }\n\t  p.x = lon;\n\t  p.y = lat;\n\t  return p;\n\t}\n\n\tvar names$22 = [\"Sinusoidal\", \"sinu\"];\n\tvar sinu = {\n\t  init: init$21,\n\t  forward: forward$20,\n\t  inverse: inverse$20,\n\t  names: names$22\n\t};\n\n\tfunction init$22() {}\n\t/* Mollweide forward equations--mapping lat,long to x,y\n\t    ----------------------------------------------------*/\n\tfunction forward$21(p) {\n\n\t  /* Forward equations\n\t      -----------------*/\n\t  var lon = p.x;\n\t  var lat = p.y;\n\n\t  var delta_lon = adjust_lon(lon - this.long0);\n\t  var theta = lat;\n\t  var con = Math.PI * Math.sin(lat);\n\n\t  /* Iterate using the Newton-Raphson method to find theta\n\t      -----------------------------------------------------*/\n\t  while (true) {\n\t    var delta_theta = -(theta + Math.sin(theta) - con) / (1 + Math.cos(theta));\n\t    theta += delta_theta;\n\t    if (Math.abs(delta_theta) < EPSLN) {\n\t      break;\n\t    }\n\t  }\n\t  theta /= 2;\n\n\t  /* If the latitude is 90 deg, force the x coordinate to be \"0 + false easting\"\n\t       this is done here because of precision problems with \"cos(theta)\"\n\t       --------------------------------------------------------------------------*/\n\t  if (Math.PI / 2 - Math.abs(lat) < EPSLN) {\n\t    delta_lon = 0;\n\t  }\n\t  var x = 0.900316316158 * this.a * delta_lon * Math.cos(theta) + this.x0;\n\t  var y = 1.4142135623731 * this.a * Math.sin(theta) + this.y0;\n\n\t  p.x = x;\n\t  p.y = y;\n\t  return p;\n\t}\n\n\tfunction inverse$21(p) {\n\t  var theta;\n\t  var arg;\n\n\t  /* Inverse equations\n\t      -----------------*/\n\t  p.x -= this.x0;\n\t  p.y -= this.y0;\n\t  arg = p.y / (1.4142135623731 * this.a);\n\n\t  /* Because of division by zero problems, 'arg' can not be 1.  Therefore\n\t       a number very close to one is used instead.\n\t       -------------------------------------------------------------------*/\n\t  if (Math.abs(arg) > 0.999999999999) {\n\t    arg = 0.999999999999;\n\t  }\n\t  theta = Math.asin(arg);\n\t  var lon = adjust_lon(this.long0 + (p.x / (0.900316316158 * this.a * Math.cos(theta))));\n\t  if (lon < (-Math.PI)) {\n\t    lon = -Math.PI;\n\t  }\n\t  if (lon > Math.PI) {\n\t    lon = Math.PI;\n\t  }\n\t  arg = (2 * theta + Math.sin(2 * theta)) / Math.PI;\n\t  if (Math.abs(arg) > 1) {\n\t    arg = 1;\n\t  }\n\t  var lat = Math.asin(arg);\n\n\t  p.x = lon;\n\t  p.y = lat;\n\t  return p;\n\t}\n\n\tvar names$23 = [\"Mollweide\", \"moll\"];\n\tvar moll = {\n\t  init: init$22,\n\t  forward: forward$21,\n\t  inverse: inverse$21,\n\t  names: names$23\n\t};\n\n\tfunction init$23() {\n\n\t  /* Place parameters in static storage for common use\n\t      -------------------------------------------------*/\n\t  // Standard Parallels cannot be equal and on opposite sides of the equator\n\t  if (Math.abs(this.lat1 + this.lat2) < EPSLN) {\n\t    return;\n\t  }\n\t  this.lat2 = this.lat2 || this.lat1;\n\t  this.temp = this.b / this.a;\n\t  this.es = 1 - Math.pow(this.temp, 2);\n\t  this.e = Math.sqrt(this.es);\n\t  this.e0 = e0fn(this.es);\n\t  this.e1 = e1fn(this.es);\n\t  this.e2 = e2fn(this.es);\n\t  this.e3 = e3fn(this.es);\n\n\t  this.sinphi = Math.sin(this.lat1);\n\t  this.cosphi = Math.cos(this.lat1);\n\n\t  this.ms1 = msfnz(this.e, this.sinphi, this.cosphi);\n\t  this.ml1 = mlfn(this.e0, this.e1, this.e2, this.e3, this.lat1);\n\n\t  if (Math.abs(this.lat1 - this.lat2) < EPSLN) {\n\t    this.ns = this.sinphi;\n\t  }\n\t  else {\n\t    this.sinphi = Math.sin(this.lat2);\n\t    this.cosphi = Math.cos(this.lat2);\n\t    this.ms2 = msfnz(this.e, this.sinphi, this.cosphi);\n\t    this.ml2 = mlfn(this.e0, this.e1, this.e2, this.e3, this.lat2);\n\t    this.ns = (this.ms1 - this.ms2) / (this.ml2 - this.ml1);\n\t  }\n\t  this.g = this.ml1 + this.ms1 / this.ns;\n\t  this.ml0 = mlfn(this.e0, this.e1, this.e2, this.e3, this.lat0);\n\t  this.rh = this.a * (this.g - this.ml0);\n\t}\n\n\t/* Equidistant Conic forward equations--mapping lat,long to x,y\n\t  -----------------------------------------------------------*/\n\tfunction forward$22(p) {\n\t  var lon = p.x;\n\t  var lat = p.y;\n\t  var rh1;\n\n\t  /* Forward equations\n\t      -----------------*/\n\t  if (this.sphere) {\n\t    rh1 = this.a * (this.g - lat);\n\t  }\n\t  else {\n\t    var ml = mlfn(this.e0, this.e1, this.e2, this.e3, lat);\n\t    rh1 = this.a * (this.g - ml);\n\t  }\n\t  var theta = this.ns * adjust_lon(lon - this.long0);\n\t  var x = this.x0 + rh1 * Math.sin(theta);\n\t  var y = this.y0 + this.rh - rh1 * Math.cos(theta);\n\t  p.x = x;\n\t  p.y = y;\n\t  return p;\n\t}\n\n\t/* Inverse equations\n\t  -----------------*/\n\tfunction inverse$22(p) {\n\t  p.x -= this.x0;\n\t  p.y = this.rh - p.y + this.y0;\n\t  var con, rh1, lat, lon;\n\t  if (this.ns >= 0) {\n\t    rh1 = Math.sqrt(p.x * p.x + p.y * p.y);\n\t    con = 1;\n\t  }\n\t  else {\n\t    rh1 = -Math.sqrt(p.x * p.x + p.y * p.y);\n\t    con = -1;\n\t  }\n\t  var theta = 0;\n\t  if (rh1 !== 0) {\n\t    theta = Math.atan2(con * p.x, con * p.y);\n\t  }\n\n\t  if (this.sphere) {\n\t    lon = adjust_lon(this.long0 + theta / this.ns);\n\t    lat = adjust_lat(this.g - rh1 / this.a);\n\t    p.x = lon;\n\t    p.y = lat;\n\t    return p;\n\t  }\n\t  else {\n\t    var ml = this.g - rh1 / this.a;\n\t    lat = imlfn(ml, this.e0, this.e1, this.e2, this.e3);\n\t    lon = adjust_lon(this.long0 + theta / this.ns);\n\t    p.x = lon;\n\t    p.y = lat;\n\t    return p;\n\t  }\n\n\t}\n\n\tvar names$24 = [\"Equidistant_Conic\", \"eqdc\"];\n\tvar eqdc = {\n\t  init: init$23,\n\t  forward: forward$22,\n\t  inverse: inverse$22,\n\t  names: names$24\n\t};\n\n\t/* Initialize the Van Der Grinten projection\n\t  ----------------------------------------*/\n\tfunction init$24() {\n\t  //this.R = 6370997; //Radius of earth\n\t  this.R = this.a;\n\t}\n\n\tfunction forward$23(p) {\n\n\t  var lon = p.x;\n\t  var lat = p.y;\n\n\t  /* Forward equations\n\t    -----------------*/\n\t  var dlon = adjust_lon(lon - this.long0);\n\t  var x, y;\n\n\t  if (Math.abs(lat) <= EPSLN) {\n\t    x = this.x0 + this.R * dlon;\n\t    y = this.y0;\n\t  }\n\t  var theta = asinz(2 * Math.abs(lat / Math.PI));\n\t  if ((Math.abs(dlon) <= EPSLN) || (Math.abs(Math.abs(lat) - HALF_PI) <= EPSLN)) {\n\t    x = this.x0;\n\t    if (lat >= 0) {\n\t      y = this.y0 + Math.PI * this.R * Math.tan(0.5 * theta);\n\t    }\n\t    else {\n\t      y = this.y0 + Math.PI * this.R * -Math.tan(0.5 * theta);\n\t    }\n\t    //  return(OK);\n\t  }\n\t  var al = 0.5 * Math.abs((Math.PI / dlon) - (dlon / Math.PI));\n\t  var asq = al * al;\n\t  var sinth = Math.sin(theta);\n\t  var costh = Math.cos(theta);\n\n\t  var g = costh / (sinth + costh - 1);\n\t  var gsq = g * g;\n\t  var m = g * (2 / sinth - 1);\n\t  var msq = m * m;\n\t  var con = Math.PI * this.R * (al * (g - msq) + Math.sqrt(asq * (g - msq) * (g - msq) - (msq + asq) * (gsq - msq))) / (msq + asq);\n\t  if (dlon < 0) {\n\t    con = -con;\n\t  }\n\t  x = this.x0 + con;\n\t  //con = Math.abs(con / (Math.PI * this.R));\n\t  var q = asq + g;\n\t  con = Math.PI * this.R * (m * q - al * Math.sqrt((msq + asq) * (asq + 1) - q * q)) / (msq + asq);\n\t  if (lat >= 0) {\n\t    //y = this.y0 + Math.PI * this.R * Math.sqrt(1 - con * con - 2 * al * con);\n\t    y = this.y0 + con;\n\t  }\n\t  else {\n\t    //y = this.y0 - Math.PI * this.R * Math.sqrt(1 - con * con - 2 * al * con);\n\t    y = this.y0 - con;\n\t  }\n\t  p.x = x;\n\t  p.y = y;\n\t  return p;\n\t}\n\n\t/* Van Der Grinten inverse equations--mapping x,y to lat/long\n\t  ---------------------------------------------------------*/\n\tfunction inverse$23(p) {\n\t  var lon, lat;\n\t  var xx, yy, xys, c1, c2, c3;\n\t  var a1;\n\t  var m1;\n\t  var con;\n\t  var th1;\n\t  var d;\n\n\t  /* inverse equations\n\t    -----------------*/\n\t  p.x -= this.x0;\n\t  p.y -= this.y0;\n\t  con = Math.PI * this.R;\n\t  xx = p.x / con;\n\t  yy = p.y / con;\n\t  xys = xx * xx + yy * yy;\n\t  c1 = -Math.abs(yy) * (1 + xys);\n\t  c2 = c1 - 2 * yy * yy + xx * xx;\n\t  c3 = -2 * c1 + 1 + 2 * yy * yy + xys * xys;\n\t  d = yy * yy / c3 + (2 * c2 * c2 * c2 / c3 / c3 / c3 - 9 * c1 * c2 / c3 / c3) / 27;\n\t  a1 = (c1 - c2 * c2 / 3 / c3) / c3;\n\t  m1 = 2 * Math.sqrt(-a1 / 3);\n\t  con = ((3 * d) / a1) / m1;\n\t  if (Math.abs(con) > 1) {\n\t    if (con >= 0) {\n\t      con = 1;\n\t    }\n\t    else {\n\t      con = -1;\n\t    }\n\t  }\n\t  th1 = Math.acos(con) / 3;\n\t  if (p.y >= 0) {\n\t    lat = (-m1 * Math.cos(th1 + Math.PI / 3) - c2 / 3 / c3) * Math.PI;\n\t  }\n\t  else {\n\t    lat = -(-m1 * Math.cos(th1 + Math.PI / 3) - c2 / 3 / c3) * Math.PI;\n\t  }\n\n\t  if (Math.abs(xx) < EPSLN) {\n\t    lon = this.long0;\n\t  }\n\t  else {\n\t    lon = adjust_lon(this.long0 + Math.PI * (xys - 1 + Math.sqrt(1 + 2 * (xx * xx - yy * yy) + xys * xys)) / 2 / xx);\n\t  }\n\n\t  p.x = lon;\n\t  p.y = lat;\n\t  return p;\n\t}\n\n\tvar names$25 = [\"Van_der_Grinten_I\", \"VanDerGrinten\", \"vandg\"];\n\tvar vandg = {\n\t  init: init$24,\n\t  forward: forward$23,\n\t  inverse: inverse$23,\n\t  names: names$25\n\t};\n\n\tfunction init$25() {\n\t  this.sin_p12 = Math.sin(this.lat0);\n\t  this.cos_p12 = Math.cos(this.lat0);\n\t}\n\n\tfunction forward$24(p) {\n\t  var lon = p.x;\n\t  var lat = p.y;\n\t  var sinphi = Math.sin(p.y);\n\t  var cosphi = Math.cos(p.y);\n\t  var dlon = adjust_lon(lon - this.long0);\n\t  var e0, e1, e2, e3, Mlp, Ml, tanphi, Nl1, Nl, psi, Az, G, H, GH, Hs, c, kp, cos_c, s, s2, s3, s4, s5;\n\t  if (this.sphere) {\n\t    if (Math.abs(this.sin_p12 - 1) <= EPSLN) {\n\t      //North Pole case\n\t      p.x = this.x0 + this.a * (HALF_PI - lat) * Math.sin(dlon);\n\t      p.y = this.y0 - this.a * (HALF_PI - lat) * Math.cos(dlon);\n\t      return p;\n\t    }\n\t    else if (Math.abs(this.sin_p12 + 1) <= EPSLN) {\n\t      //South Pole case\n\t      p.x = this.x0 + this.a * (HALF_PI + lat) * Math.sin(dlon);\n\t      p.y = this.y0 + this.a * (HALF_PI + lat) * Math.cos(dlon);\n\t      return p;\n\t    }\n\t    else {\n\t      //default case\n\t      cos_c = this.sin_p12 * sinphi + this.cos_p12 * cosphi * Math.cos(dlon);\n\t      c = Math.acos(cos_c);\n\t      kp = c / Math.sin(c);\n\t      p.x = this.x0 + this.a * kp * cosphi * Math.sin(dlon);\n\t      p.y = this.y0 + this.a * kp * (this.cos_p12 * sinphi - this.sin_p12 * cosphi * Math.cos(dlon));\n\t      return p;\n\t    }\n\t  }\n\t  else {\n\t    e0 = e0fn(this.es);\n\t    e1 = e1fn(this.es);\n\t    e2 = e2fn(this.es);\n\t    e3 = e3fn(this.es);\n\t    if (Math.abs(this.sin_p12 - 1) <= EPSLN) {\n\t      //North Pole case\n\t      Mlp = this.a * mlfn(e0, e1, e2, e3, HALF_PI);\n\t      Ml = this.a * mlfn(e0, e1, e2, e3, lat);\n\t      p.x = this.x0 + (Mlp - Ml) * Math.sin(dlon);\n\t      p.y = this.y0 - (Mlp - Ml) * Math.cos(dlon);\n\t      return p;\n\t    }\n\t    else if (Math.abs(this.sin_p12 + 1) <= EPSLN) {\n\t      //South Pole case\n\t      Mlp = this.a * mlfn(e0, e1, e2, e3, HALF_PI);\n\t      Ml = this.a * mlfn(e0, e1, e2, e3, lat);\n\t      p.x = this.x0 + (Mlp + Ml) * Math.sin(dlon);\n\t      p.y = this.y0 + (Mlp + Ml) * Math.cos(dlon);\n\t      return p;\n\t    }\n\t    else {\n\t      //Default case\n\t      tanphi = sinphi / cosphi;\n\t      Nl1 = gN(this.a, this.e, this.sin_p12);\n\t      Nl = gN(this.a, this.e, sinphi);\n\t      psi = Math.atan((1 - this.es) * tanphi + this.es * Nl1 * this.sin_p12 / (Nl * cosphi));\n\t      Az = Math.atan2(Math.sin(dlon), this.cos_p12 * Math.tan(psi) - this.sin_p12 * Math.cos(dlon));\n\t      if (Az === 0) {\n\t        s = Math.asin(this.cos_p12 * Math.sin(psi) - this.sin_p12 * Math.cos(psi));\n\t      }\n\t      else if (Math.abs(Math.abs(Az) - Math.PI) <= EPSLN) {\n\t        s = -Math.asin(this.cos_p12 * Math.sin(psi) - this.sin_p12 * Math.cos(psi));\n\t      }\n\t      else {\n\t        s = Math.asin(Math.sin(dlon) * Math.cos(psi) / Math.sin(Az));\n\t      }\n\t      G = this.e * this.sin_p12 / Math.sqrt(1 - this.es);\n\t      H = this.e * this.cos_p12 * Math.cos(Az) / Math.sqrt(1 - this.es);\n\t      GH = G * H;\n\t      Hs = H * H;\n\t      s2 = s * s;\n\t      s3 = s2 * s;\n\t      s4 = s3 * s;\n\t      s5 = s4 * s;\n\t      c = Nl1 * s * (1 - s2 * Hs * (1 - Hs) / 6 + s3 / 8 * GH * (1 - 2 * Hs) + s4 / 120 * (Hs * (4 - 7 * Hs) - 3 * G * G * (1 - 7 * Hs)) - s5 / 48 * GH);\n\t      p.x = this.x0 + c * Math.sin(Az);\n\t      p.y = this.y0 + c * Math.cos(Az);\n\t      return p;\n\t    }\n\t  }\n\n\n\t}\n\n\tfunction inverse$24(p) {\n\t  p.x -= this.x0;\n\t  p.y -= this.y0;\n\t  var rh, z, sinz, cosz, lon, lat, con, e0, e1, e2, e3, Mlp, M, N1, psi, Az, cosAz, tmp, A, B, D, Ee, F;\n\t  if (this.sphere) {\n\t    rh = Math.sqrt(p.x * p.x + p.y * p.y);\n\t    if (rh > (2 * HALF_PI * this.a)) {\n\t      return;\n\t    }\n\t    z = rh / this.a;\n\n\t    sinz = Math.sin(z);\n\t    cosz = Math.cos(z);\n\n\t    lon = this.long0;\n\t    if (Math.abs(rh) <= EPSLN) {\n\t      lat = this.lat0;\n\t    }\n\t    else {\n\t      lat = asinz(cosz * this.sin_p12 + (p.y * sinz * this.cos_p12) / rh);\n\t      con = Math.abs(this.lat0) - HALF_PI;\n\t      if (Math.abs(con) <= EPSLN) {\n\t        if (this.lat0 >= 0) {\n\t          lon = adjust_lon(this.long0 + Math.atan2(p.x, - p.y));\n\t        }\n\t        else {\n\t          lon = adjust_lon(this.long0 - Math.atan2(-p.x, p.y));\n\t        }\n\t      }\n\t      else {\n\t        /*con = cosz - this.sin_p12 * Math.sin(lat);\n\t        if ((Math.abs(con) < EPSLN) && (Math.abs(p.x) < EPSLN)) {\n\t          //no-op, just keep the lon value as is\n\t        } else {\n\t          var temp = Math.atan2((p.x * sinz * this.cos_p12), (con * rh));\n\t          lon = adjust_lon(this.long0 + Math.atan2((p.x * sinz * this.cos_p12), (con * rh)));\n\t        }*/\n\t        lon = adjust_lon(this.long0 + Math.atan2(p.x * sinz, rh * this.cos_p12 * cosz - p.y * this.sin_p12 * sinz));\n\t      }\n\t    }\n\n\t    p.x = lon;\n\t    p.y = lat;\n\t    return p;\n\t  }\n\t  else {\n\t    e0 = e0fn(this.es);\n\t    e1 = e1fn(this.es);\n\t    e2 = e2fn(this.es);\n\t    e3 = e3fn(this.es);\n\t    if (Math.abs(this.sin_p12 - 1) <= EPSLN) {\n\t      //North pole case\n\t      Mlp = this.a * mlfn(e0, e1, e2, e3, HALF_PI);\n\t      rh = Math.sqrt(p.x * p.x + p.y * p.y);\n\t      M = Mlp - rh;\n\t      lat = imlfn(M / this.a, e0, e1, e2, e3);\n\t      lon = adjust_lon(this.long0 + Math.atan2(p.x, - 1 * p.y));\n\t      p.x = lon;\n\t      p.y = lat;\n\t      return p;\n\t    }\n\t    else if (Math.abs(this.sin_p12 + 1) <= EPSLN) {\n\t      //South pole case\n\t      Mlp = this.a * mlfn(e0, e1, e2, e3, HALF_PI);\n\t      rh = Math.sqrt(p.x * p.x + p.y * p.y);\n\t      M = rh - Mlp;\n\n\t      lat = imlfn(M / this.a, e0, e1, e2, e3);\n\t      lon = adjust_lon(this.long0 + Math.atan2(p.x, p.y));\n\t      p.x = lon;\n\t      p.y = lat;\n\t      return p;\n\t    }\n\t    else {\n\t      //default case\n\t      rh = Math.sqrt(p.x * p.x + p.y * p.y);\n\t      Az = Math.atan2(p.x, p.y);\n\t      N1 = gN(this.a, this.e, this.sin_p12);\n\t      cosAz = Math.cos(Az);\n\t      tmp = this.e * this.cos_p12 * cosAz;\n\t      A = -tmp * tmp / (1 - this.es);\n\t      B = 3 * this.es * (1 - A) * this.sin_p12 * this.cos_p12 * cosAz / (1 - this.es);\n\t      D = rh / N1;\n\t      Ee = D - A * (1 + A) * Math.pow(D, 3) / 6 - B * (1 + 3 * A) * Math.pow(D, 4) / 24;\n\t      F = 1 - A * Ee * Ee / 2 - D * Ee * Ee * Ee / 6;\n\t      psi = Math.asin(this.sin_p12 * Math.cos(Ee) + this.cos_p12 * Math.sin(Ee) * cosAz);\n\t      lon = adjust_lon(this.long0 + Math.asin(Math.sin(Az) * Math.sin(Ee) / Math.cos(psi)));\n\t      lat = Math.atan((1 - this.es * F * this.sin_p12 / Math.sin(psi)) * Math.tan(psi) / (1 - this.es));\n\t      p.x = lon;\n\t      p.y = lat;\n\t      return p;\n\t    }\n\t  }\n\n\t}\n\n\tvar names$26 = [\"Azimuthal_Equidistant\", \"aeqd\"];\n\tvar aeqd = {\n\t  init: init$25,\n\t  forward: forward$24,\n\t  inverse: inverse$24,\n\t  names: names$26\n\t};\n\n\tfunction init$26() {\n\t  //double temp;      /* temporary variable    */\n\n\t  /* Place parameters in static storage for common use\n\t      -------------------------------------------------*/\n\t  this.sin_p14 = Math.sin(this.lat0);\n\t  this.cos_p14 = Math.cos(this.lat0);\n\t}\n\n\t/* Orthographic forward equations--mapping lat,long to x,y\n\t    ---------------------------------------------------*/\n\tfunction forward$25(p) {\n\t  var sinphi, cosphi; /* sin and cos value        */\n\t  var dlon; /* delta longitude value      */\n\t  var coslon; /* cos of longitude        */\n\t  var ksp; /* scale factor          */\n\t  var g, x, y;\n\t  var lon = p.x;\n\t  var lat = p.y;\n\t  /* Forward equations\n\t      -----------------*/\n\t  dlon = adjust_lon(lon - this.long0);\n\n\t  sinphi = Math.sin(lat);\n\t  cosphi = Math.cos(lat);\n\n\t  coslon = Math.cos(dlon);\n\t  g = this.sin_p14 * sinphi + this.cos_p14 * cosphi * coslon;\n\t  ksp = 1;\n\t  if ((g > 0) || (Math.abs(g) <= EPSLN)) {\n\t    x = this.a * ksp * cosphi * Math.sin(dlon);\n\t    y = this.y0 + this.a * ksp * (this.cos_p14 * sinphi - this.sin_p14 * cosphi * coslon);\n\t  }\n\t  p.x = x;\n\t  p.y = y;\n\t  return p;\n\t}\n\n\tfunction inverse$25(p) {\n\t  var rh; /* height above ellipsoid      */\n\t  var z; /* angle          */\n\t  var sinz, cosz; /* sin of z and cos of z      */\n\t  var con;\n\t  var lon, lat;\n\t  /* Inverse equations\n\t      -----------------*/\n\t  p.x -= this.x0;\n\t  p.y -= this.y0;\n\t  rh = Math.sqrt(p.x * p.x + p.y * p.y);\n\t  z = asinz(rh / this.a);\n\n\t  sinz = Math.sin(z);\n\t  cosz = Math.cos(z);\n\n\t  lon = this.long0;\n\t  if (Math.abs(rh) <= EPSLN) {\n\t    lat = this.lat0;\n\t    p.x = lon;\n\t    p.y = lat;\n\t    return p;\n\t  }\n\t  lat = asinz(cosz * this.sin_p14 + (p.y * sinz * this.cos_p14) / rh);\n\t  con = Math.abs(this.lat0) - HALF_PI;\n\t  if (Math.abs(con) <= EPSLN) {\n\t    if (this.lat0 >= 0) {\n\t      lon = adjust_lon(this.long0 + Math.atan2(p.x, - p.y));\n\t    }\n\t    else {\n\t      lon = adjust_lon(this.long0 - Math.atan2(-p.x, p.y));\n\t    }\n\t    p.x = lon;\n\t    p.y = lat;\n\t    return p;\n\t  }\n\t  lon = adjust_lon(this.long0 + Math.atan2((p.x * sinz), rh * this.cos_p14 * cosz - p.y * this.sin_p14 * sinz));\n\t  p.x = lon;\n\t  p.y = lat;\n\t  return p;\n\t}\n\n\tvar names$27 = [\"ortho\"];\n\tvar ortho = {\n\t  init: init$26,\n\t  forward: forward$25,\n\t  inverse: inverse$25,\n\t  names: names$27\n\t};\n\n\t// QSC projection rewritten from the original PROJ4\n\t// https://github.com/OSGeo/proj.4/blob/master/src/PJ_qsc.c\n\n\t/* constants */\n\tvar FACE_ENUM = {\n\t    FRONT: 1,\n\t    RIGHT: 2,\n\t    BACK: 3,\n\t    LEFT: 4,\n\t    TOP: 5,\n\t    BOTTOM: 6\n\t};\n\n\tvar AREA_ENUM = {\n\t    AREA_0: 1,\n\t    AREA_1: 2,\n\t    AREA_2: 3,\n\t    AREA_3: 4\n\t};\n\n\tfunction init$27() {\n\n\t  this.x0 = this.x0 || 0;\n\t  this.y0 = this.y0 || 0;\n\t  this.lat0 = this.lat0 || 0;\n\t  this.long0 = this.long0 || 0;\n\t  this.lat_ts = this.lat_ts || 0;\n\t  this.title = this.title || \"Quadrilateralized Spherical Cube\";\n\n\t  /* Determine the cube face from the center of projection. */\n\t  if (this.lat0 >= HALF_PI - FORTPI / 2.0) {\n\t    this.face = FACE_ENUM.TOP;\n\t  } else if (this.lat0 <= -(HALF_PI - FORTPI / 2.0)) {\n\t    this.face = FACE_ENUM.BOTTOM;\n\t  } else if (Math.abs(this.long0) <= FORTPI) {\n\t    this.face = FACE_ENUM.FRONT;\n\t  } else if (Math.abs(this.long0) <= HALF_PI + FORTPI) {\n\t    this.face = this.long0 > 0.0 ? FACE_ENUM.RIGHT : FACE_ENUM.LEFT;\n\t  } else {\n\t    this.face = FACE_ENUM.BACK;\n\t  }\n\n\t  /* Fill in useful values for the ellipsoid <-> sphere shift\n\t   * described in [LK12]. */\n\t  if (this.es !== 0) {\n\t    this.one_minus_f = 1 - (this.a - this.b) / this.a;\n\t    this.one_minus_f_squared = this.one_minus_f * this.one_minus_f;\n\t  }\n\t}\n\n\t// QSC forward equations--mapping lat,long to x,y\n\t// -----------------------------------------------------------------\n\tfunction forward$26(p) {\n\t  var xy = {x: 0, y: 0};\n\t  var lat, lon;\n\t  var theta, phi;\n\t  var t, mu;\n\t  /* nu; */\n\t  var area = {value: 0};\n\n\t  // move lon according to projection's lon\n\t  p.x -= this.long0;\n\n\t  /* Convert the geodetic latitude to a geocentric latitude.\n\t   * This corresponds to the shift from the ellipsoid to the sphere\n\t   * described in [LK12]. */\n\t  if (this.es !== 0) {//if (P->es != 0) {\n\t    lat = Math.atan(this.one_minus_f_squared * Math.tan(p.y));\n\t  } else {\n\t    lat = p.y;\n\t  }\n\n\t  /* Convert the input lat, lon into theta, phi as used by QSC.\n\t   * This depends on the cube face and the area on it.\n\t   * For the top and bottom face, we can compute theta and phi\n\t   * directly from phi, lam. For the other faces, we must use\n\t   * unit sphere cartesian coordinates as an intermediate step. */\n\t  lon = p.x; //lon = lp.lam;\n\t  if (this.face === FACE_ENUM.TOP) {\n\t    phi = HALF_PI - lat;\n\t    if (lon >= FORTPI && lon <= HALF_PI + FORTPI) {\n\t      area.value = AREA_ENUM.AREA_0;\n\t      theta = lon - HALF_PI;\n\t    } else if (lon > HALF_PI + FORTPI || lon <= -(HALF_PI + FORTPI)) {\n\t      area.value = AREA_ENUM.AREA_1;\n\t      theta = (lon > 0.0 ? lon - SPI : lon + SPI);\n\t    } else if (lon > -(HALF_PI + FORTPI) && lon <= -FORTPI) {\n\t      area.value = AREA_ENUM.AREA_2;\n\t      theta = lon + HALF_PI;\n\t    } else {\n\t      area.value = AREA_ENUM.AREA_3;\n\t      theta = lon;\n\t    }\n\t  } else if (this.face === FACE_ENUM.BOTTOM) {\n\t    phi = HALF_PI + lat;\n\t    if (lon >= FORTPI && lon <= HALF_PI + FORTPI) {\n\t      area.value = AREA_ENUM.AREA_0;\n\t      theta = -lon + HALF_PI;\n\t    } else if (lon < FORTPI && lon >= -FORTPI) {\n\t      area.value = AREA_ENUM.AREA_1;\n\t      theta = -lon;\n\t    } else if (lon < -FORTPI && lon >= -(HALF_PI + FORTPI)) {\n\t      area.value = AREA_ENUM.AREA_2;\n\t      theta = -lon - HALF_PI;\n\t    } else {\n\t      area.value = AREA_ENUM.AREA_3;\n\t      theta = (lon > 0.0 ? -lon + SPI : -lon - SPI);\n\t    }\n\t  } else {\n\t    var q, r, s;\n\t    var sinlat, coslat;\n\t    var sinlon, coslon;\n\n\t    if (this.face === FACE_ENUM.RIGHT) {\n\t      lon = qsc_shift_lon_origin(lon, +HALF_PI);\n\t    } else if (this.face === FACE_ENUM.BACK) {\n\t      lon = qsc_shift_lon_origin(lon, +SPI);\n\t    } else if (this.face === FACE_ENUM.LEFT) {\n\t      lon = qsc_shift_lon_origin(lon, -HALF_PI);\n\t    }\n\t    sinlat = Math.sin(lat);\n\t    coslat = Math.cos(lat);\n\t    sinlon = Math.sin(lon);\n\t    coslon = Math.cos(lon);\n\t    q = coslat * coslon;\n\t    r = coslat * sinlon;\n\t    s = sinlat;\n\n\t    if (this.face === FACE_ENUM.FRONT) {\n\t      phi = Math.acos(q);\n\t      theta = qsc_fwd_equat_face_theta(phi, s, r, area);\n\t    } else if (this.face === FACE_ENUM.RIGHT) {\n\t      phi = Math.acos(r);\n\t      theta = qsc_fwd_equat_face_theta(phi, s, -q, area);\n\t    } else if (this.face === FACE_ENUM.BACK) {\n\t      phi = Math.acos(-q);\n\t      theta = qsc_fwd_equat_face_theta(phi, s, -r, area);\n\t    } else if (this.face === FACE_ENUM.LEFT) {\n\t      phi = Math.acos(-r);\n\t      theta = qsc_fwd_equat_face_theta(phi, s, q, area);\n\t    } else {\n\t      /* Impossible */\n\t      phi = theta = 0;\n\t      area.value = AREA_ENUM.AREA_0;\n\t    }\n\t  }\n\n\t  /* Compute mu and nu for the area of definition.\n\t   * For mu, see Eq. (3-21) in [OL76], but note the typos:\n\t   * compare with Eq. (3-14). For nu, see Eq. (3-38). */\n\t  mu = Math.atan((12 / SPI) * (theta + Math.acos(Math.sin(theta) * Math.cos(FORTPI)) - HALF_PI));\n\t  t = Math.sqrt((1 - Math.cos(phi)) / (Math.cos(mu) * Math.cos(mu)) / (1 - Math.cos(Math.atan(1 / Math.cos(theta)))));\n\n\t  /* Apply the result to the real area. */\n\t  if (area.value === AREA_ENUM.AREA_1) {\n\t    mu += HALF_PI;\n\t  } else if (area.value === AREA_ENUM.AREA_2) {\n\t    mu += SPI;\n\t  } else if (area.value === AREA_ENUM.AREA_3) {\n\t    mu += 1.5 * SPI;\n\t  }\n\n\t  /* Now compute x, y from mu and nu */\n\t  xy.x = t * Math.cos(mu);\n\t  xy.y = t * Math.sin(mu);\n\t  xy.x = xy.x * this.a + this.x0;\n\t  xy.y = xy.y * this.a + this.y0;\n\n\t  p.x = xy.x;\n\t  p.y = xy.y;\n\t  return p;\n\t}\n\n\t// QSC inverse equations--mapping x,y to lat/long\n\t// -----------------------------------------------------------------\n\tfunction inverse$26(p) {\n\t  var lp = {lam: 0, phi: 0};\n\t  var mu, nu, cosmu, tannu;\n\t  var tantheta, theta, cosphi, phi;\n\t  var t;\n\t  var area = {value: 0};\n\n\t  /* de-offset */\n\t  p.x = (p.x - this.x0) / this.a;\n\t  p.y = (p.y - this.y0) / this.a;\n\n\t  /* Convert the input x, y to the mu and nu angles as used by QSC.\n\t   * This depends on the area of the cube face. */\n\t  nu = Math.atan(Math.sqrt(p.x * p.x + p.y * p.y));\n\t  mu = Math.atan2(p.y, p.x);\n\t  if (p.x >= 0.0 && p.x >= Math.abs(p.y)) {\n\t    area.value = AREA_ENUM.AREA_0;\n\t  } else if (p.y >= 0.0 && p.y >= Math.abs(p.x)) {\n\t    area.value = AREA_ENUM.AREA_1;\n\t    mu -= HALF_PI;\n\t  } else if (p.x < 0.0 && -p.x >= Math.abs(p.y)) {\n\t    area.value = AREA_ENUM.AREA_2;\n\t    mu = (mu < 0.0 ? mu + SPI : mu - SPI);\n\t  } else {\n\t    area.value = AREA_ENUM.AREA_3;\n\t    mu += HALF_PI;\n\t  }\n\n\t  /* Compute phi and theta for the area of definition.\n\t   * The inverse projection is not described in the original paper, but some\n\t   * good hints can be found here (as of 2011-12-14):\n\t   * http://fits.gsfc.nasa.gov/fitsbits/saf.93/saf.9302\n\t   * (search for \"Message-Id: <9302181759.AA25477 at fits.cv.nrao.edu>\") */\n\t  t = (SPI / 12) * Math.tan(mu);\n\t  tantheta = Math.sin(t) / (Math.cos(t) - (1 / Math.sqrt(2)));\n\t  theta = Math.atan(tantheta);\n\t  cosmu = Math.cos(mu);\n\t  tannu = Math.tan(nu);\n\t  cosphi = 1 - cosmu * cosmu * tannu * tannu * (1 - Math.cos(Math.atan(1 / Math.cos(theta))));\n\t  if (cosphi < -1) {\n\t    cosphi = -1;\n\t  } else if (cosphi > +1) {\n\t    cosphi = +1;\n\t  }\n\n\t  /* Apply the result to the real area on the cube face.\n\t   * For the top and bottom face, we can compute phi and lam directly.\n\t   * For the other faces, we must use unit sphere cartesian coordinates\n\t   * as an intermediate step. */\n\t  if (this.face === FACE_ENUM.TOP) {\n\t    phi = Math.acos(cosphi);\n\t    lp.phi = HALF_PI - phi;\n\t    if (area.value === AREA_ENUM.AREA_0) {\n\t      lp.lam = theta + HALF_PI;\n\t    } else if (area.value === AREA_ENUM.AREA_1) {\n\t      lp.lam = (theta < 0.0 ? theta + SPI : theta - SPI);\n\t    } else if (area.value === AREA_ENUM.AREA_2) {\n\t      lp.lam = theta - HALF_PI;\n\t    } else /* area.value == AREA_ENUM.AREA_3 */ {\n\t      lp.lam = theta;\n\t    }\n\t  } else if (this.face === FACE_ENUM.BOTTOM) {\n\t    phi = Math.acos(cosphi);\n\t    lp.phi = phi - HALF_PI;\n\t    if (area.value === AREA_ENUM.AREA_0) {\n\t      lp.lam = -theta + HALF_PI;\n\t    } else if (area.value === AREA_ENUM.AREA_1) {\n\t      lp.lam = -theta;\n\t    } else if (area.value === AREA_ENUM.AREA_2) {\n\t      lp.lam = -theta - HALF_PI;\n\t    } else /* area.value == AREA_ENUM.AREA_3 */ {\n\t      lp.lam = (theta < 0.0 ? -theta - SPI : -theta + SPI);\n\t    }\n\t  } else {\n\t    /* Compute phi and lam via cartesian unit sphere coordinates. */\n\t    var q, r, s;\n\t    q = cosphi;\n\t    t = q * q;\n\t    if (t >= 1) {\n\t      s = 0;\n\t    } else {\n\t      s = Math.sqrt(1 - t) * Math.sin(theta);\n\t    }\n\t    t += s * s;\n\t    if (t >= 1) {\n\t      r = 0;\n\t    } else {\n\t      r = Math.sqrt(1 - t);\n\t    }\n\t    /* Rotate q,r,s into the correct area. */\n\t    if (area.value === AREA_ENUM.AREA_1) {\n\t      t = r;\n\t      r = -s;\n\t      s = t;\n\t    } else if (area.value === AREA_ENUM.AREA_2) {\n\t      r = -r;\n\t      s = -s;\n\t    } else if (area.value === AREA_ENUM.AREA_3) {\n\t      t = r;\n\t      r = s;\n\t      s = -t;\n\t    }\n\t    /* Rotate q,r,s into the correct cube face. */\n\t    if (this.face === FACE_ENUM.RIGHT) {\n\t      t = q;\n\t      q = -r;\n\t      r = t;\n\t    } else if (this.face === FACE_ENUM.BACK) {\n\t      q = -q;\n\t      r = -r;\n\t    } else if (this.face === FACE_ENUM.LEFT) {\n\t      t = q;\n\t      q = r;\n\t      r = -t;\n\t    }\n\t    /* Now compute phi and lam from the unit sphere coordinates. */\n\t    lp.phi = Math.acos(-s) - HALF_PI;\n\t    lp.lam = Math.atan2(r, q);\n\t    if (this.face === FACE_ENUM.RIGHT) {\n\t      lp.lam = qsc_shift_lon_origin(lp.lam, -HALF_PI);\n\t    } else if (this.face === FACE_ENUM.BACK) {\n\t      lp.lam = qsc_shift_lon_origin(lp.lam, -SPI);\n\t    } else if (this.face === FACE_ENUM.LEFT) {\n\t      lp.lam = qsc_shift_lon_origin(lp.lam, +HALF_PI);\n\t    }\n\t  }\n\n\t  /* Apply the shift from the sphere to the ellipsoid as described\n\t   * in [LK12]. */\n\t  if (this.es !== 0) {\n\t    var invert_sign;\n\t    var tanphi, xa;\n\t    invert_sign = (lp.phi < 0 ? 1 : 0);\n\t    tanphi = Math.tan(lp.phi);\n\t    xa = this.b / Math.sqrt(tanphi * tanphi + this.one_minus_f_squared);\n\t    lp.phi = Math.atan(Math.sqrt(this.a * this.a - xa * xa) / (this.one_minus_f * xa));\n\t    if (invert_sign) {\n\t      lp.phi = -lp.phi;\n\t    }\n\t  }\n\n\t  lp.lam += this.long0;\n\t  p.x = lp.lam;\n\t  p.y = lp.phi;\n\t  return p;\n\t}\n\n\t/* Helper function for forward projection: compute the theta angle\n\t * and determine the area number. */\n\tfunction qsc_fwd_equat_face_theta(phi, y, x, area) {\n\t  var theta;\n\t  if (phi < EPSLN) {\n\t    area.value = AREA_ENUM.AREA_0;\n\t    theta = 0.0;\n\t  } else {\n\t    theta = Math.atan2(y, x);\n\t    if (Math.abs(theta) <= FORTPI) {\n\t      area.value = AREA_ENUM.AREA_0;\n\t    } else if (theta > FORTPI && theta <= HALF_PI + FORTPI) {\n\t      area.value = AREA_ENUM.AREA_1;\n\t      theta -= HALF_PI;\n\t    } else if (theta > HALF_PI + FORTPI || theta <= -(HALF_PI + FORTPI)) {\n\t      area.value = AREA_ENUM.AREA_2;\n\t      theta = (theta >= 0.0 ? theta - SPI : theta + SPI);\n\t    } else {\n\t      area.value = AREA_ENUM.AREA_3;\n\t      theta += HALF_PI;\n\t    }\n\t  }\n\t  return theta;\n\t}\n\n\t/* Helper function: shift the longitude. */\n\tfunction qsc_shift_lon_origin(lon, offset) {\n\t  var slon = lon + offset;\n\t  if (slon < -SPI) {\n\t    slon += TWO_PI;\n\t  } else if (slon > +SPI) {\n\t    slon -= TWO_PI;\n\t  }\n\t  return slon;\n\t}\n\n\tvar names$28 = [\"Quadrilateralized Spherical Cube\", \"Quadrilateralized_Spherical_Cube\", \"qsc\"];\n\tvar qsc = {\n\t  init: init$27,\n\t  forward: forward$26,\n\t  inverse: inverse$26,\n\t  names: names$28\n\t};\n\n\tvar includedProjections = function(proj4){\n\t  proj4.Proj.projections.add(tmerc);\n\t  proj4.Proj.projections.add(etmerc);\n\t  proj4.Proj.projections.add(utm);\n\t  proj4.Proj.projections.add(sterea);\n\t  proj4.Proj.projections.add(stere);\n\t  proj4.Proj.projections.add(somerc);\n\t  proj4.Proj.projections.add(omerc);\n\t  proj4.Proj.projections.add(lcc);\n\t  proj4.Proj.projections.add(krovak);\n\t  proj4.Proj.projections.add(cass);\n\t  proj4.Proj.projections.add(laea);\n\t  proj4.Proj.projections.add(aea);\n\t  proj4.Proj.projections.add(gnom);\n\t  proj4.Proj.projections.add(cea);\n\t  proj4.Proj.projections.add(eqc);\n\t  proj4.Proj.projections.add(poly);\n\t  proj4.Proj.projections.add(nzmg);\n\t  proj4.Proj.projections.add(mill);\n\t  proj4.Proj.projections.add(sinu);\n\t  proj4.Proj.projections.add(moll);\n\t  proj4.Proj.projections.add(eqdc);\n\t  proj4.Proj.projections.add(vandg);\n\t  proj4.Proj.projections.add(aeqd);\n\t  proj4.Proj.projections.add(ortho);\n\t  proj4.Proj.projections.add(qsc);\n\t};\n\n\tproj4$1.defaultDatum = 'WGS84'; //default datum\n\tproj4$1.Proj = Projection$1;\n\tproj4$1.WGS84 = new proj4$1.Proj('WGS84');\n\tproj4$1.Point = Point;\n\tproj4$1.toPoint = toPoint;\n\tproj4$1.defs = defs;\n\tproj4$1.transform = transform;\n\tproj4$1.mgrs = mgrs;\n\tproj4$1.version = version;\n\tincludedProjections(proj4$1);\n\n\treturn proj4$1;\n\n})));\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/proj4/dist/proj4-src.js\n// module id = 9\n// module chunks = 0","var Config = {\n\n    /** autoconf */\n    configuration: null,\n\n    /**\n     * Controle du chargement de l'autoconf\n     *\n     * @returns {Boolean} isConfigLoaded - True si l'autoconf a dj t charge, False sinon.\n     */\n    isConfigLoaded: function() {\n\n        var scope = typeof window !== \"undefined\" ? window : {};\n        if (scope.Gp && scope.Gp.Config && Object.keys(scope.Gp.Config).length !== 0) {\n            this.configuration = scope.Gp.Config;\n            return true;\n        }\n        return false;\n    },\n\n    /**\n     * Recuperation de l'identifiant d'une couche donne\n     *\n     * @param {String} layerName - nom de la couche (par ex. \"ORTHOIMAGERY.ORTHOPHOTOS\")\n     * @param {String} service   - nom du service (par ex. \"WMS\" ou \"WMTS\")\n     * @returns {String} layerId - identifiant de la couche (par ex. \"ORTHOIMAGERY.ORTHOPHOTOS$GEOPORTAIL:OGC:WMTS\")\n     */\n    getLayerId: function(layerName, service) {\n\n        var layerId = null;\n\n        // layer\n        // key : [layerName]$[contexte]:OGC:[service]\n        // ex : \"ORTHOIMAGERY.ORTHOPHOTOS$GEOPORTAIL:OGC:WMTS\"\n\n        // service\n        // key : [layerName]$[contexte];[service]\n        // ex : PositionOfInterest$OGC:OPENLS;ReverseGeocode\n\n        if (this.configuration) {\n            var layers = this.configuration[\"layers\"];\n            for (var key in layers) {\n                if (layers.hasOwnProperty(key)) {\n\n                    var parts = key.split(\"$\");\n                    if (layerName === parts[0]) {\n                        if (parts[1]) {\n                            var servicePartsLayer = parts[1].split(\":\");\n                            var servicePartsService = parts[1].split(\";\");\n\n                            if (servicePartsService[1] === service) {\n                                layerId = key;\n                                break;\n                            }\n                            if (servicePartsLayer[2] === service) {\n                                layerId = key;\n                                break;\n                            }\n                        }\n                    }\n                }\n            }\n        }\n        if (!layerId) {\n            console.log(\"ERROR layer id (\" + layerName + \" / \" + service + \") was not found !?\");\n        }\n\n        return layerId;\n    },\n\n    /**\n     * Rcupration des paramtres ncessaires  l'affichage d'une couche WMS ou WMTS\n     *\n     * @param {String} layerName - nom de la couche (par ex. \"ORTHOIMAGERY.ORTHOPHOTOS\")\n     * @param {String} service   - nom du service (par ex. \"WMS\" ou \"WMTS\")\n     * @param {String} [apiKey]  - Cl de contrat API\n     * @returns {Object} params  - paramtres du service (WMS ou WMTS) pour la couche donne\n     * @returns {String} params.url        - Url du service  requter pour afficher la couche\n     * @returns {String} params.version    - Version du service\n     * @returns {String} params.styles     - Style par dfaut de la couche\n     * @returns {String} params.format     - Format par dfaut de la couche\n     * @returns {String} params.projection - Projection par dfaut de la couche\n     * @returns {Number} params.minScale   - Dnominateur d'chelle minimum de la couche\n     * @returns {Number} params.maxScale   - Dnominateur d'chelle maximum de la couche\n     * @returns {Gp.BBox} params.extent    - Etendue de la couche, dans la projection de la couche\n     * @returns {Array} params.legends     - Tableau des lgendes associes  la couche\n     * @returns {Array} params.metadata    - Tableau des mtadonnes associes  la couche\n     * @returns {Array} params.originators - Tableau des originators associs  la couche\n     * @returns {Array} params.title       - Nom de la resource, lisible par un humain.\n     * @returns {Array} params.description - Url de l'image d'aperu rapide de la ressource.\n     * @returns {Array} params.quicklookUrl- Tableau des originators associs  la couche\n     * @returns {String} params.[TMSLink]          - Identifiant de la pyramide (TMS), dans le cas d'une couche WMTS\n     * @returns {Gp.Point} params.[matrixOrigin]   - Origine de la matrice (top left corner), dans le cas d'une couche WMTS\n     * @returns {Array} params.[nativeResolutions] - Tableau regroupant les rsolutions de chaque niveau de la matrice, dans le cas d'une couche WMTS\n     * @returns {Array} params.[matrixIds]         - Tableau regroupant les identifiants de chaque niveau de la matrice, dans le cas d'une couche WMTS\n     */\n    getLayerParams: function(layerName, service, apiKey) {\n        var params = {};\n\n        if (this.configuration) {\n            // rcupration de l'identifiant complet de la couche.\n            var layerId = this.getLayerId(layerName, service);\n\n            if (layerId) {\n                // rcupration de l'objet de configuration de la couche\n                var layerConf = this.configuration.layers[layerId];\n\n                // controle de la clef\n                var key = layerConf.apiKeys[0];\n                if (apiKey) {\n                    if (apiKey !== key) {\n                        console.log(\"ERROR different keys (\" + apiKey + \" !== \" + key + \") !?\");\n                        return;\n                    }\n                }\n\n                apiKey = apiKey || key;\n                params.key = apiKey;\n                // rcupration des paramtres du service\n                params.url = layerConf.getServerUrl(apiKey);\n                params.version = layerConf.getServiceParams().version;\n                params.styles = layerConf.getDefaultStyle();\n                params.format = layerConf.getDefaultFormat();\n                params.projection = layerConf.getDefaultProjection();\n\n                // rcupration des infos de la couche\n                params.minScale = layerConf.getMinScaleDenominator();\n                params.maxScale = layerConf.getMaxScaleDenominator();\n                params.extent = layerConf.getBBOX();\n                params.legends = layerConf.getLegends();\n                params.metadata = layerConf.getMetadata();\n                params.originators = layerConf.getOriginators();\n                params.title = layerConf.getTitle();\n                params.description = layerConf.getDescription();\n                params.quicklookUrl = layerConf.getQuicklookUrl();\n\n                // WMTS : rcupration des tileMatrixSetLimits\n                if (layerConf.wmtsOptions) {\n                    params.tileMatrixSetLimits = layerConf.wmtsOptions.tileMatrixSetLimits;\n                }\n\n                // WMTS : rcupration des paramtres de la pyramide (TMS)\n                var TMSLink = layerConf.getTMSID();\n                if (TMSLink) {\n                    params.TMSLink = TMSLink;\n                    var tmsConf = this.configuration.getTMSConf(TMSLink);\n                    // Get matrix origin : Gp.Point = Object{x:Float, y:Float}\n                    params.matrixOrigin = tmsConf.getTopLeftCorner();\n                    params.nativeResolutions = tmsConf.nativeResolutions;\n                    params.matrixIds = tmsConf.matrixIds;\n                    params.tileMatrices = tmsConf.tileMatrices;\n                }\n            }\n        }\n\n        return params;\n    },\n\n    /**\n     * Recuperation des parametres d'un service\n     *\n     * @param {String} [resource] - \"PositionOfInterest\", \"StreetAddress\", \"Voiture\", \"Pieton\", ...\n     * @param {String} [service] - Geocode, Itineraire, ...\n     * @param {String} [apiKey]  - Cl de contrat API\n     * @returns {Object} params - paramtres de la ressource\n     * @returns {String} params. -\n     * @returns {String} params. -\n     * @returns {String} params. -\n     */\n    getServiceParams: function(resource, service, apiKey) {\n\n        var params = {};\n\n        if (this.configuration) {\n            // rcupration de l'identifiant complet de la couche.\n            var layerId = this.getLayerId(resource, service);\n\n            if (layerId) {\n                // rcupration de l'objet de configuration de la couche\n                var layerConf = this.configuration.layers[layerId];\n\n                // controle de la clef\n                var key = layerConf.apiKeys[0];\n                if (apiKey) {\n                    if (apiKey !== key) {\n                        return;\n                    }\n                }\n\n                apiKey = apiKey || key;\n                params.key = apiKey;\n                // rcupration des paramtres du service\n                params.url = layerConf.getServerUrl(apiKey);\n                params.version = layerConf.getServiceParams().version;\n\n                // rcupration des infos de la couche\n                params.extent = layerConf.getBBOX();\n                params.title = layerConf.getTitle();\n                params.description = layerConf.getDescription();\n\n            }\n        }\n\n        return params;\n    },\n\n    /**\n     * Resolution en geographique\n     */\n    getResolutions: function() {\n        var resolutions = [];\n\n        if (this.configuration) {\n            resolutions = this.configuration[\"generalOptions\"][\"wgs84Resolutions\"];\n        }\n\n        return resolutions;\n    },\n\n    /**\n     * Recuperation des parametres TMS de la configuration\n     */\n    getTileMatrix: function(tmsName) {\n        var tms = {};\n\n        if (this.configuration) {\n            if (tmsName) {\n                tms = this.configuration[\"tileMatrixSets\"][tmsName.toUpperCase()];\n            }\n        }\n\n        return tms;\n    },\n\n    /**\n     * Rcupration des contraintes gnrales d'une couche donne : extent, minScale, maxScale, projection\n     *\n     * @param {String} layerId - identifiant de la couche\n     * @returns {Object} params - contraintes de la couche\n     * @returns {String} params.projection - Projection par dfaut de la couche\n     * @returns {Number} params.minScale   - Dnominateur d'chelle minimum de la couche\n     * @returns {Number} params.maxScale   - Dnominateur d'chelle maximum de la couche\n     * @returns {Gp.BBox} params.extent    - Etendue de la couche, dans la projection de la couche\n     */\n    getGlobalConstraints: function(layerId) {\n        var params = {};\n\n        if (layerId) {\n            // rcupration de l'objet de configuration de la couche\n            var layerConf = this.configuration.layers[layerId];\n            params.projection = layerConf.getDefaultProjection();\n            params.minScale = layerConf.getMinScaleDenominator();\n            params.maxScale = layerConf.getMaxScaleDenominator();\n            params.extent = layerConf.getBBOX();\n        }\n\n        return params;\n    }\n};\n\nexport default Config;\n\n\n\n// WEBPACK FOOTER //\n// ./src/Common/Utils/Config.js","/**\n * Constructor\n *\n * @constructor\n */\nfunction Widget(options) {\n    this.name = null;\n    this._element = null;\n    this._target = null;\n    this._globe = null;\n\n    this.setOptions(options);\n}\n\n/**\n * Constructor (alias)\n */\nWidget.prototype.constructor = Widget;\n\n/**\n * Return the widget's container element.\n *\n * @method\n * @return {HTMLElement} widget's container element.\n */\nWidget.prototype.getElement = function getElement() {\n    return this._element;\n};\n\n/**\n * Associates the widget to a specified target div.\n *\n * @method\n * @param {HTMLElement} targetDiv - widget target div.\n * @param {String} position - html position attribute.\n */\nWidget.prototype.setTarget = function setTarget(targetDiv, position) {\n    if (!targetDiv) {\n        return;\n    }\n\n    if (position && position !== \"absolute\" && position !== \"relative\") {\n        console.log(\"[ERROR] Widget:setTarget - position value should be 'absolute' or 'relative'\");\n        return;\n    }\n\n    if (this._target && this._element) {\n        this._target.removeChild(this._element);\n    }\n\n    this._target = targetDiv;\n\n    if (!this._element) {\n        console.log(\"[ERROR] Widget:setTarget - widget element not created\");\n        return;\n    }\n\n    this._element.style.position = position || \"relative\";\n\n    targetDiv.appendChild(this._element);\n};\n\n/**\n * Return the widget's target div.\n *\n * @method\n * @return {HTMLElement} widget's target div.\n */\nWidget.prototype.getTarget = function getTarget() {\n    return this._target;\n};\n\n/**\n * Change the options of the widget.\n *\n * @method\n * @param {Object} options - The new options of the control.\n */\nWidget.prototype.setOptions = function setOptions(options) {\n    this.name = options.name;\n    this._element = options.element;\n    this.setTarget(options.target, options.position);\n};\n\n/**\n * Get the globe associated with the widget. Undefined if the widget is not added to a globe.\n *\n * @method\n * @return {Object} globe\n */\nWidget.prototype.getGlobe = function getGlobe() {\n    return this._globe;\n};\n\n/**\n * Associate a globe to the widget.\n *\n * @method\n * @param {Object} globe - Globe to associate to the widget.\n */\nWidget.prototype.setGlobe = function setGlobe(globe) {\n    this._globe = globe;\n};\n\nexport default Widget;\n\n\n\n// WEBPACK FOOTER //\n// ./src/Itowns/Controls/Widget.js","import ol from \"ol\";\nimport Utils from \"../../Common/Utils\";\nimport SelectorID from \"../../Common/Utils/SelectorID\";\nimport LayerSwitcherDOM from \"../../Common/Controls/LayerSwitcherDOM\";\n\n/**\n * @classdesc\n * OpenLayers Control to manage map layers : their order, visibility and opacity, and display their informations (title, description, legends, metadata...)\n *\n * @constructor\n * @extends {ol.control.Control}\n * @alias ol.control.LayerSwitcher\n * @param {Object} lsOptions - control options\n * @param {Array} [lsOptions.layers] - list of layers to be configured. Each array element is an object, with following properties :\n * @param {ol.layer.Layer} [lsOptions.layers.layer] - ol.layer.Layer layer to be configured (that has been added to map)\n * @param {Object} [lsOptions.layers.config] - custom configuration object for layer information (title, description, legends, metadata, quicklook url), with following properties :\n * @param {String} [lsOptions.layers.config.title] - layer alias, to be displayed in widget layer list. E.g. : \"Cartes IGN\"\n * @param {String} [lsOptions.layers.config.description] - layer description, to be displayed on title hover, or in layer information panel.\n * @param {String} [lsOptions.layers.config.quicklookUrl] - link to a quick look image for this layer.\n * @param {Array} [lsOptions.layers.config.legends] - array of layer legends. Each array element is an object, with following properties :\n *      - url (String, mandatory) : link to a legend\n *      - minScaleDenominator (Number, optional) : min scale denominator for legend validity.\n * @param {Array} [lsOptions.layers.config.metadata] - array of layer metadata. Each array element is an object, with property url (String, mandatory) : link to a metadata\n * @param {Object} [lsOptions.options] - ol.control.Control options (see {@link http://openlayers.org/en/latest/apidoc/ol.control.Control.html ol.control.Control})\n * @param {Boolean} [lsOptions.options.collapsed] - Specify if widget has to be collapsed (true) or not (false) on map loading. Default is true.\n * @example\n * map.addControl(new ol.control.LayerSwitcher(\n *  [\n *      {\n *          layer : wms1,\n *          config : {\n *              title : \"test layer name 1\",\n *              description : \"test layer desc 1\",\n *          }\n *      }\n *  ],\n *  {\n *      collapsed : true\n *  }\n * ));\n */\nfunction LayerSwitcher(lsOptions) {\n\n    lsOptions = lsOptions || {};\n    var options = lsOptions.options || {};\n    var layers = lsOptions.layers || [];\n\n    if (!(this instanceof LayerSwitcher)) {\n        throw new TypeError(\"ERROR CLASS_CONSTRUCTOR\");\n    }\n\n    if (layers && !Array.isArray(layers)) {\n        throw new Error(\"ERROR WRONG_TYPE : layers should be an array\");\n    }\n\n    if (options && typeof options !== \"object\") {\n        throw new Error(\"ERROR WRONG_TYPE : options should be an object\");\n    }\n\n    this._initialize(options, layers);\n\n    var container = this._initContainer(options);\n\n    // call ol.control.Control constructor\n    ol.control.Control.call(this, {\n        element: container,\n        target: options.target,\n        render: options.render\n    });\n}\n\n// Inherits from ol.control.Control\nol.inherits(LayerSwitcher, ol.control.Control);\n\n/*\n * @lends module:LayerSwitcher\n */\nLayerSwitcher.prototype = Object.create(ol.control.Control.prototype, {});\n\n// on rcupre les mthodes de la classe commune LayerSwitcherDOM\nUtils.assign(LayerSwitcher.prototype, LayerSwitcherDOM);\n\n/**\n * Constructor (alias)\n *\n * @private\n */\nLayerSwitcher.prototype.constructor = LayerSwitcher;\n\n// ################################################################### //\n// ############## public methods (getters, setters) ################## //\n// ################################################################### //\n\n/**\n * Overload setMap function, that enables to catch map events, such as movend events.\n *\n * @param {ol.Map} map - Map.\n */\nLayerSwitcher.prototype.setMap = function(map) {\n\n    // info : cette mthode est appele (entre autres?) aprs un map.addControl() ou map.removeControl()\n\n    if (map) { // dans le cas de l'ajout du contrle  la map\n\n        // on ajoute les couches\n        this._addMapLayers(map);\n\n        // At every map movement, layer switcher may be updated,\n        // according to layers on map, and their range.\n        this._listeners.onMoveListener = map.on(\n            \"moveend\",\n            function() {\n                this._onMapMoveEnd.call(this, map);\n            },\n            this\n        );\n\n        // add event listeners when a new layer is added to map, to add it in LayerSwitcher control (and DOM)\n        this._listeners.onAddListener = map.getLayers().on(\n            \"add\",\n            function(evt) {\n                var layer = evt.element;\n                var id;\n                // on attribue un nouvel identifiant  cette couche,\n                // sauf si c'est une couche qui a dj t ajoute dans le LayerSwitcher au pralable (si gpLayerId existe)\n                if (!layer.hasOwnProperty(\"gpLayerId\")) {\n                    id = this._layerId;\n                    layer.gpLayerId = id;\n                    this._layerId++;\n                } else {\n                    id = layer.gpLayerId;\n                }\n                if (!this._layers[id]) {\n                    this.addLayer(layer);\n                }\n            },\n            this\n        );\n\n        // add event listeners when a layer is removed from map, to remove it from LayerSwitcher control (and DOM)\n        this._listeners.onRemoveListener = map.getLayers().on(\n            \"remove\",\n            function(evt) {\n                var layer = evt.element;\n                var id = layer.gpLayerId;\n                if (this._layers[id]) {\n                    this.removeLayer(layer);\n                }\n            },\n            this\n        );\n    } else {\n        // we are in a setMap(null) case\n        // we forget the listeners linked to the layerSwitcher\n        ol.Observable.unByKey(this._listeners.onMoveListener);\n        ol.Observable.unByKey(this._listeners.onAddListener);\n        ol.Observable.unByKey(this._listeners.onRemoveListener);\n\n        // we put all the layers at Zindex = 0, without changing the visual order\n        // in order that the next added layers are not hidden by layers with Zindex > 0\n        for (var i = this._layersOrder.length - 1; i >= 0; i--) {\n            this._layersOrder[i].layer.setZIndex(0);\n        }\n    }\n\n    // on appelle la mthode setMap originale d'OpenLayers\n    ol.control.Control.prototype.setMap.call(this, map);\n};\n\n/**\n * Add a new layer to control (when added to map) or add new layer configuration\n *\n * @param {ol.layer.Layer} layer - layer to add to layer switcher\n * @param {Object} [config] - additional options for layer configuration\n * @param {Object} [config.title] - layer title (default is layer identifier)\n * @param {Object} [config.description] - layer description (default is null)\n * @param {Object} [config.legends] - layer legends (default is an empty array)\n * @param {Object} [config.metadata] - layer metadata (default is an empty array)\n * @param {Object} [config.quicklookUrl] - layer quicklookUrl (default is null)\n * @example\n *   layerSwitcher.addLayer(\n *       gpParcels,\n *       {\n *           title : \"Parcelles cadastrales\",\n *           description : \"description de la couche\",\n *           quicklookUrl : \"http://quicklookUrl.fr\"\n *       }\n *   )\n */\nLayerSwitcher.prototype.addLayer = function(layer, config) {\n\n    var map = this.getMap();\n    config = config || {};\n\n    if (!layer) {\n        console.log(\"[ERROR] LayerSwitcher:addLayer - missing layer parameter\");\n        return;\n    }\n\n    var id = layer.gpLayerId;\n    if (id === \"undefined\") {\n        console.log(\"[ERROR] LayerSwitcher:addLayer - configuration cannot be set for \" + layer + \" layer (layer id not found)\");\n        return;\n    }\n\n    // make sure layer is in map layers\n    var isLayerInMap = false;\n    map.getLayers().forEach(\n        function(lyr) {\n            if (lyr.gpLayerId === id) {\n                isLayerInMap = true;\n            }\n        },\n        this\n    );\n    if (!isLayerInMap) {\n        console.log(\"[ERROR] LayerSwitcher:addLayer - configuration cannot be set for \", layer, \" layer (layer is not in map.getLayers() )\");\n        return;\n    }\n\n    // if layer is not already in layers list, add it to control (layers list and container div)\n    if (!this._layers[id]) {\n\n        // 1. add layer to layers list\n        var layerInfos = this.getLayerInfo(layer) || {};\n        var opacity = layer.getOpacity();\n        var visibility = layer.getVisible();\n        var isInRange = this.isInRange(layer, map);\n        var layerOptions = {\n            layer: layer,\n            id: id,\n            opacity: opacity != null ? opacity : 1,\n            visibility: visibility != null ? visibility : true,\n            inRange: isInRange != null ? isInRange : true,\n            title: config.title != null ? config.title : (layerInfos._title || id),\n            description: config.description || layerInfos._description || null,\n            legends: config.legends || layerInfos._legends || [],\n            metadata: config.metadata || layerInfos._metadata || [],\n            quicklookUrl: config.quicklookUrl || layerInfos._quicklookUrl || null\n        };\n        this._layers[id] = layerOptions;\n\n        // 2. create layer div (to be added to control main container)\n        // Cration de la div correspondante  cette couche\n        var layerDiv = this._createLayerDiv(layerOptions);\n        // on stocke la div dans les options de la couche, pour une ventuelle rorganisation (setZIndex par ex)\n        this._layers[id].div = layerDiv;\n\n        // 3. rorganisation des couches si un zIndex est spcifi\n        if ((layer.getZIndex && layer.getZIndex() !== 0) || layer._forceNullzIndex) {\n            // rorganisation des couches si un zIndex est spcifi\n            this._updateLayersOrder(map);\n        } else {\n            // sinon on ajoute la couche au dessus des autres\n            this._layersOrder.unshift(layerOptions);\n            this._lastZIndex++;\n            layer.setZIndex(this._lastZIndex);\n            this._layerListContainer.insertBefore(layerDiv, this._layerListContainer.firstChild);\n        }\n\n        // 3. Add listeners for opacity and visibility changes\n        layer.on(\n            \"change:opacity\",\n            this._updateLayerOpacity,\n            this\n        );\n        layer.on(\n            \"change:visible\",\n            this._updateLayerVisibility,\n            this\n        );\n        // listener for zIndex change\n        var context = this;\n        /** fonction de callback appele au changement de zindex d'une couche  */\n        var updateLayersOrder = function(e) {\n            context._updateLayersOrder.call(context, e);\n        };\n        if (this._layers[id].onZIndexChangeEvent == null) {\n            this._layers[id].onZIndexChangeEvent = layer.on(\n                \"change:zIndex\",\n                updateLayersOrder\n            );\n        }\n\n        // user may also add a new configuration for an already added layer\n    } else if (this._layers[id] && config) {\n\n        // add new configuration parameters to layer informations\n        for (var prop in config) {\n            if (config.hasOwnProperty(prop)) {\n                this._layers[id][prop] = config[prop];\n            }\n        }\n        // set new title in layer div\n        if (config.title) {\n            var nameDiv = document.getElementById(this._addUID(\"GPname_ID_\" + id));\n            if (nameDiv) {\n                nameDiv.innerHTML = config.title;\n                nameDiv.title = config.description || config.title;\n            }\n        }\n        // add layer info picto if necessary\n        var infodiv = document.getElementById(this._addUID(\"GPinfo_ID_\" + id));\n        if (!document.getElementById(this._addUID(\"GPinfo_ID_\" + id)) && config.description) {\n            var advancedTools = document.getElementById(this._addUID(\"GPadvancedTools_ID_\" + id));\n            if (advancedTools) {\n                advancedTools.appendChild(\n                    this._createAdvancedToolInformationElement({\n                        id: id\n                    })\n                );\n            }\n        }\n        // close layer info element if open, to update information.\n        if (infodiv && infodiv.className === \"GPlayerInfoOpened\") {\n            document.getElementById(this._addUID(\"GPlayerInfoPanel\")).className = \"GPlayerInfoPanelClosed\";\n            infodiv.className === \"GPlayerInfo\";\n        }\n\n    }\n};\n\n/**\n * Remove a layer from control\n *\n * @param {ol.layer.Layer} layer - layer.\n */\nLayerSwitcher.prototype.removeLayer = function(layer) {\n\n    var layerID = layer.gpLayerId;\n    var layerList = document.getElementById(this._addUID(\"GPlayersList\"));\n    // close layer info element if open.\n    var infodiv = document.getElementById(this._addUID(\"GPinfo_ID_\" + layerID));\n    if (infodiv && infodiv.className === \"GPlayerInfoOpened\") {\n        document.getElementById(this._addUID(\"GPlayerInfoPanel\")).className = \"GPlayerInfoPanelClosed\";\n        infodiv.className === \"GPlayerInfo\";\n    }\n    // remove layer div\n    var layerDiv = document.getElementById(this._addUID(\"GPlayerSwitcher_ID_\" + layerID));\n    layerList.removeChild(layerDiv);\n\n    var layerIndex = Math.abs(layer.getZIndex() - this._lastZIndex);\n    // on retire la couche de la liste ordonne des layers\n    this._layersOrder.splice(layerIndex, 1);\n    this._lastZIndex--;\n    // on met  jour les zindex des couches restantes\n    var layerOrderTemp = this._layersOrder;\n    for (var i = 0; i < layerOrderTemp.length; i++) {\n        layerOrderTemp[i].layer.setZIndex(this._lastZIndex - i);\n    }\n    // on retire la couche de la liste des layers\n    delete this._layers[layerID];\n};\n\n/**\n * Collapse or display control main container\n *\n * @param {Boolean} collapsed - True to collapse control, False to display it\n */\nLayerSwitcher.prototype.setCollapsed = function(collapsed) {\n    if (collapsed === undefined) {\n        console.log(\"[ERROR] LayerSwitcher:setCollapsed - missing collapsed parameter\");\n        return;\n    }\n    var isCollapsed = !document.getElementById(this._addUID(\"GPshowLayersList\")).checked;\n    if ((collapsed && isCollapsed) || (!collapsed && !isCollapsed)) {\n        return;\n    }\n    // on simule l'ouverture du panneau aprs un click\n    if (!isCollapsed) {\n        var layers = document.getElementsByClassName(\"GPlayerInfoOpened\");\n        for (var i = 0; i < layers.length; i++) {\n            layers[i].className = \"GPlayerInfo\";\n        }\n        document.getElementById(this._addUID(\"GPlayerInfoPanel\")).className = \"GPlayerInfoPanelClosed\";\n    }\n    document.getElementById(this._addUID(\"GPshowLayersList\")).checked = !collapsed;\n};\n\n/**\n * Returns true if widget is collapsed (minimize), false otherwise\n */\nLayerSwitcher.prototype.getCollapsed = function() {\n    return this.collapsed;\n};\n\n/**\n * Display or hide removeLayerPicto from layerSwitcher for this layer\n *\n * @param {ol.layer.Layer} layer - ol.layer to be configured\n * @param {Boolean} removable - specify if layer can be remove from layerSwitcher (true) or not (false). Default is true\n */\nLayerSwitcher.prototype.setRemovable = function(layer, removable) {\n    if (!layer) {\n        return;\n    }\n    var layerID = layer.gpLayerId;\n    if (layerID == null) { // on teste si layerID est null ou undefined\n        console.log(\"[LayerSwitcher:setRemovable] layer should be added to map before calling setRemovable method\");\n        return;\n    }\n    var removalDiv = document.getElementById(this._addUID(\"GPremove_ID_\" + layerID));\n    console.log(removalDiv.style.display);\n    if (removalDiv) {\n        if (removable === false) {\n            removalDiv.style.display = \"none\";\n        } else if (removable === true) {\n            removalDiv.style.display = \"block\";\n        } else {\n            return;\n        }\n    }\n};\n\n// ################################################################### //\n// ##################### init component ############################## //\n// ################################################################### //\n\n/**\n * Initialize LayerSwitcher control (called by constructor)\n *\n * @param {Object} options - ol.control.Control options (see {@link http://openlayers.org/en/latest/apidoc/ol.control.Control.html ol.control.Control})\n * @param {Array} layers - list of layers to be configured. Each array element is an object, with following properties :\n * @private\n */\nLayerSwitcher.prototype._initialize = function(options, layers) {\n\n    // identifiant du contrle : utile pour suffixer les identifiants CSS (pour grer le cas o il y en a plusieurs dans la mme page)\n    this._uid = SelectorID.generate();\n\n    // {Object} control layers list. Each key is a layer id, and its value is an object of layers options (layer, id, opacity, visibility, title, description...)\n    this._layers = {};\n    // [Array] array of ordered control layers\n    this._layersOrder = [];\n    // [Object] associative array of layers ordered by zindex (keys are zindex values, and corresponding values are arrays of layers at this zindex)\n    this._layersIndex = {};\n    // {Number} layers max z index, to order layers using their z index\n    this._lastZIndex = 0;\n    // {Number} layers max id, incremented when a new layer is added\n    this._layerId = 0;\n    /** {Boolean} true if widget is collapsed, false otherwise */\n    this.collapsed = (options.collapsed !== undefined) ? options.collapsed : true;\n    // div qui contiendra les div des listes.\n    this._layerListContainer = null;\n    // [Object] listeners added to the layerSwitcher saved here in order to delete them if we remove the control from the map)\n    this._listeners = {};\n\n    // add options layers to layerlist.\n    // (seulement les couches configures dans les options du layerSwitcher par l'utilisateur),\n    // les autres couches de la carte seront ajoutes dans la mthode setMap\n    for (var i = 0; i < layers.length; i++) {\n        // recup la layer, son id,\n        var layer = layers[i].layer;\n        if (layer) {\n            var id;\n            // si elles ont dj un identifiant (gpLayerId), on le rcupre, sinon on en cre un nouveau, en incrmentant this_layerId.\n            if (!layer.hasOwnProperty(\"gpLayerId\")) {\n                id = this._layerId;\n                layer.gpLayerId = id;\n                this._layerId++;\n            } else {\n                id = layer.gpLayerId;\n            }\n\n            // et les infos de la conf si elles existent (title, description, legends, quicklook, metadata)\n            var conf = layers[i].config || {};\n            var opacity = layer.getOpacity();\n            var visibility = layer.getVisible();\n            var layerOptions = {\n                layer: layer, // la couche ol.layer concerne\n                id: id,\n                opacity: opacity != null ? opacity : 1,\n                visibility: visibility != null ? visibility : true,\n                title: conf.title != null ? conf.title : id,\n                description: conf.description || null,\n                legends: conf.legends || [],\n                metadata: conf.metadata || [],\n                quicklookUrl: conf.quicklookUrl || null\n            };\n            this._layers[id] = layerOptions;\n        }\n    }\n};\n\n/**\n * Create control main container (called by constructor)\n *\n * @returns {DOMElement} container - control container\n * @private\n */\nLayerSwitcher.prototype._initContainer = function() {\n    // creation du container principal\n    var container = this._createMainContainerElement();\n\n    // ajout dans le container principal d'affichage des layers\n    var input = this._createMainLayersShowElement();\n    container.appendChild(input);\n\n    // gestion du mode \"collapsed\"\n    if (!this.collapsed) {\n        input.checked = \"checked\";\n        this.collapsed = false;\n    } else {\n        this.collapsed = true;\n    }\n\n    // on ajoute un couteur d'vnement sur le bouton (checkbox) de dpliement/repliement des couches,\n    // pour modifier la proprit this.collapsed quand on clique dessus\n    var context = this;\n    /** event listener */\n    var changeCollapsed = function(e) {\n        this.collapsed = !e.target.checked;\n        // on gnre nous mme l'evenement OpenLayers de changement de pt\n        // (utiliser layerSwitcher.on(\"change:collapsed\", function ) pour s'abonner  cet vnement)\n        this.dispatchEvent(\"change:collapsed\");\n    };\n    input.addEventListener(\n        \"click\",\n        function(e) {\n            changeCollapsed.call(context, e);\n        }\n    );\n\n    // ajout dans le container principal de la liste des layers\n    var divL = this._layerListContainer = this._createMainLayersElement();\n    container.appendChild(divL);\n\n    // creation du mode draggable\n    this._createDraggableElement(divL, this);\n\n    // ajout dans le container principal du picto du controle\n    var picto = this._createMainPictoElement();\n    container.appendChild(picto);\n\n    // ajout dans le container principal du panneau d'information\n    var divI = this._createMainInfoElement();\n    container.appendChild(divI);\n\n    return container;\n};\n\n/**\n * Add all map layers to control main container\n *\n * @param {Object} map - ol.Map object, to which control is added\n * @private\n */\nLayerSwitcher.prototype._addMapLayers = function(map) {\n\n    this._layersIndex = {};\n    var context = this;\n\n    // on parcourt toutes les couches de la carte, pour les ajouter  la liste du controle si ce n'est pas dj le cas.\n    // ide : le layerSwitcher doit reprsenter l'ensemble des couches de la carte.\n    map.getLayers().forEach(\n        function(layer) {\n\n            // ajout des couches de la carte  la liste\n            var id;\n            // si elles ont dj un identifiant (gpLayerId), on le rcupre, sinon on en cre un nouveau, en incrmentant this_layerId.\n            if (!layer.hasOwnProperty(\"gpLayerId\")) {\n                id = this._layerId;\n                layer.gpLayerId = id;\n                this._layerId++;\n            } else {\n                id = layer.gpLayerId;\n            }\n\n            var layerInfos = this.getLayerInfo(layer) || {};\n            if (!this._layers[id]) {\n                // si la couche n'est pas encore dans la liste des layers (this._layers), on l'ajoute\n                var opacity = layer.getOpacity();\n                var visibility = layer.getVisible();\n                var isInRange = this.isInRange(layer, map);\n                var layerOptions = {\n                    layer: layer,\n                    id: id,\n                    opacity: opacity != null ? opacity : 1,\n                    visibility: visibility != null ? visibility : true,\n                    inRange: isInRange != null ? isInRange : true,\n                    title: layerInfos._title || id,\n                    description: layerInfos._description || null,\n                    legends: layerInfos._legends || [],\n                    metadata: layerInfos._metadata || [],\n                    quicklookUrl: layerInfos._quicklookUrl || null\n                };\n                this._layers[id] = layerOptions;\n            } else {\n                // si elle existe dj, on met  jour ses informations (visibility, opacity, inRange)\n                this._layers[id].opacity = layer.getOpacity();\n                this._layers[id].visibility = layer.getVisible();\n                this._layers[id].inRange = this.isInRange(layer, map);\n            }\n\n            // Ajout de listeners sur les changements d'opacit, visibilit\n            layer.on(\n                \"change:opacity\",\n                this._updateLayerOpacity,\n                this\n            );\n            layer.on(\n                \"change:visible\",\n                this._updateLayerVisibility,\n                this\n            );\n\n            // rcupration des zindex des couches s'ils existent, pour les ordonner.\n            var layerIndex = null;\n            if (layer.getZIndex !== undefined) {\n                layerIndex = layer.getZIndex();\n                if (!this._layersIndex[layerIndex] || !Array.isArray(this._layersIndex[layerIndex])) {\n                    this._layersIndex[layerIndex] = [];\n                }\n                this._layersIndex[layerIndex].push(this._layers[id]);\n            };\n        },\n        this\n    );\n\n    // on rcupre l'ordre d'affichage des couches entre elles dans la carte,  partir de zindex.\n    /** fonction de callback appele au changement de zindex d'une couche  */\n    var updateLayersOrder = function(e) {\n        context._updateLayersOrder.call(context, e);\n    };\n    for (var zindex in this._layersIndex) {\n        if (this._layersIndex.hasOwnProperty(zindex)) {\n            var layers = this._layersIndex[zindex];\n            for (var l = 0; l < layers.length; l++) { //  ce stade layers[l] est une couche de this._layers.\n                // on conserve l'ordre des couches : la premire est celle qui se situe tout en haut, et la dernire est le \"fond de carte\"\n                this._layersOrder.unshift(layers[l]);\n                // et on rordonne les couches avec des zindex, uniques.\n                this._lastZIndex++;\n                layers[l].layer.setZIndex(this._lastZIndex);\n                if (this._layers[layers[l].layer.gpLayerId].onZIndexChangeEvent == null) {\n                    this._layers[layers[l].layer.gpLayerId].onZIndexChangeEvent = layers[l].layer.on(\n                        \"change:zIndex\",\n                        updateLayersOrder\n                    );\n                }\n            }\n        }\n    }\n\n    // on ajoute les div correspondantes aux diffrentes couches (dans l'ordre inverse d'affichage) dans le controle.\n    for (var j = 0; j < this._layersOrder.length; j++) {\n        var layerOptions = this._layersOrder[j];\n        var layerDiv = this._createLayerDiv(layerOptions);\n        this._layerListContainer.appendChild(layerDiv);\n        // on stocke la div dans les options de la couche, pour une ventuelle rorganisation (setZIndex par ex)\n        this._layers[layerOptions.id].div = layerDiv;\n    }\n};\n\n/**\n * create layer div (to append to control DOM element).\n *\n * @param {Object} layerOptions - layer options (id, title, description, legends, metadata, quicklookUrl ...)\n * @private\n */\nLayerSwitcher.prototype._createLayerDiv = function(layerOptions) {\n    var isLegends = layerOptions.legends && layerOptions.legends.length !== 0;\n    var isMetadata = layerOptions.metadata && layerOptions.metadata.length !== 0;\n    var isQuicklookUrl = layerOptions.quicklookUrl;\n    // on n'affiche les informations que si elles sont renseignes (pour ne pas avoir un panneau vide)\n    if (isLegends || isMetadata || isQuicklookUrl) {\n        layerOptions.displayInformationElement = true;\n    }\n\n    // ajout d'une div pour cette layer dans le control\n    var layerDiv = this._createContainerLayerElement(layerOptions);\n\n    if (!layerOptions.inRange) {\n        layerDiv.classList.add(\"outOfRange\");\n    }\n\n    return layerDiv;\n};\n\n// ################################################################### //\n// ######################### DOM events ############################## //\n// ################################################################### //\n\n/**\n * Change layer opacity on layer opacity picto click\n *\n * @param {Object} e - event\n * @private\n */\nLayerSwitcher.prototype._onChangeLayerOpacity = function(e) {\n    var divId = e.target.id; // ex GPvisibilityPicto_ID_26\n    var layerID = SelectorID.index(divId); // ex. 26\n    var layer = this._layers[layerID].layer;\n\n    var opacityValue = e.target.value;\n    var opacityId = document.getElementById(this._addUID(\"GPopacityValue_ID_\" + layerID));\n    opacityId.innerHTML = opacityValue + \"%\";\n\n    layer.setOpacity(opacityValue / 100);\n};\n\n/**\n * Update picto opacity value on layer opacity change\n *\n * @param {Object} e - event\n * @private\n */\nLayerSwitcher.prototype._updateLayerOpacity = function(e) {\n    var opacity = e.target.getOpacity();\n    if (opacity > 1) {\n        opacity = 1;\n    }\n    if (opacity < 0) {\n        opacity = 0;\n    }\n    var id = e.target.gpLayerId;\n    var layerOpacityInput = document.getElementById(this._addUID(\"GPopacityValueDiv_ID_\" + id));\n    layerOpacityInput.value = Math.round(opacity * 100);\n    var layerOpacitySpan = document.getElementById(this._addUID(\"GPopacityValue_ID_\" + id));\n    layerOpacitySpan.innerHTML = Math.round(opacity * 100) + \"%\";\n};\n\n/**\n * Change layer visibility on layer visibility picto click\n *\n * @param {Object} e - event\n * @private\n */\nLayerSwitcher.prototype._onVisibilityLayerClick = function(e) {\n    var divId = e.target.id; // ex GPvisibilityPicto_ID_26\n    var layerID = SelectorID.index(divId); // ex. 26\n    var layer = this._layers[layerID].layer;\n\n    layer.setVisible(e.target.checked);\n};\n\n/**\n * Change picto visibility on layer visibility change\n *\n * @param {Object} e - event\n * @private\n */\nLayerSwitcher.prototype._updateLayerVisibility = function(e) {\n    var visible = e.target.getVisible();\n    var id = e.target.gpLayerId;\n    var layerVisibilityInput = document.getElementById(this._addUID(\"GPvisibility_ID_\" + id));\n    layerVisibilityInput.checked = visible;\n};\n\n/**\n * Change layers order in layerswitcher (control container) on a layer index change (on map) or when a layer is added to a specific zindex\n *\n * @private\n */\nLayerSwitcher.prototype._updateLayersOrder = function() {\n\n    // info :\n    // 1. on rcupre les zindex et les couches associes dans un tableau associatif (objet)\n    // 2. on rordonne les couche selon leur index : on leur attribue de nouveaux zindex uniques\n    // 3. on vide le container des layers, et rajoute les div des couches dans l'ordre dcroissant des zindex\n\n    var map = this.getMap();\n    if (!map) {\n        return;\n    }\n    this._layersIndex = {};\n    var layerIndex;\n    var id;\n\n    // on parcourt toutes les couches pour rcuprer leur ordre :\n    // on stocke les couches dans un tableau associatif ou les cls sont les zindex, et les valeurs sont des tableaux des couches  ce zindex.\n    map.getLayers().forEach(\n        function(layer) {\n            id = layer.gpLayerId;\n\n            // on commence par dsactiver temporairement l'couteur d'vnements sur le changement de zindex.\n            ol.Observable.unByKey(this._layers[id].onZIndexChangeEvent);\n            this._layers[id].onZIndexChangeEvent = null;\n\n            // on ajoute la couche dans le tableau (de l'objet this._layersIndex) correspondant  son zindex\n            layerIndex = null;\n            if (layer.getZIndex !== undefined) {\n                layerIndex = layer.getZIndex();\n                if (!this._layersIndex[layerIndex] || !Array.isArray(this._layersIndex[layerIndex])) {\n                    this._layersIndex[layerIndex] = [];\n                }\n                this._layersIndex[layerIndex].push(this._layers[id]);\n            };\n        }, this\n    );\n\n    // on rordonne les couches entre elles dans la carte,  partir des zindex stocks ci-dessus.\n    this._lastZIndex = 0;\n    var context = this;\n    /** fonction de callback appele au changement de zindex d'une couche  */\n    var updateLayersOrder = function(e) {\n        context._updateLayersOrder.call(context, e);\n    };\n    this._layersOrder = [];\n    for (var zindex in this._layersIndex) {\n        if (this._layersIndex.hasOwnProperty(zindex)) {\n            var layers = this._layersIndex[zindex];\n            for (var l = 0; l < layers.length; l++) { //  ce stade layers[l] est une couche de this._layers.\n                // on conserve l'ordre des couches : la premire est celle qui se situe tout en haut, et la dernire est le \"fond de carte\"\n                this._layersOrder.unshift(layers[l]);\n                // et on rordonne les couches avec des zindex, uniques.\n                this._lastZIndex++;\n                // layers[l].layer.setZIndex(lastZIndex);\n                // et on ractive l'couteur d'vnement sur les zindex\n                if (this._layers[layers[l].layer.gpLayerId].onZIndexChangeEvent == null) {\n                    this._layers[layers[l].layer.gpLayerId].onZIndexChangeEvent = layers[l].layer.on(\n                        \"change:zIndex\",\n                        updateLayersOrder\n                    );\n                }\n            }\n        }\n    }\n\n    if (this._layerListContainer) {\n        // on vide le container prcdent\n        while (this._layerListContainer.firstChild) {\n            this._layerListContainer.removeChild(this._layerListContainer.firstChild);\n        }\n        // et on rajoute les div correspondantes aux diffrentes couches, dans l'ordre dcroissant des zindex\n        for (var j = 0; j < this._layersOrder.length; j++) {\n            var layerOptions = this._layersOrder[j];\n            this._layerListContainer.appendChild(layerOptions.div);\n        }\n    } else {\n        console.log(\"[ol.control.LayerSwitcher] _updateLayersOrder : layer list container not found to update layers order ?!\");\n    }\n\n};\n\n/**\n * Open layer information panel on picto click\n *\n * @param {Event} e - MouseEvent\n * @private\n */\nLayerSwitcher.prototype._onOpenLayerInfoClick = function(e) {\n\n    var divId = e.target.id; // ex GPvisibilityPicto_ID_26\n    var layerID = SelectorID.index(divId); // ex. 26\n    var layerOptions = this._layers[layerID];\n\n    var panel;\n    var info;\n\n    // Close layer info panel\n    divId = document.getElementById(e.target.id);\n    if (divId.className === \"GPlayerInfoOpened\") {\n        if (divId.classList !== undefined) {\n            divId.classList.remove(\"GPlayerInfoOpened\");\n            divId.classList.add(\"GPlayerInfo\");\n        }\n\n        panel = document.getElementById(this._addUID(\"GPlayerInfoPanel\"));\n        if (panel.classList !== undefined) {\n            panel.classList.remove(\"GPpanel\");\n            panel.classList.remove(\"GPlayerInfoPanelOpened\");\n            panel.classList.add(\"GPlayerInfoPanelClosed\");\n        }\n\n        info = document.getElementById(this._addUID(\"GPlayerInfoContent\"));\n        panel.removeChild(info);\n        return;\n    }\n\n    var layers = document.getElementsByClassName(\"GPlayerInfoOpened\");\n    for (var i = 0; i < layers.length; i++) {\n        layers[i].className = \"GPlayerInfo\";\n    }\n\n    // Open layer info panel\n    if (divId.classList !== undefined) {\n        divId.classList.remove(\"GPlayerInfo\");\n        divId.classList.add(\"GPlayerInfoOpened\");\n    }\n\n    panel = document.getElementById(this._addUID(\"GPlayerInfoPanel\"));\n    if (panel.classList !== undefined) {\n        panel.classList.add(\"GPpanel\");\n        panel.classList.remove(\"GPlayerInfoPanelClosed\");\n        panel.classList.add(\"GPlayerInfoPanelOpened\");\n    }\n\n    info = document.getElementById(this._addUID(\"GPlayerInfoContent\"));\n    if (info) {\n        panel.removeChild(info);\n    }\n\n    // on rcupre les infos associes au layer pour mettre dynamiquement le contenu du panel d'informations\n    var obj = {\n        title: layerOptions.title,\n        description: layerOptions.description,\n        quicklookUrl: layerOptions.quicklookUrl,\n        metadata: layerOptions.metadata,\n        legends: layerOptions.legends\n    };\n    // get layer max scale denominator\n    var maxResolution = layerOptions.layer.getMaxResolution();\n    if (maxResolution === Infinity) {\n        obj._maxScaleDenominator = 560000000;\n    } else {\n        obj._maxScaleDenominator = Math.round(maxResolution / 0.00028);\n    }\n    var infoLayer = this._createContainerLayerInfoElement(obj);\n    panel.appendChild(infoLayer);\n};\n\n/**\n * remove layer from layer switcher and map on picto click\n *\n * @param {Event} e - MouseEvent\n * @private\n */\nLayerSwitcher.prototype._onDropLayerClick = function(e) {\n    var divId = e.target.id; // ex GPvisibilityPicto_ID_26\n    var layerID = SelectorID.index(divId); // ex. 26\n    var layer = this._layers[layerID].layer;\n\n    // le retrait de la couche va dclencher l'ecouteur d'venement,\n    // et appeler this.removeLayer qui va supprimer la div.\n    this.getMap().getLayers().remove(layer);\n};\n\n/**\n * change layers order (on map) on drag and drop (on control container)\n *\n * @private\n */\nLayerSwitcher.prototype._onDragAndDropLayerClick = function() {\n    // INFO : e.oldIndex et e.newIndex marchent en mode AMD mais pas Bundle.\n    var map = this.getMap();\n    var context = this;\n    /** fonction de callback appele au changement de zindex d'une couche  */\n    var updateLayersOrder = function(e) {\n        context._updateLayersOrder.call(context, e);\n    };\n\n    // on rcupre l'ordre des div dans le contrle pour rordonner les couches (avec zindex)\n    var matchesLayers = document.querySelectorAll(\"div.GPlayerSwitcher_layer\");\n    var maxZIndex = matchesLayers.length;\n    // on vide la liste ordonne avant de la remplir avec l'ordre des couches selon les div.\n    this._layersOrder = [];\n    for (var i = 0; i < matchesLayers.length; i++) {\n\n        var tag = matchesLayers[i].id;\n        var id = SelectorID.index(tag);\n        var layer = this._layers[id].layer;\n\n        // on commence par dsactiver temporairement l'couteur d'vnements sur le changement de zindex.\n        ol.Observable.unByKey(this._layers[id].onZIndexChangeEvent);\n        this._layers[id].onZIndexChangeEvent = null;\n\n        if (layer.setZIndex) {\n            // maxZIndex--;\n            layer.setZIndex(maxZIndex);\n            this._layersOrder.push(this._layers[id]);\n            maxZIndex--;\n        }\n\n        // et on ractive l'couteur d'vnement sur les zindex\n        if (this._layers[id].onZIndexChangeEvent == null) {\n            this._layers[id].onZIndexChangeEvent = layer.on(\n                \"change:zIndex\",\n                updateLayersOrder\n            );\n        }\n\n    }\n\n    // mise  jour de la visu\n    map.updateSize();\n};\n\n/**\n * check layers range on map movement\n *\n * @param {ol.Map} map - ol map on which event occured\n * @private\n */\nLayerSwitcher.prototype._onMapMoveEnd = function(map) {\n\n    // pour chaque couche de la map, on vrifie qu'elle soit toujours dans la visu (inRange)\n    map.getLayers().forEach(\n        function(layer) {\n            var id = layer.gpLayerId;\n            if (this._layers[id]) {\n                var layerOptions = this._layers[id];\n\n                // Check if layer is out of range.\n                var layerDiv;\n                if (this.isInRange(layer, map) && !layerOptions.inRange) {\n                    layerOptions.inRange = true;\n                    layerDiv = document.getElementById(this._addUID(\"GPlayerSwitcher_ID_\" + id));\n                    layerDiv.classList.remove(\"outOfRange\");\n                } else if (!this.isInRange(layer, map) && layerOptions.inRange) {\n                    layerOptions.inRange = false;\n                    layerDiv = document.getElementById(this._addUID(\"GPlayerSwitcher_ID_\" + id));\n                    layerDiv.classList.add(\"outOfRange\");\n                }\n            }\n        },\n        this\n    );\n};\n\n// ################################################################### //\n// ############################ Utils ################################ //\n// ################################################################### //\n\n/**\n * Returns Layer Container Id associated with given olLayer\n *\n * @param {ol.layer.Layer} olLayer - ol layer object\n * @returns {String} - div container Id ; null if layer not found.\n */\nLayerSwitcher.prototype.getLayerDOMId = function(olLayer) {\n\n    var foundId = null;\n\n    this.getMap().getLayers().forEach(function(layer) {\n            if (layer == olLayer) {\n                foundId = layer.hasOwnProperty(\"gpLayerId\") ? layer.gpLayerId : null;\n            }\n        },\n        this);\n\n    // TODO : recuperer \"GPlayerSwitcher_ID\" depuis une constante\n    return foundId !== null ? this._addUID(\"GPlayerSwitcher_ID_\" + foundId) : null;\n};\n\n/**\n * Check if map view is out of layer range (in terms of extent and zoom)\n *\n * @method isInRange\n * @param {Object} layer - the ol.layer object\n * @param {Object} map   - the ol.Map object\n * @returns {Boolean} outOfRange - false if map view is out of layer range\n */\nLayerSwitcher.prototype.isInRange = function(layer, map) {\n    if (!map) {\n        return;\n    }\n    // check if map zoom is in layer zoom range\n    var mapResolution = map.getView().getResolution();\n    if (mapResolution > layer.getMaxResolution() || mapResolution < layer.getMinResolution()) {\n        return false;\n    }\n\n    // check if map extent intersects layer extent (if defined)\n    var mapExtent = map.getView().calculateExtent(map.getSize());\n    var layerExtent = layer.getExtent();\n    if (layerExtent && !ol.extent.intersects(mapExtent, layerExtent)) {\n        return false;\n    }\n\n    return true;\n};\n\n/**\n * Get layer informations : title, description, quicklookurl, legends, metadata\n *\n * @method getLayerInfo\n * @param {Object} layer - the ol.layer object\n * @returns {Object} layerInfo - layer informations\n */\nLayerSwitcher.prototype.getLayerInfo = function(layer) {\n    var layerInfo = {};\n    if (layer.getSource !== undefined) {\n        var src = layer.getSource();\n        layerInfo._title = src._title || \"\";\n        layerInfo._description = src._description || \"\";\n        layerInfo._quicklookUrl = src._quicklookUrl || \"\";\n        layerInfo._metadata = src._metadata || [];\n        layerInfo._legends = src._legends || [];\n    }\n    return layerInfo;\n};\n\nexport default LayerSwitcher;\n\n\n\n// WEBPACK FOOTER //\n// ./src/OpenLayers/Controls/LayerSwitcher.js","import ol from \"ol\";\nimport Logger from \"../../../Common/Utils/LoggerByDefault\";\nimport Interactions from \"../Utils/Interactions\";\n\n// Derived from OpenLayers measure example\n// http://openlayers.org/en/latest/examples/measure.html\n\n\nvar logger = Logger.getLogger(\"measures\");\n\n/**\n * Measures Tools :\n * - length\n * - aera\n * - azimut\n */\nvar Measures = {\n\n    // ****************************************************************** //\n    // > Default Styles\n    // ****************************************************************** //\n\n    /*\n     * Pointer\n     */\n    DEFAULT_POINTER_STYLE: new ol.style.Circle({\n        radius: 5,\n        stroke: new ol.style.Stroke({\n            color: \"#002A50\",\n            width: 2\n        }),\n        fill: new ol.style.Fill({\n            color: \"rgba(255, 155, 0, 0.7)\"\n        })\n    }),\n\n    /*\n     * Measures style line\n     */\n    DEFAULT_DRAW_START_STYLE: new ol.style.Style({\n        fill: new ol.style.Fill({\n            color: \"rgba(0, 183, 152, 0.2)\"\n        }),\n        stroke: new ol.style.Stroke({\n            color: \"#002A50\",\n            lineDash: [10, 10],\n            width: 2\n        })\n    }),\n\n    /*\n     * Measures final style line\n     */\n    DEFAULT_DRAW_FINISH_STYLE: new ol.style.Style({\n        fill: new ol.style.Fill({\n            color: \"rgba(0, 183, 152, 0.3)\"\n        }),\n        stroke: new ol.style.Stroke({\n            color: \"#002A50\",\n            width: 3\n        })\n    }),\n\n    // ****************************************************************** //\n    // > ToolBox : these tools work together\n    // ****************************************************************** //\n    tools: {\n        MeasureLength: {\n            active: false,\n            instance: null\n        },\n        MeasureArea: {\n            active: false,\n            instance: null\n        },\n        MeasureAzimuth: {\n            active: false,\n            instance: null\n        }\n    },\n\n    // ****************************************************************** //\n    // > Variables\n    // ****************************************************************** //\n\n    /**\n     * Global measure draw interaction\n     * @type {ol.interaction.Draw}\n     */\n    measureDraw: null,\n\n    /**\n     * Global vector source for measure\n     * @type {ol.source.Vector}\n     */\n    measureSource: null,\n\n    /**\n     * Global vector layer for measure\n     * @type {ol.layer.Vector}\n     */\n    measureVector: null,\n\n    /**\n     * Currently drawn feature.\n     * @type {ol.Feature}\n     */\n    sketch: null,\n\n    /**\n     * The measure tooltip element.\n     * @type {Element}\n     */\n    measureTooltipElement: null,\n\n    /**\n     * Overlay to show the measurement.\n     * @type {ol.Overlay}\n     */\n    measureTooltip: null,\n\n    /**\n     * TODO The help tooltip element.\n     * @type {Element}\n     */\n    helpTooltipElement: null,\n\n    /**\n     * TODO Overlay to show the help.\n     * @type {ol.Overlay}\n     */\n    helpTooltip: null,\n\n    // ****************************************************************** //\n    // > Methods Public\n    // ****************************************************************** //\n\n    /** Desactived Tool Measure */\n    clean: function() {\n        var _class = this.CLASSNAME;\n\n        logger.trace(\"[\" + _class + \"] deactived tool !\");\n        // sur la desactivation de l'outil de mesure\n        // on fait un nettoyage des ressources\n        // ainsi que le DOM\n        this.clearMeasure();\n        this.clearMeasureToolTip();\n        this.removeMeasureEvents();\n        this._showContainer.checked = false;\n\n    },\n\n    // ****************************************************************** //\n    // > Methods Events\n    // ****************************************************************** //\n\n    /**\n     * Handle pointer move.\n     *\n     * @param {ol.MapBrowserEvent} e - The event.\n     */\n    onPointerMoveHandler: function(e) {\n\n        if (e.dragging) {\n            return;\n        }\n\n        /** @type {ol.Coordinate|undefined} */\n        var tooltipCoord = e.coordinate;\n\n        if (this.sketch) {\n            var output;\n            var geom = (this.sketch.getGeometry());\n            output = this.format((geom));\n            if (geom.getType() === \"LineString\") {\n                tooltipCoord = geom.getLastCoordinate();\n            } else if (geom.getType() === \"Polygon\") {\n                tooltipCoord = geom.getInteriorPoint().getCoordinates();\n            } else {\n                return;\n            }\n            this.measureTooltipElement.innerHTML = output;\n            this.measureTooltip.setPosition(tooltipCoord);\n        }\n    },\n\n    /**\n     * Main program !\n     * This method is called by event 'click' on control picto\n     *\n     * @param {Object} e - HTMLElement\n     * @param {String} type - LineString or Polygon\n     * @private\n     */\n    onShowMeasureClick: function(e, type) {\n\n        // desactivation des controles de mesures\n        var self = this.CLASSNAME; // this.constructor.name : pas possible en mode minifi/manglifi !\n        for (var className in this.tools) {\n            if (this.tools.hasOwnProperty(className)) {\n                var o = this.tools[className];\n                if (o.active && className !== self) {\n                    o.active = false;\n                    if (o.instance !== null) { // au cas o le controle a t supprim !\n                        o.instance.clean();\n                    }\n                }\n            }\n        }\n\n        // desactivation des autres interactions parasites\n        var map = this.getMap();\n        Interactions.unset(map, {\n            current: \"Measures\"\n        });\n\n        if (!this._showContainer.checked) {\n\n            this.addMeasureEvents();\n            this.initMeasureInteraction();\n            this.addMeasureInteraction(type);\n            this.tools[self].active = true;\n\n        } else {\n\n            this.clearMeasure();\n            this.clearMeasureToolTip();\n            this.removeMeasureEvents();\n            this.tools[self].active = false;\n        }\n    },\n\n    // ****************************************************************** //\n    // > Methods not Public\n    // ****************************************************************** //\n\n    /**\n     * Clear all dom tooltip of length, area or azimut object.\n     */\n    clearMeasureToolTip: function() {\n\n        var map = this.getMap();\n        if (!map) {\n            return;\n        }\n\n        var mapContainer = map.getTargetElement();\n        // au cas o il y'aurait plusieurs container de carte !\n        var overlays = mapContainer.getElementsByClassName(\"ol-overlaycontainer-stopevent\");\n        for (var k = 0; k < overlays.length; k++) {\n            var nodes = overlays[k];\n            var len = nodes.children.length;\n            var nodesToRemove = [];\n            for (var i = 0; i < len; i++) {\n                var node = nodes.children[i];\n                if (node.children.length !== 0) {\n                    var child = node.children[0];\n                    if (child.className === \"GPmeasureTooltip GPmeasureTooltip-static\" ||\n                        child.className === \"GPmeasureTooltip GPmeasureTooltip-measure\") {\n                        nodesToRemove.push(node);\n                    }\n                }\n\n            }\n            for (var j = 0; j < nodesToRemove.length; j++) {\n                nodes.removeChild(nodesToRemove[j]);\n            }\n        }\n    },\n\n    /**\n     * Clear all length, area or azimut object.\n     */\n    clearMeasure: function() {\n\n        var map = this.getMap();\n\n        // FIXME !?\n        // if (this.measureTooltip) {\n        //     map.removeOverlay(this.measureTooltip);\n        //     this.measureTooltip = null;\n        // }\n\n        if (this.measureVector) {\n            map.removeLayer(this.measureVector);\n            this.measureVector = null;\n        }\n\n        if (this.measureDraw) {\n            map.removeInteraction(this.measureDraw);\n            this.measureDraw = null;\n        }\n    },\n\n    /**\n     * Creates a new measure tooltip\n     * FIXME bug d'affichage de la tooltip de saisie en cours si on ne termine pas\n     * la saisie  !?\n     *\n     * @param {ol.Map} map - The Map.\n     */\n    createMeasureTooltip: function(map) {\n        if (this.measureTooltipElement) {\n            this.measureTooltipElement.parentNode.removeChild(this.measureTooltipElement);\n        }\n\n        this.measureTooltipElement = document.createElement(\"div\");\n        this.measureTooltipElement.className = \"GPmeasureTooltip GPmeasureTooltip-measure\";\n\n        this.measureTooltip = new ol.Overlay({\n            element: this.measureTooltipElement,\n            offset: [0, -15],\n            positioning: \"bottom-center\"\n        });\n\n        map.addOverlay(this.measureTooltip);\n    },\n\n    /**\n     * TODO evolution\n     * Creates a new help tooltip\n     *\n     * @param {ol.Map} map - The Map.\n     */\n    createHelpTooltip: function(map) {\n\n        if (this.helpTooltipElement) {\n            this.helpTooltipElement.parentNode.removeChild(this.helpTooltipElement);\n        }\n\n        this.helpTooltipElement = document.createElement(\"div\");\n        this.helpTooltipElement.className = \"tooltip hidden\";\n\n        this.helpTooltip = new ol.Overlay({\n            element: this.helpTooltipElement,\n            offset: [15, 0],\n            positioning: \"center-left\"\n        });\n\n        map.addOverlay(this.helpTooltip);\n    },\n\n    /**\n     * Creates a style for drawing\n     *\n     * @param {Object} styles - styles.\n     */\n    createStylingMeasureInteraction: function(styles) {\n\n        this.options.styles = styles || {};\n\n        // style de depart\n        logger.trace(\"style start\", this.options.styles.start);\n\n        // Creation  partir des styles par dfaut\n        var startStyleOpts = {\n            image: Measures.DEFAULT_POINTER_STYLE,\n            fill: Measures.DEFAULT_DRAW_START_STYLE.getFill(),\n            stroke: Measures.DEFAULT_DRAW_START_STYLE.getStroke()\n        };\n        // ecrasement  partir des proprits renseignes\n        if (this.options.styles.hasOwnProperty(\"pointer\") && this.options.styles.pointer instanceof ol.style.Image) {\n            startStyleOpts.image = this.options.styles.pointer;\n        }\n        if (this.options.styles.hasOwnProperty(\"start\") && this.options.styles.start instanceof ol.style.Style) {\n            if (this.options.styles.start.getFill() != null) {\n                startStyleOpts.fill = this.options.styles.start.getFill();\n            }\n            if (this.options.styles.start.getStroke() != null) {\n                startStyleOpts.stroke = this.options.styles.start.getStroke();\n            }\n        }\n\n        this.options.styles.start = new ol.style.Style(startStyleOpts);\n\n        // style de fin\n        logger.trace(\"style finish\", this.options.styles.finish);\n\n        var finishStyleOpts = {\n            fill: Measures.DEFAULT_DRAW_FINISH_STYLE.getFill(),\n            stroke: Measures.DEFAULT_DRAW_FINISH_STYLE.getStroke()\n        };\n        // ecrasement  partir des proprits renseignes\n        if (this.options.styles.hasOwnProperty(\"finish\") && this.options.styles.finish instanceof ol.style.Style) {\n            if (this.options.styles.finish.getFill() != null) {\n                finishStyleOpts.fill = this.options.styles.finish.getFill();\n            }\n            if (this.options.styles.finish.getStroke() != null) {\n                finishStyleOpts.stroke = this.options.styles.finish.getStroke();\n            }\n        }\n\n        this.options.styles.finish = new ol.style.Style(finishStyleOpts);\n\n    },\n\n    /**\n     * Add the measure interaction\n     *\n     * @param {String} type - LineString or Polygon.\n     */\n    addMeasureInteraction: function(type) {\n\n        var map = this.getMap();\n\n        // Creates and adds the interaction\n        var self = this;\n        this.measureDraw = new ol.interaction.Draw({\n            source: this.measureSource,\n            /** condition : permet de gerer la suppression des derniers points saisis */\n            condition: function(event) {\n                if (event.originalEvent.ctrlKey) {\n                    if (self.sketch) {\n                        this.removeLastPoint();\n                    }\n                    return false;\n                }\n                return true;\n            },\n            type: type,\n            style: this.options.styles.start || Measures.DEFAULT_DRAW_START_STYLE\n        });\n        this.measureDraw.setProperties({\n            name: \"Measures\",\n            source: this\n        });\n        map.addInteraction(this.measureDraw);\n\n        // Create tooltips\n        this.createMeasureTooltip(map);\n\n        // Event start measuring\n        this.measureDraw.on(\"drawstart\", function(evt) {\n            // set sketch\n            self.sketch = evt.feature;\n        }, this);\n\n        // Event end measuring\n        this.measureDraw.on(\"drawend\", function() {\n\n            // FIXME MaJ de la tooltip en mode mobile !\n            if (self.sketch) {\n                var output;\n                var tooltipCoord;\n                var geom = (self.sketch.getGeometry());\n                output = self.format((geom));\n                if (geom.getType() === \"LineString\") {\n                    tooltipCoord = geom.getLastCoordinate();\n                } else if (geom.getType() === \"Polygon\") {\n                    tooltipCoord = geom.getInteriorPoint().getCoordinates();\n                } else {\n                    return;\n                }\n                self.measureTooltipElement.innerHTML = output;\n                self.measureTooltip.setPosition(tooltipCoord);\n            }\n\n            self.measureTooltipElement.className = \"GPmeasureTooltip GPmeasureTooltip-static\";\n            self.measureTooltip.setOffset([0, -7]);\n\n            // unset sketch\n            self.sketch = null;\n            // unset tooltip so that a new one can be created\n            self.measureTooltipElement = null;\n            self.createMeasureTooltip(map);\n\n        }, this);\n    },\n\n    /**\n     * Init the measure interaction\n     */\n    initMeasureInteraction: function() {\n\n        var map = this.getMap();\n\n        this.measureSource = new ol.source.Vector();\n\n        this.measureVector = new ol.layer.Vector({\n            source: this.measureSource,\n            style: this.options.styles.finish || Measures.DEFAULT_DRAW_FINISH_STYLE\n        });\n\n        // on rajoute le champ gpResultLayerId permettant d'identifier une couche cre par le composant.\n        this.measureVector.gpResultLayerId = \"measure\";\n\n        map.addLayer(this.measureVector);\n    }\n};\n\nexport default Measures;\n\n\n\n// WEBPACK FOOTER //\n// ./src/OpenLayers/Controls/Measures/Measures.js","import ol from \"ol\";\nimport Logger from \"../../Common/Utils/LoggerByDefault\";\nimport Utils from \"../../Common/Utils\";\nimport ID from \"../../Common/Utils/SelectorID\";\nimport MeasureToolBoxDOM from \"../../Common/Controls/MeasureToolBoxDOM\";\n\n\nvar logger = Logger.getLogger(\"toolbox\");\n\nvar MeasureToolBox = {\n\n    /**\n     * liste des uid/map (pour chaque toolbox)\n     * { map : uid }\n     * Ex. { \"map1\" : 465456456486845 }\n     */\n    _toolbox: {},\n\n    /**\n     * Ajout d'un controle dans la ToolBox.\n     * Creation de la toolbox si besoin...\n     *\n     * @param {ol.Map} map - map\n     * @param {ol.control.Control} ctrl - objet  ajouter\n     */\n    add: function(map, ctrl) {\n        logger.trace(\"ToolBox.add()\", ctrl);\n\n        if (!map) {\n            logger.trace(\"map doesn't exist !?\");\n            return;\n        }\n\n        var mapContainer = map.getTargetElement();\n        var mapDocument = mapContainer.ownerDocument;\n        var mapId = mapContainer.id;\n\n        if (!this._toolbox || Object.keys(this._toolbox).length === 0) {\n            this._toolbox[mapId] = ID.generate();\n        } else {\n            if (!this._toolbox[mapId]) {\n                this._toolbox[mapId] = ID.generate();\n            }\n        }\n\n        var uid = this._toolbox[mapId];\n        if (!mapDocument.getElementById(this.getToolBoxID(uid))) {\n            logger.trace(\"create toolbox !\");\n            // creation et ajout de la toolbox sur la map\n            var toolboxContainer = this._createToolBoxContainerElement(uid);\n            var overlaysContainer = mapContainer.getElementsByClassName(\"ol-overlaycontainer-stopevent\");\n            overlaysContainer[0].appendChild(toolboxContainer);\n            // mapContainer.appendChild(toolboxContainer);\n        }\n\n        // ajout du widget dans la toolbox\n        var widgetContainer = mapDocument.getElementById(this.getWidgetID(uid));\n        ctrl.setTarget(widgetContainer);\n        logger.trace(\"add control to toolbox !\");\n\n    }\n};\n\nUtils.assign(MeasureToolBox, MeasureToolBoxDOM);\n\nexport default MeasureToolBox;\n\n\n\n// WEBPACK FOOTER //\n// ./src/OpenLayers/Controls/MeasureToolBox.js","module.exports = __WEBPACK_EXTERNAL_MODULE_15__;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external {\"commonjs2\":\"xmldom\",\"commonjs\":\"xmldom\",\"amd\":\"require\"}\n// module id = 15\n// module chunks = 0","import Logger from \"../../Common/Utils/LoggerByDefault\";\n\nvar ProxyUtils = {\n    /**\n     * Ajoute un proxy aux url des couches vecteurs si besoin.\n     *\n     * @param {String} url - Url to proxify.\n     * @param {Object} [proxyOptions] - Object defining proxy options.\n     * @param {String} proxyOptions.proxyUrl - Proxy URL.\n     * @param {Array.<String>} [proxyOptions.noProxyDomains] - Proxy will not be used for this list of domain names.\n     */\n    proxifyUrl: function(url, proxyOptions) {\n\n        // logger\n\n        var logger = Logger.getLogger(\"proxifyUrl\");\n\n        if (!proxyOptions ||\n            !proxyOptions.hasOwnProperty(\"proxyUrl\") ||\n            proxyOptions.proxyUrl === null ||\n            proxyOptions.proxyUrl.trim().length == 0) {\n            return url;\n        }\n        // on regarde si l'url nest pas dans les domaines sans proxy\n        if (proxyOptions.noProxyDomains &&\n            Array.isArray(proxyOptions.noProxyDomains) &&\n            proxyOptions.noProxyDomains.length > 0) {\n            for (var i in proxyOptions.noProxyDomains) {\n                logger.trace(\"[ProxyUtils] proxifyUrl : analyzing \" + proxyOptions.noProxyDomains[i]);\n                if (url.indexOf(proxyOptions.noProxyDomains[i]) !== -1) {\n                    logger.info(\"[ProxyUtils] proxifyUrl : \" + url + \" found in noProxyDomains list (\" + proxyOptions.noProxyDomains[i] + \").\");\n                    return url;\n                }\n            }\n        }\n        return proxyOptions.proxyUrl + encodeURIComponent(url);\n    }\n};\n\nexport default ProxyUtils;\n\n\n\n// WEBPACK FOOTER //\n// ./src/Common/Utils/ProxyUtils.js","import ol from \"ol\";\nimport Gp from \"gp\";\nimport Logger from \"../Common/Utils/LoggerByDefault\";\nimport ProxyUtils from \"../Common/Utils/ProxyUtils\";\n// import $__xmldom from \"xmldom\";\n\n\nvar logger = Logger.getLogger(\"GfiUtils\");\n\nvar GfiUtils = {\n\n    /**\n     * Return layer format\n     *\n     * @param {ol.layer.Layer} l - layer openlayers\n     *\n     * @return {String} format - layer format can be wms, wmts, vector or unknown\n     *\n     */\n    getLayerFormat: function(l) {\n        var source = l.getSource();\n        if (source instanceof ol.source.TileWMS || source instanceof ol.source.ImageWMS) {\n            return \"wms\";\n        }\n        if (source instanceof ol.source.WMTS) {\n            return \"wmts\";\n        }\n        if (source instanceof ol.source.Vector) {\n            return \"vector\";\n        }\n        return \"unknown\";\n    },\n\n    /**\n     * Info Popup creation and display\n     *\n     * @param {ol.Map} map - map openlayers\n     * @param {ol.Coordinate} coords - coordinates where to anchor popup.\n     * @param {String} content - content to display\n     * @param {String} [contentType='text/html'] - content mime-type\n     * @param {Object} autoPanOptions - Auto-pan pop-up options\n     * @param {Boolean} [autoPanOptions.autoPan] - Specifies whether the map should auto-pan if the pop-up is rendered outside of the canvas\n     * @param {olx.OverlayPanOptions} [autoPanOptions.autoPanAnimation] - Used to customize the auto-pan animation. See {@link https://openlayers.org/en/latest/apidoc/olx.html#.OverlayPanOptions olx.OverlayPanOptions}.\n     * @param {Number} [autoPanOptions.autoPanMargin] - Margin (in pixels) between the pop-up and the border of the map when autopanning. Default is 20.\n     * @return {Boolean} displayed - indicates if something has been displayed\n     */\n    displayInfo: function(map, coords, content, contentType, autoPanOptions) {\n        logger.trace(\"[GfiUtils] : displayInfo...\");\n\n        if (!contentType) {\n            contentType = \"text/html\";\n        }\n\n        if (content === null) {\n            return;\n        }\n\n        var _htmlDoc = null;\n        var _parser = null;\n\n        var _content = content;\n        _content = _content.replace(/\\n/g, \"\");\n        _content = _content.replace(/(>)\\s*(<)/g, \"$1$2\");\n\n        var scope = typeof window !== \"undefined\" ? window : null;\n\n        if (typeof exports === \"object\" && window === null) {\n            // code for nodejs\n            var DOMParser = require(\"xmldom\").DOMParser;\n            _parser = new DOMParser();\n            _htmlDoc = _parser.parseFromString(_content, contentType);\n        } else if (scope.DOMParser) {\n            // code for modern browsers\n            _parser = new scope.DOMParser();\n            _htmlDoc = _parser.parseFromString(_content, contentType);\n        } else if (scope.ActiveXObject) {\n            // code for old IE browsers\n            _htmlDoc = new scope.ActiveXObject(\"Microsoft.XMLDOM\");\n            _htmlDoc.async = false;\n            _htmlDoc.loadXML(_content);\n        } else {\n            console.log(\"Incompatible environment for DOM Parser !\");\n            return false;\n        }\n\n        var body = _htmlDoc.getElementsByTagName(\"body\");\n        if (body && body.length === 1) {\n            if (!body[0].hasChildNodes()) {\n                return false;\n            }\n        }\n\n        // Affichage des features.\n        var element = document.createElement(\"div\");\n        element.className = \"gp-feature-info-div\";\n\n        var closer = document.createElement(\"input\");\n        closer.type = \"button\";\n        closer.className = \"gp-styling-button closer\";\n\n        /**\n         * fait disparatre la popup au clic sur x\n         */\n        closer.onclick = function() {\n            if (map.featuresOverlay) {\n                map.removeOverlay(map.featuresOverlay);\n                map.featuresOverlay = null;\n            }\n            return false;\n        };\n\n        var contentDiv = document.createElement(\"div\");\n        contentDiv.className = \"gp-features-content-div\";\n        contentDiv.innerHTML = content;\n        /*\n        if (content instanceof HTMLElement) {\n            this.logger.trace(\"[OL3] : _displayInfo : pure HTMLElement\") ;\n            contentDiv.appendChild(content) ;\n        } else {\n            var parser = new DOMParser() ;\n            var doc = null ;\n            try {\n                doc = parser.parseFromString(content,contentType) ;\n                this.logger.trace(\"[OL3] : _displayInfo : HTMLElement from parser\") ;\n                // FIXME : avec cette methode, on a une balise html + body qui s'insre...\n                contentDiv.appendChild(doc.documentElement) ;\n            } catch (e) {\n                console.log(e) ;\n                this.logger.trace(\"[OL3] : _displayInfo : parsing content failed (not HTML)\") ;\n                // en cas d'erreur : on se contente de recopier le contenu.\n                contentDiv.innerHTML = content ;\n            }\n        }\n        */\n        element.appendChild(contentDiv);\n        element.appendChild(closer);\n\n        if (map.featuresOverlay) {\n            // fermeture d'une ventuelle popup dj ouverte.\n            map.removeOverlay(map.featuresOverlay);\n            map.featuresOverlay = null;\n        }\n        map.featuresOverlay = new ol.Overlay({\n            // id : id,\n            element: element,\n            autoPan: autoPanOptions.autoPan,\n            autoPanAnimation: autoPanOptions.autoPanAnimation,\n            autoPanMargin: autoPanOptions.autoPanMargin,\n            positioning: \"bottom-center\",\n            insertFirst: false, // popup appears on top of other overlays if any\n            stopEvent: true\n        });\n        map.addOverlay(map.featuresOverlay);\n        map.featuresOverlay.setPosition(coords);\n        map.featuresOverlay.render();\n\n        return true;\n    },\n\n    /**\n     * Gets HTML content from features array\n     *\n     * @param {ol.Map} map - map openlayers\n     * @param {Array.<ol.Features>} features - ol3 features Array\n     * @returns {HTMLElement} HTML content.\n     */\n    features2html: function(map, features) {\n        var content = document.createElement(\"div\");\n        features.forEach(function(f) {\n            var props = f.getProperties();\n            if (props.hasOwnProperty(\"name\")) {\n                var nameDiv = document.createElement(\"div\");\n                nameDiv.className = \"gp-att-name-div\";\n                // nameDiv.appendChild(document.createTextNode(props[\"name\"])) ;\n                nameDiv.insertAdjacentHTML(\"afterbegin\", props[\"name\"]);\n                content.appendChild(nameDiv);\n            }\n            if (props.hasOwnProperty(\"description\")) {\n                var descDiv = document.createElement(\"div\");\n                descDiv.className = \"gp-att-description-div\";\n                // descDiv.appendChild(document.createTextNode(props[\"description\"])) ;\n                descDiv.insertAdjacentHTML(\"afterbegin\", props[\"description\"]);\n                content.appendChild(descDiv);\n            }\n            var p = null;\n            var others = false;\n            var oDiv = null;\n            var ul = null;\n            var li = null;\n            for (p in props) {\n                if (p == \"geometry\" || p == \"value\" || p == \"name\" || p == \"description\" || p == \"styleUrl\") {\n                    continue;\n                }\n                // FIXME La lecture des extensions GPX n'est pas gre !\n                if (p == \"extensionsNode_\" && props[p] === undefined) {\n                    continue;\n                }\n                if (!others) {\n                    oDiv = document.createElement(\"div\");\n                    oDiv.className = \"gp-att-others-div\";\n                    ul = document.createElement(\"ul\");\n                    others = true;\n                }\n                li = document.createElement(\"li\");\n                var span = document.createElement(\"span\");\n                span.className = \"gp-attname-others-span\";\n                span.appendChild(document.createTextNode(p + \" : \"));\n                li.appendChild(span);\n                li.appendChild(document.createTextNode(props[p]));\n                ul.appendChild(li);\n            }\n            if (ul) {\n                oDiv.appendChild(ul);\n                content.appendChild(oDiv);\n            }\n        }, map);\n\n        // pas de contenu !\n        if (!content.hasChildNodes()) {\n            content = null;\n        }\n\n        return content;\n    },\n\n    /**\n     * Indicates if there is a feature at the given coordinates for the given layer\n     *\n     * @param {ol.Map} map - map openlayers\n     * @param {ol.layer.Layer} olLayer - vector layer openlayers\n     * @param {ol.Coordinate} olCoordinate - coordinates pointed by user\n     * @return {Boolean}\n     *\n     */\n    layerGetFeatureAtCoordinates: function(map, olLayer, olCoordinate) {\n        var pixel = map.getPixelFromCoordinate(olCoordinate);\n        return map.hasFeatureAtPixel(pixel, function(layer) {\n            if (layer === olLayer) {\n                return true;\n            }\n            return false;\n        });\n    },\n\n    /**\n     * Get information from all the features located at the specified coordinates\n     * and belonging to the layers list argument. Those information are gathered\n     * and displayed in an info popup.\n     *\n     * @param {ol.Map} map - map openlayers\n     * @param {ol.Coordinate} olCoordinate - coordinates pointed by user\n     * @param {Array.<ol.layer.Layer>} olLayers - layers requested\n     *\n     */\n    displayVectorFeatureInfo: function(map, olCoordinate, olLayers, autoPanOptions) {\n        var pixel = map.getPixelFromCoordinate(olCoordinate);\n\n        // couches vecteur : on remplit un tableau avec les features  proximit.\n        var features = [];\n        map.forEachFeatureAtPixel(pixel, function(feature, layer) {\n            if (!olLayers || olLayers.indexOf(layer) > -1) {\n                features.push(feature);\n            }\n        });\n        if (features.length == 0) {\n            // no features\n            return false;\n        }\n        var content = this.features2html(map, features);\n        // pas de contenu !\n        if (content === null) {\n            return false;\n        }\n        // Affichage des features.\n        this.displayInfo(map, olCoordinate, content.innerHTML, \"text/html\", autoPanOptions);\n        // this._displayInfo(evt.coordinate,content,\"text/html\") ;\n        return true;\n    },\n\n    /**\n     * Method to manage the request of information from a list of layers already added to the map.\n     * Among the given list of layers only the visible ones are requested.\n     * The priority is given to the upper layer having a feature at the pointed coordinates.\n     * If the first (upper) feature encountered is from a vector layer the info popup will\n     * display the information of the features from all visible vector layers and located at\n     * the specified coordinates.\n     *\n     * @param {ol.Map} map - map openlayers\n     * @param {ol.Coordinate} olCoordinate - coordinates pointed by user\n     * @param {Array.<Object>} gfiLayers - list of layers which can be requested through the control. Each array element is an object, with following properties :\n     * @param {ol.layer.Layer} gfiLayers.obj - ol.layer.Layer layer handled by the control (that has been added to map).\n     * @param {String} [gfiLayers.event] - name of the mouse event triggering getFeatureInfo on this layer (that has been added to map). allowed values are : 'singleclick', 'dblclick' and 'contextmenu'\n     * @param {String} [gfiLayers.infoFormat] - indicates the format mime-type of the response of GetFeatureInfo requests.\n     * @param {Object} [proxyOptions] - options for poxy configuration :\n     * @param {String} [proxyOptions.proxyUrl] - Proxy URL to avoid cross-domain problems, if not already set in mapOptions. Mandatory to import WMS and WMTS layer.\n     * @param {Array.<String>} [proxyOptions.noProxyDomains] - Proxy will not be used for this list of domain names. Only use if you know what you're doing (if not already set in mapOptions).\n     * @param {Object} [autoPanOptions] - Auto-pan pop-up options\n     * @param {Boolean} [autoPanOptions.autoPan = true] - Specifies whether the map should auto-pan if the pop-up is rendered outside of the canvas. Defaults to true.\n     * @param {olx.OverlayPanOptions} [autoPanOptions.autoPanAnimation] - Used to customize the auto-pan animation. See {@link https://openlayers.org/en/latest/apidoc/olx.html#.OverlayPanOptions olx.OverlayPanOptions}.\n     * @param {Number} [autoPanOptions.autoPanMargin] - Margin (in pixels) between the pop-up and the border of the map when autopanning. Default is 20.\n     *\n     */\n    displayFeatureInfo: function(map, olCoordinate, gfiLayers, proxyOptions, autoPanOptions) {\n        // Layers orders\n        var layersOrdered = {};\n        for (var j = 0; j < gfiLayers.length; j++) {\n            var layer = gfiLayers[j];\n            var position = layer.obj.getZIndex();\n            if (!layersOrdered[position]) {\n                layersOrdered[position] = [];\n            }\n            layersOrdered[position].push(layer);\n        }\n\n        // affichage de la premire popup d'informations en partant du dessus...\n        var requests = [];\n        // inversion de l'ordre des layers\n        var positions = Object.keys(layersOrdered);\n        positions.sort(function(a, b) {\n            return b - a;\n        });\n\n        // si la 1ere couche affichable est de type vecteur on affiche les infos de toutes\n        // les couches vecteur qui suivent. Par consequent, une seule requete vecteur suffit\n        // (celle correspondant au premier objet vecteur rencontre)\n        var foundFeature = false;\n\n        for (var k = 0; k < positions.length; k++) {\n            var p = positions[k];\n            for (var h = 0; h < layersOrdered[p].length; ++h) {\n                var l = layersOrdered[p][h].obj;\n                var infoFormat = layersOrdered[p][h].infoFormat || \"text/html\";\n                var minMaxResolutionOk = true;\n                if (l.minResolution &&\n                    l.minResolution > map.getResolution()) {\n                    minMaxResolutionOk = false;\n                }\n                if (minMaxResolutionOk &&\n                    l.maxResolution &&\n                    l.maxResolution < map.getResolution()) {\n                    minMaxResolutionOk = false;\n                }\n\n                if (l.getVisible() && minMaxResolutionOk) {\n                    var format = this.getLayerFormat(l);\n                    if (format == \"vector\") {\n                        if (!foundFeature && this.layerGetFeatureAtCoordinates(map, l, olCoordinate)) {\n                            requests.push({\n                                format: format,\n                                scope: this,\n                                coordinate: olCoordinate\n                            });\n                        }\n                        continue;\n                    } else if (format != \"wms\" && format != \"wmts\") {\n                        console.log(\"[ERROR] DisplayFeatureInfo - layer format '\" + format + \"' not allowed\");\n                        continue;\n                    }\n\n                    var _res = map.getView().getResolution();\n                    var _url = null;\n                    if (format == \"wmts\") {\n                        _url = l.getSource().getGetFeatureInfoUrl(\n                            olCoordinate,\n                            _res,\n                            map.getView().getProjection(), {\n                                INFOFORMAT: infoFormat\n                            }\n                        );\n                    } else {\n                        _url = l.getSource().getGetFeatureInfoUrl(\n                            olCoordinate,\n                            _res,\n                            map.getView().getProjection(), {\n                                INFO_FORMAT: infoFormat\n                            }\n                        );\n                    }\n\n                    requests.push({\n                        // id : _id,\n                        format: infoFormat,\n                        url: ProxyUtils.proxifyUrl(_url, proxyOptions),\n                        scope: this,\n                        coordinate: olCoordinate\n                    });\n                }\n            }\n        }\n\n        // on recupere les couches vecteur ordonnees (a utiliser dans le cas de l'affichage de donnees vecteur)\n        var vectorLayersOrdered = null;\n\n        /** call request sync */\n        function requestsSync(list, iterator, callback) {\n            if (list.length === 0) {\n                return;\n            }\n            var nextItemIndex = 0;\n            /** function report next request */\n            function report(displayed) {\n                nextItemIndex++;\n                if (displayed || nextItemIndex === list.length) {\n                    callback();\n                } else {\n                    iterator(list[nextItemIndex], report);\n                }\n            }\n            // instead of starting all the iterations, we only start the 1st one\n            iterator(list[0], report);\n        };\n\n        var context = this;\n\n        requestsSync(requests,\n            function(data, report) {\n                if (data.format == \"vector\") {\n                    if (!vectorLayersOrdered) {\n                        vectorLayersOrdered = [];\n                        for (var m = 0; m < positions.length; m++) {\n                            var p = positions[m];\n                            for (var n = 0; n < layersOrdered[p].length; ++n) {\n                                vectorLayersOrdered.push(layersOrdered[p][n].obj);\n                            }\n                        }\n                    }\n                    report(data.scope.displayVectorFeatureInfo(map, data.coordinate, vectorLayersOrdered, autoPanOptions));\n                } else {\n                    // var self = data.scope;\n                    Gp.Protocols.XHR.call({\n                        url: data.url,\n                        method: \"GET\",\n                        scope: data.scope,\n                        /** Handles GFI response */\n                        onResponse: function(resp) {\n                            var exception = false;\n\n                            // a t on une exception ?\n                            if (resp.trim().length === 0 ||\n                                resp.indexOf(\"java.lang.NullPointerException\") !== -1 ||\n                                resp.indexOf(\"not queryable\") !== -1) {\n                                // rien  afficher\n                                exception = true;\n                            }\n\n                            // on affiche la popup GFI !\n                            var displayed = !exception && context.displayInfo(map, data.coordinate, resp, \"text/html\", autoPanOptions);\n                            // on reporte sur la prochaine requte...\n                            report(displayed);\n                        },\n                        /** Handles GFI response error */\n                        onFailure: function(error) {\n                            console.log(error);\n                            report(false);\n                        }\n                    });\n                }\n            },\n            function() {\n                logger.trace(\"Finish sync to GFI !\");\n            }\n        );\n    },\n\n    /**\n     * Function returning the clicked position of an event\n     */\n    getPosition: function(e, map) {\n\n        if (e.coordinate) {\n            return e.coordinate;\n        }\n\n        var pixel = [0, 0];\n\n        if (e.offsetX || e.offsetY) {\n            pixel[0] = e.offsetX; // + document.body.scrollLeft + document.documentElement.scrollLeft;\n            pixel[1] = e.offsetY; // + document.body.scrollTop + document.documentElement.scrollTop;\n        } else if (e.pointerType === \"touch\") {\n\n            // a implementer !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!\n\n            // Safari iOS / iPhone en mode Touch (cf. hammer)\n            var p = e.pointers[0];\n            pixel[0] = p.pageX;\n            pixel[1] = p.pageY;\n        }\n\n        var coordinate = map.getCoordinateFromPixel(pixel);\n        return coordinate;\n    },\n\n    /**\n     * onDisplayFeatureInfo\n     */\n    onDisplayFeatureInfo: function(e, gfiObj) {\n        if (!gfiObj.isActive()) {\n            return;\n        }\n\n        logger.trace(e);\n\n        var map = gfiObj.getMap();\n\n        if (e.type == \"contextmenu\" || e.type == \"dblclick\") {\n            e.preventDefault();\n        } else if (e.type == \"singleclick\") {\n            var interactions = map.getInteractions().getArray();\n            for (var i = 0; i < interactions.length; i++) {\n                if (interactions[i].getActive() &&\n                    (interactions[i] instanceof ol.interaction.Select ||\n                        interactions[i] instanceof ol.interaction.Modify ||\n                        interactions[i] instanceof ol.interaction.Draw)\n                ) {\n                    // si on a une interaction de dessin ou de slection en cours, on ne fait rien.\n                    return;\n                }\n            }\n        }\n\n        var proxyOptions = {};\n        if (gfiObj._proxyUrl) {\n            proxyOptions.proxyUrl = gfiObj._proxyUrl;\n        }\n        if (gfiObj._noProxyDomains) {\n            proxyOptions.noProxyDomains = gfiObj._noProxyDomains;\n        }\n\n        var autoPanOptions = {};\n        if (gfiObj._autoPan) {\n            autoPanOptions.autoPan = gfiObj._autoPan;\n        }\n        if (gfiObj._autoPanAnimation) {\n            autoPanOptions.autoPanAnimation = gfiObj._autoPanAnimation;\n        }\n        if (gfiObj._autoPanMargin) {\n            autoPanOptions.autoPanMargin = gfiObj._autoPanMargin;\n        }\n\n        var eventLayers = [];\n        for (var j = 0; j < gfiObj._layers.length; ++j) {\n            var event = (gfiObj._layers[j].event) ? gfiObj._layers[j].event : gfiObj._defaultEvent;\n            if (event == e.type) {\n                var ind = eventLayers.push(gfiObj._layers[j]) - 1;\n                if (!eventLayers[ind].infoFormat) {\n                    eventLayers[ind].infoFormat = gfiObj._defaultInfoFormat;\n                }\n            }\n        }\n\n        var coords = this.getPosition(e, map);\n\n        this.displayFeatureInfo(map, coords, eventLayers, proxyOptions, autoPanOptions);\n    }\n};\n\nexport default GfiUtils;\n\n\n\n// WEBPACK FOOTER //\n// ./src/OpenLayers/GfiUtils.js","import ol from \"ol\";\nimport Logger from \"../../Common/Utils/LoggerByDefault\";\nimport Utils from \"../../Common/Utils\";\n// import $__xmldom from \"xmldom\";\n\nvar logger = Logger.getLogger(\"extended KML format\");\n\n/**\n * @classdesc\n *\n * Extended Styles KML format to export (internal use only !)\n *\n * INFO\n * only ol.Control is a user-extendable class.\n * Everything else requires integration with the original ol3 source and a new ol.js\n * to be built with your new classes incorporated.\n *\n * SPEC\n * cf. https://developers.google.com/kml/forum/advanced\n *\n * ISSUES\n * cf. https://github.com/openlayers/ol3/issues/4829\n * cf. https://github.com/openlayers/ol3/issues/4460\n * cf. https://github.com/openlayers/ol3/pull/5590\n * cf. https://github.com/openlayers/ol3/issues/5229\n * cf. https://github.com/openlayers/ol3/issues/3371\n *\n * @constructor\n * @extends {ol.format.KML}\n * @param {Object} options - Options\n */\nfunction KML(options) {\n\n    if (!(this instanceof KML)) {\n        throw new TypeError(\"ERROR CLASS_CONSTRUCTOR\");\n    }\n\n    // call constructor\n    ol.format.KML.call(this,\n        options\n    );\n\n    this.options = options || {};\n}\n\n// Inherits\nol.inherits(KML, ol.format.KML);\n\n/*\n * @lends module:KML\n */\nKML.prototype = Object.create(ol.format.KML.prototype, {});\n\n/**\n * Constructor (alias)\n *\n * En lecture, on surcharge la mthode readFeatures.\n *  In : kml string + features du format original\n *  Out : features tendus avec des styles, et des metadatas (name ou extendData)\n * > on modifie les features du format original avec les fonctionnalits non gres.\n *\n * En criture, on surcharge la mthode writeFearures.\n *  In : kml du format original + features tendus\n *  Out : kml tendu avec des styles, et des metadatas (name ou extendData)\n * > on modifie le kml gnr par le format original avec les fonctionnalits que nous avons ajoutes aux features.\n *\n * Le principe\n * On parse le kml, et on lit (get) ou on ajoute (set) des fonctionnalits.\n *\n * Les getters vont lire le kml (ex. LabelExtendStyle), et ajouter le style ainsi que le nom du label dans le feature original.\n * getLabelIconStyle (appel des 2 fonctions suivantes)\n * getLabelExtendStyle (New)\n * getHotSpotIconStyle (Bug sur la lecture du  hotspot)\n * getExtendData (New)\n *\n * Les setters vont crire dans le dom du kml original les fonctionnalits ajoutes dans les features.\n * setLabelExtendStyle (New)\n * setHotSpotIconStyle (Bug sur l'criture du hotspot)\n * setNameData (Bug suppression de cette balise du format par dfaut).\n *\n */\nKML.prototype.constructor = KML;\n\n/**\n * Fonction d'indentation d'une chaine de caractres KML ou XML\n * cf. https://stackoverflow.com/questions/376373/pretty-printing-xml-with-javascript/\n */\nfunction _kmlFormattedToString(xml) {\n    var reg = /(>)\\s*(<)(\\/*)/g; // updated Mar 30, 2015\n    var wsexp = / *(.*) +\\n/g;\n    var contexp = /(<.+>)(.+\\n)/g;\n    xml = xml.replace(reg, \"$1\\n$2$3\").replace(wsexp, \"$1\\n\").replace(contexp, \"$1\\n$2\");\n    var formatted = \"\";\n    var lines = xml.split(\"\\n\");\n    var indent = 0;\n    var lastType = \"other\";\n    // 4 types of tags - single, closing, opening, other (text, doctype, comment) - 4*4 = 16 transitions\n    var transitions = {\n        \"single->single\": 0,\n        \"single->closing\": -1,\n        \"single->opening\": 0,\n        \"single->other\": 0,\n        \"closing->single\": 0,\n        \"closing->closing\": -1,\n        \"closing->opening\": 0,\n        \"closing->other\": 0,\n        \"opening->single\": 1,\n        \"opening->closing\": 0,\n        \"opening->opening\": 1,\n        \"opening->other\": 1,\n        \"other->single\": 0,\n        \"other->closing\": -1,\n        \"other->opening\": 0,\n        \"other->other\": 0\n    };\n\n    for (var i = 0; i < lines.length; i++) {\n        var ln = lines[i];\n        var single = Boolean(ln.match(/<.+\\/>/)); // is this line a single tag? ex. <br />\n        var closing = Boolean(ln.match(/<\\/.+>/)); // is this a closing tag? ex. </a>\n        var opening = Boolean(ln.match(/<[^!].*>/)); // is this even a tag (that's not <!something>)\n        var type = single ? \"single\" : closing ? \"closing\" : opening ? \"opening\" : \"other\";\n        var fromTo = lastType + \"->\" + type;\n        lastType = type;\n        var padding = \"\";\n\n        indent += transitions[fromTo];\n        for (var j = 0; j < indent; j++) {\n            padding += \"\\t\";\n        }\n        if (fromTo == \"opening->closing\") {\n            formatted = formatted.substr(0, formatted.length - 1) + ln + \"\\n\"; // substr removes line break (\\n) from prev loop\n        } else {\n            formatted += padding + ln + \"\\n\";\n        }\n    }\n\n    logger.trace(formatted);\n    return formatted;\n};\n\n/**\n * Fonction de parsing d'une chaine de caractres KML\n */\nfunction _kmlParse(kmlString) {\n    var kmlDoc = null;\n    var parser = null;\n    var scope = typeof window !== \"undefined\" ? window : null;\n\n    if (typeof exports === \"object\" && window === null) {\n        // code for nodejs\n        var DOMParser = require(\"xmldom\").DOMParser;\n        parser = new DOMParser();\n        kmlDoc = parser.parseFromString(kmlString, \"text/xml\");\n    } else if (scope.DOMParser) {\n        // code for modern browsers\n        parser = new scope.DOMParser();\n        kmlDoc = parser.parseFromString(kmlString, \"text/xml\");\n    } else if (scope.ActiveXObject) {\n        // code for old IE browsers\n        kmlDoc = new scope.ActiveXObject(\"Microsoft.XMLDOM\");\n        kmlDoc.async = false;\n        kmlDoc.loadXML(kmlString);\n    } else {\n        console.log(\"Incompatible environment for DOM Parser !\");\n    }\n\n    logger.trace(kmlDoc);\n    return kmlDoc;\n};\n\n/**\n * Fonction de convertion en chaine de caractres.\n */\nfunction _kmlToString(kmlDoc) {\n    var oSerializer = new XMLSerializer();\n    var kmlStringExtended = oSerializer.serializeToString(kmlDoc);\n\n    logger.trace(kmlStringExtended);\n    return kmlStringExtended;\n};\n\n/**\n * Fonction de lecture du KML avec fonction de traitement en fonction du type\n * PlaceMark (Label ou Marker).\n * Les traitements sont de 2 types :\n *  - creation de styles tendus ou correctifs sur le KML\n *  - ajout de styles tendus sur les features\n *\n * @example\n * // ajoute des fonctionnalits dans le KML\n * _kmlRead(kmlDoc, {\n *   labelStyle : createStyleLabel,\n *   iconStyle  : createStyleIcon\n * });\n *\n * // lit des fonctionnalits du KML non impl. par OpenLayers\n * _kmlRead(kmlDoc, {\n *   labelStyle : getStyleToFeatureLabel,\n *   iconStyle  : getStyleToFeatureIcon,\n *   extendedData : getExtendedData\n * });\n */\nfunction _kmlRead(kmlDoc, features, process) {\n    var root = kmlDoc.documentElement;\n    var firstNodeLevel = root.childNodes;\n\n    // Si le DOM contient un seul objet, le noeud est directement un PlaceMark\n    // sinon, c'est un ensemble de noeuds PlaceMark contenus dans le noeud Document.\n    var nodes = firstNodeLevel;\n    if (firstNodeLevel.length === 1 && firstNodeLevel[0].nodeName === \"Document\") {\n        nodes = firstNodeLevel[0].childNodes;\n    }\n\n    // On recherche les PlaceMark de type Point ayant un Style...\n    // Le style peut tre plac directement dans le PlaceMark\n    // ou li avec un id (share)\n    var stylesUrl = {}; // listes des styles\n    var index = -1; // index du features...\n    for (var i = 0; i < nodes.length; i++) {\n        var node = nodes[i];\n        switch (node.nodeName) {\n\n            case \"Style\":\n                // INFO\n                // pour le traitement des balises Styles lies avec styleUrl,\n                // elles doivent tre toujours dclares avant les PlaceMark !\n                // On ne prend en compte que celles qui sont identifies via un ID !\n                var id = node.attributes[0];\n                if (id && id.nodeName === \"id\") {\n                    var _k = id.nodeValue;\n                    var _v = node;\n                    stylesUrl[_k] = _v;\n                }\n                break;\n\n            case \"Placemark\":\n\n                index++;\n                var types = node.childNodes; // Point, LineString, Polygon, Style, ...\n                var point = false;\n                var styles = null; // dom\n                var extend = null; // dom\n                var name = node;\n                for (var j = 0; j < types.length; j++) {\n                    switch (types[j].nodeName) {\n                        case \"Point\":\n                            point = true;\n                            break;\n                        case \"Style\":\n                            styles = types[j].childNodes; // liste de styles\n                            break;\n                        case \"styleUrl\":\n                            // style avec lien vers...\n                            var _idStyle = types[j].textContent.slice(1);\n                            if (stylesUrl[_idStyle]) {\n                                styles = stylesUrl[_idStyle].childNodes;\n                            }\n                            break;\n                        case \"ExtendedData\":\n                            extend = types[j].childNodes;\n                            break;\n                        case \"name\":\n                            name = null;\n                            break;\n                        default:\n                            // on ne traite pas les autres informations ...\n                            // car elles seront gres par defaut par le format standard...\n                    }\n                }\n\n                // On traite les balises kml:extendedData pour tous les objets !\n                if (extend) {\n                    logger.log(\"ExtendedData :\", extend);\n                    var fctExtend = process.extendedData;\n                    if (fctExtend && typeof fctExtend === \"function\") {\n                        fctExtend(features[index], extend);\n                    }\n                }\n\n                //  On traite la balise kml:name\n                // (si elle n'existe plus lors de l'ecriture...)\n                if (name) {\n                    logger.log(\"Name :\", name);\n                    var fctName = process.nameData;\n                    if (fctName && typeof fctName === \"function\") {\n                        fctName(features[index], name);\n                    }\n                }\n\n                // On a un Marker avec un Style.\n                // Les markers sans styles seront gres par defaut par le format standard...\n                // Il peut tre associ avec un Label !\n                if (point && styles) {\n                    // Les Styles !\n                    if (styles.length) {\n                        var labelStyle = null;\n                        var iconStyle = null;\n                        // On recherche le type de Style\n                        for (var k = 0; k < styles.length; k++) {\n                            switch (styles[k].nodeName) {\n                                case \"LabelStyle\":\n                                    labelStyle = styles[k];\n                                    break;\n                                case \"IconStyle\":\n                                    iconStyle = styles[k];\n                                    break;\n                                default:\n                                    // on ne traite pas les autres informations ...\n                            }\n                        }\n\n                        // Pour un label, il nous faut un titre !\n                        var labelName = features[index].getProperties().name;\n                        var labelDescription = features[index].getProperties().description;\n                        var value = labelName || labelDescription;\n                        logger.trace(value);\n\n                        // C'est uniquement un Label !\n                        if (!iconStyle && labelStyle) {\n                            var fctLabel = process.labelStyle;\n                            if (fctLabel && typeof fctLabel === \"function\") {\n                                fctLabel(features[index], labelStyle);\n                            }\n                        }\n\n                        // C'est uniquement un marker !\n                        else if (iconStyle && !labelStyle) {\n                            var fctIcon = process.iconStyle;\n                            if (fctIcon && typeof fctIcon === \"function\") {\n                                fctIcon(features[index], iconStyle);\n                            }\n                        }\n\n                        // C'est un marker avec un label !\n                        else if (iconStyle && labelStyle) {\n                            var fctIconLabel = process.iconLabelStyle;\n                            if (fctIconLabel && typeof fctIconLabel === \"function\") {\n                                fctIconLabel(features[index], iconStyle, labelStyle);\n                            }\n                        }\n                    }\n                }\n\n                break;\n            default:\n                logger.trace(\"tag is not processing !\");\n        }\n    }\n};\n\n/**\n * Write Extend Styles for Features.\n * This function overloads ol.format.KML.writeFeatures ...\n *\n * @see ol.format.KML.prototype.writeFeatures\n * @param {Array.<Object>} features - Features.\n * @param {Object} options - Options.\n * @return {String} Result.\n */\nKML.prototype.writeFeatures = function(features, options) {\n    // KML.prototype._parentWriteFeatures = ol.format.KML.prototype.writeFeatures;\n    logger.log(\"overload : ol.format.KML.writeFeatures\");\n    var kmlString = this._writeExtendStylesFeatures(features, options);\n    return kmlString;\n};\n\n/**\n * _writeExtendStylesFeatures\n *\n * @private\n */\nKML.prototype._writeExtendStylesFeatures = function(features, options) {\n\n    var kmlString = ol.format.KML.prototype.writeFeatures.call(this, features, options);\n\n    // On met en place un Parser sur le KML\n    // (Dommage que le parser XML des services ne soit pas disponible !)\n    var kmlDoc = _kmlParse(kmlString);\n\n    if (kmlDoc === null) {\n        // au cas o...\n        return kmlString;\n    }\n\n    /**\n     * C'est un Label !\n     * On va donc y ajouter qq styles sur le Label (police, halo, ...) :\n     * Insertion : PlaceMark>Style>LabelStyle\n     *\n     * @example\n     *      <LabelStyleSimpleExtensionGroup fontFamily=\"Arial\" haloColor=\"16777215\" haloRadius=\"2\" haloOpacity=\"1\"/>\n     */\n    var __createExtensionStyleLabel = function(feature, style) {\n\n        logger.trace(\"label with style :\", style);\n\n        if (!feature) {\n            return;\n        }\n\n        var labelName = feature.getProperties().name;\n        if (!labelName) {\n            return;\n        }\n\n        /** RGB Colors (RRGGBB) To KML Colors (AABBGGRR) */\n        function __convertRGBColorsToKML(data) {\n            var strColor = data.toString(16);\n\n            if (strColor.charAt(0) === \"#\") {\n                strColor = strColor.slice(1);\n            }\n\n            var opacity = 1;\n            opacity = parseInt(opacity * 255, 10);\n            opacity = opacity.toString(16);\n            var color = opacity;\n            color = color + strColor.substr(4, 2);\n            color = color + strColor.substr(2, 2);\n            color = color + strColor.substr(0, 2);\n            return color.toLowerCase();\n        }\n\n        // Si pas de style defini, c'est donc que l'on va utiliser celui par defaut...\n        if (feature.getStyle() instanceof ol.style.Style) {\n\n            var fTextStyle = feature.getStyle().getText().getStroke();\n\n            if (!fTextStyle) {\n                return;\n            }\n\n            var _haloColor = __convertRGBColorsToKML(fTextStyle.getColor()) || __convertRGBColorsToKML(\"#FFFFFF\"); // KML Colors : 64FFFFFF (blanc)\n            var _haloRadius = fTextStyle.getWidth() || \"0\";\n            var _haloOpacity = \"1\"; // TODO\n            var _font = \"Sans\"; // TODO\n\n            if (style && style.getElementsByTagName(\"LabelStyleSimpleExtensionGroup\").length === 0) {\n\n                var labelextend = kmlDoc.createElement(\"LabelStyleSimpleExtensionGroup\");\n                labelextend.setAttribute(\"fontFamily\", _font);\n                labelextend.setAttribute(\"haloColor\", _haloColor);\n                labelextend.setAttribute(\"haloRadius\", _haloRadius);\n                labelextend.setAttribute(\"haloOpacity\", _haloOpacity);\n                style.appendChild(labelextend);\n            }\n        }\n\n    };\n\n    /**\n     * C'est un marker !\n     * On va donc ajouter la balise hotspot :\n     *  Traiter le cas o les units sont de type\n     *   - FRACTION\n     *   - PIXELS\n     *  Insertion du correctif dans le noeud : <PlaceMark><Style>IconStyle\n     *\n     *  @example\n     *  <Style><IconStyle>\n     *      <hotSpot x=\"0.5\"  y=\"1\" xunits=\"fraction\" yunits=\"fraction\"/>\n     *  </IconStyle></Style>\n     */\n    var __createHotSpotStyleIcon = function(feature, style) {\n        logger.trace(\"marker with style (hotspot):\", style);\n\n        if (!feature) {\n            return;\n        }\n\n        // Si pas de style defini, c'est donc que l'on va utiliser celui par defaut...\n        if (feature.getStyle() instanceof ol.style.Style) {\n\n            var fImageStyle = feature.getStyle().getImage();\n\n            if (!fImageStyle) {\n                return;\n            }\n\n            var x = 0;\n            var y = 0;\n            var xunits = \"pixels\";\n            var yunits = \"pixels\";\n\n            var size = fImageStyle.getSize();\n            var anchor = fImageStyle.getAnchor(); // pixels ! but anchor_ in the current unit !\n\n            if (anchor.length) {\n                x = anchor[0];\n                y = anchor[1];\n                if (yunits === \"fraction\") {\n                    y = (anchor[1] === 1) ? 0 : 1 - anchor[1]; // cf. fixme contribution  faire !\n                } else {\n                    y = (yunits === \"pixels\" && anchor[1] === size[1]) ? 0 : size[1] - anchor[1]; // cf. fixme contribution  faire !\n                }\n            }\n\n            if (style && style.getElementsByTagName(\"hotSpot\").length === 0) {\n                var hotspot = kmlDoc.createElement(\"hotSpot\");\n                hotspot.setAttribute(\"x\", x);\n                hotspot.setAttribute(\"y\", y);\n                hotspot.setAttribute(\"xunits\", xunits);\n                hotspot.setAttribute(\"yunits\", yunits);\n                style.appendChild(hotspot);\n            }\n        }\n    };\n\n    /** TODO */\n    var __createStyleToFeatureIconLabel = function(feature, iconStyle, labelStyle) {\n        logger.trace(\"write an icon with a label\");\n        __createHotSpotStyleIcon(feature, iconStyle);\n        __createExtensionStyleLabel(feature, labelStyle);\n\n    };\n\n    /** TODO */\n    var __setNameData = function(feature, tags) {\n\n        for (var i = 0; i < tags.length; i++) {\n            var tag = tags[i];\n            if (tag.nodeName === \"name\") {\n                return;\n            }\n        }\n\n        var labelName = feature.getProperties().name;\n        if (labelName) {\n            var name = kmlDoc.createElement(\"name\");\n            name.innerHTML = labelName;\n            tags.appendChild(name);\n        }\n    };\n\n    // On ajoute les styles tendus dans le DOM\n    _kmlRead(kmlDoc, features, {\n        labelStyle: __createExtensionStyleLabel,\n        iconStyle: __createHotSpotStyleIcon,\n        iconLabelStyle: __createStyleToFeatureIconLabel,\n        nameData: __setNameData\n    });\n\n    // On convertit le DOM en String...\n    var kmlStringExtended = _kmlToString(kmlDoc);\n\n    // au cas o...\n    if (kmlStringExtended === null) {\n        kmlStringExtended = kmlString;\n    }\n\n    // On realise un formattage du KML\n    var kmlStringFormatted = _kmlFormattedToString(kmlStringExtended);\n\n    // au cas o...\n    if (kmlStringFormatted === null) {\n        kmlStringFormatted = kmlString;\n    }\n\n    return kmlStringFormatted;\n};\n\n/**\n * Read Extend Styles for Features.\n * This function overloads ol.format.KML.readFeatures ...\n *\n * @see ol.format.KML.prototype.readFeatures\n * @param {Document|Node|ArrayBuffer|Object|String} source - Source.\n * @param {olx.format.ReadOptions=} options - options.\n * @return {Array.<ol.Feature>} Features.\n */\nKML.prototype.readFeatures = function(source, options) {\n    // KML.prototype._parentReadFeatures = ol.format.KML.prototype.readFeatures;\n    logger.log(\"overload : ol.format.KML.readFeatures\");\n    var features = this._readExtendStylesFeatures(source, options);\n    logger.trace(\"Styles tendus\", features);\n\n    // la gestion des styles est deplace au niveau des extensions\n    // qui ont besoin de lire un KML (ex. Drawing) ...\n    //\n    // features.forEach(function (feature) {\n    //     var featureStyleFunction = feature.getStyleFunction();\n    //     if (featureStyleFunction) {\n    //         var styles = featureStyleFunction.call(feature, 0);\n    //         if (styles && styles.length !== 0) {\n    //             feature.setStyle(styles[0]);\n    //         }\n    //     }\n    // });\n\n    return features;\n};\n\n/**\n * _readExtendStylesFeatures\n *\n * @private\n */\nKML.prototype._readExtendStylesFeatures = function(source, options) {\n    var features = ol.format.KML.prototype.readFeatures.call(this, source, options);\n\n    var kmlDoc = null;\n    var kmlString = \"\";\n\n    if (typeof source === \"string\") {\n        kmlString = source;\n\n    } else {\n        kmlString = source.documentElement.outerHTML;\n    }\n\n    // On 'deformatte' le KML afin d'eviter des pb de parsing...\n    kmlString = kmlString.replace(/\\n/g, \"\");\n    kmlString = kmlString.replace(/(>)\\s*(<)/g, \"$1$2\");\n\n    // On met en place un Parser sur le KML\n    kmlDoc = _kmlParse(kmlString);\n\n    if (kmlDoc === null) {\n        // au cas o...\n        return features;\n    }\n\n    /**\n     * Gestion des styles tendus sur le Label\n     * - ajout d'un icone par defaut (1x1p transparent) sur les labels\n     * s'il n'existe pas !\n     * - lecture des styles tendus des labels\n     *\n     * @example\n     * <Placemark>\n     *  <description>Un label</description>\n     *  <name>C'est un label tendu !</name>\n     *  <Style>\n     *    <IconStyle>\n     *      <Icon>\n     *        <href>data:image/png;base64,...</href>\n     *      </Icon>\n     *    </IconStyle>\n     *    <LabelStyle>\n     *      <color>ffffffff</color>\n     *      <colorMode>normal</colorMode>\n     *      <scale>1.85</scale>\n     *      <LabelStyleSimpleExtensionGroup haloColor=\"16711680\" haloRadius=\"5\" haloOpacity=\"1\"/>\n     *    </LabelStyle>\n     *  </Style>\n     *  <Point>\n     *    <coordinates>2,48</coordinates>\n     *  </Point>\n     * </Placemark>\n     */\n    var __getExtensionStyleToFeatureLabel = function(feature, style) {\n\n        logger.trace(\"label with style :\", style);\n\n        if (!feature) {\n            return;\n        }\n\n        /** KML Colors (AABBGGRR) To RGB Colors (RRGGBB) */\n        function __convertKMLColorsToRGB(data) {\n            var color = \"\";\n            color = color + data.substr(6, 2);\n            color = color + data.substr(4, 2);\n            color = color + data.substr(2, 2);\n            var hex = parseInt(color, 16).toString(16);\n            var comp = \"\";\n            var len = hex.length || 0;\n            for (var i = 0; i < (6 - len); i++) {\n                comp += \"0\";\n            }\n            hex = \"#\" + comp + hex;\n            return hex.toString(16);\n        }\n\n        var _text = feature.getProperties().name || \"---\";\n        var _color = __convertKMLColorsToRGB(\"ff000000\"); // \"#000000\"\n        var _colorHalo = \"#FFFFFF\";\n        var _radiusHalo = 0;\n        var _font = \"Sans\"; // TODO\n        var _fontSize = \"16px\"; // TODO\n\n        // On recherche les balises du Style\n        var bLabelStyleSimpleExtensionGroup = false;\n        var styles = style.childNodes;\n        for (var k = 0; k < styles.length; k++) {\n            switch (styles[k].nodeName) {\n                case \"scale\":\n                    // TODO\n                    break;\n                case \"colorMode\":\n                    // TODO\n                    break;\n                case \"color\":\n                    _color = __convertKMLColorsToRGB(styles[k].textContent);\n                    break;\n                case \"LabelStyleSimpleExtensionGroup\":\n                    bLabelStyleSimpleExtensionGroup = true;\n                    var attributs = styles[k].attributes;\n                    for (var l = 0; l < attributs.length; l++) {\n                        switch (attributs[l].nodeName) {\n                            case \"fontFamily\":\n                                // TODO\n                                break;\n                            case \"haloColor\":\n                                _colorHalo = __convertKMLColorsToRGB(attributs[l].nodeValue);\n                                break;\n                            case \"haloRadius\":\n                                _radiusHalo = parseInt(attributs[l].nodeValue, 10);\n                                break;\n                            case \"haloOpacity\":\n                                // TODO\n                                break;\n                            default:\n                        }\n                    }\n                    break;\n                default:\n                    // on ne traite pas les autres informations ...\n            }\n        }\n\n        // Ce n'est pas un style tendu !\n        if (!bLabelStyleSimpleExtensionGroup) {\n            logger.trace(\"it's not a Label Style Simple Extension Group !\");\n            return;\n        }\n\n        // On reconstruit le style !\n        feature.setStyle(new ol.style.Style({\n            image: new ol.style.Icon({\n                src: \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR4nGNiYAAAAAkAAxkR2eQAAAAASUVORK5CYII=\",\n                size: [51, 38],\n                anchor: [25.5, 38],\n                anchorOrigin: \"top-left\",\n                anchorXUnits: \"pixels\",\n                anchorYUnits: \"pixels\"\n            }),\n            text: new ol.style.Text({\n                font: _fontSize + \" \" + _font,\n                textAlign: \"left\",\n                text: _text,\n                // offsetX : 5, // FIXME valeur arbitraire MAIS esthtique !\n                fill: new ol.style.Fill({\n                    color: _color\n                }),\n                stroke: new ol.style.Stroke({\n                    color: _colorHalo,\n                    width: _radiusHalo\n                })\n            })\n        }));\n\n    };\n\n    /**\n     * Gestion de la balise kml:hostSpot sur les styles d'un Marker\n     * - problme avec 'hotspot y === 0' (?)\n     *\n     * @example\n     * <Placemark>\n     *   <Style>\n     *     <IconStyle>\n     *       <Icon>\n     *         <href>data:image/png;base64,...</href>\n     *       </Icon>\n     *       <hotSpot x=\"25.5\" y=\"0\" xunits=\"pixels\" yunits=\"pixels\"/>\n     *     </IconStyle>\n     *   </Style>\n     *   <Point>\n     *     <coordinates>2,48</coordinates>\n     *   </Point>\n     * </Placemark>\n     */\n    var __getHotSpotStyleToFeatureIcon = function(feature, style) {\n        logger.trace(\"hotspot :\", style);\n\n        var _src = null;\n        var _scale = null;\n\n        var _bSizeIcon = false;\n        var _sizeW = 51;\n        var _sizeH = 38;\n\n        var _bHotSpot = false;\n        var _anchorX = 25.5;\n        var _anchorXUnits = \"pixels\";\n        var _anchorY = 38;\n        var _anchorYUnits = \"pixels\";\n\n        var styles = style.childNodes;\n        for (var k = 0; k < styles.length; k++) {\n            switch (styles[k].nodeName) {\n                case \"Icon\":\n                    var nodes = styles[k].childNodes;\n                    for (var i = 0; i < nodes.length; i++) {\n                        switch (nodes[i].nodeName) {\n                            case \"href\":\n                                _src = nodes[i].textContent;\n                                break;\n                            case \"gx:w\":\n                                _bSizeIcon = true;\n                                _sizeW = parseFloat(nodes[i].textContent);\n                                break;\n                            case \"gx:h\":\n                                _bSizeIcon = true;\n                                _sizeH = parseFloat(nodes[i].textContent);\n                                break;\n                            default:\n                        }\n                    }\n                    break;\n                case \"hotSpot\":\n                    _bHotSpot = true;\n                    var attributs = styles[k].attributes;\n                    for (var l = 0; l < attributs.length; l++) {\n                        switch (attributs[l].nodeName) {\n                            case \"x\":\n                                _anchorX = parseFloat(attributs[l].nodeValue);\n                                break;\n                            case \"y\":\n                                _anchorY = parseFloat(attributs[l].nodeValue);\n                                break;\n                            case \"yunits\":\n                                _anchorXUnits = attributs[l].nodeValue;\n                                break;\n                            case \"xunits\":\n                                _anchorYUnits = attributs[l].nodeValue;\n                                break;\n                            default:\n                        }\n                    }\n                    break;\n                case \"scale\":\n                    _scale = parseFloat(styles[k].textContent);\n                    break;\n                default:\n                    // on ne traite pas les autres informations ...\n            }\n        }\n\n        var _options = {\n            src: _src,\n            crossOrigin: \"anonymous\", // cf. https://gis.stackexchange.com/questions/121555/wms-server-with-cors-enabled/147403#147403\n            scale: _scale || 1 // FIXME !?\n        };\n\n        if (_bSizeIcon) {\n            Utils.mergeParams(_options, {\n                size: [_sizeW, _sizeH]\n            });\n        }\n\n        if (_bHotSpot) {\n            Utils.mergeParams(_options, {\n                anchor: [_anchorX, _anchorY],\n                anchorOrigin: \"bottom-left\",\n                anchorXUnits: _anchorXUnits || \"pixels\",\n                anchorYUnits: _anchorYUnits || \"pixels\"\n            });\n        }\n\n        // existe il dj le style du label ?\n        var featureStyleFunction = feature.getStyleFunction();\n        if (featureStyleFunction) {\n            var _styles = featureStyleFunction.call(feature, 0);\n            if (_styles && _styles.length !== 0) {\n                var _style = (_styles.length === 1) ? _styles[0] : _styles[_styles.length - 1];\n                // on crase l'icone magic du label !\n                feature.setStyle(new ol.style.Style({\n                    image: new ol.style.Icon(_options),\n                    text: _style.getText()\n                }));\n            }\n        }\n    };\n\n    /**\n     * Gestion de la balise kml:ExtendedData\n     *\n     * @example\n     * //--> Marker (Point), LineString, Polygon\n     * <ExtendedData>\n     *    <Data name=\"attributetitle\">\n     *        <displayName>title</displayName>\n     *        <value>Titre  concatener avec la valeur de la balise \"kml:description\"</value>\n     *    </Data>\n     * </ExtendedData>\n     * //--> Label\n     * <ExtendedData>\n     *    <Data name=\"label\">\n     *        <value>PARIS</value> // valeur  remplacer dans \"kml:name\"\n     *    </Data>\n     *    <Data name=\"attributetitle\">\n     *        <displayName>title</displayName>\n     *        <value>Titre  concatener avec la valeur de la balise \"kml:description\"</value>\n     *    </Data>\n     * </ExtendedData>\n     */\n    var __getExtendedData = function(feature, extend) {\n\n        logger.trace(\"extendData :\", extend);\n\n        if (!feature) {\n            return;\n        }\n\n        var _fname = feature.getProperties().name || \"\";\n        var _fdescription = feature.getProperties().description || \"\";\n        var _ftitle = null;\n        for (var i = 0; i < extend.length; i++) {\n            var data = extend[i];\n            var name = data.attributes[0]; // 1 seul attribut !\n            var nodes = data.childNodes;\n            if (name.nodeName === \"name\") {\n                switch (name.nodeValue) {\n                    // compatibilit ancien geoportail !\n                    case \"label\":\n                        _fname = data.textContent;\n                        break;\n                        // compatibilit ancien geoportail !\n                    case \"title\":\n                    case \"attributetitle\":\n                        for (var j = 0; j < nodes.length; j++) {\n                            if (nodes[j].nodeName === \"value\") {\n                                _ftitle = nodes[j].textContent;\n                            }\n                        }\n                        break;\n                    default:\n                        // for (var k = 0; k < nodes.length; k++) {\n                        //     if (nodes[k].nodeName === \"value\") {\n                        //         _fdescription += \"<br>\";\n                        //         _fdescription += nodes[k].textContent;\n                        //\n                        //     }\n                        // }\n                }\n            }\n        }\n\n        // Modification des properties \"name\" et \"description\"\n        if (_ftitle) {\n            _fdescription = (_fdescription) ? _ftitle + \" : \" + _fdescription : _ftitle;\n        }\n\n        feature.setProperties({\n            name: _fname,\n            description: _fdescription\n        });\n    };\n\n    /** TODO */\n    var __getStyleToFeatureIconLabel = function(feature, iconStyle, labelStyle) {\n        logger.trace(\"display icon and label\");\n        __getExtensionStyleToFeatureLabel(feature, labelStyle);\n        __getHotSpotStyleToFeatureIcon(feature, iconStyle);\n\n    };\n\n    // On lit les styles tendus et on les ajoute aux features\n    _kmlRead(kmlDoc, features, {\n        labelStyle: this.options.showPointNames ? __getExtensionStyleToFeatureLabel : null,\n        iconStyle: __getHotSpotStyleToFeatureIcon,\n        iconLabelStyle: this.options.showPointNames ? __getStyleToFeatureIconLabel : __getHotSpotStyleToFeatureIcon,\n        extendedData: __getExtendedData\n    });\n\n    return features;\n};\n\nexport default KML;\n\n\n\n// WEBPACK FOOTER //\n// ./src/OpenLayers/Formats/KML.js","import ol from \"ol\";\nimport Logger from \"../../../Common/Utils/LoggerByDefault\";\nimport Utils from \"../../../Common/Utils\";\n\n\nvar logger = Logger.getLogger(\"interactions\");\n\n/**\n * HOWTO\n * Pourquoi et comment l'utiliser ?\n * Cette classe permet de grer les interactions entre chaque extension.\n * Une extension qui active une interaction avec la carte, doit desactiver\n * les autres interactions issues d'autre extensions.\n * La dsactivation d'une interaction s'accompagne d'actions telles que\n * le nettoyage des dessins, l'tat du composant graphique, ...\n *\n * Ex\n * // desactive toutes les interactions avec l'opration par defaut : clean\n * Interactions.unset(map);\n * // desactive les interactions sauf celles de Drawing. On execute des\n * // operations particulieres : status, collapse et message\n * Interactions.unset(map, {\n *    current : \"Drawing\",\n *    status : false,\n *    collapse : true,\n *    messsage : [\"WARNING\", \"Ceci est un avertissement !\"]\n * });\n *\n * Dans le code de l'extension, il faut placer des informations dans l'interaction :\n * interaction.setProperties({\n *     name : \"Drawing\",\n *     source : this\n * });\n */\nvar Interactions = {\n\n    /**\n     * Liste des extensions qui utilisent le mcanisme des interactions\n     */\n    _extensions: [\n        \"Measures\",\n        \"ElevationPath\",\n        \"Drawing\"\n    ],\n\n    /**\n     * Options par defaut\n     * - current : ex. \"Drawing\"\n     *       c'est l'extension qui demande la desactivation des autres interactions.\n     *       Par defaut, toutes les interactions sont desactives.\n     * - clean :\n     *       c'est la suppression des interactions, des dessins de la carte,\n     *       ainsi que la reinitialisation de l'tat graphique.\n     *       Les extensions doivent implementer la mthode 'clean()'.\n     *       Par defaut, tous les dessins sont supprims\n     */\n    _options: {\n        current: null,\n        clean: null\n    },\n\n    /**\n     * Permet de desactive les interactions (Draw) de la carte pour les extensions,\n     * sauf l'interaction courrante (si elle est renseigne avec l'option 'current').\n     * Il est possible d'ajouter des fonctionnalits via les options.\n     * Par defaut, l'option 'clean' est renseigne...\n     */\n    unset: function(map, options) {\n        logger.trace(\"unset()\");\n\n        var opts = {};\n        Utils.mergeParams(opts, this._options);\n        Utils.mergeParams(opts, options);\n\n        var interactions = map.getInteractions().getArray();\n        for (var i = 0; i < interactions.length; i++) {\n            if (interactions[i].getActive() &&\n                (interactions[i] instanceof ol.interaction.Draw ||\n                    interactions[i] instanceof ol.interaction.Select ||\n                    interactions[i] instanceof ol.interaction.Modify)) {\n\n                var prop = interactions[i].getProperties();\n                var name = prop.name;\n                if (typeof name !== \"undefined\" && this._extensions.indexOf(name) > -1) {\n                    // doit on desactiver l'interaction courrante ?\n                    if (opts.current && opts.current === name) {\n                        continue;\n                    }\n                    interactions[i].setActive(false);\n                    // instance de l'extension\n                    var source = prop.source;\n                    if (typeof source !== \"undefined\" && source instanceof ol.control.Control) {\n                        // oprations sur le composant graphique\n                        for (var action in opts) {\n                            if (opts.hasOwnProperty(action)) {\n                                if (action === \"current\") {\n                                    continue;\n                                }\n                                if (typeof source[action] === \"function\") {\n                                    var args = Array.isArray(opts[action]) ? opts[action] : [opts[action]];\n                                    source[action].apply(source, args);\n                                }\n                            }\n                        }\n                    }\n                }\n            }\n        }\n    }\n};\n\nexport default Interactions;\n\n\n\n// WEBPACK FOOTER //\n// ./src/OpenLayers/Controls/Utils/Interactions.js","// removed by extract-text-webpack-plugin\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./res/Common/GPdrawing.css\n// module id = 20\n// module chunks = 0","// removed by extract-text-webpack-plugin\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./res/Common/GPisochron.css\n// module id = 21\n// module chunks = 0","// removed by extract-text-webpack-plugin\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./res/Common/GPmeasureAzimuth.css\n// module id = 22\n// module chunks = 0","// removed by extract-text-webpack-plugin\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./res/Common/GPreverseGeocoding.css\n// module id = 23\n// module chunks = 0","// removed by extract-text-webpack-plugin\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./res/Common/GPelevationPath.css\n// module id = 24\n// module chunks = 0","// removed by extract-text-webpack-plugin\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./res/Common/GPlayerSwitcher.css\n// module id = 25\n// module chunks = 0","// removed by extract-text-webpack-plugin\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./res/Common/GPmeasureLength.css\n// module id = 26\n// module chunks = 0","// removed by extract-text-webpack-plugin\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./res/Common/GProute.css\n// module id = 27\n// module chunks = 0","// removed by extract-text-webpack-plugin\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./res/Common/GPgeneralWidget.css\n// module id = 28\n// module chunks = 0","// removed by extract-text-webpack-plugin\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./res/Common/GPlocation.css\n// module id = 29\n// module chunks = 0","// removed by extract-text-webpack-plugin\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./res/Common/GPmeasureToolTip.css\n// module id = 30\n// module chunks = 0","// removed by extract-text-webpack-plugin\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./res/Common/GPsearchEngine.css\n// module id = 31\n// module chunks = 0","// removed by extract-text-webpack-plugin\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./res/Common/GPgetFeatureInfo.css\n// module id = 32\n// module chunks = 0","// removed by extract-text-webpack-plugin\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./res/Common/GPmeasureArea.css\n// module id = 33\n// module chunks = 0","// removed by extract-text-webpack-plugin\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./res/Common/GPmousePosition.css\n// module id = 34\n// module chunks = 0","module.exports = __WEBPACK_EXTERNAL_MODULE_35__;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external {\"commonjs2\":\"itowns\",\"commonjs\":\"itowns\",\"amd\":\"itowns\",\"root\":\"itowns\"}\n// module id = 35\n// module chunks = 0","var MousePositionDOM = {\n\n    /** Add uuid to the tag ID */\n    _addUID: function(id) {\n        var uid = (this._uid) ? id + \"-\" + this._uid : id;\n        return uid;\n    },\n\n    /**\n     * Main container (DOM)\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createMainContainerElement: function() {\n\n        var container = document.createElement(\"div\");\n        container.id = this._addUID(\"GPmousePosition\");\n        container.className = \"GPwidget\";\n        return container;\n    },\n\n    // ################################################################### //\n    // ################### Methods of main container ##################### //\n    // ################################################################### //\n\n    /**\n     * Hidden checkbox for minimizing/maximizing\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createShowMousePositionElement: function() {\n\n        var input = document.createElement(\"input\");\n        input.id = this._addUID(\"GPshowMousePosition\");\n        input.type = \"checkbox\";\n        return input;\n    },\n\n    /**\n     * Show mouse position control\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createShowMousePositionPictoElement: function(isDesktop) {\n\n        // contexte d'execution\n        var self = this;\n\n        var label = document.createElement(\"label\");\n        label.id = this._addUID(\"GPshowMousePositionPicto\");\n        label.className = \"GPshowAdvancedToolPicto\";\n        label.htmlFor = this._addUID(\"GPshowMousePosition\");\n        label.title = \"Afficher les coordonnes du curseur\";\n\n        // FIXME detection disponible dans le JS !\n        // Detection : test for desktop or tactile\n        // var isDesktop = true;\n        // var userAgent = window.navigator.userAgent.toLowerCase();\n        // if (userAgent.indexOf(\"iphone\") !== -1 ||\n        // userAgent.indexOf(\"ipod\") !== -1 ||\n        // userAgent.indexOf(\"ipad\") !== -1 ||\n        // userAgent.indexOf(\"android\") !== -1 ||\n        // userAgent.indexOf(\"mobile\") !== -1 ||\n        // userAgent.indexOf(\"blackberry\") !== -1 ||\n        // userAgent.indexOf(\"tablet\") !== -1 ||\n        // userAgent.indexOf(\"phone\") !== -1 ||\n        // userAgent.indexOf(\"touch\") !== -1 ) {\n        //     isDesktop = false;\n        // }\n        // if (userAgent.indexOf(\"msie\") !== -1 ||\n        // userAgent.indexOf(\"trident\") !== -1) {\n        //     isDesktop = true;\n        // }\n\n        // Show map center localisation if panel opened and tactile support\n        label.addEventListener(\"click\", function(e) {\n            var mapCenterClass = \"\";\n            if (!document.getElementById(self._addUID(\"GPshowMousePosition\")).checked && !isDesktop) {\n                mapCenterClass = \"GPmapCenterVisible\";\n            }\n            document.getElementById(\"GPmapCenter\").className = mapCenterClass;\n            self.onShowMousePositionClick(e);\n        });\n\n        var spanOpen = document.createElement(\"span\");\n        spanOpen.id = this._addUID(\"GPshowMousePositionOpen\");\n        spanOpen.className = \"GPshowAdvancedToolOpen\";\n        label.appendChild(spanOpen);\n\n        return label;\n    },\n\n    /**\n     * mouse position panel\n     *\n     * FIXME\n     * don't call this._createMousePositionSettingsElement\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createMousePositionPanelElement: function(displayAltitude, displayCoordinates, editCoordinates, currentProjectionUnits) {\n        // default Values\n        displayAltitude = (typeof displayAltitude === \"undefined\") ? true : displayAltitude;\n        displayCoordinates = (typeof displayCoordinates === \"undefined\") ? true : displayCoordinates;\n        editCoordinates = (typeof editCoordinates === \"undefined\") ? false : editCoordinates;\n\n        var div = document.createElement(\"div\");\n        div.id = this._addUID(\"GPmousePositionPanel\");\n        div.className = \"GPpanel\";\n\n        div.appendChild(this._createMousePositionPanelHeaderElement());\n        div.appendChild(this._createMousePositionPanelBasicElement(displayAltitude, displayCoordinates, editCoordinates, currentProjectionUnits));\n\n        var arraySettings = this._createShowMousePositionSettingsElement(displayCoordinates);\n        for (var j = 0; j < arraySettings.length; j++) {\n            div.appendChild(arraySettings[j]);\n        }\n\n        // FIXME on decompose la fonction pour les besoins du controle,\n        // on ajoutera ces childs  la main...\n        // div.appendChild(this._createMousePositionSettingsElement());\n\n        return div;\n\n    },\n\n    /** Map center localisation (tactile use) */\n    _createMapCenter: function() {\n        var div = document.createElement(\"div\");\n        div.id = \"GPmapCenter\";\n        div.className = \"\";\n        return div;\n    },\n\n    // ################################################################### //\n    // ####################### Panel container ########################### //\n    // ################################################################### //\n\n    /** ... */\n    _createMousePositionPanelHeaderElement: function() {\n\n        var container = document.createElement(\"div\");\n        container.className = \"GPpanelHeader\";\n\n        var divTitle = document.createElement(\"div\");\n        divTitle.className = \"GPpanelTitle\";\n        divTitle.innerHTML = \"Coordonnes\";\n        container.appendChild(divTitle);\n\n        var divClose = document.createElement(\"div\");\n        divClose.id = \"GPmousePositionPanelClose\";\n        divClose.className = \"GPpanelClose\";\n        divClose.title = \"Fermer le panneau\";\n\n        // Link panel close / visibility checkbox\n        var self = this;\n        if (divClose.addEventListener) {\n            divClose.addEventListener(\"click\", function() {\n                document.getElementById(self._addUID(\"GPshowMousePositionPicto\")).click();\n            }, false);\n        } else if (divClose.attachEvent) {\n            divClose.attachEvent(\"onclick\", function() {\n                document.getElementById(self._addUID(\"GPshowMousePositionPicto\")).click();\n            });\n        }\n\n        container.appendChild(divClose);\n\n        return container;\n    },\n\n    /**\n     * coordinate panel\n     *\n     * FIXME\n     * call this._createMousePositionPanelBasicCoordinateElement\n     * call this._createMousePositionPanelBasicAltitudeElement\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createMousePositionPanelBasicElement: function(displayAltitude, displayCoordinates, editCoordinates, currentProjectionUnits) {\n        var container = document.createElement(\"div\");\n        container.id = this._addUID(\"GPmousePositionBasicPanel\");\n\n        // FIXME on devrait decomposer la fonction pour les besoins du controle,\n        // on ajoutera ces childs  la main...\n        container.appendChild(this._createMousePositionPanelBasicCoordinateElement(displayCoordinates, editCoordinates, currentProjectionUnits));\n        container.appendChild(this._createMousePositionPanelEditToolsElement(editCoordinates));\n        container.appendChild(this._createMousePositionPanelBasicAltitudeElement(displayAltitude));\n\n        return container;\n    },\n\n    /**\n     * create coordinate elements\n     *\n     * @param {String} coordType - (\"Lon\" ou \"Lat\")\n     * @returns {Array}\n     */\n    _createCoordinateElement: function(coordType, editCoordinates) {\n        var context = this;\n\n        if ([\"Lon\", \"Lat\"].indexOf(coordType) === -1) {\n            return [];\n        }\n\n        var list = [];\n        var input = document.createElement(\"input\");\n        input.id = this._addUID(\"GPmousePosition\" + coordType);\n        input.title = editCoordinates === true ? \"Cliquer pour saisir des coordonnes\" : \"\";\n        input.readOnly = true;\n\n        if (editCoordinates) {\n            input.addEventListener(\"click\", function() {\n                context.onMousePositionEditModeClick(true);\n            });\n            input.addEventListener(\"change\", function(e) {\n                this.classList.remove(\"error\");\n                var valid = context.validateExtentCoordinate(coordType, this.value, e);\n                valid ? this.classList.remove(\"error\") : this.classList.add(\"error\");\n            });\n        }\n        list.push(input);\n\n        var span = document.createElement(\"span\");\n        span.className = \"GPmousePositionUnits\";\n        list.push(span);\n\n        return list;\n    },\n\n    /**\n     *\n     * @param {String} coordType - (\"Lon\" ou \"Lat\")\n     * @returns {Array}\n     */\n    _createDMSCoordinateElement: function(coordType, editCoordinates) {\n        if ([\"Lon\", \"Lat\"].indexOf(coordType) === -1) {\n            return [];\n        }\n\n        var context = this;\n\n        var list = [];\n\n        var input = document.createElement(\"input\");\n        input.id = this._addUID(\"GPmousePosition\" + coordType + \"Degrees\");\n        input.className = \"GPSexagesimal\";\n        input.setAttribute(\"name\", \"degrees\");\n        input.title = editCoordinates === true ? \"Cliquer pour saisir des coordonnes\" : \"\";\n        input.readOnly = true;\n        input.dataset.min = 0;\n        input.dataset.max = (coordType === \"Lon\") ? 180 : 90;\n        if (editCoordinates) {\n            input.addEventListener(\"click\", function() {\n                context.onMousePositionEditModeClick(true);\n            });\n            input.addEventListener(\"change\", function() {\n                this.classList.remove(\"error\");\n                var valid = context._checkDMSDegrees(coordType, this);\n                valid ? this.classList.remove(\"error\") : this.classList.add(\"error\");\n            });\n        }\n        list.push(input);\n\n        var span = document.createElement(\"span\");\n        span.className = \"GPmousePositionSexagesimalLabel\";\n        span.innerHTML = \"\";\n        list.push(span);\n\n        var input1 = document.createElement(\"input\");\n        input1.id = this._addUID(\"GPmousePosition\" + coordType + \"Minutes\");\n        input1.className = \"GPSexagesimal\";\n        input1.setAttribute(\"name\", \"minutes\");\n        input1.title = editCoordinates === true ? \"Cliquer pour saisir des coordonnes\" : \"\";\n        input1.readOnly = true;\n        input1.dataset.min = 0;\n        input1.dataset.max = 59;\n        if (editCoordinates) {\n            input1.addEventListener(\"click\", function() {\n                context.onMousePositionEditModeClick(true);\n            });\n            input1.addEventListener(\"change\", function() {\n                this.classList.remove(\"error\");\n                var valid = context._checkDMSElement(this);\n                valid ? this.classList.remove(\"error\") : this.classList.add(\"error\");\n            });\n        }\n        list.push(input1);\n\n        var span1 = document.createElement(\"span\");\n        span1.className = \"GPmousePositionSexagesimalLabel\";\n        span1.innerHTML = \"'\";\n        list.push(span1);\n\n        var input2 = document.createElement(\"input\");\n        input2.id = this._addUID(\"GPmousePosition\" + coordType + \"Seconds\");\n        input2.className = \"GPSexagesimalsec\";\n        input2.setAttribute(\"name\", \"seconds\");\n        input2.title = editCoordinates === true ? \"Cliquer pour saisir des coordonnes\" : \"\";\n        input2.readOnly = true;\n        input2.dataset.min = 0;\n        input2.dataset.max = 59;\n        if (editCoordinates) {\n            input2.addEventListener(\"click\", function() {\n                context.onMousePositionEditModeClick(true);\n            });\n            input2.addEventListener(\"change\", function() {\n                this.classList.remove(\"error\");\n                var valid = context._checkDMSElement(this, true);\n                valid ? this.classList.remove(\"error\") : this.classList.add(\"error\");\n            });\n        }\n        list.push(input2);\n\n        var span2 = document.createElement(\"span\");\n        span2.className = \"GPmousePositionSexagesimalLabel\";\n        span2.innerHTML = \"''\";\n        list.push(span2);\n\n        var select = document.createElement(\"select\");\n        select.id = this._addUID(\"GPmousePosition\" + coordType + \"Direction\");\n        select.className = \"GPmousePositionDirection\";\n        select.setAttribute(\"name\", \"direction\");\n        select.disabled = true;\n\n        var option = document.createElement(\"option\");\n        option.value = (coordType === \"Lon\") ? \"E\" : \"N\";\n        option.innerHTML = (coordType === \"Lon\") ? \"E\" : \"N\";\n        select.appendChild(option);\n\n        var option1 = document.createElement(\"option\");\n        option1.value = (coordType === \"Lon\") ? \"O\" : \"S\";\n        option1.innerHTML = (coordType === \"Lon\") ? \"O\" : \"S\";\n        select.appendChild(option1);\n        list.push(select);\n\n        return list;\n    },\n\n    /** ... */\n    _createMousePositionPanelBasicCoordinateElement: function(display, editCoordinates, currentProjectionUnits) {\n        var div = document.createElement(\"div\");\n        div.id = this._addUID(\"GPmousePositionCoordinate\");\n        div.style.display = display ? \"block\" : \"none\";\n\n        // latitude\n        var divLat = document.createElement(\"div\");\n\n        var spanLat = document.createElement(\"span\");\n        spanLat.className = \"GPmousePositionLabel\";\n        spanLat.id = this._addUID(\"GPmousePositionLatLabel\");\n        spanLat.innerHTML = \"Latitude : \";\n        divLat.appendChild(spanLat);\n\n        var span = document.createElement(\"span\");\n        span.id = this._addUID(\"GPmousePositionLatCoordinate\");\n\n        var arrayCoords;\n        if (currentProjectionUnits === \"DMS\") {\n            arrayCoords = this._createDMSCoordinateElement(\"Lat\", editCoordinates);\n        } else {\n            arrayCoords = this._createCoordinateElement(\"Lat\", editCoordinates);\n        }\n        for (var i = 0; i < arrayCoords.length; i++) {\n            span.appendChild(arrayCoords[i]);\n        }\n        divLat.appendChild(span);\n        div.appendChild(divLat);\n\n        // longitude\n        var divLon = document.createElement(\"div\");\n\n        var spanLon = document.createElement(\"span\");\n        spanLon.className = \"GPmousePositionLabel\";\n        spanLon.id = this._addUID(\"GPmousePositionLonLabel\");\n        spanLon.innerHTML = \"Longitude : \";\n        divLon.appendChild(spanLon);\n\n        var span1 = document.createElement(\"span\");\n        span1.id = this._addUID(\"GPmousePositionLonCoordinate\");\n\n        var arrayCoords1;\n        if (currentProjectionUnits === \"DMS\") {\n            arrayCoords1 = this._createDMSCoordinateElement(\"Lon\", editCoordinates);\n        } else {\n            arrayCoords1 = this._createCoordinateElement(\"Lon\", editCoordinates);\n        }\n        for (var j = 0; j < arrayCoords1.length; j++) {\n            span1.appendChild(arrayCoords1[j]);\n        }\n        divLon.appendChild(span1);\n        div.appendChild(divLon);\n\n        return div;\n    },\n\n    /** ... */\n    _createMousePositionPanelBasicAltitudeElement: function(display) {\n\n        var div = document.createElement(\"div\");\n        div.id = this._addUID(\"GPmousePositionAltitude\");\n        div.style.display = display ? \"block\" : \"none\";\n\n        var spanLabel = document.createElement(\"span\");\n        spanLabel.className = \"GPmousePositionLabel\";\n        spanLabel.innerHTML = \"Altitude : \";\n        div.appendChild(spanLabel);\n\n        var spanAlt = document.createElement(\"span\");\n        spanAlt.className = \"GPmousePositionCoords\";\n        spanAlt.id = this._addUID(\"GPmousePositionAlt\");\n        spanAlt.innerHTML = \"...\";\n        div.appendChild(spanAlt);\n\n        var spanUnits = document.createElement(\"span\");\n        spanUnits.className = \"GPmousePositionAltitudeUnits\";\n        spanUnits.innerHTML = \"m\";\n        div.appendChild(spanUnits);\n\n        return div;\n    },\n\n    /** ... */\n    _createMousePositionPanelEditToolsElement: function(editCoordinates) {\n        var context = this;\n\n        var div = document.createElement(\"div\");\n        div.className = \"GPmousePositionPanelEditTools\";\n        div.id = this._addUID(\"GPmousePositionPanelEditTools\");\n        if (!editCoordinates) {\n            div.style.display = \"none\";\n        }\n\n        var span1 = document.createElement(\"span\");\n        span1.className = \"GPmousePositionEditTool\";\n        span1.id = this._addUID(\"GPmousePositionLocate\");\n        span1.title = editCoordinates === true ? \"Cliquer pour saisir des coordonnes\" : \"\";\n        if (editCoordinates) {\n            span1.addEventListener(\"click\", function() {\n                context.onMousePositionEditModeLocateClick();\n            });\n        }\n        div.appendChild(span1);\n\n        var span2 = document.createElement(\"span\");\n        span2.className = \"GPmousePositionEditTool\";\n        span2.id = this._addUID(\"GPmousePositionCloseEdit\");\n        span2.title = \"Quitter la saisie des coordonnes\";\n        span2.style.display = \"none\";\n        if (editCoordinates) {\n            span2.addEventListener(\"click\", function() {\n                context.onMousePositionEditModeClick(false);\n            });\n        }\n        div.appendChild(span2);\n\n        return div;\n    },\n\n    // ################################################################### //\n    // #################### Settings container ########################### //\n    // ################################################################### //\n\n    /** ... */\n    _createShowMousePositionSettingsElement: function(display) {\n\n        var list = [];\n\n        var input = document.createElement(\"input\");\n        input.type = \"checkbox\";\n        input.id = this._addUID(\"GPshowMousePositionSettings\");\n\n        var label = document.createElement(\"label\");\n        label.id = this._addUID(\"GPshowMousePositionSettingsPicto\");\n        label.htmlFor = this._addUID(\"GPshowMousePositionSettings\");\n        label.title = \"Rglages\";\n        label.className = \"GPshowMoreOptions GPshowMousePositionSettingsPicto\"; // FIXME classname and id ?\n        label.style.display = display ? \"block\" : \"none\";\n\n        list.push(input);\n        list.push(label);\n\n        return list;\n    },\n\n    /**\n     * settings panel\n     *\n     * FIXME\n     * don't call this._createMousePositionSettingsSystemsElement\n     * don't call this._createMousePositionSettingsUnitsElement\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createMousePositionSettingsElement: function(display) {\n\n        var container = document.createElement(\"div\");\n        container.id = this._addUID(\"GPmousePositionSettings\");\n        container.style.display = (display === undefined || display) ? \"block\" : \"none\";\n\n        var span = document.createElement(\"span\");\n        span.className = \"GPmousePositionSettingsLabel\";\n        span.innerHTML = \"Systme de rfrence\";\n        container.appendChild(span);\n\n        // FIXME on decompose la fonction pour les besoins du controle,\n        // on ajoutera ces childs  la main...\n        // FIXME tableau statique !\n        // var systems = [\n        //     {\n        //         code : \"GEOGRAPHIC\",\n        //         label : \"Gographique\"\n        //     },\n        //     {\n        //         code : \"MERCATOR\",\n        //         label : \"Mercator\"\n        //     },\n        //     {\n        //         code : \"LAMB93\",\n        //         label : \"Lambert 93\"\n        //     },\n        //     {\n        //         code : \"LAMB2E\",\n        //         label : \"Lambert II tendu\"\n        //     }\n        // ];\n        //\n        // var selectSystem = this._createMousePositionSettingsSystemsElement(systems);\n        //\n        // container.appendChild(selectSystem);\n\n        // FIXME on decompose la fonction pour les besoins du controle,\n        // on ajoutera ces childs  la main...\n        // FIXME tableau statique !\n        // var units = [\n        //     {\n        //         code : \"DEC\",\n        //         label : \"degrs dcimaux\",\n        //     },\n        //     {\n        //         code : \"DMS\",\n        //         label : \"degrs sexagsimaux\",\n        //     },\n        //     {\n        //         code : \"RAD\",\n        //         label : \"radians\",\n        //     },\n        //     {\n        //         code : \"GON\",\n        //         label : \"grades\"\n        //     }\n        // ];\n        //\n        // var selectUnits = this._createMousePositionSettingsUnitsElement(units);\n        //\n        // container.appendChild(selectUnits);\n\n        return container;\n    },\n\n    /** ... */\n    _createMousePositionSettingsSystemsElement: function(systems) {\n\n        // contexte d'execution\n        var context = this;\n\n        var selectSystem = document.createElement(\"select\");\n        selectSystem.id = this._addUID(\"GPmousePositionProjectionSystem\");\n        selectSystem.className = \"GPinputSelect GPmousePositionSettingsSelect\";\n        selectSystem.addEventListener(\"change\", function(e) {\n            context.onMousePositionProjectionSystemChange(e);\n        });\n        selectSystem.addEventListener(\"mouseover\", function(e) {\n            context.onMousePositionProjectionSystemMouseOver(e);\n        });\n\n        for (var i = 0; i < systems.length; i++) {\n            var obj = systems[i];\n            var option = document.createElement(\"option\");\n            option.value = obj.code;\n            option.text = obj.label || i;\n            // option.label = obj.label;\n            selectSystem.appendChild(option);\n        }\n\n        return selectSystem;\n    },\n\n    /** ... */\n    _createMousePositionSettingsUnitsElement: function(units) {\n\n        // contexte d'execution\n        var context = this;\n\n        var selectUnits = document.createElement(\"select\");\n        selectUnits.id = this._addUID(\"GPmousePositionProjectionUnits\");\n        selectUnits.className = \"GPinputSelect GPmousePositionSettingsSelect\";\n        selectUnits.addEventListener(\"change\", function(e) {\n            context.onMousePositionProjectionUnitsChange(e);\n        });\n\n        for (var j = 0; j < units.length; j++) {\n            var obj = units[j];\n            var option = document.createElement(\"option\");\n            option.value = (obj.code) ? obj.code : j;\n            option.text = obj.label || j;\n            // option.label = obj.label;\n            selectUnits.appendChild(option);\n        }\n\n        return selectUnits;\n    },\n\n    /** ... **/\n    _resetLabelElements: function(currentProjectionType) {\n        // Changement des labels dans le formulaire de saisie\n        var spanLat = document.getElementById(this._addUID(\"GPmousePositionLatLabel\"));\n        spanLat.innerHTML = currentProjectionType === \"Geographical\" ? \"Latitude :\" : \"X :\";\n\n        var spanLon = document.getElementById(this._addUID(\"GPmousePositionLonLabel\"));\n        spanLon.innerHTML = currentProjectionType === \"Geographical\" ? \"Longitude :\" : \"Y :\";\n    },\n\n    /** ... **/\n    _resetUnitElements: function(currentProjectionUnits) {\n        var value = \"\";\n        if (currentProjectionUnits === \"M\" || currentProjectionUnits === \"KM\") {\n            value = currentProjectionUnits.toLowerCase();\n        }\n\n        var elts = document.getElementsByClassName(\"GPmousePositionUnits\");\n        for (var e = 0; e < elts.length; e++) {\n            elts[e].innerHTML = value;\n        }\n    },\n\n    /**\n     * @method _resetCoordinateElements\n     * @param {Boolean} editCoordinates - edit coordinates option\n     * @param {String} currentProjectionType - current projection type\n     * @param {String} currentProjectionUnits - current projection unit\n     */\n    _resetCoordinateElements: function(editCoordinates, currentProjectionType, currentProjectionUnits) {\n        // Suppression de tous les enfants de GPmousePositionLatCoordinate\n        var latElt = document.getElementById(this._addUID(\"GPmousePositionLatCoordinate\"));\n        while (latElt.firstChild) {\n            latElt.removeChild(latElt.firstChild);\n        }\n\n        var arrayCoords;\n        if (currentProjectionUnits === \"DMS\") {\n            arrayCoords = this._createDMSCoordinateElement(\"Lat\", editCoordinates);\n        } else {\n            arrayCoords = this._createCoordinateElement(\"Lat\", editCoordinates);\n        }\n        for (var i = 0; i < arrayCoords.length; i++) {\n            latElt.appendChild(arrayCoords[i]);\n        }\n\n        // Suppression de tous les enfants de GPmousePositionLonCoordinate\n        var lonElt = document.getElementById(this._addUID(\"GPmousePositionLonCoordinate\"));\n        while (lonElt.firstChild) {\n            lonElt.removeChild(lonElt.firstChild);\n        }\n\n        var arrayCoords1;\n        if (currentProjectionUnits === \"DMS\") {\n            arrayCoords1 = this._createDMSCoordinateElement(\"Lon\", editCoordinates);\n        } else {\n            arrayCoords1 = this._createCoordinateElement(\"Lon\", editCoordinates);\n        }\n        for (var j = 0; j < arrayCoords1.length; j++) {\n            lonElt.appendChild(arrayCoords1[j]);\n        }\n\n        // on simule un deplacement\n        this.onMapMove();\n    },\n\n    /**\n     * Set/unset editing mode\n     *\n     * @method _setEditMode\n     * @param {Boolean} editing - active edit coordinates mode\n     */\n    _setEditMode: function(editing) {\n        var locateElt = document.getElementById(this._addUID(\"GPmousePositionLocate\"));\n        locateElt.title = editing ? \"Aller  la position ...\" : \"Cliquer pour saisir des coordonnes\";\n\n        var closeEditElt = document.getElementById(this._addUID(\"GPmousePositionCloseEdit\"));\n        closeEditElt.style.display = editing ? \"inline-block\" : \"none\";\n\n        var selector = \"div[id^=\" + this._addUID(\"GPmousePositionCoordinate\") + \"]\";\n        var inputs = document.querySelectorAll(selector + \" input\");\n        for (var i = 0; i < inputs.length; i++) {\n            inputs[i].readOnly = !editing;\n            if (editing) {\n                inputs[i].value = \"\";\n                inputs[i].classList.remove(\"error\");\n            }\n        }\n        var selects = document.querySelectorAll(selector + \" select\");\n        for (var j = 0; j < selects.length; j++) {\n            selects[j].disabled = !editing;\n        }\n    },\n\n    /**\n     *\n     * @param {DOMElement} input - input element\n     * @param {Boolean} isFloat - check for float value\n     * @returns {Boolean}\n     */\n    _checkDMSElement: function(input, isFloat) {\n        var b = (isFloat === undefined) ? false : true;\n\n        var value = input.value;\n        if (b) {\n            value = value.replace(\",\", \".\");\n        }\n        if (isNaN(value)) {\n            return false;\n        }\n\n        var v = parseFloat(value);\n        if (!b && (v | 0) !== v) { // is it an integer\n            return false;\n        }\n\n        var min = Number(input.dataset.min);\n        var max = Number(input.dataset.max);\n        return (v >= min && v <= max);\n    },\n\n    /**\n     * @param {String} coordType - \"Lon\" or \"Lat\"\n     * @param {DOMElement} input - input element\n     * @returns {Boolean}\n     */\n    _checkDMSDegrees: function(coordType, input) {\n        if (isNaN(input.value)) {\n            return false;\n        }\n\n        var v = parseFloat(input.value);\n        if ((v | 0) !== v) { // is it an integer\n            return false;\n        }\n\n        var min = Number(input.dataset.min);\n        var max = Number(input.dataset.max);\n        if (v < min || v > max) {\n            return false;\n        }\n\n        var inputMinutes = document.getElementById(this._addUID(\"GPmousePosition\" + coordType + \"Minutes\"));\n        var inputSeconds = document.getElementById(this._addUID(\"GPmousePosition\" + coordType + \"Seconds\"));\n\n        if (v >= max) {\n            inputMinutes.dataset.max = 0;\n            inputSeconds.dataset.max = 0;\n        } else {\n            inputMinutes.dataset.max = 59;\n            inputSeconds.dataset.max = 59.9999;\n        }\n\n        return true;\n    },\n\n    // ################################################################### //\n    // ####################### handlers Event ############################ //\n    // ################################################################### //\n\n    /**\n     * Function displaying coordinates from cursor position (desktop)\n     * or map center (tactile)\n     */\n    GPdisplayCoords: function(coordinate) {\n\n        // Compute coords in case of cursor position (desktop)\n        if (coordinate && coordinate != null) {\n\n            var labelLon = document.getElementById(this._addUID(\"GPmousePositionLonLabel\"));\n            var labelLat = document.getElementById(this._addUID(\"GPmousePositionLatLabel\"));\n\n            if (coordinate.x || coordinate.y) {\n                labelLat.innerHTML = \"X : \";\n                labelLon.innerHTML = \"Y : \";\n            } else if (coordinate.e || coordinate.n) {\n                labelLat.innerHTML = \"E : \";\n                labelLon.innerHTML = \"N : \";\n            } else {\n                labelLat.innerHTML = \"Latitude : \";\n                labelLon.innerHTML = \"Longitude : \";\n            }\n\n            if (typeof coordinate.lat === \"object\" && typeof coordinate.lng === \"object\") {\n                var parts = {\n                    lng: \"Lon\",\n                    lat: \"Lat\"\n                };\n                var units = [\"Degrees\", \"Minutes\", \"Seconds\"];\n                for (var p in parts) {\n                    for (var u = 0; u < units.length; ++u) {\n                        var selector = \"GPmousePosition\" + parts[p] + units[u];\n                        var elt = document.getElementById(this._addUID(selector));\n                        var key = units[u].charAt(0).toLowerCase();\n                        elt.value = coordinate[p][key];\n                    }\n                }\n                // directions\n                document.getElementById(this._addUID(\"GPmousePositionLonDirection\")).value = coordinate.lng.direction;\n                document.getElementById(this._addUID(\"GPmousePositionLatDirection\")).value = coordinate.lat.direction;\n            } else {\n                var elLat = document.getElementById(this._addUID(\"GPmousePositionLat\"));\n                var elLon = document.getElementById(this._addUID(\"GPmousePositionLon\"));\n\n                elLat.value = coordinate.x || coordinate.lat || coordinate.e || \"0\";\n                elLon.value = coordinate.y || coordinate.lng || coordinate.lon || coordinate.n || \"0\";\n\n                // les unites\n                var unit = (coordinate.unit === undefined) ? \"\" : coordinate.unit;\n                var elements = document.getElementsByClassName(\"GPmousePositionUnits\");\n                for (var n = 0; n < elements.length; ++n) {\n                    elements[n].innerHTML = unit;\n                }\n            }\n        }\n    },\n\n    /**\n     * Function displaying altitude from cursor position (desktop)\n     * or map center (tactile)\n     */\n    GPdisplayElevation: function(coordinate, altitudeTimeoutDelay, noDataValue, noDataValueTolerance) {\n\n        // contexte d'execution\n        var self = this;\n\n        // Latency for altitude request\n        var altitudeTimeout;\n        if (!altitudeTimeoutDelay) {\n            altitudeTimeoutDelay = 500;\n        }\n\n        clearTimeout(altitudeTimeout);\n        document.getElementById(this._addUID(\"GPmousePositionAlt\")).innerHTML = \"...\";\n\n        if (noDataValue == null) {\n            noDataValue = -99999;\n        }\n        if (noDataValueTolerance == null) {\n            noDataValueTolerance = 99980;\n        }\n        var maxThreshold = noDataValue + noDataValueTolerance;\n        var minThreshold = noDataValue - noDataValueTolerance;\n\n        // Compute coords in case of cursor position (desktop)\n        if (coordinate && coordinate != null) {\n\n            // If no altitude panel, don't call altitude request\n            if (document.getElementById(this._addUID(\"GPmousePositionAltitude\"))) {\n                altitudeTimeout = setTimeout(function() {\n                    self.onRequestAltitude(coordinate, function(z) {\n                        if (minThreshold < z && z < maxThreshold) {\n                            self.GPresetElevation();\n                        } else {\n                            document.getElementById(self._addUID(\"GPmousePositionAlt\")).innerHTML = z;\n                        }\n                    });\n                }, altitudeTimeoutDelay);\n            }\n\n        }\n    },\n\n    /**\n     * Function reseting altitude value\n     */\n    GPresetElevation: function() {\n        if (document.getElementById(this._addUID(\"GPmousePositionAltitude\"))) {\n            document.getElementById(this._addUID(\"GPmousePositionAlt\")).innerHTML = \"---\";\n        }\n    }\n};\n\nexport default MousePositionDOM;\n\n\n\n// WEBPACK FOOTER //\n// ./src/Common/Controls/MousePositionDOM.js","import Sortable from \"sortable\";\n\nvar LayerSwitcherDOM = {\n\n    /**\n     * Creation du drag and drop\n     *\n     * @param {Object} elementDraggable - Element HTML (DOM) Container\n     * @param {Object} context - this\n     */\n    _createDraggableElement: function(elementDraggable, context) {\n        Sortable.create(elementDraggable, {\n            handle: \".GPlayerName\",\n            draggable: \".draggable-layer\",\n            ghostClass: \"GPghostLayer\",\n            animation: 200,\n            /** Call event function on drag and drop */\n            onEnd: function(e) {\n                // FIXME pas terrrible, mais il faut bien passer ce contexte...\n                context._onDragAndDropLayerClick(e);\n            }\n        });\n    },\n\n    // ################################################################### //\n    // ######################### Main container ########################## //\n    // ################################################################### //\n\n    /** Add uuid to the tag ID */\n    _addUID: function(id) {\n        var uid = (this._uid) ? id + \"-\" + this._uid : id;\n        return uid;\n    },\n\n    /**\n     * Creation du container principal (DOM)\n     *\n     * @returns {DOMElement} container - layer switcher DOM element\n     */\n    _createMainContainerElement: function() {\n\n        var container = document.createElement(\"div\");\n        container.id = this._addUID(\"GPlayerSwitcher\");\n        container.className = \"GPwidget\";\n        return container;\n    },\n\n    /**\n     * Creation du container principal d\"affichage des layers (DOM)\n     */\n    _createMainLayersShowElement: function() {\n        // <!-- Hidden checkbox for minimizing/maximizing -->\n        var input = document.createElement(\"input\");\n        input.id = this._addUID(\"GPshowLayersList\");\n        input.type = \"checkbox\";\n        return input;\n    },\n\n    /**\n     * Creation du container principal des layers (DOM)\n     */\n    _createMainLayersElement: function() {\n        // ajout de la liste des layers dans le container principal\n        // <div id=\"GPlayersList\" class=\"GPpanel\">\n        //   (...)\n        // </div>\n        var div = document.createElement(\"div\");\n        div.id = this._addUID(\"GPlayersList\");\n        div.className = \"GPpanel\";\n        return div;\n    },\n\n    /**\n     * Creation du container du picto du controle (DOM)\n     */\n    _createMainPictoElement: function() {\n\n        var self = this;\n\n        // exemple :\n        // <!-- Label for minimizing/maximizing -->\n        // <label id=\"GPshowLayersListPicto\" class=\"GPshowAdvancedToolPicto\" for=\"GPshowLayersList\" title=\"Afficher/masquer le gestionnaire de couches\">\n        //    <span id=\"GPshowLayersListOpen\" class=\"GPshowAdvancedToolOpen\"></span><span id=\"GPshowLayersListClose\"></span>\n        // </label>\n\n        var label = document.createElement(\"label\");\n        label.id = this._addUID(\"GPshowLayersListPicto\");\n        label.className = \"GPshowAdvancedToolPicto\";\n        label.htmlFor = this._addUID(\"GPshowLayersList\");\n        label.title = \"Afficher/masquer le gestionnaire de couches\";\n\n        var spanOpen = document.createElement(\"span\");\n        spanOpen.id = this._addUID(\"GPshowLayersListOpen\");\n        spanOpen.className = \"GPshowAdvancedToolOpen\";\n        spanOpen.addEventListener(\"click\", function() {\n            if (document.getElementById(self._addUID(\"GPshowLayersList\")).checked) {\n                var layers = document.getElementsByClassName(\"GPlayerInfoOpened\");\n                for (var i = 0; i < layers.length; i++) {\n                    layers[i].className = \"GPlayerInfo\";\n                }\n                document.getElementById(self._addUID(\"GPlayerInfoPanel\")).className = \"GPlayerInfoPanelClosed\";\n            }\n        });\n\n        label.appendChild(spanOpen);\n\n        var spanClose = document.createElement(\"span\");\n        spanClose.addEventListener(\"click\", function() {\n            if (document.getElementById(self._addUID(\"GPshowLayersList\")).checked) {\n                var layers = document.getElementsByClassName(\"GPlayerInfoOpened\");\n                for (var i = 0; i < layers.length; i++) {\n                    layers[i].className = \"GPlayerInfo\";\n                }\n                document.getElementById(self._addUID(\"GPlayerInfoPanel\")).className = \"GPlayerInfoPanelClosed\";\n            }\n        });\n        spanClose.id = self._addUID(\"GPshowLayersListClose\");\n\n        label.appendChild(spanClose);\n\n        return label;\n    },\n\n    /**\n     * Creation du container du panneau d\"information (DOM)\n     */\n    _createMainInfoElement: function() {\n        // gestion du panneau d\"information dans le container principal\n        // <div id=\"GPlayerInfoPanel\" class=\"GPlayerInfoPanelClosed\">...</div>\n        var div = document.createElement(\"div\");\n        div.id = this._addUID(\"GPlayerInfoPanel\");\n        div.className = \"GPpanel GPlayerInfoPanelClosed\";\n        return div;\n    },\n\n    // ################################################################### //\n    // ######################### Layer container ######################### //\n    // ################################################################### //\n\n    /**\n     * Creation du container du layer (DOM)\n     *\n     * @param {Object} obj - options de la couche  ajouter dans le layer switcher\n     * @param {Object} obj.layer - couche (ol3 ou leaflet)\n     * @param {String} obj.id - identifiant de la couche (pour ol3 ou leaflet)\n     * @param {String} obj.title - nom de la couche  afficher dans le controle\n     * @param {String} obj.description - description de la couche  afficher\n     * @param {Boolean} obj.visibility - visibilit de la couche dans la carte (true or false)\n     * @param {Float} obj.opacity - opacit de la couche\n     *\n     */\n    _createContainerLayerElement: function(obj) {\n\n        // exemple :\n        // <div id=\"GPlayerSwitcher_ID_Layer1\" class=\"GPlayerSwitcher_layer outOfRange\">\n        //     <!-- Basic toolbar : visibility / layer name\n        //     _createBasicToolElement\n        //           _createBasicToolVisibilityElement\n        //           _createBasicToolNameElement\n        //     -->\n        //     <!-- Hidden checkbox + label for showing advanced toolbar\n        //     _createAdvancedToolShowElement\n        //     -->\n        //     <!-- Advanced toolbar : layer info / opacity slider / opacity value / removal\n        //     _createAdvancedToolElement\n        //           _createAdvancedToolDeleteElement\n        //           _createAdvancedToolInformationElement\n        //           _createAdvancedToolOpacityElement\n        //     -->\n        // </div>\n\n        // <!-- Layer entry in layer list -->\n        // <!-- Every item is marked with layerID, which is defined at layer import -->\n        var container = document.createElement(\"div\");\n        container.id = this._addUID(\"GPlayerSwitcher_ID_\" + obj.id);\n        container.className = \"GPlayerSwitcher_layer draggable-layer\";\n\n        // ajout des outils basiques (visibility / layer name)\n        container.appendChild(this._createBasicToolElement(obj));\n\n        // liste des outils avancs (layer info / opacity slider / opacity value / removal)\n        var array = this._createAdvancedToolShowElement(obj);\n        for (var i = 0; i < array.length; i++) {\n            container.appendChild(array[i]);\n        }\n\n        // ajout des outils avancs\n        container.appendChild(this._createAdvancedToolElement(obj));\n\n        return container;\n    },\n\n    // ################################################################### //\n    // ############################ Layer tool ########################### //\n    // ################################################################### //\n\n    /**\n     * Creation du container des outils basiques du layer (DOM)\n     *\n     * @param {Object} obj - options de la couche  ajouter dans le layer switcher\n     */\n    _createBasicToolElement: function(obj) {\n        // exemple :\n        // <div id=\"GPbasicTools_ID_1\" class=\"GPlayerBasicTools\">\n        //      <!-- _createBasicToolVisibilityElement -->\n        //      <!-- _createBasicToolNameElement -->\n        // </div>\n\n        var div = document.createElement(\"div\");\n        div.id = this._addUID(\"GPbasicTools_ID_\" + obj.id);\n        div.className = \"GPlayerBasicTools\";\n\n        div.appendChild(this._createBasicToolNameElement(obj));\n\n        var array = this._createBasicToolVisibilityElement(obj);\n        for (var i = 0; i < array.length; i++) {\n            div.appendChild(array[i]);\n        }\n\n        return div;\n    },\n\n    /**\n     * Creation du nom du layer (DOM)\n     *\n     * @param {Object} obj - options de la couche  ajouter dans le layer switcher\n     */\n    _createBasicToolNameElement: function(obj) {\n        // exemple :\n        // <span id=\"GPname_ID_Layer1\" class=\"GPlayerName\" title=\"Quartiers prioritaires de la ville\">Quartiers prioritaires de la ville</span>\n        var span = document.createElement(\"span\");\n        span.id = this._addUID(\"GPname_ID_\" + obj.id);\n        span.className = \"GPlayerName\";\n        span.title = obj.description || obj.title;\n        span.innerHTML = obj.title;\n\n        return span;\n    },\n\n    /**\n     * Creation de l'icone de visibilit du layer (DOM)\n     *\n     * @param {Object} obj - options de la couche  ajouter dans le layer switcher\n     */\n    _createBasicToolVisibilityElement: function(obj) {\n        // exemple :\n        // <input type=\"checkbox\" id=\"GPvisibility_ID_Layer1\" checked=\"\">\n        // <label for=\"GPvisibility_ID_Layer1\" id=\"GPvisibilityPicto_ID_Layer1\" class=\"GPlayerVisibility\" title=\"Afficher/masquer la couche\"></label>\n\n        var list = [];\n\n        var checked = (typeof obj.visibility !== \"undefined\") ? obj.visibility : true;\n        var id = this._addUID(\"GPvisibility_ID_\" + obj.id);\n\n        var input = document.createElement(\"input\");\n        input.id = id;\n        input.type = \"checkbox\";\n        input.checked = checked;\n\n        var label = document.createElement(\"label\");\n        label.htmlFor = id;\n        label.id = this._addUID(\"GPvisibilityPicto_ID_\" + obj.id);\n        label.className = \"GPlayerVisibility\";\n        label.title = \"Afficher/masquer la couche\";\n\n        // add event for visibility change\n        var context = this;\n        if (input.addEventListener) {\n            input.addEventListener(\n                \"click\",\n                function(e) {\n                    context._onVisibilityLayerClick.call(context, e);\n                }\n            );\n        } else if (input.attachEvent) {\n            // internet explorer\n            input.attachEvent(\n                \"onclick\",\n                function(e) {\n                    context._onVisibilityLayerClick.call(context, e);\n                }\n            );\n        }\n\n        list.push(input);\n        list.push(label);\n\n        return list;\n    },\n\n    /**\n     * Creation de l'affichage du menu des outils avancs du layer (DOM)\n     *\n     * @param {Object} obj - options de la couche  ajouter dans le layer switcher\n     */\n    _createAdvancedToolShowElement: function(obj) {\n        // <input type=\"checkbox\" id=\"GPshowAdvancedTools_ID_Layer1\">\n        // <label for=\"GPshowAdvancedTools_ID_Layer1\" id=\"GPshowAdvancedToolsPicto_ID_Layer1\" class=\"GPshowMoreOptions GPshowLayerAdvancedTools\" title=\"Plus d'outils\"></label>\n\n        var list = [];\n\n        var label = document.createElement(\"label\");\n        label.id = this._addUID(\"GPshowAdvancedToolsPicto_ID_\" + obj.id);\n        label.htmlFor = this._addUID(\"GPshowAdvancedTools_ID_\" + obj.id);\n        label.title = \"Plus d'outils\";\n        label.className = \"GPshowMoreOptions GPshowLayerAdvancedTools\";\n\n        var input = document.createElement(\"input\");\n        input.type = \"checkbox\";\n        input.id = this._addUID(\"GPshowAdvancedTools_ID_\" + obj.id);\n\n        list.push(input);\n        list.push(label);\n\n        return list;\n    },\n\n    /**\n     * Creation du container des outils avancs du layer (DOM)\n     *\n     * @param {Object} obj - options de la couche  ajouter dans le layer switcher\n     */\n    _createAdvancedToolElement: function(obj) {\n\n        // exemple :\n        // <div id=\"GPadvancedTools_ID_Layer1\" class=\"GPlayerAdvancedTools\">\n        //     <!-- _createAdvancedToolDeleteElement -->\n        //     <!-- _createAdvancedToolInformationElement -->\n        //     <!-- _createAdvancedToolOpacityElement -->\n        // </div>\n\n        var container = document.createElement(\"div\");\n        container.id = this._addUID(\"GPadvancedTools_ID_\" + obj.id);\n        container.className = \"GPlayerAdvancedTools\";\n\n        container.appendChild(this._createAdvancedToolDeleteElement(obj));\n\n        // si on n'a de l'informations  afficher, on met en place ce composant\n        if (obj.title && obj.description) {\n            container.appendChild(this._createAdvancedToolInformationElement(obj));\n        }\n        if (obj.type !== \"feature\") {\n            var array = this._createAdvancedToolOpacityElement(obj);\n            for (var i = 0; i < array.length; i++) {\n                container.appendChild(array[i]);\n            }\n        }\n\n        return container;\n\n    },\n\n    /**\n     * Creation de l'icone de suppression du layer (DOM)\n     *\n     * @param {Object} obj - options de la couche  ajouter dans le layer switcher\n     */\n    _createAdvancedToolDeleteElement: function(obj) {\n\n        // exemple :\n        // <div id=\"GPremove_ID_Layer1\" class=\"GPlayerRemove\" title=\"Supprimer la couche\" onclick=\"GPdropLayer(this);\"></div>\n\n        var div = document.createElement(\"div\");\n        div.id = this._addUID(\"GPremove_ID_\" + obj.id);\n        div.className = \"GPlayerRemove\";\n        div.title = \"Supprimer la couche\";\n        div.layerId = obj.id;\n\n        var context = this;\n        if (div.addEventListener) {\n            div.addEventListener(\n                \"click\",\n                function(e) {\n                    context._onDropLayerClick.call(context, e);\n                }\n            );\n        } else if (div.attachEvent) {\n            // internet explorer\n            div.attachEvent(\n                \"onclick\",\n                function(e) {\n                    context._onDropLayerClick.call(context, e);\n                }\n            );\n        }\n\n        return div;\n    },\n\n    /**\n     * Creation de l'icone d'information du layer (DOM)\n     *\n     * @param {Object} obj - options de la couche  ajouter dans le layer switcher\n     */\n    _createAdvancedToolInformationElement: function(obj) {\n\n        // exemple :\n        // <div id=\"GPinfo_ID_Layer1\" class=\"GPlayerInfo\" title=\"Informations/lgende\" onclick=\"GPopenLayerInfo(this);\"></div>\n\n        var div = document.createElement(\"div\");\n        div.id = this._addUID(\"GPinfo_ID_\" + obj.id);\n        div.className = \"GPlayerInfo\";\n        div.title = \"Informations/lgende\";\n        div.layerId = obj.id;\n        // add event on click\n        var context = this;\n        if (div.addEventListener) {\n            div.addEventListener(\n                \"click\",\n                function(e) {\n                    context._onOpenLayerInfoClick.call(context, e);\n                }\n            );\n        } else if (div.attachEvent) {\n            // internet explorer\n            div.attachEvent(\n                \"onclick\",\n                function(e) {\n                    context._onOpenLayerInfoClick.call(context, e);\n                }\n            );\n        }\n\n        return div;\n    },\n\n    /**\n     * Creation de l'icone de gestion de l'opacit du layer (DOM)\n     *\n     * @param {Object} obj - options de la couche  ajouter dans le layer switcher\n     */\n    _createAdvancedToolOpacityElement: function(obj) {\n\n        // exemple :\n        // <div id=\"GPopacity_ID_Layer1\" class=\"GPlayerOpacity\" title=\"Opacit\">\n        //   <input id=\"GPopacityRange_ID_Layer1\" type=\"range\" value=\"100\" oninput=\"GPchangeLayerOpacity(this);\" onchange=\"GPchangeLayerOpacity(this);\">\n        // </div>\n        // <div class=\"GPlayerOpacityValue\" id=\"GPopacityValueDiv_ID_Layer1\">\n        //   <span id=\"GPopacityValue_ID_Layer1\">100</span>\n        //   %\n        // </div>\n\n        var list = [];\n\n        // curseur pour changer l'opacit\n        var divO = document.createElement(\"div\");\n        divO.id = this._addUID(\"GPopacity_ID_\" + obj.id);\n        divO.className = \"GPlayerOpacity\";\n        divO.title = \"Opacit\";\n\n        var opacity = (typeof obj.opacity !== \"undefined\") ? obj.opacity : 1;\n        opacity = Math.round(opacity * 100);\n\n        var input = document.createElement(\"input\");\n        input.id = this._addUID(\"GPopacityValueDiv_ID_\" + obj.id);\n        input.type = \"range\";\n        input.value = opacity;\n\n        // add event for opacity change\n        var context = this;\n        if (input.addEventListener) {\n            input.addEventListener(\n                \"change\",\n                function(e) {\n                    context._onChangeLayerOpacity.call(context, e);\n                }\n            );\n        } else if (input.attachEvent) {\n            // internet explorer\n            input.attachEvent(\n                \"onchange\",\n                function(e) {\n                    context._onChangeLayerOpacity.call(context, e);\n                }\n            );\n        }\n\n        if (input.addEventListener) {\n            input.addEventListener(\n                \"input\",\n                function(e) {\n                    context._onChangeLayerOpacity.call(context, e);\n                }\n            );\n        } else if (input.attachEvent) {\n            // internet explorer\n            input.attachEvent(\n                \"oninput\",\n                function(e) {\n                    context._onChangeLayerOpacity.call(context, e);\n                }\n            );\n        }\n\n        divO.appendChild(input);\n\n        // Valeur d'opacit\n        var divC = document.createElement(\"div\");\n        divC.id = this._addUID(\"GPopacityValueDiv_ID_\" + obj.id);\n        divC.className = \"GPlayerOpacityValue\";\n\n        var span = document.createElement(\"span\");\n        span.id = this._addUID(\"GPopacityValue_ID_\" + obj.id);\n        span.innerHTML = opacity + \"%\";\n\n        divC.appendChild(span);\n\n        list.push(divO);\n        list.push(divC);\n\n        return list;\n    },\n\n    // ################################################################### //\n    // ############################ Layer info ########################### //\n    // ################################################################### //\n\n    /**\n     * Creation du container du layer info (DOM)\n     *\n     * TODO GPlayerInfoPopup : ???\n     * TODO GPlayerInfoLink  : mettre en forme les chelles !\n     *\n     * @param {Object} obj - options de la couche  ajouter dans le layer switcher\n     */\n    _createContainerLayerInfoElement: function(obj) {\n\n        var container = document.createElement(\"div\");\n        container.id = this._addUID(\"GPlayerInfoContent\");\n\n        var title = document.createElement(\"div\");\n        title.id = this._addUID(\"GPlayerInfoTitle\");\n        title.innerHTML = obj.title;\n        container.appendChild(title);\n\n        if (obj.quicklookUrl) {\n\n            var quick = document.createElement(\"div\");\n            quick.id = this._addUID(\"GPlayerInfoQuicklook\");\n            quick.title = \"Afficher un aperu de la couche\";\n            var refquick = document.createElement(\"a\");\n            refquick.href = obj.quicklookUrl;\n            refquick.appendChild(quick);\n            container.appendChild(refquick);\n        }\n\n        var close = document.createElement(\"div\");\n        close.id = this._addUID(\"GPlayerInfoClose\");\n        close.title = \"Fermer la fentre\";\n\n        var self = this;\n        /** Call event function on close click */\n        var onCloseClick = function() {\n            document.getElementById(self._addUID(\"GPlayerInfoPanel\")).className = \"GPlayerInfoPanelClosed\";\n            var layers = document.getElementsByClassName(\"GPlayerInfoOpened\");\n            for (var i = 0; i < layers.length; i++) {\n                layers[i].className = \"GPlayerInfo\";\n            }\n        };\n        if (close.addEventListener) {\n            close.addEventListener(\"click\", onCloseClick);\n        } else if (close.attachEvent) {\n            // internet explorer\n            close.attachEvent(\"onclick\", onCloseClick);\n        }\n        container.appendChild(close);\n\n        var desc = document.createElement(\"div\");\n        desc.id = this._addUID(\"GPlayerInfoDescription\");\n        desc.innerHTML = obj.description;\n        container.appendChild(desc);\n\n        if (obj.metadata) {\n\n            var mtd = document.createElement(\"div\");\n            mtd.id = this._addUID(\"GPlayerInfoMetadata\");\n\n            var mtdtitle = document.createElement(\"div\");\n            mtdtitle.className = \"GPlayerInfoSubtitle\";\n            mtdtitle.innerHTML = \"Mtadonnes\";\n            mtd.appendChild(mtdtitle);\n\n            for (var i = 0; i < obj.metadata.length; i++) {\n\n                var urlmtd = obj.metadata[i].url;\n\n                var mtdlink = document.createElement(\"div\");\n                mtdlink.className = \"GPlayerInfoLink\";\n\n                var refmtd = document.createElement(\"a\");\n                refmtd.href = urlmtd;\n                refmtd.innerHTML = urlmtd;\n                mtdlink.appendChild(refmtd);\n                mtd.appendChild(mtdlink);\n            }\n\n            if (obj.metadata.length !== 0) {\n                container.appendChild(mtd);\n            }\n        }\n\n        if (obj.legends) {\n\n            var lgd = document.createElement(\"div\");\n            lgd.id = this._addUID(\"GPlayerInfoLegend\");\n\n            var lgdtitle = document.createElement(\"div\");\n            lgdtitle.className = \"GPlayerInfoSubtitle\";\n            lgdtitle.innerHTML = \"Lgende\";\n            lgd.appendChild(lgdtitle);\n\n            var legends = {};\n            var maxScale = obj.maxScaleDenominator || 560000000;\n\n            // on cre un tableau temporaire pour ordonner les lgendes selon le dnominateur d'chelle\n            for (var k = 0; k < obj.legends.length; k++) {\n                var minScale = obj.legends[k].minScaleDenominator;\n                if (minScale) {\n                    var s = minScale.toString();\n                    minScale = Math.round(parseInt(s.substring(0, 3), 10) / 10) * Math.pow(10, s.length - 2);\n                } else {\n                    minScale = 270;\n                }\n                legends[minScale] = obj.legends[k];\n            }\n\n            for (var scale in legends) {\n                if (legends.hasOwnProperty(scale)) {\n                    var urllgd = legends[scale].url;\n                    // on n'affiche pas les lgendes pointant vers \"nolegend.jpg\"\n                    if (typeof urllgd === \"string\" && urllgd.toLowerCase().indexOf(\"nolegend.jpg\") == -1) {\n                        // TODO GPlayerInfoPopup\n                        var lgdlink = document.createElement(\"div\");\n                        lgdlink.className = \"GPlayerInfoLink\";\n\n                        maxScale = legends[scale].maxScaleDenominator || maxScale;\n\n                        var reflgd = document.createElement(\"a\");\n                        reflgd.href = urllgd;\n                        reflgd.innerHTML = \"Du 1/\" + scale + \" au 1/\" + maxScale;\n                        lgdlink.appendChild(reflgd);\n                        lgd.appendChild(lgdlink);\n                    } else {\n                        delete legends[scale];\n                    }\n                }\n            }\n\n            if (Object.keys(legends).length !== 0) {\n                container.appendChild(lgd);\n            }\n        }\n\n        return container;\n    }\n};\n\nexport default LayerSwitcherDOM;\n\n\n\n// WEBPACK FOOTER //\n// ./src/Common/Controls/LayerSwitcherDOM.js","/**!\n * Sortable\n * @author\tRubaXa   <trash@rubaxa.org>\n * @license MIT\n */\n\n\n(function (factory) {\n\t\"use strict\";\n\n\tif (typeof define === \"function\" && define.amd) {\n\t\tdefine(factory);\n\t}\n\telse if (typeof module != \"undefined\" && typeof module.exports != \"undefined\") {\n\t\tmodule.exports = factory();\n\t}\n\telse if (typeof Package !== \"undefined\") {\n\t\tSortable = factory();  // export for Meteor.js\n\t}\n\telse {\n\t\t/* jshint sub:true */\n\t\twindow[\"Sortable\"] = factory();\n\t}\n})(function () {\n\t\"use strict\";\n\n\tvar dragEl,\n\t\tparentEl,\n\t\tghostEl,\n\t\tcloneEl,\n\t\trootEl,\n\t\tnextEl,\n\n\t\tscrollEl,\n\t\tscrollParentEl,\n\n\t\tlastEl,\n\t\tlastCSS,\n\t\tlastParentCSS,\n\n\t\toldIndex,\n\t\tnewIndex,\n\n\t\tactiveGroup,\n\t\tautoScroll = {},\n\n\t\ttapEvt,\n\t\ttouchEvt,\n\n\t\tmoved,\n\n\t\t/** @const */\n\t\tRSPACE = /\\s+/g,\n\n\t\texpando = 'Sortable' + (new Date).getTime(),\n\n\t\twin = window,\n\t\tdocument = win.document,\n\t\tparseInt = win.parseInt,\n\n\t\tsupportDraggable = !!('draggable' in document.createElement('div')),\n\t\tsupportCssPointerEvents = (function (el) {\n\t\t\tel = document.createElement('x');\n\t\t\tel.style.cssText = 'pointer-events:auto';\n\t\t\treturn el.style.pointerEvents === 'auto';\n\t\t})(),\n\n\t\t_silent = false,\n\n\t\tabs = Math.abs,\n\t\tslice = [].slice,\n\n\t\ttouchDragOverListeners = [],\n\n\t\t_autoScroll = _throttle(function (/**Event*/evt, /**Object*/options, /**HTMLElement*/rootEl) {\n\t\t\t// Bug: https://bugzilla.mozilla.org/show_bug.cgi?id=505521\n\t\t\tif (rootEl && options.scroll) {\n\t\t\t\tvar el,\n\t\t\t\t\trect,\n\t\t\t\t\tsens = options.scrollSensitivity,\n\t\t\t\t\tspeed = options.scrollSpeed,\n\n\t\t\t\t\tx = evt.clientX,\n\t\t\t\t\ty = evt.clientY,\n\n\t\t\t\t\twinWidth = window.innerWidth,\n\t\t\t\t\twinHeight = window.innerHeight,\n\n\t\t\t\t\tvx,\n\t\t\t\t\tvy\n\t\t\t\t;\n\n\t\t\t\t// Delect scrollEl\n\t\t\t\tif (scrollParentEl !== rootEl) {\n\t\t\t\t\tscrollEl = options.scroll;\n\t\t\t\t\tscrollParentEl = rootEl;\n\n\t\t\t\t\tif (scrollEl === true) {\n\t\t\t\t\t\tscrollEl = rootEl;\n\n\t\t\t\t\t\tdo {\n\t\t\t\t\t\t\tif ((scrollEl.offsetWidth < scrollEl.scrollWidth) ||\n\t\t\t\t\t\t\t\t(scrollEl.offsetHeight < scrollEl.scrollHeight)\n\t\t\t\t\t\t\t) {\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t/* jshint boss:true */\n\t\t\t\t\t\t} while (scrollEl = scrollEl.parentNode);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (scrollEl) {\n\t\t\t\t\tel = scrollEl;\n\t\t\t\t\trect = scrollEl.getBoundingClientRect();\n\t\t\t\t\tvx = (abs(rect.right - x) <= sens) - (abs(rect.left - x) <= sens);\n\t\t\t\t\tvy = (abs(rect.bottom - y) <= sens) - (abs(rect.top - y) <= sens);\n\t\t\t\t}\n\n\n\t\t\t\tif (!(vx || vy)) {\n\t\t\t\t\tvx = (winWidth - x <= sens) - (x <= sens);\n\t\t\t\t\tvy = (winHeight - y <= sens) - (y <= sens);\n\n\t\t\t\t\t/* jshint expr:true */\n\t\t\t\t\t(vx || vy) && (el = win);\n\t\t\t\t}\n\n\n\t\t\t\tif (autoScroll.vx !== vx || autoScroll.vy !== vy || autoScroll.el !== el) {\n\t\t\t\t\tautoScroll.el = el;\n\t\t\t\t\tautoScroll.vx = vx;\n\t\t\t\t\tautoScroll.vy = vy;\n\n\t\t\t\t\tclearInterval(autoScroll.pid);\n\n\t\t\t\t\tif (el) {\n\t\t\t\t\t\tautoScroll.pid = setInterval(function () {\n\t\t\t\t\t\t\tif (el === win) {\n\t\t\t\t\t\t\t\twin.scrollTo(win.pageXOffset + vx * speed, win.pageYOffset + vy * speed);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tvy && (el.scrollTop += vy * speed);\n\t\t\t\t\t\t\t\tvx && (el.scrollLeft += vx * speed);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}, 24);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}, 30),\n\n\t\t_prepareGroup = function (options) {\n\t\t\tvar group = options.group;\n\n\t\t\tif (!group || typeof group != 'object') {\n\t\t\t\tgroup = options.group = {name: group};\n\t\t\t}\n\n\t\t\t['pull', 'put'].forEach(function (key) {\n\t\t\t\tif (!(key in group)) {\n\t\t\t\t\tgroup[key] = true;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\toptions.groups = ' ' + group.name + (group.put.join ? ' ' + group.put.join(' ') : '') + ' ';\n\t\t}\n\t;\n\n\n\n\t/**\n\t * @class  Sortable\n\t * @param  {HTMLElement}  el\n\t * @param  {Object}       [options]\n\t */\n\tfunction Sortable(el, options) {\n\t\tif (!(el && el.nodeType && el.nodeType === 1)) {\n\t\t\tthrow 'Sortable: `el` must be HTMLElement, and not ' + {}.toString.call(el);\n\t\t}\n\n\t\tthis.el = el; // root element\n\t\tthis.options = options = _extend({}, options);\n\n\n\t\t// Export instance\n\t\tel[expando] = this;\n\n\n\t\t// Default options\n\t\tvar defaults = {\n\t\t\tgroup: Math.random(),\n\t\t\tsort: true,\n\t\t\tdisabled: false,\n\t\t\tstore: null,\n\t\t\thandle: null,\n\t\t\tscroll: true,\n\t\t\tscrollSensitivity: 30,\n\t\t\tscrollSpeed: 10,\n\t\t\tdraggable: /[uo]l/i.test(el.nodeName) ? 'li' : '>*',\n\t\t\tghostClass: 'sortable-ghost',\n\t\t\tchosenClass: 'sortable-chosen',\n\t\t\tignore: 'a, img',\n\t\t\tfilter: null,\n\t\t\tanimation: 0,\n\t\t\tsetData: function (dataTransfer, dragEl) {\n\t\t\t\tdataTransfer.setData('Text', dragEl.textContent);\n\t\t\t},\n\t\t\tdropBubble: false,\n\t\t\tdragoverBubble: false,\n\t\t\tdataIdAttr: 'data-id',\n\t\t\tdelay: 0,\n\t\t\tforceFallback: false,\n\t\t\tfallbackClass: 'sortable-fallback',\n\t\t\tfallbackOnBody: false\n\t\t};\n\n\n\t\t// Set default options\n\t\tfor (var name in defaults) {\n\t\t\t!(name in options) && (options[name] = defaults[name]);\n\t\t}\n\n\t\t_prepareGroup(options);\n\n\t\t// Bind all private methods\n\t\tfor (var fn in this) {\n\t\t\tif (fn.charAt(0) === '_') {\n\t\t\t\tthis[fn] = this[fn].bind(this);\n\t\t\t}\n\t\t}\n\n\t\t// Setup drag mode\n\t\tthis.nativeDraggable = options.forceFallback ? false : supportDraggable;\n\n\t\t// Bind events\n\t\t_on(el, 'mousedown', this._onTapStart);\n\t\t_on(el, 'touchstart', this._onTapStart);\n\n\t\tif (this.nativeDraggable) {\n\t\t\t_on(el, 'dragover', this);\n\t\t\t_on(el, 'dragenter', this);\n\t\t}\n\n\t\ttouchDragOverListeners.push(this._onDragOver);\n\n\t\t// Restore sorting\n\t\toptions.store && this.sort(options.store.get(this));\n\t}\n\n\n\tSortable.prototype = /** @lends Sortable.prototype */ {\n\t\tconstructor: Sortable,\n\n\t\t_onTapStart: function (/** Event|TouchEvent */evt) {\n\t\t\tvar _this = this,\n\t\t\t\tel = this.el,\n\t\t\t\toptions = this.options,\n\t\t\t\ttype = evt.type,\n\t\t\t\ttouch = evt.touches && evt.touches[0],\n\t\t\t\ttarget = (touch || evt).target,\n\t\t\t\toriginalTarget = target,\n\t\t\t\tfilter = options.filter;\n\n\n\t\t\tif (type === 'mousedown' && evt.button !== 0 || options.disabled) {\n\t\t\t\treturn; // only left button or enabled\n\t\t\t}\n\n\t\t\ttarget = _closest(target, options.draggable, el);\n\n\t\t\tif (!target) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// get the index of the dragged element within its parent\n\t\t\toldIndex = _index(target);\n\n\t\t\t// Check filter\n\t\t\tif (typeof filter === 'function') {\n\t\t\t\tif (filter.call(this, evt, target, this)) {\n\t\t\t\t\t_dispatchEvent(_this, originalTarget, 'filter', target, el, oldIndex);\n\t\t\t\t\tevt.preventDefault();\n\t\t\t\t\treturn; // cancel dnd\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (filter) {\n\t\t\t\tfilter = filter.split(',').some(function (criteria) {\n\t\t\t\t\tcriteria = _closest(originalTarget, criteria.trim(), el);\n\n\t\t\t\t\tif (criteria) {\n\t\t\t\t\t\t_dispatchEvent(_this, criteria, 'filter', target, el, oldIndex);\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tif (filter) {\n\t\t\t\t\tevt.preventDefault();\n\t\t\t\t\treturn; // cancel dnd\n\t\t\t\t}\n\t\t\t}\n\n\n\t\t\tif (options.handle && !_closest(originalTarget, options.handle, el)) {\n\t\t\t\treturn;\n\t\t\t}\n\n\n\t\t\t// Prepare `dragstart`\n\t\t\tthis._prepareDragStart(evt, touch, target);\n\t\t},\n\n\t\t_prepareDragStart: function (/** Event */evt, /** Touch */touch, /** HTMLElement */target) {\n\t\t\tvar _this = this,\n\t\t\t\tel = _this.el,\n\t\t\t\toptions = _this.options,\n\t\t\t\townerDocument = el.ownerDocument,\n\t\t\t\tdragStartFn;\n\n\t\t\tif (target && !dragEl && (target.parentNode === el)) {\n\t\t\t\ttapEvt = evt;\n\n\t\t\t\trootEl = el;\n\t\t\t\tdragEl = target;\n\t\t\t\tparentEl = dragEl.parentNode;\n\t\t\t\tnextEl = dragEl.nextSibling;\n\t\t\t\tactiveGroup = options.group;\n\n\t\t\t\tdragStartFn = function () {\n\t\t\t\t\t// Delayed drag has been triggered\n\t\t\t\t\t// we can re-enable the events: touchmove/mousemove\n\t\t\t\t\t_this._disableDelayedDrag();\n\n\t\t\t\t\t// Make the element draggable\n\t\t\t\t\tdragEl.draggable = true;\n\n\t\t\t\t\t// Chosen item\n\t\t\t\t\t_toggleClass(dragEl, _this.options.chosenClass, true);\n\n\t\t\t\t\t// Bind the events: dragstart/dragend\n\t\t\t\t\t_this._triggerDragStart(touch);\n\t\t\t\t};\n\n\t\t\t\t// Disable \"draggable\"\n\t\t\t\toptions.ignore.split(',').forEach(function (criteria) {\n\t\t\t\t\t_find(dragEl, criteria.trim(), _disableDraggable);\n\t\t\t\t});\n\n\t\t\t\t_on(ownerDocument, 'mouseup', _this._onDrop);\n\t\t\t\t_on(ownerDocument, 'touchend', _this._onDrop);\n\t\t\t\t_on(ownerDocument, 'touchcancel', _this._onDrop);\n\n\t\t\t\tif (options.delay) {\n\t\t\t\t\t// If the user moves the pointer or let go the click or touch\n\t\t\t\t\t// before the delay has been reached:\n\t\t\t\t\t// disable the delayed drag\n\t\t\t\t\t_on(ownerDocument, 'mouseup', _this._disableDelayedDrag);\n\t\t\t\t\t_on(ownerDocument, 'touchend', _this._disableDelayedDrag);\n\t\t\t\t\t_on(ownerDocument, 'touchcancel', _this._disableDelayedDrag);\n\t\t\t\t\t_on(ownerDocument, 'mousemove', _this._disableDelayedDrag);\n\t\t\t\t\t_on(ownerDocument, 'touchmove', _this._disableDelayedDrag);\n\n\t\t\t\t\t_this._dragStartTimer = setTimeout(dragStartFn, options.delay);\n\t\t\t\t} else {\n\t\t\t\t\tdragStartFn();\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\n\t\t_disableDelayedDrag: function () {\n\t\t\tvar ownerDocument = this.el.ownerDocument;\n\n\t\t\tclearTimeout(this._dragStartTimer);\n\t\t\t_off(ownerDocument, 'mouseup', this._disableDelayedDrag);\n\t\t\t_off(ownerDocument, 'touchend', this._disableDelayedDrag);\n\t\t\t_off(ownerDocument, 'touchcancel', this._disableDelayedDrag);\n\t\t\t_off(ownerDocument, 'mousemove', this._disableDelayedDrag);\n\t\t\t_off(ownerDocument, 'touchmove', this._disableDelayedDrag);\n\t\t},\n\n\t\t_triggerDragStart: function (/** Touch */touch) {\n\t\t\tif (touch) {\n\t\t\t\t// Touch device support\n\t\t\t\ttapEvt = {\n\t\t\t\t\ttarget: dragEl,\n\t\t\t\t\tclientX: touch.clientX,\n\t\t\t\t\tclientY: touch.clientY\n\t\t\t\t};\n\n\t\t\t\tthis._onDragStart(tapEvt, 'touch');\n\t\t\t}\n\t\t\telse if (!this.nativeDraggable) {\n\t\t\t\tthis._onDragStart(tapEvt, true);\n\t\t\t}\n\t\t\telse {\n\t\t\t\t_on(dragEl, 'dragend', this);\n\t\t\t\t_on(rootEl, 'dragstart', this._onDragStart);\n\t\t\t}\n\n\t\t\ttry {\n\t\t\t\tif (document.selection) {\n\t\t\t\t\tdocument.selection.empty();\n\t\t\t\t} else {\n\t\t\t\t\twindow.getSelection().removeAllRanges();\n\t\t\t\t}\n\t\t\t} catch (err) {\n\t\t\t}\n\t\t},\n\n\t\t_dragStarted: function () {\n\t\t\tif (rootEl && dragEl) {\n\t\t\t\t// Apply effect\n\t\t\t\t_toggleClass(dragEl, this.options.ghostClass, true);\n\n\t\t\t\tSortable.active = this;\n\n\t\t\t\t// Drag start event\n\t\t\t\t_dispatchEvent(this, rootEl, 'start', dragEl, rootEl, oldIndex);\n\t\t\t}\n\t\t},\n\n\t\t_emulateDragOver: function () {\n\t\t\tif (touchEvt) {\n\t\t\t\tif (this._lastX === touchEvt.clientX && this._lastY === touchEvt.clientY) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tthis._lastX = touchEvt.clientX;\n\t\t\t\tthis._lastY = touchEvt.clientY;\n\n\t\t\t\tif (!supportCssPointerEvents) {\n\t\t\t\t\t_css(ghostEl, 'display', 'none');\n\t\t\t\t}\n\n\t\t\t\tvar target = document.elementFromPoint(touchEvt.clientX, touchEvt.clientY),\n\t\t\t\t\tparent = target,\n\t\t\t\t\tgroupName = ' ' + this.options.group.name + '',\n\t\t\t\t\ti = touchDragOverListeners.length;\n\n\t\t\t\tif (parent) {\n\t\t\t\t\tdo {\n\t\t\t\t\t\tif (parent[expando] && parent[expando].options.groups.indexOf(groupName) > -1) {\n\t\t\t\t\t\t\twhile (i--) {\n\t\t\t\t\t\t\t\ttouchDragOverListeners[i]({\n\t\t\t\t\t\t\t\t\tclientX: touchEvt.clientX,\n\t\t\t\t\t\t\t\t\tclientY: touchEvt.clientY,\n\t\t\t\t\t\t\t\t\ttarget: target,\n\t\t\t\t\t\t\t\t\trootEl: parent\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\ttarget = parent; // store last element\n\t\t\t\t\t}\n\t\t\t\t\t/* jshint boss:true */\n\t\t\t\t\twhile (parent = parent.parentNode);\n\t\t\t\t}\n\n\t\t\t\tif (!supportCssPointerEvents) {\n\t\t\t\t\t_css(ghostEl, 'display', '');\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\n\n\t\t_onTouchMove: function (/**TouchEvent*/evt) {\n\t\t\tif (tapEvt) {\n\t\t\t\t// only set the status to dragging, when we are actually dragging\n\t\t\t\tif (!Sortable.active) {\n\t\t\t\t\tthis._dragStarted();\n\t\t\t\t}\n\n\t\t\t\t// as well as creating the ghost element on the document body\n\t\t\t\tthis._appendGhost();\n\n\t\t\t\tvar touch = evt.touches ? evt.touches[0] : evt,\n\t\t\t\t\tdx = touch.clientX - tapEvt.clientX,\n\t\t\t\t\tdy = touch.clientY - tapEvt.clientY,\n\t\t\t\t\ttranslate3d = evt.touches ? 'translate3d(' + dx + 'px,' + dy + 'px,0)' : 'translate(' + dx + 'px,' + dy + 'px)';\n\n\t\t\t\tmoved = true;\n\t\t\t\ttouchEvt = touch;\n\n\t\t\t\t_css(ghostEl, 'webkitTransform', translate3d);\n\t\t\t\t_css(ghostEl, 'mozTransform', translate3d);\n\t\t\t\t_css(ghostEl, 'msTransform', translate3d);\n\t\t\t\t_css(ghostEl, 'transform', translate3d);\n\n\t\t\t\tevt.preventDefault();\n\t\t\t}\n\t\t},\n\n\t\t_appendGhost: function () {\n\t\t\tif (!ghostEl) {\n\t\t\t\tvar rect = dragEl.getBoundingClientRect(),\n\t\t\t\t\tcss = _css(dragEl),\n\t\t\t\t\toptions = this.options,\n\t\t\t\t\tghostRect;\n\n\t\t\t\tghostEl = dragEl.cloneNode(true);\n\n\t\t\t\t_toggleClass(ghostEl, options.ghostClass, false);\n\t\t\t\t_toggleClass(ghostEl, options.fallbackClass, true);\n\n\t\t\t\t_css(ghostEl, 'top', rect.top - parseInt(css.marginTop, 10));\n\t\t\t\t_css(ghostEl, 'left', rect.left - parseInt(css.marginLeft, 10));\n\t\t\t\t_css(ghostEl, 'width', rect.width);\n\t\t\t\t_css(ghostEl, 'height', rect.height);\n\t\t\t\t_css(ghostEl, 'opacity', '0.8');\n\t\t\t\t_css(ghostEl, 'position', 'fixed');\n\t\t\t\t_css(ghostEl, 'zIndex', '100000');\n\t\t\t\t_css(ghostEl, 'pointerEvents', 'none');\n\n\t\t\t\toptions.fallbackOnBody && document.body.appendChild(ghostEl) || rootEl.appendChild(ghostEl);\n\n\t\t\t\t// Fixing dimensions.\n\t\t\t\tghostRect = ghostEl.getBoundingClientRect();\n\t\t\t\t_css(ghostEl, 'width', rect.width * 2 - ghostRect.width);\n\t\t\t\t_css(ghostEl, 'height', rect.height * 2 - ghostRect.height);\n\t\t\t}\n\t\t},\n\n\t\t_onDragStart: function (/**Event*/evt, /**boolean*/useFallback) {\n\t\t\tvar dataTransfer = evt.dataTransfer,\n\t\t\t\toptions = this.options;\n\n\t\t\tthis._offUpEvents();\n\n\t\t\tif (activeGroup.pull == 'clone') {\n\t\t\t\tcloneEl = dragEl.cloneNode(true);\n\t\t\t\t_css(cloneEl, 'display', 'none');\n\t\t\t\trootEl.insertBefore(cloneEl, dragEl);\n\t\t\t}\n\n\t\t\tif (useFallback) {\n\n\t\t\t\tif (useFallback === 'touch') {\n\t\t\t\t\t// Bind touch events\n\t\t\t\t\t_on(document, 'touchmove', this._onTouchMove);\n\t\t\t\t\t_on(document, 'touchend', this._onDrop);\n\t\t\t\t\t_on(document, 'touchcancel', this._onDrop);\n\t\t\t\t} else {\n\t\t\t\t\t// Old brwoser\n\t\t\t\t\t_on(document, 'mousemove', this._onTouchMove);\n\t\t\t\t\t_on(document, 'mouseup', this._onDrop);\n\t\t\t\t}\n\n\t\t\t\tthis._loopId = setInterval(this._emulateDragOver, 50);\n\t\t\t}\n\t\t\telse {\n\t\t\t\tif (dataTransfer) {\n\t\t\t\t\tdataTransfer.effectAllowed = 'move';\n\t\t\t\t\toptions.setData && options.setData.call(this, dataTransfer, dragEl);\n\t\t\t\t}\n\n\t\t\t\t_on(document, 'drop', this);\n\t\t\t\tsetTimeout(this._dragStarted, 0);\n\t\t\t}\n\t\t},\n\n\t\t_onDragOver: function (/**Event*/evt) {\n\t\t\tvar el = this.el,\n\t\t\t\ttarget,\n\t\t\t\tdragRect,\n\t\t\t\trevert,\n\t\t\t\toptions = this.options,\n\t\t\t\tgroup = options.group,\n\t\t\t\tgroupPut = group.put,\n\t\t\t\tisOwner = (activeGroup === group),\n\t\t\t\tcanSort = options.sort;\n\n\t\t\tif (evt.preventDefault !== void 0) {\n\t\t\t\tevt.preventDefault();\n\t\t\t\t!options.dragoverBubble && evt.stopPropagation();\n\t\t\t}\n\n\t\t\tmoved = true;\n\n\t\t\tif (activeGroup && !options.disabled &&\n\t\t\t\t(isOwner\n\t\t\t\t\t? canSort || (revert = !rootEl.contains(dragEl)) // Reverting item into the original list\n\t\t\t\t\t: activeGroup.pull && groupPut && (\n\t\t\t\t\t\t(activeGroup.name === group.name) || // by Name\n\t\t\t\t\t\t(groupPut.indexOf && ~groupPut.indexOf(activeGroup.name)) // by Array\n\t\t\t\t\t)\n\t\t\t\t) &&\n\t\t\t\t(evt.rootEl === void 0 || evt.rootEl === this.el) // touch fallback\n\t\t\t) {\n\t\t\t\t// Smart auto-scrolling\n\t\t\t\t_autoScroll(evt, options, this.el);\n\n\t\t\t\tif (_silent) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\ttarget = _closest(evt.target, options.draggable, el);\n\t\t\t\tdragRect = dragEl.getBoundingClientRect();\n\n\t\t\t\tif (revert) {\n\t\t\t\t\t_cloneHide(true);\n\n\t\t\t\t\tif (cloneEl || nextEl) {\n\t\t\t\t\t\trootEl.insertBefore(dragEl, cloneEl || nextEl);\n\t\t\t\t\t}\n\t\t\t\t\telse if (!canSort) {\n\t\t\t\t\t\trootEl.appendChild(dragEl);\n\t\t\t\t\t}\n\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\n\t\t\t\tif ((el.children.length === 0) || (el.children[0] === ghostEl) ||\n\t\t\t\t\t(el === evt.target) && (target = _ghostIsLast(el, evt))\n\t\t\t\t) {\n\n\t\t\t\t\tif (target) {\n\t\t\t\t\t\tif (target.animated) {\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\ttargetRect = target.getBoundingClientRect();\n\t\t\t\t\t}\n\n\t\t\t\t\t_cloneHide(isOwner);\n\n\t\t\t\t\tif (_onMove(rootEl, el, dragEl, dragRect, target, targetRect) !== false) {\n\t\t\t\t\t\tif (!dragEl.contains(el)) {\n\t\t\t\t\t\t\tel.appendChild(dragEl);\n\t\t\t\t\t\t\tparentEl = el; // actualization\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tthis._animate(dragRect, dragEl);\n\t\t\t\t\t\ttarget && this._animate(targetRect, target);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse if (target && !target.animated && target !== dragEl && (target.parentNode[expando] !== void 0)) {\n\t\t\t\t\tif (lastEl !== target) {\n\t\t\t\t\t\tlastEl = target;\n\t\t\t\t\t\tlastCSS = _css(target);\n\t\t\t\t\t\tlastParentCSS = _css(target.parentNode);\n\t\t\t\t\t}\n\n\n\t\t\t\t\tvar targetRect = target.getBoundingClientRect(),\n\t\t\t\t\t\twidth = targetRect.right - targetRect.left,\n\t\t\t\t\t\theight = targetRect.bottom - targetRect.top,\n\t\t\t\t\t\tfloating = /left|right|inline/.test(lastCSS.cssFloat + lastCSS.display)\n\t\t\t\t\t\t\t|| (lastParentCSS.display == 'flex' && lastParentCSS['flex-direction'].indexOf('row') === 0),\n\t\t\t\t\t\tisWide = (target.offsetWidth > dragEl.offsetWidth),\n\t\t\t\t\t\tisLong = (target.offsetHeight > dragEl.offsetHeight),\n\t\t\t\t\t\thalfway = (floating ? (evt.clientX - targetRect.left) / width : (evt.clientY - targetRect.top) / height) > 0.5,\n\t\t\t\t\t\tnextSibling = target.nextElementSibling,\n\t\t\t\t\t\tmoveVector = _onMove(rootEl, el, dragEl, dragRect, target, targetRect),\n\t\t\t\t\t\tafter\n\t\t\t\t\t;\n\n\t\t\t\t\tif (moveVector !== false) {\n\t\t\t\t\t\t_silent = true;\n\t\t\t\t\t\tsetTimeout(_unsilent, 30);\n\n\t\t\t\t\t\t_cloneHide(isOwner);\n\n\t\t\t\t\t\tif (moveVector === 1 || moveVector === -1) {\n\t\t\t\t\t\t\tafter = (moveVector === 1);\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse if (floating) {\n\t\t\t\t\t\t\tvar elTop = dragEl.offsetTop,\n\t\t\t\t\t\t\t\ttgTop = target.offsetTop;\n\n\t\t\t\t\t\t\tif (elTop === tgTop) {\n\t\t\t\t\t\t\t\tafter = (target.previousElementSibling === dragEl) && !isWide || halfway && isWide;\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tafter = tgTop > elTop;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tafter = (nextSibling !== dragEl) && !isLong || halfway && isLong;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (!dragEl.contains(el)) {\n\t\t\t\t\t\t\tif (after && !nextSibling) {\n\t\t\t\t\t\t\t\tel.appendChild(dragEl);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\ttarget.parentNode.insertBefore(dragEl, after ? nextSibling : target);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tparentEl = dragEl.parentNode; // actualization\n\n\t\t\t\t\t\tthis._animate(dragRect, dragEl);\n\t\t\t\t\t\tthis._animate(targetRect, target);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\n\t\t_animate: function (prevRect, target) {\n\t\t\tvar ms = this.options.animation;\n\n\t\t\tif (ms) {\n\t\t\t\tvar currentRect = target.getBoundingClientRect();\n\n\t\t\t\t_css(target, 'transition', 'none');\n\t\t\t\t_css(target, 'transform', 'translate3d('\n\t\t\t\t\t+ (prevRect.left - currentRect.left) + 'px,'\n\t\t\t\t\t+ (prevRect.top - currentRect.top) + 'px,0)'\n\t\t\t\t);\n\n\t\t\t\ttarget.offsetWidth; // repaint\n\n\t\t\t\t_css(target, 'transition', 'all ' + ms + 'ms');\n\t\t\t\t_css(target, 'transform', 'translate3d(0,0,0)');\n\n\t\t\t\tclearTimeout(target.animated);\n\t\t\t\ttarget.animated = setTimeout(function () {\n\t\t\t\t\t_css(target, 'transition', '');\n\t\t\t\t\t_css(target, 'transform', '');\n\t\t\t\t\ttarget.animated = false;\n\t\t\t\t}, ms);\n\t\t\t}\n\t\t},\n\n\t\t_offUpEvents: function () {\n\t\t\tvar ownerDocument = this.el.ownerDocument;\n\n\t\t\t_off(document, 'touchmove', this._onTouchMove);\n\t\t\t_off(ownerDocument, 'mouseup', this._onDrop);\n\t\t\t_off(ownerDocument, 'touchend', this._onDrop);\n\t\t\t_off(ownerDocument, 'touchcancel', this._onDrop);\n\t\t},\n\n\t\t_onDrop: function (/**Event*/evt) {\n\t\t\tvar el = this.el,\n\t\t\t\toptions = this.options;\n\n\t\t\tclearInterval(this._loopId);\n\t\t\tclearInterval(autoScroll.pid);\n\t\t\tclearTimeout(this._dragStartTimer);\n\n\t\t\t// Unbind events\n\t\t\t_off(document, 'mousemove', this._onTouchMove);\n\n\t\t\tif (this.nativeDraggable) {\n\t\t\t\t_off(document, 'drop', this);\n\t\t\t\t_off(el, 'dragstart', this._onDragStart);\n\t\t\t}\n\n\t\t\tthis._offUpEvents();\n\n\t\t\tif (evt) {\n\t\t\t\tif (moved) {\n\t\t\t\t\tevt.preventDefault();\n\t\t\t\t\t!options.dropBubble && evt.stopPropagation();\n\t\t\t\t}\n\n\t\t\t\tghostEl && ghostEl.parentNode.removeChild(ghostEl);\n\n\t\t\t\tif (dragEl) {\n\t\t\t\t\tif (this.nativeDraggable) {\n\t\t\t\t\t\t_off(dragEl, 'dragend', this);\n\t\t\t\t\t}\n\n\t\t\t\t\t_disableDraggable(dragEl);\n\n\t\t\t\t\t// Remove class's\n\t\t\t\t\t_toggleClass(dragEl, this.options.ghostClass, false);\n\t\t\t\t\t_toggleClass(dragEl, this.options.chosenClass, false);\n\n\t\t\t\t\tif (rootEl !== parentEl) {\n\t\t\t\t\t\tnewIndex = _index(dragEl);\n\n\t\t\t\t\t\tif (newIndex >= 0) {\n\t\t\t\t\t\t\t// drag from one list and drop into another\n\t\t\t\t\t\t\t_dispatchEvent(null, parentEl, 'sort', dragEl, rootEl, oldIndex, newIndex);\n\t\t\t\t\t\t\t_dispatchEvent(this, rootEl, 'sort', dragEl, rootEl, oldIndex, newIndex);\n\n\t\t\t\t\t\t\t// Add event\n\t\t\t\t\t\t\t_dispatchEvent(null, parentEl, 'add', dragEl, rootEl, oldIndex, newIndex);\n\n\t\t\t\t\t\t\t// Remove event\n\t\t\t\t\t\t\t_dispatchEvent(this, rootEl, 'remove', dragEl, rootEl, oldIndex, newIndex);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\t// Remove clone\n\t\t\t\t\t\tcloneEl && cloneEl.parentNode.removeChild(cloneEl);\n\n\t\t\t\t\t\tif (dragEl.nextSibling !== nextEl) {\n\t\t\t\t\t\t\t// Get the index of the dragged element within its parent\n\t\t\t\t\t\t\tnewIndex = _index(dragEl);\n\n\t\t\t\t\t\t\tif (newIndex >= 0) {\n\t\t\t\t\t\t\t\t// drag & drop within the same list\n\t\t\t\t\t\t\t\t_dispatchEvent(this, rootEl, 'update', dragEl, rootEl, oldIndex, newIndex);\n\t\t\t\t\t\t\t\t_dispatchEvent(this, rootEl, 'sort', dragEl, rootEl, oldIndex, newIndex);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tif (Sortable.active) {\n\t\t\t\t\t\tif (newIndex === null || newIndex === -1) {\n\t\t\t\t\t\t\tnewIndex = oldIndex;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t_dispatchEvent(this, rootEl, 'end', dragEl, rootEl, oldIndex, newIndex);\n\n\t\t\t\t\t\t// Save sorting\n\t\t\t\t\t\tthis.save();\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// Nulling\n\t\t\t\trootEl =\n\t\t\t\tdragEl =\n\t\t\t\tparentEl =\n\t\t\t\tghostEl =\n\t\t\t\tnextEl =\n\t\t\t\tcloneEl =\n\n\t\t\t\tscrollEl =\n\t\t\t\tscrollParentEl =\n\n\t\t\t\ttapEvt =\n\t\t\t\ttouchEvt =\n\n\t\t\t\tmoved =\n\t\t\t\tnewIndex =\n\n\t\t\t\tlastEl =\n\t\t\t\tlastCSS =\n\n\t\t\t\tactiveGroup =\n\t\t\t\tSortable.active = null;\n\t\t\t}\n\t\t},\n\n\n\t\thandleEvent: function (/**Event*/evt) {\n\t\t\tvar type = evt.type;\n\n\t\t\tif (type === 'dragover' || type === 'dragenter') {\n\t\t\t\tif (dragEl) {\n\t\t\t\t\tthis._onDragOver(evt);\n\t\t\t\t\t_globalDragOver(evt);\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (type === 'drop' || type === 'dragend') {\n\t\t\t\tthis._onDrop(evt);\n\t\t\t}\n\t\t},\n\n\n\t\t/**\n\t\t * Serializes the item into an array of string.\n\t\t * @returns {String[]}\n\t\t */\n\t\ttoArray: function () {\n\t\t\tvar order = [],\n\t\t\t\tel,\n\t\t\t\tchildren = this.el.children,\n\t\t\t\ti = 0,\n\t\t\t\tn = children.length,\n\t\t\t\toptions = this.options;\n\n\t\t\tfor (; i < n; i++) {\n\t\t\t\tel = children[i];\n\t\t\t\tif (_closest(el, options.draggable, this.el)) {\n\t\t\t\t\torder.push(el.getAttribute(options.dataIdAttr) || _generateId(el));\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn order;\n\t\t},\n\n\n\t\t/**\n\t\t * Sorts the elements according to the array.\n\t\t * @param  {String[]}  order  order of the items\n\t\t */\n\t\tsort: function (order) {\n\t\t\tvar items = {}, rootEl = this.el;\n\n\t\t\tthis.toArray().forEach(function (id, i) {\n\t\t\t\tvar el = rootEl.children[i];\n\n\t\t\t\tif (_closest(el, this.options.draggable, rootEl)) {\n\t\t\t\t\titems[id] = el;\n\t\t\t\t}\n\t\t\t}, this);\n\n\t\t\torder.forEach(function (id) {\n\t\t\t\tif (items[id]) {\n\t\t\t\t\trootEl.removeChild(items[id]);\n\t\t\t\t\trootEl.appendChild(items[id]);\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\n\n\t\t/**\n\t\t * Save the current sorting\n\t\t */\n\t\tsave: function () {\n\t\t\tvar store = this.options.store;\n\t\t\tstore && store.set(this);\n\t\t},\n\n\n\t\t/**\n\t\t * For each element in the set, get the first element that matches the selector by testing the element itself and traversing up through its ancestors in the DOM tree.\n\t\t * @param   {HTMLElement}  el\n\t\t * @param   {String}       [selector]  default: `options.draggable`\n\t\t * @returns {HTMLElement|null}\n\t\t */\n\t\tclosest: function (el, selector) {\n\t\t\treturn _closest(el, selector || this.options.draggable, this.el);\n\t\t},\n\n\n\t\t/**\n\t\t * Set/get option\n\t\t * @param   {string} name\n\t\t * @param   {*}      [value]\n\t\t * @returns {*}\n\t\t */\n\t\toption: function (name, value) {\n\t\t\tvar options = this.options;\n\n\t\t\tif (value === void 0) {\n\t\t\t\treturn options[name];\n\t\t\t} else {\n\t\t\t\toptions[name] = value;\n\n\t\t\t\tif (name === 'group') {\n\t\t\t\t\t_prepareGroup(options);\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\n\n\t\t/**\n\t\t * Destroy\n\t\t */\n\t\tdestroy: function () {\n\t\t\tvar el = this.el;\n\n\t\t\tel[expando] = null;\n\n\t\t\t_off(el, 'mousedown', this._onTapStart);\n\t\t\t_off(el, 'touchstart', this._onTapStart);\n\n\t\t\tif (this.nativeDraggable) {\n\t\t\t\t_off(el, 'dragover', this);\n\t\t\t\t_off(el, 'dragenter', this);\n\t\t\t}\n\n\t\t\t// Remove draggable attributes\n\t\t\tArray.prototype.forEach.call(el.querySelectorAll('[draggable]'), function (el) {\n\t\t\t\tel.removeAttribute('draggable');\n\t\t\t});\n\n\t\t\ttouchDragOverListeners.splice(touchDragOverListeners.indexOf(this._onDragOver), 1);\n\n\t\t\tthis._onDrop();\n\n\t\t\tthis.el = el = null;\n\t\t}\n\t};\n\n\n\tfunction _cloneHide(state) {\n\t\tif (cloneEl && (cloneEl.state !== state)) {\n\t\t\t_css(cloneEl, 'display', state ? 'none' : '');\n\t\t\t!state && cloneEl.state && rootEl.insertBefore(cloneEl, dragEl);\n\t\t\tcloneEl.state = state;\n\t\t}\n\t}\n\n\n\tfunction _closest(/**HTMLElement*/el, /**String*/selector, /**HTMLElement*/ctx) {\n\t\tif (el) {\n\t\t\tctx = ctx || document;\n\t\t\tselector = selector.split('.');\n\n\t\t\tvar tag = selector.shift().toUpperCase(),\n\t\t\t\tre = new RegExp('\\\\s(' + selector.join('|') + ')(?=\\\\s)', 'g');\n\n\t\t\tdo {\n\t\t\t\tif (\n\t\t\t\t\t(tag === '>*' && el.parentNode === ctx) || (\n\t\t\t\t\t\t(tag === '' || el.nodeName.toUpperCase() == tag) &&\n\t\t\t\t\t\t(!selector.length || ((' ' + el.className + ' ').match(re) || []).length == selector.length)\n\t\t\t\t\t)\n\t\t\t\t) {\n\t\t\t\t\treturn el;\n\t\t\t\t}\n\t\t\t}\n\t\t\twhile (el !== ctx && (el = el.parentNode));\n\t\t}\n\n\t\treturn null;\n\t}\n\n\n\tfunction _globalDragOver(/**Event*/evt) {\n\t\tif (evt.dataTransfer) {\n\t\t\tevt.dataTransfer.dropEffect = 'move';\n\t\t}\n\t\tevt.preventDefault();\n\t}\n\n\n\tfunction _on(el, event, fn) {\n\t\tel.addEventListener(event, fn, false);\n\t}\n\n\n\tfunction _off(el, event, fn) {\n\t\tel.removeEventListener(event, fn, false);\n\t}\n\n\n\tfunction _toggleClass(el, name, state) {\n\t\tif (el) {\n\t\t\tif (el.classList) {\n\t\t\t\tel.classList[state ? 'add' : 'remove'](name);\n\t\t\t}\n\t\t\telse {\n\t\t\t\tvar className = (' ' + el.className + ' ').replace(RSPACE, ' ').replace(' ' + name + ' ', ' ');\n\t\t\t\tel.className = (className + (state ? ' ' + name : '')).replace(RSPACE, ' ');\n\t\t\t}\n\t\t}\n\t}\n\n\n\tfunction _css(el, prop, val) {\n\t\tvar style = el && el.style;\n\n\t\tif (style) {\n\t\t\tif (val === void 0) {\n\t\t\t\tif (document.defaultView && document.defaultView.getComputedStyle) {\n\t\t\t\t\tval = document.defaultView.getComputedStyle(el, '');\n\t\t\t\t}\n\t\t\t\telse if (el.currentStyle) {\n\t\t\t\t\tval = el.currentStyle;\n\t\t\t\t}\n\n\t\t\t\treturn prop === void 0 ? val : val[prop];\n\t\t\t}\n\t\t\telse {\n\t\t\t\tif (!(prop in style)) {\n\t\t\t\t\tprop = '-webkit-' + prop;\n\t\t\t\t}\n\n\t\t\t\tstyle[prop] = val + (typeof val === 'string' ? '' : 'px');\n\t\t\t}\n\t\t}\n\t}\n\n\n\tfunction _find(ctx, tagName, iterator) {\n\t\tif (ctx) {\n\t\t\tvar list = ctx.getElementsByTagName(tagName), i = 0, n = list.length;\n\n\t\t\tif (iterator) {\n\t\t\t\tfor (; i < n; i++) {\n\t\t\t\t\titerator(list[i], i);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn list;\n\t\t}\n\n\t\treturn [];\n\t}\n\n\n\n\tfunction _dispatchEvent(sortable, rootEl, name, targetEl, fromEl, startIndex, newIndex) {\n\t\tvar evt = document.createEvent('Event'),\n\t\t\toptions = (sortable || rootEl[expando]).options,\n\t\t\tonName = 'on' + name.charAt(0).toUpperCase() + name.substr(1);\n\n\t\tevt.initEvent(name, true, true);\n\n\t\tevt.to = rootEl;\n\t\tevt.from = fromEl || rootEl;\n\t\tevt.item = targetEl || rootEl;\n\t\tevt.clone = cloneEl;\n\n\t\tevt.oldIndex = startIndex;\n\t\tevt.newIndex = newIndex;\n\n\t\trootEl.dispatchEvent(evt);\n\n\t\tif (options[onName]) {\n\t\t\toptions[onName].call(sortable, evt);\n\t\t}\n\t}\n\n\n\tfunction _onMove(fromEl, toEl, dragEl, dragRect, targetEl, targetRect) {\n\t\tvar evt,\n\t\t\tsortable = fromEl[expando],\n\t\t\tonMoveFn = sortable.options.onMove,\n\t\t\tretVal;\n\n\t\tevt = document.createEvent('Event');\n\t\tevt.initEvent('move', true, true);\n\n\t\tevt.to = toEl;\n\t\tevt.from = fromEl;\n\t\tevt.dragged = dragEl;\n\t\tevt.draggedRect = dragRect;\n\t\tevt.related = targetEl || toEl;\n\t\tevt.relatedRect = targetRect || toEl.getBoundingClientRect();\n\n\t\tfromEl.dispatchEvent(evt);\n\n\t\tif (onMoveFn) {\n\t\t\tretVal = onMoveFn.call(sortable, evt);\n\t\t}\n\n\t\treturn retVal;\n\t}\n\n\n\tfunction _disableDraggable(el) {\n\t\tel.draggable = false;\n\t}\n\n\n\tfunction _unsilent() {\n\t\t_silent = false;\n\t}\n\n\n\t/** @returns {HTMLElement|false} */\n\tfunction _ghostIsLast(el, evt) {\n\t\tvar lastEl = el.lastElementChild,\n\t\t\t\trect = lastEl.getBoundingClientRect();\n\n\t\treturn ((evt.clientY - (rect.top + rect.height) > 5) || (evt.clientX - (rect.right + rect.width) > 5)) && lastEl; // min delta\n\t}\n\n\n\t/**\n\t * Generate id\n\t * @param   {HTMLElement} el\n\t * @returns {String}\n\t * @private\n\t */\n\tfunction _generateId(el) {\n\t\tvar str = el.tagName + el.className + el.src + el.href + el.textContent,\n\t\t\ti = str.length,\n\t\t\tsum = 0;\n\n\t\twhile (i--) {\n\t\t\tsum += str.charCodeAt(i);\n\t\t}\n\n\t\treturn sum.toString(36);\n\t}\n\n\t/**\n\t * Returns the index of an element within its parent\n\t * @param  {HTMLElement} el\n\t * @return {number}\n\t */\n\tfunction _index(el) {\n\t\tvar index = 0;\n\n\t\tif (!el || !el.parentNode) {\n\t\t\treturn -1;\n\t\t}\n\n\t\twhile (el && (el = el.previousElementSibling)) {\n\t\t\tif (el.nodeName.toUpperCase() !== 'TEMPLATE') {\n\t\t\t\tindex++;\n\t\t\t}\n\t\t}\n\n\t\treturn index;\n\t}\n\n\tfunction _throttle(callback, ms) {\n\t\tvar args, _this;\n\n\t\treturn function () {\n\t\t\tif (args === void 0) {\n\t\t\t\targs = arguments;\n\t\t\t\t_this = this;\n\n\t\t\t\tsetTimeout(function () {\n\t\t\t\t\tif (args.length === 1) {\n\t\t\t\t\t\tcallback.call(_this, args[0]);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tcallback.apply(_this, args);\n\t\t\t\t\t}\n\n\t\t\t\t\targs = void 0;\n\t\t\t\t}, ms);\n\t\t\t}\n\t\t};\n\t}\n\n\tfunction _extend(dst, src) {\n\t\tif (dst && src) {\n\t\t\tfor (var key in src) {\n\t\t\t\tif (src.hasOwnProperty(key)) {\n\t\t\t\t\tdst[key] = src[key];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn dst;\n\t}\n\n\n\t// Export utils\n\tSortable.utils = {\n\t\ton: _on,\n\t\toff: _off,\n\t\tcss: _css,\n\t\tfind: _find,\n\t\tis: function (el, selector) {\n\t\t\treturn !!_closest(el, selector, el);\n\t\t},\n\t\textend: _extend,\n\t\tthrottle: _throttle,\n\t\tclosest: _closest,\n\t\ttoggleClass: _toggleClass,\n\t\tindex: _index\n\t};\n\n\n\t/**\n\t * Create sortable instance\n\t * @param {HTMLElement}  el\n\t * @param {Object}      [options]\n\t */\n\tSortable.create = function (el, options) {\n\t\treturn new Sortable(el, options);\n\t};\n\n\n\t// Export\n\tSortable.version = '1.3.0';\n\treturn Sortable;\n});\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/sortablejs/Sortable.js\n// module id = 38\n// module chunks = 0","import Proj4 from \"proj4\";\n\n/**\n * Register definition for IGNF, and EPSG CRS.\n * @example\n * Gp.Register.IGNF.AMST63\n *   // return : \"+title=Amsterdam 1963 +proj=geocent +towgs84=109.753,-528.133,-362.244,0,0,0,0 +a=6378388.0000 +rf=297.0000000000000 +units=m +no_defs\"\n * Gp.Register.get(\"IGNF:AMST63\")\n *   // same as Gp.Register.IGNF.AMST63\n */\nvar Register = {\n\n    /**\n     * instance already loaded into proj4\n     *\n     * @private\n     */\n    isLoaded: false,\n\n    /**\n     * get the definition for a code\n     *\n     * @param {String} name - ie. EPSG:2154 (Lambert)\n     * @returns {Object}\n     */\n    get: function(name) {\n        if (name === \"\" || name === null || typeof name === \"undefined\") {\n            return;\n        }\n\n        var s = name.split(\":\");\n        if (s.length !== 2) {\n            return;\n        }\n\n        var register = s[0];\n        var code = s[1];\n\n        if (!this.hasOwnProperty(register)) {\n            return;\n        }\n\n        if (!this[register].hasOwnProperty(code)) {\n            return;\n        }\n\n        return this[register][code];\n    },\n\n    /**\n     * load all defs to proj4\n     */\n    load: function() {\n        if (!this.isLoaded) {\n\n            var registers = [\"IGNF\", \"EPSG\", \"CRS\"];\n            for (var i = 0; i < registers.length; i++) {\n                var register = registers[i];\n                var codes = this[register];\n                for (var code in codes) {\n                    if (codes.hasOwnProperty(code)) {\n                        var name = register + \":\" + code;\n                        Proj4.defs(name, this.get(name));\n                    }\n                }\n            }\n            this.isLoaded = true;\n        }\n    },\n\n    // definitions\n    EPSG: {\n        4149: \"+title=CH1903 +proj=longlat +ellps=bessel +towgs84=674.374,15.056,405.346,0,0,0,0 +no_defs \",\n        4150: \"+title=CH1903plus +proj=longlat +ellps=bessel +towgs84=674.374,15.056,405.346,0,0,0,0 +no_defs \",\n        4151: \"+title=CHTRF95 +proj=longlat +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +no_defs \",\n        4171: \"+title=RGF93 +proj=longlat +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +no_defs \",\n        4230: \"+title=ED50 +proj=longlat +ellps=intl +no_defs \",\n        4235: \"+title=Guyane Francaise +proj=longlat +ellps=intl +no_defs \",\n        4258: \"+title=ETRS89 +proj=longlat +ellps=GRS80 +no_defs \",\n        4275: \"+title=NTF +proj=longlat +a=6378249.2 +b=6356515 +towgs84=-168,-60,320,0,0,0,0 +no_defs \",\n        4322: \"+title=WGS 72 +proj=longlat +ellps=WGS72 +no_defs \",\n        4326: \"+title=WGS 84 +proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs \",\n        4467: \"+proj=utm +zone=21 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs \",\n        4470: \"+proj=longlat +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +no_defs \",\n        4471: \"+proj=utm +zone=38 +south +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs \",\n        4474: \"+proj=utm +zone=38 +south +ellps=intl +towgs84=-382,-59,-262,0,0,0,0 +units=m +no_defs \",\n        4558: \"+proj=longlat +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +no_defs \",\n        4559: \"+proj=utm +zone=20 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs \",\n        4621: \"+title=Fort Marigot +proj=longlat +ellps=intl +towgs84=137,248,-430,0,0,0,0 +no_defs \",\n        4622: \"+title=Guadeloupe 1948 +proj=longlat +ellps=intl +no_defs \",\n        4623: \"+title=CSG67 +proj=longlat +ellps=intl +towgs84=-186,230,110,0,0,0,0 +no_defs \",\n        4624: \"+title=RGFG95 +proj=longlat +ellps=GRS80 +towgs84=2,2,-2,0,0,0,0 +no_defs \",\n        4625: \"+title=Martinique 1938 +proj=longlat +ellps=intl +no_defs \",\n        4626: \"+title=Reunion 1947 +proj=longlat +ellps=intl +no_defs \",\n        4627: \"+title=RGR92 +proj=longlat +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +no_defs \",\n        4628: \"+title=Tahiti 52 +proj=longlat +ellps=intl +towgs84=162,117,154,0,0,0,0 +no_defs \",\n        4629: \"+title=Tahaa 54 +proj=longlat +ellps=intl +no_defs \",\n        4630: \"+title=IGN72 Nuku Hiva +proj=longlat +ellps=intl +no_defs \",\n        4632: \"+title=Combani 1950 +proj=longlat +ellps=intl +towgs84=-382,-59,-262,0,0,0,0 +no_defs \",\n        4633: \"+title=IGN56 Lifou +proj=longlat +ellps=intl +no_defs \",\n        4634: \"+title=IGN72 Grand Terre +proj=longlat +ellps=intl +no_defs \",\n        4637: \"+title=Perroud 1950 +proj=longlat +ellps=intl +towgs84=325,154,172,0,0,0,0 +no_defs \",\n        4638: \"+title=Saint Pierre et Miquelon 1950 +proj=longlat +ellps=clrk66 +towgs84=30,430,368,0,0,0,0 +no_defs \",\n        4640: \"+title=RRAF 1991 +proj=longlat +ellps=WGS84 +towgs84=0,0,0,0,0,0,0 +no_defs \",\n        4641: \"+title=IGN53 Mare +proj=longlat +ellps=intl +no_defs \",\n        4645: \"+title=RGNC 1991 +proj=longlat +ellps=intl +towgs84=0,0,0,0,0,0,0 +no_defs \",\n        4687: \"+proj=longlat +ellps=GRS80 +no_defs \",\n        4662: \"+title=IGN72 Grande Terre +proj=longlat +ellps=intl +no_defs \",\n        4689: \"+title=IGN63 Hiva Oa +proj=longlat +ellps=intl +no_defs \",\n        4690: \"+title=Tahiti 79 +proj=longlat +ellps=intl +no_defs \",\n        4691: \"+title=Moorea 87 +proj=longlat +ellps=intl +towgs84=215.525,149.593,176.229,-3.2624,-1.692,-1.1571,10.4773 +no_defs \",\n        4692: \"+title=Maupiti 83 +proj=longlat +ellps=intl +towgs84=217.037,86.959,23.956,0,0,0,0 +no_defs \",\n        4698: \"+title=IGN 1962 Kerguelen +proj=longlat +ellps=intl +towgs84=145,-187,103,0,0,0,0 +no_defs \",\n        4749: \"+title=RGNC91-93 +proj=longlat +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +no_defs \",\n        4750: \"+title=ST87 Ouvea +proj=longlat +ellps=WGS84 +towgs84=-56.263,16.136,-22.856,0,0,0,0 +no_defs \",\n        4807: \"+title=NTF (Paris) +proj=longlat +a=6378249.2 +b=6356515 +towgs84=-168,-60,320,0,0,0,0 +pm=paris +no_defs \",\n        2056: \"+title=CH1903+ / LV95 +proj=somerc +lat_0=46.95240555555556 +lon_0=7.439583333333333 +x_0=2600000 +y_0=1200000 +ellps=bessel +towgs84=674.374,15.056,405.346,0,0,0,0 +units=m +no_defs \",\n        2154: \"+title=RGF93 / Lambert-93 +proj=lcc +lat_1=49 +lat_2=44 +lat_0=46.5 +lon_0=3 +x_0=700000 +y_0=6600000 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs \",\n        2213: \"+title=ETRS89 / TM 30 NE +proj=tmerc +lat_0=0 +lon_0=30 +k=0.9996 +x_0=500000 +y_0=0 +ellps=GRS80 +units=m +no_defs \",\n        2969: \"+title=Fort Marigot / UTM zone 20N +proj=utm +zone=20 +ellps=intl +towgs84=137,248,-430,0,0,0,0 +units=m +no_defs \",\n        2970: \"+title=Guadeloupe 1948 / UTM zone 20N +proj=utm +zone=20 +ellps=intl +units=m +no_defs \",\n        2971: \"+title=CSG67 / UTM zone 22N +proj=utm +zone=22 +ellps=intl +towgs84=-186,230,110,0,0,0,0 +units=m +no_defs \",\n        2972: \"+title=RGFG95 / UTM zone 22N +proj=utm +zone=22 +ellps=GRS80 +towgs84=2,2,-2,0,0,0,0 +units=m +no_defs \",\n        2973: \"+title=Martinique 1938 / UTM zone 20N +proj=utm +zone=20 +ellps=intl +units=m +no_defs \",\n        2975: \"+title=RGR92 / UTM zone 40S +proj=utm +zone=40 +south +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs \",\n        2976: \"+title=Tahiti 52 / UTM zone 6S +proj=utm +zone=6 +south +ellps=intl +towgs84=162,117,154,0,0,0,0 +units=m +no_defs \",\n        2977: \"+title=Tahaa 54 / UTM zone 5S +proj=utm +zone=5 +south +ellps=intl +units=m +no_defs \",\n        2978: \"+title=IGN72 Nuku Hiva / UTM zone 7S +proj=utm +zone=7 +south +ellps=intl +units=m +no_defs \",\n        2980: \"+title=Combani 1950 / UTM zone 38S +proj=utm +zone=38 +south +ellps=intl +towgs84=-382,-59,-262,0,0,0,0 +units=m +no_defs \",\n        2981: \"+title=IGN56 Lifou / UTM zone 58S +proj=utm +zone=58 +south +ellps=intl +units=m +no_defs \",\n        2982: \"+title=IGN72 Grand Terre / UTM zone 58S (deprecated) +proj=utm +zone=58 +south +ellps=intl +units=m +no_defs \",\n        2984: \"+title=RGNC 1991 / Lambert New Caledonia (deprecated) +proj=lcc +lat_1=-20.66666666666667 +lat_2=-22.33333333333333 +lat_0=-21.5 +lon_0=166 +x_0=400000 +y_0=300000 +ellps=intl +towgs84=0,0,0,0,0,0,0 +units=m +no_defs \",\n        2986: \"+title=Terre Adelie 1950 +proj=stere +towgs84=324.9120,153.2820,172.0260 +a=6378388.0000 +rf=297.0000000000000 +lat_0=-90.000000000 +lon_0=140.000000000 +lat_ts=-67.000000000 +k=0.96027295 +x_0=300000.000 +y_0=-2299363.482 +units=m +no_defs\",\n        2987: \"+title=Saint Pierre et Miquelon 1950 / UTM zone 21N +proj=utm +zone=21 +ellps=clrk66 +towgs84=30,430,368,0,0,0,0 +units=m +no_defs \",\n        2989: \"+title=RRAF 1991 / UTM zone 20N +proj=utm +zone=20 +ellps=WGS84 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs \",\n        2990: \"+title=Reunion 1947 / TM Reunion (deprecated) +proj=tmerc +lat_0=-21.11666666666667 +lon_0=55.53333333333333 +k=1 +x_0=50000 +y_0=160000 +ellps=intl +units=m +no_defs \",\n        2995: \"+title=IGN53 Mare / UTM zone 58S +proj=utm +zone=58 +south +ellps=intl +units=m +no_defs \",\n        3038: \"+proj=utm +zone=26 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs \",\n        3039: \"+proj=utm +zone=27 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs \",\n        3040: \"+proj=utm +zone=28 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs \",\n        3041: \"+proj=utm +zone=29 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs \",\n        // 3042 : \"+proj=utm +zone=30 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs \",\n        // 3043 : \"+proj=utm +zone=31 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs \",\n        // 3044 : \"+proj=utm +zone=32 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs \",\n        3045: \"+proj=utm +zone=33 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs \",\n        3046: \"+proj=utm +zone=34 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs \",\n        3047: \"+proj=utm +zone=35 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs \",\n        3048: \"+proj=utm +zone=36 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs \",\n        3049: \"+proj=utm +zone=37 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs \",\n        3050: \"+proj=utm +zone=38 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs \",\n        3051: \"+proj=utm +zone=39 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs \",\n        3034: \"+title=ETRS89 / ETRS-LCC +proj=lcc +lat_1=35 +lat_2=65 +lat_0=52 +lon_0=10 +x_0=4000000 +y_0=2800000 +ellps=GRS80 +units=m +no_defs \",\n        3035: \"+title=ETRS89 / ETRS-LAEA +proj=laea +lat_0=52 +lon_0=10 +x_0=4321000 +y_0=3210000 +ellps=GRS80 +units=m +no_defs \",\n        3042: \"+title=ETRS89 / ETRS-TM30 +proj=utm +zone=30 +ellps=GRS80 +units=m +no_defs \",\n        3043: \"+title=ETRS89 / ETRS-TM31 +proj=utm +zone=31 +ellps=GRS80 +units=m +no_defs \",\n        3044: \"+title=ETRS89 / ETRS-TM32 +proj=utm +zone=32 +ellps=GRS80 +units=m +no_defs \",\n        25828: \"+proj=utm +zone=28 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs \",\n        25829: \"+proj=utm +zone=29 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs \",\n        // 25830 : \"+proj=utm +zone=30 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs \",\n        // 25831 : \"+proj=utm +zone=31 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs \",\n        // 25832 : \"+proj=utm +zone=32 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs \",\n        25833: \"+proj=utm +zone=33 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs \",\n        25834: \"+proj=utm +zone=34 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs \",\n        25835: \"+proj=utm +zone=35 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs \",\n        25836: \"+proj=utm +zone=36 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs \",\n        25837: \"+proj=utm +zone=37 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs \",\n        25838: \"+proj=utm +zone=38 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs \",\n        3060: \"+title=IGN72 Grande Terre / UTM zone 58S +proj=utm +zone=58 +south +ellps=intl +units=m +no_defs \",\n        3163: \"+title=RGNC91-93 / Lambert New Caledonia +proj=lcc +lat_1=-20.66666666666667 +lat_2=-22.33333333333333 +lat_0=-21.5 +lon_0=166 +x_0=400000 +y_0=300000 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs \",\n        3164: \"+title=ST87 Ouvea / UTM zone 58S +proj=utm +zone=58 +south +ellps=WGS84 +towgs84=-56.263,16.136,-22.856,0,0,0,0 +units=m +no_defs \",\n        3165: \"+title=NEA74 Noumea / Noumea Lambert +proj=lcc +lat_1=-22.24469175 +lat_2=-22.29469175 +lat_0=-22.26969175 +lon_0=166.44242575 +x_0=0.66 +y_0=1.02 +ellps=intl +units=m +no_defs \",\n        3166: \"+title=NEA74 Noumea / Noumea Lambert 2 +proj=lcc +lat_1=-22.24472222222222 +lat_2=-22.29472222222222 +lat_0=-22.26972222222222 +lon_0=166.4425 +x_0=8.313000000000001 +y_0=-2.354 +ellps=intl +units=m +no_defs \",\n        3169: \"+title=RGNC91-93 / UTM zone 57S +proj=utm +zone=57 +south +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs \",\n        3170: \"+title=RGNC91-93 / UTM zone 58S +proj=utm +zone=58 +south +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs \",\n        3171: \"+title=RGNC91-93 / UTM zone 59S +proj=utm +zone=59 +south +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs \",\n        3172: \"+title=IGN53 Mare / UTM zone 59S +proj=utm +zone=59 +south +ellps=intl +units=m +no_defs \",\n        3296: \"+title=RGPF / UTM zone 5S +proj=utm +zone=5 +south +ellps=GRS80 +units=m +no_defs \",\n        3297: \"+title=RGPF / UTM zone 6S +proj=utm +zone=6 +south +ellps=GRS80 +units=m +no_defs \",\n        3298: \"+title=RGPF / UTM zone 7S +proj=utm +zone=7 +south +ellps=GRS80 +units=m +no_defs \",\n        3299: \"+title=RGPF / UTM zone 8S +proj=utm +zone=8 +south +ellps=GRS80 +units=m +no_defs \",\n        3302: \"+title=IGN63 Hiva Oa / UTM zone 7S +proj=utm +zone=7 +south +ellps=intl +units=m +no_defs \",\n        3303: \"+title=Fatu Iva 72 / UTM zone 7S +proj=utm +zone=7 +south +ellps=intl +towgs84=347.103,1078.12,2623.92,-33.8875,70.6773,-9.3943,186.074 +units=m +no_defs \",\n        3304: \"+title=Tahiti 79 / UTM zone 6S +proj=utm +zone=6 +south +ellps=intl +units=m +no_defs \",\n        3305: \"+title=Moorea 87 / UTM zone 6S +proj=utm +zone=6 +south +ellps=intl +towgs84=215.525,149.593,176.229,-3.2624,-1.692,-1.1571,10.4773 +units=m +no_defs \",\n        3306: \"+title=Maupiti 83 / UTM zone 5S +proj=utm +zone=5 +south +ellps=intl +towgs84=217.037,86.959,23.956,0,0,0,0 +units=m +no_defs \",\n        3312: \"+title=CSG67 / UTM zone 21N +proj=utm +zone=21 +ellps=intl +towgs84=-186,230,110,0,0,0,0 +units=m +no_defs \",\n        3313: \"+title=RGFG95 / UTM zone 21N +proj=utm +zone=21 +ellps=GRS80 +towgs84=2,2,-2,0,0,0,0 +units=m +no_defs \",\n        3336: \"+title=IGN 1962 Kerguelen / UTM zone 42S +proj=utm +zone=42 +south +ellps=intl +towgs84=145,-187,103,0,0,0,0 +units=m +no_defs \",\n        3395: \"+title=WGS 84 / World Mercator +proj=merc +lon_0=0 +k=1 +x_0=0 +y_0=0 +ellps=WGS84 +datum=WGS84 +units=m +no_defs \",\n        3727: \"+title=Reunion 1947 / TM Reunion +proj=tmerc +lat_0=-21.11666666666667 +lon_0=55.53333333333333 +k=1 +x_0=160000 +y_0=50000 +ellps=intl +units=m +no_defs \",\n        21781: \"+title=CH1903 / LV03 +proj=somerc +lat_0=46.95240555555556 +lon_0=7.439583333333333 +x_0=600000 +y_0=200000 +ellps=bessel +towgs84=674.374,15.056,405.346,0,0,0,0 +units=m +no_defs \",\n        25830: \"+title=ETRS89 / UTM zone 30N +proj=utm +zone=30 +ellps=GRS80 +units=m +no_defs \",\n        25831: \"+title=ETRS89 / UTM zone 31N +proj=utm +zone=31 +ellps=GRS80 +units=m +no_defs \",\n        25832: \"+title=ETRS89 / UTM zone 32N +proj=utm +zone=32 +ellps=GRS80 +units=m +no_defs \",\n        27561: \"+title=NTF (Paris) / Lambert Nord France +proj=lcc +lat_1=49.50000000000001 +lat_0=49.50000000000001 +lon_0=0 +k_0=0.999877341 +x_0=600000 +y_0=200000 +a=6378249.2 +b=6356515 +towgs84=-168,-60,320,0,0,0,0 +pm=paris +units=m +no_defs \",\n        27562: \"+title=NTF (Paris) / Lambert Centre France +proj=lcc +lat_1=46.8 +lat_0=46.8 +lon_0=0 +k_0=0.99987742 +x_0=600000 +y_0=200000 +a=6378249.2 +b=6356515 +towgs84=-168,-60,320,0,0,0,0 +pm=paris +units=m +no_defs \",\n        27563: \"+title=NTF (Paris) / Lambert Sud France +proj=lcc +lat_1=44.10000000000001 +lat_0=44.10000000000001 +lon_0=0 +k_0=0.9998774990000001 +x_0=600000 +y_0=200000 +a=6378249.2 +b=6356515 +towgs84=-168,-60,320,0,0,0,0 +pm=paris +units=m +no_defs \",\n        27564: \"+title=NTF (Paris) / Lambert Corse +proj=lcc +lat_1=42.16500000000001 +lat_0=42.16500000000001 +lon_0=0 +k_0=0.9999447100000001 +x_0=234.358 +y_0=185861.369 +a=6378249.2 +b=6356515 +towgs84=-168,-60,320,0,0,0,0 +pm=paris +units=m +no_defs \",\n        27571: \"+title=NTF (Paris) / Lambert zone I +proj=lcc +lat_1=49.50000000000001 +lat_0=49.50000000000001 +lon_0=0 +k_0=0.999877341 +x_0=600000 +y_0=1200000 +a=6378249.2 +b=6356515 +towgs84=-168,-60,320,0,0,0,0 +pm=paris +units=m +no_defs \",\n        27572: \"+title=NTF (Paris) / Lambert zone II +proj=lcc +lat_1=46.8 +lat_0=46.8 +lon_0=0 +k_0=0.99987742 +x_0=600000 +y_0=2200000 +a=6378249.2 +b=6356515 +towgs84=-168,-60,320,0,0,0,0 +pm=paris +units=m +no_defs \",\n        27573: \"+title=NTF (Paris) / Lambert zone III +proj=lcc +lat_1=44.10000000000001 +lat_0=44.10000000000001 +lon_0=0 +k_0=0.9998774990000001 +x_0=600000 +y_0=3200000 +a=6378249.2 +b=6356515 +towgs84=-168,-60,320,0,0,0,0 +pm=paris +units=m +no_defs \",\n        27574: \"+title=NTF (Paris) / Lambert zone IV +proj=lcc +lat_1=42.16500000000001 +lat_0=42.16500000000001 +lon_0=0 +k_0=0.9999447100000001 +x_0=234.358 +y_0=4185861.369 +a=6378249.2 +b=6356515 +towgs84=-168,-60,320,0,0,0,0 +pm=paris +units=m +no_defs \",\n        27581: \"+title=NTF (Paris) / France I (deprecated) +proj=lcc +lat_1=49.50000000000001 +lat_0=49.50000000000001 +lon_0=0 +k_0=0.999877341 +x_0=600000 +y_0=1200000 +a=6378249.2 +b=6356515 +towgs84=-168,-60,320,0,0,0,0 +pm=paris +units=m +no_defs \",\n        27582: \"+title=NTF (Paris) / France II (deprecated) +proj=lcc +lat_1=46.8 +lat_0=46.8 +lon_0=0 +k_0=0.99987742 +x_0=600000 +y_0=2200000 +a=6378249.2 +b=6356515 +towgs84=-168,-60,320,0,0,0,0 +pm=paris +units=m +no_defs \",\n        27583: \"+title=NTF (Paris) / France III (deprecated) +proj=lcc +lat_1=44.10000000000001 +lat_0=44.10000000000001 +lon_0=0 +k_0=0.9998774990000001 +x_0=600000 +y_0=3200000 +a=6378249.2 +b=6356515 +towgs84=-168,-60,320,0,0,0,0 +pm=paris +units=m +no_defs \",\n        27584: \"+title=NTF (Paris) / France IV (deprecated) +proj=lcc +lat_1=42.16500000000001 +lat_0=42.16500000000001 +lon_0=0 +k_0=0.9999447100000001 +x_0=234.358 +y_0=4185861.369 +a=6378249.2 +b=6356515 +towgs84=-168,-60,320,0,0,0,0 +pm=paris +units=m +no_defs \",\n        27591: \"+title=NTF (Paris) / Nord France (deprecated) +proj=lcc +lat_1=49.50000000000001 +lat_0=49.50000000000001 +lon_0=0 +k_0=0.999877341 +x_0=600000 +y_0=200000 +a=6378249.2 +b=6356515 +towgs84=-168,-60,320,0,0,0,0 +pm=paris +units=m +no_defs \",\n        27592: \"+title=NTF (Paris) / Centre France (deprecated) +proj=lcc +lat_1=46.8 +lat_0=46.8 +lon_0=0 +k_0=0.99987742 +x_0=600000 +y_0=200000 +a=6378249.2 +b=6356515 +towgs84=-168,-60,320,0,0,0,0 +pm=paris +units=m +no_defs \",\n        27593: \"+title=NTF (Paris) / Sud France (deprecated) +proj=lcc +lat_1=44.10000000000001 +lat_0=44.10000000000001 +lon_0=0 +k_0=0.9998774990000001 +x_0=600000 +y_0=200000 +a=6378249.2 +b=6356515 +towgs84=-168,-60,320,0,0,0,0 +pm=paris +units=m +no_defs \",\n        27594: \"+title=NTF (Paris) / Corse (deprecated) +proj=lcc +lat_1=42.16500000000001 +lat_0=42.16500000000001 +lon_0=0 +k_0=0.9999447100000001 +x_0=234.358 +y_0=185861.369 +a=6378249.2 +b=6356515 +towgs84=-168,-60,320,0,0,0,0 +pm=paris +units=m +no_defs \",\n        32601: \"+proj=utm +zone=1 +ellps=WGS84 +datum=WGS84 +units=m +no_defs \",\n        32602: \"+proj=utm +zone=2 +ellps=WGS84 +datum=WGS84 +units=m +no_defs \",\n        32603: \"+proj=utm +zone=3 +ellps=WGS84 +datum=WGS84 +units=m +no_defs \",\n        32604: \"+proj=utm +zone=4 +ellps=WGS84 +datum=WGS84 +units=m +no_defs \",\n        32605: \"+proj=utm +zone=5 +ellps=WGS84 +datum=WGS84 +units=m +no_defs \",\n        32606: \"+proj=utm +zone=6 +ellps=WGS84 +datum=WGS84 +units=m +no_defs \",\n        32607: \"+proj=utm +zone=7 +ellps=WGS84 +datum=WGS84 +units=m +no_defs \",\n        32608: \"+proj=utm +zone=8 +ellps=WGS84 +datum=WGS84 +units=m +no_defs \",\n        32609: \"+proj=utm +zone=9 +ellps=WGS84 +datum=WGS84 +units=m +no_defs \",\n        32610: \"+proj=utm +zone=10 +ellps=WGS84 +datum=WGS84 +units=m +no_defs \",\n        32611: \"+proj=utm +zone=11 +ellps=WGS84 +datum=WGS84 +units=m +no_defs \",\n        32612: \"+proj=utm +zone=12 +ellps=WGS84 +datum=WGS84 +units=m +no_defs \",\n        32613: \"+proj=utm +zone=13 +ellps=WGS84 +datum=WGS84 +units=m +no_defs \",\n        32614: \"+proj=utm +zone=14 +ellps=WGS84 +datum=WGS84 +units=m +no_defs \",\n        32615: \"+proj=utm +zone=15 +ellps=WGS84 +datum=WGS84 +units=m +no_defs \",\n        32616: \"+proj=utm +zone=16 +ellps=WGS84 +datum=WGS84 +units=m +no_defs \",\n        32617: \"+proj=utm +zone=17 +ellps=WGS84 +datum=WGS84 +units=m +no_defs \",\n        32618: \"+proj=utm +zone=18 +ellps=WGS84 +datum=WGS84 +units=m +no_defs \",\n        32619: \"+proj=utm +zone=19 +ellps=WGS84 +datum=WGS84 +units=m +no_defs \",\n        32620: \"+proj=utm +zone=20 +ellps=WGS84 +datum=WGS84 +units=m +no_defs \",\n        32621: \"+proj=utm +zone=21 +ellps=WGS84 +datum=WGS84 +units=m +no_defs \",\n        32622: \"+proj=utm +zone=22 +ellps=WGS84 +datum=WGS84 +units=m +no_defs \",\n        32623: \"+proj=utm +zone=23 +ellps=WGS84 +datum=WGS84 +units=m +no_defs \",\n        32624: \"+proj=utm +zone=24 +ellps=WGS84 +datum=WGS84 +units=m +no_defs \",\n        32625: \"+proj=utm +zone=25 +ellps=WGS84 +datum=WGS84 +units=m +no_defs \",\n        32626: \"+proj=utm +zone=26 +ellps=WGS84 +datum=WGS84 +units=m +no_defs \",\n        32627: \"+proj=utm +zone=27 +ellps=WGS84 +datum=WGS84 +units=m +no_defs \",\n        32628: \"+proj=utm +zone=28 +ellps=WGS84 +datum=WGS84 +units=m +no_defs \",\n        32629: \"+proj=utm +zone=29 +ellps=WGS84 +datum=WGS84 +units=m +no_defs \",\n        32630: \"+proj=utm +zone=30 +ellps=WGS84 +datum=WGS84 +units=m +no_defs \",\n        32631: \"+proj=utm +zone=31 +ellps=WGS84 +datum=WGS84 +units=m +no_defs \",\n        32632: \"+proj=utm +zone=32 +ellps=WGS84 +datum=WGS84 +units=m +no_defs \",\n        32633: \"+proj=utm +zone=33 +ellps=WGS84 +datum=WGS84 +units=m +no_defs \",\n        32634: \"+proj=utm +zone=34 +ellps=WGS84 +datum=WGS84 +units=m +no_defs \",\n        32635: \"+proj=utm +zone=35 +ellps=WGS84 +datum=WGS84 +units=m +no_defs \",\n        32636: \"+proj=utm +zone=36 +ellps=WGS84 +datum=WGS84 +units=m +no_defs \",\n        32637: \"+proj=utm +zone=37 +ellps=WGS84 +datum=WGS84 +units=m +no_defs \",\n        32638: \"+proj=utm +zone=38 +ellps=WGS84 +datum=WGS84 +units=m +no_defs \",\n        32639: \"+proj=utm +zone=39 +ellps=WGS84 +datum=WGS84 +units=m +no_defs \",\n        32640: \"+proj=utm +zone=40 +ellps=WGS84 +datum=WGS84 +units=m +no_defs \",\n        32641: \"+proj=utm +zone=41 +ellps=WGS84 +datum=WGS84 +units=m +no_defs \",\n        32642: \"+proj=utm +zone=42 +ellps=WGS84 +datum=WGS84 +units=m +no_defs \",\n        32643: \"+proj=utm +zone=43 +ellps=WGS84 +datum=WGS84 +units=m +no_defs \",\n        32644: \"+proj=utm +zone=44 +ellps=WGS84 +datum=WGS84 +units=m +no_defs \",\n        32645: \"+proj=utm +zone=45 +ellps=WGS84 +datum=WGS84 +units=m +no_defs \",\n        32646: \"+proj=utm +zone=46 +ellps=WGS84 +datum=WGS84 +units=m +no_defs \",\n        32647: \"+proj=utm +zone=47 +ellps=WGS84 +datum=WGS84 +units=m +no_defs \",\n        32648: \"+proj=utm +zone=48 +ellps=WGS84 +datum=WGS84 +units=m +no_defs \",\n        32649: \"+proj=utm +zone=49 +ellps=WGS84 +datum=WGS84 +units=m +no_defs \",\n        32650: \"+proj=utm +zone=50 +ellps=WGS84 +datum=WGS84 +units=m +no_defs \",\n        32651: \"+proj=utm +zone=51 +ellps=WGS84 +datum=WGS84 +units=m +no_defs \",\n        32652: \"+proj=utm +zone=52 +ellps=WGS84 +datum=WGS84 +units=m +no_defs \",\n        32653: \"+proj=utm +zone=53 +ellps=WGS84 +datum=WGS84 +units=m +no_defs \",\n        32654: \"+proj=utm +zone=54 +ellps=WGS84 +datum=WGS84 +units=m +no_defs \",\n        32655: \"+proj=utm +zone=55 +ellps=WGS84 +datum=WGS84 +units=m +no_defs \",\n        32656: \"+proj=utm +zone=56 +ellps=WGS84 +datum=WGS84 +units=m +no_defs \",\n        32657: \"+proj=utm +zone=57 +ellps=WGS84 +datum=WGS84 +units=m +no_defs \",\n        32658: \"+proj=utm +zone=58 +ellps=WGS84 +datum=WGS84 +units=m +no_defs \",\n        32659: \"+proj=utm +zone=59 +ellps=WGS84 +datum=WGS84 +units=m +no_defs \",\n        32660: \"+proj=utm +zone=60 +ellps=WGS84 +datum=WGS84 +units=m +no_defs \",\n        32661: \"+proj=stere +lat_0=90 +lat_ts=90 +lon_0=0 +k=0.994 +x_0=2000000 +y_0=2000000 +ellps=WGS84 +datum=WGS84 +units=m +no_defs \",\n        32662: \"+title=WGS 84 / Plate Carree +proj=eqc +lat_ts=0 +lon_0=0 +x_0=0 +y_0=0 +ellps=WGS84 +datum=WGS84 +units=m +no_defs \",\n        32701: \"+proj=utm +zone=1 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs \",\n        32702: \"+proj=utm +zone=2 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs \",\n        32703: \"+proj=utm +zone=3 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs \",\n        32704: \"+proj=utm +zone=4 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs \",\n        32705: \"+proj=utm +zone=5 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs \",\n        32706: \"+proj=utm +zone=6 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs \",\n        32707: \"+proj=utm +zone=7 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs \",\n        32708: \"+proj=utm +zone=8 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs \",\n        32709: \"+proj=utm +zone=9 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs \",\n        32710: \"+proj=utm +zone=10 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs \",\n        32711: \"+proj=utm +zone=11 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs \",\n        32712: \"+proj=utm +zone=12 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs \",\n        32713: \"+proj=utm +zone=13 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs \",\n        32714: \"+proj=utm +zone=14 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs \",\n        32715: \"+proj=utm +zone=15 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs \",\n        32716: \"+proj=utm +zone=16 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs \",\n        32717: \"+proj=utm +zone=17 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs \",\n        32718: \"+proj=utm +zone=18 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs \",\n        32719: \"+proj=utm +zone=19 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs \",\n        32720: \"+proj=utm +zone=20 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs \",\n        32721: \"+proj=utm +zone=21 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs \",\n        32722: \"+proj=utm +zone=22 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs \",\n        32723: \"+proj=utm +zone=23 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs \",\n        32724: \"+proj=utm +zone=24 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs \",\n        32725: \"+proj=utm +zone=25 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs \",\n        32726: \"+proj=utm +zone=26 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs \",\n        32727: \"+proj=utm +zone=27 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs \",\n        32728: \"+proj=utm +zone=28 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs \",\n        32729: \"+proj=utm +zone=29 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs \",\n        32730: \"+proj=utm +zone=30 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs \",\n        32731: \"+proj=utm +zone=31 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs \",\n        32732: \"+proj=utm +zone=32 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs \",\n        32733: \"+proj=utm +zone=33 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs \",\n        32734: \"+proj=utm +zone=34 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs \",\n        32735: \"+proj=utm +zone=35 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs \",\n        32736: \"+proj=utm +zone=36 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs \",\n        32737: \"+proj=utm +zone=37 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs \",\n        32738: \"+proj=utm +zone=38 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs \",\n        32739: \"+proj=utm +zone=39 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs \",\n        32740: \"+proj=utm +zone=40 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs \",\n        32741: \"+proj=utm +zone=41 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs \",\n        32742: \"+proj=utm +zone=42 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs \",\n        32743: \"+proj=utm +zone=43 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs \",\n        32744: \"+proj=utm +zone=44 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs \",\n        32745: \"+proj=utm +zone=45 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs \",\n        32746: \"+proj=utm +zone=46 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs \",\n        32747: \"+proj=utm +zone=47 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs \",\n        32748: \"+proj=utm +zone=48 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs \",\n        32749: \"+proj=utm +zone=49 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs \",\n        32750: \"+proj=utm +zone=50 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs \",\n        32751: \"+proj=utm +zone=51 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs \",\n        32752: \"+proj=utm +zone=52 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs \",\n        32753: \"+proj=utm +zone=53 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs \",\n        32754: \"+proj=utm +zone=54 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs \",\n        32755: \"+proj=utm +zone=55 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs \",\n        32756: \"+proj=utm +zone=56 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs \",\n        32757: \"+proj=utm +zone=57 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs \",\n        32758: \"+proj=utm +zone=58 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs \",\n        32759: \"+proj=utm +zone=59 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs \",\n        32760: \"+proj=utm +zone=60 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs \",\n        32761: \"+proj=stere +lat_0=-90 +lat_ts=-90 +lon_0=0 +k=0.994 +x_0=2000000 +y_0=2000000 +ellps=WGS84 +datum=WGS84 +units=m +no_defs \",\n        310024802: \"+title=Geoportail - France metropolitaine +proj=eqc +nadgrids=null +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=0.000000000 +lat_ts=46.500000000 +x_0=0.000 +y_0=0.000 +units=m +no_defs\",\n        310915814: \"+title=Geoportail - Antilles francaises +proj=eqc +nadgrids=null +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=0.000000000 +lat_ts=15.000000000 +x_0=0.000 +y_0=0.000 +units=m +no_defs\",\n        310486805: \"+title=Geoportail - Guyane +proj=eqc +nadgrids=null +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=0.000000000 +lat_ts=4.000000000 +x_0=0.000 +y_0=0.000 +units=m +no_defs\",\n        310700806: \"+title=Geoportail - Reunion et dependances +proj=eqc +nadgrids=null +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=0.000000000 +lat_ts=-21.000000000 +x_0=0.000 +y_0=0.000 +units=m +no_defs\",\n        310702807: \"+title=Geoportail - Mayotte +proj=eqc +nadgrids=null +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=0.000000000 +lat_ts=-12.000000000 +x_0=0.000 +y_0=0.000 +units=m +no_defs\",\n        310706808: \"+title=Geoportail - Saint-Pierre et Miquelon +proj=eqc +nadgrids=null +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=0.000000000 +lat_ts=47.000000000 +x_0=0.000 +y_0=0.000 +units=m +no_defs\",\n        310547809: \"+title=Geoportail - Nouvelle-Caledonie +proj=eqc +nadgrids=null +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=0.000000000 +lat_ts=-22.000000000 +x_0=0.000 +y_0=0.000 +units=m +no_defs\",\n        310642810: \"+title=Geoportail - Wallis et Futuna +proj=eqc +nadgrids=null +towgs84=0.0000,0.0000,0.0000,0.0000,0.0000,0.0000,0.000000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=0.000000000 +lat_ts=-14.000000000 +x_0=0.000 +y_0=0.000 +units=m +no_defs\",\n        310032811: \"+title=Geoportail - Polynesie francaise +proj=eqc +nadgrids=null +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=0.000000000 +lat_ts=-15.000000000 +x_0=0.000 +y_0=0.000 +units=m +no_defs\",\n        310642812: \"+title=Geoportail - Kerguelen +proj=eqc +nadgrids=null +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=0.000000000 +lat_ts=-49.500000000 +x_0=0.000 +y_0=0.000 +units=m +no_defs\",\n        310642801: \"+title=Geoportail - Crozet +proj=eqc +nadgrids=null +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=0.000000000 +lat_ts=-46.000000000 +x_0=0.000 +y_0=0.000 +units=m +no_defs\",\n        310642813: \"+title=Geoportail - Amsterdam et Saint-Paul +proj=eqc +nadgrids=null +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=0.000000000 +lat_ts=-38.000000000 +x_0=0.000 +y_0=0.000 +units=m +no_defs\",\n        310642901: \"+title=Geoportail - Monde +proj=mill +towgs84=0.0000,0.0000,0.0000,0.0000,0.0000,0.0000,0.000000 +a=6378137.0000 +rf=298.2572221010000 +lon_0=0.000000000 +x_0=0.000 +y_0=0.000 +units=m +no_defs\",\n        5489: \"+title=RGAF09 geographiques (dms) +proj=longlat +nadgrids=@null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137 +rf=298.257222101 +units=m +no_defs\",\n        5490: \"+title=RGAF09 UTM Nord Fuseau 20 +proj=tmerc +nadgrids=@null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137 +rf=298.257222101 +lat_0=0.000000000 +lon_0=-63.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=0.000 +units=m +no_defs\"\n    },\n    CRS: {\n        84: \"+title=WGS 84 longitude-latitude +proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs \"\n    },\n    IGNF: {\n        AMST63: \"+title=Amsterdam 1963 +proj=geocent +towgs84=109.753,-528.133,-362.244,0,0,0,0 +a=6378388.0000 +rf=297.0000000000000 +units=m +no_defs\",\n        CROZ63: \"+title=Crozet 1963 +proj=geocent +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378388.0000 +rf=297.0000000000000 +units=m +no_defs\",\n        CSG67: \"+title=Guyane CSG67 +proj=geocent +towgs84=-193.0660,236.9930,105.4470,0.4814,-0.8074,0.1276,1.564900 +a=6378388.0000 +rf=297.0000000000000 +units=m +no_defs\",\n        ED50: \"+title=ED50 +proj=geocent +towgs84=-84.0000,-97.0000,-117.0000 +a=6378388.0000 +rf=297.0000000000000 +units=m +no_defs\",\n        ETRS89: \"+title=Systeme de reference terrestre Europeen (1989) +proj=geocent +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +units=m +no_defs\",\n        GUAD48: \"+title=Guadeloupe Ste Anne +proj=geocent +towgs84=-472.2900,-5.6300,-304.1200,0.4362,-0.8374,0.2563,1.898400 +a=6378388.0000 +rf=297.0000000000000 +units=m +no_defs\",\n        GUADFM49: \"+title=Guadeloupe Fort Marigot +proj=geocent +towgs84=136.5960,248.1480,-429.7890 +a=6378388.0000 +rf=297.0000000000000 +units=m +no_defs\",\n        IGN63: \"+title=IGN 1963 (Hiva Oa, Tahuata, Mohotani) +proj=geocent +towgs84=410.7210,55.0490,80.7460,-2.5779,-2.3514,-0.6664,17.331100 +a=6378388.0000 +rf=297.0000000000000 +units=m +no_defs\",\n        IGN72: \"+title=IGN 1972 Grande-Terre / Ile des Pins +proj=geocent +towgs84=-11.6400,-348.6000,291.6800 +a=6378388.0000 +rf=297.0000000000000 +units=m +no_defs\",\n        KERG62CAR: \"+title=Kerguelen - K0 +proj=geocent +towgs84=144.8990,-186.7700,100.9230 +a=6378388.0000 +rf=297.0000000000000 +units=m +no_defs\",\n        MART38: \"+title=Martinique Fort-Desaix +proj=geocent +towgs84=126.9260,547.9390,130.4090,-2.7867,5.1612,-0.8584,13.822650 +a=6378388.0000 +rf=297.0000000000000 +units=m +no_defs\",\n        MAYO50: \"+title=Mayotte Combani +proj=geocent +towgs84=-599.9280,-275.5520,-195.6650,-0.0835,-0.4715,0.0602,49.281400 +a=6378388.0000 +rf=297.0000000000000 +units=m +no_defs\",\n        MOOREA87: \"+title=Moorea 1987 +proj=geocent +towgs84=215.9820,149.5930,176.2290,3.2624,1.6920,1.1571,10.477300 +a=6378388.0000 +rf=297.0000000000000 +units=m +no_defs\",\n        NTF: \"+title=Nouvelle Triangulation Francaise +proj=geocent +nadgrids=ntf_r93.gsb,null +wktext +towgs84=-168.0000,-60.0000,320.0000 +a=6378249.2000 +rf=293.4660210000000 +units=m +no_defs\",\n        NUKU72: \"+title=IGN 1972 Nuku Hiva +proj=geocent +towgs84=165.7320,216.7200,180.5050,-0.6434,-0.4512,-0.0791,7.420400 +a=6378388.0000 +rf=297.0000000000000 +units=m +no_defs\",\n        REUN47: \"+title=Reunion 1947 +proj=geocent +towgs84=789.5240,-626.4860,-89.9040,0.6006,76.7946,-10.5788,-32.324100 +a=6378388.0000 +rf=297.0000000000000 +units=m +no_defs\",\n        RGF93: \"+title=Reseau geodesique francais 1993 +proj=geocent +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +units=m +no_defs\",\n        RGFG95: \"+title=Reseau geodesique francais de Guyane 1995 +proj=geocent +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +units=m +no_defs\",\n        RGM04: \"+title=RGM04 (Reseau Geodesique de Mayotte 2004) +proj=geocent +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +units=m +no_defs\",\n        RGNC: \"+title=Reseau Geodesique de Nouvelle-Caledonie +proj=geocent +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +units=m +no_defs\",\n        RGPF: \"+title=RGPF (Reseau Geodesique de Polynesie Francaise) +proj=geocent +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +units=m +no_defs\",\n        RGR92: \"+title=Reseau geodesique Reunion 1992 +proj=geocent +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +units=m +no_defs\",\n        RGSPM06: \"+title=Reseau Geodesique Saint-Pierre-et-Miquelon (2006) +proj=geocent +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +units=m +no_defs\",\n        RGTAAF07: \"+title=Reseau Geodesique des TAAF (2007) +proj=geocent +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +units=m +no_defs\",\n        RRAF91: \"+title=RRAF 1991 (Reseau de Reference des Antilles Francaises) +proj=geocent +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +units=m +no_defs\",\n        STPL69: \"+title=Saint-Paul 1969 +proj=geocent +towgs84=225.571,-346.608,-46.567,0,0,0,0 +a=6378388.0000 +rf=297.0000000000000 +units=m +no_defs\",\n        STPM50: \"+title=St Pierre et Miquelon 1950 +proj=geocent +towgs84=-95.5930,573.7630,173.4420,-0.9602,1.2510,-1.3918,42.626500 +a=6378206.4000 +rf=294.9786982000000 +units=m +no_defs\",\n        TAHAA: \"+title=Raiatea - Tahaa 51-54 (Tahaa, Base Terme Est) +proj=geocent +towgs84=72.4380,345.9180,79.4860,-1.6045,-0.8823,-0.5565,1.374600 +a=6378388.0000 +rf=297.0000000000000 +units=m +no_defs\",\n        TAHI79: \"+title=IGN79 (Tahiti) Iles de la Societe +proj=geocent +towgs84=221.5250,152.9480,176.7680,2.3847,1.3896,0.8770,11.474100 +a=6378388.0000 +rf=297.0000000000000 +units=m +no_defs\",\n        TERA50: \"+title=Pointe Geologie - Perroud 1950 +proj=geocent +towgs84=324.9120,153.2820,172.0260 +a=6378388.0000 +rf=297.0000000000000 +units=m +no_defs\",\n        WALL78: \"+title=Wallis-Uvea 1978 (MOP78) +proj=geocent +towgs84=253.0000,-133.0000,-127.0000 +a=6378388.0000 +rf=297.0000000000000 +units=m +no_defs\",\n        WGS72: \"+title=World Geodetic System 1972 +proj=geocent +towgs84=0.0000,12.0000,6.0000 +a=6378135.0000 +rf=298.2600000000000 +units=m +no_defs\",\n        WGS84: \"+title=World Geodetic System 1984 +proj=geocent +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +units=m +no_defs\",\n        AMST63GEO: \"+title=Amsterdam 1963 +proj=longlat +towgs84=109.753,-528.133,-362.244,0,0,0,0 +a=6378388.0000 +rf=297.0000000000000 +units=m +no_defs\",\n        CROZ63GEO: \"+title=Crozet 1963 +proj=longlat +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378388.0000 +rf=297.0000000000000 +units=m +no_defs\",\n        CSG67GEO: \"+title=Guyane CSG67 +proj=longlat +towgs84=-193.0660,236.9930,105.4470,0.4814,-0.8074,0.1276,1.564900 +a=6378388.0000 +rf=297.0000000000000 +units=m +no_defs\",\n        ED50G: \"+title=ED50 +proj=longlat +towgs84=-84.0000,-97.0000,-117.0000 +a=6378388.0000 +rf=297.0000000000000 +units=m +no_defs\",\n        GUAD48GEO: \"+title=Guadeloupe Ste Anne +proj=longlat +towgs84=-472.2900,-5.6300,-304.1200,0.4362,-0.8374,0.2563,1.898400 +a=6378388.0000 +rf=297.0000000000000 +units=m +no_defs\",\n        GUADFM49GEO: \"+title=Guadeloupe Fort Marigot +proj=longlat +towgs84=136.5960,248.1480,-429.7890 +a=6378388.0000 +rf=297.0000000000000 +units=m +no_defs\",\n        IGN63GEO: \"+title=IGN 1963 (Hiva Oa, Tahuata, Mohotani) +proj=longlat +towgs84=410.7210,55.0490,80.7460,-2.5779,-2.3514,-0.6664,17.331100 +a=6378388.0000 +rf=297.0000000000000 +units=m +no_defs\",\n        IGN72GEO: \"+title=IGN 1972 Grande-Terre / Ile des Pins +proj=longlat +towgs84=-11.6400,-348.6000,291.6800 +a=6378388.0000 +rf=297.0000000000000 +units=m +no_defs\",\n        KERG62GEO: \"+title=Kerguelen - K0 +proj=longlat +towgs84=144.8990,-186.7700,100.9230 +a=6378388.0000 +rf=297.0000000000000 +units=m +no_defs\",\n        MART38GEO: \"+title=Martinique Fort-Desaix +proj=longlat +towgs84=126.9260,547.9390,130.4090,-2.7867,5.1612,-0.8584,13.822650 +a=6378388.0000 +rf=297.0000000000000 +units=m +no_defs\",\n        MAYO50GEO: \"+title=Mayotte Combani +proj=longlat +towgs84=-599.9280,-275.5520,-195.6650,-0.0835,-0.4715,0.0602,49.281400 +a=6378388.0000 +rf=297.0000000000000 +units=m +no_defs\",\n        MOOREA87GEO: \"+title=Moorea 1987 +proj=longlat +towgs84=215.9820,149.5930,176.2290,3.2624,1.6920,1.1571,10.477300 +a=6378388.0000 +rf=297.0000000000000 +units=m +no_defs\",\n        NTFG: \"+title=Nouvelle Triangulation Francaise Greenwich degres sexagesimaux +proj=longlat +nadgrids=ntf_r93.gsb,null +wktext +towgs84=-168.0000,-60.0000,320.0000 +a=6378249.2000 +rf=293.4660210000000 +units=m +no_defs\",\n        NTFP: \"+title=Nouvelle Triangulation Francaise Paris grades +proj=longlat +nadgrids=ntf_r93.gsb,null +wktext +towgs84=-168.0000,-60.0000,320.0000 +a=6378249.2000 +rf=293.4660210000000 +pm=2.337229167 +units=m +no_defs\",\n        NUKU72GEO: \"+title=IGN 1972 Nuku Hiva +proj=longlat +towgs84=165.7320,216.7200,180.5050,-0.6434,-0.4512,-0.0791,7.420400 +a=6378388.0000 +rf=297.0000000000000 +units=m +no_defs\",\n        REUN47GEO: \"+title=Reunion 1947 +proj=longlat +towgs84=789.5240,-626.4860,-89.9040,0.6006,76.7946,-10.5788,-32.324100 +a=6378388.0000 +rf=297.0000000000000 +units=m +no_defs\",\n        RGF93G: \"+title=Reseau geodesique francais 1993 +proj=longlat +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +units=m +no_defs\",\n        RGFG95GEO: \"+title=Reseau geodesique francais de Guyane 1995 +proj=longlat +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +units=m +no_defs\",\n        RGM04GEO: \"+title=RGM04 (Reseau Geodesique de Mayotte 2004) +proj=longlat +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +units=m +no_defs\",\n        RGNCGEO: \"+title=Reseau Geodesique de Nouvelle-Caledonie +proj=longlat +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +units=m +no_defs\",\n        RGPFGEO: \"+title=RGPF (Reseau Geodesique de Polynesie Francaise) +proj=longlat +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +units=m +no_defs\",\n        RGR92GEO: \"+title=Reseau geodesique de la Reunion 1992 +proj=longlat +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +units=m +no_defs\",\n        RGSPM06GEO: \"+title=Saint-Pierre-et-Miquelon (2006) +proj=longlat +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +units=m +no_defs\",\n        RGTAAF07G: \"+title=Reseau Geodesique des TAAF (2007) (dms) +proj=longlat +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +units=m +no_defs\",\n        STPL69GEO: \"+title=Saint-Paul 1969 +proj=longlat +towgs84=225.571,-346.608,-46.567,0,0,0,0 +a=6378388.0000 +rf=297.0000000000000 +units=m +no_defs\",\n        STPM50GEO: \"+title=St Pierre et Miquelon 1950  +proj=longlat +towgs84=-95.5930,573.7630,173.4420,-0.9602,1.2510,-1.3918,42.626500 +a=6378206.4000 +rf=294.9786982000000 +units=m +no_defs\",\n        TAHAAGEO: \"+title=Raiatea - Tahaa 51-54 (Tahaa, Base Terme Est) +proj=longlat +towgs84=72.4380,345.9180,79.4860,-1.6045,-0.8823,-0.5565,1.374600 +a=6378388.0000 +rf=297.0000000000000 +units=m +no_defs\",\n        TAHI79GEO: \"+title=IGN79 (Tahiti) Iles de la Societe +proj=longlat +towgs84=221.5250,152.9480,176.7680,2.3847,1.3896,0.8770,11.474100 +a=6378388.0000 +rf=297.0000000000000 +units=m +no_defs\",\n        TERA50G: \"+title=Pointe Geologie - Perroud 1950 +proj=longlat +towgs84=324.9120,153.2820,172.0260 +a=6378388.0000 +rf=297.0000000000000 +units=m +no_defs\",\n        WALL78GEO: \"+title=Wallis - Uvea 1978 (MOP78) +proj=longlat +towgs84=253.0000,-133.0000,-127.0000 +a=6378388.0000 +rf=297.0000000000000 +units=m +no_defs\",\n        WGS72G: \"+title=WGS72 +proj=longlat +towgs84=0.0000,12.0000,6.0000 +a=6378135.0000 +rf=298.2600000000000 +units=m +no_defs\",\n        WGS84G: \"+title=World Geodetic System 1984 +proj=longlat +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +units=m +no_defs\",\n        WGS84RRAFGEO: \"+title=Reseau de reference des Antilles francaises (1988-1991) +proj=longlat +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +units=m +no_defs\",\n        XGEO: \"+title=Systeme CIO-BIH +proj=longlat +towgs84=0.0000,0.0000,0.5000,0.0000,0.0000,0.0140,-0.100000 +a=6378137.0000 +rf=298.2572221010000 +units=m +no_defs\",\n        AMST63UTM43S: \"+title=Amsterdam 1963 UTM fuseau 43 Sud +proj=tmerc +towgs84=109.753,-528.133,-362.244,0,0,0,0 +a=6378388.0000 +rf=297.0000000000000 +lat_0=0.000000000 +lon_0=75.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=10000000.000 +units=m +no_defs\",\n        CROZ63UTM39S: \"+title=Crozet 1963 +proj=tmerc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378388.0000 +rf=297.0000000000000 +lat_0=0.000000000 +lon_0=51.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=10000000.000 +units=m +no_defs\",\n        CSG67UTM21: \"+title=Guyane CSG67 UTM fuseau 21 +proj=tmerc +towgs84=-193.0660,236.9930,105.4470,0.4814,-0.8074,0.1276,1.564900 +a=6378388.0000 +rf=297.0000000000000 +lat_0=0.000000000 +lon_0=-57.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=0.000 +units=m +no_defs\",\n        CSG67UTM22: \"+title=Guyane CSG67 UTM fuseau 22 +proj=tmerc +towgs84=-193.0660,236.9930,105.4470,0.4814,-0.8074,0.1276,1.564900 +a=6378388.0000 +rf=297.0000000000000 +lat_0=0.000000000 +lon_0=-51.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=0.000 +units=m +no_defs\",\n        GEOPORTALANF: \"+title=Geoportail - Antilles francaises +proj=eqc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=0.000000000 +lat_ts=15.000000000 +x_0=0.000 +y_0=0.000 +units=m +no_defs\",\n        GEOPORTALASP: \"+title=Geoportail - Amsterdam et Saint-Paul +proj=eqc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=0.000000000 +lat_ts=-38.000000000 +x_0=0.000 +y_0=0.000 +units=m +no_defs\",\n        GEOPORTALCRZ: \"+title=Geoportail - Crozet +proj=eqc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=0.000000000 +lat_ts=-46.000000000 +x_0=0.000 +y_0=0.000 +units=m +no_defs\",\n        GEOPORTALFXX: \"+title=Geoportail - France metropolitaine +proj=eqc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=0.000000000 +lat_ts=46.500000000 +x_0=0.000 +y_0=0.000 +units=m +no_defs\",\n        GEOPORTALGUF: \"+title=Geoportail - Guyane +proj=eqc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=0.000000000 +lat_ts=4.000000000 +x_0=0.000 +y_0=0.000 +units=m +no_defs\",\n        GEOPORTALKER: \"+title=Geoportail - Kerguelen +proj=eqc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=0.000000000 +lat_ts=-49.500000000 +x_0=0.000 +y_0=0.000 +units=m +no_defs\",\n        GEOPORTALMYT: \"+title=Geoportail - Mayotte +proj=eqc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=0.000000000 +lat_ts=-12.000000000 +x_0=0.000 +y_0=0.000 +units=m +no_defs\",\n        GEOPORTALNCL: \"+title=Geoportail - Nouvelle-Caledonie +proj=eqc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=0.000000000 +lat_ts=-22.000000000 +x_0=0.000 +y_0=0.000 +units=m +no_defs\",\n        GEOPORTALPYF: \"+title=Geoportail - Polynesie francaise +proj=eqc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=0.000000000 +lat_ts=-15.000000000 +x_0=0.000 +y_0=0.000 +units=m +no_defs\",\n        GEOPORTALREU: \"+title=Geoportail - Reunion et dependances +proj=eqc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=0.000000000 +lat_ts=-21.000000000 +x_0=0.000 +y_0=0.000 +units=m +no_defs\",\n        GEOPORTALSPM: \"+title=Geoportail - Saint-Pierre et Miquelon +proj=eqc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=0.000000000 +lat_ts=47.000000000 +x_0=0.000 +y_0=0.000 +units=m +no_defs\",\n        GEOPORTALWLF: \"+title=Geoportail - Wallis et Futuna +proj=eqc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=0.000000000 +lat_ts=-14.000000000 +x_0=0.000 +y_0=0.000 +units=m +no_defs\",\n        GUAD48UTM20: \"+title=Guadeloupe Ste Anne +proj=tmerc +towgs84=-472.2900,-5.6300,-304.1200,0.4362,-0.8374,0.2563,1.898400 +a=6378388.0000 +rf=297.0000000000000 +lat_0=0.000000000 +lon_0=-63.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=0.000 +units=m +no_defs\",\n        GUADFM49U20: \"+title=Guadeloupe Fort Marigot  +proj=tmerc +towgs84=136.5960,248.1480,-429.7890 +a=6378388.0000 +rf=297.0000000000000 +lat_0=0.000000000 +lon_0=-63.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=0.000 +units=m +no_defs\",\n        IGN63UTM7S: \"+title=IGN 1963 - Hiva Oa, Tahuata, Mohotani - UTM fuseau 7 Sud +proj=tmerc +towgs84=410.7210,55.0490,80.7460,-2.5779,-2.3514,-0.6664,17.331100 +a=6378388.0000 +rf=297.0000000000000 +lat_0=0.000000000 +lon_0=-141.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=10000000.000 +units=m +no_defs\",\n        IGN72UTM58S: \"+title=IGN 1972 - UTM fuseau 58 Sud +proj=tmerc +towgs84=-11.6400,-348.6000,291.6800 +a=6378388.0000 +rf=297.0000000000000 +lat_0=0.000000000 +lon_0=165.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=10000000.000 +units=m +no_defs\",\n        KERG62UTM42S: \"+title=Kerguelen 1962 +proj=tmerc +towgs84=144.8990,-186.7700,100.9230 +a=6378388.0000 +rf=297.0000000000000 +lat_0=0.000000000 +lon_0=69.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=10000000.000 +units=m +no_defs\",\n        LAMB1: \"+title=Lambert I +proj=lcc +nadgrids=ntf_r93.gsb,null +wktext +towgs84=-168.0000,-60.0000,320.0000 +a=6378249.2000 +rf=293.4660210000000 +pm=2.337229167 +lat_0=49.500000000 +lon_0=0.000000000 +k_0=0.99987734 +lat_1=49.500000000 +x_0=600000.000 +y_0=200000.000 +units=m +no_defs\",\n        LAMB1C: \"+title=Lambert I Carto +proj=lcc +nadgrids=ntf_r93.gsb,null +wktext +towgs84=-168.0000,-60.0000,320.0000 +a=6378249.2000 +rf=293.4660210000000 +pm=2.337229167 +lat_0=49.500000000 +lon_0=0.000000000 +k_0=0.99987734 +lat_1=49.500000000 +x_0=600000.000 +y_0=1200000.000 +units=m +no_defs\",\n        LAMB2: \"+title=Lambert II +proj=lcc +nadgrids=ntf_r93.gsb,null +wktext +towgs84=-168.0000,-60.0000,320.0000 +a=6378249.2000 +rf=293.4660210000000 +pm=2.337229167 +lat_0=46.800000000 +lon_0=0.000000000 +k_0=0.99987742 +lat_1=46.800000000 +x_0=600000.000 +y_0=200000.000 +units=m +no_defs\",\n        LAMB2C: \"+title=Lambert II Carto +proj=lcc +nadgrids=ntf_r93.gsb,null +wktext +towgs84=-168.0000,-60.0000,320.0000 +a=6378249.2000 +rf=293.4660210000000 +pm=2.337229167 +lat_0=46.800000000 +lon_0=0.000000000 +k_0=0.99987742 +lat_1=46.800000000 +x_0=600000.000 +y_0=2200000.000 +units=m +no_defs\",\n        LAMB3: \"+title=Lambert III +proj=lcc +nadgrids=ntf_r93.gsb,null +wktext +towgs84=-168.0000,-60.0000,320.0000 +a=6378249.2000 +rf=293.4660210000000 +pm=2.337229167 +lat_0=44.100000000 +lon_0=0.000000000 +k_0=0.99987750 +lat_1=44.100000000 +x_0=600000.000 +y_0=200000.000 +units=m +no_defs\",\n        LAMB3C: \"+title=Lambert III Carto +proj=lcc +nadgrids=ntf_r93.gsb,null +wktext +towgs84=-168.0000,-60.0000,320.0000 +a=6378249.2000 +rf=293.4660210000000 +pm=2.337229167 +lat_0=44.100000000 +lon_0=0.000000000 +k_0=0.99987750 +lat_1=44.100000000 +x_0=600000.000 +y_0=3200000.000 +units=m +no_defs\",\n        LAMB4: \"+title=Lambert IV +proj=lcc +nadgrids=ntf_r93.gsb,null +wktext +towgs84=-168.0000,-60.0000,320.0000 +a=6378249.2000 +rf=293.4660210000000 +pm=2.337229167 +lat_0=42.165000000 +lon_0=0.000000000 +k_0=0.99994471 +lat_1=42.165000000 +x_0=234.358 +y_0=185861.369 +units=m +no_defs\",\n        LAMB4C: \"+title=Lambert IV Carto +proj=lcc +nadgrids=ntf_r93.gsb,null +wktext +towgs84=-168.0000,-60.0000,320.0000 +a=6378249.2000 +rf=293.4660210000000 +pm=2.337229167 +lat_0=42.165000000 +lon_0=0.000000000 +k_0=0.99994471 +lat_1=42.165000000 +x_0=234.358 +y_0=4185861.369 +units=m +no_defs\",\n        LAMB93: \"+title=Lambert 93 +proj=lcc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=46.500000000 +lon_0=3.000000000 +lat_1=44.000000000 +lat_2=49.000000000 +x_0=700000.000 +y_0=6600000.000 +units=m +no_defs\",\n        RGF93CC42: \"+title=Lambert conique conforme Zone 1 +proj=lcc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=42.000000000 +lon_0=3.000000000 +lat_1=41.200000000 +lat_2=42.800000000 +x_0=1700000.000 +y_0=1200000.000 +units=m +no_defs\",\n        RGF93CC43: \"+title=Lambert conique conforme Zone 2 +proj=lcc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=43.000000000 +lon_0=3.000000000 +lat_1=42.200000000 +lat_2=43.800000000 +x_0=1700000.000 +y_0=2200000.000 +units=m +no_defs\",\n        RGF93CC44: \"+title=Lambert conique conforme Zone 3 +proj=lcc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=44.000000000 +lon_0=3.000000000 +lat_1=43.200000000 +lat_2=44.800000000 +x_0=1700000.000 +y_0=3200000.000 +units=m +no_defs\",\n        RGF93CC45: \"+title=Lambert conique conforme Zone 4 +proj=lcc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=45.000000000 +lon_0=3.000000000 +lat_1=44.200000000 +lat_2=45.800000000 +x_0=1700000.000 +y_0=4200000.000 +units=m +no_defs\",\n        RGF93CC46: \"+title=Lambert conique conforme Zone 5 +proj=lcc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=46.000000000 +lon_0=3.000000000 +lat_1=45.200000000 +lat_2=46.800000000 +x_0=1700000.000 +y_0=5200000.000 +units=m +no_defs\",\n        RGF93CC47: \"+title=Lambert conique conforme Zone 6 +proj=lcc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=47.000000000 +lon_0=3.000000000 +lat_1=46.200000000 +lat_2=47.800000000 +x_0=1700000.000 +y_0=6200000.000 +units=m +no_defs\",\n        RGF93CC48: \"+title=Lambert conique conforme Zone 7 +proj=lcc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=48.000000000 +lon_0=3.000000000 +lat_1=47.200000000 +lat_2=48.800000000 +x_0=1700000.000 +y_0=7200000.000 +units=m +no_defs\",\n        RGF93CC49: \"+title=Lambert conique conforme Zone 8 +proj=lcc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=49.000000000 +lon_0=3.000000000 +lat_1=48.200000000 +lat_2=49.800000000 +x_0=1700000.000 +y_0=8200000.000 +units=m +no_defs\",\n        RGF93CC50: \"+title=Lambert conique conforme Zone 9 +proj=lcc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=50.000000000 +lon_0=3.000000000 +lat_1=49.200000000 +lat_2=50.800000000 +x_0=1700000.000 +y_0=9200000.000 +units=m +no_defs\",\n        LAMBE: \"+title=Lambert II etendu +proj=lcc +nadgrids=ntf_r93.gsb,null +wktext +towgs84=-168.0000,-60.0000,320.0000 +a=6378249.2000 +rf=293.4660210000000 +pm=2.337229167 +lat_0=46.800000000 +lon_0=0.000000000 +k_0=0.99987742 +lat_1=46.800000000 +x_0=600000.000 +y_0=2200000.000 +units=m +no_defs\",\n        MART38UTM20: \"+title=Martinique Fort-Desaix +proj=tmerc +towgs84=126.9260,547.9390,130.4090,-2.7867,5.1612,-0.8584,13.822650 +a=6378388.0000 +rf=297.0000000000000 +lat_0=0.000000000 +lon_0=-63.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=0.000 +units=m +no_defs\",\n        MAYO50UTM38S: \"+title=Mayotte Combani +proj=tmerc +towgs84=-599.9280,-275.5520,-195.6650,-0.0835,-0.4715,0.0602,49.281400 +a=6378388.0000 +rf=297.0000000000000 +lat_0=0.000000000 +lon_0=45.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=10000000.000 +units=m +no_defs\",\n        MILLER: \"+title=Geoportail - Monde +proj=mill +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lon_0=0.000000000 +x_0=0.000 +y_0=0.000 +units=m +no_defs\",\n        MOOREA87U6S: \"+title=Moorea 1987 - UTM fuseau 6 Sud +proj=tmerc +towgs84=215.9820,149.5930,176.2290,3.2624,1.6920,1.1571,10.477300 +a=6378388.0000 +rf=297.0000000000000 +lat_0=0.000000000 +lon_0=-147.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=10000000.000 +units=m +no_defs\",\n        NUKU72U7S: \"+title=IGN 1972 Nuku Hiva - UTM fuseau 7 Sud +proj=tmerc +towgs84=165.7320,216.7200,180.5050,-0.6434,-0.4512,-0.0791,7.420400 +a=6378388.0000 +rf=297.0000000000000 +lat_0=0.000000000 +lon_0=-141.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=10000000.000 +units=m +no_defs\",\n        REUN47GAUSSL: \"+title=Reunion Gauss Laborde +proj=gstmerc +towgs84=789.5240,-626.4860,-89.9040,0.6006,76.7946,-10.5788,-32.324100 +a=6378388.0000 +rf=297.0000000000000 +lat_0=-21.116666667 +lon_0=55.533333333 +k_0=1.00000000 +x_0=160000.000 +y_0=50000.000 +units=m +no_defs\",\n        RGM04UTM38S: \"+title=UTM fuseau 38 Sud (Reseau Geodesique de Mayotte 2004) +proj=tmerc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=45.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=10000000.000 +units=m +no_defs\",\n        RGNCUTM57S: \"+title=Reseau Geodesique de Nouvelle-Caledonie - UTM fuseau 57 Sud +proj=tmerc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=159.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=10000000.000 +units=m +no_defs\",\n        RGNCUTM58S: \"+title=Reseau Geodesique de Nouvelle-Caledonie - UTM fuseau 58 Sud +proj=tmerc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=165.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=10000000.000 +units=m +no_defs\",\n        RGNCUTM59S: \"+title=Reseau Geodesique de Nouvelle-Caledonie - UTM fuseau 59 Sud +proj=tmerc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=171.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=10000000.000 +units=m +no_defs\",\n        RGPFUTM5S: \"+title=RGPF - UTM fuseau 5 Sud +proj=tmerc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=-153.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=10000000.000 +units=m +no_defs\",\n        RGPFUTM6S: \"+title=RGPF - UTM fuseau 6 Sud +proj=tmerc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=-147.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=10000000.000 +units=m +no_defs\",\n        RGPFUTM7S: \"+title=RGPF - UTM fuseau 7 Sud +proj=tmerc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=-141.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=10000000.000 +units=m +no_defs\",\n        RGR92UTM40S: \"+title=RGR92 UTM fuseau 40 Sud +proj=tmerc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=57.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=10000000.000 +units=m +no_defs\",\n        RGSPM06U21: \"+title=Saint-Pierre-et-Miquelon (2006) UTM Fuseau 21 Nord +proj=tmerc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=-57.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=0.000 +units=m +no_defs\",\n        STPL69UTM43S: \"+title=Saint-Paul 1969 UTM fuseau 43 Sud +proj=tmerc +towgs84=225.571,-346.608,-46.567,0,0,0,0 +a=6378388.0000 +rf=297.0000000000000 +lat_0=0.000000000 +lon_0=75.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=10000000.000 +units=m +no_defs\",\n        STPM50UTM21: \"+title=St Pierre et Miquelon 1950 +proj=tmerc +towgs84=-95.5930,573.7630,173.4420,-0.9602,1.2510,-1.3918,42.626500 +a=6378206.4000 +rf=294.9786982000000 +lat_0=0.000000000 +lon_0=-57.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=0.000 +units=m +no_defs\",\n        TAHAAUTM05S: \"+title=Tahaa 1951 +proj=tmerc +towgs84=72.4380,345.9180,79.4860,-1.6045,-0.8823,-0.5565,1.374600 +a=6378388.0000 +rf=297.0000000000000 +lat_0=0.000000000 +lon_0=-153.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=10000000.000 +units=m +no_defs\",\n        TAHI51UTM06S: \"+title=Tahiti-Terme Nord UTM fuseau 6 Sud +proj=tmerc +towgs84=162.0000,117.0000,154.0000 +a=6378388.0000 +rf=297.0000000000000 +lat_0=0.000000000 +lon_0=-147.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=10000000.000 +units=m +no_defs\",\n        TAHI79UTM6S: \"+title=Tahiti 1979 +proj=tmerc +towgs84=221.5250,152.9480,176.7680,2.3847,1.3896,0.8770,11.474100 +a=6378388.0000 +rf=297.0000000000000 +lat_0=0.000000000 +lon_0=-147.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=10000000.000 +units=m +no_defs\",\n        TERA50STEREO: \"+title=Terre Adelie 1950 +proj=stere +towgs84=324.9120,153.2820,172.0260 +a=6378388.0000 +rf=297.0000000000000 +lat_0=-90.000000000 +lon_0=140.000000000 +lat_ts=-67 +k=0.96027295 +x_0=300000.000 +y_0=-2299363.482 +units=m +no_defs\",\n        UTM01SW84: \"+title=World Geodetic System 1984 UTM fuseau 01 Sud +proj=tmerc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=-177.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=10000000.000 +units=m +no_defs\",\n        UTM20W84GUAD: \"+title=World Geodetic System 1984 UTM fuseau 20 Nord-Guadeloupe +proj=tmerc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=-63.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=0.000 +units=m +no_defs\",\n        UTM20W84MART: \"+title=World Geodetic System 1984 UTM fuseau 20 Nord-Martinique +proj=tmerc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=-63.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=0.000 +units=m +no_defs\",\n        UTM22RGFG95: \"+title=RGFG95 UTM fuseau 22 Nord-Guyane +proj=tmerc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=-51.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=0.000 +units=m +no_defs\",\n        UTM39SW84: \"+title=World Geodetic System 1984 UTM fuseau 39 Sud +proj=tmerc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=51.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=10000000.000 +units=m +no_defs\",\n        UTM42SW84: \"+title=World Geodetic System 1984 UTM fuseau 42 Sud +proj=tmerc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=69.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=10000000.000 +units=m +no_defs\",\n        UTM43SW84: \"+title=World Geodetic System 1984 UTM fuseau 43 Sud +proj=tmerc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=75.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=10000000.000 +units=m +no_defs\",\n        WALL78UTM1S: \"+title=Wallis-Uvea 1978 (MOP78) UTM 1 SUD +proj=tmerc +towgs84=253.0000,-133.0000,-127.0000 +a=6378388.0000 +rf=297.0000000000000 +lat_0=0.000000000 +lon_0=-177.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=10000000.000 +units=m +no_defs\",\n        ETRS89GEO: \"+title=ETRS89 geographiques (dms) +proj=longlat +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +units=m +no_defs\",\n        ETRS89LAEA: \"+title=ETRS89 Lambert Azimutal Equal Area +proj=laea +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=52.000000000 +lon_0=10.000000000 +x_0=4321000.000 +y_0=3210000.000 +units=m +no_defs\",\n        ETRS89LCC: \"+title=ETRS89 Lambert Conformal Conic +proj=lcc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=52.000000000 +lon_0=9.999999995 +lat_1=35.000000000 +lat_2=65.000000000 +x_0=4000000.000 +y_0=2800000.000 +units=m +no_defs\",\n        UTM26ETRS89: \"+title=Europe - de 30d a 24d Ouest +proj=tmerc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=-27.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=0.000 +units=m +no_defs\",\n        UTM27ETRS89: \"+title=Europe - de 24d a 18d Ouest +proj=tmerc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=-21.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=0.000 +units=m +no_defs\",\n        UTM28ETRS89: \"+title=Europe - de 18d a 12d Ouest +proj=tmerc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=-15.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=0.000 +units=m +no_defs\",\n        UTM29ETRS89: \"+title=Europe - de 12d a 6d Ouest +proj=tmerc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=-9.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=0.000 +units=m +no_defs\",\n        UTM30ETRS89: \"+title=Europe - de -6d a 0d Ouest +proj=tmerc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=-3.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=0.000 +units=m +no_defs\",\n        UTM31ETRS89: \"+title=Europe - de 0d a 6d Est +proj=tmerc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=3.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=0.000 +units=m +no_defs\",\n        UTM32ETRS89: \"+title=Europe - de 6d a 12d Est +proj=tmerc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=9.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=0.000 +units=m +no_defs\",\n        UTM33ETRS89: \"+title=Europe - de 12d a 18d Est +proj=tmerc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=15.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=0.000 +units=m +no_defs\",\n        UTM34ETRS89: \"+title=Europe - de 18d a 24d Est +proj=tmerc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=21.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=0.000 +units=m +no_defs\",\n        UTM35ETRS89: \"+title=Europe - de 24d a 30d Est +proj=tmerc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=27.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=0.000 +units=m +no_defs\",\n        UTM36ETRS89: \"+title=Europe - de 30d a 36d Est +proj=tmerc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=33.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=0.000 +units=m +no_defs\",\n        UTM37ETRS89: \"+title=Europe - de 36d a 42d Est +proj=tmerc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=39.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=0.000 +units=m +no_defs\",\n        UTM38ETRS89: \"+title=Europe - de 42d a 48d Est +proj=tmerc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=45.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=0.000 +units=m +no_defs\"\n    }\n};\n\nexport default Register;\n\n\n\n// WEBPACK FOOTER //\n// ./src/Common/Utils/Register.js","import ol from \"ol\";\nimport Gp from \"gp\";\nimport Utils from \"../../Common/Utils\";\n\n/**\n * @classdesc\n *\n * Extended ol.source.WMTS.\n *\n * @constructor\n * @extends {ol.source.WMTS}\n * @param {Object} options - Options\n */\nfunction WMTS(options) {\n\n    if (!(this instanceof WMTS)) {\n        throw new TypeError(\"ERROR CLASS_CONSTRUCTOR\");\n    }\n\n    // call constructor\n    ol.source.WMTS.call(this,\n        options\n    );\n\n}\n\n// Inherits\nol.inherits(WMTS, ol.source.WMTS);\n\n/*\n * @lends module:KML\n */\nWMTS.prototype = Object.create(ol.source.WMTS.prototype, {});\n\n/**\n * Constructor (alias)\n */\nWMTS.prototype.constructor = WMTS;\n\n/**\n * Return the GetFeatureInfo URL for the passed coordinate, resolution, and\n * projection. Return `undefined` if the GetFeatureInfo URL cannot be\n * constructed.\n * @param {ol.Coordinate} coordinate - Coordinate.\n * @param {Number} resolution - Resolution.\n * @param {ol.proj.Projection} projection - Projection.\n * @param {!Object} params - GetFeatureInfo params. `INFOFORMAT` at least should\n *     be provided.\n * @return {String|undefined} GetFeatureInfo URL.\n */\nWMTS.prototype.getGetFeatureInfoUrl = function(coordinate, resolution, projection, params) {\n\n    var pixelRatio = (this.option && this.options.tilePixelRatio) ? this.options.tilePixelRatio : 1;\n\n    var tileGrid = this.tileGrid;\n    var tileCoord = this.tileGrid.getTileCoordForCoordAndResolution(coordinate, resolution);\n\n    /**\n     * this code is duplicated from createFromWMTSTemplate function\n     */\n    var getTransformedTileCoord = function(tileCoord, tileGrid, projection) {\n        var tmpTileCoord = [0, 0, 0]; /*Note : [z(zoomLevel),x,y]*/\n        var tmpExtent = ol.extent.createEmpty();\n        var x = tileCoord[1];\n        var y = -tileCoord[2] - 1;\n        var tileExtent = tileGrid.getTileCoordExtent(tileCoord);\n        var projectionExtent = projection.getExtent();\n        var extent = projectionExtent;\n\n        if (extent != null && projection.isGlobal() && extent[0] === projectionExtent[0] && extent[2] === projectionExtent[2]) {\n            var numCols = Math.ceil(ol.extent.getWidth(extent) / ol.extent.getWidth(tileExtent));\n            x = x % numCols;\n            tmpTileCoord[0] = tileCoord[0];\n            tmpTileCoord[1] = x;\n            tmpTileCoord[2] = tileCoord[2];\n            tileExtent = tileGrid.getTileCoordExtent(tmpTileCoord, tmpExtent);\n        }\n        if (!ol.extent.intersects(tileExtent, extent) /*|| ol.extent.touches(tileExtent, extent) */ ) {\n            return null;\n        }\n        return [tileCoord[0], x, y];\n    };\n\n    var tileExtent = tileGrid.getTileCoordExtent(tileCoord);\n    var transformedTileCoord = getTransformedTileCoord(tileCoord, tileGrid, projection);\n\n    if (tileGrid.getResolutions().length <= tileCoord[0]) {\n        return undefined;\n    }\n\n    var tileResolution = tileGrid.getResolution(tileCoord[0]);\n    var tileMatrix = tileGrid.getMatrixIds()[tileCoord[0]];\n\n    var baseParams = {\n        SERVICE: \"WMTS\",\n        VERSION: \"1.0.0\",\n        REQUEST: \"GetFeatureInfo\",\n        LAYER: this.getLayer(),\n        TILECOL: transformedTileCoord[1],\n        TILEROW: transformedTileCoord[2],\n        TILEMATRIX: tileMatrix,\n        TILEMATRIXSET: this.getMatrixSet(),\n        FORMAT: this.getFormat() || \"image/png\",\n        STYLE: this.getStyle() || \"normal\"\n    };\n\n    Utils.assign(baseParams, params);\n\n    /*var tileSize = tileGrid.getTileSize();\n    var x = Math.floor(tileSize*((coordinate[0]-tileExtent[0])/(tileExtent[2]-tileExtent[0])));\n    var y = Math.floor(tileSize*((tileExtent[3]-coordinate[1])/(tileExtent[3]-tileExtent[1])));*/\n\n    var x = Math.floor((coordinate[0] - tileExtent[0]) / (tileResolution / pixelRatio));\n    var y = Math.floor((tileExtent[3] - coordinate[1]) / (tileResolution / pixelRatio));\n\n    baseParams[\"I\"] = x;\n    baseParams[\"J\"] = y;\n\n    var url = this.urls[0];\n\n    var featureInfoUrl = Gp.Helper.normalyzeUrl(url, baseParams);\n\n    return featureInfoUrl;\n};\n\nexport default WMTS;\n\n\n\n// WEBPACK FOOTER //\n// ./src/OpenLayers/Sources/WMTS.js","import ol from \"ol\";\nimport Proj4 from \"proj4\";\nimport Register from \"../../Common/Utils/Register\";\n\n/**\n * Autoload function that loads all defs into proj4\n * and adds proj4 defs into ol.\n */\n(function() {\n    // load all defs into proj4\n    Register.load();\n    // overload proj4 into ol\n    if (!ol.proj.proj4_ && ol.proj.setProj4) {\n        ol.proj.setProj4(Proj4);\n    } else {\n        console.log(\"WARNING : OpenLayers library should manage proj4 dependency in order to add custom projections (Lambert 93 for instance)\");\n    }\n})();\n\nvar CRS = {\n\n    /**\n     * Overload OpenLayers ol.proj.transformExtent function,\n     * to manage EPSG:2154 extent restriction\n     */\n    overloadTransformExtent: function() {\n        /**\n         * Transforms an extent from source projection to destination projection.  This\n         * returns a new extent (and does not modify the original).\n         * Overload Geoportal Extension for OL3 : to manage EPSG:2154 extent restriction.\n         *\n         * @param {ol.Extent} extent - The extent to transform.\n         * @param {ol.proj.ProjectionLike} source - Source projection-like.\n         * @param {ol.proj.ProjectionLike} destination - Destination projection-like.\n         * @return {ol.Extent} extent - The transformed extent.\n         */\n        ol.proj.transformExtent = function(extent, source, destination) {\n            if (destination === \"EPSG:2154\") {\n                if (source === \"EPSG:4326\") {\n                    // dans le cas d'une transfo 4326->2154,\n                    // il faut restreindre l'tendue gographique  l'tendue de validit de Lambert93.\n                    if (extent[0] < -9.62) {\n                        extent[0] = -9.62;\n                    }\n                    if (extent[1] < 41.18) {\n                        extent[1] = 41.18;\n                    }\n                    if (extent[2] > 10.3) {\n                        extent[2] = 10.3;\n                    }\n                    if (extent[3] > 51.54) {\n                        extent[3] = 51.54;\n                    }\n                }\n            }\n            var transformFn = ol.proj.getTransform(source, destination);\n            var transformedExtent = ol.extent.applyTransform(extent, transformFn);\n            return transformedExtent;\n        };\n    },\n\n    /**\n     * Load all overload function\n     */\n    overload: function() {\n        // TODO ajouter les fonctions  surcharger...\n        this.overloadTransformExtent();\n    }\n};\n\nexport default CRS;\n\n\n\n// WEBPACK FOOTER //\n// ./src/OpenLayers/CRS/CRS.js","/* globals self */\nimport ol from \"ol\";\nimport Gp from \"gp\";\nimport WMTSExtended from \"../Sources/WMTS\";\nimport GfiUtils from \"../GfiUtils\";\nimport Utils from \"../../Common/Utils\";\nimport Config from \"../../Common/Utils/Config\";\nimport LayerUtils from \"../../Common/Utils/LayerUtils\";\n\n/**\n * @classdesc\n * Geoportal WMTS source creation (inherit from ol.source.WMTS)\n *\n * @constructor\n * @alias ol.source.GeoportalWMTS\n * @extends {WMTSExtended}\n * @param {Object} options            - options for function call.\n * @param {String} options.layer      - Layer name (e.g. \"ORTHOIMAGERY.ORTHOPHOTOS\")\n * @param {Boolean} [options.ssl]     - if set true, enforce protocol https (only for nodejs)\n * @param {String} [options.apiKey]   - Access key to Geoportal platform\n * @param {Object} [options.olParams] - other options for ol.source.WMTS function (see {@link http://openlayers.org/en/latest/apidoc/ol.source.WMTS.html ol.source.WMTS})\n * @example\n * var sourceWMTS = new ol.source.GeoportalWMTS({\n *      layer  : \"ORTHOIMAGERY.ORTHOPHOTOS\"\n * });\n */\nfunction SourceWMTS(options) {\n\n    if (!(this instanceof SourceWMTS)) {\n        throw new TypeError(\"ERROR CLASS_CONSTRUCTOR\");\n    }\n\n    // check layer params\n    if (!options.layer) {\n        throw new Error(\"ERROR PARAM_MISSING : layer\");\n    }\n    if (typeof options.layer !== \"string\") {\n        throw new Error(\"ERROR WRONG TYPE : layer\");\n    }\n\n    // par defaut\n    if (typeof options.ssl === \"undefined\") {\n        options.ssl = false;\n    }\n\n    // Check if configuration is loaded\n    if (!Config.isConfigLoaded()) {\n        throw new Error(\"ERROR : contract key configuration has to be loaded to load Geoportal layers. See http://ignf.github.io/evolution-apigeoportail/ol3/ol3-autoconf.html\");\n    }\n\n    var layerId = Config.getLayerId(options.layer, \"WMTS\");\n\n    if (layerId && Config.configuration.getLayerConf(layerId)) {\n\n        var wmtsParams = Config.getLayerParams(options.layer, \"WMTS\", options.apiKey);\n\n        // gestion de mixContent dans l'url du service...\n        var ctx = typeof window !== \"undefined\" ? window : typeof self !== \"undefined\" ? self : null;\n        var protocol = (ctx) ?\n            (ctx.location && ctx.location.protocol && ctx.location.protocol.indexOf(\"https:\") === 0 ? \"https://\" : \"http://\") :\n            (options.ssl ? \"https://\" : \"http://\");\n\n        // save originators (to be updated by Originators control)\n        this._originators = wmtsParams.originators;\n\n        // save legends and metadata (to be added to LayerSwitcher control)\n        this._legends = wmtsParams.legends;\n        this._metadata = wmtsParams.metadata;\n\n        var wmtsSourceOptions = {\n            // tracker extension ol3\n            // FIXME : gp-ext version en mode AMD\n            url: Gp.Helper.normalyzeUrl(wmtsParams.url.replace(/(http|https):\\/\\//, protocol), {\n                \"gp-ol3-ext\": \"__GPOL3EXTVERSION__\"\n            }, false),\n            version: wmtsParams.version,\n            style: wmtsParams.styles,\n            format: wmtsParams.format,\n            projection: wmtsParams.projection,\n            maxZoom: LayerUtils.getZoomLevelFromScaleDenominator(wmtsParams.minScale),\n            layer: options.layer,\n            matrixSet: wmtsParams.TMSLink,\n            tileGrid: new ol.tilegrid.WMTS({\n                    resolutions: wmtsParams.nativeResolutions,\n                    matrixIds: wmtsParams.matrixIds,\n                    origin: [wmtsParams.matrixOrigin.x, wmtsParams.matrixOrigin.y]\n                })\n                // ,\n                // attributions : [\n                //     new ol.Attribution({\n                //         html : \"<a class='gp-control-attribution-link' target='_blank' href='http://www.ign.fr'><img class='gp-control-attribution-image' src='http://wxs.ign.fr/static/logos/IGN/IGN.gif' title='Institut national de l\\'information gographique et forestire' style='height: 30px; width: 30px;'></a>\"\n                //     })\n                // ]\n        };\n\n        // rcupration des autres paramtres passs par l'utilisateur\n        Utils.mergeParams(wmtsSourceOptions, options.olParams);\n\n        // returns a WMTS object, that inherits from WMTSExtended.\n        WMTSExtended.call(this, wmtsSourceOptions);\n\n        // add originators to layer source (to be updated by Originators control)\n        this._originators = wmtsParams.originators;\n\n        // add legends and metadata (to be added to LayerSwitcher control)\n        this._legends = wmtsParams.legends;\n        this._metadata = wmtsParams.metadata;\n        this._description = wmtsParams.description;\n        this._title = wmtsParams.title;\n        this._quicklookUrl = wmtsParams.quicklookUrl;\n\n    } else {\n        // If layer is not in Gp.Config\n        console.log(\"[source WMTS] ERROR : \" + options.layer + \" cannot be found in Geoportal Configuration. Make sure that this resource is included in your contract key.\");\n        return new WMTSExtended({});\n    }\n}\n\n// Inherits from ol.source.WMTS\nol.inherits(SourceWMTS, WMTSExtended);\n\n/*\n * @lends module:SourceWMTS\n */\nSourceWMTS.prototype = Object.create(WMTSExtended.prototype, {});\n\n/*\n * Constructor (alias)\n */\nSourceWMTS.prototype.constructor = SourceWMTS;\n\nexport default SourceWMTS;\n\n\n\n// WEBPACK FOOTER //\n// ./src/OpenLayers/Layers/SourceWMTS.js","/* globals self */\nimport ol from \"ol\";\nimport Gp from \"gp\";\nimport Utils from \"../../Common/Utils\";\nimport Config from \"../../Common/Utils/Config\";\n\n/**\n * @classdesc\n * Geoportal tile WMS source creation (inherit from ol.source.TileWMS)\n *\n * @constructor\n * @alias ol.source.GeoportalWMS\n * @extends {ol.source.TileWMS}\n * @param {Object} options            - options for function call.\n * @param {String} options.layer      - Layer name (e.g. \"ORTHOIMAGERY.ORTHOPHOTOS\")\n * @param {Boolean} [options.ssl]     - if set true, enforce protocol https (only for nodejs)\n * @param {String} [options.apiKey]   - Access key to Geoportal platform\n * @param {Object} [options.olParams] - other options for ol.source.TileWMS function (see {@link http://openlayers.org/en/latest/apidoc/ol.source.TileWMS.html ol.source.TileWMS})\n * @example\n * var sourceWMS = new ol.source.GeoportalWMS({\n *      layer  : \"ORTHOIMAGERY.ORTHOPHOTOS\"\n * });\n */\nfunction SourceWMS(options) {\n\n    if (!(this instanceof SourceWMS)) {\n        throw new TypeError(\"ERROR CLASS_CONSTRUCTOR\");\n    }\n\n    // check layer params\n    if (!options.layer) {\n        throw new Error(\"ERROR PARAM_MISSING : layer\");\n    }\n    if (typeof options.layer !== \"string\") {\n        throw new Error(\"ERROR WRONG TYPE : layer\");\n    }\n\n    // par defaut\n    if (typeof options.ssl === \"undefined\") {\n        options.ssl = false;\n    }\n\n    // Check if configuration is loaded\n    if (!Config.isConfigLoaded()) {\n        throw new Error(\"ERROR : contract key configuration has to be loaded to load Geoportal layers. See http://ignf.github.io/evolution-apigeoportail/ol3/ol3-autoconf.html\");\n    }\n\n    var layerId = Config.getLayerId(options.layer, \"WMS\");\n\n    if (layerId && Config.configuration.getLayerConf(layerId)) {\n        var wmsParams = Config.getLayerParams(options.layer, \"WMS\", options.apiKey);\n\n        // gestion de mixContent dans l'url du service...\n        var ctx = typeof window !== \"undefined\" ? window : typeof self !== \"undefined\" ? self : null;\n        var protocol = (ctx) ?\n            (ctx.location && ctx.location.protocol && ctx.location.protocol.indexOf(\"https:\") === 0 ? \"https://\" : \"http://\") :\n            (options.ssl ? \"https://\" : \"http://\");\n\n        var wmsSourceOptions = {\n            // tracker extension ol3\n            // FIXME : gp-ext version en mode AMD\n            url: Gp.Helper.normalyzeUrl(wmsParams.url.replace(/(http|https):\\/\\//, protocol), {\n                \"gp-ol3-ext\": \"__GPOL3EXTVERSION__\"\n            }, false),\n            params: {\n                SERVICE: \"WMS\",\n                LAYERS: options.layer,\n                VERSION: wmsParams.version,\n                STYLES: wmsParams.styles,\n                FORMAT: wmsParams.format\n            }\n            // ,\n            // attributions : [\n            //     new ol.Attribution({\n            //         html : \"<a class='gp-control-attribution-link' target='_blank' href='http://www.ign.fr'><img class='gp-control-attribution-image' src='http://wxs.ign.fr/static/logos/IGN/IGN.gif' title='Institut national de l\\'information gographique et forestire' style='height: 30px; width: 30px;'></a>\"\n            //     })\n            // ]\n        };\n\n        // rcupration des autres paramtres passs par l'utilisateur\n        Utils.mergeParams(wmsSourceOptions, options.olParams);\n\n        // returns a WMS object, that inherits from ol.source.TileWMS.\n        ol.source.TileWMS.call(this, wmsSourceOptions);\n\n        // save originators (to be updated by Originators control)\n        this._originators = wmsParams.originators;\n\n        // save legends and metadata (to be added to LayerSwitcher control)\n        this._legends = wmsParams.legends;\n        this._metadata = wmsParams.metadata;\n        this._title = wmsParams.title;\n        this._description = wmsParams.description;\n        this._quicklookUrl = wmsParams.quicklookUrl;\n\n    } else {\n        // If layer is not in Gp.Config\n        console.log(\"[source WMS] ERROR : \" + options.layer + \" cannot be found in Geoportal Configuration. Make sure that this resource is included in your contract key.\");\n        return new ol.source.TileWMS({});\n    }\n\n}\n\n// Inherits from ol.source.TileWMS\nol.inherits(SourceWMS, ol.source.TileWMS);\n\n/*\n * @lends module:SourceWMS\n */\nSourceWMS.prototype = Object.create(ol.source.TileWMS.prototype, {});\n\n/*\n * Constructor (alias)\n */\nSourceWMS.prototype.constructor = SourceWMS;\n\nexport default SourceWMS;\n\n\n\n// WEBPACK FOOTER //\n// ./src/OpenLayers/Layers/SourceWMS.js","import ol from \"ol\";\nimport Gp from \"gp\";\nimport Logger from \"../../Common/Utils/LoggerByDefault\";\nimport Utils from \"../../Common/Utils\";\nimport RightManagement from \"../../Common/Utils/CheckRightManagement\";\nimport SelectorID from \"../../Common/Utils/SelectorID\";\nimport LocationSelectorDOM from \"../../Common/Controls/LocationSelectorDOM\";\nimport Markers from \"./Utils/Markers\";\n\n\nvar logger = Logger.getLogger(\"locationselector\");\n\n/**\n * @classdesc\n *\n * LocationSelector component. Enables to select a location, using autocompletion or picking location on the map\n * @param {Object} [options] - component options\n * @param {String} [options.apiKey] - API key for autocomplete service call, mandatory if autoconf service has not been charged in advance\n * @param {Boolean} [options.displayInfo = true] - whether to display info in a popup or not (not implemented yet) Default is true\n * @param {Object} [options.tag] - tag options\n * @param {Number} [options.tag.id = 1] - order id number in a locations group, in case several LocationSelector are used. For instance in route case : departure tag id should be 0, arrival tag id should be 1, and other ones : 2, 3, ...\n * @param {Number} [options.tag.groupId = null] - locationSelector global component id (in case locationSelector is called by another graphic component, e.g. route control)\n * @param {String} [options.tag.label] - text to display in component (e.g. \"Departure\"). Default is \">\"\n * @param {Object} [options.tag.markerOpts] - options to use your own marker. Default is a lightOrange marker.\n * @param {String} [options.tag.markerOpts.url] - marker base64 encoded url (ex \"data:image/png;base64,...\"\"). Mandatory for a custom marker\n * @param {Array} [options.tag.markerOpts.offset] - Offsets in pixels used when positioning the overlay. The first element in the array is the horizontal offset. A positive value shifts the overlay right. The second element in the array is the vertical offset. A positive value shifts the overlay down. Default is [0, 0]. (see {@link http://openlayers.org/en/latest/apidoc/ol.Overlay.html ol.Overlay})\n * @param {Boolean} [options.tag.display = true] - whether to display or hide component. Default is true\n * @param {Boolean} [options.tag.addOption = false] - whether to display picto to add another LocationSelector (in case of route control)\n * @param {Boolean} [options.tag.removeOption = false] - whether to display picto to remove a LocationSelector (in case of route control)\n * @param {Object} [options.autocompleteOptions] - autocomplete service options (see {@link http://ignf.github.io/geoportal-access-lib/latest/jsdoc/module-Services.html#~autoComplete Gp.Services.autoComplete()} to know all autocomplete options)\n * @example\n *  var locationselector = new LocationSelector({\n *      apiKey : \"\",\n *      tag : {\n *         id : 1,\n *         groupId : null,\n *         label : \"Dpart\",\n *         markerOpts : {\n *              url : \"...\",\n *              offset : [0,0]\n *         },\n *         display : true\n *      },\n *      autocompleteOptions : {}\n *  });\n */\nfunction LocationSelector(options) {\n\n    options = options || {};\n\n    if (!(this instanceof LocationSelector)) {\n        throw new TypeError(\"ERROR CLASS_CONSTRUCTOR\");\n    }\n\n    // initialisation du composant\n    this.initialize(options);\n\n    // creation du DOM\n    this._container = this._initContainer();\n\n    // on peut ventuellement encapsuler le composant dans une div passe par l'utilisateur\n    // (le composant tant positionn en relatif, il doit tre positionn dans une div si utilis seul)\n    if (options.element && options.element.appendChild) {\n        options.element.appendChild(this._container);\n        this._container = options.element;\n    }\n\n    // call ol.control.Control constructor\n    ol.control.Control.call(this, {\n        element: this._container,\n        target: options.target,\n        render: options.render\n    });\n};\n// Inherits from ol.control.Control\nol.inherits(LocationSelector, ol.control.Control);\n\n/**\n * @lends module:LocationSelector\n */\nLocationSelector.prototype = Object.create(ol.control.Control.prototype, {});\n\nUtils.assign(LocationSelector.prototype, LocationSelectorDOM);\n\n/**\n * Constructor (alias)\n */\nLocationSelector.prototype.constructor = LocationSelector;\n\n/**\n * initialize component\n */\nLocationSelector.prototype.initialize = function(options) {\n\n    // set default options\n    this.options = {\n        tag: {\n            id: 1, // numero d'ordre sur un groupe de locations\n            groupId: null, // id du composant global contenant le LocationSelector\n            label: \">\",\n            display: true,\n            addOption: false,\n            removeOption: false\n        },\n        displayInfo: true,\n        autocompleteOptions: {}\n    };\n\n    // merge with user options\n    Utils.mergeParams(this.options, options);\n\n    /** uuid */\n    this._uid = this.options.tag.groupId || SelectorID.generate();\n    // info : si un uid (groupId) est spcifi\n    // (par ex si ce composant est appl par un autre composant graphique)\n    // alors on le rcupre, sinon c'est qu'il est indpendant : on gnre donc un uuid\n\n    /** container map */\n    this._map = null;\n\n    /** container principal des entres  */\n    this._inputsContainer = null;\n\n    /** container du label du point */\n    this._inputLabelContainer = null;\n\n    /** container de la saisi de l'autocompletion */\n    this._inputAutoCompleteContainer = null;\n\n    /** container du pointer de saisi sur la carte */\n    this._inputShowPointerContainer = null;\n\n    /** label du pointer de saisi sur la carte (avec img) */\n    this._inputShowPointer = null;\n\n    /** container des coordonnes */\n    this._inputCoordinateContainer = null;\n\n    /** elements pour ajouter ou supprimer un nouveau point */\n    this._addPointElement = null;\n    this._removePointElement = null;\n\n    /** coordonnes du point selectionn, en EPSG:4326 */\n    this._coordinate = null;\n\n    /** container des reponses de l'autocompletion */\n    this._suggestedContainer = null;\n\n    /** listes des reponses de l'autocompletion */\n    this._suggestedLocations = [];\n\n    /** localisant */\n    this._currentLocation = null;\n\n    /** marker */\n    this._initMarker();\n\n    /** ressources du services d'autocompletion (ayant droit!) */\n    this._resources = {};\n\n    /** a t on des droits sur les ressources du service ? */\n    this._noRightManagement = false;\n\n    // gestion des droits sur les ressources/services\n    this._checkRightsManagement();\n\n};\n\n/**\n * initialize marker : url and offset\n *\n * @private\n */\nLocationSelector.prototype._initMarker = function() {\n    // init marker properties\n    this._marker = null;\n    this._markerUrl = \"\";\n    this._markerOffset = [0, 0];\n\n    if (this.options.tag.markerOpts && this.options.tag.markerOpts.url) {\n\n        // get marker src url\n        this._markerUrl = this.options.tag.markerOpts.url;\n\n        // get marker offset\n        var offset = this.options.tag.markerOpts.offset;\n        if (offset) {\n            if (Array.isArray(offset) && offset.length === 2) {\n                this._markerOffset = offset;\n            } else {\n                console.log(\"markerOpts.offset should be an array. e.g. : [0,0]\");\n            }\n        }\n\n    } else {\n        // set default options for marker\n        this._markerUrl = Markers[\"lightOrange\"];\n        this._markerOffset = Markers.defaultOffset;\n    }\n};\n\n// ################################################################### //\n// ########################## publics methods ######################## //\n// ################################################################### //\n\n/**\n * get coordinate\n *\n * @returns {Array} this._coordinate - point coordinate (EPSG:4326) : [lon, lat]\n */\nLocationSelector.prototype.getCoordinate = function() {\n    return this._coordinate;\n};\n\n/**\n * clean input\n */\nLocationSelector.prototype.clear = function() {\n    this._clearResults();\n    this._inputLabelContainer.click();\n};\n\n// ################################################################### //\n// ##################### init component (private) #################### //\n// ################################################################### //\n\n/**\n * check\n */\nLocationSelector.prototype._checkRightsManagement = function() {\n    // les ressources du service d'autocompletion\n    var _opts = this.options.autocompleteOptions.filterOptions;\n    var _res = (_opts) ? _opts.type : [];\n    if (!_res || _res.length === 0) {\n        _res = [\n            \"PositionOfInterest\",\n            \"StreetAddress\"\n        ];\n    }\n\n    var rightManagement = RightManagement.check({\n        key: this.options.apiKey,\n        resources: _res,\n        services: [\"AutoCompletion\"]\n    });\n\n    if (!rightManagement) {\n        this._noRightManagement = true;\n    }\n\n    // on recupre les informations utiles\n    // sur ce controle, on ne s'occupe pas de la ressource car elle est unique...\n    // Ex. la clef API issue de l'autoconfiguration si elle n'a pas\n    // t renseigne.\n    if (!this.options.apiKey) {\n        this.options.apiKey = rightManagement.key;\n    }\n\n    Utils.assign(this._resources, rightManagement);\n\n};\n\n/**\n * initialize component container\n */\nLocationSelector.prototype._initContainer = function() {\n\n    var id = this.options.tag.id;\n\n    // create main container\n    var container = this._createMainContainerElement();\n\n    var inputs = this._inputsContainer = this._createLocationPointElement(id, this.options.tag.display);\n    container.appendChild(inputs);\n\n    var _inputLabel = this._inputLabelContainer = this._createLocationPointLabelElement(id, this.options.tag.label);\n    inputs.appendChild(_inputLabel);\n    var _inputAutoComplete = this._inputAutoCompleteContainer = this._createLocationAutoCompleteteInputElement(id);\n    var context = this;\n    if (_inputAutoComplete.addEventListener) {\n        _inputAutoComplete.addEventListener(\"click\", function() {\n            context.onAutoCompleteInputClick();\n        });\n    } else if (_inputAutoComplete.attachEvent) {\n        _inputAutoComplete.attachEvent(\"onclick\", function() {\n            context.onAutoCompleteInputClick();\n        });\n    }\n    inputs.appendChild(_inputAutoComplete);\n    var _inputCoordinate = this._inputCoordinateContainer = this._createLocationCoordinateInputElement(id);\n    inputs.appendChild(_inputCoordinate);\n    var _inputShowPointer = this._inputShowPointerContainer = this._createLocationPointerShowInputElement(id);\n    inputs.appendChild(_inputShowPointer);\n    var _inputPointer = this._inputShowPointer = this._createLocationPointerInputElement(id);\n    inputs.appendChild(_inputPointer);\n\n    if (this.options.tag.addOption) {\n        var _inputAddStage = this._addPointElement = this._createLocationAddPointElement();\n        inputs.appendChild(_inputAddStage);\n    }\n\n    if (this.options.tag.removeOption) {\n        var _inputRemoveStage = this._removePointElement = this._createLocationRemovePointElement(id);\n        inputs.appendChild(_inputRemoveStage);\n    }\n\n    var results = this._suggestedContainer = this._createLocationAutoCompleteResultElement(id);\n    container.appendChild(results);\n\n    return container;\n};\n\n// ################################################################### //\n// ###################### handlers events (dom) ###################### //\n// ################################################################### //\n\n/**\n * this method is called by event 'click' on 'GPlocationOrigin' input\n *\n * @private\n */\nLocationSelector.prototype.onAutoCompleteInputClick = function() {\n    if (this._inputAutoCompleteContainer && this._inputAutoCompleteContainer.value.length > 2) {\n        this._displaySuggestedLocation();\n    }\n};\n\n/**\n * this method is called by event 'keyup' on 'GProuteOrigin' tag input\n * (cf. this._createRouteAutoCompleteteInputElement), and it gets the value of input.\n * this value is passed as a parameter for the service autocomplete (text).\n * the results of the request are displayed into a drop down menu.\n * FIXME\n *\n * @param {Object} e - HTMLElement\n * @private\n */\nLocationSelector.prototype.onAutoCompleteSearchText = function(e) {\n\n    var value = e.target.value;\n    if (!value) {\n        return;\n    }\n\n    // aucun droits !\n    // on evite une requte...\n    if (this._noRightManagement) {\n        console.log(\"no rights for this service !?\");\n        return;\n    }\n\n    // on sauvegarde le localisant\n    this._currentLocation = value;\n\n    // on limite les requtes  partir de 3 car. saisie !\n    if (value.length < 3) {\n        this._clearSuggestedLocation();\n        return;\n    }\n\n    // INFORMATION\n    // on effectue la requte au service d'autocompletion.\n    // on met en place des callbacks afin de recuperer les resultats ou\n    // les messages d'erreurs du service.\n    // les resultats sont affichs dans une liste deroulante.\n    // les messages d'erreurs sont affichs sur la console (?)\n    var context = this;\n    this._requestAutoComplete({\n        text: value,\n        maximumResponses: 5, // FIXME je limite le nombre de reponse car le container DOM est limit dans l'affichage !!!\n        /** callback onSuccess */\n        onSuccess: function(results) {\n            if (results) {\n                var locations = results.suggestedLocations;\n                context._fillAutoCompletedLocationListContainer(locations);\n            }\n        },\n        /** callback onFailure */\n        onFailure: function(error) {\n            // FIXME\n            // o affiche t on les messages : ex. 'No suggestion matching the search' ?\n            // doit on nettoyer la liste des suggestions dernierement enregistre :\n            context._clearSuggestedLocation();\n            logger.log(error.message);\n        }\n    });\n\n    var map = this.getMap();\n    map.on(\n        \"click\",\n        this._hideSuggestedLocation,\n        this\n    );\n    map.on(\n        \"pointerdrag\",\n        this._hideSuggestedLocation,\n        this\n    );\n};\n\n/**\n * this method is called by event 'click' on 'GPautoCompleteResultsList' tag div\n * (cf. this._createAutoCompleteListElement), and it selects the location.\n * this location displays a marker on the map.\n * FIXME\n *\n * @param {Object} e - HTMLElement\n * @private\n */\nLocationSelector.prototype.onAutoCompletedResultsItemClick = function(e) {\n\n    var idx = SelectorID.index(e.target.id);\n\n    if (!idx) {\n        return;\n    }\n\n    // FIXME\n    // les coordonnes sont inverses entre les 2 services !?\n    // AutoCompletion : lon/lat (\"EPSG:4326\")\n    // Geocoding : lat/lon\n    var position = [\n        this._suggestedLocations[idx].position.x,\n        this._suggestedLocations[idx].position.y\n    ];\n    // on sauvegarde le point courant (en EPSG:4326, [lon, lat])\n    this._coordinate = position;\n\n    var info = {\n        type: this._suggestedLocations[idx].type,\n        fields: this._suggestedLocations[idx]\n    };\n\n    // on ajoute le texte de l'autocompltion dans l'input\n    var label = this._suggestedLocations[idx].fullText;\n    this._setLabel(label);\n\n    // Info : la position est en EPSG:4326,  transformer dans la projection de la carte\n    var view = this.getMap().getView();\n    var mapProj = view.getProjection().getCode();\n    if (mapProj !== \"EPSG:4326\") {\n        // on retransforme les coordonnes de la position dans la projection de la carte\n        position = ol.proj.transform(position, \"EPSG:4326\", mapProj);\n    }\n    // on centre la vue et positionne le marker,  la position reprojete dans la projection de la carte\n    this._setPosition(position);\n    this._setMarker(position, info, this.options.displayInfo);\n\n};\n\n/**\n * this method is called by event 'click' on 'GProuteOriginPointerImg' tag input\n * (cf. this._createRoutePointerInputElement), and it create or remove the event of click map.\n *\n * @private\n */\nLocationSelector.prototype.onActivateMapPointClick = function() {\n    var map = this.getMap();\n\n    if (this._inputShowPointerContainer.checked) {\n        // on efface l'ancien resultat\n        this._clearResults();\n        map.on(\n            \"click\",\n            this.onMouseMapClick,\n            this\n        );\n        this._setCursor(\"crosshair\");\n    } else {\n        map.un(\n            \"click\",\n            this.onMouseMapClick,\n            this\n        );\n        this._setCursor();\n    }\n};\n\n/**\n * this method is called by event 'click' on 'GProuteOriginLabel' tag label\n * (cf. this._createRoutePointLabelElement).\n * this point is erased.\n *\n * @private\n */\nLocationSelector.prototype.onLocationClearPointClick = function() {\n    this._setCursor();\n    this._clearResults();\n};\n\n/**\n * this method is called by event 'click' on 'GProuteStageRemove' tag input\n * (cf. this._createRouteRemovePointElement).\n * this point is deleted\n *\n * @private\n */\nLocationSelector.prototype.onLocationRemovePointClick = function() {\n    this._setCursor();\n    this._clearResults();\n};\n\n/**\n * TODO this method is called by event 'click' on 'GProuteStageAdd' tag input\n * (cf. this._createRouteAddPointElement).\n * this point is added as a parameter for the service route.\n *\n * @param {Object} e - HTMLElement\n */\nLocationSelector.prototype.onLocationAddPointClick = function(e) {\n    logger.log(\"onRouteAddPointClick\", e);\n};\n\n// ################################################################### //\n// #################### handlers events (control) #################### //\n// ################################################################### //\n\n/**\n * this method is called by event 'click' on map\n * (cf. this.onRouteMapPointClick), and it gets the coordinate of click on map.\n * this point is saved as a parameter for the service route.\n *\n * @param {Object} e - HTMLElement\n * @private\n */\nLocationSelector.prototype.onMouseMapClick = function(e) {\n\n    var coordinate = e.coordinate;\n    if (!e.map || !e.map.getView()) {\n        return;\n    }\n    var crs = e.map.getView().getProjection();\n\n    this._setCoordinate(coordinate, crs);\n\n    this._setMarker([\n        coordinate[0],\n        coordinate[1]\n    ], null, false);\n\n    // on desactive l'event sur la map !\n    this.onActivateMapPointClick(e);\n};\n\n// ################################################################### //\n// ################# pivates methods use by events ################### //\n// ################################################################### //\n\n/**\n * this sends the label to the panel.\n *\n * @param {String} label - label suggested location\n * @private\n */\nLocationSelector.prototype._setLabel = function(label) {\n    this._inputAutoCompleteContainer.value = label;\n};\n\n/**\n * this change the cursor of the map when entering a point.\n *\n * @param {String} cursor - cursor style\n * @private\n */\nLocationSelector.prototype._setCursor = function(cursor) {\n    var map = this.getMap();\n    var div = map.getTargetElement();\n\n    if (cursor) {\n        div.style.cursor = cursor;\n    } else {\n        div.style.cursor = null;\n    }\n};\n\n/**\n * this sends the coordinates to the panel.\n *\n * @method _setCoordinate\n * @param {Array} olCoordinate - ol.Coordinate object [lon, lat] ou [x, y] (proj = map proj system)\n * @param {Object} crs - coordinate CRS (ol.proj.Projection)\n * @private\n */\nLocationSelector.prototype._setCoordinate = function(olCoordinate, crs) {\n\n    // structure\n    // ol.Coordinate\n    //      [\n    //          4   // lon ou x\n    //          48  // lat ou y\n    //      ]\n\n    // on transforme olCoodinate (dont la projection est celle de la carte) en EPSG:4326\n    this._coordinate = ol.proj.transform(olCoordinate, crs, \"EPSG:4326\");\n\n    // INFO : si on veut des DMS\n    // var coords = ol.coordinate.toStringHDMS(this._coordinate, 2).split(\"N \");\n    // // coords est du type : \"48 00 00 N 2 00 00 E\". On veut rcuprer les 2 coordonnes sparment.\n    // var lat = coords[0] + \"N\";\n    // var lng = coords[1];\n\n    // Pour avoir des degrs dcimaux :\n    var lat = this._coordinate[0].toFixed(4);\n    var lng = this._coordinate[1].toFixed(4);\n\n    var value = lat + \" / \" + lng;\n    this.GPdisplayCoordinate(value);\n\n};\n\n/**\n * this method is called by this.on*ResultsItemClick()\n * and set center at given position.\n *\n * @param {Array} position - ol.Coordinate object [lon, lat] (en lat/lon : \"EPSG:4326\")\n * @private\n */\nLocationSelector.prototype._setPosition = function(position) {\n    var view = this.getMap().getView();\n    view.setCenter(position);\n};\n\n/**\n * this method is called by this.on*ResultsItemClick()\n * and displays a marker.\n * FIXME : marker IGN et informations ?\n *\n * @param {Array} position - ol.Coordinate object [lon, lat] ou [x, y]\n * @param {Object} information - suggested or geocoded information\n * @param {Boolean} display - display a popup information\n * @private\n */\nLocationSelector.prototype._setMarker = function(position, information, display) {\n\n    var map = this.getMap();\n    // remove previous markers\n    if (this._marker != null) {\n        map.removeOverlay(this._marker);\n        this._marker = null;\n    }\n\n    if (position) {\n\n        var markerDiv = document.createElement(\"img\");\n        markerDiv.src = this._markerUrl;\n        this._marker = new ol.Overlay({\n            position: position,\n            offset: this._markerOffset,\n            element: markerDiv,\n            stopEvent: false\n        });\n        map.addOverlay(this._marker);\n\n        if (display) {\n            logger.log(\"marker information : \", information);\n        }\n        // // FIXME\n        // // doit on mettre une information\n        // // - correctement construite ?\n        // // - uniquement informatif ?\n        // // - RIEN ?\n        // if (display) {\n        //     var popupContent = null;\n        //\n        //     var values = [];\n        //\n        //     values.push(information.fields.fullText || \"\");\n        //     values.push(information.fields.street || \"\");\n        //     values.push(information.fields.postalCode || \"\");\n        //     values.push(information.fields.commune || \"\");\n        //\n        //     if (information.type === \"PositionOfInterest\") {\n        //         values.push(information.fields.poi || \"\");\n        //         values.push(information.fields.kind || \"\");\n        //     }\n        //\n        //     popupContent = values.join(\" | \");\n        //\n        //     this._marker.bindPopup(popupContent);\n        // }\n    }\n};\n\n/**\n * this method is called by this.()\n * and it clears all results and the marker.\n *\n * @private\n */\nLocationSelector.prototype._clearResults = function() {\n    var map = this.getMap();\n    this._currentLocation = null;\n    this._coordinate = null;\n    this._hideSuggestedLocation();\n    this._clearSuggestedLocation();\n    this._setMarker();\n    map.un(\n        \"click\",\n        this.onMouseMapClick,\n        this\n    );\n};\n\n/**\n * this method is called by this.onAutoCompleteSearchText()\n * and it clears all suggested location.\n *\n * @private\n */\nLocationSelector.prototype._clearSuggestedLocation = function() {\n    // suppression du dom\n    this._suggestedLocations = [];\n    if (this._suggestedContainer) {\n        while (this._suggestedContainer.firstChild) {\n            this._suggestedContainer.removeChild(this._suggestedContainer.firstChild);\n        }\n    }\n};\n\n/**\n * this method is called by event 'click' on map\n * and it hide suggested locations\n *\n * @private\n */\nLocationSelector.prototype._hideSuggestedLocation = function() {\n    if (this._suggestedContainer) {\n        this._suggestedContainer.style.display = \"none\";\n    }\n};\n\n/**\n * this method is called by this.onAutoCompleteSearchText()\n * and it clears all suggested location.\n *\n * @private\n */\nLocationSelector.prototype._displaySuggestedLocation = function() {\n    if (this._suggestedContainer) {\n        this._suggestedContainer.style.display = \"block\";\n    }\n};\n\n/**\n * this method is called by this.onAutoCompleteSearch()\n * and executes a request to the service.\n *\n * @param {Object} settings - service settings\n * @param {String}   settings.text - text\n * @param {Function} settings.onSuccess - callback\n * @param {Function} settings.onFailure - callback\n * @private\n */\nLocationSelector.prototype._requestAutoComplete = function(settings) {\n    logger.log(\"_requestAutoComplete()\", settings);\n\n    // on ne fait pas de requte si on n'a pas renseign de parametres !\n    if (!settings || Object.keys(settings).length === 0) {\n        return;\n    }\n\n    // on ne fait pas de requte si la parametre 'text' est vide !\n    if (!settings.text) {\n        return;\n    }\n\n    logger.log(settings);\n\n    var options = {};\n    // on recupere les options du service\n    Utils.assign(options, this.options.autocompleteOptions);\n    // ainsi que la recherche et les callbacks\n    Utils.assign(options, settings);\n\n    // les ressources\n    var resources = this._resources[\"AutoCompletion\"] || null;\n    if (resources && Array.isArray(resources)) {\n        if (!options.filterOptions) {\n            options.filterOptions = {};\n        }\n        options.filterOptions.type = resources;\n    }\n\n    // cas o la clef API n'est pas renseigne dans les options du service,\n    // on utilise celle de l'autoconf ou celle renseigne au niveau du controle\n    options.apiKey = options.apiKey || this.options.apiKey;\n\n    logger.log(options);\n\n    Gp.Services.autoComplete(options);\n};\n\n/**\n * this method is called by this.onAutoCompleteSearchText()\n * and fills the container of the location list.\n * it creates a HTML Element per location\n * (cf. this. ...)\n *\n * @private\n */\nLocationSelector.prototype._fillAutoCompletedLocationListContainer = function(locations) {\n\n    if (!locations || locations.length === 0) {\n        return;\n    }\n\n    // on vide la liste avant de la construire\n    var element = this._suggestedContainer;\n    if (element.childElementCount) {\n        while (element.firstChild) {\n            element.removeChild(element.firstChild);\n        }\n    }\n\n    for (var i = 0; i < locations.length; i++) {\n        // Proposals are dynamically filled in Javascript by autocomplete service\n        this._createLocationAutoCompletedLocationElement(this.options.tag.id, locations[i], i);\n    }\n\n    // sauvegarde de l'etat des locations\n    this._suggestedLocations = locations;\n};\n\nexport default LocationSelector;\n\n\n\n// WEBPACK FOOTER //\n// ./src/OpenLayers/Controls/LocationSelector.js","import Gp from \"gp\";\n\n(function() {\n\n    var scripts = document.getElementsByTagName(\"script\");\n\n    var key = scripts[scripts.length - 1].getAttribute(\"data-key\");\n    // in case of several keys\n    if (key) {\n        var splitKeys = key.split(/;|,|\\|/);\n        if (key && splitKeys.length > 1) {\n            var keys = [];\n            for (var i = 0; i < splitKeys.length; i++) {\n                keys.push(splitKeys[i]);\n            }\n            key = keys;\n        }\n    }\n    var url = scripts[scripts.length - 1].getAttribute(\"data-url\");\n    var timeout = scripts[scripts.length - 1].getAttribute(\"data-timeout\");\n\n    /** callback */\n    var success = function() {\n        // Pas de messages en mode prod\n        // console.log(\"GetConfig success!\");\n    };\n\n    /** callback */\n    var error = function(e) {\n        throw new Error(\"Configuration load failed : \" + e.message);\n    };\n\n    if (!key && !url) {\n        // pas de message d'information !\n        // console.log(\"WARNING : parameters missing 'data-key' and 'data-url', the loading of configuration can not be done !\");\n        return;\n    }\n\n    var options = {\n        apiKey: key,\n        onSuccess: success,\n        onFailure: error\n    };\n\n    if (url) {\n        options.serverUrl = url;\n        options.callbackSuffix = \"\";\n    }\n\n    if (timeout) {\n        options.timeOut = timeout;\n    }\n\n    // test d'existance de la varibale globale Gp.Config\n    if (!Gp.Config) {\n        // appel du service\n        Gp.Services.getConfig(options);\n    }\n})();\n\n\n\n// WEBPACK FOOTER //\n// ./src/Common/Utils/AutoLoadConfig.js","module.exports = __WEBPACK_EXTERNAL_MODULE_47__;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external {\"commonjs2\":\"request\",\"commonjs\":\"request\",\"amd\":\"require\"}\n// module id = 47\n// module chunks = 0","import commonGPdrawing from \"../../res/Common/GPdrawing.css\";\nimport commonGPisochron from \"../../res/Common/GPisochron.css\";\nimport commonGPmeasureAzimuth from \"../../res/Common/GPmeasureAzimuth.css\";\nimport commonGPreverseGeocoding from \"../../res/Common/GPreverseGeocoding.css\";\nimport commonGPelevationPath from \"../../res/Common/GPelevationPath.css\";\nimport commonGPlayerSwitcher from \"../../res/Common/GPlayerSwitcher.css\";\nimport commonGPmeasureLength from \"../../res/Common/GPmeasureLength.css\";\nimport commonGProute from \"../../res/Common/GProute.css\";\nimport commonGPgeneralWidget from \"../../res/Common/GPgeneralWidget.css\";\nimport commonGPlocation from \"../../res/Common/GPlocation.css\";\nimport commonGPmeasureToolTip from \"../../res/Common/GPmeasureToolTip.css\";\nimport commonGPsearchEngine from \"../../res/Common/GPsearchEngine.css\";\nimport commonGPgetFeatureInfo from \"../../res/Common/GPgetFeatureInfo.css\";\nimport commonGPmeasureArea from \"../../res/Common/GPmeasureArea.css\";\nimport commonGPmousePosition from \"../../res/Common/GPmousePosition.css\";\n\nimport generalGPgeneralWidgetOpenLayers from \"../../res/Itowns/GPgeneralWidgetItowns.css\";\n\nimport controlGPattributionItowns from \"../../res/Itowns/Controls/Attribution/GPattributionItowns.css\";\nimport controlGPlayerSwitcherItowns from \"../../res/Itowns/Controls/LayerSwitcher/GPlayerSwitcherItowns.css\";\nimport controlGPminiGlobeItowns from \"../../res/Itowns/Controls/MiniGlobe/GPminiGlobeItowns.css\";\nimport controlGPmousePositionItowns from \"../../res/Itowns/Controls/MousePosition/GPmousePositionItowns.css\";\nimport controlGPscaleItowns from \"../../res/Itowns/Controls/Scale/GPscaleItowns.css\";\n\n\n\n// WEBPACK FOOTER //\n// ./src/Itowns/CSS.js","// removed by extract-text-webpack-plugin\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./res/Itowns/GPgeneralWidgetItowns.css\n// module id = 49\n// module chunks = 0","// removed by extract-text-webpack-plugin\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./res/Itowns/Controls/Attribution/GPattributionItowns.css\n// module id = 50\n// module chunks = 0","// removed by extract-text-webpack-plugin\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./res/Itowns/Controls/LayerSwitcher/GPlayerSwitcherItowns.css\n// module id = 51\n// module chunks = 0","// removed by extract-text-webpack-plugin\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./res/Itowns/Controls/MiniGlobe/GPminiGlobeItowns.css\n// module id = 52\n// module chunks = 0","// removed by extract-text-webpack-plugin\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./res/Itowns/Controls/MousePosition/GPmousePositionItowns.css\n// module id = 53\n// module chunks = 0","// removed by extract-text-webpack-plugin\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./res/Itowns/Controls/Scale/GPscaleItowns.css\n// module id = 54\n// module chunks = 0","import commonGPdrawing from \"../../res/Common/GPdrawing.css\";\nimport commonGPisochron from \"../../res/Common/GPisochron.css\";\nimport commonGPmeasureAzimuth from \"../../res/Common/GPmeasureAzimuth.css\";\nimport commonGPreverseGeocoding from \"../../res/Common/GPreverseGeocoding.css\";\nimport commonGPelevationPath from \"../../res/Common/GPelevationPath.css\";\nimport commonGPlayerSwitcher from \"../../res/Common/GPlayerSwitcher.css\";\nimport commonGPmeasureLength from \"../../res/Common/GPmeasureLength.css\";\nimport commonGProute from \"../../res/Common/GProute.css\";\nimport commonGPgeneralWidget from \"../../res/Common/GPgeneralWidget.css\";\nimport commonGPlocation from \"../../res/Common/GPlocation.css\";\nimport commonGPmeasureToolTip from \"../../res/Common/GPmeasureToolTip.css\";\nimport commonGPsearchEngine from \"../../res/Common/GPsearchEngine.css\";\nimport commonGPgetFeatureInfo from \"../../res/Common/GPgetFeatureInfo.css\";\nimport commonGPmeasureArea from \"../../res/Common/GPmeasureArea.css\";\nimport commonGPmousePosition from \"../../res/Common/GPmousePosition.css\";\n\nimport generalGPgeneralWidgetOpenLayers from \"../../res/OpenLayers/GPgeneralWidgetOpenLayers.css\";\n\nimport controlGpattributionOpenLayers from \"../../res/OpenLayers/Controls/Attribution/GpattributionOpenLayers.css\";\nimport controlGPmeasureAreaOpenLayers from \"../../res/OpenLayers/Controls/Measures/GPmeasureAreaOpenLayers.css\";\nimport controlGPdrawingOpenLayers from \"../../res/OpenLayers/Controls/Drawing/GPdrawingOpenLayers.css\";\nimport controlGPmeasureAzimuthOpenLayers from \"../../res/OpenLayers/Controls/Measures/GPmeasureAzimuthOpenLayers.css\";\nimport controlGPelevationPathOpenLayers from \"../../res/OpenLayers/Controls/ElevationPath/GPelevationPathOpenLayers.css\";\nimport controlGPmeasureLengthOpenLayers from \"../../res/OpenLayers/Controls/Measures/GPmeasureLengthOpenLayers.css\";\nimport controlGPgetFeatureInfoOpenLayers from \"../../res/OpenLayers/Controls/GetFeatureInfo/GPgetFeatureInfoOpenLayers.css\";\nimport controlGPmousePositionOpenLayers from \"../../res/OpenLayers/Controls/MousePosition/GPmousePositionOpenLayers.css\";\nimport controlGPisochronOpenLayers from \"../../res/OpenLayers/Controls/Isochrone/GPisochronOpenLayers.css\";\nimport controlGPreverseGeocodingOpenLayers from \"../../res/OpenLayers/Controls/ReverseGeocoding/GPreverseGeocodingOpenLayers.css\";\nimport controlGPimportOpenLayers from \"../../res/OpenLayers/Controls/LayerImport/GPimportOpenLayers.css\";\nimport controlGProuteOpenLayers from \"../../res/OpenLayers/Controls/Route/GProuteOpenLayers.css\";\nimport controlGPlayerSwitcherOpenLayers from \"../../res/OpenLayers/Controls/LayerSwitcher/GPlayerSwitcherOpenLayers.css\";\nimport controlGPsearchEngineOpenLayers from \"../../res/OpenLayers/Controls/SearchEngine/GPsearchEngineOpenLayers.css\";\nimport controlGPlocationOpenLayers from \"../../res/OpenLayers/Controls/LocationSelector/GPlocationOpenLayers.css\";\nimport controlGPtoolBoxMeasureOpenLayers from \"../../res/OpenLayers/Controls/ToolBoxMeasure/GPtoolBoxMeasureOpenLayers.css\";\n\n\n\n// WEBPACK FOOTER //\n// ./src/OpenLayers/CSS.js","// removed by extract-text-webpack-plugin\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./res/OpenLayers/GPgeneralWidgetOpenLayers.css\n// module id = 56\n// module chunks = 0","// removed by extract-text-webpack-plugin\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./res/OpenLayers/Controls/Attribution/GpattributionOpenLayers.css\n// module id = 57\n// module chunks = 0","// removed by extract-text-webpack-plugin\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./res/OpenLayers/Controls/Measures/GPmeasureAreaOpenLayers.css\n// module id = 58\n// module chunks = 0","// removed by extract-text-webpack-plugin\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./res/OpenLayers/Controls/Drawing/GPdrawingOpenLayers.css\n// module id = 59\n// module chunks = 0","// removed by extract-text-webpack-plugin\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./res/OpenLayers/Controls/Measures/GPmeasureAzimuthOpenLayers.css\n// module id = 60\n// module chunks = 0","// removed by extract-text-webpack-plugin\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./res/OpenLayers/Controls/ElevationPath/GPelevationPathOpenLayers.css\n// module id = 61\n// module chunks = 0","// removed by extract-text-webpack-plugin\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./res/OpenLayers/Controls/Measures/GPmeasureLengthOpenLayers.css\n// module id = 62\n// module chunks = 0","// removed by extract-text-webpack-plugin\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./res/OpenLayers/Controls/GetFeatureInfo/GPgetFeatureInfoOpenLayers.css\n// module id = 63\n// module chunks = 0","// removed by extract-text-webpack-plugin\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./res/OpenLayers/Controls/MousePosition/GPmousePositionOpenLayers.css\n// module id = 64\n// module chunks = 0","// removed by extract-text-webpack-plugin\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./res/OpenLayers/Controls/Isochrone/GPisochronOpenLayers.css\n// module id = 65\n// module chunks = 0","// removed by extract-text-webpack-plugin\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./res/OpenLayers/Controls/ReverseGeocoding/GPreverseGeocodingOpenLayers.css\n// module id = 66\n// module chunks = 0","// removed by extract-text-webpack-plugin\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./res/OpenLayers/Controls/LayerImport/GPimportOpenLayers.css\n// module id = 67\n// module chunks = 0","// removed by extract-text-webpack-plugin\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./res/OpenLayers/Controls/Route/GProuteOpenLayers.css\n// module id = 68\n// module chunks = 0","// removed by extract-text-webpack-plugin\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./res/OpenLayers/Controls/LayerSwitcher/GPlayerSwitcherOpenLayers.css\n// module id = 69\n// module chunks = 0","// removed by extract-text-webpack-plugin\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./res/OpenLayers/Controls/SearchEngine/GPsearchEngineOpenLayers.css\n// module id = 70\n// module chunks = 0","// removed by extract-text-webpack-plugin\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./res/OpenLayers/Controls/LocationSelector/GPlocationOpenLayers.css\n// module id = 71\n// module chunks = 0","// removed by extract-text-webpack-plugin\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./res/OpenLayers/Controls/ToolBoxMeasure/GPtoolBoxMeasureOpenLayers.css\n// module id = 72\n// module chunks = 0","import Gp from \"gp\";\nimport * as Itowns from \"itowns\";\nimport LayerUtils from \"../Common/Utils/LayerUtils\";\nimport MousePosition from \"./Controls/MousePosition\";\nimport LayerSwitcher from \"./Controls/LayerSwitcher\";\nimport Attributions from \"./Controls/Attributions\";\nimport Scale from \"./Controls/Scale\";\nimport MiniGlobe from \"./Controls/MiniGlobe\";\nimport GlobeViewExtended from \"./GlobeViewExtended\";\n\n\n// Adds the extensions properties in the Gp namespace\nGp.LayerUtils = LayerUtils ;\n\n// determines the execution environment l'environnement : browser or not ?\nvar scope = typeof window !== \"undefined\" ? window : {};\n\n// creation of the namespace for the itowns extensions\nItowns.control = {};\nItowns.control.MousePosition = MousePosition;\nItowns.control.LayerSwitcher = LayerSwitcher;\nItowns.control.Attributions = Attributions;\nItowns.control.Scale = Scale;\nItowns.control.MiniGlobe = MiniGlobe;\nItowns.GlobeViewExtended = GlobeViewExtended;\n\n// saves in the global variable !\nif ( !scope.itowns ){\n    scope.itowns = {};\n}\n\ndeepCopy( Itowns, scope.itowns );\n\nfunction deepCopy(source, target)\n{\n    for (var prop in source) {\n        if ( source.hasOwnProperty(prop) ) {\n            if ( !target.hasOwnProperty(prop) ) {\n                target[prop] = source[prop];\n            } else if ( typeof source[prop] === \"object\" ) {\n                deepCopy( source[prop], target[prop] );\n            }\n        }\n    }\n}\n\nexport default Gp;\n\n\n\n// WEBPACK FOOTER //\n// ./src/Itowns/GpPluginItowns.js","import proj4 from \"proj4\";\nimport Logger from \"../../Common/Utils/LoggerByDefault\";\nimport Gp from \"gp\";\nimport GlobeViewExtended from \"../GlobeViewExtended\";\nimport Utils from \"../../Common/Utils\";\nimport RightManagement from \"../../Common/Utils/CheckRightManagement\";\nimport SelectorID from \"../../Common/Utils/SelectorID\";\nimport MousePositionDOM from \"../../Common/Controls/MousePositionDOM\";\nimport Widget from \"./Widget\";\nimport PositionFormater from \"./Utils/PositionFormater\";\nimport CRS from \"../CRS/CRS\";\n\n\n\nvar logger = Logger.getLogger(\"MousePosition\");\n\n/**\n * @classdesc\n *\n * MousePosition Control.\n *\n * @constructor\n * @alias itowns.control.MousePosition\n * @extends {itowns.control.Control}\n * @param {Object} options - options for function call.\n * @param {Boolean} [options.collapsed = true] - Specify if MousePosition control should be collapsed at startup. Default is true.\n * @param {Array}   [options.systems] - list of projection systems, default are Geographical (\"EPSG:4326\"), Web Mercator (\"EPSG:3857\"), Lambert 93 (\"EPSG:2154\") and extended Lambert 2 (\"EPSG:27572\").\n *      Each array element (=system) is an object with following properties :\n * @param {String}  options.systems.crs - Proj4 crs alias (from proj4 defs). e.g. : \"EPSG:4326\". Required\n * @param {String}  [options.systems.label] - CRS label to be displayed in control. Default is crs code (e.g. \"EPSG:4326\")\n * @param {String}  options.systems.type - CRS units type for coordinates conversion : \"Geographical\" or \"Metric\". Default: \"Metric\"\n * @param {Object}  [options.systems.geoBBox] - Aera covered by the system (WGS84 coordinates).\n * @param {Number}  options.systems.geoBBox.right - Right bound.\n * @param {Number}  options.systems.geoBBox.left - Left bound.\n * @param {Number}  options.systems.geoBBox.top - Top bound.\n * @param {Number}  options.systems.geoBBox.bottom - Bottom bound.\n * @param {Array}   [options.units] - list of coordinates units, to be displayed in control units list.\n *      Values may be \"DEC\" (decimal degrees), \"DMS\" (sexagecimal), \"RAD\" (radians) and \"GON\" (grades) for geographical coordinates,\n *      and \"M\" or \"KM\" for metric coordinates\n * @param {Array}   [options.displayAltitude = true] - activate (true) or deactivate (false) the altitude panel. True by default\n * @param {Array}   [options.displayCoordinates = true] - activate (true) or deactivate (false) the coordinates panel. True by default\n * @param {Object}  [options.altitude] - elevation configuration\n * @param {Object}  [options.altitude.serviceOptions] - options of elevation service\n * @param {Number}  [options.altitude.responseDelay] - latency for altitude request, 500 ms by default\n * @param {Number}  [options.altitude.triggerDelay] - immobilisation time of movement on the globe to trigger the elevation calculation, 200 ms by default\n * @example\n *  var mousePosition = new itowns.control.MousePosition({\n *      collapsed : false,\n *      displayCoordinates : true,\n *      displayAltitude : true,\n *      altitude : {\n *           triggerDelay : 100,\n *           responseDelay : 500,\n *           serviceOptions : {}\n *      },\n *      systems : [\n *       {\n *          crs : \"EPSG:3857\",\n *          label : \"Mercator\",\n *          type : \"Metric\"\n *        },\n *       {\n *          crs : \"EPSG:32620\",\n *          label : \"UTM 20N (Guadeloupe, Martinique)\",\n *          type : \"Metric\",\n *          geoBBox : {\n *              left: -66.00,\n *              bottom : 0.00,\n *              right : -60.00,\n *              top : 84.00\n *          }\n *        }\n *      ],\n *      units : [\"DEC\", \"DMS\"]\n *  });\n */\nfunction MousePosition(options) {\n\n    options = options || {};\n\n    if (!(this instanceof MousePosition)) {\n        throw new TypeError(\"ERROR CLASS_CONSTRUCTOR\");\n    }\n\n    if (options && typeof options !== \"object\") {\n        throw new Error(\"ERROR WRONG_TYPE : options should be an object\");\n    }\n\n    this._initialize(options);\n\n    this._callbacks = {};\n\n    // init control DOM container\n    var container = this._initContainer(options);\n    var targetDiv = document.getElementById(options.target) || null;\n    Widget.call(\n        this, {\n            name: \"MousePosition\",\n            element: container,\n            target: targetDiv\n        }\n    );\n};\n\n/**\n * @lends module:MousePosition\n */\nMousePosition.prototype = Object.create(Widget.prototype, {});\n\nUtils.assign(MousePosition.prototype, MousePositionDOM);\n\n/**\n * Constructor (alias)\n */\nMousePosition.prototype.constructor = MousePosition;\n\n/**\n * Bind globe to control\n */\nMousePosition.prototype.setGlobe = function(globe) {\n\n    if (globe) { // In the case of the adding of a control to the globe\n\n        this._centerElement = this._createMapCenter();\n        globe.getTargetElement().appendChild(this._centerElement);\n\n        // defines the callback on the map to retrieve the coordinates\n        this._callbacks.mouseMove = this.onMouseMove.bind(this);\n\n        // valid event for desktop mode\n        if (!this.collapsed) {\n            if (this._isDesktop) {\n                globe.listen(GlobeViewExtended.EVENTS.MOUSE_MOVE, this._callbacks.mouseMove);\n            } else {\n                globe.listen(GlobeViewExtended.EVENTS.CENTER_CHANGED, this.onGlobeMove);\n            }\n        }\n    } else if (globe == null) { // if globe == null we remove the MP control\n        // deletes the listener associated to the mousePosition control\n        this._globe.forget(GlobeViewExtended.EVENTS.MOUSE_MOVE, this._callbacks.mouseMove);\n        // deletes the mousePosition control DOM\n        while (this.getElement().hasChildNodes()) {\n            this.getElement().removeChild(this.getElement().lastChild);\n        }\n        this.getElement().parentNode.removeChild(this.getElement());\n        this._globe.getTargetElement().removeChild(this._centerElement);\n    }\n    // call original setGlobe method\n    Widget.prototype.setGlobe.call(this, globe);\n};\n\n// ################################################################### //\n// #################### user interface methods ####################### //\n// ################################################################### //\n\n/**\n * Sets additional projection system\n *\n * @method use system defined in the Itowns/CRS/CRS.js class\n * @param {Object} system - Projection system\n * @param {String} system.crs - Proj4 crs alias (from proj4 defs) e.g. \"EPSG:4326\"\n * @param {String} [system.label] - CRS label to be displayed in control. Default is system.crs alias\n * @param {String} [system.type] - CRS units type for coordinates conversion (one of control options.units). Default is \"Metric\"\n */\nMousePosition.prototype.addSystem = function(system) {\n    if (typeof system !== \"object\") {\n        console.log(\"[ERROR] MousePosition:addSystem - system parameter should be an object\");\n        return;\n    }\n    if (!system.crs) {\n        logger.error(\"crs not defined !\");\n        return;\n    }\n    if (!system.label) {\n        logger.warn(\"crs label not defined, use crs code by default.\");\n        system.label = system.crs;\n    }\n    if (!system.type) {\n        logger.warn(\"type srs not defined, use 'Metric' by default.\");\n        system.type = \"Metric\";\n    }\n\n    // 1. adds system to control systems\n    for (var j = 0; j < this._projectionSystems.length; j++) {\n        var obj = this._projectionSystems[j];\n        if (system.crs === obj.crs) {\n            // warn user\n            console.log(\"crs '{}' already configured\", obj.crs);\n        }\n    }\n\n    system.code = this._projectionSystems.length;\n    this._projectionSystems.push(system);\n\n    // 2. adds system settings option to container (if it was already build)\n    var selectSystem = document.getElementById(this._addUID(\"GPmousePositionProjectionSystem\"));\n    if (selectSystem) {\n        var option = document.createElement(\"option\");\n        option.value = system.code;\n        option.text = system.label;\n        selectSystem.appendChild(option);\n    }\n};\n\n/**\n * Sets additional projection systems\n *\n * @param {Array} systems - Array of system object, with following properties :\n * @param {String} systems.crs - Proj4 CRS alias (from proj4 defs) e.g. \"EPSG:4326\"\n * @param {String} systems.label - CRS label (for coordinates conversion)\n * @param {String} systems.type - CRS units type to be displayed in control (one of control options.units). Default is \"Metric\"\n */\nMousePosition.prototype.addSystems = function(systems) {\n    if (!systems) {\n        return;\n    }\n    if (!Array.isArray(systems)) {\n        console.log(\"[ERROR] MousePosition:addSystems - systems parameter should be an array\");\n        return;\n    }\n    for (var i = 0; i < systems.length; i++) {\n        this.addSystem(systems[i]);\n    }\n};\n\n/**\n * Removes projection system (in case there are several system with same code, only the first one will be removed)\n *\n * @param {String} systemCrs - CRS alias (from proj4 defs)\n */\nMousePosition.prototype.removeSystem = function(systemCrs) {\n    if (!systemCrs || typeof systemCrs !== \"string\") {\n        console.log(\"[ERROR] MousePosition:removeSystem - systemCode parameter should be a string\");\n        return;\n    }\n\n    var systemCode = null;\n    // finds system in control projection systems list\n    for (var i = 0; i < this._projectionSystems.length; i++) {\n        var proj = this._projectionSystems[i];\n        if (systemCrs === proj.crs) {\n            systemCode = proj.code;\n            // removes system from control projection systems list\n            this._projectionSystems.splice(i, 1);\n            break;\n        }\n    }\n\n    if (systemCode == null) {\n        console.log(\"[WARN] MousePosition:removeSystem - system not found\");\n        return;\n    }\n\n    // re-initialization of codes\n    var oldNewCodeGlobe = [];\n    for (var ii = 0; ii < this._projectionSystems.length; ii++) {\n        oldNewCodeGlobe[Number(this._projectionSystems[ii].code)] = ii;\n        this._projectionSystems[ii].code = ii;\n    }\n\n    // finds system in control container systems list\n    var indexChildToRemove = null;\n    var systemList = document.getElementById(this._addUID(\"GPmousePositionProjectionSystem\"));\n    for (var j = 0; j < systemList.childNodes.length; j++) {\n        if (systemCode == systemList.childNodes[j].value) {\n            indexChildToRemove = j;\n            continue;\n        }\n        systemList.childNodes[j].value = oldNewCodeGlobe[Number(systemList.childNodes[j].value)];\n    }\n    // removes system from control container systems list\n    if (indexChildToRemove != null) {\n        systemList.removeChild(systemList.childNodes[indexChildToRemove]);\n    }\n\n    // choose arbitrarily a new current system if needed\n    if (this._currentProjectionSystems.code == systemCode) {\n        systemList.childNodes[0].setAttribute(\"selected\", \"selected\");\n        this._setCurrentSystem(systemList.childNodes[0].value);\n    }\n};\n\n/**\n * Sets control units (to be displayed)\n *\n * @param {Array} units - list of all coordinates units, to be displayed in control units list.\n *      Values may be \"DEC\" (decimal degrees), \"DMS\" (sexagecimal), \"RAD\" (radians) and \"GON\" (grades) for geographical coordinates,\n *      and \"M\" or \"KM\" for metric coordinates\n */\nMousePosition.prototype.setUnits = function(units) {\n    if (!units || !Array.isArray(units)) {\n        return;\n    }\n    this.options.units = units;\n    this._projectionUnits = {};\n    this._initProjectionUnits();\n    if (this._currentProjectionType) {\n        this._setTypeUnitsPanel(this._currentProjectionType);\n    }\n};\n\n/**\n * Sets control altitude options (useless if displayAltitude == false)\n *\n * @param {Object} options - altitude options\n * @param {Object}  [options.serviceOptions] - options of elevation service\n * @param {Number}  [options.responseDelay] - latency for elevation request, 500 ms by default\n * @param {Number}  [options.triggerDelay] - immobilisation time of movement on the globe to trigger the elevation calculation, 200 ms by default\n */\nMousePosition.prototype.setAltitudeOptions = function(options) {\n    if (!options || typeof options !== \"object\") {\n        return;\n    }\n    this.options.altitude.triggerDelay = options.triggerDelay;\n    this.options.altitude.responseDelay = options.responseDelay;\n    if (options.serviceOptions) {\n        for (var opt in options.serviceOptions) {\n            if (options.serviceOptions.hasOwnProperty(opt)) {\n                this.options.altitude.serviceOptions[opt] = options.serviceOptions[opt];\n            }\n        }\n    }\n};\n\n/**\n * Displays or hides elevation panel\n *\n * @param {Boolean} displayAltitude - true to display elevation panel, false to hide it\n */\nMousePosition.prototype.displayAltitude = function(displayAltitude) {\n    if (displayAltitude === undefined) {\n        return;\n    }\n    if (typeof this._noRightManagement === \"undefined\") {\n        this._checkRightsManagement();\n    }\n    this.options.displayAltitude = displayAltitude;\n    this._setElevationPanel(displayAltitude);\n};\n\n/**\n * Displays or hides coordinates panel\n *\n * @param {Boolean} displayCoordinates - true to display coordinates panel, false to hide it\n */\nMousePosition.prototype.displayCoordinates = function(displayCoordinates) {\n    if (displayCoordinates === undefined) {\n        return;\n    }\n    this.options.displayCoordinates = displayCoordinates;\n    this._setCoordinatesPanel(displayCoordinates);\n    this._setSettingsPanel(displayCoordinates);\n};\n\n/**\n * Collapses or displays control main container\n *\n * @param {Boolean} collapsed - True to collapse control, False to display it\n */\nMousePosition.prototype.setCollapsed = function(collapsed) {\n    if (collapsed === undefined) {\n        console.log(\"[ERROR] MousePosition:setCollapsed - missing collapsed parameter\");\n        return;\n    }\n    if ((collapsed && this.collapsed) || (!collapsed && !this.collapsed)) {\n        return;\n    }\n    if (!this._isDesktop) {\n        document.getElementById(this._addUID(\"GPmapCenter\")).className = collapsed ? \"\" : \"GPmapCenterVisible\";\n    }\n    // simulates the opening of the panel after a click\n    this.onShowMousePositionClick();\n    this._showMousePositionContainer.checked = !collapsed;\n};\n\n// ################################################################### //\n// ######################## initialize control ####################### //\n// ################################################################### //\n\n/**\n * Initializes control (called by MousePosition constructor)\n *\n * @method _initialize\n * @param {Object} options - control options (set by user)\n * @private\n */\nMousePosition.prototype._initialize = function(options) {\n\n    // Set default options\n    // {Object} control options - set by user or by default\n    this.options = options || {};\n    this.options.collapsed = (options.collapsed !== undefined) ? options.collapsed : true;\n    /** {Boolean} specify if MousePosition control is collapsed (true) or not (false) */\n    this.collapsed = this.options.collapsed;\n    this.options.units = options.units || [];\n    this.options.displayAltitude = (options.displayAltitude !== undefined) ? options.displayAltitude : true;\n    this.options.displayCoordinates = (options.displayCoordinates !== undefined) ? options.displayCoordinates : true;\n    this.options.systems = options.systems || [];\n    if (options.altitude) {\n        var altitude = options.altitude;\n        this.options.altitude = {\n            triggerDelay: (altitude.triggerDelay !== undefined) ? altitude.triggerDelay : 200,\n            responseDelay: (altitude.responseDelay !== undefined) ? altitude.responseDelay : 500,\n            serviceOptions: altitude.serviceOptions || {},\n            noDataValue: (altitude.noDataValue !== undefined) ? altitude.noDataValue : -99999,\n            noDataValueTolerance: (altitude.noDataValueTolerance !== undefined) ? altitude.noDataValueTolerance : 90000\n        };\n    } else {\n        this.options.altitude = {\n            triggerDelay: 200,\n            responseDelay: 500,\n            serviceOptions: {}\n        };\n    }\n\n    // id of the widget : usefull to suffix the CSS ids (to handle cases with several widgets on the same page)\n    this._uid = SelectorID.generate();\n\n    // initialization of the projections systems\n    this._projectionSystems = [];\n    this._initProjectionSystems();\n\n    // initialization of the units systems\n    this._projectionUnits = {};\n    this._initProjectionUnits();\n\n    // support detect : desktop or tactile\n    this._isDesktop = Utils.detectSupport();\n\n    // implements a timer threshold\n    if (this.options.altitude.triggerDelay < 100) {\n        this.options.altitude.triggerDelay = 100;\n    }\n\n    // {Number} timer on movestopped delay (altitude calculation)\n    this._timer = this.options.altitude.triggerDelay;\n\n    // {Object} Selected projection system\n    this._currentProjectionSystems = this._projectionSystems[0];\n\n    // {String} Selected projection units typs : Geographical or metric\n    this._currentProjectionType = this._projectionSystems[0].type;\n\n    // {String} Selected projection unit\n    this._currentProjectionUnits = this._projectionUnits[this._currentProjectionType][0].code;\n\n    // {Object} Projection units container (DOM Element)\n    this._projectionUnitsContainer = null;\n\n    // {Object} control panel container (DOM Element)\n    this._showMousePositionContainer = null;\n\n    // management of the altitude panel display\n    if (!this.options.displayAltitude && !this.options.displayCoordinates) {\n        // reactivate the display of coordinates, to not display an empty panel\n        this.options.displayCoordinates = true;\n    }\n\n    // rights management on resources and services\n    // if we want an altitude calculation, we check the alti resources rights...\n    if (this.options.displayAltitude) {\n        this._checkRightsManagement();\n    }\n};\n\n/**\n * this method is called by the constructor and initialize the projection\n * systems.\n * getting coordinates in the requested projection :\n * see this.onMousePositionProjectionSystemChange()\n *\n * @method _initProjectionSystems\n * @private\n */\nMousePosition.prototype._initProjectionSystems = function() {\n\n    // user has the possibility to modify the list of systems to display\n    // Ex. this.options.systems\n\n    // available projection systems vy default\n    var projectionSystemsByDefault = [{\n        label: \"Gographique\",\n        crs: \"EPSG:4326\",\n        type: \"Geographical\"\n    }, {\n        label: \"Mercator\",\n        crs: \"EPSG:3857\",\n        type: \"Metric\"\n    }, {\n        label: \"Lambert 93\",\n        crs: \"EPSG:2154\",\n        type: \"Metric\",\n        geoBBox: {\n            left: -9.86,\n            bottom: 41.15,\n            right: 10.38,\n            top: 51.56\n        }\n    }, {\n        label: \"Lambert II tendu\",\n        crs: \"EPSG:27572\",\n        type: \"Metric\",\n        geoBBox: {\n            left: -4.87,\n            bottom: 42.33,\n            right: 8.23,\n            top: 51.14\n        }\n    }];\n\n    var systems = this.options.systems;\n    for (var i = 0; i < systems.length; i++) {\n        // definition of a reference system\n        var sys = systems[i];\n        this.addSystem(sys);\n    }\n\n    if (this._projectionSystems.length === 0) {\n        // we add the default projection systems\n        for (var ii = 0; ii < projectionSystemsByDefault.length; ii++) {\n            this.addSystem(projectionSystemsByDefault[ii]);\n        }\n    }\n};\n\n/**\n * this method is called by the constructor and initialize the units.\n * getting coordinates in the requested units :\n * see this.onMousePositionProjectionUnitsChange()\n *\n * @method _initProjectionUnits\n * @private\n */\nMousePosition.prototype._initProjectionUnits = function() {\n\n    // user has the possibility to modify the list of units to display\n    // Ex.\n    // this.options.units : [\"DEC\", \"DMS\"]\n\n    // available units systems by default\n    var projectionUnitsByDefault = {\n        Geographical: [{\n            code: \"DEC\",\n            label: \"degrs dcimaux\",\n            convert: this._displayDEC\n        }, {\n            code: \"DMS\",\n            label: \"degrs sexagsimaux\",\n            convert: this._displayDMS\n        }, {\n            code: \"RAD\",\n            label: \"radians\",\n            convert: this._displayRAD\n        }, {\n            code: \"GON\",\n            label: \"grades\",\n            convert: this._displayGON\n        }],\n        Metric: [{\n            code: \"M\",\n            label: \"mtres\",\n            convert: this._displayMeter\n        }, {\n            code: \"KM\",\n            label: \"kilomtres\",\n            convert: this._displayKMeter\n        }]\n    };\n\n    var units = this.options.units;\n\n    for (var type in projectionUnitsByDefault) {\n        if (projectionUnitsByDefault.hasOwnProperty(type)) {\n            var found = false;\n            for (var j = 0; j < projectionUnitsByDefault[type].length; j++) {\n                var obj = projectionUnitsByDefault[type][j];\n                for (var i = 0; i < units.length; i++) {\n                    var unit = units[i];\n                    if (obj.code === unit) {\n                        found = true;\n                        if (!this._projectionUnits[type]) {\n                            this._projectionUnits[type] = [];\n                        }\n                        this._projectionUnits[type].push(obj);\n                    }\n                }\n            }\n            if (!found) {\n                this._projectionUnits[type] = projectionUnitsByDefault[type];\n            }\n        }\n    }\n\n    // in case of...\n    if (typeof this._projectionUnits === \"object\" && Object.keys(this._projectionUnits).length === 0) {\n        this._projectionUnits = projectionUnitsByDefault;\n    }\n};\n\n/**\n * this method is called by constructor\n * and check the rights to resources\n *\n * @method _checkRightsManagement\n * @private\n */\nMousePosition.prototype._checkRightsManagement = function() {\n\n    var rightManagement = RightManagement.check({\n        key: this.options.apiKey,\n        resources: [\"SERVICE_CALCUL_ALTIMETRIQUE_RSC\"],\n        services: [\"Elevation\"]\n    });\n\n    this._noRightManagement = !rightManagement;\n\n    // retrieves the usefull infos\n    // on this control, we do not care about the ressource bescause it is unique\n    // Ex : the API key from the autoconfiguration if it has not been given\n    if (!this.options.apiKey) {\n        this.options.apiKey = rightManagement.key;\n    }\n\n};\n\n// ################################################################### //\n// ######################## methods handle dom ####################### //\n// ################################################################### //\n\n/**\n * Create control main container (called by MousePosition constructor)\n *\n * @method _initContainer\n * @private\n */\nMousePosition.prototype._initContainer = function(options) {\n    // creates the main container\n    var container = this._createMainContainerElement();\n\n    var inputShow = this._showMousePositionContainer = this._createShowMousePositionElement();\n    if (!options.collapsed) {\n        inputShow.checked = \"checked\";\n    }\n    container.appendChild(inputShow);\n\n    var picto = this._createShowMousePositionPictoElement(this._isDesktop);\n    container.appendChild(picto);\n\n    var panel = this._createMousePositionPanelElement(options.displayAltitude, options.displayCoordinates);\n    var settings = this._createMousePositionSettingsElement(options.displayCoordinates);\n    var systems = this._projectionSystemsContainer = this._createMousePositionSettingsSystemsElement(this._projectionSystems);\n    var units = this._projectionUnitsContainer = this._createMousePositionSettingsUnitsElement(this._projectionUnits[this._currentProjectionType]);\n\n    settings.appendChild(systems);\n    settings.appendChild(units);\n    panel.appendChild(settings);\n    container.appendChild(panel);\n\n    return container;\n};\n\n/**\n * this method is called by this.()\n * and it changes the elevation view panel into the dom.\n *\n * @method _setElevationPanel\n * @param {Boolean} active - true:active, false:disable\n * @private\n */\nMousePosition.prototype._setElevationPanel = function(active) {\n    var div = null;\n\n    if (!active) {\n        div = document.getElementById(\"GPmousePositionAltitude-\" + this._uid);\n        div.style.display = \"none\";\n    } else {\n        if (this._noRightManagement) {\n            div = document.getElementById(\"GPmousePositionAlt-\" + this._uid);\n            div.innerHTML = \"No rights!\";\n        } else {\n            div = document.getElementById(\"GPmousePositionAltitude-\" + this._uid);\n            div.style.display = \"\";\n        }\n    }\n};\n\n/**\n * this method is called by this.()\n * and it changes the coordinate view panel into the dom.\n *\n * @method _setCoordinatesPanel\n * @param {Boolean} active - true:active, false:disable\n * @private\n */\nMousePosition.prototype._setCoordinatesPanel = function(active) {\n    var div = document.getElementById(\"GPmousePositionCoordinate-\" + this._uid);\n    if (!active) {\n        div.style.display = \"none\";\n    } else {\n        div.style.display = \"\";\n    }\n};\n\n/**\n * this method is called by this.()\n * and it changes the settings view panel into the dom.\n *\n * @method _setSettingsPanel\n * @param {Boolean} active - true:active, false:disable\n * @private\n */\nMousePosition.prototype._setSettingsPanel = function(active) {\n    var divPicto = document.getElementById(\"GPshowMousePositionSettingsPicto-\" + this._uid);\n    var divPanel = document.getElementById(\"GPmousePositionSettings-\" + this._uid);\n    if (!active) {\n        divPicto.style.display = \"none\";\n        divPanel.style.display = \"none\";\n    } else {\n        divPicto.style.display = \"\";\n        divPanel.style.display = \"\";\n    }\n};\n\n/**\n * this method is called by this.onMousePositionProjectionSystemChange()\n * when changes to a metric or a geographical units.\n *\n * @method _setTypeUnitsPanel\n * @param {String} type - Geographical or Metric\n * @private\n */\nMousePosition.prototype._setTypeUnitsPanel = function(type) {\n    var container = this._projectionUnitsContainer;\n\n    // deletes the childNodes\n    while (container.firstChild) {\n        container.removeChild(container.firstChild);\n    }\n\n    var units = this._projectionUnits[type];\n    for (var j = 0; j < units.length; j++) {\n        var obj = units[j];\n        var option = document.createElement(\"option\");\n        option.value = (obj.code) ? obj.code : j;\n        option.text = obj.label || j;\n        // option.label = obj.label;\n        container.appendChild(option);\n    }\n\n    // the new type of system\n    this._currentProjectionType = type;\n    // as the system changed, the unit system has to change too !\n    this._currentProjectionUnits = this._projectionUnits[type][0].code;\n};\n\n// ################################################################### //\n// ######################## method units convert ##################### //\n// ################################################################### //\n\n/**\n * degreedecimal\n *\n * @method _displayDEC\n * @param {Object} coords - coordinatesobject {lon, lat}\n * @return {Object} coordinate - coordinate object : {lat : 48, lng : 2} par exemple\n * @private\n */\nMousePosition.prototype._displayDEC = function(coords) {\n    var coordinate = {};\n    coordinate.lat = PositionFormater.roundToDecimal(coords.lat, 6);\n    coordinate.lng = PositionFormater.roundToDecimal(coords.lon, 6);\n    return coordinate;\n};\n\n/**\n * degreedecimal2sexagecimal\n *\n * @method _displayDMS\n * @param {Object} coords - coordinates object {lon, lat}\n * @return {Object} coordinate - coordinate object : {lng : \"2 00 00 E\", lat : \"48 00 00 N\"} par exemple\n * @private\n */\nMousePosition.prototype._displayDMS = function(coords) {\n    var coordinate = {};\n    coordinate.lat = PositionFormater.decimalLatToDMS(coords.lat);\n    coordinate.lng = PositionFormater.decimalLongToDMS(coords.lon);\n    return coordinate;\n};\n\n/**\n * degreedecimal2radian\n *\n * @method _displayRAD\n * @param {Object} coords - coordinates object {lon, lat}\n * @return {Object} coordinate - coordinate object : {lat : \"0.02837864\", lng : \"0.84300269\"} par exemple\n * @private\n */\nMousePosition.prototype._displayRAD = function(coords) {\n    var coordinate = {};\n    coordinate.lat = PositionFormater.decimalToRadian(coords.lat);\n    coordinate.lng = PositionFormater.decimalToRadian(coords.lon);\n    return coordinate;\n};\n\n/**\n * degreedecimal2grade\n *\n * @method _displayGON\n * @param {Object} coords - coordinates object {lon, lat}\n * @return {Object} coordinate - coordinate object : {lat : \"4.09545898\", lng : \"53.68751528\"} par exemple\n * @private\n */\nMousePosition.prototype._displayGON = function(coords) {\n    var coordinate = {};\n    coordinate.lat = PositionFormater.decimalToGrade(coords.lat);\n    coordinate.lng = PositionFormater.decimalToGrade(coords.lon);\n    return coordinate;\n};\n\n/**\n * meter\n *\n * @method _displayMeter\n * @param {Object} coords - coords object {lon, lat}\n * @return {Object} coordinate - coordinate object : {x : \"148593.58\", y : \"6176560.95\"} par exemple\n * @private\n */\nMousePosition.prototype._displayMeter = function(coords) {\n    // on recoit toujours des coordonnes metriques\n    var coordinate = {};\n    coordinate.x = coords.lon.toFixed(2);\n    coordinate.y = coords.lat.toFixed(2);\n    coordinate.unit = \"m\";\n    return coordinate;\n};\n\n/**\n * kilometer\n *\n * @method _displayKMeter\n * @param {Object} coords - coords object {lon, lat}\n * @return {Object} coordinate - coordinate object : {x : \"214.96\", y : \"6250.09\"} par exemple\n * @private\n */\nMousePosition.prototype._displayKMeter = function(coords) {\n    var coordinate = {};\n    coordinate.x = (coords.lon / 1000).toFixed(2);\n    coordinate.y = (coords.lat / 1000).toFixed(2);\n    coordinate.unit = \"km\";\n    return coordinate;\n};\n\n// ################################################################### //\n// ##################### handlers events to control ################## //\n// ################################################################### //\n\n/**\n * this sends the coordinates to the panel.\n * (cf. this.GPdisplayCoords() into the DOM functions)\n *\n * @method _setCoordinate\n * @param {Array} coords - coordinate object {lon, lat}\n * @private\n */\nMousePosition.prototype._setCoordinate = function(coords) {\n\n    // structure\n    // coords\n    //      {\n    //          lon: 5,\n    //          lat : 48\n    //      }\n    //\n    // structure for the coordinates depending on the system type :\n    // {x:, y:, unit:} or {lng:, lat:} or {lon:, lat:} or {e:, n:, unit:}...\n\n    var coord = [];\n    var coordinates = {};\n\n    // transforms the point in the wanted coords system\n    var oSrs = this._currentProjectionSystems;\n    var crsProp = oSrs.crs;\n\n    if (!oSrs || !crsProp) {\n        console.log(\"ERROR : system crs not found\");\n        return;\n    }\n    // reproject coordinates from their CRS of origin (WGS84) to the wanted CRS (crsProp)\n    if (crsProp !== \"EPSG:4326\") {\n        coord = proj4(CRS[crsProp], [coords.lon, coords.lat]);\n        // projected values are affected to the coord var\n        coordinates.lon = coord[0];\n        coordinates.lat = coord[1];\n    } else {\n        coordinates = coords;\n    }\n\n    // system type : Geographical or Metric\n\n    var type = this._currentProjectionSystems.type;\n\n    // checks for a formatting function in the wanted unit\n    var convert = null;\n    var units = this._projectionUnits[type];\n\n    for (var i = 0; i < units.length; i++) {\n        if (units[i].code === this._currentProjectionUnits) {\n            convert = units[i].convert;\n            break;\n        }\n    }\n    if (!convert || typeof convert !== \"function\") {\n        console.log(\"WARNING : coordinates format function not found\");\n        return;\n    } else {\n        coord = convert(coordinates);\n    }\n\n    if (!coord || Object.keys(coord).length === 0) {\n        return;\n    }\n\n    this.GPdisplayCoords(coord);\n};\n\n/**\n * this sends the coordinates to the panel.\n * (cf. this.GPdisplayElevation() into the DOM functions)\n *\n * @method _setElevation\n * @param {Object} coords - Coordinate position object {lon, lat}\n * @private\n */\nMousePosition.prototype._setElevation = function(coords) {\n    // management of the timer of the altitude service request\n    var delay = this.options.altitude.responseDelay;\n    this.GPdisplayElevation(coords, delay);\n};\n\n/**\n * this method is triggered when the mouse or the globe is stopped.\n * (cf. onMouseMove and onGlobeMove)\n *\n * @method onMoveStopped\n * @param {Object} coords - Coordinate position object {lon, lat}\n * @private\n */\nMousePosition.prototype.onMoveStopped = function(coords) {\n    this._setElevation(coords);\n};\n\n/**\n * this method is an handler event to control. The event is 'mousemove' on\n * the globe. The handler sends the coordinates to the panel.\n * (cf. this.GPdisplayCoords() into the DOM functions)\n *\n * @method onMouseMove\n * @param {Object} e - HTMLElement\n * @private\n */\nMousePosition.prototype.onMouseMove = function(e) {\n    var self = this;\n\n    var position = this.getGlobe().getCoordinateFromMouseEvent(e);\n    if (!position) {\n        this.GPdisplayCoords({\n            lon: \"---\",\n            lat: \"---\"\n        });\n        this.GPresetElevation();\n        return;\n    }\n\n    var coordinate = {\n        lon: position.longitude(),\n        lat: position.latitude()\n    };\n\n    this._setCoordinate(coordinate);\n\n    // calculation of the altitude after a time limit from the moment where the mouse movement is stopped\n    if (this.options.displayAltitude) {\n        clearTimeout(this._timer);\n        this._timer = setTimeout(function() {\n            self.onMoveStopped(coordinate);\n        }, this.options.altitude.triggerDelay);\n    }\n};\n\n/**\n * this method is an handler event to control. The event is 'moveend' on\n * the globe. The handler sends the coordinates to the panel.\n * (cf. this.GPdisplayCoords() into the DOM functions)\n *\n * @method onGlobeMove\n * @private\n */\nMousePosition.prototype.onGlobeMove = function() {\n\n    // var self = this;\n\n    // info: coordinate = [x, y]\n    // var coordinate = e.coordinate;\n    // if ( !e.map || !e.map.getView() ) {\n    //     return;\n    // }\n    // var crs = e.map.getView().getProjection();\n    //\n    // this._setCoordinate(coordinate, crs);\n    //\n    // // calcul de l'altitude aprs un certain dlai aprs l'arrt du mouvement de la carte\n    // clearTimeout(this._timer);\n    // this._timer = setTimeout( function () {\n    //     self.onMoveStopped(coordinate, crs);\n    // }, this.options.altitude.triggerDelay);\n};\n\n// ################################################################### //\n// ####################### handlers events to dom #################### //\n// ################################################################### //\n\n/**\n * this method is called by this.GPdisplayElevation() in the dom, and\n * it executes a request to the elevation service.\n *\n * @method onRequestAltitude\n * @param {Object} coordinate - {lat:..., lng:...}\n * @private\n */\nMousePosition.prototype.onRequestAltitude = function(coordinate, callback) {\n    // INFORMATION\n    // we launch the request to the altitude services\n    // we implement callbacks in order to retrieve results or errors\n    // from the service.\n    // The result is displayed in a DOM element.\n    // The error messages are display in the dev console (?)\n\n    if (!coordinate || Object.keys(coordinate).length === 0) {\n        return;\n    }\n\n    // if we do not want any altitude calculation, we just stop !\n    if (!this.options.displayAltitude) {\n        return;\n    }\n\n    // if we don not have the rights on the requested resource, we just stop !\n    if (this._noRightManagement) {\n        console.log(\"[WARNING] contract key configuration has no rights to load geoportal elevation \");\n        document.getElementById(this._addUID(\"GPmousePositionAlt\")).innerHTML = \"No rights!\";\n        return;\n    }\n\n    // we retrieve the service options...\n    var options = this.options.altitude.serviceOptions || {};\n\n    // ... and the coordinates...\n    options.zonly = true;\n    options.positions = [{\n        lon: coordinate.lon,\n        lat: coordinate.lat\n    }];\n\n    // ... and the callbacks\n    options.scope = this;\n\n    if (!options.rawResponse) {\n        // in the general case\n        /** callback onSuccess */\n        options.onSuccess = function(results) {\n            if (results && Object.keys(results)) {\n                callback.call(this, results.elevations[0].z);\n            }\n        };\n    } else {\n        /** callback onSuccess */\n        options.onSuccess = function(results) {\n            console.log(\"alti service raw response : \", results);\n        };\n    }\n\n    /** callback onFailure */\n    options.onFailure = function(error) {\n        console.log(\"[getAltitude] ERROR : \" + error.message);\n    };\n    // in the case of the API key is not given as option of the service,\n    // we use the key of the autoconf, or the key given in the control options\n    options.apiKey = options.apiKey || this.options.apiKey;\n\n    Gp.Services.getAltitude(options);\n};\n\n/**\n * this method is called by event 'click' on 'GPshowMousePositionPicto' tag label\n * (cf. this._createShowMousePositionPictoElement),\n * and toggles event 'mousemove' on globe.\n *\n * @method onShowMousePositionClick\n * @private\n */\nMousePosition.prototype.onShowMousePositionClick = function() {\n    // checked : true - panel close\n    // checked : false - panel open\n    var globe = this.getGlobe();\n\n    this.collapsed = this._showMousePositionContainer.checked;\n\n    // event triggered when opening/closing the panel\n    // and depending on the mode : desktop or tactile!\n    if (this._showMousePositionContainer.checked) {\n        // FIXME handle or not mobile case\n        if (this._isDesktop) {\n            globe.forget(GlobeViewExtended.EVENTS.MOUSE_MOVE, this._callbacks.mouseMove);\n        } else {\n            globe.forget(GlobeViewExtended.EVENTS.CENTER_CHANGED, this.onGlobeMove);\n        }\n\n    } else {\n        // FIXME handle or not mobile case\n        if (this._isDesktop) {\n            globe.listen(GlobeViewExtended.EVENTS.MOUSE_MOVE, this._callbacks.mouseMove);\n        } else {\n            globe.listen(GlobeViewExtended.EVENTS.CENTER_CHANGED, this.onGlobeMove);\n        }\n    }\n\n    // FIXME\n    // we handle here the panel display..., but this is not really the good\n    // place to do it...\n    this._setElevationPanel(this.options.displayAltitude);\n    this._setCoordinatesPanel(this.options.displayCoordinates);\n    if (!this.options.displayCoordinates) {\n        this._setSettingsPanel(false);\n    }\n};\n\n/**\n * this method is called by event 'change' on 'GPmousePositionProjectionSystem'\n * tag select (cf. this._createMousePositionSettingsElement),\n * and selects the system projection.\n *\n * @method onMousePositionProjectionSystemChange\n * @param {Object} e - HTMLElement\n * @private\n */\nMousePosition.prototype.onMousePositionProjectionSystemChange = function(e) {\n\n    var idx = e.target.selectedIndex; // index\n    var value = e.target.options[idx].value; // crs\n\n    this._setCurrentSystem(value);\n};\n\n/**\n * this method selects the current system projection.\n *\n * @method _setCurrentSystem\n * @param {Object} systemCode - inner code (rank in array _projectionSystems)\n * @private\n */\nMousePosition.prototype._setCurrentSystem = function(systemCode) {\n    // if we change of system type, we must change the unit type too !\n    var type = null;\n    for (var i = 0; i < this._projectionSystems.length; ++i) {\n        if (this._projectionSystems[i].code == systemCode) {\n            type = this._projectionSystems[i].type;\n            break;\n        }\n    }\n\n    if (!type) {\n        logger.log(\"system not found in projection systems container\");\n        return;\n    }\n\n    if (type !== this._currentProjectionType) {\n        this._setTypeUnitsPanel(type);\n    }\n\n    // registers the current system\n    this._currentProjectionSystems = this._projectionSystems[Number(systemCode)];\n\n    // simulates a movement in tactile mode to update the results\n    if (!this._isDesktop) {\n        this.onGlobeMove();\n    }\n};\n\n/**\n * this method is called by event 'mouseover' on 'GPmousePositionProjectionSystem'\n * tag select (cf. this._createMousePositionSettingsElement),\n * and selects the system projection whose geoBBox interstects the current view extent.\n *\n * @method onMousePositionProjectionSystemMouseOver\n * @private\n */\nMousePosition.prototype.onMousePositionProjectionSystemMouseOver = function() {\n\n    // globe infos\n    var globe = this.getGlobe();\n    if (!globe) {\n        return;\n    }\n\n    var globeExtent = globe.getExtent();\n\n    // clear select\n    var systemList = document.getElementById(this._addUID(\"GPmousePositionProjectionSystem\"));\n    systemList.innerHTML = \"\";\n\n    var option;\n\n    // add systems whose extent intersects the globe extent\n    for (var j = 0; j < this._projectionSystems.length; j++) {\n        var proj = this._projectionSystems[j];\n        if (proj.geoBBox) {\n            // bboxes intersection test\n            if (globeExtent.west() > proj.geoBBox.right ||\n                globeExtent.south() > proj.geoBBox.top ||\n                globeExtent.east() < proj.geoBBox.left ||\n                globeExtent.north() < proj.geoBBox.bottom\n            ) {\n                if (proj === this._currentProjectionSystems) {\n                    option = document.createElement(\"option\");\n                    option.value = proj.code;\n                    option.text = proj.label || j;\n                    option.setAttribute(\"selected\", \"selected\");\n                    option.setAttribute(\"disabled\", \"disabled\");\n\n                    systemList.appendChild(option);\n                }\n                continue; // do not intersect\n            }\n        }\n        option = document.createElement(\"option\");\n        option.value = proj.code;\n        option.text = proj.label || j;\n        if (proj === this._currentProjectionSystems) {\n            option.setAttribute(\"selected\", \"selected\");\n        }\n\n        systemList.appendChild(option);\n    }\n};\n\n/**\n * this method is called by event 'change' on 'GPmousePositionProjectionUnits'\n * tag select (cf. this._createMousePositionSettingsElement),\n * and selects the units projection.\n *\n * @method onMousePositionProjectionUnitsChange\n * @param {Object} e - HTMLElement\n * @private\n */\nMousePosition.prototype.onMousePositionProjectionUnitsChange = function(e) {\n\n    var idx = e.target.selectedIndex;\n    var value = e.target.options[idx].value;\n\n    this._currentProjectionUnits = value;\n\n    // simulates a movement in tactile mode to update the results\n    if (!this._isDesktop) {\n        this.onGlobeMove();\n    }\n};\n\nexport default MousePosition;\n\n\n\n// WEBPACK FOOTER //\n// ./src/Itowns/Controls/MousePosition.js","/*\n* loglevel - https://github.com/pimterry/loglevel\n*\n* Copyright (c) 2013 Tim Perry\n* Licensed under the MIT license.\n*/\n(function (root, definition) {\n    \"use strict\";\n    if (typeof define === 'function' && define.amd) {\n        define(definition);\n    } else if (typeof module === 'object' && module.exports) {\n        module.exports = definition();\n    } else {\n        root.log = definition();\n    }\n}(this, function () {\n    \"use strict\";\n\n    // Slightly dubious tricks to cut down minimized file size\n    var noop = function() {};\n    var undefinedType = \"undefined\";\n\n    var logMethods = [\n        \"trace\",\n        \"debug\",\n        \"info\",\n        \"warn\",\n        \"error\"\n    ];\n\n    // Cross-browser bind equivalent that works at least back to IE6\n    function bindMethod(obj, methodName) {\n        var method = obj[methodName];\n        if (typeof method.bind === 'function') {\n            return method.bind(obj);\n        } else {\n            try {\n                return Function.prototype.bind.call(method, obj);\n            } catch (e) {\n                // Missing bind shim or IE8 + Modernizr, fallback to wrapping\n                return function() {\n                    return Function.prototype.apply.apply(method, [obj, arguments]);\n                };\n            }\n        }\n    }\n\n    // Build the best logging method possible for this env\n    // Wherever possible we want to bind, not wrap, to preserve stack traces\n    function realMethod(methodName) {\n        if (methodName === 'debug') {\n            methodName = 'log';\n        }\n\n        if (typeof console === undefinedType) {\n            return false; // No method possible, for now - fixed later by enableLoggingWhenConsoleArrives\n        } else if (console[methodName] !== undefined) {\n            return bindMethod(console, methodName);\n        } else if (console.log !== undefined) {\n            return bindMethod(console, 'log');\n        } else {\n            return noop;\n        }\n    }\n\n    // These private functions always need `this` to be set properly\n\n    function replaceLoggingMethods(level, loggerName) {\n        /*jshint validthis:true */\n        for (var i = 0; i < logMethods.length; i++) {\n            var methodName = logMethods[i];\n            this[methodName] = (i < level) ?\n                noop :\n                this.methodFactory(methodName, level, loggerName);\n        }\n\n        // Define log.log as an alias for log.debug\n        this.log = this.debug;\n    }\n\n    // In old IE versions, the console isn't present until you first open it.\n    // We build realMethod() replacements here that regenerate logging methods\n    function enableLoggingWhenConsoleArrives(methodName, level, loggerName) {\n        return function () {\n            if (typeof console !== undefinedType) {\n                replaceLoggingMethods.call(this, level, loggerName);\n                this[methodName].apply(this, arguments);\n            }\n        };\n    }\n\n    // By default, we use closely bound real methods wherever possible, and\n    // otherwise we wait for a console to appear, and then try again.\n    function defaultMethodFactory(methodName, level, loggerName) {\n        /*jshint validthis:true */\n        return realMethod(methodName) ||\n               enableLoggingWhenConsoleArrives.apply(this, arguments);\n    }\n\n    function Logger(name, defaultLevel, factory) {\n      var self = this;\n      var currentLevel;\n      var storageKey = \"loglevel\";\n      if (name) {\n        storageKey += \":\" + name;\n      }\n\n      function persistLevelIfPossible(levelNum) {\n          var levelName = (logMethods[levelNum] || 'silent').toUpperCase();\n\n          if (typeof window === undefinedType) return;\n\n          // Use localStorage if available\n          try {\n              window.localStorage[storageKey] = levelName;\n              return;\n          } catch (ignore) {}\n\n          // Use session cookie as fallback\n          try {\n              window.document.cookie =\n                encodeURIComponent(storageKey) + \"=\" + levelName + \";\";\n          } catch (ignore) {}\n      }\n\n      function getPersistedLevel() {\n          var storedLevel;\n\n          if (typeof window === undefinedType) return;\n\n          try {\n              storedLevel = window.localStorage[storageKey];\n          } catch (ignore) {}\n\n          // Fallback to cookies if local storage gives us nothing\n          if (typeof storedLevel === undefinedType) {\n              try {\n                  var cookie = window.document.cookie;\n                  var location = cookie.indexOf(\n                      encodeURIComponent(storageKey) + \"=\");\n                  if (location !== -1) {\n                      storedLevel = /^([^;]+)/.exec(cookie.slice(location))[1];\n                  }\n              } catch (ignore) {}\n          }\n\n          // If the stored level is not valid, treat it as if nothing was stored.\n          if (self.levels[storedLevel] === undefined) {\n              storedLevel = undefined;\n          }\n\n          return storedLevel;\n      }\n\n      /*\n       *\n       * Public logger API - see https://github.com/pimterry/loglevel for details\n       *\n       */\n\n      self.name = name;\n\n      self.levels = { \"TRACE\": 0, \"DEBUG\": 1, \"INFO\": 2, \"WARN\": 3,\n          \"ERROR\": 4, \"SILENT\": 5};\n\n      self.methodFactory = factory || defaultMethodFactory;\n\n      self.getLevel = function () {\n          return currentLevel;\n      };\n\n      self.setLevel = function (level, persist) {\n          if (typeof level === \"string\" && self.levels[level.toUpperCase()] !== undefined) {\n              level = self.levels[level.toUpperCase()];\n          }\n          if (typeof level === \"number\" && level >= 0 && level <= self.levels.SILENT) {\n              currentLevel = level;\n              if (persist !== false) {  // defaults to true\n                  persistLevelIfPossible(level);\n              }\n              replaceLoggingMethods.call(self, level, name);\n              if (typeof console === undefinedType && level < self.levels.SILENT) {\n                  return \"No console available for logging\";\n              }\n          } else {\n              throw \"log.setLevel() called with invalid level: \" + level;\n          }\n      };\n\n      self.setDefaultLevel = function (level) {\n          if (!getPersistedLevel()) {\n              self.setLevel(level, false);\n          }\n      };\n\n      self.enableAll = function(persist) {\n          self.setLevel(self.levels.TRACE, persist);\n      };\n\n      self.disableAll = function(persist) {\n          self.setLevel(self.levels.SILENT, persist);\n      };\n\n      // Initialize with the right level\n      var initialLevel = getPersistedLevel();\n      if (initialLevel == null) {\n          initialLevel = defaultLevel == null ? \"WARN\" : defaultLevel;\n      }\n      self.setLevel(initialLevel, false);\n    }\n\n    /*\n     *\n     * Top-level API\n     *\n     */\n\n    var defaultLogger = new Logger();\n\n    var _loggersByName = {};\n    defaultLogger.getLogger = function getLogger(name) {\n        if (typeof name !== \"string\" || name === \"\") {\n          throw new TypeError(\"You must supply a name when creating a logger.\");\n        }\n\n        var logger = _loggersByName[name];\n        if (!logger) {\n          logger = _loggersByName[name] = new Logger(\n            name, defaultLogger.getLevel(), defaultLogger.methodFactory);\n        }\n        return logger;\n    };\n\n    // Grab the current global log variable in case of overwrite\n    var _log = (typeof window !== undefinedType) ? window.log : undefined;\n    defaultLogger.noConflict = function() {\n        if (typeof window !== undefinedType &&\n               window.log === defaultLogger) {\n            window.log = _log;\n        }\n\n        return defaultLogger;\n    };\n\n    defaultLogger.getLoggers = function getLoggers() {\n        return _loggersByName;\n    };\n\n    return defaultLogger;\n}));\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/loglevel/lib/loglevel.js\n// module id = 75\n// module chunks = 0","/**\n* implementation :\n* cf. http://uihacker.blogspot.fr/2011/07/javascript-formatting-latitudelongitude.html?m=1\n* cf. http://andrew.hedges.name/experiments/convert_lat_long/\n* FIXME formater la sortie\n* cf. http://mottie.github.io/javascript-number-formatter/\n* cf. https://github.com/j-/number-formatter\n*\n*/\n/** ... */\nvar PositionFormater = {\n\n    /** ... */\n    NORTH: \"N\",\n\n    /** ... */\n    SOUTH: \"S\",\n\n    /** ... */\n    EAST: \"E\",\n\n    /** ... */\n    WEST: \"W\",\n\n    /** ... */\n    digitSecond: 2,\n\n    /** ... */\n    digitDecimal: 5,\n\n    /** ... */\n    digitRadian: 8,\n\n    /** ... */\n    roundToDecimal: function(inputNum, numPoints) {\n        var multiplier = Math.pow(10, numPoints);\n        return Math.round(inputNum * multiplier) / multiplier;\n    },\n\n    /** ... */\n    decimalToRadian: function(location) {\n        var d = 0.01745329251994329577;\n        return this.roundToDecimal(location * d, this.digitRadian);\n    },\n\n    /** ... */\n    decimalToGrade: function(location) {\n        var d = 1.11111111111111111111;\n        return this.roundToDecimal(location * d, this.digitRadian);\n    },\n\n    /** ... */\n    decimalToDMS: function(location, hemisphere) {\n        if (location < 0) {\n            location *= -1; // strip dash '-'\n        }\n\n        var degrees = Math.floor(location); // strip decimal remainer for degrees\n        var minutesFromRemainder = (location - degrees) * 60; // multiply the remainer by 60\n        var minutes = Math.floor(minutesFromRemainder); // get minutes from integer\n        var secondsFromRemainder = (minutesFromRemainder - minutes) * 60; // multiply the remainer by 60\n        var seconds = this.roundToDecimal(secondsFromRemainder, this.digitSecond); // get minutes by rounding to integer\n\n        var dms = degrees + \" \" + minutes + \"' \" + seconds + \"\\\" \";\n        if (hemisphere) {\n            dms += hemisphere;\n        }\n\n        return dms;\n    },\n\n    /** ... */\n    decimalLatToDMS: function(location) {\n        var hemisphere = (location < 0) ? this.SOUTH : this.NORTH; // south if negative\n        return this.decimalToDMS(location, hemisphere);\n    },\n\n    /** ... */\n    decimalLongToDMS: function(location) {\n        var hemisphere = (location < 0) ? this.WEST : this.EAST; // west if negative\n        return this.decimalToDMS(location, hemisphere);\n    },\n\n    /** ... */\n    DMSToDecimal: function(degrees, minutes, seconds, hemisphere) {\n        var ddVal = degrees + minutes / 60 + seconds / 3600;\n        ddVal = (hemisphere == this.SOUTH || hemisphere == this.WEST) ? ddVal * -1 : ddVal;\n\n        var decimal = this.roundToDecimal(ddVal, this.digitDecimal);\n        return decimal;\n    }\n\n};\n\nexport default PositionFormater;\n\n\n\n// WEBPACK FOOTER //\n// ./src/Itowns/Controls/Utils/PositionFormater.js","var CRS = {\n\n    /**\n     * CRS : WGS84\n     *\n     * @property EPSG:4326\n     * @private\n     */\n    \"EPSG:4326\": \"+title=WGS 84 (long/lat) +proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs +units=degrees\",\n\n    /**\n     * CRS : PseudoMercator\n     *\n     * @property EPSG:3857\n     * @private\n     */\n    \"EPSG:3857\": \"+proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +wktext  +no_defs\",\n\n    /**\n     * CRS : Lambert 93\n     *\n     * @property EPSG:2154\n     * @private\n     */\n    \"EPSG:2154\": \"+proj=lcc +lat_1=49 +lat_2=44 +lat_0=46.5 +lon_0=3 +x_0=700000 +y_0=6600000 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs\",\n\n    /**\n     * CRS : Lambert 2 extended\n     *\n     * @property EPSG:27572\n     * @private\n     */\n    \"EPSG:27572\": \"+proj=lcc +lat_1=46.8 +lat_0=46.8 +lon_0=0 +k_0=0.99987742 +x_0=600000 +y_0=2200000 +a=6378249.2 +b=6356515 +towgs84=-168,-60,320,0,0,0,0 +pm=paris +units=m +no_defs\",\n\n    /**\n     * CRS : UTM 20N (Guadeloupe, Martinique)\n     *\n     * @property EPSG:32620\n     * @private\n     */\n    \"EPSG:32620\": \"+proj=utm +zone=20 +ellps=WGS84 +datum=WGS84 +units=m +no_defs\",\n\n    /**\n     * CRS : UTM 21N (Saint-Pierre-et-Miquelon)\n     *\n     * @property EPSG:4467\n     * @private\n     */\n    \"EPSG:4467\": \"+proj=utm +zone=21 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs\",\n\n    /**\n     * CRS : UTM 22N (Guyane)\n     *\n     * @property EPSG:2972\n     * @private\n     */\n    \"EPSG:2972\": \"+proj=utm +zone=22 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs\",\n\n    /**\n     * CRS : UTM 30N (France mtropolitaine)\n     *\n     * @property EPSG:32630\n     * @private\n     */\n    \"EPSG:32630\": \"+proj=utm +zone=30 +datum=WGS84 +units=m +no_defs\",\n\n    /**\n     * CRS : UTM 31N (France mtropolitaine)\n     *\n     * @property EPSG:32631\n     * @private\n     */\n    \"EPSG:32631\": \"+proj=utm +zone=31 +datum=WGS84 +units=m +no_defs\",\n\n    /**\n     * CRS : UTM 32N (France mtropolitaine)\n     *\n     * @property EPSG:32632\n     * @private\n     */\n    \"EPSG:32632\": \"+proj=utm +zone=32 +datum=WGS84 +units=m +no_defs\",\n\n    /**\n     * CRS : UTM 38S (Mayotte)\n     *\n     * @property EPSG:4471\n     * @private\n     */\n    \"EPSG:4471\": \"+proj=utm +zone=38 +south +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs\",\n\n    /**\n     * CRS : UTM 40S (Runion)\n     *\n     * @property EPSG:2975\n     * @private\n     */\n    \"EPSG:2975\": \"+proj=utm +zone=40 +south +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs\",\n\n    /**\n     * CRS : UTM 5S (Polynsie)\n     *\n     * @property EPSG:3296\n     * @private\n     */\n    \"EPSG:3296\": \"+proj=utm +zone=5 +south +ellps=GRS80 +towgs84=0.072,-0.507,-0.245,-0.0183,0.0003,-0.007,-0.0093 +units=m +no_defs\",\n\n    /**\n     * CRS : UTM 6S (Polynsie)\n     *\n     * @property EPSG:3297\n     * @private\n     */\n    \"EPSG:3297\": \"+proj=utm +zone=6 +south +ellps=GRS80 +towgs84=0.072,-0.507,-0.245,-0.0183,0.0003,-0.007,-0.0093 +units=m +no_defs\",\n\n    /**\n     * CRS : UTM 7S (Polynsie)\n     *\n     * @property EPSG:32707\n     * @private\n     */\n    \"EPSG:32707\": \"+proj=utm +zone=7 +south +datum=WGS84 +units=m +no_defs\",\n\n    /**\n     * CRS : UTM 8S (Polynsie)\n     *\n     * @property EPSG:32708\n     * @private\n     */\n    \"EPSG:32708\": \"+proj=utm +zone=8 +south +datum=WGS84 +units=m +no_defs\",\n\n    /**\n     * CRS : UTM 12N (Ile de Clipperton)\n     *\n     * @property EPSG:26912\n     * @private\n     */\n    \"EPSG:26912\": \"+proj=utm +zone=12 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs\",\n\n    /**\n     * CRS : UTM 42S (Iles Kerguelen)\n     *\n     * @property EPSG:32742\n     * @private\n     */\n    \"EPSG:32742\": \"+proj=utm +zone=42 +south +datum=WGS84 +units=m +no_defs\",\n\n    /**\n     * CRS : UTM 39S (Iles Crozet)\n     *\n     * @property EPSG:32739\n     * @private\n     */\n    \"EPSG:32739\": \"+proj=utm +zone=39 +south +datum=WGS84 +units=m +no_defs\",\n\n    /**\n     * CRS : UTM 43S (Iles St-Paul et Amsterdam)\n     *\n     * @property EPSG:32743\n     * @private\n     */\n    \"EPSG:32743\": \"+proj=utm +zone=43 +south +datum=WGS84 +units=m +no_defs\",\n\n    /**\n     * CRS : Strographique polaire (Terre Adelie)\n     *\n     * @property EPSG:2986\n     * @private\n     */\n    \"EPSG:2986\": \"\",\n\n    /**\n     * CRS : UTM 37S (Iles du canal de Mozambique)\n     *\n     * @property EPSG:32737\n     * @private\n     */\n    \"EPSG:32737\": \"+proj=utm +zone=37 +south +datum=WGS84 +units=m +no_defs\",\n\n    /**\n     * CRS : UTM 38S (Iles du canal de Mozambique)\n     *\n     * @property EPSG:32738\n     * @private\n     */\n    \"EPSG:32738\": \"+proj=utm +zone=38 +south +datum=WGS84 +units=m +no_defs\",\n\n    /**\n     * CRS : UTM 1S (Wallis-et-Futuna)\n     *\n     * @property EPSG:2988\n     * @private\n     */\n    \"EPSG:2988\": \"+proj=utm +zone=1 +south +ellps=intl +towgs84=253,-132,-127,0,0,0,0 +units=m +no_defs\",\n\n    /**\n     * CRS : RGNC91-93 (Nouvelle-Caldonie)\n     *\n     * @property EPSG:3163\n     * @private\n     */\n    \"EPSG:3163\": \"+proj=lcc +lat_1=-20.66666666666667 +lat_2=-22.33333333333333 +lat_0=-21.5 +lon_0=166 +x_0=400000 +y_0=300000 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs\"\n};\n\nexport default CRS;\n\n\n\n// WEBPACK FOOTER //\n// ./src/Itowns/CRS/CRS.js","import GlobeViewExtended from \"../GlobeViewExtended\";\nimport Utils from \"../../Common/Utils\";\nimport LayerUtils from \"../../Common/Utils/LayerUtils\";\nimport SelectorID from \"../../Common/Utils/SelectorID\";\nimport LayerSwitcherDOM from \"../../Common/Controls/LayerSwitcherDOM\";\nimport Widget from \"./Widget\";\n\n\n/**\n * @classdesc\n * Control to manage globe layers : their order, visibility and opacity, and display their informations (title, description, legends, metadata...)\n *\n * @constructor\n * @extends {itowns.control.Widget}\n * @alias itowns.control.LayerSwitcher\n * @param {Object} lsOptions - control options\n * @param {Array} [lsOptions.layers] - list of layers to be configured. Each array element is an object, with following properties :\n * @param {String} [lsOptions.layers.id] - ol.layer.Layer layer to be configured (that has been added to globe)\n * @param {Object} [lsOptions.layers.config] - custom configuration object for layer information (title, description, legends, metadata, quicklook url), with following properties :\n * @param {String} [lsOptions.layers.config.title] - layer alias, to be displayed in widget layer list. E.g. : \"Cartes IGN\"\n * @param {String} [lsOptions.layers.config.description] - layer description, to be displayed on title hover, or in layer information panel.\n * @param {String} [lsOptions.layers.config.quicklookUrl] - link to a quick look image for this layer.\n * @param {Array} [lsOptions.layers.config.legends] - array of layer legends. Each array element is an object, with following properties :\n *      - url (String, mandatory) : link to a legend\n *      - minScaleDenominator (Number, optional) : min scale denominator for legend validity.\n * @param {Array} [lsOptions.layers.config.metadata] - array of layer metadata. Each array element is an object, with property url (String, mandatory) : link to a metadata\n * @param {Object} [lsOptions.options] - Itowns.control.Control options\n * @param {Boolean} [lsOptions.options.collapsed = true] - Specify if widget has to be collapsed (true) or not (false) on globe loading.\n * @example\n * var layerSwitcher = new itowns.control.LayerSwitcher({\n *  layers : [\n *      {\n *          id : \"myLayer\",\n *          config : {\n *              title : \"test layer name 1\",\n *              description : \"test layer desc 1\",\n *          }\n *      }\n *  ],\n *  options : {\n *      collapsed : false\n *  }\n * ));\n */\nfunction LayerSwitcher(lsOptions) {\n\n    lsOptions = lsOptions || {};\n    var options = lsOptions.options || {};\n    var layers = lsOptions.layers || [];\n\n    if (!(this instanceof LayerSwitcher)) {\n        throw new TypeError(\"ERROR CLASS_CONSTRUCTOR\");\n    }\n\n    if (layers && !Array.isArray(layers)) {\n        throw new Error(\"ERROR WRONG_TYPE : layers should be an array\");\n    }\n\n    if (options && typeof options !== \"object\") {\n        throw new Error(\"ERROR WRONG_TYPE : options should be an object\");\n    }\n\n    this._initialize(options, layers);\n\n    var container = this._initContainer(options);\n    // property to save layers conf added after the LS is initialized\n    this._addedLayerConf = {};\n    var targetDiv = document.getElementById(options.target) || null;\n\n    Widget.call(\n        this, {\n            name: \"LayerSwitcher\",\n            element: container,\n            target: targetDiv\n        }\n    );\n}\n\n/*\n * @lends module:LayerSwitcher\n */\nLayerSwitcher.prototype = Object.create(Widget.prototype, {});\n\n// retrieves methods of the common class LayerSwitcherDOM\nUtils.assign(LayerSwitcher.prototype, LayerSwitcherDOM);\n\n/**\n * Constructor (alias)\n *\n * @private\n */\nLayerSwitcher.prototype.constructor = LayerSwitcher;\n\n// ################################################################### //\n// ############## public methods (getters, setters) ################## //\n// ################################################################### //\n\n/**\n * Binds globe to control\n */\nLayerSwitcher.prototype.setGlobe = function(globe) {\n    var layers;\n    if (globe) { // in the case the control is added to the globe\n        var self = this;\n\n        // add options layers to layerlist.\n        // (only the layers configurated by the user in the options of the layerSwitcher )\n        // the other layers of the map will be added in the setGlobe method\n        for (var i = 0; i < this._initLayers.length; i++) {\n            // retrieves the layer...\n            var layer = null;\n\n            if (this._initLayers[i].id) {\n                layer = globe.getLayerById(this._initLayers[i].id);\n            }\n\n            if (layer && this._initLayers[i].displayed) {\n                // .. and the infos of the configuration if they exist (title, description, legends, quicklook, metadata)\n                var conf = this._initLayers[i].config || {};\n                var layerOptions = {\n                    title: conf.title || layer.title || this._initLayers[i].id,\n                    description: conf.description || null,\n                    legends: conf.legends || [],\n                    metadata: conf.metadata || [],\n                    quicklookUrl: conf.quicklookUrl || null\n                };\n                if (typeof conf.ipr !== \"undefined\") {\n                    layerOptions.ipr = conf.ipr;\n                }\n                if (typeof conf.opacity !== \"undefined\") {\n                    layerOptions.opacity = conf.opacity;\n                }\n                if (typeof conf.visibility !== \"undefined\") {\n                    layerOptions.visibility = conf.visibility;\n                }\n                this._layers[layer.id] = layerOptions;\n            }\n        }\n\n        // adds the layers\n        this._addGlobeLayers(globe);\n\n        // adding of listeners\n\n        /**\n         * adds the onlayerchanged:opacity callback\n         */\n        this._callbacks.onOpacityLayerCallBack = function(e) {\n            self._updateLayerOpacity(e.target.id, e.new.opacity);\n        };\n\n        /**\n         * adds the onlayerchanged:visible callback\n         */\n        this._callbacks.onVisibilityLayerCallBack = function(e) {\n            self._updateLayerVisibility(e.target.id, e.new.visible);\n        };\n\n        // At every globe movement, layer switcher may be updated,\n        // according to layers on globe, and their range.\n        /**\n         * adds the onChangedViewCallBack callback\n         */\n        this._callbacks.onChangedViewCallBack = function(e) {\n            self._inRangeUpdate(e.colorLayersId);\n        };\n        globe.listen(GlobeViewExtended.EVENTS.PRE_RENDER, this._callbacks.onChangedViewCallBack);\n        // prerender events returns visible layers\n        globe.preRenderEventFetchColorLayersDisplayed();\n\n        /**\n         * adds the onlayeradded\n         */\n        this._callbacks.onAddedLayerCallBack = function(e) {\n            var id = e.layerId;\n            if (self) {\n                if (!self._layerDisplayedInLayerSwitcher(id)) {\n                    return;\n                }\n                var layer = self.getGlobe().getLayerById(id);\n                if (layer.type === \"elevation\") {\n                    return;\n                }\n                var layerConf = self._getLayerConf(id) || self._addedLayerConf[id];\n                if (layerConf) {\n                    self.addLayer(layer, layerConf);\n                } else {\n                    self.addLayer(layer);\n                }\n            }\n        };\n        globe.listen(GlobeViewExtended.EVENTS.LAYER_ADDED, this._callbacks.onAddedLayerCallBack);\n\n        /**\n         * adds the onlayerremoved callback\n         */\n        this._callbacks.onRemovedLayerCallBack = function(e) {\n            var id = e.layerId;\n\n            // update the index max and delete the layer from the layerswitcher\n            if (self) {\n                self.removeLayer(id);\n            }\n\n        };\n        globe.listen(GlobeViewExtended.EVENTS.LAYER_REMOVED, this._callbacks.onRemovedLayerCallBack);\n\n        /**\n         * adds the onlayerchanged:index callback\n         */\n        this._callbacks.onIndexLayerCallBack = function(e) {\n\n            /** arraysEquals */\n            var arraysEquals = function(a1, a2) {\n                if (a1.length !== a2.length) {\n                    return false;\n                }\n                for (var i = 0; i < a1.length; ++i) {\n                    if (a1[i] !== a2[i]) {\n                        return false;\n                    }\n                }\n                return true;\n            };\n\n            if (!arraysEquals(e.new.sequence, e.previous.sequence)) {\n                self._updateLayerListContainer();\n            }\n        };\n        globe.listen(GlobeViewExtended.EVENTS.LAYERS_ORDER_CHANGED, this._callbacks.onIndexLayerCallBack);\n\n        layers = globe.getColorLayers();\n        for (var ii = 0; ii < layers.length; ++ii) {\n            globe.addLayerListener(layers[ii], GlobeViewExtended.EVENTS.OPACITY_PROPERTY_CHANGED, this._callbacks.onOpacityLayerCallBack);\n            globe.addLayerListener(layers[ii], GlobeViewExtended.EVENTS.VISIBLE_PROPERTY_CHANGED, this._callbacks.onVisibilityLayerCallBack);\n            self._updateLayerVisibility(layers[ii].id, layers[ii].visible);\n            self._updateLayerOpacity(layers[ii].id, layers[ii].opacity);\n        }\n    } else {\n        // removes the listeners associated to the deleted layerswitcher\n        this._globe.forget(GlobeViewExtended.EVENTS.PRE_RENDER, this._callbacks.onChangedViewCallBack);\n        this._globe.forget(GlobeViewExtended.EVENTS.LAYER_ADDED, this._callbacks.onAddedLayerCallBack);\n        this._globe.forget(GlobeViewExtended.EVENTS.LAYER_REMOVED, this._callbacks.onRemovedLayerCallBack);\n        this._globe.forget(GlobeViewExtended.EVENTS.LAYERS_ORDER_CHANGED, this._callbacks.onIndexLayerCallBack);\n        layers = this._globe.getColorLayers();\n        for (var j = 0; j < layers.length; ++j) {\n            this._globe.removeLayerListener(layers[j], GlobeViewExtended.EVENTS.OPACITY_PROPERTY_CHANGED, this._callbacks.onOpacityLayerCallBack);\n            this._globe.removeLayerListener(layers[j], GlobeViewExtended.EVENTS.VISIBLE_PROPERTY_CHANGED, this._callbacks.onVisibilityLayerCallBack);\n        }\n        // deletes the layerSwitcher DOM\n        while (this._element.hasChildNodes()) {\n            this._element.removeChild(this._element.lastChild);\n        }\n        this._element.parentNode.removeChild(this._element);\n    }\n\n    // calls original setGlobe method\n    Widget.prototype.setGlobe.call(this, globe);\n};\n\n/**\n * Adds a new layer to control (when added to globe) or add new layer configuration\n *\n * @param {Object} layer - layer to add to layer switcher\n * @param {Object} [config] - additional options for layer configuration\n * @param {Object} [config.title] - layer title (default is layer identifier)\n * @param {Object} [config.description] - layer description (default is null)\n * @param {Object} [config.legends] - layer legends (default is an empty array)\n * @param {Object} [config.metadata] - layer metadata (default is an empty array)\n * @param {Object} [config.quicklookUrl] - layer quicklookUrl (default is null)\n * @example\n *   layerSwitcher.addLayer({\n *       layer : gpParcels,\n *       config : {\n *           title : \"Parcelles cadastrales\",\n *           description : \"description de la couche\",\n *           quicklookUrl : \"http://quicklookUrl.fr\"\n *       }\n *   })\n */\nLayerSwitcher.prototype.addLayer = function(layer, config) {\n\n    config = config || {};\n    var globe = this.getGlobe();\n\n    if (!layer) {\n        console.log(\"[ERROR] LayerSwitcher:addLayer - missing layer parameter\");\n        return;\n    }\n\n    var id = layer.id;\n    if (id === \"undefined\") {\n        console.log(\"[ERROR] LayerSwitcher:addLayer - configuration cannot be set for \" + layer + \" layer (layer id not found)\");\n        return;\n    }\n\n    // subscription to the events\n    globe.addLayerListener(layer, GlobeViewExtended.EVENTS.OPACITY_PROPERTY_CHANGED, this._callbacks.onOpacityLayerCallBack);\n    globe.addLayerListener(layer, GlobeViewExtended.EVENTS.VISIBLE_PROPERTY_CHANGED, this._callbacks.onVisibilityLayerCallBack);\n\n    // make sure layer is in globe layers\n    var LayerInGlobe = globe.getLayerById(id);\n\n    if (!LayerInGlobe) {\n        console.log(\"[ERROR] LayerSwitcher:addLayer - configuration cannot be set for \", layer, \" layer (layer is not in globe layers )\");\n        return;\n    }\n\n    // if layer is not already in layers list, add it to control (layers list and container div)\n    if (!this._layers[id]) {\n\n        // 1. add layer to layers list\n        var layerInfos = this._getLayerInfo(layer) || {};\n        var layerOptions = {\n            title: config.title || layerInfos._title || id,\n            description: config.description || layerInfos._description || null,\n            legends: config.legends || layerInfos._legends || [],\n            metadata: config.metadata || layerInfos._metadata || [],\n            quicklookUrl: config.quicklookUrl || layerInfos._quicklookUrl || null\n        };\n        if (typeof config.ipr !== \"undefined\") {\n            layerOptions.ipr = config.ipr;\n            layer.attribution = layerOptions.ipr;\n        }\n        if (typeof config.opacity !== \"undefined\") {\n            layerOptions.opacity = config.opacity;\n            layer.opacity = layerOptions.opacity;\n        }\n        if (typeof config.visibility !== \"undefined\") {\n            layerOptions.visibility = config.visibility;\n            layer.visible = layerOptions.visibility;\n        }\n        this._layers[id] = layerOptions;\n\n        // creation of the div of the layer which will be added to the layerSwitcher\n        this._layers[id].div = this._createLayerDiv(id);\n\n        this._updateLayerListContainer();\n\n        // user may also add a new configuration for an already added layer\n    } else if (this._layers[id] && config) {\n\n        // add new configuration parameters to layer informations\n        for (var prop in config) {\n            if (config.hasOwnProperty(prop)) {\n                this._layers[id][prop] = config[prop];\n            }\n        }\n        if (typeof config.ipr !== \"undefined\") {\n            layer.attribution = config.ipr;\n        }\n        if (typeof config.opacity !== \"undefined\") {\n            layer.opacity = config.opacity;\n        }\n        if (typeof config.visibility !== \"undefined\") {\n            layer.visible = config.visibility;\n        }\n        // set new title in layer div\n        if (config.title) {\n            var nameDiv = document.getElementById(this._addUID(\"GPname_ID_\" + id));\n            if (nameDiv) {\n                nameDiv.innerHTML = config.title;\n                // FIXME a ajouter?\n                // nameDiv.title = config.description || config.title;\n            }\n        }\n        // add layer info picto if necessary\n        var infodiv = document.getElementById(this._addUID(\"GPinfo_ID_\" + id));\n        if (!document.getElementById(this._addUID(\"GPinfo_ID_\" + id)) && config.description && (config.legends || config.metadata || config.quicklookUrl)) {\n            var advancedTools = document.getElementById(this._addUID(\"GPadvancedTools_ID_\" + id));\n            if (advancedTools) {\n                advancedTools.appendChild(\n                    this._createAdvancedToolInformationElement({\n                        id: id\n                    })\n                );\n            }\n        }\n        // close layer info element if open, to update information.\n        if (infodiv && infodiv.className === \"GPlayerInfoOpened\") {\n            document.getElementById(this._addUID(\"GPlayerInfoPanel\")).className = \"GPlayerInfoPanelClosed\";\n            infodiv.className === \"GPlayerInfo\";\n        }\n\n    }\n};\n\n/**\n * Removes a layer from control\n *\n * @param {Object} layerId - layer to remove to layer switcher\n */\nLayerSwitcher.prototype.removeLayer = function(layerId) {\n    var layerList = document.getElementById(this._addUID(\"GPlayersList\"));\n    // close layer info element if open.\n    var infodiv = document.getElementById(this._addUID(\"GPinfo_ID_\" + layerId));\n    if (infodiv && infodiv.className === \"GPlayerInfoOpened\") {\n        document.getElementById(this._addUID(\"GPlayerInfoPanel\")).className = \"GPlayerInfoPanelClosed\";\n        infodiv.className === \"GPlayerInfo\";\n    }\n    // remove layer div\n    var layerDiv = document.getElementById(this._addUID(\"GPlayerSwitcher_ID_\" + layerId));\n    layerList.removeChild(layerDiv);\n\n    // removes layer of the layer list\n    delete this._layers[layerId];\n};\n\n/**\n * Collapse or display control main container\n *\n * @param {Boolean} collapsed - True to collapse control, False to display it\n */\nLayerSwitcher.prototype.setCollapsed = function(collapsed) {\n    if (collapsed === undefined) {\n        console.log(\"[ERROR] LayerSwitcher:setCollapsed - missing collapsed parameter\");\n        return;\n    }\n    var isCollapsed = this.getCollapsed();\n    if ((collapsed && isCollapsed) || (!collapsed && !isCollapsed)) {\n        return;\n    }\n    // simulates the panel opening after a click\n    if (!isCollapsed) {\n        var layers = document.getElementsByClassName(\"GPlayerInfoOpened\");\n        for (var i = 0; i < layers.length; i++) {\n            layers[i].className = \"GPlayerInfo\";\n        }\n        document.getElementById(this._addUID(\"GPlayerInfoPanel\")).className = \"GPlayerInfoPanelClosed\";\n    }\n    document.getElementById(this._addUID(\"GPshowLayersList\")).checked = !collapsed;\n};\n\n/**\n * Returns true if widget is collapsed (minimize), false otherwise\n */\nLayerSwitcher.prototype.getCollapsed = function() {\n    return !document.getElementById(this._addUID(\"GPshowLayersList\")).checked;\n};\n\n// ################################################################### //\n// ##################### init component ############################## //\n// ################################################################### //\n\n/**\n * Initialize LayerSwitcher control (called by constructor)\n *\n * @param {Object} options - Itowns.control.Control options\n * @param {Array} layers - list of layers to be configured. Each array element is an object, with following properties :\n * @private\n */\nLayerSwitcher.prototype._initialize = function(options, layers) {\n    // id of the control ; used to suffix the CSS id (handles cases with severel controls on the same page)\n    this._uid = SelectorID.generate();\n\n    // {Object} control layers list. Each key is a layer id, and its value is an object of layers options (layer, id, opacity, visibility, title, description...)\n    this._layers = {};\n\n    // div which will contain the divs of the lists\n    this._layerListContainer = null;\n\n    // callbacks\n    this._callbacks = {};\n\n    // options\n    this._options = options;\n    this._initLayers = layers;\n};\n\n/**\n * Returns the layer configuration defined at widget initialization\n *\n * @method _getLayerConf\n * @param {String} layerId - layer id\n * @return {Object} layerConfig - layer configuration\n * @private\n */\nLayerSwitcher.prototype._getLayerConf = function(layerId) {\n    for (var i = 0; i < this._initLayers.length; ++i) {\n        if (this._initLayers[i].id === layerId) {\n            return this._initLayers[i].config;\n        }\n    }\n    return null;\n};\n\n/**\n * Indicates if the layer must be displayed in the layerSwitcher\n *\n * @method _layerDisplayedInLayerSwitcher\n * @param {String} layerId - layer id\n * @return {Boolean} displayed\n * @private\n */\nLayerSwitcher.prototype._layerDisplayedInLayerSwitcher = function(layerId) {\n    for (var i = 0; i < this._initLayers.length; ++i) {\n        if (this._initLayers[i].id === layerId) {\n            return (typeof this._initLayers[i].displayed === \"undefined\" || this._initLayers[i].displayed);\n        }\n    }\n    return true;\n};\n\n/**\n * Creates control main container\n *\n * @method _initContainer\n * @param {Object} options - control options\n * @private\n */\nLayerSwitcher.prototype._initContainer = function(options) {\n    // creation of the main container\n    var container = this._createMainContainerElement();\n\n    // adding in the main container\n    var input = this._createMainLayersShowElement();\n    container.appendChild(input);\n\n    // handling of the \"collapsed\" mode\n    if (!options.collapsed) {\n        input.checked = \"checked\";\n    }\n    // adds the layer list in the main container\n    var divL = this._layerListContainer = this._createMainLayersElement();\n    container.appendChild(divL);\n\n    // creates the draggable mode\n    this._createDraggableElement(divL, this);\n\n    // adds the control picto in the main container\n    var picto = this._createMainPictoElement();\n    container.appendChild(picto);\n\n    // adds the info panel in the main container\n    var divI = this._createMainInfoElement();\n    container.appendChild(divI);\n\n    return container;\n};\n\n/**\n * Adds control layers to control main container\n *\n * @method _addGlobeLayers\n * @param {Object} globe - the Itowns.GlobeViewExtended object\n * @private\n */\nLayerSwitcher.prototype._addGlobeLayers = function(globe) {\n\n    // Retrieves the element which contains the different layers\n    var elementLayersList;\n    var childNodes = this.getElement().childNodes;\n\n    for (var i = 0; i < childNodes.length; i++) {\n        if (childNodes[i].id === this._addUID(\"GPlayersList\")) {\n            elementLayersList = childNodes[i];\n            break;\n        }\n    }\n    // reorders layers according to the layer stack (globe.getLayers returns an reverse ordenered array)\n    var layers = globe.getColorLayers();\n    var orderedLayers = layers.sort(function(a, b) {\n        return b.sequence - a.sequence;\n    });\n\n    // loop over all the layers of the map in order to add them to the control layer list (if they are not already added)\n    orderedLayers.forEach(\n        function(layer) {\n            // adds the map layers to the list\n            var id;\n            id = layer.id;\n            if (!this._layerDisplayedInLayerSwitcher(id)) {\n                return;\n            }\n            var layerConf = this._getLayerConf(id) || this._addedLayerConf[id] || {};\n            var layerInfos = this._getLayerInfo(layer) || {};\n            if (!this._layers[id]) {\n                // if the layer is not yet in the layer list (this._layers), we add it\n                var layerOptions = {\n                    title: layerConf.title || layerInfos._title || id,\n                    description: layerConf.description || layerInfos._description || null,\n                    legends: layerConf.legends || layerInfos._legends || [],\n                    metadata: layerConf.metadata || layerInfos._metadata || [],\n                    quicklookUrl: layerConf.quicklookUrl || layerInfos._quicklookUrl || null\n                };\n                this._layers[id] = layerOptions;\n            } else {\n                var lsLayerConf = this._layers[id];\n                if (typeof lsLayerConf.ipr !== \"undefined\") {\n                    layer.options.attribution = lsLayerConf.ipr;\n                }\n                if (typeof lsLayerConf.opacity !== \"undefined\") {\n                    layer.opacity = lsLayerConf.opacity;\n                }\n                if (typeof lsLayerConf.visibility !== \"undefined\") {\n                    layer.visible = lsLayerConf.visibility;\n                }\n            }\n\n            var layerDiv = this._createLayerDiv(id);\n            this._layers[id].div = layerDiv;\n            elementLayersList.appendChild(layerDiv);\n        },\n        this\n    );\n};\n\n/**\n * creates layer div (to append to control DOM element).\n *\n * @method _createLayerDiv\n * @param {String} layerId - layer id\n * @private\n */\nLayerSwitcher.prototype._createLayerDiv = function(layerId) {\n    var layerOptions = this._layers[layerId];\n    var isLegends = layerOptions.legends && layerOptions.legends.length !== 0;\n    var isMetadata = layerOptions.metadata && layerOptions.metadata.length !== 0;\n    var isQuicklookUrl = layerOptions.quicklookUrl;\n    if (isLegends || isMetadata || isQuicklookUrl) {\n        layerOptions.displayInformationElement = true;\n    }\n\n    // adds a specific div in the control for the layer\n    layerOptions.id = layerId;\n    var layerDiv = this._createContainerLayerElement(layerOptions);\n\n    if (!layerOptions.inRange) {\n        layerDiv.classList.add(\"outOfRange\");\n    }\n\n    return layerDiv;\n};\n\n// ################################################################### //\n// ######################### DOM events ############################## //\n// ################################################################### //\n\n/**\n * Changes layer opacity on layer opacity picto click\n *\n * @method _onChangeLayerOpacity\n * @param {Object} e - HTML event\n * @private\n */\nLayerSwitcher.prototype._onChangeLayerOpacity = function(e) {\n    var globe = this.getGlobe();\n    var layerID = this._resolveLayerId(e.target.id);\n\n    var opacityValue = e.target.value;\n    var opacityId = document.getElementById(this._addUID(\"GPopacityValue_ID_\" + layerID));\n    opacityId.innerHTML = opacityValue + \"%\";\n    globe.setLayerOpacity(layerID, opacityValue / 100);\n};\n\n/**\n * Updates picto opacity value on layer opacity change\n *\n * @method _updateLayerOpacity\n * @param {String} layerId - layer id\n * @param {Number} opacity - opacity value\n * @private\n */\nLayerSwitcher.prototype._updateLayerOpacity = function(layerId, opacity) {\n    if (opacity > 1) {\n        opacity = 1;\n    }\n    if (opacity < 0) {\n        opacity = 0;\n    }\n\n    var layerOpacityInput = document.getElementById(this._addUID(\"GPopacityValueDiv_ID_\" + layerId));\n    if (layerOpacityInput) {\n        layerOpacityInput.value = Math.round(opacity * 100);\n    }\n\n    var layerOpacitySpan = document.getElementById(this._addUID(\"GPopacityValue_ID_\" + layerId));\n    if (layerOpacitySpan) {\n        layerOpacitySpan.innerHTML = Math.round(opacity * 100) + \"%\";\n    }\n};\n\n/**\n * Changes layer visibility on layer visibility picto click\n *\n * @method _onVisibilityLayerClick\n * @param {Object} e - HTML event\n * @private\n */\nLayerSwitcher.prototype._onVisibilityLayerClick = function(e) {\n    var globe = this.getGlobe();\n\n    var layerID = this._resolveLayerId(e.target.id);\n    globe.setLayerVisibility(layerID, e.target.checked); // update viewer\n};\n\n/**\n * Changes picto visibility on layer visibility change\n *\n * @method _updateLayerVisibility\n * @param {String} layerId - layer id\n * @param {Boolean} visibility - visible if true\n * @private\n */\nLayerSwitcher.prototype._updateLayerVisibility = function(layerId, visibility) {\n    var layerVisibilityInput = document.getElementById(this._addUID(\"GPvisibility_ID_\" + layerId));\n    if (layerVisibilityInput) {\n        layerVisibilityInput.checked = visibility;\n    }\n};\n\n/**\n * Opens layer information panel on picto click\n *\n * @method _onOpenLayerInfoClick\n * @param {Event} e - MouseEvent\n * @private\n */\nLayerSwitcher.prototype._onOpenLayerInfoClick = function(e) {\n    var layerID = this._resolveLayerId(e.target.id);\n\n    var layerOptions = this._layers[layerID];\n\n    var panel;\n    var info;\n\n    // Close layer info panel\n    var divId = document.getElementById(e.target.id);\n    if (divId.className === \"GPlayerInfoOpened\") {\n        if (divId.classList !== undefined) {\n            divId.classList.remove(\"GPlayerInfoOpened\");\n            divId.classList.add(\"GPlayerInfo\");\n        }\n\n        panel = document.getElementById(this._addUID(\"GPlayerInfoPanel\"));\n        if (panel.classList !== undefined) {\n            panel.classList.remove(\"GPpanel\");\n            panel.classList.remove(\"GPlayerInfoPanelOpened\");\n            panel.classList.add(\"GPlayerInfoPanelClosed\");\n        }\n\n        info = document.getElementById(this._addUID(\"GPlayerInfoContent\"));\n        panel.removeChild(info);\n        return;\n    }\n\n    var layers = document.getElementsByClassName(\"GPlayerInfoOpened\");\n    for (var i = 0; i < layers.length; i++) {\n        layers[i].className = \"GPlayerInfo\";\n    }\n\n    // Open layer info panel\n    if (divId.classList !== undefined) {\n        divId.classList.remove(\"GPlayerInfo\");\n        divId.classList.add(\"GPlayerInfoOpened\");\n    }\n\n    panel = document.getElementById(this._addUID(\"GPlayerInfoPanel\"));\n    if (panel.classList !== undefined) {\n        panel.classList.add(\"GPpanel\");\n        panel.classList.remove(\"GPlayerInfoPanelClosed\");\n        panel.classList.add(\"GPlayerInfoPanelOpened\");\n    }\n\n    info = document.getElementById(this._addUID(\"GPlayerInfoContent\"));\n    if (info) {\n        panel.removeChild(info);\n    }\n\n    // on rcupre les infos associes au layer pour mettre dynamiquement le contenu du panel d'informations\n    var obj = {\n        title: layerOptions.title,\n        description: layerOptions.description,\n        quicklookUrl: layerOptions.quicklookUrl,\n        metadata: layerOptions.metadata,\n        legends: layerOptions.legends\n    };\n\n    var infoLayer = this._createContainerLayerInfoElement(obj);\n    panel.appendChild(infoLayer);\n};\n\n/**\n * removes layer from layer switcher and globe on picto click\n *\n * @method _onDropLayerClick\n * @param {Event} e - MouseEvent\n * @private\n */\nLayerSwitcher.prototype._onDropLayerClick = function(e) {\n    var globe = this.getGlobe();\n\n    var layerID = this._resolveLayerId(e.target.id);\n    // removing the layer will trigger the event listener\n    // which will call this.removeLayer and delete the div\n    globe.removeLayer(layerID);\n\n    this._updateLayerListContainer();\n};\n\n/**\n * changes layers order on drag and drop\n *\n * @method _onDropLayerClick\n * @param {Event} e - HTML event\n * @private\n */\nLayerSwitcher.prototype._onDragAndDropLayerClick = function(e) {\n    var globe = this.getGlobe();\n\n    // Handling of the indexes : gives the little indexes (lowest layers) to the non-visible layers (displayed: false)\n    // when the index of a visible layer changes.\n    // Always moves the non-visible layers under the other layers (to not hide them)\n\n    if (e.newIndex - e.oldIndex === 0) {\n        return;\n    }\n\n    var targetIndex = null;\n    if (!e.newIndex || e.newIndex === 0) {\n        targetIndex = globe.getColorLayers().length - 1;\n    } else {\n        var layerTargetID = this._resolveLayerId(e.from.childNodes[e.newIndex + (e.newIndex - e.oldIndex < 0 ? 1 : -1)].id);\n        targetIndex = globe.getLayerById(layerTargetID).sequence;\n    }\n\n    var layerID = this._resolveLayerId(e.item.id);\n\n    globe.moveLayerToIndex(layerID, targetIndex);\n};\n\n/**\n * Checks layers range\n *\n * @method _inRangeUpdate\n * @private\n */\nLayerSwitcher.prototype._inRangeUpdate = function(layersDisplayed) {\n\n    for (var layerKey in this._layers) {\n        var layer = this._layers[layerKey];\n        if (!layer) {\n            continue;\n        }\n        // Check if layer is displayed.\n        var layerDiv;\n        var bInRange = layersDisplayed.indexOf(layer.id) >= 0;\n        if (bInRange && !layer.inRange) {\n            layer.inRange = true;\n            layerDiv = document.getElementById(this._addUID(\"GPlayerSwitcher_ID_\" + layer.id));\n            layerDiv.classList.remove(\"outOfRange\");\n        } else if (!bInRange && layer.inRange) {\n            layer.inRange = false;\n            layerDiv = document.getElementById(this._addUID(\"GPlayerSwitcher_ID_\" + layer.id));\n            layerDiv.classList.add(\"outOfRange\");\n        }\n    }\n};\n\n/**\n * Update the layer list container\n *\n * @method _updateLayerListContainer\n * @private\n */\nLayerSwitcher.prototype._updateLayerListContainer = function() {\n    if (this._layerListContainer) {\n        var globe = this.getGlobe();\n\n        // empty the previous container\n        while (this._layerListContainer.firstChild) {\n            this._layerListContainer.removeChild(this._layerListContainer.firstChild);\n        }\n        // reorders layers according to the layer stack (globe.getLayers returns an reverse ordenered array)..\n        var layers = globe.getColorLayers();\n        var orderedLayers = layers.sort(function(a, b) {\n            return b.sequence - a.sequence;\n        });\n        // ... and adds the correct div to the different layers, in the zindex decreasing order\n        for (var j = 0; j < orderedLayers.length; j++) {\n            if (!this._layers[orderedLayers[j].id]) {\n                continue;\n            }\n            // retrieves the div of the layer, stored in the _layers array\n            var layerDiv = this._layers[orderedLayers[j].id].div;\n            this._layerListContainer.appendChild(layerDiv);\n        }\n    } else {\n        console.log(\"[Itowns.control.LayerSwitcher] _updateLayerListContainer : layer list container not found to update layers order ?!\");\n    }\n};\n\n// ################################################################### //\n// ############################ Utils ################################ //\n// ################################################################### //\n\n/**\n * Gets layer informations : title, description, quicklookurl, legends, metadata\n *\n * @private\n * @memberof LayerSwitcher\n * @method _getLayerInfo\n * @param {Object} layer - the layer object\n * @returns {Object} layerInfo - layer informations\n */\nLayerSwitcher.prototype._getLayerInfo = function(layer) {\n    var layerInfo = {};\n    if (layer) {\n        layerInfo._title = layer.title || null;\n        layerInfo._description = layer.description || null;\n        layerInfo._quicklookUrl = layer.quicklookUrl || null;\n        layerInfo._metadata = layer.metadata || null;\n        layerInfo._legends = layer.legends || null;\n    }\n    return layerInfo;\n};\n\n/**\n * Gets layer id from div id\n *\n * @method _resolveLayerId\n * @param {String} divId - HTML div id\n * @private\n */\nLayerSwitcher.prototype._resolveLayerId = function(divId) {\n    var divName = SelectorID.name(divId); // ex GPvisibilityPicto_ID_26\n    return divName.substring(divName.indexOf(\"_ID_\") + 4); // ex. 26\n};\n\nexport default LayerSwitcher;\n\n\n\n// WEBPACK FOOTER //\n// ./src/Itowns/Controls/LayerSwitcher.js","import GlobeViewExtended from \"../GlobeViewExtended\";\nimport Utils from \"../../Common/Utils\";\nimport SelectorID from \"../../Common/Utils/SelectorID\";\nimport LayerUtils from \"../../Common/Utils/LayerUtils\";\nimport AttributionDOM from \"../../Common/Controls/AttributionDOM\";\nimport Widget from \"./Widget\";\n\n\n/**\n * @classdesc\n * Control to manage layers attributions\n *\n * @constructor\n * @alias itowns.control.Attributions\n * @extends {itowns.control.Widget}\n * @param {Object} aOptions - control options\n * @param {Object} [aOptions.options] - Itowns.control.Control options\n * @param {Boolean} [aOptions.options.collapsed = false] - Specify if the control has to be opened or not.\n * @example\n * var attribution = new itowns.control.Attritbution({\n *  options : {\n *      collapsed: true\n *  }\n * ));\n */\nfunction Attributions(aOptions) {\n\n    aOptions = aOptions || {};\n    var options = aOptions.options || {};\n\n    if (!(this instanceof Attributions)) {\n        throw new TypeError(\"ERROR CLASS_CONSTRUCTOR\");\n    }\n\n    if (options && typeof options !== \"object\") {\n        throw new Error(\"ERROR WRONG_TYPE : options should be an object\");\n    }\n\n    this._initialize(options);\n\n    var container = this._initContainer(options);\n    var targetDiv = document.getElementById(options.target) || null;\n\n    Widget.call(\n        this, {\n            name: \"Attributions\",\n            element: container,\n            target: targetDiv\n        }\n    );\n}\n\n/*\n * @lends module:Attributions\n */\nAttributions.prototype = Object.create(Widget.prototype, {});\n\n// retrieves methods of the common class AttributionDOM\nUtils.assign(Attributions.prototype, AttributionDOM);\n\n/**\n * Constructor (alias)\n *\n * @private\n */\nAttributions.prototype.constructor = Attributions;\n\n// ################################################################### //\n// ############## public methods (getters, setters) ################## //\n// ################################################################### //\n\n/**\n * Bind globe to control\n */\nAttributions.prototype.setGlobe = function(globe) {\n    // info : this function is called after a globe.addWidget() or a globe.removeWidget()\n\n    if (globe) { // In the case of the adding of a control to the globe\n        var self = this;\n\n        // Adding of the listeners\n\n        // At every globe movement, attributions may be updated,\n        // according to layers on globe, and their visibility.\n        /**\n         * Adds the onPreRenderCallBack callback\n         */\n        this._callbacks.onPreRenderCallBack = function(e) {\n            var allLayers = e.colorLayersId.concat(e.elevationLayersId);\n\n            self._inRangeUpdate(allLayers, e.extent);\n        };\n\n        globe.listen(GlobeViewExtended.EVENTS.PRE_RENDER, this._callbacks.onPreRenderCallBack);\n        globe.preRenderEventFetchViewExtent();\n        globe.preRenderEventFetchLayersDisplayed();\n    } else {\n        // delete listener\n        this._globe.forget(GlobeViewExtended.EVENTS.PRE_RENDER, this._callbacks.onPreRenderCallBack);\n\n        // delete DOM\n        while (this._element.hasChildNodes()) {\n            this._element.removeChild(this._element.lastChild);\n        }\n        this._element.parentNode.removeChild(this._element);\n    }\n\n    // call original setGlobe method\n    Widget.prototype.setGlobe.call(this, globe);\n};\n\n/**\n * Collapse or display control main container\n *\n * @param {Boolean} collapsed - True to collapse control, False to display it\n */\nAttributions.prototype.setCollapsed = function(collapsed) {\n    if (collapsed === undefined) {\n        console.log(\"[ERROR] Attributions:setCollapsed - missing collapsed parameter\");\n        return;\n    }\n    var isCollapsed = this.getCollapsed();\n    if ((collapsed && isCollapsed) || (!collapsed && !isCollapsed)) {\n        return;\n    }\n\n    document.getElementById(this._addUID(\"GPshowAttributionsList\")).checked = !collapsed;\n};\n\n/**\n * Returns true if widget is collapsed (minimize), false otherwise\n *\n * @return {Boolean} collapsed\n */\nAttributions.prototype.getCollapsed = function() {\n    return !document.getElementById(this._addUID(\"GPshowAttributionsList\")).checked;\n};\n\n// ################################################################### //\n// ##################### init component ############################## //\n// ################################################################### //\n\n/**\n * Initialize Attributions control (called by constructor)\n *\n * @param {Object} options - Itowns.control.Control options\n * @private\n */\nAttributions.prototype._initialize = function(options) {\n    // id of the widget : usefull to suffix the CSS ids (to handle cases with several widgets on the same page)\n    this._uid = SelectorID.generate();\n\n    // div which will contain the list divs.\n    this._AttributionContainer = null;\n\n    // callbacks\n    this._callbacks = {};\n\n    // options\n    this._options = options;\n};\n\n/**\n * Creates control main container\n *\n * @method _initContainer\n * @param {Object} options - control options\n * @private\n */\nAttributions.prototype._initContainer = function(options) {\n\n    var container = this._createMainContainerElement();\n\n    // adds in the main container the layer display selector\n    var inputShow = this._createMainAttributionsShowElement();\n    container.appendChild(inputShow);\n\n    // handles the \"collapsed\" mode\n    if (!options.collapsed) {\n        inputShow.checked = \"checked\";\n    }\n    // adds the layer list in the main container\n    var divA = this._attributionListContainer = this._createMainAttributionsListContainer();\n    var ulA = this._createAttributionsList();\n    divA.appendChild(ulA);\n    container.appendChild(divA);\n\n    // adds the widget picto in the main container\n    var picto = this._createMainPictoElement(options.collapsed);\n    container.appendChild(picto);\n\n    return container;\n};\n\n/**\n * Checks layers range\n *\n * @method _inRangeUpdate\n * @param {Array} layersDisplayed - Id of the layers diplayed on screen\n * @param {Object} extent - The globe view extent\n * @private\n */\n\nAttributions.prototype._inRangeUpdate = function(layersDisplayed, extent) {\n    var globe = this.getGlobe();\n\n    var scaleDenominator = 1 / globe.getScale();\n\n    var attributions = new window.Map();\n\n    for (var h = 0; h < layersDisplayed.length; h++) {\n\n        var layer = globe.getLayerById(layersDisplayed[h]);\n\n        // FIXME itowns bug : itowns should only returns visible layers\n        if (!layer.visible) {\n            continue;\n        }\n\n        var ori = layer.options.originators;\n\n        if (ori) {\n            for (var j = 0; j < ori.length; j++) {\n                // if the attribution is already added, we skip to not add it several times\n                if (attributions.has(ori[j].name)) {\n                    continue;\n                };\n                // if no constraints are associated to the originator, we just add the attribution\n                if (!ori[j].constraints) {\n                    // adds the attribution in the Map() called 'attributions'\n                    attributions.set(ori[j].name, ori[j]);\n                    continue;\n                }\n                // if the minScaleDenominator exists\n                if (ori[j].constraints[0].minScaleDenominator) {\n                    // if min/maxScaleDenominator are equals, we display the attribution corresponding to the zoom level associated to the scale denominator\n                    if (ori[j].constraints[0].minScaleDenominator === ori[j].constraints[0].maxScaleDenominator) {\n                        // retrieves the zoom level\n                        var attributionZoomLevel = LayerUtils.getZoomLevelFromScaleDenominator(ori[j].constraints[0].minScaleDenominator);\n                        // selects the scaledenominators around the corresponding zoom level\n                        var maxAttributionScaleDenominator = (this._resolutionsWGS84[attributionZoomLevel] + this._resolutionsWGS84[attributionZoomLevel - 1]) / (0.00028 * 2);\n                        var minAttributionScaleDenominator = (this._resolutionsWGS84[attributionZoomLevel] + this._resolutionsWGS84[attributionZoomLevel + 1]) / (0.00028 * 2);\n                        if (!(maxAttributionScaleDenominator > scaleDenominator && scaleDenominator > minAttributionScaleDenominator)) {\n                            continue;\n                        }\n                    }\n                    // either, we check we are located between the minScaleDenominator and the maxScaleDenominator\n                    else if (!(ori[j].constraints[0].minScaleDenominator < scaleDenominator && scaleDenominator < ori[j].constraints[0].maxScaleDenominator)) {\n                        continue;\n                    }\n                }\n                // checks if 'bbox\" exists\n                if (ori[j].constraints[0].bbox) {\n                    // checks we are into the bbox limits\n                    if (ori[j].constraints[0].bbox.left < extent.west() && ori[j].constraints[0].bbox.right > extent.east() && ori[j].constraints[0].bbox.top > extent.north() && ori[j].constraints[0].bbox.bottom < extent.south()) {\n                        // adds the attribution in the Map() called 'attributions'\n                        attributions.set(ori[j].name, ori[j]);\n                    }\n                    // if 'bbox' attribute doesn't exist\n                } else if (!ori[j].constraints[0].bbox) {\n                    attributions.set(ori[j].name, ori[j]);\n                }\n            }\n        }\n    }\n    this._updateAttributionListContainer(attributions);\n};\n\n// ################################################################### //\n// ######################### DOM events ############################## //\n// ################################################################### //\n\n/**\n * Updates the layer list container\n *\n * @method _updateAttributionListContainer\n * @private\n */\nAttributions.prototype._updateAttributionListContainer = function(attributions) {\n    var element = document.getElementById(this._addUID(\"GPAttributionsList\"));\n    document.getElementById(this._addUID(\"GPAttributionsList\")).parentNode.removeChild(element);\n\n    var ul = this._createAttributionsList();\n    attributions.forEach(function(a) {\n        var li = document.createElement(\"li\");\n        var link = document.createElement(\"a\");\n        link.href = a.url;\n        link.innerHTML = a.name + \"&nbsp\";\n        link.target = \"_blank\";\n        li.id = a.name.replace(/\\s/g, \"\");\n        li.appendChild(link);\n        ul.appendChild(li);\n    });\n    this._attributionListContainer.appendChild(ul);\n};\n\nAttributions.prototype._resolutionsWGS84 = {\n    0: 156543.033928041,\n    1: 78271.51696402048,\n    2: 39135.758482010235,\n    3: 19567.87924100512,\n    4: 9783.93962050256,\n    5: 4891.96981025128,\n    6: 2445.98490512564,\n    7: 1222.99245256282,\n    8: 611.49622628141,\n    9: 305.7481131407048,\n    10: 152.8740565703525,\n    11: 76.43702828517624,\n    12: 38.21851414258813,\n    13: 19.10925707129406,\n    14: 9.554628535647032,\n    15: 4.777314267823516,\n    16: 2.388657133911758,\n    17: 1.194328566955879,\n    18: 0.5971642834779395,\n    19: 0.2985821417389697,\n    20: 0.1492910708694849,\n    21: 0.0746455354347424\n};\n\nexport default Attributions;\n\n\n\n// WEBPACK FOOTER //\n// ./src/Itowns/Controls/Attributions.js","import Sortable from \"sortable\";\n\nvar AttributionDOM = {\n\n    // ################################################################### //\n    // ######################### Main container ########################## //\n    // ################################################################### //\n\n    /** Add uuid to the tag ID */\n    _addUID: function(id) {\n        var uid = (this._uid) ? id + \"-\" + this._uid : id;\n        return uid;\n    },\n\n    /**\n     * Creation du container principal (DOM)\n     *\n     * @returns {DOMElement} div DOM\n     */\n    _createMainContainerElement: function() {\n\n        var container = document.createElement(\"div\");\n        container.id = this._addUID(\"GPAttribution\");\n        container.className = \"GPwidget\";\n\n        return container;\n    },\n\n    /**\n     * Creation du selecteur (cach) pour l'affichage/masquage des attributions (DOM)\n     *\n     * @returns {DOMElement} checkbox DOM\n     */\n    _createMainAttributionsShowElement: function() {\n        var input = document.createElement(\"input\");\n        input.id = this._addUID(\"GPshowAttributionsList\");\n        input.type = \"checkbox\";\n        return input;\n    },\n\n    /**\n     * Cration de l'lment liste des attributions (DOM)\n     *\n     * @returns {DOMElement} liste DOM\n     */\n    _createAttributionsList: function() {\n        var ul = document.createElement(\"ul\");\n        ul.id = this._addUID(\"GPAttributionsList\");\n        return ul;\n    },\n\n    /**\n     * Cration du conteneur principal des attributions (DOM)\n     *\n     * @returns {DOMElement} div DOM\n     */\n    _createMainAttributionsListContainer: function() {\n        var div = document.createElement(\"div\");\n        div.id = this._addUID(\"GPAttributionsListContainer\");\n\n        return div;\n    },\n\n    /**\n     * Cration du container du picto du controle (DOM)\n     *\n     * @returns {DOMElement} label DOM\n     */\n    _createMainPictoElement: function(collapsed) {\n\n        var self = this;\n\n        var label = document.createElement(\"label\");\n        label.id = this._addUID(\"GPshowAttributionsListPicto\");\n        label.className = \"GPshowAdvancedToolPicto\";\n        label.htmlFor = this._addUID(\"GPshowAttributionsList\");\n        label.title = \"Afficher/masquer les attributions\";\n\n        var spanOpen = document.createElement(\"span\");\n        spanOpen.id = this._addUID(\"GPshowAttributionsListOpenClose\");\n        spanOpen.className = \"GPshowAdvancedToolOpen\";\n        spanOpen.innerHTML = collapsed ? \"i\" : \"\";\n        spanOpen.addEventListener(\"click\", function() {\n            spanOpen.innerHTML = (document.getElementById(self._addUID(\"GPshowAttributionsList\")).checked) ? \"i\" : \"\";\n        });\n\n        label.appendChild(spanOpen);\n\n        return label;\n    }\n\n};\n\nexport default AttributionDOM;\n\n\n\n// WEBPACK FOOTER //\n// ./src/Common/Controls/AttributionDOM.js","import GlobeViewExtended from \"../GlobeViewExtended\";\nimport Utils from \"../../Common/Utils\";\nimport SelectorID from \"../../Common/Utils/SelectorID\";\nimport ScaleDOM from \"../../Common/Controls/ScaleDOM\";\nimport Widget from \"./Widget\";\n\n\n/**\n * @classdesc\n * Control to display the scalebar with itowns\n *\n * @constructor\n * @alias itowns.control.Scale\n * @extends {itowns.control.Widget}\n * @alias itowns.control.Scale\n * @example\n * var scale = new itowns.control.Scale();\n *\n */\nfunction Scale(options) {\n\n    options = options || {};\n\n    if (!(this instanceof Scale)) {\n        throw new TypeError(\"ERROR CLASS_CONSTRUCTOR\");\n    }\n\n    if (options && typeof options !== \"object\") {\n        throw new Error(\"ERROR WRONG_TYPE : options should be an object\");\n    }\n\n    this._initialize();\n\n    var container = this._initContainer();\n    var vDiv = document.getElementById(\"viewerDiv\");\n\n    // by default, add the control on the viwerDiv\n    var targetDiv = document.getElementById(options.target) || vDiv;\n\n    Widget.call(\n        this, {\n            name: \"GraphicScale\",\n            element: container,\n            target: targetDiv,\n            position: options.position\n        }\n    );\n}\n\n/*\n * @lends module:Scale\n */\nScale.prototype = Object.create(Widget.prototype, {});\n\n// retrieves methods of the common class ScaleDOM\nUtils.assign(Scale.prototype, ScaleDOM);\n\n/**\n * Constructor (alias)\n *\n * @private\n */\nScale.prototype.constructor = Scale;\n\n// ################################################################### //\n// ############## public methods (getters, setters) ################## //\n// ################################################################### //\n\n/**\n * Binds globe to control\n */\nScale.prototype.setGlobe = function(globe) {\n    // info : this function is called after a globe.addWidget() or a globe.removeWidget()\n\n    if (globe) { // In the case of the adding of a control to the globe\n        var self = this;\n        /**\n         * Definition of the scaleControl callback :\n         * when the view is changing, we recalculate the graphic scale\n         */\n        this._callbacks.onChangedViewCallback = function() {\n            var value = globe.pixelsToMeters(200);\n            value = Math.floor(value);\n            var digit = Math.pow(10, value.toString().length - 1);\n            value = Math.round(value / digit) * digit;\n            var pix = globe.metersToPixels(value);\n            var unit = \"m\";\n            if (value >= 1000) {\n                value /= 1000;\n                unit = \"km\";\n            }\n            self.getElement().innerHTML = value + \" \" + unit;\n            self.getElement().style.width = pix + \"px\";\n        };\n        // Ajout des listeners\n        // initialization\n        if (globe.isInitialized()) {\n            this._callbacks.onChangedViewCallback();\n        } else {\n            globe.listen(GlobeViewExtended.EVENTS.GLOBE_INITIALIZED, this._callbacks.onChangedViewCallback);\n        }\n\n        // At every globe range movement, scale bar may be updated,\n        globe.listen(GlobeViewExtended.EVENTS.RANGE_CHANGED, this._callbacks.onChangedViewCallback);\n    } else if (globe == null) {\n        // we remove the listeners linked to the scalecontrol which has been deleted\n        this._globe.forget(GlobeViewExtended.EVENTS.GLOBE_INITIALIZED, this._callbacks.onChangedViewCallback);\n        this._globe.forget(GlobeViewExtended.EVENTS.RANGE_CHANGED, this._callbacks.onChangedViewCallback);\n\n        // if globe == null we remove the scale control\n        // delete the scaleControl DOM\n        while (this.getElement().hasChildNodes()) {\n            this.getElement().removeChild(this.getElement().lastChild);\n        }\n        this.getElement().parentNode.removeChild(this.getElement());\n    }\n\n    // call original setGlobe method\n    Widget.prototype.setGlobe.call(this, globe);\n};\n\n// ################################################################### //\n// ##################### init component ############################## //\n// ################################################################### //\n\n/**\n * Initialize Scale control (called by constructor)\n *\n * @private\n */\nScale.prototype._initialize = function() {\n    // id of the widget : usefull to suffix the CSS ids (to handle cases with several widgets on the same page)\n    this._uid = SelectorID.generate();\n\n    // div which will contain the list divs.\n    this._ScaleContainer = null;\n\n    // callbacks\n    this._callbacks = {};\n};\n\n/**\n * Create control main container\n *\n * @method _initContainer\n * @private\n */\nScale.prototype._initContainer = function() {\n\n    var container = this._createMainContainerElement();\n\n    return container;\n};\n\nexport default Scale;\n\n\n\n// WEBPACK FOOTER //\n// ./src/Itowns/Controls/Scale.js","var ScaleDOM = {\n\n    /** Add uuid to the tag ID */\n    _addUID: function(id) {\n        var uid = (this._uid) ? id + \"-\" + this._uid : id;\n        return uid;\n    },\n\n    /**\n     * Main container (DOM)\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createMainContainerElement: function() {\n\n        var container = document.createElement(\"div\");\n        container.id = this._addUID(\"GPscaleContainer\");\n        container.className = \"GPwidget\";\n        return container;\n    }\n};\n\nexport default ScaleDOM;\n\n\n\n// WEBPACK FOOTER //\n// ./src/Common/Controls/ScaleDOM.js","import * as Itowns from \"itowns\";\nimport GlobeViewExtended from \"../GlobeViewExtended\";\nimport Utils from \"../../Common/Utils\";\nimport SelectorID from \"../../Common/Utils/SelectorID\";\nimport MiniGlobeDOM from \"../../Common/Controls/MiniGlobeDOM\";\nimport Widget from \"./Widget\";\n\n\n/**\n * @classdesc\n * Control to display the MiniGlobe with itowns\n *\n * @constructor\n * @alias itowns.control.MiniGlobe\n * @extends {itowns.control.Widget}\n * @example\n * var miniglobe = new itowns.control.MiniGlobe();\n *\n */\nfunction MiniGlobe(options) {\n\n    options = options || {};\n\n    if (!(this instanceof MiniGlobe)) {\n        throw new TypeError(\"ERROR CLASS_CONSTRUCTOR\");\n    }\n\n    if (options && typeof options !== \"object\") {\n        throw new Error(\"ERROR WRONG_TYPE : options should be an object\");\n    }\n\n    this._initialize();\n\n    var container = this._initContainer();\n    var vDiv = document.getElementById(\"viewerDiv\");\n    this._options = options;\n\n    // by default, adds the control on the viewerDiv\n    var targetDiv = document.getElementById(options.target) || vDiv;\n\n    Widget.call(\n        this, {\n            name: \"Overview\",\n            element: container,\n            target: targetDiv,\n            position: options.position\n        }\n    );\n}\n\n/*\n * @lends module:MiniGlobe\n */\nMiniGlobe.prototype = Object.create(Widget.prototype, {});\n\n// retrieves methods of the common class MiniGlobeDOM\nUtils.assign(MiniGlobe.prototype, MiniGlobeDOM);\n\n/**\n * Constructor (alias)\n *\n * @private\n */\nMiniGlobe.prototype.constructor = MiniGlobe;\n\n// ################################################################### //\n// ############## public methods (getters, setters) ################## //\n// ################################################################### //\n\n/**\n * Bind globe to control\n */\nMiniGlobe.prototype.setGlobe = function(globe) {\n    // info : this function is called after a globe.addWidget() or a globe.removeWidget()\n\n    if (globe) { // In the case of the adding of a control to the globe\n        var minDistance = 6650000;\n        var maxDistance = 30000000;\n        var positionOnGlobe = globe.getCenter();\n        var miniView = new Itowns.GlobeView(this._element, positionOnGlobe, {\n            // `limit globe' subdivision level:\n            // we're don't need a precise globe model\n            // since the mini globe will always be seen from a far point of view (see minDistance above)\n            maxSubdivisionLevel: 6,\n            // Don't instance default controls since miniview's camera will be synced\n            // on the main view's one (see globeView.onAfterRender)\n            noControls: true\n        });\n\n        // Set a 0 alpha clear value (instead of the default '1')\n        // because we want a transparent background for the miniglobe view to be able\n        // to see the main view \"behind\"\n        miniView.mainLoop.gfxEngine.renderer.setClearColor(0x000000, 0);\n\n        /**\n         * update miniview's camera with the globeView's camera position\n         */\n        var updateMiniGlobeHandler = function() {\n            // clamp distance camera from globe\n            var range = globe.getRange();\n            var distance = Math.min(Math.max(range * 1.5, minDistance), maxDistance);\n            var camera = miniView.camera.camera3D;\n            // Update target miniview's camera\n            camera.position.copy(globe.moveTarget()).setLength(distance);\n            camera.lookAt(globe.moveTarget());\n            miniView.notifyChange(true);\n        };\n        globe.listen(GlobeViewExtended.EVENTS.AFTER_RENDER, updateMiniGlobeHandler);\n        if (globe.isInitialized()) {\n            updateMiniGlobeHandler;\n        } else {\n            globe.listen(GlobeViewExtended.EVENTS.GLOBE_INITIALIZED, updateMiniGlobeHandler);\n        }\n\n        /**\n         * Add one imagery layer to the miniview (by default, the ortho)\n         */\n        var miniGlobeLayer = this._options.layer || this._baseLayer;\n        miniView.addLayer(miniGlobeLayer);\n        // save as property of the control the globe created for the overview\n        this._globeObj = miniView;\n    } else if (globe == null) {\n        // if globe == null we remove the overview control\n        // we delete the overview control DOM\n        while (this.getElement().hasChildNodes()) {\n            this.getElement().removeChild(this.getElement().lastChild);\n        }\n        this.getElement().parentNode.removeChild(this.getElement());\n    }\n\n    // call original setGlobe method\n    Widget.prototype.setGlobe.call(this, globe);\n};\n\n// ################################################################### //\n// ##################### init component ############################## //\n// ################################################################### //\n\n/**\n * Initialize MiniGlobe control (called by constructor)\n *\n * @private\n */\nMiniGlobe.prototype._initialize = function() {\n\n    // id of the widget : usefull to suffix the CSS ids (to handle cases with several widgets on the same page)\n    this._uid = SelectorID.generate();\n\n    // div which will contain the list divs.\n    this._MiniGlobeContainer = null;\n\n    // callbacks\n    this._callbacks = {};\n};\n\n/**\n * Creates control main container\n *\n * @method _initContainer\n * @private\n */\nMiniGlobe.prototype._initContainer = function() {\n\n    var container = this._createMainContainerElement();\n\n    return container;\n};\n\nMiniGlobe.prototype._baseLayer = {\n    type: \"color\",\n    protocol: \"wmts\",\n    id: \"Maps\",\n    url: \"https://wxs.ign.fr/an7nvfzojv5wa96dsga5nk8w/geoportail/wmts\",\n    updateStrategy: {\n        type: \"0\",\n        options: {}\n    },\n    networkOptions: {\n        crossOrigin: \"omit\"\n    },\n    options: {\n        name: \"GEOGRAPHICALGRIDSYSTEMS.MAPS\",\n        mimetype: \"image/jpeg\",\n        tileMatrixSet: \"PM\",\n        tileMatrixSetLimits: {\n            0: {\n                minTileRow: \"0\",\n                maxTileRow: \"0\",\n                minTileCol: \"0\",\n                maxTileCol: \"1\"\n            },\n            1: {\n                minTileRow: \"0\",\n                maxTileRow: \"1\",\n                minTileCol: \"0\",\n                maxTileCol: \"2\"\n            },\n            2: {\n                minTileRow: \"0\",\n                maxTileRow: \"2\",\n                minTileCol: \"0\",\n                maxTileCol: \"4\"\n            },\n            3: {\n                minTileRow: \"0\",\n                maxTileRow: \"5\",\n                minTileCol: \"0\",\n                maxTileCol: \"8\"\n            },\n            4: {\n                minTileRow: \"1\",\n                maxTileRow: \"11\",\n                minTileCol: \"0\",\n                maxTileCol: \"16\"\n            },\n            5: {\n                minTileRow: \"3\",\n                maxTileRow: \"22\",\n                minTileCol: \"0\",\n                maxTileCol: \"32\"\n            },\n            6: {\n                minTileRow: \"7\",\n                maxTileRow: \"45\",\n                minTileCol: \"0\",\n                maxTileCol: \"64\"\n            },\n            7: {\n                minTileRow: \"42\",\n                maxTileRow: \"97\",\n                minTileCol: \"0\",\n                maxTileCol: \"115\"\n            },\n            8: {\n                minTileRow: \"84\",\n                maxTileRow: \"195\",\n                minTileCol: \"1\",\n                maxTileCol: \"247\"\n            },\n            9: {\n                minTileRow: \"170\",\n                maxTileRow: \"390\",\n                minTileCol: \"2\",\n                maxTileCol: \"495\"\n            },\n            10: {\n                minTileRow: \"340\",\n                maxTileRow: \"780\",\n                minTileCol: \"5\",\n                maxTileCol: \"990\"\n            },\n            11: {\n                minTileRow: \"681\",\n                maxTileRow: \"1544\",\n                minTileCol: \"10\",\n                maxTileCol: \"1981\"\n            },\n            12: {\n                minTileRow: \"1363\",\n                maxTileRow: \"3088\",\n                minTileCol: \"20\",\n                maxTileCol: \"3962\"\n            },\n            13: {\n                minTileRow: \"2726\",\n                maxTileRow: \"6177\",\n                minTileCol: \"40\",\n                maxTileCol: \"7924\"\n            },\n            14: {\n                minTileRow: \"5452\",\n                maxTileRow: \"12355\",\n                minTileCol: \"81\",\n                maxTileCol: \"15847\"\n            },\n            15: {\n                minTileRow: \"10944\",\n                maxTileRow: \"21176\",\n                minTileCol: \"163\",\n                maxTileCol: \"31695\"\n            },\n            16: {\n                minTileRow: \"21889\",\n                maxTileRow: \"42353\",\n                minTileCol: \"326\",\n                maxTileCol: \"63382\"\n            },\n            17: {\n                minTileRow: \"43776\",\n                maxTileRow: \"73526\",\n                minTileCol: \"42528\",\n                maxTileCol: \"85869\"\n            },\n            18: {\n                minTileRow: \"87557\",\n                maxTileRow: \"147052\",\n                minTileCol: \"85058\",\n                maxTileCol: \"171738\"\n            }\n        }\n    }\n};\n\nexport default MiniGlobe;\n\n\n\n// WEBPACK FOOTER //\n// ./src/Itowns/Controls/MiniGlobe.js","var MiniGlobeDOM = {\n\n    /** Add uuid to the tag ID */\n    _addUID: function(id) {\n        var uid = (this._uid) ? id + \"-\" + this._uid : id;\n        return uid;\n    },\n\n    /**\n     * Main container (DOM)\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createMainContainerElement: function() {\n\n        var container = document.createElement(\"div\");\n        container.id = this._addUID(\"GPminiglobeContainer\");\n        container.className = \"GPwidget\";\n        return container;\n    }\n};\n\nexport default MiniGlobeDOM;\n\n\n\n// WEBPACK FOOTER //\n// ./src/Common/Controls/MiniGlobeDOM.js","import ol from \"ol\";\nimport Gp from \"gp\";\nimport LayerUtils from \"../Common/Utils/LayerUtils\";\nimport Register from \"../Common/Utils/Register\";\nimport ProxyUtils from \"../Common/Utils/ProxyUtils\";\nimport GfiUtils from \"./GfiUtils\";\nimport Utils from \"../Common/Utils\";\nimport KML from \"./Formats/KML\";\nimport WMTS from \"./Sources/WMTS\";\nimport CRS from \"./CRS/CRS\";\nimport SourceWMTS from \"./Layers/SourceWMTS\";\nimport SourceWMS from \"./Layers/SourceWMS\";\nimport LayerWMTS from \"./Layers/LayerWMTS\";\nimport LayerWMS from \"./Layers/LayerWMS\";\nimport LayerSwitcher from \"./Controls/LayerSwitcher\";\nimport GetFeatureInfo from \"./Controls/GetFeatureInfo\";\nimport SearchEngine from \"./Controls/SearchEngine\";\nimport MousePosition from \"./Controls/MousePosition\";\nimport Drawing from \"./Controls/Drawing\";\nimport Route from \"./Controls/Route\";\nimport Isocurve from \"./Controls/Isocurve\";\nimport ReverseGeocode from \"./Controls/ReverseGeocode\";\nimport LayerImport from \"./Controls/LayerImport\";\nimport GeoportalAttribution from \"./Controls/GeoportalAttribution\";\nimport Markers from \"./Controls/Utils/Markers\";\nimport ElevationPath from \"./Controls/ElevationPath\";\nimport MeasureLength from \"./Controls/Measures/MeasureLength\";\nimport MeasureArea from \"./Controls/Measures/MeasureArea\";\nimport MeasureAzimuth from \"./Controls/Measures/MeasureAzimuth\";\n\n// FIXME suprimer les rf.  ol3 !\n\n// Rajout des proprits de l'extension dans le namespace Gp\nGp.ol3extVersion = \"__GPOL3EXTVERSION__\";\nGp.ol3extDate = \"__GPDATE__\";\nGp.olUtils = Utils;\n\n// Classes utilitaires\nGp.LayerUtils = LayerUtils;\nGp.ProxyUtils = ProxyUtils;\nol.gp = {};\nol.gp.GfiUtils = GfiUtils;\n\n// FIXME overload or not ? name Gp.format.kml ?\nol.format.KMLExtended = KML;\nol.source.WMTSExtended = WMTS;\n\n// Surcharge sur les functions ol/proj4 par dfaut\nCRS.overload();\n\n// Rajout des proprits ol3 dans le namespace ol\nol.source.GeoportalWMTS = SourceWMTS;\nol.source.GeoportalWMS = SourceWMS;\nol.layer.GeoportalWMTS = LayerWMTS;\nol.layer.GeoportalWMS = LayerWMS;\nol.control.GeoportalAttribution = GeoportalAttribution;\nol.control.LayerSwitcher = LayerSwitcher;\nol.control.GetFeatureInfo = GetFeatureInfo;\nol.control.SearchEngine = SearchEngine;\nol.control.Route = Route;\nol.control.Isocurve = Isocurve;\nol.control.GeoportalMousePosition = MousePosition;\nol.control.Drawing = Drawing;\nol.control.ReverseGeocode = ReverseGeocode;\nol.control.LayerImport = LayerImport;\nol.control.MeasureLength = MeasureLength;\nol.control.MeasureArea = MeasureArea;\nol.control.MeasureAzimuth = MeasureAzimuth;\n// export default markers definitions\nol.control.DefaultMarkers = Markers;\nol.control.ElevationPath = ElevationPath;\n\nexport default Gp;\n\n\n\n// WEBPACK FOOTER //\n// ./src/OpenLayers/GpPluginOpenLayers.js","import ol from \"ol\";\nimport Utils from \"../../Common/Utils\";\nimport Config from \"../../Common/Utils/Config\";\nimport LayerUtils from \"../../Common/Utils/LayerUtils\";\nimport SourceWMTS from \"./SourceWMTS\";\n\n/**\n * @classdesc\n * Geoportal LayerWMTS source creation (inherit from ol.layer.Tile)\n *\n * @constructor\n * @extends {ol.layer.Tile}\n * @alias ol.layer.GeoportalWMTS\n * @param {Object} options            - options for function call.\n * @param {String} options.layer      - Layer name (e.g. \"ORTHOIMAGERY.ORTHOPHOTOS\")\n * @param {Boolean} [options.ssl]     - if set true, enforce protocol https (only for nodejs)\n * @param {String} [options.apiKey]   - Access key to Geoportal platform\n * @param {Object} [options.olParams] - other options for ol.layer.Tile function (see {@link http://openlayers.org/en/latest/apidoc/ol.layer.Tile.html ol.layer.Tile})\n * @param {Object} [options.olParams.sourceParams] - other options for ol.source.WMTS function (see {@link http://openlayers.org/en/latest/apidoc/ol.source.WMTS.html ol.source.WMTS})\n * @example\n * var layerWMTS = new ol.layer.GeoportalWMTS({\n *      layer  : \"ORTHOIMAGERY.ORTHOPHOTOS\"\n * });\n */\n \nfunction LayerWMTS(options) {\n\n    if (!(this instanceof LayerWMTS)) {\n        throw new TypeError(\"ERROR CLASS_CONSTRUCTOR\");\n    }\n\n    if (!options.layer) {\n        throw new Error(\"ERROR PARAM_MISSING : layer\");\n    }\n\n    if (typeof options.layer !== \"string\") {\n        throw new Error(\"ERROR WRONG TYPE : layer\");\n    }\n\n    // par defaut\n    if (typeof options.ssl === \"undefined\") {\n        options.ssl = false;\n    }\n\n    // Check if configuration is loaded\n    if (!Config.isConfigLoaded()) {\n        throw new Error(\"ERROR : contract key configuration has to be loaded to load Geoportal layers. See http://ignf.github.io/evolution-apigeoportail/ol3/ol3-autoconf.html\");\n    }\n\n    // cration de la source WMTS\n    var olSourceParams;\n    if (options.olParams && options.olParams.sourceParams) {\n        olSourceParams = options.olParams.sourceParams;\n    }\n    var wmtsSource = new SourceWMTS({\n        layer: options.layer,\n        ssl: options.ssl,\n        apiKey: options.apiKey,\n        olParams: olSourceParams\n    });\n\n    var layerTileOptions = {\n        source: wmtsSource\n    };\n\n    // si le param layer n'a pas t renseign lors de la cration de la source,\n    // c'est que l'identifiant de la couche n'a pas t trouv. on passe donc la recherche des paramtres.\n    if (wmtsSource.getLayer() !== undefined) {\n        // rcupration des autres paramtres ncessaires  la cration de la layer\n        var layerId = Config.getLayerId(options.layer, \"WMTS\");\n        var globalConstraints = Config.getGlobalConstraints(layerId);\n        if (globalConstraints && globalConstraints.projection) {\n\n            /* INFO : dsactivation temporaire de l'tendue, car certaines tendues (trop grandes ?)\n            provoquent quelques bugs d'affichage (zoom > 16 par exemple) */\n            // rcupration de l'tendue (en EPSG:4326), et reprojection dans la proj de la couche\n            // var geobbox = [\n            //     globalConstraints.extent.left,\n            //     globalConstraints.extent.bottom,\n            //     globalConstraints.extent.right,\n            //     globalConstraints.extent.top\n            // ];\n            // layerTileOptions.extent = ol.proj.transformExtent(geobbox, \"EPSG:4326\", globalConstraints.projection);\n\n            // rcupration des rsolutions min et max\n            var p;\n            // on rcupre tout d'abord la projection\n            if (typeof globalConstraints.projection === \"string\") {\n                p = ol.proj.get(globalConstraints.projection);\n            }\n            // puis, selon l'unit de la projection, on calcule la rsolution correspondante\n            if (p && p.getUnits()) {\n                if (p.getUnits() === \"m\") {\n                    /* fixme : fix temporaire pour grer les min/max scaledenominator qui sont arrondis dans l'autoconf !\n                     * on les arrondit respectivement  l'unit infrieure et suprieure\n                     * pour que les couches soient bien disponibles aux niveaux de zoom correspondants */\n                    // info : 1 pixel = 0.00028 m\n                    layerTileOptions.minResolution = (globalConstraints.minScale - 1) * 0.00028;\n                    layerTileOptions.maxResolution = (globalConstraints.maxScale + 1) * 0.00028;\n                } else if (p.getUnits() === \"degrees\") {\n                    /* fixme : fix temporaire pour grer les min/max scaledenominator qui sont arrondis dans l'autoconf !\n                     * on les arrondit respectivement  l'unit infrieure et suprieure\n                     * pour que les couches soient bien disponibles aux niveaux de zoom correspondants */\n                    // info : 6378137 * 2 * pi / 360 = rayon de la terre (ellipsoide WGS84)\n                    layerTileOptions.minResolution = (globalConstraints.minScale - 1) * 0.00028 * 180 / (Math.PI * 6378137);\n                    layerTileOptions.maxResolution = (globalConstraints.maxScale + 1) * 0.00028 * 180 / (Math.PI * 6378137);\n                }\n            }\n        }\n    }\n\n    // rcupration des autres paramtres passs par l'utilisateur\n    Utils.mergeParams(layerTileOptions, options.olParams);\n\n    // cration d'une ol.layer.Tile avec les options rcupres ci-dessus.\n    ol.layer.Tile.call(this, layerTileOptions);\n\n}\n\n// Inherits from ol.layer.Tile\nol.inherits(LayerWMTS, ol.layer.Tile);\n\n/*\n * @lends module:LayerWMTS\n */\nLayerWMTS.prototype = Object.create(ol.layer.Tile.prototype, {});\n\n/*\n * Constructor (alias)\n */\nLayerWMTS.prototype.constructor = LayerWMTS;\n\nexport default LayerWMTS;\n\n\n\n// WEBPACK FOOTER //\n// ./src/OpenLayers/Layers/LayerWMTS.js","import ol from \"ol\";\nimport Utils from \"../../Common/Utils\";\nimport Config from \"../../Common/Utils/Config\";\nimport LayerUtils from \"../../Common/Utils/LayerUtils\";\nimport SourceWMS from \"./SourceWMS\";\n\n/**\n * @classdesc\n * Geoportal LayerWMS source creation (inherit from ol.layer.Tile)\n *\n * @constructor\n * @extends {ol.layer.Tile}\n * @alias ol.layer.GeoportalWMS\n * @param {Object} options            - options for function call.\n * @param {String} options.layer      - Layer name (e.g. \"ORTHOIMAGERY.ORTHOPHOTOS\")\n * @param {Boolean} [options.ssl]     - if set true, enforce protocol https (only for nodejs)\n * @param {String} [options.apiKey]   - Access key to Geoportal platform\n * @param {Object} [options.olParams] - other options for ol.layer.Tile function (see {@link http://openlayers.org/en/latest/apidoc/ol.layer.Tile.html ol.layer.Tile})\n * @param {Object} [options.olParams.sourceParams] - other options for ol.source.TileWMS function (see {@link http://openlayers.org/en/latest/apidoc/ol.source.TileWMS.html ol.source.TileWMS})\n * @example\n * var layerWMS = new ol.layer.GeoportalWMS({\n *      layer  : \"ORTHOIMAGERY.ORTHOPHOTOS\"\n * });\n */\nfunction LayerWMS(options) {\n\n    if (!(this instanceof LayerWMS)) {\n        throw new TypeError(\"ERROR CLASS_CONSTRUCTOR\");\n    }\n\n    if (!options.layer) {\n        throw new Error(\"ERROR PARAM_MISSING : layer\");\n    }\n\n    if (typeof options.layer !== \"string\") {\n        throw new Error(\"ERROR WRONG TYPE : layer\");\n    }\n\n    // par defaut\n    if (typeof options.ssl === \"undefined\") {\n        options.ssl = false;\n    }\n\n    // Check if configuration is loaded\n    if (!Config.isConfigLoaded()) {\n        throw new Error(\"ERROR : contract key configuration has to be loaded to load Geoportal layers. See http://ignf.github.io/evolution-apigeoportail/ol3/ol3-autoconf.html\");\n    }\n\n    // cration de la source WMS\n    var olSourceParams;\n    if (options.olParams && options.olParams.sourceParams) {\n        olSourceParams = options.olParams.sourceParams;\n    }\n    var wmsSource = new SourceWMS({\n        layer: options.layer,\n        ssl: options.ssl,\n        apiKey: options.apiKey,\n        olParams: olSourceParams\n    });\n\n    var layerTileOptions = {\n        source: wmsSource\n    };\n\n    // si le param LAYERS n'a pas t renseign lors de la cration de la source,\n    // c'est que l'identifiant de la couche n'a pas t trouv. on passe donc la recherche des paramtres.\n    if (wmsSource.getParams().LAYERS !== undefined) {\n        // rcupration des autres paramtres ncessaires  la cration de la layer\n        var layerId = Config.getLayerId(options.layer, \"WMS\");\n        var globalConstraints = Config.getGlobalConstraints(layerId);\n\n        /* INFO : on ne rcupre l'emprise de la couche que lorsque que l'utilisateur spcifie la projection.\n           Si aucune projection n'est spcifie, il faudrait spcifier l'emprise dans la projection de la carte (car OpenLayers reprojette),\n           mais on ne peut pas la rcuprer  ce niveau. On ne spcifie donc aucune emprise.\n           Idem pour les rsolutions : il faut connaitre l'unit de la projection (metres ou degrs) pour pouvoir calculer la rsolution.\n        */\n        if (olSourceParams && olSourceParams.projection) {\n            // rcupration de l'tendue (en EPSG:4326), et reprojection dans la proj spcifie\n            var geobbox = [\n                globalConstraints.extent.left,\n                globalConstraints.extent.bottom,\n                globalConstraints.extent.right,\n                globalConstraints.extent.top\n            ];\n            layerTileOptions.extent = ol.proj.transformExtent(geobbox, \"EPSG:4326\", olSourceParams.projection);\n\n            // rcupration des rsolutions min et max\n            var p;\n            // on rcupre tout d'abord la projection\n            if (typeof olSourceParams.projection === \"string\") {\n                p = ol.proj.get(olSourceParams.projection);\n            } else if (typeof olSourceParams.projection === \"object\" && olSourceParams.projection.getCode()) {\n                p = ol.proj.get(olSourceParams.projection.getCode());\n            }\n            // puis, selon l'unit de la projection, on calcule la rsolution correspondante\n            if (p && p.getUnits()) {\n                if (p.getUnits() === \"m\") {\n                    /* fixme : fix temporaire pour grer les min/max scaledenominator qui sont arrondis dans l'autoconf !\n                     * on les arrondit respectivement  l'unit infrieure et suprieure\n                     * pour que les couches soient bien disponibles aux niveaux de zoom correspondants */\n                    // info : 1 pixel = 0.00028 m\n                    layerTileOptions.minResolution = (globalConstraints.minScale - 1) * 0.00028;\n                    layerTileOptions.maxResolution = (globalConstraints.maxScale + 1) * 0.00028;\n                } else if (p.getUnits() === \"degrees\") {\n                    /* fixme : fix temporaire pour grer les min/max scaledenominator qui sont arrondis dans l'autoconf !\n                     * on les arrondit respectivement  l'unit infrieure et suprieure\n                     * pour que les couches soient bien disponibles aux niveaux de zoom correspondants */\n                    // info : 6378137 * 2 * pi / 360 = rayon de la terre (ellipsoide WGS84)\n                    layerTileOptions.minResolution = (globalConstraints.minScale - 1) * 0.00028 * 180 / (Math.PI * 6378137);\n                    layerTileOptions.maxResolution = (globalConstraints.maxScale + 1) * 0.00028 * 180 / (Math.PI * 6378137);\n                }\n            }\n        }\n    }\n    // rcupration des autres paramtres passs par l'utilisateur\n    Utils.mergeParams(layerTileOptions, options.olParams);\n\n    // cration d'une ol.layer.Tile avec les options rcupres ci-dessus.\n    ol.layer.Tile.call(this, layerTileOptions);\n\n}\n\n// Inherits from ol.layer.Tile\nol.inherits(LayerWMS, ol.layer.Tile);\n\n/*\n * @lends module:LayerWMS\n */\nLayerWMS.prototype = Object.create(ol.layer.Tile.prototype, {});\n\n/*\n * Constructor (alias)\n */\nLayerWMS.prototype.constructor = LayerWMS;\n\nexport default LayerWMS;\n\n\n\n// WEBPACK FOOTER //\n// ./src/OpenLayers/Layers/LayerWMS.js","import ol from \"ol\";\nimport Gp from \"gp\";\nimport Proj4 from \"proj4\";\nimport Utils from \"../../Common/Utils\";\nimport GfiUtils from \"../GfiUtils\";\nimport SelectorID from \"../../Common/Utils/SelectorID\";\nimport GetFeatureInfoDOM from \"../../Common/Controls/GetFeatureInfoDOM\";\n\n/**\n * @classdesc\n * OpenLayers Control to manage getFeatureInfo capability. All queryable layers can be requested.\n * For the vector objects the information displayed are the objects properties. For the wms and wmts layers\n * this is the response of the getFeatureInfo request which is shown to the user.\n *\n * @constructor\n * @alias ol.control.GetFeatureInfo\n * @extends {ol.control.Control}\n * @param {Object} gfiOptions - control options\n * @param {Array.<Object>} [gfiOptions.layers] - list of layers which can be requested through the control. Each array element is an object, with following properties :\n * @param {ol.layer.Layer} gfiOptions.layers.obj - {@link http://openlayers.org/en/latest/apidoc/ol.layer.Layer.html ol.layer.Layer} layer handled by the control (that has been added to map).\n * @param {String} [gfiOptions.layers.event] - name of the mouse event triggering getFeatureInfo on this layer (that has been added to map). allowed values are : 'singleclick', 'dblclick' and 'contextmenu'. If not specified the triggering event is the current default event (see gfiOptions.options.defaultEvent).\n * @param {String} [gfiOptions.layers.infoFormat] - indicates the format mime-type of the response of GetFeatureInfo requests.\n * @param {Object} [gfiOptions.options] - custom options object to configure the control, with following properties :\n * @param {Boolean} [gfiOptions.options.hidden=false] - specifies if the widget should be hidden.\n * @param {Boolean} [gfiOptions.options.auto=false] - specifies if the control run in automatic mode. In automatic mode all vector layers added on run time or added at map initialization can be requested through the control. The triggering event of those layers is the default event.\n * @param {Boolean} [gfiOptions.options.active=true] - specifies if the control is active or inactive. In inactive mode requests are not fired and no information are displayed.\n * @param {String} [gfiOptions.options.defaultEvent='singleclick'] - default triggering event chosen in the list ('singleclick', 'dblclick', 'contextmenu'). This is the triggering event of all layers added to the control without configured triggering event.\n * @param {String} [gfiOptions.options.defaultInfoFormat='text/html'] - indicates the default format mime-type of the response of GetFeatureInfo requests.\n * @param {String} [gfiOptions.options.cursorStyle='pointer'] - specifies the type of cursor to be displayed when pointing on vector feature of a layer previously added to the control. The value must be choosen in the possible values of the css cursor property.\n * @param {String} [gfiOptions.options.proxyUrl] - Proxy URL to avoid cross-domain problems.\n * @param {Array.<String>} [gfiOptions.options.noProxyDomains] - Proxy will not be used for this list of domain names. Only use if you know what you're doing.\n * @param {Boolean} [gfiOptions.options.autoPan = true] - Specifies whether the map should auto-pan if the pop-up is rendered outside of the canvas. Defaults to true.\n * @param {olx.OverlayPanOptions} [gfiOptions.options.autoPanAnimation] - Used to customize the auto-pan animation. See {@link https://openlayers.org/en/latest/apidoc/olx.html#.OverlayPanOptions olx.OverlayPanOptions}.\n * @param {Number} [gfiOptions.options.autoPanMargin] - Margin (in pixels) between the pop-up and the border of the map when autopanning. Default is 20.\n */\nfunction GetFeatureInfo(gfiOptions) {\n\n    gfiOptions = gfiOptions || {};\n    var options = gfiOptions.options || {};\n    var layers = gfiOptions.layers || [];\n\n    if (!(this instanceof GetFeatureInfo)) {\n        throw new TypeError(\"ERROR CLASS_CONSTRUCTOR\");\n    }\n\n    if (layers && !Array.isArray(layers)) {\n        throw new Error(\"ERROR WRONG_TYPE : layers should be an array\");\n    }\n\n    if (options && typeof options !== \"object\") {\n        throw new Error(\"ERROR WRONG_TYPE : options should be an object\");\n    }\n\n    this._initialize(options, layers);\n\n    // init control DOM container\n    var container = this._initContainer(options);\n\n    // call ol.control.Control constructor\n    ol.control.Control.call(this, {\n        element: container,\n        target: options.target,\n        render: options.render\n    });\n};\n\n// Inherits from ol.control.Control\nol.inherits(GetFeatureInfo, ol.control.Control);\n\n/**\n * @lends module:GetFeatureInfo\n */\nGetFeatureInfo.prototype = Object.create(ol.control.Control.prototype, {});\n\n// on rcupre les mthodes de la classe commune GetFeatureInfoDOM\nUtils.assign(GetFeatureInfo.prototype, GetFeatureInfoDOM);\n\n/**\n * Constructor (alias)\n *\n * @private\n */\nGetFeatureInfo.prototype.constructor = GetFeatureInfo;\n\n// ################################################################### //\n// ######################## initialize control ####################### //\n// ################################################################### //\n\n/**\n * Initializes GetFeatureInfo control (called by constructor)\n *\n * @param {Object} options - General options of the control set by user.\n * @param {Array.<Object>} layers - Array of ol layers with their configuration options (obj, event, infoFormat)\n * @private\n */\nGetFeatureInfo.prototype._initialize = function(options, layers) {\n\n    // identifiant du contrle : utile pour suffixer les identifiants CSS (pour grer le cas o il y en a plusieurs dans la mme page)\n    this._uid = SelectorID.generate();\n\n    // List of triggering events associated to a boolean indicating if the event is listened (there must be\n    // almost one layer having this triggering event configured)\n    this._events = {\n        dblclick: false,\n        singleclick: false,\n        contextmenu: false\n    };\n\n    // Object associating a event (key) to his handler (value) in order to unlisten events which have\n    // no more layers related to.\n    this._eventsHandler = {};\n\n    if (typeof options.auto !== \"undefined\" && typeof options.auto !== \"boolean\") {\n        console.log(\"[ERROR] GetFeatureInfo:_initialize - auto parameter should be a boolean\");\n        return;\n    }\n    this._auto = options.auto || false;\n\n    if (typeof options.active !== \"undefined\" && typeof options.active !== \"boolean\") {\n        console.log(\"[ERROR] GetFeatureInfo:_initialize - active parameter should be a boolean\");\n        return;\n    }\n    this._active = (typeof options.active === \"undefined\") ? true : options.active;\n\n    if (options.defaultEvent && typeof options.defaultEvent !== \"string\") {\n        console.log(\"[ERROR] GetFeatureInfo:_initialize - defaultEvent parameter should be a string\");\n        return;\n    }\n    this._defaultEvent = options.defaultEvent || \"singleclick\";\n    if (!this._isValidEvent(this._defaultEvent)) {\n        console.log(\"[ERROR] GetFeatureInfo:_initialize - _defaultEvent '\" + this._defaultEvent + \"' is not a valid event\");\n        return;\n    }\n\n    if (options.defaultInfoFormat && typeof options.defaultInfoFormat !== \"string\") {\n        console.log(\"[ERROR] GetFeatureInfo:_initialize - defaultInfoFormat parameter should be a string\");\n        return;\n    }\n    this._defaultInfoFormat = options.defaultInfoFormat || \"text/html\";\n\n    if (options.cursorStyle && typeof options.cursorStyle !== \"string\") {\n        console.log(\"[ERROR] GetFeatureInfo:_initialize - cursorStyle parameter should be a string\");\n        return;\n    }\n    this._cursorStyle = options.cursorStyle || \"pointer\";\n\n    if (options.proxyUrl) {\n        if (typeof options.proxyUrl !== \"string\") {\n            console.log(\"[ERROR] GetFeatureInfo:_initialize - proxyUrl parameter should be a string\");\n            return;\n        }\n        this._proxyUrl = options.proxyUrl;\n    }\n\n    if (options.noProxyDomains) {\n        if (!Array.isArray(options.noProxyDomains)) {\n            console.log(\"[ERROR] GetFeatureInfo:_initialize - noProxyDomains parameter should be a array\");\n            return;\n        }\n        this._noProxyDomains = options.noProxyDomains;\n    }\n\n    if (typeof options.autoPan !== \"undefined\" && typeof options.autoPan !== \"boolean\") {\n        console.log(\"[ERROR] GetFeatureInfo:_initialize - autoPan parameter should be a boolean\");\n        return;\n    }\n    this._autoPan = (typeof options.autoPan === \"undefined\") ? true : options.autoPan;\n\n    if (options.autoPanAnimation) {\n        if (options.autoPanAnimation.duration) {\n            if (typeof options.autoPanAnimation.duration !== \"number\") {\n                console.log(\"[ERROR] GetFeatureInfo:_initialize - autoPanAnimation parameter is invalid : duration should be a number.\");\n                return;\n            }\n        }\n\n        if (options.autoPanAnimation.easing) {\n            if (typeof options.autoPanAnimation.easing !== \"function\") {\n                console.log(\"[ERROR] GetFeatureInfo:_initialize - autoPanAnimation parameter is invalid : easing should be a ol.easing function or a custom function.\");\n                return;\n            }\n        }\n        this._autoPanAnimation = options.autoPanAnimation;\n    }\n\n    if (options.autoPanMargin) {\n        if (typeof options.autoPanMargin !== \"number\") {\n            console.log(\"[ERROR] GetFeatureInfo:_initialize - autoPanMargin parameter should be a number\");\n            return;\n        }\n        this._autoPanMargin = options.autoPanMargin;\n    }\n\n    // {Object} control layers list.\n    if (!Array.isArray(layers)) {\n        console.log(\"[ERROR] GetFeatureInfo:_initialize - layers parameter should be an array\");\n        return;\n    }\n    this._setLayers(layers);\n\n    // {Object} control panel container (DOM Element)\n    this._activateGetFeatureInfoContainer = null;\n};\n\n/**\n * Binds map to control.\n *\n * @param {ol.Map} map - Map.\n */\nGetFeatureInfo.prototype.setMap = function(map) {\n    if (map) {\n        // on active les evenements (si des couches sont configurees)\n        this._updateEvents(map);\n\n        if (this._cursorStyle && this._active) {\n            this._activateCursor(true, map);\n        }\n\n        map.getLayers().on(\n            \"remove\",\n            function(evt) {\n                for (var i = 0; i < this._layers.length; ++i) {\n                    if (this._layers[i].obj === evt.element) {\n                        this._layers.splice(i, 1);\n                        break;\n                    }\n                }\n                this._updateEvents(map);\n            },\n            this\n        );\n\n        if (this._auto) {\n            // ajout des couches vecteur deja dans la carte\n            var updated = false;\n            map.getLayers().forEach(function(olLayer) {\n                    var layerFormat = GfiUtils.getLayerFormat(olLayer);\n                    if (!this._hasLayer(olLayer) && layerFormat == \"vector\") {\n                        this._layers.push({\n                            obj: olLayer\n                        });\n                        updated = true;\n                    }\n                },\n                this\n            );\n\n            if (updated) {\n                this._updateEvents(map);\n            }\n\n            map.getLayers().on(\n                \"add\",\n                function(evt) {\n                    var layerFormat = GfiUtils.getLayerFormat(evt.element);\n                    if (layerFormat == \"vector\") {\n                        this._layers.push({\n                            obj: evt.element\n                        });\n                    }\n                    this._updateEvents(map);\n                },\n                this\n            );\n        }\n    } else {\n        this._clearEvents();\n        this._activateCursor(false);\n    }\n\n    // call original setMap method\n    ol.control.Control.prototype.setMap.call(this, map);\n};\n\n// ################################################################### //\n// #################### user interface methods ####################### //\n// ################################################################### //\n\n/**\n * Gets the list of layers already added to the map and attached to the control.\n *\n * @returns {Array.<Object>} gfiLayers List of layers.\n * @returns {ol.layer.Layer} gfiLayers.obj {@link http://openlayers.org/en/latest/apidoc/ol.layer.Layer.html ol.layer.Layer} layer handled by the control (that has been added to map).\n * @returns {String} gfiLayers.event Optional. Name of the mouse event triggering getFeatureInfo on this layer (that has been added to map). allowed values are : 'singleclick', 'dblclick' and 'contextmenu'.\n * @returns {String} gfiLayers.infoFormat Optional. Indicates the format mime-type of the response of GetFeatureInfo requests.\n */\nGetFeatureInfo.prototype.getLayers = function() {\n    return this._layers;\n};\n\n/**\n * Sets the default event applied to layer with no triggering event configured.\n * This can be set on run time.\n *\n * @param {String} eventName - name of the mouse event chosen in the list : 'singleclick', 'dblclick', 'contextmenu'.\n */\nGetFeatureInfo.prototype.setDefaultEvent = function(eventName) {\n    if (typeof eventName !== \"string\") {\n        console.log(\"[ERROR] GetFeatureInfo:setDefaultEvent - eventName parameter should be a string\");\n        return;\n    }\n    if (!eventName || !this._isValidEvent(eventName)) {\n        console.log(\"[ERROR] GetFeatureInfo:setDefaultEvent - event '\" + eventName + \"' is not allowed.\");\n        return;\n    }\n\n    this._defaultEvent = eventName;\n    this._updateEvents();\n};\n\n/**\n * Sets the cursor style when hovering vector layers features.\n *\n * @param {String} cursorStyle - cursor style. The value must be choosen in the possible values of the css cursor property.\n */\nGetFeatureInfo.prototype.setCursorStyle = function(cursorStyle) {\n    if (typeof cursorStyle !== \"string\") {\n        console.log(\"[ERROR] GetFeatureInfo:setCursorStyle - cursorStyle parameter should be a string\");\n        return;\n    }\n    if (this._active) {\n        if (!this._cursorStyle && cursorStyle) {\n            this._activateCursor(true);\n        } else if (this._cursorStyle && !cursorStyle) {\n            this._activateCursor(false);\n        }\n    }\n    this._cursorStyle = cursorStyle;\n};\n\n/**\n * Sets active control property\n *\n * @param {Boolean} active - specify the value the active property must be set to.\n */\nGetFeatureInfo.prototype.setActive = function(active) {\n    this._setActive(active);\n    var element = document.getElementById(this._addUID(\"GPactivateGetFeatureInfo\"));\n    if (element) {\n        element.checked = active;\n    }\n};\n\n/**\n * Sets active control property\n *\n * @param {Boolean} active - specify the value the active property must be set to.\n *\n * @private\n */\nGetFeatureInfo.prototype._setActive = function(active) {\n    if (typeof active !== \"boolean\") {\n        console.log(\"[ERROR] GetFeatureInfo:_setActive - active parameter should be a boolean\");\n        return;\n    }\n    if (this._active === active) {\n        return;\n    }\n    this._active = active;\n    if (this._cursorStyle) {\n        this._activateCursor(active);\n    }\n};\n\n/**\n * Gets active control property\n *\n * @return {Boolean} active\n */\nGetFeatureInfo.prototype.isActive = function() {\n    return this._active;\n};\n\n/**\n * Hides/displays widget\n *\n * @param {Boolean} hidden - specify if the widget must be hidden\n */\nGetFeatureInfo.prototype.setHidden = function(hidden) {\n    this.element.style.visibility = (hidden) ? \"hidden\" : \"\";\n};\n\n/**\n * Indicates if the widget is hidden\n *\n * @return {Boolean} hidden\n */\nGetFeatureInfo.prototype.isHidden = function() {\n    return this.element.style.visibility == \"hidden\";\n};\n\n/**\n * Set the layers list the control is attached to. Listened events are updated according to this list.\n *\n * @param {Array.<Object>} gfiLayers - list of layers which can be requested through the control.\n * @param {ol.layer.Layer} gfiLayers.obj - {@link http://openlayers.org/en/latest/apidoc/ol.layer.Layer.html ol.layer.Layer} layer handled by the control (that has been added to map).\n * @param {String} [gfiLayers.event] - Name of the mouse event triggering getFeatureInfo on this layer (that has been added to map). allowed values are : 'singleclick', 'dblclick' and 'contextmenu'.\n * @param {String} [gfiLayers.infoFormat] - Indicates the format mime-type of the response of GetFeatureInfo requests.\n */\nGetFeatureInfo.prototype.setLayers = function(gfiLayers) {\n    this._setLayers(gfiLayers);\n    this._updateEvents();\n};\n\n/**\n * Indicates if an event is allowed\n * @param {String} eventName - name of the mouse event chosen in the list : 'singleclick', 'dblclick', 'contextmenu'.\n * @returns {Boolean}\n *\n * @private\n */\nGetFeatureInfo.prototype._isValidEvent = function(eventName) {\n    return Object.keys(this._events).indexOf(eventName) > -1;\n};\n\n/**\n * Adds an event listener to the specified event.\n *\n * @param {String} eventName - name of the mouse event chosen in the list : 'singleclick', 'dblclick', 'contextmenu'.\n * @param {Object} map - map on wich event are attached.\n *\n * @private\n */\nGetFeatureInfo.prototype._activateEvent = function(eventName, map) {\n    var gfiObj = this;\n\n    /**\n     * getFeatureInfoHandler\n     */\n    var getFeatureInfoHandler = function(e) {\n        GfiUtils.onDisplayFeatureInfo(e, gfiObj);\n    };\n\n    if (eventName == \"contextmenu\") {\n        map.getViewport().addEventListener(\n            eventName,\n            getFeatureInfoHandler\n        );\n    } else {\n        map.on(\n            eventName,\n            getFeatureInfoHandler\n        );\n    }\n\n    this._eventsHandler[eventName] = getFeatureInfoHandler;\n\n    this._events[eventName] = true;\n};\n\n/**\n * Unlistens the specified event.\n * @param {String} eventName - name of the mouse event chosen in the list : 'singleclick', 'dblclick', 'contextmenu'.\n * @param {Object} map - map on wich event are attached.\n *\n * @private\n */\nGetFeatureInfo.prototype._deactivateEvent = function(eventName, map) {\n    if (eventName == \"contextmenu\") {\n        map.getViewport().removeEventListener(\n            eventName,\n            this._eventsHandler[eventName]\n        );\n    } else {\n        map.un(\n            eventName,\n            this._eventsHandler[eventName]\n        );\n    }\n\n    delete this._eventsHandler[eventName];\n\n    this._events[eventName] = false;\n};\n\n/**\n * Updates the listener (listen/unlisten) in accordance with the layers attached to the control and their triggering events.\n *\n * @param {Object} map - map on wich event are attached.\n *\n * @private\n */\nGetFeatureInfo.prototype._updateEvents = function(map) {\n    if (!map) {\n        map = this.getMap();\n    }\n    var sEvent = [];\n    for (var i = 0; i < this._layers.length; ++i) {\n        var event = (this._layers[i].event) ? this._layers[i].event : this._defaultEvent;\n        if (sEvent.indexOf(event) < 0) {\n            sEvent.push(event);\n        }\n    }\n\n    for (var eventName in this._events) {\n        if (!this._events[eventName] && sEvent.indexOf(eventName) >= 0) {\n            this._activateEvent(eventName, map);\n        } else if (this._events[eventName] && sEvent.indexOf(eventName) < 0) {\n            this._deactivateEvent(eventName, map);\n        }\n    }\n};\n\n/**\n * Clears all the listeners.\n *\n * @private\n */\nGetFeatureInfo.prototype._clearEvents = function() {\n    var map = this.getMap();\n    for (var eventName in this._events) {\n        if (this._events[eventName]) {\n            this._deactivateEvent(eventName, map);\n        }\n    }\n};\n\n/**\n * Indicates if the control has the specified layer attached\n * @param {ol.layer.Layer} olLayer - layer openlayers\n * @returns {Boolean}\n *\n * @private\n */\nGetFeatureInfo.prototype._hasLayer = function(olLayer) {\n    for (var i = 0; i < this._layers.length; ++i) {\n        if (this._layers[i].obj === olLayer) {\n            return true;\n        }\n    }\n    return false;\n};\n\n/**\n * Listens/unlistens 'pointermove' event displaying specific cursor style when hovering vector features\n *\n * @param {Boolean} activate - specify if the control must be activated or deactivated\n * @param {Object} map - map on wich cursor is attached.\n *\n * @private\n */\nGetFeatureInfo.prototype._activateCursor = function(activate, map) {\n    if (!map) {\n        map = this.getMap();\n    }\n\n    if (activate) {\n        if (this._eventsHandler.hasOwnProperty(\"pointermove\")) {\n            console.log(\"[ERROR] _activateCursor - inconsistent state: pointermove event handler already registered\");\n            return;\n        }\n        var gfiObj = this;\n\n        /**\n         * displayCursor\n         */\n        var displayCursor = function(evt) {\n            var hit = map.forEachFeatureAtPixel(evt.pixel, function(feature, layer) {\n                // on ne prend en compte que les couches vecteurs connues du controle\n                var gfiLayers = gfiObj.getLayers();\n                for (var m = 0; m < gfiLayers.length; ++m) {\n                    if (gfiLayers[m].obj === layer) {\n                        return true;\n                    }\n                }\n            });\n            if (hit) {\n                map.getTargetElement().style.cursor = gfiObj._cursorStyle;\n            } else {\n                map.getTargetElement().style.cursor = \"\";\n            }\n        };\n\n        this._eventsHandler[\"pointermove\"] = displayCursor;\n        map.on(\"pointermove\", displayCursor);\n    } else {\n        map.un(\"pointermove\", this._eventsHandler[\"pointermove\"]);\n        delete this._eventsHandler[\"pointermove\"];\n        map.getTargetElement().style.cursor = \"\";\n    }\n};\n\n/**\n * Sets the layers list the control is attached to.\n * @param {Array.<Object>} gfiLayers - list of layers which can be requested through the control.\n *\n * @private\n */\nGetFeatureInfo.prototype._setLayers = function(gfiLayers) {\n    if (!gfiLayers || !Array.isArray(gfiLayers)) {\n        console.log(\"[ERROR] GetFeatureInfo:setLayers - gfiLayers parameter should be a array\");\n        return;\n    }\n    this._layers = [];\n\n    for (var i = 0; i < gfiLayers.length; ++i) {\n        var ind = this._layers.push({}) - 1;\n\n        if (gfiLayers[i].event) {\n            if (!this._isValidEvent(gfiLayers[i].event)) {\n                console.log(\"[ERROR] GetFeatureInfo:setLayers - layer event '\" + this._layers[i].event + \"' is not allowed.\");\n            } else {\n                this._layers[ind].event = gfiLayers[i].event;\n            }\n        }\n\n        if (gfiLayers[i].infoFormat) {\n            this._layers[ind].infoFormat = gfiLayers[i].infoFormat;\n        }\n\n        this._layers[ind].obj = gfiLayers[i].obj;\n    }\n};\n\n// ################################################################### //\n// ######################## methods handle dom ####################### //\n// ################################################################### //\n\n/**\n * This method is called by event 'change' on 'GPactivateGetFeatureInfo'\n * tag select (cf. this._createActivateGetFeatureInfoElement).\n *\n * @method onActivateGetFeatureInfoElementChange\n * @param {Object} e - HTMLElement\n *\n * @private\n */\nGetFeatureInfo.prototype.onActivateGetFeatureInfoElementChange = function(e) {\n    this._setActive(e.target.checked);\n};\n\n/**\n * Creates control main container (called by GetFeatureInfo constructor)\n * @param {Object} [options] - options object to configure the widget :\n * @param {Boolean} [options.hidden] - specifies if the widget should be hidden.\n *\n * @method _initContainer\n *\n * @private\n */\nGetFeatureInfo.prototype._initContainer = function(options) {\n    // creation du container principal\n    var container = this._createMainContainerElement();\n\n    var inputActivate = this._activateGetFeatureInfoContainer = this._createActivateGetFeatureInfoElement(this.isActive());\n    container.appendChild(inputActivate);\n\n    // ajout dans le container principal du picto du controle\n    var picto = this._createMainPictoElement();\n    container.appendChild(picto);\n\n    if (typeof options.hidden !== \"undefined\") {\n        if (typeof options.hidden !== \"boolean\") {\n            console.log(\"[ERROR] GetFeatureInfo:_initContainer - hidden parameter should be a boolean\");\n            return;\n        }\n        if (options.hidden) {\n            container.style.visibility = \"hidden\";\n        }\n    }\n\n    return container;\n};\n\nexport default GetFeatureInfo;\n\n\n\n// WEBPACK FOOTER //\n// ./src/OpenLayers/Controls/GetFeatureInfo.js","var GetFeatureInfoDOM = {\n\n    /** Add uuid to the tag ID */\n    _addUID: function(id) {\n        var uid = (this._uid) ? id + \"-\" + this._uid : id;\n        return uid;\n    },\n\n    /**\n     * Main container (DOM)\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createMainContainerElement: function() {\n\n        var container = document.createElement(\"div\");\n        container.id = this._addUID(\"GPgetFeatureInfo\");\n        container.className = \"GPwidget\";\n        return container;\n    },\n\n    // ################################################################### //\n    // ################# Methods to display Main Panel ################### //\n    // ################################################################### //\n\n    /**\n     * Hidden checkbox for activating getFeatureInfo\n     * @param {Boolean} activate - specify if the control is active or inactive\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createActivateGetFeatureInfoElement: function(activate) {\n\n        // contexte d'execution\n        var context = this;\n\n        var input = document.createElement(\"input\");\n        input.id = this._addUID(\"GPactivateGetFeatureInfo\");\n        input.type = \"checkbox\";\n        input.checked = activate;\n\n        input.addEventListener(\"change\", function(e) {\n            context.onActivateGetFeatureInfoElementChange(e);\n        });\n\n        return input;\n    },\n\n    /**\n     * Creation du container du picto du controle (DOM)\n     */\n    _createMainPictoElement: function() {\n\n        var self = this;\n\n        var label = document.createElement(\"label\");\n        label.id = this._addUID(\"GPgetFeatureInfoPicto\");\n        label.className = \"GPshowAdvancedToolPicto\";\n        label.htmlFor = this._addUID(\"GPactivateGetFeatureInfo\");\n        label.title = \"activer/desactiver l'interrogation des couches\";\n\n        var spanOpen = document.createElement(\"span\");\n        spanOpen.id = this._addUID(\"GPgetFeatureInfoActivate\");\n        spanOpen.className = \"GPshowAdvancedToolOpen\";\n        label.appendChild(spanOpen);\n\n        var spanClose = document.createElement(\"span\");\n        spanClose.id = self._addUID(\"GPgetFeatureInfoDeactivate\");\n        label.appendChild(spanClose);\n\n        return label;\n    }\n};\n\nexport default GetFeatureInfoDOM;\n\n\n\n// WEBPACK FOOTER //\n// ./src/Common/Controls/GetFeatureInfoDOM.js","import ol from \"ol\";\nimport Gp from \"gp\";\nimport Logger from \"../../Common/Utils/LoggerByDefault\";\nimport Utils from \"../../Common/Utils\";\nimport Markers from \"./Utils/Markers\";\nimport RightManagement from \"../../Common/Utils/CheckRightManagement\";\nimport SelectorID from \"../../Common/Utils/SelectorID\";\nimport SearchEngineUtils from \"../../Common/Utils/SearchEngineUtils\";\nimport SearchEngineDOM from \"../../Common/Controls/SearchEngineDOM\";\n\n\nvar logger = Logger.getLogger(\"searchengine\");\n\n/**\n * @classdesc\n * SearchEngine control\n *\n * @constructor\n * @extends {ol.control.Control}\n * @alias ol.control.SearchEngine\n * @param {Object}  options - control options\n * @param {String}   [options.apiKey] - API key, mandatory if autoconf service has not been charged in advance\n * @param {Boolean} [options.collapsed = true] - collapse mode, true by default\n * @param {Object}   [options.resources] - resources to be used by geocode and autocompletion services :\n * @param {Array}   [options.resources.geocode] - resources geocoding, by default : [\"PositionOfInterest\", \"StreetAddress\"]\n * @param {Array}   [options.resources.autocomplete] - resources autocompletion, by default : [\"PositionOfInterest\", \"StreetAddress\"]\n * @param {Boolean}  [options.displayAdvancedSearch = true] - False to disable advanced search tools (it will not be displayed). Default is true (displayed)\n * @param {Object}  [options.advancedSearch] - advanced search options for geocoding (filters). Properties can be found among geocode options.filterOptions (see {@link http://ignf.github.io/geoportal-access-lib/latest/jsdoc/module-Services.html#~geocode Gp.Services.geocode})\n * @param {Object}  [options.geocodeOptions = {}] - options of geocode service (see {@link http://ignf.github.io/geoportal-access-lib/latest/jsdoc/module-Services.html#~geocode Gp.Services.geocode})\n * @param {Object}  [options.autocompleteOptions = {}] - options of autocomplete service (see {@link http://ignf.github.io/geoportal-access-lib/latest/jsdoc/module-Services.html#~autoComplete Gp.Services.autoComplete}\n * @param {Object}  [options.autocompleteOptions.serviceOptions] - options of autocomplete service\n * @param {Boolean} [options.autocompleteOptions.triggerGeocode = false] - trigger a geocoding request if the autocompletion does not return any suggestions, false by default\n * @param {Number}  [options.autocompleteOptions.triggerDelay = 1000] - waiting time before sending the geocoding request, 1000ms by default\n * @param {Sting|Numeric|Function} [options.zoomTo] - zoom to results, by default, current zoom.\n *       Value possible : auto or zoom level.\n *       Possible to overload it with a function :\n *       zoomTo : function (info) {\n *           // do some stuff...\n *           return zoom;\n *       }\n * @param {String}  [options.placeholder] - Placeholder in search bar. Default is \"Rechercher un lieu, une adresse\".\n * @param {Boolean}  [options.displayMarker = true] - set a marker on search result, defaults to true.\n * @param {String}  [options.markerStyle = \"lightOrange\"] - Marker style. Currently possible values are \"lightOrange\" (default value), \"darkOrange\", \"red\" and \"turquoiseBlue\".\n * @example\n *  var SearchEngine = ol.control.SearchEngine({\n *      apiKey : \"CLEAPI\",\n *      collapsed : true,\n *      resources : {\n *          geocode : [\"StreetAddress\", \"PositionOfInterest\"],\n *          autocomplete : [\"StreetAddress\"]\n *      },\n *      advancedSearch : {\n *          PositionOfInterest : [{name : \"municipality\", title : \"Ville\"}],\n *          StreetAddress : [{...}]\n *      },\n *      geocodeOptions : {},\n *      autocompleteOptions : {}\n *  });\n */\nfunction SearchEngine(options) {\n\n    options = options || {};\n\n    if (!(this instanceof SearchEngine)) {\n        throw new TypeError(\"ERROR CLASS_CONSTRUCTOR\");\n    }\n\n    // initialisation du composant\n    this.initialize(options);\n\n    // // Widget main DOM container\n    this._container = this._initContainer();\n    // info: le container sera complt lors de l'ajout  la carte (setMap), car certains composants ncessitent d'tre lis  la map.\n    this._containerElement = null;\n\n    // on peut ventuellement encapsuler le composant dans une div passe par l'utilisateur\n    if (options.element && options.element.appendChild) {\n        // dans ce cas on stocke les deux container\n        options.element.appendChild(this._container);\n        this._containerElement = options.element;\n    }\n\n    // call ol.control.Control constructor\n    ol.control.Control.call(this, {\n        element: this._containerElement || this._container,\n        target: options.target,\n        render: options.render\n    });\n\n};\n\n// Inherits from ol.control.Control\nol.inherits(SearchEngine, ol.control.Control);\n\n/*\n * @lends module:SearchEngine\n */\nSearchEngine.prototype = Object.create(ol.control.Control.prototype, {});\n\n// on rcupre les mthodes de la classe commune IsoDOM\nUtils.assign(SearchEngine.prototype, SearchEngineDOM);\n\n/**\n * Constructor (alias)\n *\n * @private\n */\nSearchEngine.prototype.constructor = SearchEngine;\n\n// ################################################################### //\n// ##################### public methods ############################## //\n// ################################################################### //\n\n/**\n * Overwrite OpenLayers setMap method\n *\n * @param {ol.Map} map - Map.\n */\nSearchEngine.prototype.setMap = function(map) {\n\n    if (!map) {\n        this._clearResults();\n    }\n\n    // on appelle la mthode setMap originale d'OpenLayers\n    ol.control.Control.prototype.setMap.call(this, map);\n\n};\n\n/**\n * Returns true if widget is collapsed (minimized), false otherwise\n *\n * @returns {Boolean} collapsed - true if widget is collapsed\n */\nSearchEngine.prototype.getCollapsed = function() {\n    return this.collapsed;\n};\n\n/**\n * Collapse or display widget main container\n *\n * @param {Boolean} collapsed - True to collapse widget, False to display it\n */\nSearchEngine.prototype.setCollapsed = function(collapsed) {\n    if (collapsed === undefined) {\n        console.log(\"[ERROR] SearchEngine:setCollapsed - missing collapsed parameter\");\n        return;\n    }\n    if ((collapsed && this.collapsed) || (!collapsed && !this.collapsed)) {\n        return;\n    }\n    if (collapsed) {\n        this._showSearchEngineInput.click();\n    } else {\n        this._showSearchEngineInput.click();\n    }\n    this.collapsed = collapsed;\n};\n\n// ################################################################### //\n// ##################### init component ############################## //\n// ################################################################### //\n\n/**\n * Initialize SearchEngine control (called by SearchEngine constructor)\n *\n * @param {Object} options - constructor options\n * @private\n */\nSearchEngine.prototype.initialize = function(options) {\n\n    this._checkInputOptions(options);\n\n    // define default options\n    this.options = {\n        collapsed: true,\n        zoomTo: \"\",\n        resources: {\n            geocode: [],\n            autocomplete: []\n        },\n        displayAdvancedSearch: true,\n        advancedSearch: {},\n        geocodeOptions: {},\n        autocompleteOptions: {\n            serviceOptions: {},\n            triggerGeocode: false,\n            triggerDelay: 1000\n        },\n        displayMarker: true,\n        markerStyle: \"lightOrange\",\n        placeholder: \"Rechercher un lieu, une adresse\"\n    };\n\n    // merge with user options\n    Utils.mergeParams(this.options, options);\n    if (this.options.resources.geocode.length === 0) {\n        this.options.resources.geocode = [\"PositionOfInterest\", \"StreetAddress\"];\n    }\n    if (this.options.resources.autocomplete.length === 0) {\n        this.options.resources.autocomplete = [\"PositionOfInterest\", \"StreetAddress\"];\n    }\n\n    /** {Boolean} specify if searchEngine control is collapsed (true) or not (false) */\n    this.collapsed = this.options.collapsed;\n\n    // identifiant du contrle : utile pour suffixer les identifiants CSS (pour grer le cas o il y en a plusieurs dans la mme page)\n    this._uid = SelectorID.generate();\n\n    this._showSearchEngineInput = null;\n\n    // container de l'input de recherche\n    this._inputSearchContainer = null;\n\n    // container des reponses de l'autocompletion\n    this._autocompleteContainer = null;\n    this._suggestedContainer = null;\n\n    // listes des reponses de l'autocompletion\n    this._suggestedLocations = [];\n\n    // container des reponses du geocodage\n    this._geocodedContainer = null;\n\n    // liste des reponses du geocodage\n    this._geocodedLocations = [];\n\n    // container des filtres du geocodage\n    this._filterContainer = null;\n\n    // ressource de geocodage selectionne pour le geocodage avanc\n    this._currentGeocodingCode = null;\n\n    // localisant */\n    this._currentGeocodingLocation = null;\n\n    // liste des filtres du geocodage pour le geocodage avanc\n    this._advancedSearchFilters = {};\n    this._initAdvancedSearchFilters();\n\n    // liste des ressources du geocodage pour le geocodage avanc\n    this._advancedSearchCodes = [];\n    this._initAdvancedSearchCodes();\n\n    // marker\n    this._marker = null;\n\n    // marker style\n    var _markerStyle = this.options.markerStyle;\n    this._markerUrl = (Object.keys(Markers).indexOf(_markerStyle) === -1) ? Markers[\"lightOrange\"] : Markers[_markerStyle];\n\n    // marker display\n    this._displayMarker = this.options.displayMarker;\n\n    // popup\n    this._popupContent = null;\n    this._popupDiv = this._initPopupDiv();\n    this._popupOverlay = null;\n\n    // ressources des services d'autocompletion et de geocodage\n    this._servicesRightManagement = {};\n\n    /*\n     * Droit sur les ressources sur les services.\n     * Par defaut, on n'en s'occupe pas\n     * sauf si l'autoconfiguration est charge !\n     */\n    this._noRightManagement = false;\n\n    // gestion des droits sur les ressources/services\n    this._checkRightsManagement();\n\n    // trigger geocode\n    this._triggerHandler = null;\n};\n\n/**\n * this method is called by this.initialize()\n * and makes sure input options are correctly formated\n *\n * @private\n */\nSearchEngine.prototype._checkInputOptions = function(options) {\n    var i;\n\n    if (options.resources) {\n        // on vrifie que resources est bien un objet\n        if (typeof options.resources === \"object\") {\n\n            // ressources de geocodage\n            var geocodeResources = options.resources.geocode;\n            if (geocodeResources) {\n                // on vrifie que la liste des ressources de geocodage est bien un tableau\n                if (!Array.isArray(geocodeResources)) {\n                    console.log(\"[SearchEngine] 'options.resources.geocode' parameter should be an array\");\n                    geocodeResources = null;\n                }\n                var geocodeResourcesList = [\"StreetAddress\", \"PositionOfInterest\", \"CadastralParcel\", \"Administratif\"];\n                for (i = 0; i < geocodeResources.length; i++) {\n                    if (geocodeResourcesList.indexOf(geocodeResources[i]) === -1) {\n                        // si la resource n'est pas rfrence, on l'enlve\n                        // geocodeResources.splice(i, 1);\n                        console.log(\"[SearchEngine] options.resources.geocode : \" + geocodeResources[i] + \" is not a resource for geocode\");\n                    }\n                }\n            }\n\n            // ressources d'autocompletion\n            var autocompleteResources = options.resources.autocomplete;\n            if (autocompleteResources) {\n                // on vrifie que la liste des ressources d'autocompletion est bien un tableau\n                if (!Array.isArray(autocompleteResources)) {\n                    console.log(\"[SearchEngine] 'options.resources.autocomplete' parameter should be an array\");\n                    autocompleteResources = null;\n                }\n                var autocompleteResourcesList = [\"StreetAddress\", \"PositionOfInterest\"];\n                for (i = 0; i < autocompleteResources.length; i++) {\n                    if (autocompleteResourcesList.indexOf(autocompleteResources[i]) === -1) {\n                        // si la resource n'est pas rfrence, on l'enlve\n                        // autocompleteResources.splice(i, 1);\n                        console.log(\"[SearchEngine] options.resources.autocomplete : \" + autocompleteResources[i] + \" is not a resource for autocomplete\");\n                    }\n                }\n            }\n        } else {\n            console.log(\"[SearchEngine] 'resources' parameter should be an object\");\n            options.resources = null;\n        }\n    }\n\n};\n\n/**\n * this method is called by this.initialize()\n * and initialize the geocoding resources titles.\n *\n * @private\n */\nSearchEngine.prototype._initAdvancedSearchCodes = function() {\n\n    // INFORMATION\n    // on y ajoute les filtres attributaires pour une table de ressources\n    // selectionne via un evenement (onchange) de la liste deroulante du\n    // menu avanc du geocodage.\n    // cf. onGeocodingAdvancedSearchCodeChange() pour la selection de la\n    // ressource de geocodage  afficher\n\n    var geocodeResources = this.options.resources.geocode;\n    for (var i = 0; i < geocodeResources.length; i++) {\n        switch (geocodeResources[i]) {\n            case \"PositionOfInterest\":\n                this._advancedSearchCodes.push({\n                    id: \"PositionOfInterest\",\n                    title: \"Lieux/toponymes\"\n                });\n                break;\n            case \"StreetAddress\":\n                this._advancedSearchCodes.push({\n                    id: \"StreetAddress\",\n                    title: \"Adresses\"\n                });\n                break;\n            case \"CadastralParcel\":\n                this._advancedSearchCodes.push({\n                    id: \"CadastralParcel\",\n                    title: \"Parcelles cadastrales\"\n                });\n                break;\n            case \"Administratif\":\n                this._advancedSearchCodes.push({\n                    id: \"Administratif\",\n                    title: \"Administratif\"\n                });\n                break;\n            default:\n                break;\n        }\n    }\n    // par dfaut, au cas o aucune ressource passe en option ne correspond  celles attendues\n    if (this._advancedSearchCodes.length === 0) {\n        this._advancedSearchCodes = [{\n            id: \"StreetAddress\",\n            title: \"Adresses\"\n        }, {\n            id: \"PositionOfInterest\",\n            title: \"Lieux/toponymes\"\n        }];\n    }\n\n    logger.log(\"advancedSearchCodes\", this._advancedSearchCodes);\n};\n\n/**\n * this method is called by this.onAdd()\n * and initialize the advanced geocoding filters.\n *\n * @private\n */\nSearchEngine.prototype._initAdvancedSearchFilters = function() {\n\n    // liste des filtres par defauts pour toutes les ressources\n    this._advancedSearchFilters = SearchEngineUtils.advancedSearchFiltersByDefault;\n\n    // on merge les options avances avec celles par defaut\n    var advancedSearchFiltersCustom = this.options.advancedSearch;\n    Utils.assign(this._advancedSearchFilters, advancedSearchFiltersCustom);\n\n    logger.log(\"advancedSearchFilters\", this._advancedSearchFilters);\n};\n\n/**\n * this method is called by this.initialize() and initialize popup div\n * (to display results information on marker click)\n *\n * @return {Object} element - DOM element for popup\n * @private\n */\nSearchEngine.prototype._initPopupDiv = function() {\n    var context = this;\n    var element = document.createElement(\"div\");\n    element.className = \"gp-feature-info-div\";\n    var closer = document.createElement(\"input\");\n    closer.type = \"button\";\n    closer.className = \"gp-styling-button closer\";\n    /** on closer click : remove popup */\n    closer.onclick = function() {\n        if (context._popupOverlay != null) {\n            context._popupOverlay.setPosition(undefined);\n        }\n        return false;\n    };\n    this._popupContent = document.createElement(\"div\");\n    this._popupContent.className = \"gp-features-content-div\";\n    this._popupContent.style[\"min-width\"] = \"200px\";\n    element.appendChild(this._popupContent);\n    element.appendChild(closer);\n\n    return element;\n};\n\n// ################################################################### //\n// ######################## DOM initialize ########################### //\n// ################################################################### //\n\n/**\n * Create control main container\n *\n * @private\n */\nSearchEngine.prototype._initContainer = function() {\n    // create main container\n    var container = this._createMainContainerElement();\n\n    // create show search engine element\n    var inputShow = this._showSearchEngineInput = this._createShowSearchEngineElement();\n    container.appendChild(inputShow);\n\n    // mode \"collapsed\"\n    if (!this.options.collapsed) {\n        inputShow.checked = true;\n    }\n\n    // create search engine picto\n    var picto = this._createShowSearchEnginePictoElement();\n    container.appendChild(picto);\n\n    var search = this._inputSearchContainer = this._createSearchInputElement(this.options.placeholder);\n    var context = this;\n    if (search.addEventListener) {\n        search.addEventListener(\"click\", function() {\n            context.onAutoCompleteInputClick();\n        });\n    } else if (search.attachEvent) {\n        search.attachEvent(\"onclick\", function() {\n            context.onAutoCompleteInputClick();\n        });\n    }\n    container.appendChild(search);\n\n    if (this.options.displayAdvancedSearch) {\n        var advancedShow = this._createShowAdvancedSearchElement();\n        container.appendChild(advancedShow);\n\n        // INFO je decompose les appels car j'ai besoin de recuperer le container\n        // des filtres\n        var advancedPanel = this._createAdvancedSearchPanelElement();\n        var advancedHeader = this._createAdvancedSearchPanelHeaderElement();\n        var advancedForm = this._createAdvancedSearchPanelFormElement(this._advancedSearchCodes);\n        var advancedFormFilters = this._filterContainer = this._createAdvancedSearchFormFiltersElement();\n        this._setFilter(this._advancedSearchCodes[0].id); // ex \"PositionOfInterest\"\n        var advancedFormInput = this._createAdvancedSearchFormInputElement();\n        advancedForm.appendChild(advancedFormFilters);\n        advancedForm.appendChild(advancedFormInput);\n        advancedPanel.appendChild(advancedHeader);\n        advancedPanel.appendChild(advancedForm);\n        container.appendChild(advancedPanel);\n    }\n\n    // INFO je decompose les appels car j'ai besoin de recuperer le container\n    // des resultats de l'autocompletion\n    var autocomplete = this._autocompleteContainer = this._createAutoCompleteElement();\n    var autocompleteList = this._suggestedContainer = this._createAutoCompleteListElement();\n    autocomplete.appendChild(autocompleteList);\n    container.appendChild(autocomplete);\n\n    // INFO je decompose les appels car j'ai besoin de recuperer le container\n    // des resultats du geocodage\n    var geocode = this._createGeocodeResultsElement();\n    var geocodeList = this._geocodedContainer = this._createGeocodeResultsListElement();\n    geocode.appendChild(geocodeList);\n    container.appendChild(geocode);\n\n    return container;\n};\n\n/**\n * this method is called by :\n * - this._initContainer() : ...\n * - this.onGeocodingAdvancedSearchCodeChoice() : ...\n * and initialize or create the filters container HTMLElement\n * to the geocoding advanced menu.\n *\n * @param {String} code - resource geocoding name\n * @private\n */\nSearchEngine.prototype._setFilter = function(code) {\n\n    // INFORMATION\n    // Nous avons 2 solutions possibles pour la mise en place des filtres.\n    // 1. Soit on decide de creer tous les filtres pour chaque ressource\n    // de geocodage  l'initialisation du composant, et on joue sur le\n    // mode 'hidden' pour n'afficher que la ressource selectionne.\n    // 2. Soit on decide de creer  chaque fois les filtres pour la\n    // ressource selectionne.\n    // Chaque solution a ses inconvenients/avantages.\n    // Implementation du choix 2 car elle offre plus de souplesse pour\n    // recuperer les 'form-data'...\n\n    var container = this._filterContainer;\n\n    var codeFound = false;\n    for (var i = 0; i < this._advancedSearchCodes.length; i++) {\n        if (this._advancedSearchCodes[i].id === code) {\n            codeFound = true;\n            break;\n        }\n    }\n\n    if (!codeFound) {\n        // cette ressource n'est pas disponible,\n        // on supprime les anciens enfants...\n        while (container.firstChild) {\n            container.removeChild(container.firstChild);\n        }\n        return;\n    }\n\n    // on sauvegarde la ressource de geocodage slectionne\n    this._currentGeocodingCode = code;\n\n    // on supprime les enfants...\n    while (container.firstChild) {\n        container.removeChild(container.firstChild);\n    }\n\n    var lstAttributs = this._advancedSearchFilters[code];\n    if (!lstAttributs || lstAttributs.length === 0) {\n        // cette ressource n'est pas parametrable\n        return;\n    }\n\n    var divTable = this._createAdvancedSearchFiltersTableElement(code, true);\n\n    for (var j = 0; j < lstAttributs.length; j++) {\n        var divFilter = this._createAdvancedSearchFiltersAttributElement(lstAttributs[j]);\n        divTable.appendChild(divFilter);\n    }\n\n    container.appendChild(divTable);\n\n    return container;\n};\n\n// ################################################################### //\n// ##################### methods rights management ################### //\n// ################################################################### //\n\n/**\n * this method is called by constructor\n * and check the rights to resources and services\n *\n * @private\n */\nSearchEngine.prototype._checkRightsManagement = function() {\n\n    // INFORMATION\n    // l'autoconfiguration n'est utile que pour rcuprer la clef si elle\n    // n'est pas renseigne, et pour vrifier les droits sur les ressources\n    // et les services.\n\n    // si l'autoconfiguration n'est pas charge,\n    // il est toujours possible de requeter le service avec une clef API,\n    // mais les droits sur les ressources ne sont pas garantis, on risque\n    // d'obtenir des erreurs 403 forbidden..., la responsabilit revient\n    //  l'utilisateur (message d'information)...\n    // par contre, sans clef API renseigne au niveau du controle,\n    // l'utilisateur doit la renseigner au niveau des services...,\n    // sinon, Exception du service\n\n    // si l'autoconfiguration est charge,\n    // si une clef API est renseigne au niveau controle, on controle\n    // le mapping entre le contrat et la clef...\n    // on obtient la liste des ressources ayant droits,\n    // si on ne trouve pas de ressources ou certaines ressources ne sont\n    // pas disponible, on previent l'utilisateur (message d'information).\n\n    var _resources = [];\n    var _key;\n    var _opts = null;\n\n    // les ressources du service d'autocompletion\n    _key = this.options.autocompleteOptions.apiKey;\n    _opts = this.options.autocompleteOptions.filterOptions;\n    // on rcupre les ventuelles ressources passes en option, soit dans autocompleteOptions\n    _resources = (_opts) ? _opts.type : [];\n    // soit dans options.resources.autocomplete\n    if (!_resources || _resources.length === 0) {\n        _resources = this.options.resources.autocomplete;\n    }\n    // ou celles par dfaut sinon.\n    if (!_resources || _resources.length === 0) {\n        _resources = [\n            \"StreetAddress\",\n            \"PositionOfInterest\"\n        ];\n    }\n    var rightManagementAutoComplete = RightManagement.check({\n        key: _key || this.options.apiKey,\n        resources: _resources,\n        services: [\"AutoCompletion\"]\n    });\n    logger.log(\"rightManagementAutoComplete\", rightManagementAutoComplete);\n\n    // les ressources du service de geocodage\n    _key = this.options.geocodeOptions.apiKey;\n    _opts = this.options.geocodeOptions.filterOptions;\n    // on rcupre les ventuelles ressources passes en option, soit dans geocodeOptions :\n    _resources = (_opts) ? _opts.type : [];\n    // soit directement dans options.resources.geocode :\n    if (!_resources || _resources.length === 0) {\n        _resources = this.options.resources.geocode;\n    }\n    // ou celles par dfaut sinon.\n    if (!_resources || _resources.length === 0) {\n        _resources = [\n            \"StreetAddress\",\n            \"PositionOfInterest\"\n        ];\n    }\n    var rightManagementGeocode = RightManagement.check({\n        key: _key || this.options.apiKey,\n        resources: _resources,\n        services: [\"Geocode\"]\n    });\n    logger.log(\"rightManagementGeocode\", rightManagementGeocode);\n\n    // aucun droit !\n    if (!rightManagementAutoComplete && !rightManagementGeocode) {\n        this._noRightManagement = true;\n        return;\n    }\n\n    // on recupre les informations utiles\n    // Ex. la clef API issue de l'autoconfiguration si elle n'a pas\n    // t renseigne.\n    if (!this.options.apiKey) {\n        if (rightManagementGeocode) {\n            this.options.apiKey = rightManagementGeocode.key;\n        } else {\n            this.options.apiKey = rightManagementAutoComplete.key;\n        }\n    }\n\n    // les ressources par services ayant droit doivent servir pour les\n    // appels aux services\n    if (rightManagementAutoComplete) {\n        this._servicesRightManagement[\"AutoCompletion\"] = rightManagementAutoComplete[\"AutoCompletion\"];\n    }\n\n    if (rightManagementGeocode) {\n        this._servicesRightManagement[\"Geocode\"] = rightManagementGeocode[\"Geocode\"];\n    }\n\n};\n\n// ################################################################### //\n// ################ methods to request and results ################### //\n// ################################################################### //\n\n/**\n * this method is called by this.onAutoCompleteSearch()\n * and executes a request to the service.\n *\n * @param {Object} settings - service settings\n * @param {String}   settings.text - text\n * @param {Function} settings.onSuccess - callback\n * @param {Function} settings.onFailure - callback\n * @private\n */\nSearchEngine.prototype._requestAutoComplete = function(settings) {\n\n    // on ne fait pas de requte si on n'a pas renseign de parametres !\n    if (!settings || (typeof settings === \"object\" && Object.keys(settings).length === 0)) {\n        return;\n    }\n\n    // on ne fait pas de requte si la parametre 'text' est vide !\n    if (!settings.text) {\n        return;\n    }\n\n    logger.log(settings);\n\n    var options = {};\n    // on recupere les options du service\n    Utils.assign(options, this.options.autocompleteOptions.serviceOptions);\n    // ainsi que la recherche et les callbacks\n    Utils.assign(options, settings);\n\n    // on ajoute le paramtre filterOptions.type spcifiant les ressources.\n    var resources = this.options.resources.autocomplete;\n    if (resources && Array.isArray(resources)) {\n        if (!options.filterOptions) {\n            options.filterOptions = {};\n        }\n        // il se peut que l'utilisateur ait surcharg ce paramtre dans geocodeOptions,\n        if (!options.filterOptions.type) {\n            options.filterOptions.type = resources;\n        }\n    }\n\n    // cas o la clef API n'est pas renseigne dans les options du service,\n    // on utilise celle de l'autoconf ou celle renseigne au niveau du controle\n    options.apiKey = options.apiKey || this.options.apiKey;\n\n    logger.log(options);\n\n    Gp.Services.autoComplete(options);\n};\n\n/**\n * this method is called by this.onAutoCompleteSearchText() (case of success)\n * and fills the container of the location list.\n * it creates a HTML Element per location\n *\n * @param {Array} locations - Array of Gp.Services.AutoComplete.SuggestedLocation corresponding to autocomplete results list\n * @private\n */\nSearchEngine.prototype._fillAutoCompletedLocationListContainer = function(locations) {\n\n    if (!locations || locations.length === 0) {\n        return;\n    }\n\n    // on vide la liste avant de la construire\n    var element = this._suggestedContainer;\n    if (element.childElementCount) {\n        while (element.firstChild) {\n            element.removeChild(element.firstChild);\n        }\n    }\n\n    this._displaySuggestedLocation();\n    for (var i = 0; i < locations.length; i++) {\n        // Proposals are dynamically filled in Javascript by autocomplete service\n        this._createAutoCompletedLocationElement(locations[i], i);\n    }\n\n};\n\n/**\n * this method is called by this.onAutoCompleteSearch()\n * and executes a request to the service.\n *\n * @param {Object} settings - service settings\n * @param {String}   settings.location - text\n * @param {Function} settings.onSuccess - callback\n * @param {Function} settings.onFailure - callback\n * @private\n */\nSearchEngine.prototype._requestGeocoding = function(settings) {\n\n    // on ne fait pas de requte si on n'a pas renseign de parametres !\n    if (!settings || (typeof settings === \"object\" && Object.keys(settings).length === 0)) {\n        return;\n    }\n\n    // on ne fait pas de requte si la parametre 'text' est vide !\n    if (!settings.location) {\n        return;\n    }\n\n    logger.log(settings);\n\n    var options = {};\n    options.returnFreeForm = true;\n    // on recupere les options du service\n    Utils.assign(options, this.options.geocodeOptions);\n    // ainsi que la recherche et les callbacks\n    Utils.assign(options, settings);\n\n    // on ajoute le paramtre filterOptions.type spcifiant les ressources.\n    var resources = this.options.resources.geocode;\n    if (resources && Array.isArray(resources)) {\n        if (!options.filterOptions) {\n            options.filterOptions = {};\n        }\n        // il se peut que l'utilisateur ait surcharg ce paramtre dans geocodeOptions,\n        // ou qu'il ait dj t rempli (cas de la recherche avance)\n        if (!options.filterOptions.type) {\n            options.filterOptions.type = resources;\n        }\n    }\n\n    // cas o la clef API n'est pas renseigne dans les options du service,\n    // on utilise celle de l'autoconf ou celle renseigne au niveau du controle\n    options.apiKey = options.apiKey || this.options.apiKey;\n\n    logger.log(options);\n\n    Gp.Services.geocode(options);\n};\n\n/**\n * this method is called by this.onGeocodingSearch()\n * and fills the container of the location results.\n * it creates a HTML Element per location\n * (cf. this. ...)\n *\n * @private\n */\nSearchEngine.prototype._fillGeocodedLocationListContainer = function(locations) {\n\n    if (!locations || locations.length === 0) {\n        this._clearGeocodedLocation();\n        return;\n    }\n\n    // on vide la liste avant de la construire\n    var element = this._geocodedContainer;\n    if (element.childElementCount) {\n        while (element.firstChild) {\n            element.removeChild(element.firstChild);\n        }\n    }\n\n    for (var i = 0; i < locations.length; i++) {\n        logger.log(locations[i]);\n        // Proposals are dynamically filled in Javascript by autocomplete service\n        this._createGeocodedLocationElement(locations[i], i);\n    }\n\n    // sauvegarde de l'etat des locations\n    this._geocodedLocations = locations;\n};\n\n// ################################################################### //\n// ######################### other methods ########################### //\n// ################################################################### //\n\n/**\n * this sends the label to the panel.\n *\n * @param {String} label - label suggested location\n * @private\n */\nSearchEngine.prototype._setLabel = function(label) {\n    document.getElementById(\"GPsearchInputText-\" + this._uid).value = label;\n};\n\n/**\n * this method is called by this.on*ResultsItemClick()\n * and move/zoom on a position.\n *\n * @param {Array} position - ol.Coordinate object [lon, lat] (en lat/lon : \"EPSG:4326\")\n * @param {Number} zoom - zoom level\n * @private\n */\nSearchEngine.prototype._setPosition = function(position, zoom) {\n\n    var view = this.getMap().getView();\n    view.setCenter(position);\n    view.setZoom(zoom);\n\n};\n\n/**\n * this method is called by this.on*ResultsItemClick()\n * and displays a marker.\n * FIXME\n *\n * @param {Array} position - ol.Coordinate object [lon, lat] ou [x, y]\n * @private\n */\nSearchEngine.prototype._setMarker = function(position, info) {\n\n    var map = this.getMap();\n    var context = this;\n\n    // remove previous markers\n    if (this._marker != null) {\n        map.removeOverlay(this._marker);\n        this._marker = null;\n    }\n\n    if (position) {\n\n        // cration de l'lment DOM\n        var markerDiv = document.createElement(\"img\");\n        markerDiv.src = this._markerUrl;\n\n        // ajout de l'vnement onclick (pour afficher une popup)\n        if (markerDiv.addEventListener) {\n            markerDiv.addEventListener(\n                \"click\",\n                function() {\n                    context._onResultMarkerSelect(info);\n                }\n            );\n        } else if (markerDiv.attachEvent) {\n            // Internet Explorer\n            markerDiv.attachEvent(\n                \"onclick\",\n                function() {\n                    context._onResultMarkerSelect(info);\n                }\n            );\n        }\n\n        // cration du marker (overlay)\n        this._marker = new ol.Overlay({\n            position: position,\n            offset: [-25.5, -38],\n            element: markerDiv,\n            stopEvent: false\n        });\n        map.addOverlay(this._marker);\n    }\n};\n\n/**\n * this method is called by this.on*ResultsItemClick()\n * and get zoom to results.\n *\n * @param {Object} info - {}\n * @private\n */\nSearchEngine.prototype._getZoom = function(info) {\n\n    var map = this.getMap();\n    var key = this.options.zoomTo;\n    var zoom = null;\n\n    // les valeurs du zooms sont determines\n    // soit par les mots clefs suivants :  max, min ou auto\n    // soit par un niveau de zoom\n    // soit defini par l'utilisateur via une fonction\n\n    if (typeof key === \"function\") {\n        logger.trace(\"zoom function\");\n        zoom = key.call(this, info);\n    }\n\n    if (typeof key === \"number\") {\n        logger.trace(\"zoom level\");\n        zoom = key;\n    }\n\n    if (typeof key === \"string\") {\n\n        // if (key === \"max\") {\n        //     zoom = map.getMaxZoom();\n        // } else if (key === \"min\") {\n        //     zoom = map.getMinZoom();\n        // } else\n\n        if (key === \"auto\") {\n            logger.trace(\"zoom auto\");\n            zoom = SearchEngineUtils.zoomToResultsByDefault(info);\n\n        } else {\n            logger.trace(\"zoom level parsing\");\n            var value = parseInt(key, 10);\n            if (!isNaN(value)) {\n                logger.trace(\"zoom parsing\");\n                zoom = value;\n            }\n        }\n    }\n\n    // polyfill IE\n    Number.isInteger = Number.isInteger || function(value) {\n        return typeof value === \"number\" &&\n            isFinite(value) &&\n            Math.floor(value) === value;\n    };\n\n    // test de validit du zoom,\n    // on prend le zoom courant par defaut ...\n    if (!zoom || zoom === \"\" || !Number.isInteger(zoom)) {\n        logger.trace(\"zoom not found, current zoom...\");\n        zoom = map.getView().getZoom();\n    }\n\n    // FIXME test si le zoom est dans l'espace de la carte\n    var min = map.minZoom; // .getMinZoom();\n    var max = map.maxZoom; // .getMaxZoom();\n    if (zoom < min) {\n        logger.trace(\"zoom level min...\");\n        zoom = min;\n    }\n    if (zoom > max) {\n        logger.trace(\"zoom level max...\");\n        zoom = max;\n    }\n\n    logger.trace(\"zoom\", zoom);\n    return zoom;\n};\n\n/**\n * this method is called on 'click' on this._marker\n * (cf. this._setMarker() )\n * and sets a popup with marker information\n *\n * @param {Object} information - location information\n * @private\n */\nSearchEngine.prototype._onResultMarkerSelect = function(information) {\n    var map = this.getMap();\n\n    var popupContent = \"\";\n    if (information.attributes) {\n        // si on a des attributes (freeform = false)\n        popupContent = \"<ul>\";\n        var attributes = information.attributes;\n        for (var attr in attributes) {\n            if (attributes.hasOwnProperty(attr)) {\n                if (attr !== \"bbox\") {\n                    popupContent += \"<li>\";\n                    popupContent += \"<span class=\\\"gp-attname-others-span\\\">\" + attr.toUpperCase() + \" : </span>\";\n                    popupContent += attributes[attr];\n                    popupContent += \" </li>\";\n                }\n            }\n        }\n        popupContent += \" </ul>\";\n    } else {\n        // freeform\n        popupContent = information.label;\n    }\n\n    this._popupContent.innerHTML = popupContent;\n    if (!this._popupOverlay) {\n        // ajout de la popup a la carte comme un overlay\n        this._popupOverlay = new ol.Overlay({\n            element: this._popupDiv,\n            positioning: \"bottom-center\",\n            position: this._marker.getPosition(),\n            offset: [0, -42]\n        });\n        map.addOverlay(this._popupOverlay);\n    } else {\n        // si l'overlay est dj cr, on modifie juste sa position\n        this._popupOverlay.setPosition(this._marker.getPosition());\n    }\n\n};\n\n// ################################################################### //\n// ###################### other handlers events ###################### //\n// ################################################################### //\n\n/**\n * this method is called by event 'click' on 'GPshowSearchEnginePicto' tag label\n * (cf. this._createShowSearchEnginePictoElement), and it cleans the component\n * when it's closed.\n *\n * @private\n */\nSearchEngine.prototype.onShowSearchEngineClick = function() {\n    this.collapsed = this._showSearchEngineInput.checked;\n    // on gnre nous mme l'evenement OpenLayers de changement de proprit\n    // (utiliser ol.control.SearchEngine.on(\"change:collapsed\", function ) pour s'abonner  cet vnement)\n    this.dispatchEvent(\"change:collapsed\");\n};\n\n/**\n * this method is called by event 'click' on 'GPsearchInputReset' tag div\n * (cf. this._createSearchInputElement), and it cleans the value of input.\n *\n * @private\n */\nSearchEngine.prototype.onSearchResetClick = function() {\n    this._clearResults();\n};\n\n// ################################################################### //\n// ################## handlers events AutoComplete ################### //\n// ################################################################### //\n\n/**\n * this method is called by event 'click' on 'GPlocationOrigin' input\n *\n * @private\n */\nSearchEngine.prototype.onAutoCompleteInputClick = function() {\n    var inputSearchTextContainer = document.getElementById(\"GPsearchInputText-\" + this._uid);\n    if (inputSearchTextContainer && !inputSearchTextContainer.disabled && inputSearchTextContainer.value.length > 2) {\n        this._displaySuggestedLocation();\n    }\n};\n\n/**\n * this method is called by event 'keyup' on 'GPsearchInputText' tag input\n * (cf. this._createSearchInputElement), and it gets the value of input.\n * this value is passed as a parameter for the service autocomplete (text).\n * the results of the request are displayed into a drop down menu.\n *\n * @param {Object} e - HTMLElement\n * @private\n */\nSearchEngine.prototype.onAutoCompleteSearchText = function(e) {\n\n    var value = e.target.value;\n    if (!value) {\n        return;\n    }\n\n    // aucun droits !\n    // on evite une requte...\n    if (this._noRightManagement) {\n        console.log(\"no rights for this service !\");\n        return;\n    }\n\n    // on sauvegarde le localisant\n    this._currentGeocodingLocation = value;\n\n    // on limite les requtes  partir de 3 car. saisie !\n    if (value.length < 3) {\n        this._clearSuggestedLocation();\n        return;\n    }\n\n    var _triggerGeocode = this.options.autocompleteOptions.triggerGeocode;\n    var _triggerDelay = this.options.autocompleteOptions.triggerDelay;\n\n    // INFORMATION\n    // on effectue la requte au service d'autocompletion.\n    // on met en place des callbacks afin de recuperer les resultats ou\n    // les messages d'erreurs du service.\n    // les resultats sont affichs dans une liste deroulante.\n    // les messages d'erreurs sont affichs sur la console (?)\n    var context = this;\n    this._requestAutoComplete({\n        text: value,\n        /** callback onSuccess */\n        onSuccess: function(results) {\n            logger.log(\"request from AutoComplete\", results);\n            if (results) {\n                // on sauvegarde l'etat des rsultats\n                context._suggestedLocations = results.suggestedLocations;\n                context._locationsToBeDisplayed = [];\n                // on vrifie qu'on n'a pas rcupr des coordonnes nulles (par ex recherche par code postal)\n                for (var i = 0; i < context._suggestedLocations.length; i++) {\n                    var ilocation = context._suggestedLocations[i];\n                    if (ilocation.position && ilocation.position.x === 0 && ilocation.position.y === 0 && ilocation.fullText) {\n                        // si les coordonnes sont nulles, il faut relancer une requte de gocodage avec l'attribut \"fullText\" rcupr\n                        context._getGeocodeCoordinatesFromFullText(ilocation, i);\n                    } else {\n                        // sinon on peut afficher normalement le rsultat dans la liste\n                        context._locationsToBeDisplayed.push(ilocation);\n                    }\n                };\n                // on affiche les rsultats qui n'ont pas des coordonnes nulles\n                context._fillAutoCompletedLocationListContainer(context._locationsToBeDisplayed);\n                // on annule eventuellement une requete de geocodage en cours car on obtient des\n                // de nouveau des resultats d'autocompletion...\n                if (context._triggerHandler) {\n                    clearTimeout(context._triggerHandler);\n                    context._triggerHandler = null;\n                    logger.warn(\"Cancel a geocode request !\");\n                }\n            }\n        },\n        /** callback onFailure */\n        onFailure: function(error) {\n            // FIXME\n            // o affiche t on les messages : ex. 'No suggestion matching the search' ?\n            context._clearSuggestedLocation();\n            logger.log(error.message);\n            // on envoie une requete de geocodage si aucun resultat d'autocompletion\n            // n'a t trouv ! Et on n'oublie pas d'annuler celle qui est en cours !\n            if (error.message === \"No suggestion matching the search\" && _triggerGeocode /* && value.length === 5 */ ) {\n                if (context._triggerHandler) {\n                    clearTimeout(context._triggerHandler);\n                    logger.warn(\"Cancel the last geocode request !\");\n                }\n                context._triggerHandler = setTimeout(\n                    function() {\n                        logger.warn(\"Launch a geocode request (code postal) !\");\n                        context._requestGeocoding({\n                            location: value,\n                            returnFreeForm: true,\n                            /** callback onSuccess */\n                            onSuccess: function(results) {\n                                logger.log(\"request from Geocoding\", results);\n                                if (results) {\n                                    context._locationsToBeDisplayed = [];\n                                    // on modifie la structure des reponses pour tre\n                                    // compatible avec l'autocompletion !\n                                    var locations = results.locations;\n                                    for (var i = 0; i < locations.length; i++) {\n                                        var location = locations[i];\n                                        location.fullText = location.placeAttributes.freeform;\n                                        location.position = {\n                                            x: location.position.y,\n                                            y: location.position.x\n                                        };\n                                        context._locationsToBeDisplayed.push(location);\n                                    }\n                                    context._fillAutoCompletedLocationListContainer(locations);\n                                }\n                            },\n                            /** callback onFailure */\n                            onFailure: function(error) {\n                                logger.log(error.message);\n                            }\n                        });\n                    }, _triggerDelay\n                );\n            }\n        }\n    });\n\n    var map = this.getMap();\n    map.on(\n        \"click\",\n        this._hideSuggestedLocation,\n        this\n    );\n    map.on(\n        \"pointerdrag\",\n        this._hideSuggestedLocation,\n        this\n    );\n};\n\n/**\n * this method is called by Gp.Services.autoComplete callback in case of success\n * (cf. this.onAutoCompleteSearchText), for suggested locations with null coordinates\n * (case of postalCode research for instance).\n * Send a geocode request with suggested location 'fullText' attribute, to get its coordinates and display it in autocomplete results list container.\n *\n * @param {Gp.Services.AutoCompleteResponse.SuggestedLocation} suggestedLocation - autocompletion result (with null coordinates) to be geocoded\n * @param {Number} i - suggestedLocation position in Gp.Services.AutoCompleteResponse.suggestedLocations autocomplete results list\n * @private\n */\nSearchEngine.prototype._getGeocodeCoordinatesFromFullText = function(suggestedLocation, i) {\n    var context = this;\n    Gp.Services.geocode({\n        apiKey: this.options.apiKey,\n        location: suggestedLocation.fullText,\n        filterOptions: {\n            type: suggestedLocation.type\n        },\n        /** callback onSuccess */\n        onSuccess: function(response) {\n            logger.log(\"request from Geocoding (coordinates null)\", response);\n            if (response.locations && response.locations.length !== 0 && response.locations[0].position) {\n                // on modifie les coordonnes du rsultat en EPSG:4326 donc lat,lon\n                if (context._suggestedLocations && context._suggestedLocations[i]) {\n                    context._suggestedLocations[i].position = {\n                        x: response.locations[0].position.y,\n                        y: response.locations[0].position.x\n                    };\n                    // et on l'affiche dans la liste\n                    context._locationsToBeDisplayed.unshift(context._suggestedLocations[i]);\n                    context._fillAutoCompletedLocationListContainer(context._locationsToBeDisplayed);\n                }\n            }\n        },\n        /** callback onFailure */\n        onFailure: function() {\n            // si on n'a pas russi  rcuprer les coordonnes, on affiche quand mme le rsultat\n            if (context._suggestedLocations && context._suggestedLocations[i]) {\n                context._createAutoCompletedLocationElement(context._suggestedLocations[i], i);\n            }\n        }\n    });\n};\n\n/**\n * this method is called by event 'click' on 'GPautoCompleteResultsList' tag div\n * (cf. this._createAutoCompleteListElement), and it selects the location.\n * this location displays a marker on the map.\n *\n * @param {Object} e - HTMLElement\n * @private\n */\nSearchEngine.prototype.onAutoCompletedResultsItemClick = function(e) {\n\n    // TODO on souhaite un comportement different pour la selection des reponses\n    // de l'autocompletion :\n    // - liste deroulante des reponses,\n    // - puis possibilit de cliquer sur une suggestion\n    // - mais aussi de la choisir avec le clavier (arrow up/down), puis valider\n    // par un return\n    // cette selection avec les fleches doit mettre  jour le input !\n    // (comme un moteur de recherche de navigateur)\n\n    var idx = SelectorID.index(e.target.id);\n    logger.log(idx);\n    logger.log(this._locationsToBeDisplayed[idx]);\n\n    if (!idx) {\n        return;\n    }\n\n    var position = [\n        this._locationsToBeDisplayed[idx].position.x,\n        this._locationsToBeDisplayed[idx].position.y\n    ];\n    var info = {\n        service: \"SuggestedLocation\",\n        type: this._locationsToBeDisplayed[idx].type,\n        fields: this._locationsToBeDisplayed[idx]\n    };\n\n    // on ajoute le texte de l'autocompltion dans l'input\n    var label = this._locationsToBeDisplayed[idx].fullText;\n    this._setLabel(label);\n    info.label = label;\n\n    // Info : la position est en EPSG:4326,  transformer dans la projection de la carte\n    var view = this.getMap().getView();\n    var mapProj = view.getProjection().getCode();\n    if (mapProj !== \"EPSG:4326\") {\n        // on retransforme les coordonnes de la position dans la projection de la carte\n        position = ol.proj.transform(position, \"EPSG:4326\", mapProj);\n    }\n    // on centre la vue et positionne le marker,  la position reprojete dans la projection de la carte\n    var zoom = this._getZoom(info);\n    this._setPosition(position, zoom);\n    if (this._displayMarker) {\n        this._setMarker(position, info);\n    }\n\n};\n\n// ################################################################### //\n// ################### handlers events Geocode ####################### //\n// ################################################################### //\n\n/**\n * this method is called by event 'submit' on 'GPsearchInput' tag form\n * (cf. this._createSearchInputElement), and it gets the value of input.\n * this value is passed as a parameter for the service geocoding.\n * the results of the request are displayed into a window.\n *\n * @param {Object} e - HTMLElement\n * @private\n */\nSearchEngine.prototype.onGeocodingSearchSubmit = function(e) {\n\n    var value = e.target[0].value;\n    if (!value) {\n        return;\n    }\n\n    // aucun droits !\n    // on evite une requte...\n    if (this._noRightManagement) {\n        console.log(\"no rights for this service !\");\n        return;\n    }\n\n    // on sauvegarde le localisant\n    this._currentGeocodingLocation = value;\n\n    // on met en place l'affichage des resultats dans une fenetre de recherche.\n    var context = this;\n    this._requestGeocoding({\n        location: value,\n        /** callback onSuccess */\n        onSuccess: function(results) {\n            logger.log(\"request from Geocoding\", results);\n            if (results) {\n                var locations = results.locations;\n                context._fillGeocodedLocationListContainer(locations);\n            }\n        },\n        /** callback onFailure */\n        onFailure: function(error) {\n            // FIXME cf. this.onAutoCompleteSearch()\n            context._clearGeocodedLocation();\n            logger.log(error.message);\n        }\n    });\n\n};\n\n/**\n * this method is called by event 'submit' on 'GPgeocodeResultsList' tag div\n * (cf. this._createGeocodeResultsListElement), and it selects the location.\n * this location displays a marker on the map.\n *\n * @param {Object} e - HTMLElement\n * @private\n */\nSearchEngine.prototype.onGeocodedResultsItemClick = function(e) {\n    var idx = SelectorID.index(e.target.id);\n\n    if (!idx) {\n        return;\n    }\n\n    var position = [\n        this._geocodedLocations[idx].position.y,\n        this._geocodedLocations[idx].position.x\n    ];\n    var attributes = this._geocodedLocations[idx].placeAttributes;\n    var info = {\n        service: \"DirectGeocodedLocation\",\n        type: this._geocodedLocations[idx].type,\n        fields: this._geocodedLocations[idx]\n    };\n\n    // on ajoute le texte du gocodage dans l'input\n    var label;\n    if (attributes.freeform) {\n        // reponse en freeForm\n        label = attributes.freeform;\n    } else if (attributes.postalCode) {\n        // cas des StreetAddress, PositionOfInterest, Administratif\n        // on affiche uniquement ce qui est commun aux ressources ...\n        label = attributes.postalCode + \" \" + attributes.commune;\n        info.attributes = attributes;\n    } else if (attributes.cadastralParcel) {\n        // cas des CadastralParcel\n        label = attributes.cadastralParcel;\n        info.attributes = attributes;\n    } else {\n        label = \"...\";\n    }\n    this._setLabel(label);\n    info.label = label;\n\n    // Info : la position est en EPSG:4326,  transformer dans la projection de la carte\n    var view = this.getMap().getView();\n    var mapProj = view.getProjection().getCode();\n    if (mapProj !== \"EPSG:4326\") {\n        // on retransforme les coordonnes de la position dans la projection de la carte\n        position = ol.proj.transform(position, \"EPSG:4326\", mapProj);\n    }\n    // on centre la vue et positionne le marker,  la position reprojete dans la projection de la carte\n    var zoom = this._getZoom(info);\n    this._setPosition(position, zoom);\n    if (this._displayMarker) {\n        this._setMarker(position, info);\n    }\n};\n\n// ################################################################### //\n// ############## handlers events Geocode Advanced ################### //\n// ################################################################### //\n\n/**\n * this method is called by event 'change' on 'GPadvancedSearchCode' tag select\n * (cf. this._createAdvancedSearchFormCodeElement), and it gets the value of\n * option selected.\n * this value is passed as a parameter to create the attributs container.\n *\n * @param {Object} e - HTMLElement\n * @private\n */\nSearchEngine.prototype.onGeocodingAdvancedSearchCodeChange = function(e) {\n    logger.log(e);\n    var idx = e.target.selectedIndex;\n    var value = e.target.options[idx].value;\n\n    if (!value) {\n        return;\n    }\n\n    // INFORMATION\n    // le declenchement de l'evenement va creer un container de filtre  la vole...\n    // l'insertion des containers d'attributs dans le DOM sont :\n    // - soit GPadvancedSearchFilters > PositionOfInterest\n    // - soit GPadvancedSearchFilters > StreetAddress\n    // - soit GPadvancedSearchFilters > CadastralParcel\n    // cf. _setFilter() pour la creation du container\n\n    this._setFilter(value);\n};\n\n/**\n * this method is called by event 'submit' on 'GPadvancedSearchForm' tag form\n * (cf. this._createAdvancedSearchPanelFormElement), and it gets the value of all input.\n * this value is passed as a parameter for the service geocoding.\n * the results of the request are displayed into a window.\n *\n * @param {Object} e - HTMLElement\n * @param {Array} data - [{key: ..., value: ...}]\n * @private\n */\nSearchEngine.prototype.onGeocodingAdvancedSearchSubmit = function(e, data) {\n    logger.log(data);\n    if (!data || data.length === 0) {\n        return;\n    }\n\n    var _location;\n    var _filterOptions = {};\n    var filter;\n    _filterOptions.type = [this._currentGeocodingCode];\n    for (var i = 0; i < data.length; i++) {\n        filter = data[i];\n        _filterOptions[filter.key] = filter.value;\n    }\n\n    if (this._currentGeocodingCode === \"CadastralParcel\") {\n        // dans ce cas, les filtres de recherche avance ne sont pas vraiment des filtres,\n        // mais simplement la dcomposition des informations de la parcelle,  concatner.\n        _location = this._getCadastralParcelRequestParams(_filterOptions);\n\n        // FIXME ne marche pas bien !\n        _filterOptions = {\n            type: [this._currentGeocodingCode]\n        };\n\n    } else {\n        // recuperation des parametres des filtres pour les transmettre\n        //  la requte, ainsi que le type de table de ressources de geocodage,\n        // et le localisant (freeform)\n        _location = this._currentGeocodingLocation;\n    }\n\n    // on met en place l'affichage des resultats dans une fenetre de recherche.\n    var context = this;\n    this._requestGeocoding({\n        location: _location,\n        filterOptions: _filterOptions,\n        /** callback onSuccess */\n        onSuccess: function(results) {\n            logger.log(results);\n            if (results) {\n                var locations = results.locations;\n                context._fillGeocodedLocationListContainer(locations);\n            }\n        },\n        /** callback onFailure */\n        onFailure: function(error) {\n            // FIXME cf. this.onAutoCompleteSearch()\n            context._clearGeocodedLocation();\n            logger.log(error.message);\n        }\n    });\n};\n\n/**\n * this method is called by 'onGeocodingAdvancedSearchSubmit' method,\n * in case geocoding type is 'CadastralParcel',\n * and gets request parameters from inputs\n *\n * @param {Object} filterOptions - object with inputs value (department, insee, ...)\n * @returns {String} location - cadastral parcel number : concatenation of inputs values (e.g. : 940670000D0041 or 94067_____0041)\n * @private\n */\nSearchEngine.prototype._getCadastralParcelRequestParams = function(filterOptions) {\n    /* info:\n        la parcelle cadastrale se compose de 14 chiffres ou lettres, indiquant, de gauche  droite :\n        - le code du dpartement (2 caractres)\n        - le code commune (3 caractres). (Remarque : code dpartement + code commune = code INSEE)\n        - OU le code INSEE de la commune (5 chiffres) (remplace les 2 prcdents)\n        - le code commune absorbe INSEE, ou '000' (3 caractres),\n        - la section (2 caractres),\n        - le numro de parcelle (4 caractres).\n        Exemple de parcelle : '940670000D0041'. Si l'identifiant est incomplet (par exemple '940670000D'), le service renverra uniquement les 25 premiers rsultats pouvant correspondre.\n    */\n\n    var _location = \"\";\n\n    var l;\n    // code dpartement (2 caractres)\n    var dep = filterOptions.department;\n    if (dep) {\n        l = dep.length;\n        if (l === 2) {\n            _location = dep;\n        } else if (l === 1) {\n            // si un seul numro a t saisi, on prsume que c'est un numro < 10\n            _location = \"0\" + dep;\n        } else {\n            _location = dep.substring(0, 2);\n        }\n    } else {\n        _location = \"__\";\n    }\n\n    // code commune insee (3 caractres)\n    var commune = filterOptions.commune;\n    if (commune) {\n        l = commune.length;\n        if (l === 3) {\n            _location += commune;\n        } else if (l == 2) {\n            _location += \"_\" + commune;\n        } else if (l == 1) {\n            _location += \"__\" + commune;\n        } else { // l > 3\n            _location += commune.substring(0, 3);\n        }\n    } else {\n        _location += \"___\";\n    }\n\n    // code insee (5 caractres) : surcharge les 2 autres si renseign\n    var insee = filterOptions.insee;\n    if (insee) {\n        if (insee.length === 5) {\n            _location = insee;\n        }\n    }\n\n    // code commune absorbee INSEE (3 caractres)\n    var absorbedCity = filterOptions.absorbedCity;\n    if (absorbedCity) {\n        l = absorbedCity.length;\n        if (l === 3) {\n            _location += absorbedCity;\n        } else if (l < 3) {\n            if (l === 2) {\n                _location += \"_\" + absorbedCity;\n            } else if (l === 1) {\n                _location += \"__\" + absorbedCity;\n            }\n        } else { // l > 3\n            _location += absorbedCity.substring(0, 3);\n        }\n    } else {\n        _location += \"___\";\n    }\n\n    // section (2 caractres)\n    var section = filterOptions.section;\n    if (section) {\n        l = section.length;\n        if (l === 2) {\n            _location += section;\n        } else if (l === 1) {\n            _location += \"_\" + section;\n        } else {\n            _location += section.substring(0, 2);\n        }\n    } else {\n        _location += \"__\";\n    }\n\n    // numro de parcelle (4 caractres)\n    var number = filterOptions.number;\n    if (number) {\n        l = number.length;\n        if (l === 4) {\n            _location += number;\n        } else if (l === 3) {\n            _location += \"_\" + number;\n        } else if (l === 2) {\n            _location += \"__\" + number;\n        } else if (l === 1) {\n            _location += \"___\" + number;\n        } else { // l > 4\n            _location += number.substring(0, 4);\n        }\n    } else {\n        _location += \"___\";\n    }\n\n    logger.log(\"location : \" + _location);\n\n    return _location;\n};\n\n// ################################################################### //\n// ############################## clean ############################## //\n// ################################################################### //\n\n/**\n * this method is called by this.onSearchReset()\n * and it clears all results and the marker.\n *\n * @private\n */\nSearchEngine.prototype._clearResults = function() {\n\n    var map = this.getMap();\n\n    this._currentGeocodingLocation = null;\n\n    this._clearSuggestedLocation();\n    this._clearGeocodedLocation();\n\n    this._setMarker();\n    // on retire l'overlay de la popup de la carte\n    if (this._popupOverlay != null) {\n        map.removeOverlay(this._popupOverlay);\n        this._popupOverlay = null;\n    }\n};\n\n/**\n * this method is called by this.onAutoCompleteSearchText()\n * and it clears all suggested location.\n *\n * @private\n */\nSearchEngine.prototype._clearSuggestedLocation = function() {\n    this._suggestedLocations = [];\n    if (this._suggestedContainer) {\n        while (this._suggestedContainer.firstChild) {\n            this._suggestedContainer.removeChild(this._suggestedContainer.firstChild);\n        }\n    }\n};\n\n/**\n * this method is called by event 'click' on map\n * and it hides suggested locations\n *\n * @private\n */\nSearchEngine.prototype._hideSuggestedLocation = function() {\n    if (this._autocompleteContainer) {\n        this._autocompleteContainer.style.display = \"none\";\n    }\n};\n\n/**\n * this method is called by event 'click' on label input\n * and it displays suggested location.\n *\n * @private\n */\nSearchEngine.prototype._displaySuggestedLocation = function() {\n    if (this._autocompleteContainer) {\n        this._autocompleteContainer.style.display = \"block\";\n    }\n};\n\n/**\n * this method is called by this.onGeocodingAdvancedSearchSubmit()\n * and it clears all geocoded location.\n *\n * @private\n */\nSearchEngine.prototype._clearGeocodedLocation = function() {\n    this._geocodedLocations = [];\n    if (this._geocodedContainer) {\n        while (this._geocodedContainer.firstChild) {\n            this._geocodedContainer.removeChild(this._geocodedContainer.firstChild);\n        }\n    }\n};\n\nexport default SearchEngine;\n\n\n\n// WEBPACK FOOTER //\n// ./src/OpenLayers/Controls/SearchEngine.js","var SearchEngineUtils = {\n    /**\n     * Advanced Search Filters by default\n     */\n    advancedSearchFiltersByDefault: {\n        PositionOfInterest: [{\n            name: \"importance\",\n            title: \"Importance\"\n        }, {\n            name: \"nature\",\n            title: \"Nature\"\n        }, {\n            name: \"territory\",\n            title: \"Territoire\"\n        }, {\n            name: \"insee\",\n            title: \"Code INSEE\"\n        }, {\n            name: \"municipality\",\n            title: \"Ville\"\n        }, {\n            name: \"department\",\n            title: \"Dpartement\"\n        }],\n        StreetAddress: [\n            // INFO\n            // ce ne sont pas des filtres mais une location dite structure !\n            // {name : \"number\", title : \"Numro\"},\n            // {name : \"street\", title : \"Rue\"},\n            // {name : \"postalCode\", title : \"Code Postal\"},\n            // {name : \"city\", title : \"Commune\"},\n            {\n                name: \"territory\",\n                title: \"Territoire\"\n            }, {\n                name: \"insee\",\n                title: \"Code INSEE\"\n            }, {\n                name: \"municipality\",\n                title: \"Ville\"\n            }, {\n                name: \"department\",\n                title: \"Dpartement\"\n            }\n        ],\n        CadastralParcel: [{\n                name: \"department\",\n                title: \"Dpartement\",\n                description: \"Numro du dpartement (ex: 01, 94)\"\n            }, {\n                name: \"commune\",\n                title: \"Code commune (INSEE)\",\n                description: \"Code commune (INSEE) : 3 chiffres (ex: 067)\"\n            },\n            // {\n            //     name : \"insee\",\n            //     title : \"Code INSEE\"\n            // },\n            {\n                name: \"absorbedCity\",\n                title: \"Commune absorbe\",\n                description: \"Commune absorbe : 3 chiffres (ex: 000, 001)\"\n            }, {\n                name: \"section\",\n                title: \"Section\",\n                description: \"Section : 2 caractres (ex: AA, 0D)\"\n            }, {\n                name: \"number\",\n                title: \"Numro\",\n                description: \"Numro de la parcelle : 4 chiffres (ex: 0041, 0250)\"\n            }\n        ],\n        Administratif: [{\n            name: \"prefecture\",\n            title: \"Prfecture\"\n        }, {\n            name: \"inseeRegion\",\n            title: \"Code rgion (INSEE)\"\n        }, {\n            name: \"inseeDepartment\",\n            title: \"Code dpartement (INSEE)\"\n        }, {\n            name: \"municipality\",\n            title: \"Ville\"\n        }]\n    },\n\n    /**\n     * Provides default zoom based on results.\n     *\n     * @param {Object} info - location information\n     * @returns zoom level\n     */\n    zoomToResultsByDefault: function(info) {\n\n        // FIXME\n        // la classification du geocodage est differente de l'importance de l'autocompletion !\n\n        var zoom = 15;\n\n        var service = info.service;\n        var fields = info.fields;\n        var type = info.type;\n\n        var importance = {\n            1: 11,\n            2: 12,\n            3: 13,\n            4: 14,\n            5: 15,\n            6: 16,\n            7: 17,\n            8: 17\n        };\n\n        // AutoCompletion POI\n        if (service === \"SuggestedLocation\") {\n            if (type === \"PositionOfInterest\") {\n                zoom = importance[fields.classification];\n            }\n        }\n\n        // Geocodage POI\n        if (service === \"DirectGeocodedLocation\") {\n            if (type === \"PositionOfInterest\") {\n                zoom = importance[fields.importance] || 14; // au cas o la recherche est en freeform !\n            }\n        }\n\n        if (type === \"StreetAddress\") {\n            zoom = 17;\n        }\n\n        if (type === \"CadastralParcel\") {\n            zoom = 17;\n        }\n\n        if (type === \"Administratif\") {\n            zoom = 12;\n        }\n\n        return zoom;\n    }\n};\n\nexport default SearchEngineUtils;\n\n\n\n// WEBPACK FOOTER //\n// ./src/Common/Utils/SearchEngineUtils.js","import ID from \"../Utils/SelectorID\";\n\nvar SearchEngineDOM = {\n\n    /** Add uuid to the tag ID */\n    _addUID: function(id) {\n        var uid = (this._uid) ? id + \"-\" + this._uid : id;\n        return uid;\n    },\n\n    /**\n     * Main container (DOM)\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createMainContainerElement: function() {\n\n        var container = document.createElement(\"div\");\n        container.id = this._addUID(\"GPsearchEngine\");\n        container.className = \"GPwidget\";\n        return container;\n    },\n\n    // ################################################################### //\n    // ################### Methods of main container ##################### //\n    // ################################################################### //\n\n    /**\n     * Hidden checkbox for minimizing/maximizing\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createShowSearchEngineElement: function() {\n\n        var input = document.createElement(\"input\");\n        input.id = this._addUID(\"GPshowSearchEngine\");\n        input.type = \"checkbox\";\n        return input;\n    },\n\n    /**\n     * Show search engine\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createShowSearchEnginePictoElement: function() {\n\n        // contexte d'execution\n        var self = this;\n\n        var label = document.createElement(\"label\");\n        label.id = this._addUID(\"GPshowSearchEnginePicto\");\n        label.className = \"GPshowAdvancedToolPicto\";\n        label.htmlFor = this._addUID(\"GPshowSearchEngine\");\n        label.title = \"Afficher/masquer la recherche par lieux\";\n\n        // Close all results and panels when minimizing the widget\n        label.addEventListener(\"click\", function() {\n            document.getElementById(self._addUID(\"GPautoCompleteList\")).style.display = \"none\";\n            document.getElementById(self._addUID(\"GPgeocodeResultsList\")).style.display = \"none\";\n            var showAdvancedSearch = document.getElementById(self._addUID(\"GPshowAdvancedSearch\"));\n            if (showAdvancedSearch) {\n                showAdvancedSearch.style.display = null;\n                document.getElementById(self._addUID(\"GPadvancedSearchPanel\")).style.display = \"none\";\n            }\n            var id = \"#GPsearchInput-\" + self._uid;\n            document.querySelector(id + \" input\").disabled = false; // FIXME form[id^=GPsearchInput] = #GPsearchInput ?\n            self.onShowSearchEngineClick();\n        });\n\n        var spanOpen = document.createElement(\"span\");\n        spanOpen.id = this._addUID(\"GPshowSearchEngineOpen\");\n        spanOpen.className = \"GPshowAdvancedToolOpen\";\n        label.appendChild(spanOpen);\n\n        return label;\n    },\n\n    /**\n     * Simple search input\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createSearchInputElement: function(placeholder) {\n\n        // contexte d'execution\n        var self = this;\n\n        var form = document.createElement(\"form\");\n        form.id = this._addUID(\"GPsearchInput\");\n        // Open geocode results panel when submitting the input\n        form.addEventListener(\"submit\", function(e) {\n\n            e.preventDefault();\n            document.getElementById(self._addUID(\"GPgeocodeResultsList\")).style.display = \"block\";\n            document.getElementById(self._addUID(\"GPautoCompleteList\")).style.display = \"none\";\n            // cf. FIXME\n            // document.querySelector(\"#GPsearchInput input\").blur ();\n\n            // gestionnaire d'evenement :\n            // on rcupre la valeur de saisie pour requte sur le service de geocodage\n            self.onGeocodingSearchSubmit(e);\n            return false;\n        });\n\n        var input = document.createElement(\"input\");\n        input.id = this._addUID(\"GPsearchInputText\");\n        input.type = \"text\";\n        input.placeholder = placeholder;\n        input.autocomplete = \"off\";\n        // Manage autocomplete list appearance when filling the address input\n        input.addEventListener(\"keyup\", function(e) {\n\n            var charCode = e.which || e.keyCode;\n            if (charCode === 13 || charCode === 10 || charCode === 38 || charCode === 40) {\n                return;\n            }\n            document.getElementById(self._addUID(\"GPgeocodeResultsList\")).style.display = \"none\";\n            if (input.value.length > 2) {\n                document.getElementById(self._addUID(\"GPautoCompleteList\")).style.display = \"block\";\n            } else {\n                document.getElementById(self._addUID(\"GPautoCompleteList\")).style.display = \"none\";\n            }\n            // gestionnaire d'evenement :\n            // on rcupre la valeur de saisie pour requte sur le service d'autocompletion\n            self.onAutoCompleteSearchText(e);\n\n        });\n\n        // FIXME ce code interfere avec le click sur la liste des suggested locations !\n        // input.addEventListener(\"blur\", function(e) {\n        //     document.getElementById(self._addUID(\"GPautoCompleteList\")).style.display = \"none\";\n        // });\n\n        input.addEventListener(\"keydown\", function(e) {\n            // FIXME\n            // l'action clavier 'enter (13)' lance le submit de la form !\n            // Ce comportement n'est pas souhait car le submit execute un geocodage !\n            // Il faut donc trouver le moyen d'eviter le submit sur un return venant\n            // seulement d'une selection de suggestion...\n\n            var charCode = e.which || e.keyCode;\n\n            var container = document.getElementById(self._addUID(\"GPautocompleteResults\"));\n\n            // si aucun container !?\n            if (!container) {\n                return;\n            }\n\n            var curr = container.getElementsByClassName(\"GPautoCompleteProposal current\");\n            var list = container.getElementsByClassName(\"GPautoCompleteProposal\");\n\n            // si aucune suggestion, on ne va pas plus loin !\n            var length = list.length;\n            if (!length) {\n                return;\n            }\n\n            var current = null;\n\n            // si aucun item courant, on prend le 1er !\n            if (!curr.length) {\n                current = list[0];\n                current.className = \"GPautoCompleteProposal current\";\n                current.style.color = \"#000000\";\n                current.style[\"background-color\"] = \"#CEDBEF\";\n                return;\n            } else {\n                current = curr[0];\n            }\n\n            var index = parseInt(ID.index(current.id), 10);\n            var next = (index === length - 1) ? list[0] : list[index + 1];\n            var prev = (index === 0) ? list[length - 1] : list[index - 1];\n\n            current.style[\"background-color\"] = \"\";\n            current.style.color = \"\";\n            prev.style[\"background-color\"] = \"\";\n            prev.style.color = \"\";\n            next.style[\"background-color\"] = \"\";\n            next.style.color = \"\";\n\n            switch (charCode) {\n                case 38: // arrow up\n                    current.className = \"GPautoCompleteProposal\";\n                    prev.className = \"GPautoCompleteProposal current\";\n                    prev.style.color = \"#000000\";\n                    prev.style[\"background-color\"] = \"#CEDBEF\";\n                    break;\n                case 40: // arrow down\n                    current.className = \"GPautoCompleteProposal\";\n                    next.className = \"GPautoCompleteProposal current\";\n                    next.style.color = \"#000000\";\n                    next.style[\"background-color\"] = \"#CEDBEF\";\n                    break;\n                case 13: // enter\n                    // cf. FIXME\n                    e.preventDefault();\n                    current.click(e);\n                    break;\n            }\n\n            current.focus();\n        });\n\n        form.appendChild(input);\n\n        var div = document.createElement(\"div\");\n        div.id = this._addUID(\"GPsearchInputReset\");\n        // Reset input\n        div.addEventListener(\"click\", function() {\n            document.getElementById(self._addUID(\"GPsearchInputText\")).value = \"\";\n            document.getElementById(self._addUID(\"GPautoCompleteList\")).style.display = \"none\";\n            document.getElementById(self._addUID(\"GPgeocodeResultsList\")).style.display = \"none\";\n            self.onSearchResetClick();\n        });\n        form.appendChild(div);\n\n        return form;\n    },\n\n    /**\n     * Show advanced search panel\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createShowAdvancedSearchElement: function() {\n\n        // contexte d'execution\n        var self = this;\n\n        var div = document.createElement(\"div\");\n        div.id = this._addUID(\"GPshowAdvancedSearch\");\n        div.className = \"GPshowAdvancedToolPicto\";\n        div.title = \"Ouvrir la recherche avance\";\n\n        // Open advanced search\n        div.addEventListener(\"click\", function() {\n            var id = \"#GPsearchInput-\" + self._uid;\n            document.querySelector(id + \" input\").disabled = true;\n            document.getElementById(self._addUID(\"GPautoCompleteList\")).style.display = \"none\";\n            document.getElementById(self._addUID(\"GPgeocodeResultsList\")).style.display = \"none\";\n            document.getElementById(self._addUID(\"GPshowAdvancedSearch\")).style.display = \"none\";\n            document.getElementById(self._addUID(\"GPadvancedSearchPanel\")).style.display = \"inline-block\";\n        });\n\n        var span = document.createElement(\"span\");\n        span.id = this._addUID(\"GPshowAdvancedSearchOpen\");\n        span.className = \"GPshowAdvancedToolOpen\";\n        div.appendChild(span);\n\n        return div;\n    },\n\n    /**\n     * Advanced search panel\n     *\n     * FIXME\n     * don't call this._createAdvancedSearchPanelHeaderElement\n     * don't call this._createAdvancedSearchPanelFormElement\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createAdvancedSearchPanelElement: function() {\n\n        var div = document.createElement(\"div\");\n        div.id = this._addUID(\"GPadvancedSearchPanel\");\n        div.className = \"GPpanel\";\n        div.style.display = \"none\";\n\n        // FIXME on decompose la fonction pour les besoins du controle,\n        // on ajoutera ces childs  la main...\n        // div.appendChild(this._createAdvancedSearchPanelHeaderElement ());\n        // div.appendChild(this._createAdvancedSearchPanelFormElement ());\n\n        return div;\n\n    },\n\n    /**\n     * Geocoding results\n     *\n     * FIXME\n     * don't call this._createGeocodeResultsListElement\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createGeocodeResultsElement: function() {\n\n        var div = document.createElement(\"div\");\n        div.id = this._addUID(\"GPgeocodeResultsList\");\n        div.className = \"GPpanel\";\n        div.style.display = \"none\";\n\n        div.appendChild(this._createGeocodeResultsHeaderElement());\n\n        // FIXME on decompose la fonction pour les besoins du controle,\n        // on ajoutera ces childs  la main...\n        // div.appendChild(this._createGeocodeResultsListElement ());\n\n        return div;\n\n    },\n\n    /**\n     * Autocompletion results\n     *\n     * FIXME\n     * don't call this._createAutoCompleteListElement\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createAutoCompleteElement: function() {\n\n        var div = document.createElement(\"div\");\n        div.id = this._addUID(\"GPautoCompleteList\");\n        div.className = \"GPautoCompleteList\"; // GPpanel ?\n        div.style.display = \"none\";\n\n        // FIXME on decompose la fonction pour les besoins du controle,\n        // on ajoutera ces childs  la main...\n        // div.appendChild(this._createAutoCompleteListElement ());\n\n        return div;\n\n    },\n\n    // ################################################################### //\n    // ################### Autocompletion container ###################### //\n    // ################################################################### //\n\n    /**\n     * Autocompletion results list.\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createAutoCompleteListElement: function() {\n\n        // contexte d'execution\n        var self = this;\n\n        var container = document.createElement(\"div\");\n        container.id = this._addUID(\"GPautocompleteResults\");\n\n        if (container.addEventListener) {\n            container.addEventListener(\"click\", function(e) {\n                self.onAutoCompletedResultsItemClick(e);\n                document.getElementById(self._addUID(\"GPautoCompleteList\")).style.display = \"none\";\n            }, false);\n        } else if (container.attachEvent) {\n            container.attachEvent(\"onclick\", function(e) {\n                self.onAutoCompletedResultsItemClick(e);\n                document.getElementById(self._addUID(\"GPautoCompleteList\")).style.display = \"none\";\n            });\n        }\n\n        // Proposals are dynamically filled in Javascript by autocomplete service\n        // <div class=\"GPautoCompleteProposal\">...</div>\n\n        return container;\n    },\n\n    /**\n     * Autocompletion result.\n     * Proposals are dynamically filled in Javascript by autocomplete service\n     *\n     * TODO formaliser le contenu des reponse\n     *\n     * @param {Object} location - suggested or geocoded location results\n     * @param {Number} id - ID\n     */\n    _createAutoCompletedLocationElement: function(location, id) {\n\n        var container = document.getElementById(this._addUID(\"GPautocompleteResults\"));\n\n        var div = document.createElement(\"div\");\n        div.id = this._addUID(\"AutoCompletedLocation_\" + id);\n        div.className = \"GPautoCompleteProposal\";\n        div.innerHTML = location.fullText;\n        if (div.addEventListener) {\n            div.addEventListener(\"click\", function(e) {\n                container.click(e);\n            }, false);\n        } else if (div.attachEvent) {\n            div.attachEvent(\"onclick\", function(e) {\n                container.click(e);\n            });\n        }\n\n        container.appendChild(div);\n    },\n\n    // ################################################################### //\n    // ############### Geocoding with advanced container ################# //\n    // ################################################################### //\n\n    /** ... */\n    _createAdvancedSearchPanelHeaderElement: function() {\n\n        // contexte d'execution\n        var self = this;\n\n        var container = document.createElement(\"div\");\n        container.className = \"GPpanelHeader\";\n\n        var divTitle = document.createElement(\"div\");\n        divTitle.className = \"GPpanelTitle\";\n        divTitle.innerHTML = \"Recherche avance\";\n        container.appendChild(divTitle);\n\n        var divClose = document.createElement(\"div\");\n        divClose.id = this._addUID(\"GPadvancedSearchClose\");\n        divClose.className = \"GPpanelClose\";\n        divClose.title = \"Fermer la recherche avance\";\n\n        if (divClose.addEventListener) {\n            divClose.addEventListener(\"click\", function() {\n                var id = \"#GPsearchInput-\" + self._uid;\n                document.querySelector(id + \" input\").disabled = false;\n                document.getElementById(self._addUID(\"GPgeocodeResultsList\")).style.display = \"none\";\n                document.getElementById(self._addUID(\"GPshowAdvancedSearch\")).style.display = \"inline-block\";\n                document.getElementById(self._addUID(\"GPadvancedSearchPanel\")).style.display = \"none\";\n            }, false);\n        } else if (divClose.attachEvent) {\n            divClose.attachEvent(\"onclick\", function() {\n                var id = \"#GPsearchInput-\" + self._uid;\n                document.querySelector(id + \" input\").disabled = false;\n                document.getElementById(self._addUID(\"GPgeocodeResultsList\")).style.display = \"none\";\n                document.getElementById(self._addUID(\"GPshowAdvancedSearch\")).style.display = \"inline-block\";\n                document.getElementById(self._addUID(\"GPadvancedSearchPanel\")).style.display = \"none\";\n            });\n        }\n\n        container.appendChild(divClose);\n\n        return container;\n    },\n\n    /** ... */\n    _createAdvancedSearchPanelFormElement: function(advancedSearchCodes) {\n\n        // contexte d'execution\n        var self = this;\n\n        var form = document.createElement(\"form\");\n        form.id = this._addUID(\"GPadvancedSearchForm\");\n        form.addEventListener(\"submit\", function(e) {\n\n            e.preventDefault();\n            // data\n            var data = [];\n            // liste des attributs de la ressource de geocodage\n            var id = \"#GPadvancedSearchFilters-\" + self._uid;\n            var matchesFilters = document.querySelectorAll(id + \" > div > div > input\");\n            for (var i = 0; i < matchesFilters.length; i++) {\n                var element = matchesFilters[i];\n                data.push({\n                    key: element.name,\n                    value: element.value\n                });\n            }\n\n            // gestionnaire d'evenement :\n            // on rcupre les valeurs de saisies pour requte sur le service de geocodage\n            self.onGeocodingAdvancedSearchSubmit(e, data);\n            document.getElementById(self._addUID(\"GPgeocodeResultsList\")).style.display = \"block\";\n\n            return false;\n        });\n\n        var div = document.createElement(\"div\");\n        div.className = \"GPflexInput\";\n\n        var label = document.createElement(\"label\");\n        label.className = \"GPadvancedSearchCodeLabel\";\n        label.innerHTML = \"Recherche par\";\n        div.appendChild(label);\n\n        var select = this._createAdvancedSearchFormCodeElement(advancedSearchCodes);\n        div.appendChild(select);\n\n        // FIXME on decompose la fonction pour les besoins du controle,\n        // on ajoutera ces childs  la main...\n\n        // var filters = this._createAdvancedSearchFormFiltersElement ();\n        // form.appendChild(filters);\n\n        // var input = this._createAdvancedSearchFormInputElement ();\n        // form.appendChild(input);\n\n        form.appendChild(div);\n\n        return form;\n    },\n\n    /** ... */\n    _createAdvancedSearchFormCodeElement: function(codes) {\n\n        // contexte d'execution\n        var self = this;\n\n        var select = document.createElement(\"select\");\n        select.id = this._addUID(\"GPadvancedSearchCode\");\n        select.className = \"GPadvancedSearchCode\";\n        select.addEventListener(\"change\", function(e) {\n            // var idx   = e.target.selectedIndex;\n            // var value = e.target.options[idx].value;\n            // gestionnaire d'evenement :\n            // permet de recuperer des informations diverses...\n            self.onGeocodingAdvancedSearchCodeChange(e);\n        }, false);\n\n        // liste statique au cas o des codes n'ont pas t passs en entre\n        if (!codes) {\n            codes = [{\n                id: \"PositionOfInterest\",\n                title: \"Lieux/toponymes\"\n            }, {\n                id: \"StreetAddress\",\n                title: \"Adresses\"\n            }, {\n                id: \"CadastralParcel\",\n                title: \"Parcelles cadastrales\"\n            }, {\n                id: \"Administratif\",\n                title: \"Administratif\"\n            }];\n        }\n\n        for (var i = 0; i < codes.length; i++) {\n            var option = document.createElement(\"option\");\n            option.value = codes[i].id;\n            option.text = codes[i].title;\n            select.appendChild(option);\n        }\n\n        return select;\n    },\n\n    /** ... */\n    _createAdvancedSearchFormInputElement: function() {\n\n        var input = document.createElement(\"input\");\n        input.type = \"submit\";\n        input.id = this._addUID(\"GPadvancedSearchSubmit\");\n        input.className = \"GPinputSubmit\";\n        input.value = \"Chercher\";\n\n        return input;\n    },\n\n    /**\n     * Filters geocoding.\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createAdvancedSearchFormFiltersElement: function() {\n\n        var container = document.createElement(\"div\");\n        container.id = this._addUID(\"GPadvancedSearchFilters\");\n        return container;\n    },\n\n    /**\n     * Create filter container for resources :\n     * \"PositionOfInterest\", \"StreetAddress\", ...\n     *\n     * @param {String} code - code of geocoding resource\n     */\n    _createAdvancedSearchFiltersTableElement: function(code, display) {\n\n        var container = document.createElement(\"div\");\n        container.id = this._addUID(code);\n        if (!display) {\n            container.style.display = \"none\";\n        }\n\n        return container;\n    },\n\n    /**\n     * Create filter attribut for a resource :\n     * \"PositionOfInterest\", \"StreetAddress\", ...\n     * Research filters are filled in Javascript depending on developer choice\n     *\n     * @param {Object} filterAttributes - filter attributes :\n     * @param {String} filterAttributes.code - code of geocoding resource\n     * @param {String} filterAttributes.name - ID\n     * @param {String} filterAttributes.title - label\n     * @param {String} filterAttributes.description - description\n     * @param {String} filterAttributes.value - value\n     */\n    _createAdvancedSearchFiltersAttributElement: function(filterAttributes) {\n\n        // INFORMATION\n        // cette methode peut tre appele si le document n'existe pas, elle\n        // permet ainsi de creer une div sans insertion dans le container...\n\n        var container = null;\n        var name = filterAttributes.name;\n        var title = filterAttributes.title;\n        var description = filterAttributes.description;\n        var code = filterAttributes.code;\n        var value = filterAttributes.value;\n\n        var div = document.createElement(\"div\");\n        div.className = \"GPflexInput\";\n\n        var label = document.createElement(\"label\");\n        label.className = \"GPadvancedSearchFilterLabel\";\n        label.htmlFor = name;\n        label.title = description || title;\n        label.innerHTML = title;\n        div.appendChild(label);\n\n        var input = document.createElement(\"input\");\n        input.id = name;\n        input.className = \"GPadvancedSearchFilterInput\";\n        input.type = \"text\";\n        input.name = name;\n        if (value) {\n            input.value = value;\n        }\n        div.appendChild(input);\n\n        container = document.getElementById(this._addUID(code));\n\n        if (container) {\n            container.appendChild(div);\n        } else {\n            // le container, c'est la div !\n            container = div;\n        }\n\n        return container;\n    },\n\n    // ################################################################### //\n    // ################## Geocoding results container #################### //\n    // ################################################################### //\n\n    /** ... */\n    _createGeocodeResultsHeaderElement: function() {\n\n        var self = this;\n\n        var container = document.createElement(\"div\");\n        container.className = \"GPpanelHeader\";\n\n        var divTitle = document.createElement(\"div\");\n        divTitle.className = \"GPpanelTitle\";\n        divTitle.innerHTML = \"Rsultats de la recherche\";\n        container.appendChild(divTitle);\n\n        var divClose = document.createElement(\"div\");\n        divClose.id = this._addUID(\"GPgeocodeResultsClose\");\n        divClose.className = \"GPpanelClose\";\n        divClose.title = \"Fermer la fentre de rsultats\";\n\n        if (divClose.addEventListener) {\n            divClose.addEventListener(\"click\", function() {\n                document.getElementById(self._addUID(\"GPgeocodeResultsList\")).style.display = \"none\";\n            }, false);\n        } else if (divClose.attachEvent) {\n            divClose.attachEvent(\"onclick\", function() {\n                document.getElementById(self._addUID(\"GPgeocodeResultsList\")).style.display = \"none\";\n            });\n        }\n        container.appendChild(divClose);\n\n        return container;\n    },\n\n    /**\n     * Geocoding results list.\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createGeocodeResultsListElement: function() {\n\n        // contexte d'execution\n        var self = this;\n\n        var container = document.createElement(\"div\");\n        container.id = this._addUID(\"GPgeocodeResults\");\n\n        if (container.addEventListener) {\n            container.addEventListener(\"click\", function(e) {\n                if (!e.ctrlKey) {\n                    document.getElementById(self._addUID(\"GPgeocodeResultsList\")).style.display = \"none\";\n                }\n                self.onGeocodedResultsItemClick(e);\n            }, false);\n        } else if (container.attachEvent) {\n            container.attachEvent(\"onclick\", function(e) {\n                if (!e.ctrlKey) {\n                    document.getElementById(self._addUID(\"GPgeocodeResultsList\")).style.display = \"none\";\n                }\n                self.onGeocodedResultsItemClick(e);\n            });\n        }\n        // Results are dynamically filled in Javascript by geocoding service\n        // <div class=\"GPautoCompleteProposal\">...</div>\n\n        return container;\n    },\n\n    /**\n     * Geocoding result.\n     * Results are dynamically filled in Javascript by geocoding service\n     *\n     * TODO formaliser le contenu des reponses\n     * FIXME formater la reponse en amont !\n     *\n     * @param {Object} location - suggested or geocoded location results\n     * @param {Number} id - ID\n     */\n    _createGeocodedLocationElement: function(location, id) {\n        var container = document.getElementById(this._addUID(\"GPgeocodeResults\"));\n\n        var div = document.createElement(\"div\");\n        div.id = this._addUID(\"GeocodedLocation_\" + id);\n        div.className = \"GPautoCompleteProposal\";\n\n        if (typeof location === \"string\") {\n            div.innerHTML = location;\n\n        } else {\n\n            var places = location.placeAttributes;\n\n            if (places.freeform) {\n                // reponse en freeForm\n                div.innerHTML = places.freeform;\n            } else if (places.postalCode) {\n                // cas des StreetAddress, PositionOfInterest, Administratif\n                // on affiche uniquement ce qui est commun aux ressources ...\n                div.innerHTML = places.postalCode + \" \" + places.commune;\n            } else if (places.cadastralParcel) {\n                // cas des CadastralParcel\n                div.innerHTML = places.cadastralParcel;\n            } else {\n                div.innerHTML = \"...\";\n            }\n        }\n\n        container.appendChild(div);\n    }\n};\n\nexport default SearchEngineDOM;\n\n\n\n// WEBPACK FOOTER //\n// ./src/Common/Controls/SearchEngineDOM.js","import ol from \"ol\";\nimport Gp from \"gp\";\nimport Proj4 from \"proj4\";\nimport Logger from \"../../Common/Utils/LoggerByDefault\";\nimport Utils from \"../../Common/Utils\";\nimport Markers from \"./Utils/Markers\";\nimport RightManagement from \"../../Common/Utils/CheckRightManagement\";\nimport SelectorID from \"../../Common/Utils/SelectorID\";\nimport MathUtils from \"../../Common/Utils/MathUtils\";\nimport MousePositionDOM from \"../../Common/Controls/MousePositionDOM\";\nimport \"../CRS/CRS\";\n\nvar logger = Logger.getLogger(\"GeoportalMousePosition\");\n\n/**\n * @classdesc\n * MousePosition Control.\n *\n * @constructor\n * @alias ol.control.GeoportalMousePosition\n * @extends {ol.control.Control}\n * @param {Object} options - options for function call.\n * @param {Sting}   [options.apiKey] - API key, mandatory if autoconf service has not been charged in advance\n * @param {Boolean} [options.collapsed = true] - Specify if MousePosition control should be collapsed at startup. Default is true.\n * @param {Array}   [options.systems] - list of projection systems, default are Geographical (\"EPSG:4326\"), Web Mercator (\"EPSG:3857\"), Lambert 93 (\"EPSG:2154\") and extended Lambert 2 (\"EPSG:27572\").\n *      Each array element (=system) is an object with following properties :\n * @param {String}  options.systems.crs - Proj4 crs alias (from proj4 defs). e.g. : \"EPSG:4326\". Required\n * @param {String}  [options.systems.label] - CRS label to be displayed in control. Default is crs code (e.g. \"EPSG:4326\")\n * @param {String}  options.systems.type - CRS units type for coordinates conversion : \"Geographical\" or \"Metric\". Default: \"Metric\"\n * @param {Object}  [options.systems.geoBBox] - Aera covered by the system (WGS84 coordinates).\n * @param {Number}  options.systems.geoBBox.right - Right bound.\n * @param {Number}  options.systems.geoBBox.left - Left bound.\n * @param {Number}  options.systems.geoBBox.top - Top bound.\n * @param {Number}  options.systems.geoBBox.bottom - Bottom bound.\n * @param {Array}   [options.units] - list of coordinates units, to be displayed in control units list.\n *      Values may be \"DEC\" (decimal degrees), \"DMS\" (sexagecimal), \"RAD\" (radians) and \"GON\" (grades) for geographical coordinates,\n *      and \"M\" or \"KM\" for metric coordinates\n * @param {Array}   [options.displayAltitude = true] - activate (true) or deactivate (false) the altitude panel. True by default\n * @param {Array}   [options.displayCoordinates = true] - activate (true) or deactivate (false) the coordinates panel. True by default\n * @param {Boolean} [options.editCoordinates = false] - add edit coordinates options. False by default.\n * @param {Object} [options.positionMarker] - options for position marker\n * @param {String} options.positionMarker.url - Marker url (define in src/Ol3/Controls/Utils/Markers.js)\n * @param {Array} options.positionMarker.offset - Offsets in pixels used when positioning the marker towards targeted point.\n *      The first element in the array is the horizontal offset. A positive value shifts the marker right.\n *      The second element in the array is the vertical offset. A positive value shifts the marker down. [0,0] value positions the top-left corner of the marker image to the targeted point.\n *      Default is offset associated to default marker image.\n * @param {Boolean} options.positionMarker.hide - if true, marker is not displayed, otherwise displayed (False by default.)\n * @param {Object}  [options.altitude] - elevation configuration\n * @param {Object}  [options.altitude.serviceOptions] - options of elevation service\n * @param {Number}  [options.altitude.responseDelay] - latency for altitude request, 500 ms by default\n * @param {Number}  [options.altitude.triggerDelay] - immobilisation time of movement on the map to trigger the elevation calculation, 200 ms by default\n * @param {Number}  [options.altitude.noDataValue] - value used for altitude service no data (default is -99999). In this case, \"---m\" will be displayed instead of \"-99999m\"\n * @param {Number}  [options.altitude.noDataValueTolerance] - tolerance for no data value :\n *                  values in [noDataValue + noDataValueTolerance ; noDataValue - noDataValueTolerance] interval will not be displayed, but \"---m\" will be displayed instead.\n *                  Default is 90000 (no data values = [-9999 ; -189999])\n *  @example\n *  var MousePosition = new ol.control.GeoportalMousePosition({\n *      collapsed : false,\n *      displayCoordinates : true,\n *      displayAltitude : true,\n *      altitude : {\n *           triggerDelay : 100,\n *           responseDelay : 500,\n *           noDataValue : -99999,\n *           noDataValueTolerance : 99000,\n *           serviceOptions : {}\n *      },\n *      systems : [\n *       {\n *          crs : \"EPSG:3857\",\n *          label : \"Web Mercator\",\n *          type : \"Metric\"\n *        },\n *       {\n *          crs : \"EPSG:4326\",\n *          label : \"Gographiques\",\n *          type : \"Geographical\"\n *        }\n *      ],\n *      units : [\"DEC\", \"DMS\"]\n * });\n */\nfunction MousePosition(options) {\n\n    options = options || {};\n\n    if (!(this instanceof MousePosition)) {\n        throw new TypeError(\"ERROR CLASS_CONSTRUCTOR\");\n    }\n\n    this._initialize(options);\n\n    // init control DOM container\n    var container = this._initContainer(options);\n\n    // call ol.control.Control constructor\n    ol.control.Control.call(this, {\n        element: container,\n        target: options.target,\n        render: options.render\n    });\n};\n\n// Inherits from ol.control.Control\nol.inherits(MousePosition, ol.control.Control);\n\n/**\n * @lends module:GeoportalMousePosition\n */\nMousePosition.prototype = Object.create(ol.control.Control.prototype, {});\n\n// on rcupre les mthodes de la classe commune MousePositionDOM\nUtils.assign(MousePosition.prototype, MousePositionDOM);\n\n/**\n * Constructor (alias)\n *\n * @private\n */\nMousePosition.prototype.constructor = MousePosition;\n\n/**\n * Overload ol.control.Control setMap method, called when\n */\nMousePosition.prototype.setMap = function(map) {\n    var context = this;\n\n    if (map) { // dans le cas de l'ajout du contrle  la map\n        var center = this._createMapCenter();\n        map.getViewport().appendChild(center);\n        if (!this.collapsed && !this._isDesktop) {\n            center.className = \"GPmapCenterVisible\";\n        }\n\n        // on met en place l'evenement sur la carte pour recuperer les coordonnes,\n        // on l'active  l'ouverture du panneau uniquement !\n        if (!this.collapsed) {\n            // evenement valable pour le mode desktop !\n            if (this._isDesktop) {\n                map.on(\n                    \"pointermove\",\n                    this.onMouseMove,\n                    this\n                );\n            } else {\n                map.on(\n                    \"moveend\",\n                    this.onMapMove,\n                    this\n                );\n            }\n        }\n\n        // add overlay only if option editCoordinates is true\n        if (this.options.editCoordinates) {\n            // cration de l'lment DOM\n            var markerDiv = document.createElement(\"img\");\n            markerDiv.id = this._addUID(\"GPmousePositionMarker\");\n            markerDiv.src = this._markerUrl;\n            markerDiv.title = \"Cliquer pour supprimer\";\n            markerDiv.addEventListener(\"click\", function() {\n                context._markerOverlay.setPosition(undefined);\n            });\n\n            this._markerOverlay = new ol.Overlay({\n                offset: this._markerOffset,\n                element: markerDiv,\n                stopEvent: false\n            });\n            map.addOverlay(this._markerOverlay);\n        }\n    }\n\n    // call original setMap method\n    ol.control.Control.prototype.setMap.call(this, map);\n\n    // nothing else to do if map == null\n    if (map == null) {\n        return;\n    }\n\n    // mode \"collapsed\"\n    if (!this.collapsed) {\n        var inputShow = document.getElementById(\"GPshowMousePosition-\" + this._uid);\n        inputShow.checked = \"checked\";\n        this._setElevationPanel(this.options.displayAltitude);\n        this._setCoordinatesPanel(this.options.displayCoordinates);\n        if (!this.options.displayCoordinates) {\n            this._setSettingsPanel(false);\n        }\n    }\n};\n\n// ################################################################### //\n// #################### user interface methods ####################### //\n// ################################################################### //\n\n/**\n * Set additional projection system\n *\n * @method addSystem\n * @param {Object} system - projection system\n * @param {String} system.crs - Proj4 crs alias (from proj4 defs) e.g. \"EPSG:4326\"\n * @param {String} [system.label] - CRS label to be displayed in control. Default is system.crs alias\n * @param {String} [system.type] - CRS units type for coordinates conversion (one of control options.units). Default is \"Metric\"\n */\nMousePosition.prototype.addSystem = function(system) {\n\n    if (typeof system !== \"object\") {\n        console.log(\"[ERROR] MousePosition:addSystem - system parameter should be an object\");\n        return;\n    }\n    if (!system.crs) {\n        logger.error(\"crs not defined !\");\n        return;\n    }\n    if (!system.label) {\n        logger.warn(\"crs label not defined, use crs code by default.\");\n        system.label = system.crs;\n    }\n    if (!system.type) {\n        logger.warn(\"type srs not defined, use 'Metric' by default.\");\n        system.type = \"Metric\";\n    }\n\n    // 1. add system to control systems\n    var found = false;\n    for (var j = 0; j < this._projectionSystems.length; j++) {\n        var obj = this._projectionSystems[j];\n        if (system.crs === obj.crs) {\n            found = true;\n            // warn user\n            logger.info(\"crs '{}' already configured\", obj.crs);\n        }\n    }\n    system.code = this._projectionSystems.length;\n    this._projectionSystems.push(system);\n\n    // 2. add system settings option to container (if it was already build)\n    var selectSystem = document.getElementById(\"GPmousePositionProjectionSystem-\" + this._uid);\n    if (selectSystem) {\n        var option = document.createElement(\"option\");\n        option.value = system.code;\n        option.text = system.label;\n        selectSystem.appendChild(option);\n    }\n};\n\n/**\n * Set additional projection systems\n *\n * @param {Array} systems - Array of system object, with following properties :\n * @param {String} systems.crs - Proj4 CRS alias (from proj4 defs) e.g. \"EPSG:4326\"\n * @param {String} systems.label - CRS label (for coordinates conversion)\n * @param {String} systems.type - CRS units type to be displayed in control (one of control options.units). Default is \"Metric\"\n */\nMousePosition.prototype.addSystems = function(systems) {\n    if (!systems) {\n        return;\n    }\n    if (!Array.isArray(systems)) {\n        console.log(\"[ERROR] MousePosition:addSystems - systems parameter should be an array\");\n        return;\n    }\n    for (var i = 0; i < systems.length; i++) {\n        this.addSystem(systems[i]);\n    }\n};\n\n/**\n * Remove projection system (in case there are several system with same code, only the first one will be removed)\n *\n * @param {String} systemCrs - CRS alias (from proj4 defs)\n */\nMousePosition.prototype.removeSystem = function(systemCrs) {\n    if (!systemCrs || typeof systemCrs !== \"string\") {\n        console.log(\"[ERROR] MousePosition:removeSystem - systemCode parameter should be a string\");\n        return;\n    }\n\n    var systemList = document.getElementById(\"GPmousePositionProjectionSystem-\" + this._uid);\n\n    var systemCode = null;\n    // find system in control projection systems list\n    for (var i = 0; i < this._projectionSystems.length; i++) {\n        var proj = this._projectionSystems[i];\n        if (systemCrs === proj.crs) {\n            systemCode = proj.code;\n            // remove system from control projection systems list\n            this._projectionSystems.splice(i, 1);\n            break;\n        }\n    }\n\n    if (systemCode == null) {\n        console.log(\"[WARN] MousePosition:removeSystem - system not found\");\n        return;\n    }\n\n    /*re-initialization of codes*/\n    var oldNewCodeMap = [];\n\n    for (var j = 0; j < this._projectionSystems.length; j++) {\n        oldNewCodeMap[Number(this._projectionSystems[j].code)] = j;\n        this._projectionSystems[j].code = j;\n    }\n\n    /*find system in control container systems list*/\n    var indexChildToRemove = null;\n\n    for (var k = 0; k < systemList.childNodes.length; k++) {\n        if (systemCode == systemList.childNodes[j].value) {\n            indexChildToRemove = k;\n            continue;\n        }\n        systemList.childNodes[j].value = oldNewCodeMap[Number(systemList.childNodes[j].value)];\n    }\n    /*remove system from control container systems list*/\n    if (indexChildToRemove != null) {\n        systemList.removeChild(systemList.childNodes[indexChildToRemove]);\n    }\n\n    /*choose arbitrarily a new current system if needed*/\n    if (this._currentProjectionSystems.code == systemCode) {\n        systemList.childNodes[0].setAttribute(\"selected\", \"selected\");\n        this._setCurrentSystem(systemList.childNodes[0].value);\n    }\n};\n\n/**\n * Set control units (to be displayed)\n *\n * @param {Array} units - list of all coordinates units, to be displayed in control units list.\n *      Values may be \"DEC\" (decimal degrees), \"DMS\" (sexagecimal), \"RAD\" (radians) and \"GON\" (grades) for geographical coordinates,\n *      and \"M\" or \"KM\" for metric coordinates\n */\nMousePosition.prototype.setUnits = function(units) {\n    if (!units || !Array.isArray(units)) {\n        return;\n    }\n    this.options.units = units;\n    this._projectionUnits = [];\n    this._initProjectionUnits();\n    if (this._currentProjectionType) {\n        this._setTypeUnitsPanel(this._currentProjectionType);\n    }\n};\n\n/**\n * Set control altitude options (useless if displayAltitude == false)\n *\n * @param {Object} options - altitude options\n * @param {Object}  [options.serviceOptions] - options of elevation service\n * @param {Number}  [options.responseDelay] - latency for elevation request, 500 ms by default\n * @param {Number}  [options.triggerDelay] - immobilisation time of movement on the map to trigger the elevation calculation, 200 ms by default\n */\nMousePosition.prototype.setAltitudeOptions = function(options) {\n    if (!options || typeof options !== \"object\") {\n        return;\n    }\n    this.options.altitude.triggerDelay = options.triggerDelay;\n    this.options.altitude.responseDelay = options.responseDelay;\n    if (options.serviceOptions) {\n        for (var opt in options.serviceOptions) {\n            if (options.serviceOptions.hasOwnProperty(opt)) {\n                this.options.altitude.serviceOptions[opt] = options.serviceOptions[opt];\n            }\n        }\n    }\n};\n\n/**\n * Display or hide elevation panel\n *\n * @param {Boolean} displayAltitude - true to display elevation panel, false to hide it\n */\nMousePosition.prototype.displayAltitude = function(displayAltitude) {\n    if (displayAltitude === undefined) {\n        return;\n    }\n    if (typeof this._noRightManagement === \"undefined\") {\n        this._checkRightsManagement();\n    }\n    this.options.displayAltitude = displayAltitude;\n    this._setElevationPanel(displayAltitude);\n};\n\n/**\n * Display or hide coordinates panel\n *\n * @param {Boolean} displayCoordinates - true to display coordinates panel, false to hide it\n */\nMousePosition.prototype.displayCoordinates = function(displayCoordinates) {\n    if (displayCoordinates === undefined) {\n        return;\n    }\n    this.options.displayCoordinates = displayCoordinates;\n    this._setCoordinatesPanel(displayCoordinates);\n    this._setSettingsPanel(displayCoordinates);\n};\n\n/**\n * Collapse or display control main container\n *\n * @param {Boolean} collapsed - True to collapse control, False to display it\n */\nMousePosition.prototype.setCollapsed = function(collapsed) {\n    if (collapsed === undefined) {\n        console.log(\"[ERROR] MousePosition:setCollapsed - missing collapsed parameter\");\n        return;\n    }\n    if ((collapsed && this.collapsed) || (!collapsed && !this.collapsed)) {\n        return;\n    }\n    if (!this._isDesktop) {\n        document.getElementById(\"GPmapCenter\").className = collapsed ? \"\" : \"GPmapCenterVisible\";\n    }\n    // on simule l'ouverture du panneau aprs un click\n    this.onShowMousePositionClick();\n    this._showMousePositionContainer.checked = !collapsed;\n};\n\n// ################################################################### //\n// ######################## initialize control ####################### //\n// ################################################################### //\n\n/**\n * Initialize control (called by MousePosition constructor)\n *\n * @method _initialize\n * @param {Object} options - control options (set by user)\n * @private\n */\nMousePosition.prototype._initialize = function(options) {\n\n    // Set default options\n    // {Object} control options - set by user or by default\n    this.options = options || {};\n    this.options.collapsed = (options.collapsed !== undefined) ? options.collapsed : true;\n    /** {Boolean} specify if MousePosition control is collapsed (true) or not (false) */\n    this.collapsed = this.options.collapsed;\n\n    // position marker\n    this._markerOverlay = null;\n    this._markerUrl = null;\n    this._markerOffset = [0, 0];\n    this._hideMarker = false;\n    this._initMarker(options.positionMarker);\n\n    this.options.units = options.units || [];\n    this.options.displayAltitude = (options.displayAltitude !== undefined) ? options.displayAltitude : true;\n    this.options.displayCoordinates = (options.displayCoordinates !== undefined) ? options.displayCoordinates : true;\n    if (this.options.displayCoordinates) {\n        this.options.editCoordinates = (options.editCoordinates !== undefined) ? options.editCoordinates : false;\n    } else {\n        // si les coordonnes ne sont pas affiches : pas besoin de les diter...\n        this.options.editCoordinates = false;\n    }\n    this.editing = false;\n\n    this.options.systems = options.systems || [];\n    if (options.altitude) {\n        var altitude = options.altitude;\n        this.options.altitude = {\n            triggerDelay: (altitude.triggerDelay !== undefined) ? altitude.triggerDelay : 200,\n            responseDelay: (altitude.responseDelay !== undefined) ? altitude.responseDelay : 500,\n            serviceOptions: altitude.serviceOptions || {},\n            noDataValue: (altitude.noDataValue !== undefined) ? altitude.noDataValue : -99999,\n            noDataValueTolerance: (altitude.noDataValueTolerance !== undefined) ? altitude.noDataValueTolerance : 90000\n        };\n    } else {\n        this.options.altitude = {\n            triggerDelay: 200,\n            responseDelay: 500,\n            serviceOptions: {}\n        };\n    }\n\n    // identifiant du contrle : utile pour suffixer les identifiants CSS (pour grer le cas o il y en a plusieurs dans la mme page)\n    this._uid = SelectorID.generate();\n\n    // initialisation des systemes de projections\n    this._projectionSystems = [];\n    this._initProjectionSystems();\n\n    // initialisation des systemes des units\n    this._projectionUnits = {};\n    this._initProjectionUnits();\n\n    // detection du support : desktop ou tactile\n    this._isDesktop = Utils.detectSupport();\n\n    // on met en place un seuil sur le timer\n    if (this.options.altitude.triggerDelay < 100) {\n        this.options.altitude.triggerDelay = 100;\n    }\n\n    // {Number} timer on movestopped delay (altitude calculation)\n    this._timer = this.options.altitude.triggerDelay;\n\n    // {Object} Selected projection system\n    this._currentProjectionSystems = this._projectionSystems[0];\n\n    // {String} Selected projection units typs : Geographical or metric\n    this._currentProjectionType = this._projectionSystems[0].type;\n\n    // {String} Selected projection unit\n    this._currentProjectionUnits = this._projectionUnits[this._currentProjectionType][0].code;\n\n    // {Object} Projection units container (DOM Element)\n    this._projectionUnitsContainer = null;\n\n    // {Object} control panel container (DOM Element)\n    this._showMousePositionContainer = null;\n\n    // gestion de l'affichage du panneau de l'altitude\n    if (!this.options.displayAltitude && !this.options.displayCoordinates) {\n        // on reactive l'affichage des coordonnes, pour ne pas afficher un panneau vide !\n        this.options.displayCoordinates = true;\n    }\n\n    // gestion des droits sur les ressources/services\n    // si l'on souhaite un calcul d'altitude, on verifie les droits sur les ressources d'alti...\n    if (this.options.displayAltitude) {\n        this._checkRightsManagement();\n    }\n};\n\n/**\n *\n * @param {Object} option - positionMarker option\n * @private\n */\nMousePosition.prototype._initMarker = function(option) {\n    if (!this.options.editCoordinates) {\n        return;\n    }\n\n    if (!option) {\n        this._markerUrl = Markers[\"lightOrange\"];\n        this._markerOffset = Markers.defaultOffset;\n        return;\n    }\n\n    // hide\n    this._hideMarker = (option.hide !== undefined) ? option.hide : false;\n\n    // offset\n    if (option.offset) {\n        if (Array.isArray(option.offset) && option.offset.length === 2) {\n            this._markerOffset = option.offset;\n        } else {\n            console.log(\"positionMarker.offset should be an array. e.g. : [0,0]\");\n            this._markerOffset = Markers.defaultOffset;\n        }\n    } else {\n        this._markerOffset = Markers.defaultOffset;\n    }\n\n    var url = option.url;\n    if (!url) {\n        this._markerUrl = Markers[\"lightOrange\"];\n    } else if (url.match(/^[a-zA-Z]+$/)) { // un seul mot\n        this._markerUrl = (Markers[url] !== undefined) ? Markers[url] : Markers[\"lightOrange\"];\n    } else {\n        this._markerUrl = url;\n    }\n};\n\n/**\n * this method is called by the constructor and initialize the projection\n * systems.\n * getting coordinates in the requested projection :\n * see this.onMousePositionProjectionSystemChange()\n *\n * @method _initProjectionSystems\n * @private\n */\nMousePosition.prototype._initProjectionSystems = function() {\n\n    // on donne la possibilit  l'utilisateur de modifier\n    // la liste des systmes  afficher\n    // Ex. this.options.systems\n\n    // systemes de projection disponible par defaut\n    var projectionSystemsByDefault = [{\n        label: \"G\\u00e9ographique\",\n        crs: ol.proj.get(\"EPSG:4326\").getCode(),\n        type: \"Geographical\"\n    }, {\n        label: \"Web Mercator\",\n        crs: ol.proj.get(\"EPSG:3857\").getCode(),\n        type: \"Metric\"\n    }, {\n        label: \"Lambert 93\",\n        crs: ol.proj.get(\"EPSG:2154\").getCode(),\n        type: \"Metric\",\n        geoBBox: {\n            left: -9.86,\n            bottom: 41.15,\n            right: 10.38,\n            top: 51.56\n        }\n    }, {\n        label: \"Lambert II \\u00e9tendu\",\n        crs: ol.proj.get(\"EPSG:27572\"),\n        type: \"Metric\",\n        geoBBox: {\n            left: -4.87,\n            bottom: 42.33,\n            right: 8.23,\n            top: 51.14\n        }\n    }];\n\n    var systems = this.options.systems;\n    for (var i = 0; i < systems.length; i++) {\n        /*definition d'un systeme de reference*/\n        var sys = systems[i];\n        this.addSystem(sys);\n    }\n\n    if (this._projectionSystems.length === 0) {\n        // on ajoute les systmes de projections par dfaut\n        for (var j = 0; j < projectionSystemsByDefault.length; j++) {\n            this.addSystem(projectionSystemsByDefault[j]);\n        }\n    }\n};\n\n/**\n * this method is called by the constructor and initialize the units.\n * getting coordinates in the requested units :\n * see this.onMousePositionProjectionUnitsChange()\n *\n * @method _initProjectionUnits\n * @private\n */\nMousePosition.prototype._initProjectionUnits = function() {\n\n    // on donne la possibilit  l'utilisateur de modifier\n    // la liste des units  afficher\n    // Ex.\n    // this.options.units : [\"DEC\", \"DMS\"]\n\n    // units disponible par defaut\n    var projectionUnitsByDefault = {\n        Geographical: [{\n            code: \"DEC\",\n            label: \"degrs dcimaux\",\n            format: this._displayDEC\n        }, {\n            code: \"DMS\",\n            label: \"degrs sexagsimaux\",\n            format: this._displayDMS\n        }, {\n            code: \"RAD\",\n            label: \"radians\",\n            format: this._displayRAD\n        }, {\n            code: \"GON\",\n            label: \"grades\",\n            format: this._displayGON\n        }],\n        Metric: [{\n            code: \"M\",\n            label: \"mtres\",\n            format: this._displayMeter\n        }, {\n            code: \"KM\",\n            label: \"kilomtres\",\n            format: this._displayKMeter\n        }]\n    };\n\n    var units = this.options.units;\n\n    for (var type in projectionUnitsByDefault) {\n        if (projectionUnitsByDefault.hasOwnProperty(type)) {\n            var found = false;\n            for (var j = 0; j < projectionUnitsByDefault[type].length; j++) {\n                var obj = projectionUnitsByDefault[type][j];\n                for (var i = 0; i < units.length; i++) {\n                    var unit = units[i];\n                    if (obj.code === unit) {\n                        found = true;\n                        if (!this._projectionUnits[type]) {\n                            this._projectionUnits[type] = [];\n                        }\n                        this._projectionUnits[type].push(obj);\n                    }\n                }\n            }\n            if (!found) {\n                this._projectionUnits[type] = projectionUnitsByDefault[type];\n            }\n        }\n    }\n\n    // au cas o...\n    if (typeof this._projectionUnits === \"object\" && Object.keys(this._projectionUnits).length === 0) {\n        this._projectionUnits = projectionUnitsByDefault;\n    }\n};\n\n/**\n * this method get label from the current projection units\n *\n * @method _getCurrentProjectionInformation\n * @private\n */\nMousePosition.prototype._getCurrentProjectionInformation = function() {\n    var systemInfo = [\n        this._currentProjectionSystems.label,\n        \"en\"\n    ];\n\n    var units = this._projectionUnits[this._currentProjectionType];\n    for (var u = 0; u < units.length; ++u) {\n        if (units[u].code === this._currentProjectionUnits) {\n            systemInfo.push(units[u].label);\n            break;\n        }\n    }\n    return systemInfo.join(\" \");\n};\n\n/**\n * this method is called by constructor\n * and check the rights to resources\n *\n * @method _checkRightsManagement\n * @private\n */\nMousePosition.prototype._checkRightsManagement = function() {\n\n    var rightManagement = RightManagement.check({\n        key: this.options.apiKey,\n        resources: [\"SERVICE_CALCUL_ALTIMETRIQUE_RSC\"],\n        services: [\"Elevation\"]\n    });\n\n    this._noRightManagement = !rightManagement;\n\n    // on recupre les informations utiles\n    // sur ce controle, on ne s'occupe pas de la ressource car elle est unique...\n    // Ex. la clef API issue de l'autoconfiguration si elle n'a pas\n    // t renseigne.\n    if (!this.options.apiKey) {\n        this.options.apiKey = rightManagement.key;\n    }\n\n};\n\n// ################################################################### //\n// ######################## methods handle dom ####################### //\n// ################################################################### //\n\n/**\n * Create control main container (called by MousePosition constructor)\n *\n * @method _initContainer\n * @private\n */\nMousePosition.prototype._initContainer = function() {\n    // creation du container principal\n    var container = this._createMainContainerElement();\n\n    var inputShow = this._showMousePositionContainer = this._createShowMousePositionElement();\n    container.appendChild(inputShow);\n\n    var picto = this._createShowMousePositionPictoElement(this._isDesktop);\n    container.appendChild(picto);\n\n    var panel = this._createMousePositionPanelElement(\n        this.options.displayAltitude,\n        this.options.displayCoordinates,\n        this.options.editCoordinates,\n        this._currentProjectionUnits\n    );\n    var settings = this._createMousePositionSettingsElement();\n    var systems = this._projectionSystemsContainer = this._createMousePositionSettingsSystemsElement(this._projectionSystems);\n    var units = this._projectionUnitsContainer = this._createMousePositionSettingsUnitsElement(this._projectionUnits[this._currentProjectionType]);\n\n    settings.appendChild(systems);\n    settings.appendChild(units);\n    panel.appendChild(settings);\n    container.appendChild(panel);\n\n    return container;\n};\n\n/**\n * this method is called by this.()\n * and it changes the elevation view panel into the dom.\n *\n * @method _setElevationPanel\n * @param {Boolean} active - true:active, false:disable\n * @private\n */\nMousePosition.prototype._setElevationPanel = function(active) {\n    var div = null;\n\n    if (!active) {\n        div = document.getElementById(\"GPmousePositionAltitude-\" + this._uid);\n        div.style.display = \"none\";\n    } else {\n        if (this._noRightManagement) {\n            div = document.getElementById(\"GPmousePositionAlt-\" + this._uid);\n            div.innerHTML = \"No rights!\";\n        } else {\n            div = document.getElementById(\"GPmousePositionAltitude-\" + this._uid);\n            div.style.display = \"\";\n        }\n    }\n};\n\n/**\n * this method is called by this.()\n * and it changes the coordinate view panel into the dom.\n *\n * @method _setCoordinatesPanel\n * @param {Boolean} active - true:active, false:disable\n * @private\n */\nMousePosition.prototype._setCoordinatesPanel = function(active) {\n    var div = document.getElementById(\"GPmousePositionCoordinate-\" + this._uid);\n    if (!active) {\n        div.style.display = \"none\";\n    } else {\n        div.style.display = \"\";\n    }\n};\n\n/**\n * this method is called by this.()\n * and it changes the settings view panel into the dom.\n *\n * @method _setSettingsPanel\n * @param {Boolean} active - true:active, false:disable\n * @private\n */\nMousePosition.prototype._setSettingsPanel = function(active) {\n    var divPicto = document.getElementById(\"GPshowMousePositionSettingsPicto-\" + this._uid);\n    var divPanel = document.getElementById(\"GPmousePositionSettings-\" + this._uid);\n    if (!active) {\n        divPicto.style.display = \"none\";\n        divPanel.style.display = \"none\";\n    } else {\n        divPicto.style.display = \"\";\n        divPanel.style.display = \"\";\n    }\n};\n\n/**\n * this method is called by this.onMousePositionProjectionSystemChange()\n * when changes to a metric or a geographical units.\n *\n * @method _setTypeUnitsPanel\n * @param {String} type - Geographical or Metric\n * @private\n */\nMousePosition.prototype._setTypeUnitsPanel = function(type) {\n    var container = this._projectionUnitsContainer;\n\n    // on supprime les enfants...\n    while (container.firstChild) {\n        container.removeChild(container.firstChild);\n    }\n\n    var units = this._projectionUnits[type];\n    for (var j = 0; j < units.length; j++) {\n        var obj = units[j];\n        var option = document.createElement(\"option\");\n        option.value = (obj.code) ? obj.code : j;\n        option.text = obj.label || j;\n        // option.label = obj.label;\n        container.appendChild(option);\n    }\n\n    var projectionUnits = this._projectionUnits[type][0].code;\n\n    if (this._currentProjectionUnits === \"DMS\" || projectionUnits === \"DMS\") {\n        this._resetCoordinateElements(this.options.editCoordinates, type, projectionUnits);\n        this._setEditMode(this.editing);\n    }\n\n    // le nouveau type de system ...\n    this._currentProjectionType = type;\n\n    // Mise a jour des elements labels et unites\n    this._resetLabelElements(type);\n    this._resetUnitElements(projectionUnits);\n\n    // et comme on a chang de type de systeme,\n    // il faut changer aussi d'unit !\n    this._currentProjectionUnits = projectionUnits;\n};\n\n// ################################################################### //\n// ######################## method units format ###################### //\n// ################################################################### //\n\n/**\n * degreedecimal\n *\n * @method _displayDEC\n * @param {Array} olCoordinate - ol.Coordinate object [lon, lat]\n * @return {Object} coordinate - coordinate object : {lat : 48, lng : 2} par exemple\n * @private\n */\nMousePosition.prototype._displayDEC = function(olCoordinate) {\n    var coordinate = {};\n    coordinate.lat = olCoordinate[1].toFixed(6);\n    coordinate.lng = olCoordinate[0].toFixed(6);\n    coordinate.unit = \"\";\n    return coordinate;\n};\n\n/**\n * degreedecimal2sexagecimal\n *\n * @method _displayDMS\n * @param {Array} olCoordinate - ol.Coordinate object [lon, lat]\n * @return {Object} coordinate - coordinate object : {lng : \"2 00 00 E\", lat : \"48 00 00 N\"} par exemple\n * @private\n */\nMousePosition.prototype._displayDMS = function(olCoordinate) {\n    return {\n        lng: MathUtils.decimalToDMS(olCoordinate[0], \"EO\", 2),\n        lat: MathUtils.decimalToDMS(olCoordinate[1], \"NS\", 2),\n        unit: \"DMS\"\n    };\n};\n\n/**\n * degreedecimal2radian\n *\n * @method _displayRAD\n * @param {Array} olCoordinate - ol.Coordinate object [lon, lat]\n * @return {Object} coordinate - coordinate object : {lng : \"0.02837864\", lat : \"0.84300269\"} par exemple\n * @private\n */\nMousePosition.prototype._displayRAD = function(olCoordinate) {\n    var coordinate = {};\n    var d = 0.01745329251994329577;\n    coordinate.lng = olCoordinate[0] * d;\n    coordinate.lng = coordinate.lng.toFixed(8);\n    coordinate.lat = olCoordinate[1] * d;\n    coordinate.lat = coordinate.lat.toFixed(8);\n    coordinate.unit = \"rad\";\n    return coordinate;\n};\n\n/**\n * degreedecimal2grade\n *\n * @method _displayGON\n * @param {Array} olCoordinate - ol.Coordinate object [lon, lat]\n * @return {Object} coordinate - coordinate object : {lng : \"4.09545898\", lat : \"53.68751528\"} par exemple\n * @private\n */\nMousePosition.prototype._displayGON = function(olCoordinate) {\n    var coordinate = {};\n    var d = 1.11111111111111111111;\n    coordinate.lng = olCoordinate[0] * d;\n    coordinate.lng = coordinate.lng.toFixed(8);\n    coordinate.lat = olCoordinate[1] * d;\n    coordinate.lat = coordinate.lat.toFixed(8);\n    coordinate.unit = \"gon\";\n    return coordinate;\n};\n\n/**\n * meter\n *\n * @method _displayMeter\n * @param {Array} olCoordinate - ol.Coordinate object [lon, lat]\n * @return {Object} coordinate - coordinate object : {x : \"148593.58\", y : \"6176560.95\"} par exemple\n * @private\n */\nMousePosition.prototype._displayMeter = function(olCoordinate) {\n    // on recoit toujours des coordonnes metriques\n    var coordinate = {};\n    coordinate.x = olCoordinate[0].toFixed(2);\n    coordinate.y = olCoordinate[1].toFixed(2);\n    coordinate.unit = \"m\";\n    return coordinate;\n};\n\n/**\n * kilometer\n *\n * @method _displayKMeter\n * @param {Array} olCoordinate - ol.Coordinate object [lon, lat]\n * @return {Object} coordinate - coordinate object : {x : \"214.96\", y : \"6250.09\"} par exemple\n * @private\n */\nMousePosition.prototype._displayKMeter = function(olCoordinate) {\n    var coordinate = {};\n    coordinate.x = (olCoordinate[0] / 1000).toFixed(2);\n    coordinate.y = (olCoordinate[1] / 1000).toFixed(2);\n    coordinate.unit = \"km\";\n    return coordinate;\n};\n\n// ################################################################### //\n// ##################### handlers events to control ################## //\n// ################################################################### //\n\n/**\n * this sends the coordinates to the panel.\n * (cf. this.GPdisplayCoords() into the DOM functions)\n *\n * @method _setCoordinate\n * @param {Array} olCoordinate - ol.Coordinate object [lon, lat]\n * @param {Object} crs - coordinate CRS (ol.proj.Projection)\n * @private\n */\nMousePosition.prototype._setCoordinate = function(olCoordinate, crs) {\n\n    // structure\n    // ol.Coordinate\n    //      [\n    //          4   // lon\n    //          48  // lat\n    //      ]\n\n    // structure pour les coordonnes en fonctin du type demand :\n    // {x:, y:, unit:} ou {lng:, lat:} ou {lon:, lat:} ou {e:, n:, unit:}...\n    var coordinate = {};\n    // on projete le point dans le systeme demand\n    var oSrs = this._currentProjectionSystems.crs;\n    if (!oSrs) {\n        console.log(\"ERROR : system crs not found\");\n        return;\n    }\n    // on reprojette les coordonnes depuis leur CRS d'origine (CRS) vers le CRS demand (oSrs)\n    olCoordinate = ol.proj.transform(olCoordinate, crs, oSrs);\n\n    // type de systeme : Geographical ou Metric\n    var type = this._currentProjectionSystems.type;\n\n    // on recherche la fonction de formatage dans l'unit demande\n    var format = null;\n    var units = this._projectionUnits[type];\n    for (var i = 0; i < units.length; i++) {\n        if (units[i].code === this._currentProjectionUnits) {\n            format = units[i].format;\n            break;\n        }\n    }\n    if (!format || typeof format !== \"function\") {\n        console.log(\"WARNING : coordinates format function not found\");\n        return;\n    } else {\n        coordinate = format(olCoordinate);\n    }\n\n    if (!coordinate || Object.keys(coordinate).length === 0) {\n        return;\n    }\n\n    this.GPdisplayCoords(coordinate);\n};\n\n/**\n * this sends the coordinates to the panel.\n * (cf. this.GPdisplayElevation() into the DOM functions)\n *\n * @method _setElevation\n * @param {Array} olCoordinate - ol.Coordinate object [lon, lat]\n * @private\n */\nMousePosition.prototype._setElevation = function(olCoordinate) {\n    // gestion du timer de la requete du service d'altitude\n    var delay = this.options.altitude.responseDelay;\n    var noDataValue = this.options.altitude.noDataValue;\n    var noDataValueTolerance = this.options.altitude.noDataValueTolerance;\n    this.GPdisplayElevation(olCoordinate, delay, noDataValue, noDataValueTolerance);\n};\n\n/**\n * this method is triggered when the mouse or the map is stopped.\n * (cf. onMouseMove and onMapMove)\n *\n * @method onMoveStopped\n * @param {Array} olCoordinate - ol.Coordinate object [lon, lat]\n * @param {Object} crs - coordinate CRS (ol.proj.Projection)\n * @private\n */\nMousePosition.prototype.onMoveStopped = function(olCoordinate, crs) {\n    // reprojection en CRS:84 (EPSG:4326) pour le calcul alti\n    var oLatLng = ol.proj.transform(olCoordinate, crs, \"EPSG:4326\");\n    this._setElevation(oLatLng);\n};\n\n/**\n * this method is an handler event to control. The event is 'mousemove' on\n * the map. The handler sends the coordinates to the panel.\n * (cf. this.GPdisplayCoords() into the DOM functions)\n *\n * @method onMouseMove\n * @param {Object} e - HTMLElement\n * @private\n */\nMousePosition.prototype.onMouseMove = function(e) {\n\n    var self = this;\n\n    // info: coordinate = [x, y]\n    var coordinate = e.coordinate;\n    if (!e.map || !e.map.getView()) {\n        return;\n    }\n    var crs = e.map.getView().getProjection();\n\n    this._setCoordinate(coordinate, crs);\n\n    // calcul de l'altitude aprs un certain dlai aprs l'arrt du mouvement de la souris\n    clearTimeout(this._timer);\n    this._timer = setTimeout(function() {\n        self.onMoveStopped(coordinate, crs);\n    }, this.options.altitude.triggerDelay);\n};\n\n/**\n * this method is an handler event to control. The event is 'moveend' on\n * the map. The handler sends the coordinates to the panel.\n * (cf. this.GPdisplayCoords() into the DOM functions)\n *\n * @method onMapMove\n * @private\n */\nMousePosition.prototype.onMapMove = function() {\n\n    var self = this;\n\n    var map = this.getMap();\n    if (!map || !map.getView()) {\n        return;\n    }\n    var view = map.getView();\n    var coordinate = view.getCenter();\n    var crs = view.getProjection();\n\n    this._setCoordinate(coordinate, crs);\n\n    // calcul de l'altitude aprs un certain dlai aprs l'arrt du mouvement de la souris\n    clearTimeout(this._timer);\n    this._timer = setTimeout(function() {\n        self.onMoveStopped(coordinate, crs);\n    }, this.options.altitude.triggerDelay);\n\n};\n\n// ################################################################### //\n// ####################### handlers events to dom #################### //\n// ################################################################### //\n\n/**\n * this method is called by this.GPdisplayElevation() in the dom, and\n * it executes a request to the elevation service.\n *\n * @method onRequestAltitude\n * @param {Object} coordinate - {lat:..., lng:...}\n * @private\n */\nMousePosition.prototype.onRequestAltitude = function(coordinate, callback) {\n\n    // INFORMATION\n    // on effectue la requte au service d'altitude...\n    // on met en place des callbacks afin de recuperer les resultats ou\n    // les messages d'erreurs du service.\n    // le resultat est affich dans une balise du dom.\n    // les messages d'erreurs sont affichs sur la console (?)\n\n    if (!coordinate || Object.keys(coordinate).length === 0) {\n        return;\n    }\n\n    // si on ne veut pas de calcul d'altitude, on ne continue pas !\n    if (!this.options.displayAltitude) {\n        return;\n    }\n\n    // si on n'a pas les droits sur la ressource, pas la peine de\n    // continuer !\n    if (this._noRightManagement) {\n        console.log(\"[WARNING] contract key configuration has no rights to load geoportal elevation \");\n        document.getElementById(\"GPmousePositionAlt-\" + this._uid).innerHTML = \"No rights!\";\n        return;\n    }\n\n    // on recupere les options du service\n    var options = this.options.altitude.serviceOptions || {};\n\n    // gestion du protocole et du timeout\n    // le timeout est indispensable sur le protocole JSONP.\n    var _protocol = options.protocol || \"XHR\";\n    var _timeout = options.timeOut || 0;\n    if (_protocol === \"JSONP\" && _timeout === 0) {\n        _timeout = 15000;\n    }\n\n    // ainsi que les coordonnes\n    var _zonly = true;\n    var _positions = [{\n        lon: coordinate[0],\n        lat: coordinate[1]\n    }];\n\n    // et les callbacks\n    var _scope = this;\n    var _rawResponse = options.rawResponse || false;\n    var _onSuccess = null;\n    var _onFailure = null;\n\n    if (!_rawResponse) {\n        // dans le cas gnral\n        /** callback onSuccess */\n        _onSuccess = function(results) {\n            if (results && Object.keys(results)) {\n                callback.call(this, results.elevations[0].z);\n            }\n        };\n    } else {\n        /** callback onSuccess */\n        _onSuccess = function(results) {\n            console.log(\"alti service raw response : \", results);\n        };\n    }\n\n    /** callback onFailure */\n    _onFailure = function(error) {\n        console.log(\"[getAltitude] ERROR : \" + error.message);\n    };\n\n    // cas o la clef API n'est pas renseigne dans les options du service,\n    // on utilise celle de l'autoconf ou celle renseigne au niveau du controle\n    var _apiKey = options.apiKey || this.options.apiKey;\n\n    Gp.Services.getAltitude({\n        apiKey: _apiKey,\n        protocol: _protocol,\n        timeOut: _timeout,\n        scope: _scope,\n        rawResponse: _rawResponse,\n        onSuccess: _onSuccess,\n        onFailure: _onFailure,\n        zonly: _zonly,\n        positions: _positions\n    });\n};\n\n/**\n * this method is called by event 'click' on 'GPshowMousePositionPicto' tag label\n * (cf. this._createShowMousePositionPictoElement),\n * and toggles event 'mousemove' on map.\n *\n * @method onShowMousePositionClick\n * @private\n */\nMousePosition.prototype.onShowMousePositionClick = function() {\n\n    // checked : true - panel close\n    // checked : false - panel open\n    var map = this.getMap();\n    this.collapsed = this._showMousePositionContainer.checked;\n    // on gnre nous mme l'evenement OpenLayers de changement de proprit\n    // (utiliser mousePosition.on(\"change:collapsed\", function(e) ) pour s'abonner  cet vnement)\n    this.dispatchEvent(\"change:collapsed\");\n\n    // evenement declench  l'ouverture/fermeture du panneau,\n    // et en fonction du mode : desktop ou tactile !\n    if (this._showMousePositionContainer.checked) {\n        if (this._isDesktop) {\n            map.un(\"pointermove\", this.onMouseMove, this);\n        } else {\n            map.un(\"moveend\", this.onMapMove, this);\n        }\n    } else if (!this.editing) {\n        if (this._isDesktop) {\n            map.on(\"pointermove\", this.onMouseMove, this);\n        } else {\n            map.on(\"moveend\", this.onMapMove, this);\n            // on simule un deplacement en mode tactile\n            this.onMapMove();\n        }\n    }\n\n    // FIXME\n    // on gre l'affichage des panneaux ici..., mme si ce n'est pas l'endroit\n    // adequate...\n    this._setElevationPanel(this.options.displayAltitude);\n    this._setCoordinatesPanel(this.options.displayCoordinates);\n    if (!this.options.displayCoordinates) {\n        this._setSettingsPanel(false);\n    }\n};\n\n/**\n * this method is called by event 'click' on input coordinate\n *\n * @method onMousePositionEditModeClick\n * @param {Boolean} editing - editing mode\n */\nMousePosition.prototype.onMousePositionEditModeClick = function(editing) {\n    if (!this.options.editCoordinates) {\n        return;\n    }\n    if (this.editing === editing) {\n        return;\n    }\n\n    this.editing = editing;\n\n    // Affichage des outils, input en ecriture\n    this._setEditMode(this.editing);\n\n    var map = this.getMap();\n    if (this._isDesktop) {\n        if (this.editing) { // Unlisten for 'pointermove' events\n            map.un(\"pointermove\", this.onMouseMove, this);\n        } else { // Listen for 'pointermove' events\n            map.on(\"pointermove\", this.onMouseMove, this);\n            // on simule un deplacement\n            this.onMapMove();\n        }\n    } else {\n        if (this.editing) { // Unlisten for 'moveend' events\n            map.un(\"moveend\", this.onMapMove, this);\n        } else { // Listen for moveend' events\n            map.on(\"moveend\", this.onMapMove, this);\n            // on simule un deplacement\n            this.onMapMove();\n        }\n    }\n\n    // clear _markerOverlay\n    if (!this.editing && this._markerOverlay) {\n        this._markerOverlay.setPosition(undefined);\n    }\n};\n\n/**\n * Get coordinate from inputs and select in decimal degrees\n *\n * @method getCoordinate\n * @param {String} coordType - \"Lon\" or \"Lat\"\n * @returns {undefined}\n * @private\n */\nMousePosition.prototype.getCoordinate = function(coordType) {\n    var inputDegrees = document.getElementById(this._addUID(\"GPmousePosition\" + coordType + \"Degrees\"));\n    var degrees = inputDegrees.value;\n    if (!degrees) {\n        return null;\n    }\n\n    degrees = degrees.replace(\",\", \".\");\n    if (!MathUtils.isInteger(degrees)) {\n        return null;\n    }\n\n    var result = MathUtils.toInteger(degrees);\n    if (result < Number(inputDegrees.dataset.min) || result > Number(inputDegrees.dataset.max)) {\n        return null;\n    }\n\n    var direction = document.getElementById(this._addUID(\"GPmousePosition\" + coordType + \"Direction\")).value;\n\n    var inputMinutes = document.getElementById(this._addUID(\"GPmousePosition\" + coordType + \"Minutes\"));\n    var minutes = inputMinutes.value;\n    if (minutes) {\n        minutes = minutes.replace(\",\", \".\");\n        if (MathUtils.isInteger(minutes)) {\n            var mins = MathUtils.toInteger(minutes);\n            if (mins >= Number(inputMinutes.dataset.min) && mins <= Number(inputMinutes.dataset.max)) {\n                result += (mins / 60);\n            }\n        }\n    }\n\n    var inputSeconds = document.getElementById(this._addUID(\"GPmousePosition\" + coordType + \"Seconds\"));\n    var seconds = inputSeconds.value;\n    if (seconds) {\n        seconds = seconds.replace(\",\", \".\");\n        var secs = MathUtils.toFloat(seconds);\n        if (secs && secs >= Number(inputSeconds.dataset.min) && secs <= Number(inputSeconds.dataset.max)) {\n            result += (secs / 3600);\n        }\n    }\n\n    if (direction === \"O\" || direction === \"S\") {\n        result = -result;\n    }\n\n    return result;\n};\n\n/**\n * locate DMS coordinates on map\n *\n * @method locateDMSCoordinates\n * @private\n */\nMousePosition.prototype.locateDMSCoordinates = function() {\n    var lonlat = [\n        this.getCoordinate(\"Lon\"),\n        this.getCoordinate(\"Lat\")\n    ];\n\n    if (lonlat[0] === null || lonlat[1] === null) {\n        return;\n    }\n\n    var oSrs = this._currentProjectionSystems.crs;\n    if (!oSrs) {\n        console.log(\"ERROR : system crs not found\");\n        return;\n    }\n\n    var view = this.getMap().getView();\n\n    var coordinate = ol.proj.transform(lonlat, oSrs, view.getProjection());\n    view.setCenter(coordinate);\n\n    if (this._markerOverlay && !this._hideMarker) {\n        this._markerOverlay.setPosition(coordinate);\n    }\n};\n\n/**\n * locate coordinates on map (not DMS)\n *\n * @method locateCoordinates\n * @private\n */\nMousePosition.prototype.locateCoordinates = function() {\n    var lon = document.getElementById(this._addUID(\"GPmousePositionLon\")).value;\n\n    lon = lon.replace(\",\", \".\");\n    lon = MathUtils.toFloat(lon);\n    if (lon === null) {\n        return;\n    }\n\n    var lat = document.getElementById(this._addUID(\"GPmousePositionLat\")).value;\n    lat = lat.replace(\",\", \".\");\n    lat = MathUtils.toFloat(lat);\n    if (lat === null) {\n        return;\n    }\n\n    var oSrs = this._currentProjectionSystems.crs;\n    if (!oSrs) {\n        console.log(\"ERROR : system crs not found\");\n        return;\n    }\n\n    var xy;\n    if (this._currentProjectionSystems.type === \"Geographical\") {\n        xy = [this.convert(lon), this.convert(lat)];\n    } else {\n        xy = [this.convert(lat), this.convert(lon)];\n    }\n    var xyWGS84 = ol.proj.transform(xy, this._currentProjectionSystems.crs, \"EPSG:4326\");\n\n    var geoBBox = this._currentProjectionSystems.geoBBox;\n    if (geoBBox) { // check if coordinates are in the extent\n        var extent = [geoBBox.left, geoBBox.bottom, geoBBox.right, geoBBox.top];\n        if (xyWGS84[0] < extent[0] || xyWGS84[0] > extent[2]) {\n            return;\n        }\n        if (xyWGS84[1] < extent[1] || xyWGS84[1] > extent[3]) {\n            return;\n        }\n    }\n\n    var view = this.getMap().getView();\n\n    var coordinate = ol.proj.transform(xy, oSrs, view.getProjection());\n    view.setCenter(coordinate);\n\n    if (this._markerOverlay && !this._hideMarker) {\n        this._markerOverlay.setPosition(coordinate);\n    }\n};\n\n/**\n * locate coordinates on map\n *\n * @method locate\n * @private\n */\nMousePosition.prototype.onMousePositionEditModeLocateClick = function() {\n    if (!this.options.editCoordinates) {\n        return;\n    }\n    if (!this.editing) {\n        this.onMousePositionEditModeClick(true);\n        return;\n    }\n\n    if (this._currentProjectionUnits === \"DMS\") {\n        this.locateDMSCoordinates();\n    } else {\n        this.locateCoordinates();\n    }\n};\n\n/**\n * this method is called by event 'change' on 'GPmousePositionProjectionSystem'\n * tag select (cf. this._createMousePositionSettingsElement),\n * and selects the system projection.\n *\n * @method onMousePositionProjectionSystemChange\n * @param {Object} e - HTMLElement\n * @private\n */\nMousePosition.prototype.onMousePositionProjectionSystemChange = function(e) {\n\n    var idx = e.target.selectedIndex; // index\n    var value = e.target.options[idx].value; // crs\n\n    this._setCurrentSystem(value);\n};\n\n/**\n * this method selects the current system projection.\n *\n * @method _setCurrentSystem\n * @param {Object} systemCode - inner code (rank in array _projectionSystems)\n * @private\n */\nMousePosition.prototype._setCurrentSystem = function(systemCode) {\n    // si on change de type de systeme, on doit aussi changer le type d'units !\n    var type = null;\n    for (var i = 0; i < this._projectionSystems.length; ++i) {\n        if (this._projectionSystems[i].code == systemCode) {\n            type = this._projectionSystems[i].type;\n            break;\n        }\n    }\n\n    if (!type) {\n        logger.log(\"system not found in projection systems container\");\n        return;\n    }\n\n    // on enregistre le systeme courant\n    this._currentProjectionSystems = this._projectionSystems[Number(systemCode)];\n\n    if (type !== this._currentProjectionType) {\n        this._setTypeUnitsPanel(type);\n    }\n\n    // on simule un deplacement en mode tactile pour mettre  jour les\n    // resultats\n    if (!this._isDesktop) {\n        this.onMapMove();\n    }\n};\n\n/**\n * this method is called by event 'mouseover' on 'GPmousePositionProjectionSystem'\n * tag select (cf. this._createMousePositionSettingsElement),\n * and selects the system projection.\n *\n * @method onMousePositionProjectionSystemMouseOver\n * @param {Object} e - HTMLElement\n * @private\n */\nMousePosition.prototype.onMousePositionProjectionSystemMouseOver = function(e) {\n\n    logger.trace(e);\n\n    // map infos\n    var map = this.getMap();\n    if (!map || !map.getView()) {\n        return;\n    }\n    var view = map.getView();\n    var crs = view.getProjection();\n    var mapExtent = view.calculateExtent(map.getSize());\n\n    // get extent in WGS84 coordinates\n    mapExtent = ol.proj.transformExtent(mapExtent, crs, \"EPSG:4326\");\n\n    /*clear select*/\n    var systemList = document.getElementById(this._addUID(\"GPmousePositionProjectionSystem\"));\n    systemList.innerHTML = \"\";\n\n    // add systems whose extent intersects the map extent\n    for (var j = 0; j < this._projectionSystems.length; j++) {\n        var proj = this._projectionSystems[j];\n        var option = null;\n\n        if (proj.geoBBox) {\n            /*bboxes intersection test*/\n            if (mapExtent[0] > proj.geoBBox.right ||\n                mapExtent[1] > proj.geoBBox.top ||\n                mapExtent[2] < proj.geoBBox.left ||\n                mapExtent[3] < proj.geoBBox.bottom\n            ) {\n                if (proj === this._currentProjectionSystems) {\n                    option = document.createElement(\"option\");\n                    option.value = proj.code;\n                    option.text = proj.label || j;\n                    option.setAttribute(\"selected\", \"selected\");\n                    option.setAttribute(\"disabled\", \"disabled\");\n\n                    systemList.appendChild(option);\n                }\n                continue; // do not intersect\n            }\n        }\n\n        var optionElement = document.createElement(\"option\");\n        optionElement.value = proj.code;\n        optionElement.text = proj.label || j;\n\n        if (proj === this._currentProjectionSystems) {\n            optionElement.setAttribute(\"selected\", \"selected\");\n        }\n        systemList.appendChild(optionElement);\n    }\n};\n\n/**\n * this method is called by event 'change' on 'GPmousePositionProjectionUnits'\n * tag select (cf. this._createMousePositionSettingsElement),\n * and selects the units projection.\n *\n * @method onMousePositionProjectionUnitsChange\n * @param {Object} e - HTMLElement\n * @private\n */\nMousePosition.prototype.onMousePositionProjectionUnitsChange = function(e) {\n\n    var idx = e.target.selectedIndex;\n    var value = e.target.options[idx].value;\n\n    var oldProjectionUnits = this._currentProjectionUnits;\n    this._currentProjectionUnits = value;\n\n    // Mise a jour des elements lebels et unites\n    this._resetLabelElements(this._currentProjectionType);\n    this._resetUnitElements(this._currentProjectionUnits);\n\n    // mise a jour des inputs pour les coordonnees\n    if (oldProjectionUnits === \"DMS\" || this._currentProjectionUnits === \"DMS\") {\n        this._resetCoordinateElements(this.options.editCoordinates, this._currentProjectionType, this._currentProjectionUnits);\n        this._setEditMode(this.editing);\n    }\n\n    // on simule un deplacement en mode tactile pour mettre  jour les\n    // resultats\n    if (!this._isDesktop) {\n        this.onMapMove();\n    }\n};\n\n/**\n *\n * @param {Number} value - value to convert (km to meters, radians, grades to decimal degrees)\n * @returns {undefined}\n * @private\n */\nMousePosition.prototype.convert = function(value) {\n    var result;\n    if (this._currentProjectionUnits === \"M\" || this._currentProjectionUnits === \"DEC\") {\n        result = value;\n    } else if (this._currentProjectionUnits === \"KM\") {\n        result = value * 1000;\n    } else if (this._currentProjectionUnits === \"RAD\") {\n        var rd = (180 / Math.PI).toFixed(20);\n        result = (value * rd).toFixed(20);\n    } else if (this._currentProjectionUnits === \"GON\") {\n        var d = (9 / 10).toFixed(20);\n        result = (value * d).toFixed(20);\n    }\n\n    return result;\n};\n\n/**\n * @param {String} coordType - \"Lon\" or \"Lat\"\n * @param {String} value - input value\n * @returns {Boolean}\n * @private\n */\nMousePosition.prototype.validateExtentCoordinate = function(coordType, value) {\n    if ([\"Lon\", \"Lat\"].indexOf(coordType) === -1) {\n        return false;\n    }\n\n    var coord = value.replace(\",\", \".\");\n    coord = MathUtils.toFloat(coord);\n    if (coord === null) {\n        return false;\n    }\n\n    // convert depending on _currentProjectionUnits\n    coord = this.convert(coord);\n\n    var geoBBox = this._currentProjectionSystems.geoBBox;\n    if (geoBBox === undefined) {\n        return true;\n    }\n\n    // convert to current projection system\n    var extent = [geoBBox.left, geoBBox.bottom, geoBBox.right, geoBBox.top];\n    extent = ol.proj.transformExtent(extent, \"EPSG:4326\", this._currentProjectionSystems.crs);\n\n    // checking if value is in the right interval\n    if (coordType === \"Lat\" && (coord < extent[0] || coord > extent[2])) {\n        return false;\n    }\n    if (coordType === \"Lon\" && (coord < extent[1] || coord > extent[3])) {\n        return false;\n    }\n\n    return true;\n};\n\nexport default MousePosition;\n\n\n\n// WEBPACK FOOTER //\n// ./src/OpenLayers/Controls/MousePosition.js","var MathUtils = {\n    /**\n     * Reste de la division euclidienne\n     * @param {Number} a - divisor\n     * @param {Number} b - quotient\n     * @returns {Number}\n     */\n    modulo: function(a, b) {\n        var r = a % b;\n        return r * b < 0 ? r + b : r;\n    },\n\n    /**\n     * Transform degrees, minutes, seconds form decimal degrees -\n     * Largely inspired by the private function degreesToStringHDMS from ol/coordinate.js\n     *\n     * @param {Number} degrees - decimal degrees\n     * @param {Array} hemispheres - \"NS\" ou \"EO\"\n     * @param {Number} numDigits - number of digits for seconds\n     * @returns {Object}\n     */\n    decimalToDMS: function(degrees, hemispheres, numDigits) {\n        var normalizedDegrees = this.modulo(degrees + 180, 360) - 180;\n        var x = Math.abs(3600 * normalizedDegrees);\n        var dflPrecision = numDigits || 0;\n        var precision = Math.pow(10, dflPrecision);\n\n        var deg = Math.floor(x / 3600);\n        var min = Math.floor((x - deg * 3600) / 60);\n        var sec = x - (deg * 3600) - (min * 60);\n        sec = Math.ceil(sec * precision) / precision;\n\n        if (sec >= 60) {\n            sec = 0;\n            min += 1;\n        }\n\n        if (min >= 60) {\n            min = 0;\n            deg += 1;\n        }\n\n        var direction = hemispheres.charAt(normalizedDegrees < 0 ? 1 : 0);\n        return {\n            d: deg,\n            m: min,\n            s: sec,\n            direction: direction\n        };\n    },\n\n    /**\n     * Converts string to Integer\n     *\n     * @param {String} s - string number\n     * @param {Numeric} base - between 2 and 36\n     * @returns {null|Numeric}\n     */\n    toInteger: function(s, base) {\n        var _base = base || 10;\n        var n = parseInt(s, _base);\n        if (!isNaN(n) && isFinite(n)) {\n            return n;\n        }\n        return null;\n    },\n\n    /**\n     * check if s represents an integer\n     *\n     * @param {String} s - string number\n     * @returns {Boolean}\n     */\n    isInteger: function(s) {\n        if (isNaN(s)) {\n            return false;\n        }\n\n        var v = parseFloat(s);\n        return ((v | 0) === v);\n    },\n\n    /**\n     * Converts s to float\n     *\n     * @param {String} s - string number\n     * @returns {null|Numeric}\n     */\n    toFloat: function(s) {\n        var n = parseFloat(s);\n        if (!isNaN(n) && isFinite(n)) {\n            return n;\n        }\n        return null;\n    }\n};\n\nexport default MathUtils;\n\n\n\n// WEBPACK FOOTER //\n// ./src/Common/Utils/MathUtils.js","import ol from \"ol\";\nimport Gp from \"gp\";\nimport Logger from \"../../Common/Utils/LoggerByDefault\";\nimport SelectorID from \"../../Common/Utils/SelectorID\";\nimport Interactions from \"./Utils/Interactions\";\nimport DrawingDOM from \"../../Common/Controls/DrawingDOM\";\nimport Utils from \"../../Common/Utils\";\nimport KMLExtended from \"../Formats/KML\";\n\nvar logger = Logger.getLogger(\"Drawing\");\n\n/**\n * @classdesc\n *\n * Drawing Control.\n *\n * @constructor\n * @alias ol.control.Drawing\n * @extends {ol.control.Control}\n * @param {Object} options - options for function call.\n * @param {Boolean} [options.collapsed = true] - Specify if Drawing control should be collapsed at startup. Default is true.\n * @param {ol.layer.Vector} [options.layer = null] - OL3 layer that will hosts created features. If none, an empty vector layer will be created.\n * @param {Object} options.tools - Tools to display in the drawing toolbox. All by default.\n * @param {Boolean} [options.tools.points = true] - Display points drawing tool\n * @param {Boolean} [options.tools.lines = true] - Display lines drawing tool\n * @param {Boolean} [options.tools.polygons = true] - Display polygons drawing tool\n * @param {Boolean} [options.tools.text = true] - Display text drawing tool\n * @param {Boolean} [options.tools.remove = true] - Display feature removing tool\n * @param {Boolean} [options.tools.display = true] - Display style editing tool\n * @param {Boolean} [options.tools.tooltip = true] - Display text editing tool\n * @param {Boolean} [options.tools.edit = true] - Display editing tool\n * @param {Boolean} [options.tools.export = true] - Display exporting tool\n * @param {Boolean} [options.tools.measure = false] - Display measure drawing into popup info\n * @param {String} [options.labels] - Labels for Control\n * @param {String} [options.labels.control] - Label for Control\n * @param {String} [options.labels.points] - Label for points drawing tool\n * @param {String} [options.labels.lines] - Label for lines drawing tool\n * @param {String} [options.labels.polygons] - Label for polygons drawing tool\n * @param {String} [options.labels.text] - Label for text drawing tool\n * @param {String} [options.labels.edit] - Label for editing tool\n * @param {String} [options.labels.display] - Label for style editing tool\n * @param {String} [options.labels.tooltip] - Label for text editing tool\n * @param {String} [options.labels.remove] - Label for feature removing tool\n * @param {String} [options.labels.export] - Label for exporting tool.\n * @param {String} [options.labels.exportTitle] - Title for exporting tool.\n * @param {String} [options.labels.applyToObject] - Label for apply to object button.\n * @param {String} [options.labels.saveDescription] - Label for save description button.\n * @param {String} [options.labels.setAsDefault] - Label for set as default style button.\n * @param {String} [options.labels.strokeColor] - Label for stroke color.\n * @param {String} [options.labels.strokeWidth] - Label for stroke width.\n * @param {String} [options.labels.fillColor] - Label for fill color.\n * @param {String} [options.labels.fillOpacity] - Label for fillOpacity.\n * @param {Array.<Object>} [options.markersList = [{src : \"data:image/png;base64,xxxx\", anchor : [0.5,1]}]] - List of markers src to be used for points with their anchor offsets See {@link http://openlayers.org/en/latest/apidoc/ol.style.Icon.html OpenLayers params} for anchor offset options.\n * @param {Object} options.defaultStyles - Default styles applying to geometries (labels, lines and polygons).\n * @param {String} [options.defaultStyles.textFillColor = \"#000000\"] - Text fill color for labels (RGB hex value).\n * @param {String} [options.defaultStyles.textStrokeColor = \"#FFFFFF\"] - Text surrounding color for labels (RGB hex value).\n * @param {String} [options.defaultStyles.strokeColor = \"#ffcc33\"] - Stroke color (RGB hex value).\n * @param {Number} [options.defaultStyles.strokeWidth = 2] - Stroke width in pixels.\n * @param {String} [options.defaultStyles.polyStrokeColor = \"#ffcc33\"] - Stroke color (RGB hex value) for polygons.\n * @param {Number} [options.defaultStyles.polyStrokeWidth = 2] - Stroke width in pixels for polygons.\n * @param {String} [options.defaultStyles.polyFillColor = \"#ffffff\"] - Polygons fill color (RGB hex value).\n * @param {Number} [options.defaultStyles.polyFillOpacity = 0.2] - Polygon fill opacity (alpha value between 0:transparent and 1:opaque).\n * @param {Object} options.cursorStyle - cursor (circle) style when drawing or editing.\n * @param {String} [options.cursorStyle.fillColor = \"rgba(0, 153, 255, 1)\"] - Cursor fill color.\n * @param {String} [options.cursorStyle.strokeColor = \"#FFF\"] - Cursor stroke color.\n * @param {String} [options.cursorStyle.strokeWidth = 1] - Cursor surrounding stroke width.\n * @param {String} [options.cursorStyle.radius = 6] - Cursor radius.\n */\nfunction Drawing(options) {\n\n    options = options || {};\n\n    if (!(this instanceof Drawing)) {\n        throw new TypeError(\"ERROR CLASS_CONSTRUCTOR\");\n    }\n\n    this._initialize(options);\n\n    // init control DOM container\n    var container = this._initContainer();\n\n    // call ol.control.Control constructor\n    ol.control.Control.call(this, {\n        element: container,\n        target: options.target,\n        render: options.render\n    });\n};\n\n// Inherits from ol.control.Control\nol.inherits(Drawing, ol.control.Control);\n\n/**\n * Default tools to display for widget\n *\n * @private\n */\nDrawing.DefaultTools = {\n    points: true,\n    lines: true,\n    polygons: true,\n    text: true,\n    remove: true,\n    display: true,\n    tooltip: true,\n    edit: true,\n    export: true,\n    measure: false\n};\n\n/**\n * Default labels for widget\n *\n * @private\n */\nDrawing.DefaultLabels = {\n    control: \"Annoter la carte\",\n    creatingTools: \"Outils de cration\",\n    points: \"Placer des points\",\n    lines: \"Dessiner des lignes\",\n    polygons: \"Dessiner des polygones\",\n    text: \"Ecrire sur la carte\",\n    editingTools: \"Outils d'dition\",\n    edit: \"Editer les tracs\",\n    display: \"Modifier l'apparence des objets\",\n    tooltip: \"Modifier les textes / infos-bulles\",\n    remove: \"Supprimer des objets\",\n    export: \"Exporter\",\n    exportTitle: \"Exporter en KML\",\n    applyToObject: \"Appliquer  l'objet\",\n    saveDescription: \"Enregistrer\",\n    setAsDefault: \"Dfinir par dfaut\",\n    strokeColor: \"Couleur du trait : \",\n    strokeWidth: \"Epaisseur du trait : \",\n    fillColor: \"Couleur de remplissage : \",\n    fillOpacity: \"Opacit du remplissage : \"\n};\n\n/**\n * Default styles applyied to drawn features.\n *\n * @private\n */\nDrawing.DefaultStyles = {\n    textFillColor: \"#000000\",\n    textStrokeColor: \"#FFFFFF\",\n    // INFO : cette option n'est pas surchargeable via les options du constructeur !\n    textIcon1x1: {\n        src: \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR4nGNiYAAAAAkAAxkR2eQAAAAASUVORK5CYII=\",\n        anchor: [0, 0]\n    },\n    polyFillColor: \"#ffffff\",\n    polyFillOpacity: 0.4,\n    polyStrokeColor: \"#ffcc33\",\n    polyStrokeWidth: 4,\n    strokeColor: \"#ffcc33\",\n    strokeWidth: 4\n};\n\n/**\n * Default styles when drawing\n *\n * @private\n */\nDrawing.DefaultCursorStyle = {\n    radius: 6,\n    strokeColor: \"#FFF\",\n    strokeWidth: 1,\n    fillColor: \"rgba(0, 153, 255, 1)\"\n};\n\n/**\n * @lends module:Drawing\n */\nDrawing.prototype = Object.create(ol.control.Control.prototype, {});\n\n/**\n * Copies all source object members to Drawing prototype\n *\n * @param {Object} source - source object whose properties will be copied.\n * @private\n */\nDrawing.prototype.assign = function(source) {\n    for (var prop in source) {\n        if (source.hasOwnProperty(prop)) {\n            this[prop] = source[prop];\n        }\n    }\n};\n\nDrawing.prototype.assign(DrawingDOM);\n\n/**\n * Constructor (alias)\n *\n * @private\n */\nDrawing.prototype.constructor = Drawing;\n\n/**\n * Overload of {@link http://openlayers.org/en/latest/apidoc/ol.control.Control.html#setMap ol.control.Control.setMap()} method, called when control is added to or removed from map.\n *\n * @param {Object} map - {@link http://openlayers.org/en/latest/apidoc/ol.Map.html ol.Map} object.\n */\nDrawing.prototype.setMap = function(map) {\n\n    // call original setMap method\n    ol.control.Control.prototype.setMap.call(this, map);\n\n    if (this.getMap() && this.eventKey) {\n        ol.Observable.unByKey(this.eventKey);\n    }\n\n    // nothing else to do if map == null\n    if (map == null) {\n        return;\n    }\n\n    // mode \"collapsed\"\n    if (!this.collapsed) {\n        var inputShow = document.getElementById(this._addUID(\"GPshowDrawing\"));\n        inputShow.checked = \"checked\";\n    }\n\n    if (this.layer) {\n        // ajout du layer de dessin  la carte s'il n'y est pas dj\n        this.setLayer(this.layer);\n    }\n\n    // gestion des suppressions \"externes\" de la couche de dessin.\n    this.eventKey = this.getMap().getLayers().on(\"remove\", function(evtRm) {\n        if (evtRm.element == this.layer) {\n            // found layer removed.\n            this.layer = null;\n            // on supprime l'interaction en cours si besoin\n            if (this.interactionCurrent) {\n                this.getMap().removeInteraction(this.interactionCurrent);\n                this.interactionCurrent = null;\n            }\n        }\n    }, this);\n\n};\n\n/**\n * Export features of current drawing layer in KML.\n *\n * @returns {String} - a KML representation of drawn features or null if not possible.\n */\nDrawing.prototype.exportFeatures = function() {\n\n    var result = null;\n    if (ol.control.Control.prototype.getMap.call(this) == null) {\n        console.log(\"Impossible to export : control isn't attached to any map.\");\n        return result;\n    }\n    if (!this.layer) {\n        console.log(\"Impossible to export : no layer is hosting features.\");\n        return result;\n    }\n    if (!this.layer.getSource() ||\n        !this.layer.getSource().getFeatures() ||\n        !this.layer.getSource().getFeatures().length) {\n        console.log(\"Impossible to export : no features found.\");\n        return result;\n    }\n    var featProj = this.layer.getSource().getProjection();\n    featProj = featProj || this.getMap().getView().getProjection();\n\n    var kmlFormat = new KMLExtended({\n        writeStyles: true\n    });\n\n    result = kmlFormat.writeFeatures(this.layer.getSource().getFeatures(), {\n        dataProjection: \"EPSG:4326\",\n        featureProjection: featProj\n    });\n\n    return result;\n};\n\n// ################################################################### //\n// #################### user interface methods ####################### //\n// ################################################################### //\n\n/**\n * Collapse or display control main container\n *\n * @param {Boolean} collapsed - True to collapse control, False to display it\n */\nDrawing.prototype.setCollapsed = function(collapsed) {\n    if (collapsed === undefined) {\n        console.log(\"[ERROR] Drawing:setCollapsed - missing collapsed parameter\");\n        return;\n    }\n    if ((collapsed && this.collapsed) || (!collapsed && !this.collapsed)) {\n        return;\n    }\n    // on simule l'ouverture du panneau aprs un click\n    this.onShowDrawingClick();\n    this._showDrawingContainer.checked = !collapsed;\n};\n\n/**\n * Setter for Export Name.\n *\n * @param {String} name - Export Name. By default, \"Croquis\".\n */\nDrawing.prototype.setExportName = function(name) {\n    this._exportName = name;\n};\n\n/**\n * getter for Export Name.\n *\n * @returns {String} - export name\n */\nDrawing.prototype.getExportName = function() {\n    return this._exportName;\n};\n\n// ################################################################### //\n// ######################## initialize control ####################### //\n// ################################################################### //\n\n/**\n * Gets marker options in options.markersList given its src.\n *\n * @param {String} src - marker image URI,\n * @returns {Object} - markers options\n * @private\n */\nDrawing.prototype._getsMarkersOptionsFromSrc = function(src) {\n    var markerOptions = null;\n    for (var i = 0; i < this.options.markersList.length; i++) {\n        if (this.options.markersList[i].src == src) {\n            markerOptions = this.options.markersList[i];\n            return markerOptions;\n        }\n    }\n    return markerOptions;\n};\n\n/**\n * Converts markerElement options into OL3 IconStyles options.\n *\n * @param {Object} markerElement - marker element\n * @returns {Object} - ol.Style.Icon constructor options.\n * @private\n */\nDrawing.prototype._getIconStyleOptions = function(markerElement) {\n    var iconOptions = {};\n    Object.keys(markerElement).forEach(function(key) {\n        switch (key) {\n            case \"src\":\n            case \"size\":\n            case \"anchor\":\n            case \"anchorOrigin\":\n            case \"anchorXUnits\":\n            case \"anchorYUnits\":\n                iconOptions[key] = markerElement[key];\n                break;\n        }\n    }, this);\n\n    return iconOptions;\n};\n\n/**\n * Initialize control (called by Drawing constructor)\n *\n * @method _initialize\n * @param {Object} options - control options (set by user)\n * @private\n */\nDrawing.prototype._initialize = function(options) {\n\n    // determination d'un uid\n    this._uid = SelectorID.generate();\n\n    // export name / format / ...\n    this._exportName = \"Croquis\";\n    this._exportFormat = \".kml\";\n\n    // Set default options\n    this.options = options || {};\n    // applying default tools\n    if (!this.options.tools) {\n        this.options.tools = {};\n    }\n    Object.keys(Drawing.DefaultTools).forEach(function(key) {\n        if (!this.options.tools.hasOwnProperty(key)) {\n            this.options.tools[key] = Drawing.DefaultTools[key];\n        }\n    }, this);\n    // styles par defaut lors du dessin\n    if (!this.options.cursorStyle) {\n        this.options.cursorStyle = {};\n    }\n    Object.keys(Drawing.DefaultCursorStyle).forEach(function(key) {\n        if (!this.options.cursorStyle.hasOwnProperty(key)) {\n            this.options.cursorStyle[key] = Drawing.DefaultCursorStyle[key];\n        }\n    }, this);\n\n    this.options.collapsed = (options.collapsed !== undefined) ? options.collapsed : true;\n    /** {Boolean} specify if Drawing control is collapsed (true) or not (false) */\n    this.collapsed = this.options.collapsed;\n    this.options.markersList = options.markersList || [{\n        src: \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADMAAAAmCAYAAABpuqMCAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAN1wAADdcBQiibeAAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAARfSURBVFiF3ZhfbBRVGMV/d2Z3212tbSkCbuNaqzaRiL6QyAMPjSFoYqgx4oOiRmMFUzQG479o2lQ0QXk1EhYFgmlD2mIRkYhRwqLEaA2GiKWV7rZLQ0sLwbZId7t/Zq4PFK1125m5s/vCedz7nXO+M9/N3jsD1xFEvgXlTkrI8hBQBywFbgEqgEvAMHAayZcYHBYbuZJP77yFkdsoR+ct4GXAb4OSQPARXj4QzzGejx7yEkZuZy2CMLBAgf4nkhfEi3S67UNzQ5YSIXfQhKAdtSAACxDsk2EapXT3cF2FYQdNSN7F/YQFsJkw77gVUcL01mp3o5EDJoK1Yj37VchKjcjdlJEmhvrWmg9jGNwhGhhzSlTbZmnepjBBAMrReF2F6Hgy0+fIKPb+flWRIMtip+eQ88lcPRCtg3gCCVZ3RqhPDbJepqlPDbJ6XwSvP2nDJYCXB522prLN6iwrPIEETw33U/VoLZovBPjQfCGqHqtl3XDUZiBrn1lQCXO3ZcUDLV34Su/JueYrW0btnp8tNSRLnTamEiZoWRF6uHre9dseuT0vPrOgEqbCWtW3xNX6VSy02c+/sk4JwF+WFWZ6xGL9vA2fyzb7+QcqYUYtKwYP9s+7PrA/bsNn/geSA87DSLosa44+fT/p8VM511Jjp4g8u8KGk7XPLKhM5qhlRSbppzV4JwMdEcz0WSCNmT5LrC1CS/AujKliSw1BxGljzm8AH3MjHs4BpU65DjCBn0rxDJNOSI4nM33F2O2U58yEnU6DgOpF02AzcEGJa40LZHlfhagUZvp6vkmFawObVK7/4PLFSoZpBZ50ozEThsne6i2hjZqmFRVJ6U8JUeSVUmQNzQvg0c1MVtNMIUTSl0pNLhsaGu8A4xrfbZhS4CRQ5SoFcCWtja/5NBg+N+GZsu0vhSEkcY8mf+iNx+OuX3llmJVABNCVNUA2fl3xWdvJkriqRBb2uPugAYgNHEey1Y3Gt3/ccNxFEAChm2al6zAAjNAEWF/rc1Ev6+ffOLTwmBt7E0xD02J5CSOayQLrsHMJnYGMITJvHrr588mUMKyr54CUaaHrnfF4fCQ/kwHEBmLAa044rb+WHP4xXnxJ0VJK6CkyjO2xWOx3KMSH8zDtwONWdb2jvt41u4JtChZJKeVveDwnYrHYfw5uj4KYFRpSWbGqyCPL5ypIpMTkKwcWfWVXUEqRRcio1LTuUCjUE4lEsrnq8j4ZgKEP9bpgmfHFHPpyy3fle3f9Uto3n4aUIqNhDghN6zZ1vTcajaasfAsSBmBwq7f11tLM/24Hx2L+n+rbF38zBy2JEP0anPEGAj3d3d1pJ56F2GYAGInM82M+bWW53wxd++3ipH7x1QMLj8ysk5BAyj6Ppp2+d/nyaEdHh/I/W8EmA3Ci2b/iviVT3+tCerMmxkudiz450hcYBSYQIqrDmScGBvqawSxkH3lDV2Pxe6ltItnWcFNLTXX1qpqamkoK/BCvC/wNB+l5MdQKNHsAAAAASUVORK5CYII=\",\n        anchor: [0.5, 1]\n            // FIXME l'impl. sur le KML connait qq souci dont la gestion de\n            // la balise hotspot du format KML\n            // size : [51, 38],\n            // anchor : [25.5 , 38],\n            // anchorOrigin : \"top-left\",\n            // anchorXUnits : \"pixels\",\n            // anchorYUnits : \"pixels\"\n    }, {\n        src: \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADMAAAAmCAYAAABpuqMCAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAN1wAADdcBQiibeAAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAS7SURBVFiF3VhNTFxVFP7OfTNvOjMtM9AoJSSYEEVMCv6kJi5NoCa1TRqNxDTaFhcWNSmxaaxNQ0w3mqgLdGeRhKFYXVC7qDU2BhVt/YdqEQRhRgYTKD8VZqAMzM+7xwVCcIR58+6b2fRb3nO+853v3fvuu+8CtxEo1wX5pTu2IpasBfEeSFSCUAygCMAsgEkAQyD6DClXF3VMLeZSO2dmuN7vB+MYiBsAbDEn8BIIZ6BrzdQyF81FDzkxw8/594P5HQCFCvQ5QDRSYO4Tu30IO2QGiA/5XgVzAGpGsMKTZ/mw7wTbfLi2yFzvOwngpJ0aaXidAtG3VcnKZv5dWgE7Nf5fFBJCHqK2hUsqdKVG+EihDwn5K9SXViZEAHqAApGIVaLaO5Pg48iPEQDwg2WjCtHyzKx8RxJBZLP9qoJ5CdJ9t9XvkPWZiSVrkY0R3b2MxnM9aJ2Ooi3iRut0FEc/6IHuiZtyidwQ8RqrrVk3Q7zHNEd3L6N5eAYP7q2BppcB0KHpZXhoXw2aB6eyM8SPW23NuhnGvaY5L7T2w7Nt54Yxj68KDS19WSiZ66RBZQPYYZpRvfuejPH7H8scX0FJlv2sQcVMkWmGpmc2bBbPVicNKsvslmmOkZg0id/IQmkhy47WoLABYNo05/rnIxnjv1wOmtbgLHTSoDIz10xzzhypQiz624axWLQPLQ3V5kLUa7U1la35G9OcRMyFY/cV49qlLhiJMQAJGIkx9FzswsuVO5BccpnryKuWW7NK4IPFXmjLgwAKrHItYB66t5JaJmJWSJZnhjqmFiFxzirPIjqsGgFUD5qC3gRjRolrBsYMQEr/NEpmKBCJgHBKhWteHKdUjv8rVBvgw773QaizU2M9DMb58q98rwghXC5md5zI5WSmlCGcAODQZDIlhCSiJT0eX6waH490AsYq356ZZ4oK4DSuAihT4UuGYIaQILGQ4vknen2BibhYzlqfySBG2CH4ylA4HLb9y8v1BY8A9CkAzVwcZDA0BgkG0+oFBjP49Ij3o48n9b9U20gB7bZuZwCAAvM/gPndTDmSIZKS9CRDNwCHBIv1NzFdfzu/t2EEAEiTstS2GQDA2PwbAHrSh9ebSDewihtxMdn0h/dbO/ISkIYQoZyYoW6kYOD59YdQg8mRYjgleFONpKRk07D34qJBxmY5pmBOkKZdCIfDk7mZGQDUER0FUROwaoQdZpd6H07oXT/OOWYVJZmBQZdhvBcKhfqBfFyc1xcEEpKeNjMytOgYfqp32wUFiSVm7oPD0RsKhf5zsnYoFMsMyccTUtvtFHL7ZimxFC2eGPJezrYkM6VAHGQhBsrKyga7u7tTG+XlfGYAIFxXuLfEzZ288fvCb4U858+Ou0KZajBTUkCOkhADUtOGgsGg6SVIXswAQKiuqK3UbRxIH78yq//8Yr/3i01oSyD6UwDDTo9ncGBgIGFFM29mRh/FFm+J/3qBk+9aHbsZFzf39WwN3DK0tWXCQAzMIw4hfq/etSvY2dmpvLPlzQwA/PTk9od3eowvhWCnZEodHfC2fz3rnAEQBVFQA4YPjI6OnAZkPvvIGb7bX/Ta/LP+SEftne0V5eW1FRUVpcjzQ7wt8A+9at5zXMB2DQAAAABJRU5ErkJggg==\",\n        anchor: [0.5, 1]\n    }, {\n        src: \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADMAAAAmCAYAAABpuqMCAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAN1wAADdcBQiibeAAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAP0SURBVFiF3ZnLbxtVFIe/e8eOPU5DapI2whEWyiILJGDTBQuWSGTTSkVlQRGs2MGSh4RoQWLB4x/gpVIViNokJUV0U4RQXKgQr0ookCYkdjONSJtQJTGltjO2Zw6LJlEbkszLTgQ/6Ww859xzPt97556Zgf+RVKMHFGgD+oADwP3APUAHsABcBS4BXwDnFNxsdP6GSCAt8LZAWUB8WEngLYHdO137HRI4JLDgE2K9LQg8vtMMCCiBowJuSJBVcwWOSBOWfRCY1yJCrLdXdwrkUANmZL05Age3G2R3hD3iZYsC6TB16ZA8rwB3h4z1Uhp4MUxg4A23co7MA2aYhD5VBrqCnkNhZqYPPyCpVJnh4Ry2PYNIFdue4fTpHKZZ8ZEjBTwWorZgEvjEc92nUiUpFn+VjbS0NCqm6edgPbEdMD97FjI8PLIhyKoGB0d8wPy0HTBXPQux7Stbwti25QNmNmhtYW4ANtCytZNUPXxslEp4pKoq8PK5Q2FuAH97elSrcx7Xr/nIc8NnPWsKAzPv6XH27OUtr585Y/nIs/Uf0ggJHPdc76ZZlqWl0Q33y+LiqCSTFR975th2wDzjqy0xzbIMDo6IbVsiYottW3Lq1IhPEBF4ejtgdgkUm9SXrVpRoDVobYH3zEqLcTxoXEAdU1Bqco5bkluPyPNNmpV5Cdk1RwE63CSYw2FrivSYKtBPhOTr5cDJnmz2Oa11IiFi2kol4iKq7ug4QMxwa3WtXaVUpcW2Sw/MzhaHwFmNjwrTDvwC3BeJAripdXF/JvP+H7HYsu/8ohwlWDEt305YlhX5BYLAI0AOMCKMIUc6Oj4eaGuzwg5RhxNhnzTXpOAC8E6UMb5qbb0QAQRAGa7bHRlmRUeBH8IEzhnGtZc6O89HSe6C62hdaAiMgjrwFH6a0NtUU6r28p49n5WUcry9N5FIVRnGsGVZc42aGRQUgBeCxPS3tZ37LplcCJlSBMYTjvNeoVD4baWGxkpgEHjCy2+ipWVifyYzECJFRURGicUuFgqFP2+/0AyYTlupyYTIpqd4WanSwe7udy/HYr5aFhFVR0letB7LZrPjuVyuvpFfU97tzhrGgYzjfL7J+PJmOn3yo/b2qa3GEFE1jTuttB5zDWMin8/bXnmb9qJ6Jh7vv7dW+1d3cN40v3+2q+vLTcIqKHVZw2Q8lRofGxurBsnZNJhpSLZr/XvadbOrv103jOt9mcwHNwxjbZkIlBGZiml96cF9+/JDQ0Oh72xN/YRw0TQffmh5+RtDJF4H5/m9ez/8OpWaB/5CqbwBk09OT0+9Dm4z62iYfkwm37CVqgzsuuvT3p6eR3t7e7vZye8w/xX9A0ynxee2hlfFAAAAAElFTkSuQmCC\",\n        anchor: [0.5, 1]\n    }, {\n        src: \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADMAAAAmCAYAAABpuqMCAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAN1wAADdcBQiibeAAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAASKSURBVFiF3ZhdbBRVHMV/9+5uPwikFExEiCtWbSKCCEsCiU1EJIEXeMIHxZgYPzBUYzB+RUPlwwTl1UhYFIiGhrQVFCMRAoQFidGaEgIuVLrbLgSkhWBb2N3uzs7M3weBILadnZndF87j3P8553/m3ty5c+Eugiq1oDy5dRw5czGKpQjTgPuAicBV4C+E02j5gSFrn4o3pkvpXbIwMmNTLaHAByjeBKqLoGRBfY4V+lSdeGmgFD2UJIzM2bwMUVFgggf634i8qo6/vttvH9oPWRAlkS1NiGrFWxCACSj1rUSiqwXx9XJ9hWH2liaQtfifYQWsIxL9yK+IJ9xYWq1+NIaBjahl6vhr33khe2pEntg+noCRxPvSGg39GNZD6tTKfrdEb8ssaHxIeYIA1FKh3/VCdD0zN74jfRS3/XpFlpx5r9vvUNC1Tc5cTDFBqoJZ1i9opyFcR0hPomD3cvR8N02H55IvOPHHUB1aBOxy05r7ZaZY6lhTFcyy74Vunp46n5AOAxWEdJhnps5n//IElaEhRw0pwucOuA8jPOpYs35BO2Mrpg87NrZiBmvn/+aooWSa29a8bACTHSsawnWjjj/1wIOOGlKEzx3wEmaiY0VIT/I1/i/uKbKfW/AS5rpjRcHudRi/VITPtSL7uQUvYfocK46e7x51PNaTKsJn9BcyDDyEkXbHkqbDc0kbp4Ydu54/xcexec42OPvcAS9b82HHmnyhmkXND3OwJ0bBPgcYFOxzHEjGWLTjEQyryrkzFXPfmkvIY1+MpSp4Aahxy3WBQQrVU9TJFzNuSK5nRsUb0yi2u+W5dNnqNgh4PWjmrXXAZU9cZ1zGMD/xQvQU5sbxfJUXbhFY5eX4Dz5/rCQSbQae96NxOyzsnXVXNjRqrSsrRarzSlWGRJRp6RBAMGAXTK1tpdRQRT6fmXHx4kAbWDf5fsPUACeAqb5SAGkxBpYMfBW9YA/mivYXZSkhFdTyc2cqlfL9yyuRaAMQAwKeNUBWZ376piV3IuVVwoSv/V1oAKpjxTGQjX40Dhh/HvMRBEAFbHuK7zAAjOttApyP9cOg17526b303iN+7G2wLa2TJQmjYmtMYDnFHEJvQwGr8H5m766M5C3n6hEgYqhAYHcqleotzcwAqmNFEuEdN5zm3PF9vxipqx4tReBMpWVtTiaTf0A5Ls4j0VbgWae6TrOvc8ngthYPFkMicpJgsCOZTP7nw+3+QsMZK/NiLqxUwdqRCrJ2PvNWes+PxQqKKBMlCdE6Hg6Hz8RiMXO4upLPDMDFWZ8tnazHfz+CvmzIHNy5Lfd712gaIqqgsXuU1nE7EOhMJBJ5J9+yhAE4P2tj8/265n+ngyNG8tdXrrfuH4E2hFLdGs6Gxow5E4/HDTee5VhmAFj92Zf7J1Q01Krq8M1nV+zMlbfTew7dXieQRaQrqPXpx+fMSbS1tXne2co2MwAds9fMm6kmHQ2gQia29ca13V8eKnT1AYMolQjA2ed6errWgF3OPkqG9pmr1+cjm4ZapjfuqK+rW1hfXz+FMr/EuwL/AGOdsbn1H7gQAAAAAElFTkSuQmCC\",\n        anchor: [0.5, 1]\n    }, {\n        src: \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADMAAAAmCAYAAABpuqMCAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAN1wAADdcBQiibeAAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAATNSURBVFiF3VhZTFxlFP7Of+8Mi12Eot2Sia36IIJCIWmT0lhSK30wfaoaNcampBhrfGhSl5hIW9HE5VFTpWilNpUI0hrTh1YwjJSkthFEcABhBoZ0YekCFGa72/FBSLAF7jY86Pc453znO9/9//nvuT/wPwIlu2DLns1Lo3J8hwDtZHA2gNUAVgC4SYRrzNxFJH6UpNjZ4iOBqWRqJ83MmVdzM7y6520CvQ4gzQIlSoxPJVX/sLi6fTwZPSTFTOMrhbuYuRJApgP6LRDv3V7ZdsptH8INmQH6aW9BOTPXwpkRAMgE0/eNZQXvssuHK7khF5VtOEhEh+F+hQlAcX/hGu1E61CzmyKOML21at3UmAMGM+96qqrttBOyo0aadufdq3mlEJxvrXlBwFhcUh58+vPOMbtcR/8ZzSu/g0UwAgAMZHgN7xtOuLZXpmXP5qUxOT4Ca8evU0RlOb7S7ntItq8S30EWjEje1GhOacWlrNyi9SR5VrGuDo92NPd3HSvfqCsJM366pqaVAKi305vtbSZAO81yJG9qdMsnZ/vvyyveSpLHB8BLkse3Mn/b1i0fnQtK3pSYuRKb6tzdm10QP2KWklNacUlOXZIzV0xOX5KbvfvwRXMdyrbbmm0zzFhjlpOVW7R+ofj9eU+ss6BkqnMnnJxmK8wSSPKschOfRpbljqbhxMykWQLr6rBJfMiCzm3LHU3DiZkRs4TRjub+BeO/+8MWdBZ8IHPBthkiXDLL6TpWvlGLTnXOFVOjk52B6oObzJXYVOdO2D8AQE1mObqSSDv/VslDI62NftbVQQAK6+rgyG8N/vNvljxsqEqqqQ4Lv93ebE8ATfseXaJpqVcALLfLtYEJI6auLTnREbFDsr0y/4wY9LVdnh0w4yu7RgCHg2ZCSrwHYNQJ1wJGFVl53wnRkZnp8Xy/E64F7Hcy/gMuP6waygpOAnjBTY3Z0Bk1ZeeuvyaESElhTksQpXiYSdOFBwBkyVA1IQwiinkTiUju1avjdYA+w3drZjkB7Qw84NIH4hqPV1wYr7wVM+JWOcykEyMsCz7fEw6HXX/yNpQVFAHww819AoNP9kS+abkcDzutoAHHXd3OAMD2o60tTPjYTY3260qLCyMAQJJhrHVtBgA8q5eWAzAf6+fAeNwYqu6c+sWNvgEYuhChpJgpPuTXBPAiLAyhs6Ez1ONdkfqEzrp59jxgVkiSToXD4eGkmAGAbUdbQ0R8wA7Hfzl+tueGctOhJDPQnaLrX4RCoT+BRbg4bywrqGXgGbO8K5NazwcXJr5zIBFj5g7IcmsoFPrXi9v2hYYZJGBfzOAnPYIy5stJaEbky86pM1ZrMpMG4iALEfD5fN1+v1+bKy/pKwMAtS/n78xIET/MU5/r/4rUNA7G+xaqwUyqgDFAQgQMSeoJBoMJM91FMQMANS/ln8xKE3dNB4Ebyq+ftU2em4cWA1G/AHo96endgUBAsaOZ9G02g7g0VhpRMovu8ZJv5rcJxbh+rHPq59l5DETB3CcL0fVYYWGwrq7O8cm2aCsDAFXPbdjkW0bNguDRDehV7ber/rihjgCYAFFQAnqfHxjoOwQYydBbVDMAcOTZxyvWLZMPXBxS6r/tjlRDlrt7e3uvAeDF1v5P42/pFun0pc2xBwAAAABJRU5ErkJggg==\",\n        anchor: [0.5, 1]\n    }, {\n        src: \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADMAAAAmCAYAAABpuqMCAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAN1wAADdcBQiibeAAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAARrSURBVFiF3ZhNbFRVFMd/985H26m1VEoL0zj0Ayqi6IZElpiQ2MSgIeJCDZGFuEEXJH4bG9QN6spoImiMIaExbREEYoIxhgEb1CZNjFg6lHnTacNHW8QW7Mx0pjPvuKDVprR9X1MX/Jfvnv/5n/89N++d++AOgip2QolRQZAWhCeA9cAqYDlwHbiCcB7NcTKcVA8wUUztopmRQarI8wbwMlBmg5IGPkGzTzUwXowaimJGEmxHOADc44L+F7BLNXHEax3aC1kEJQatCB24M8I077DEeUfE2+Z6MkOCVuBdvHdYoXgPg7e9JXGJ6aPV4SXHPDARtqs1HHVDdlWIDLAMEwP3R2sxjOGnSa1mzCnR3TET3mJpjABUkedVN0THnZEYFQQYwd7r1y3STFLr9DvkvDNBWrBjRIfS1B6J0pAdolFyNGSHqD0cRZVlbKiEKOUxp6U5N3Pry26RNZRm9ZUE5ds2o4IRIIgKRih/ajOrr8RtGVI2dObKOiUA91tGrDjUjap8cH7FZRuoOfirZQ5hvdPC3JgJW0aEHm9cfP3JBsscYkNnDtyYWW4ZoYIrPa0DKKptVzQN52YUf1vGSG548YDcVRtKN+0V9B/cvABGLGPSJxKLrqeOJm0oWWzI7XBzzLotI0Z3PII5fm7eNXPsHKM7NxVFZw7cdOaUdUymjMHwGlKdUSQ3COSQ3CCp9iiD4bXIZKllDkXUaWnOJ4Be7qKUS0ClU64D3KCcOrWSlBOS485MjxhfOeU5xJdOjYDbqfnWFTkG1LjhW2AUP+v+t6l5WmiPG64N7HFjBDxerMSgDXjWS47ZKBT4unFLZLfWuqREpCyrVElAROULOgDg95lTea1NpVQmmM2mNly+PN4JhRm+VzOVwG9AvScXwERaj2/dFT5wadg/aVtfVEEJSb+Wn2LJZNLTPwDVxA1gB7N2xw1EkH37q445MQKglPjQ0pSH5+vr6+u9/dAAVBNdwIdecvzQVd7V/l1F0ksZPtOs82wGgCFaAeuxfh4MX/Ndfe2D6tNe5E0wC1obRTGjHiWPyXNgYwidhakpNfX6Ryu+SWWU+2MqklM+35FkMjlcnM4Aai0GwitOOG0nKk6e7Sm97lJSBPpKCoX9hmH8AUvx49ygA3jaKi5mBGNbXwy3u5DIiMjv+P09hmGMzl4ovpkLVGcLqr+kRKoWikmnVWrb7rrPEkN+WyOLiMqjJC5a90Yikb5oNJqfL87vtuiFoO7jz8s/653hmsK3zL9Z8vHBZcesjIioKY05oLTuNf2+WDwezwIkEgtflYremRkMdQXa7l01ddt0cLq77JcX3qz9fgFaBqUSGvoDoVBfb29vzonmkpkZOEVpZaW+UFVpRmaeXRvzXWvZGf785oTv32MikEbkol/r8w9t3Bjv7Ox0/WZbMjMAPcfLNj28bvKMzyeBfIHCS3trvvjxbGgEuIFScR/0PzMwcHEvmEtZR9HQfaz0/WxMZdo/vftQc2Pjlubm5jqWeBPvCPwD/KOH+jnO5aMAAAAASUVORK5CYII=\",\n        anchor: [0.5, 1]\n    }, {\n        src: \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADMAAAAmCAYAAABpuqMCAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAN1wAADdcBQiibeAAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAASxSURBVFiF3ZhdbBRVGIafc2Z2210hbeWnpcQVUC8kwBUJXJBIgwkgBEPEC1GMxhgE4gUJJsYERMWI3orYaiqgrYSWH/mvMaQLciE1RAKUkrLbbhMobQ20/LT7N3OOF0CC0O7szGwv9L3c73u/93vnnD3zzYH/EUTBKx6sHUvQWgR6GTAdmASMA26A6AYuofUhQnYTVevuFlK6cGaObC9DGh8i9PtAKA/GEIKvSRZtZfnbA4VooTBmjlWvQFADPOmBfRN4l8Xv7ffbhvTF1lpwrHoTgga8GeE+by9NNRvR2tfDNfyQmVv5MYJP8L/CAqgidtai/sgpP0W84d7WavBV43Eo0CtYvOaAF7K3Rg7sKKU4Hcf71sqFfmz1DEvX9rslevvPFKc/YnSMAJRhyA+8EN2vzMHasQSzveR3/HrFEMV2udv3kOlaJmgtIg8jYcMcqpu1oGXJhMi0oJQVGaV6Dvd1day62DwnaWWd+GHSciGwz01rHraZXuaUETbMoe6qVR3Ly6fMD0oZAYJBKSOvVEyd3z3/jVjIDCSddYSjzqPwYEY875RRN2tBS4kZnDFcrNQMztw144UzjjKa6W4787IylU4ZSyZEpuWKv1w+dWohdB6Fl9NsnFNCUMqKnHGRO34PYnz+Ld2DFzN3nBIySvXkjGt1PQ+d23l3dB9ezPQ6JRzu6+rIFT/Q25lwVNHkfCDDwYuZFqeEVReb5wxYmQvDxfqz6QtvnW+e69yZcNR5jOKWgKbZKSVpZUOV0bpnG3vi0YxWXUAmo1XXnp54tLL5p+dSyi52FlJRt625nwCavxlDyrgKlLjm5o9byPBkFr456IbkfmWq1t1FsMM1zx1q3RoBr4OmpT4F+jxxndGHrbZ4IXozs3RtP0Ks98R1ghDrvYz/4PfD6ti39Qix0leNh6H07siaL9ZJKYuKtA6lhSgKaC0sWwYATENlLSmVECIZTKcHZ167NtAI9gO6PzO/1ZRg6XPAFF91AJnKDES21NaYN26l8uVoLWyhSZhS/345kUj4/+Q9XjMPdBR/9wl6Qn3TjyWnzyW88i3Y5e92BmDx6tPAV35KjDnXftqHEQBhKDXZvxmA4p5NCJzH+mFg3rxzvXzn0ZN+5BUoW8p4YcxUbbZQ4nXyGEIfhrDt7MS6o/tEOm07Z48ArTPCMPYnEomewpgBeGl1HMQGN5SSk381hdsSNzwqag1tRbZdHY/HL8JoXJwfr24AXnVKK7rae/mpz3fs8aCQ1FqfxzTPxuPxf7243V9oOMESa4XOvqgDZtlIKTKVHpz4w6Ej+ZbUWlgIHdNStkYikbZoNGoNl1f4lQGM3V8us0tLfhmhvh6/98Tu0hN/XslVQ2uRlahOIWWrMozLsVgs7aQ7KmYAAnVb67PjSh+bDsKtHX9Ubmv4dQRaEiE6JLQHwuG21tbWjBvNwm+z+8hmU+/Iu8l5akwo8uA34/bg3+W1B088nKdhCK2vmFJemjV7dqyxsdHzyTZqKwMQ2r55bmpK+SktRABb2ZO+2//9E+djvcAthIgZ0P5aZ+eVzaAKoTeqZgCKt238LP10xYaxZy7tq/j5+E5Ms629vb0b0KOt/Z/GP4jqqfL5oxVsAAAAAElFTkSuQmCC\",\n        anchor: [0.5, 1]\n    }, {\n        src: \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADMAAAAmCAYAAABpuqMCAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAN1wAADdcBQiibeAAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAS8SURBVFiF3VhdTBxVGD3f3Rl2oRAstZXaBGxpoxaxhSVpE0ha0ib0qU/1QX009UHjQ5Oa+BO3pdTEn0QffNDGGH+SprGUqlUTSGtcKfGHBELALYTuwGJsSyEVKLuz87Mzny80sQjMzp3lQc/j3O+c8525N3fuXOB/BCq0YNNoU5lRZBwipsMM3glgM4ANAO4AuMnM14QQl7LZbFeiNpEupHfBwtRN1q1Xc+orBHoJQHEeFB3AB45w3hrcOjhXiB4KEqZxvPEIM58BUCFB/4vBRwdqBi4G7UMEYjMoqkVjzHweckEAoIJAF6LJ6BvgYC83UJiG8YYYgDYEn2EC4VRUi74eTEQSi0vrfBCNZeAy85GB7QNfyZClGtk9sfuBkBvSIL+0VsOspVg1w9XDs36JUstMYeU1rE0QAFhflCt6WYboe2aaRpvKDNW4jfy2X1nohmE85Pc7pPh1MYqMQ2DvIBER0ds3tvc1lzRvU0mttNme6tF7xmPTsT0mm178kuJIcSuATj+9+V5mxHTYqyYiInpXddd4y7qW/SqpVQCKVFKrDqw7sL+7ujsZpnDWS4OJPX2WwncYBj/uVdO+sb2vlEqfWG6sVJTWtW1q+81Lg5h2+u1NZgN42KuguaR522rj+0r2bfXSYGZPn6WQCbPBq0AltTLIOACA8KCPngDIhCEseJXYbE+tOg77Vh5Od/PuaRH+wzBue5X06D3jq43HM/FUHk6rvpDlILPM+rwKYtOxPWk3Pbzc2IK7MHxi+sReLw0Ge/oshczW/KNXjclmcetk6/YrmStxm+1JAJbN9uTlzOV462TrDoutiGdjJOK+e/NLqE3UlkYikT8BlPvl+sC8vc7eMlQ5lPFD8j0zidpEmkCf+uX5xCd+gwCSB01TMU8BmJbh5oFpS7FOyxClwiwez4/JcPPAMZnjPxDwxyqqRc8CeCaIxn1wcG7m4MyLQohwmLnYJAqrzJRzhAoASsi1c0K4RJQtMs1M3Y0bcx2Ac48eNEw5gEEAjwQKAYB1nksfnTvjTrlG3hwmhxgpRfDV0VQqFfiXN6pFmwHEAYSkRRisv5/5wv7eSMkq5IDPg93OAOiv6e8F8E4QDbvX6g0QBAAo5LpbAocBgLI/ymIAPI/1y4Fn3FvZt9M/BfF3AdcRQitImHhLPAcXzwLeh9D7YMPW3810cpYd7+IVwGxRKHQxlUpNFSQMAPTv6NeY+bgfjvmt0ZXrt+5IWjIDI2HH+UjTtN+BNbg4j2rR8wCe8qpztdzowvPzX0pYZJl5CIrSr2nafR9u3xcansjhBXb4IIVp/UolrLuZ9On0d/lKMlMOxEkWIlFVVTUSj8dzy9UVfGYAoP6X+sNik/h6BX02PsycMy8Y11fTYCZbwJ0gIRJuKDSaTCZNL981CQMA9b31Z8Vm8a/Tgd1n/aq/utC9Ai0LonEBjKklJSOJRMLy41n4ZbaIWXv2uYr5imYqp6p7z9xZdyb7ZvqHf9YxoIP5uiLEtScbG5MdHR3SO9uazQwANFxq2EuPUQ9CUOHA0U/e/dj+2b4NYB5EyRAw9vTExPWTgFsIvzUNAwC7vtnVrjyqHLeuWJ3me5nPoCgjY2NjNwHwWnv/p/E3iQfm3w9KV7kAAAAASUVORK5CYII=\",\n        anchor: [0.5, 1]\n    }, {\n        src: \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADMAAAAmCAYAAABpuqMCAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAN1wAADdcBQiibeAAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAATaSURBVFiF3VhbbBRVGP7+M9NddtmyvcYKSbGoAYn4REJNIGmRpMREfMEH5YEYY6ptfCCBxEgEvMR4eeCBtBYa1EIIsbVAFAIIsis0og1GpJbWdrdsiUBLuXQp3e3MzpzfB23Cpe3pzGwf9Huc83/f939z5nLOAf5HoGwL7m4ryjWssdVgWkPEi5npURAKwbgJ4CoYF5n4WyBwrLZy6G42vbMWpv5MOJ9s+TYz3gIQUDtzCkw7DGgfb6gcHs5GD1kJUxcJrSWinWAUuOjgFkt+vXbl3QNe+xBeyMyg+lOhLQRqdhUEABgFRPTN59HQu8zebq7mhVxSEdoKovfgfYYJoMpzCZ91pMk87UHEHeoiobUEavai8RAYkgTWvlkxctAN3VUj2yN5eX6y464fralxG7p4vGZF8rZToqt3xs/2OzMUBADykZGb3BAdz8zutqJcI2MMYjqfX7cgTjEHHnH6H9Kd+hjW2GqAlEF0PZhataixfX5h1QJBvhLJ5kD/jaN9J7url1l2amo+U1BwugpAq5PenD9mTGtUJboeTK0v7+0rK3qhQpCvFIBPkK+0rPjFivXP/hnTtWBaaSPUPg/CzTvzlKpg1aLGdp+e+/REYz49vGTlooZfVBrMWOy0MTdh5qoK5hdWLZhqvKzo+TKVBpHa50E4D0MoVIqSr8TL+L8omnZP47pOCWCMqEokmwOK8WvT8LnjoCsA7mZmUFXSf+No31TjfTeOJKbhNOUNmQiOwxCjXVVzsrt6mWklOyYaMzLDHae63ihXaTCpfR6E4zCSKaKqsexUoOnswifiQ4eiks1+AKZksz82dDDadHbhk7ZMz1I3RlGnvTleAdRFikOEsb8AhJ1yHSA5agbnbaoaHHVCcjwz/ywx+EunPEcg7HYaBHC7OdO190G47oqrAuE6NPGhG6qrMDUrkrchaYMbrhKSNrhZ/gMeN1b10dA+ML3iReNe2JL3f/ZqQa0Qwu9nDhhE/hxmsmyRAwC6JjOWEJKI0j7DGF1y5cpwC2CP8z2F2XkiP2zr1nkAj3mLAZhpMbx3a3hnckiMTZfDTDYxErrgM92JRMLzlrcukrucgCi8nCcw+MSe2Xs6orMSbhUsoMnT6QwA1FaOtIHxqReN2G/+Ng9BAIA0Ked5DgMA12lkCwDlsn4ijNyia8d3zf7Ri78EpC1EPCthtlXC0qRYB6gXofc1YSNz/Is5rYZBtrp6EjCbpGkHEonEQFbCAED1c8k4GBudcM6fmnXscqd+06UlM9Dlt+2GeDz+BzADB+f1kTnNAL+kqhu6rHfv3Rr+2oVFmpkvQNd/jcfj9/24HR9oqKCBawyTVuk+zp+sxhyj0cMNocPT1WQmC8QxFqKztLS0KxqNWhPVZX1mAOCT1rw1uQX2oUn0+fT+4P5z3wd6p9JgpoyAvERCdEpN647FYobKd0bCAMBHzeF9ecXyodVB4kLOzwe2zzk+CS0Noj4B9OQEg12dnZ2mE8+sP2bjMEeTr6UD4eWBkCwdvzZ6Rwwd2TX7h3vrGEiBuVcX4uIzS5fGWlpaXH/ZZmxmAGBzY0H53AXWaRKcI23Y3+0INcZ/9w8CSIIopgE9L1+61LsNkNnwm9EwALB5V8EHJWWZjV0/BVpPNoW+gq539fT0XAXAM+39n8bfE7XcWzV66JYAAAAASUVORK5CYII=\",\n        anchor: [0.5, 1]\n    }, {\n        src: \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADMAAAAmCAYAAABpuqMCAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAN1wAADdcBQiibeAAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAR4SURBVFiF3ZhbbBRVGMd/58x2u7vQbmtvssSNAjaRiE8k8oAPBowkVTAGTVAJJMYXiTGYNFxisHiJ7ZMPQiIxxhRLCG1tjSBRubiAJEhiNDaFSlu6baRQELsI7e7sZY4PlKT2sjNzZvvC/3HO9//+33++M2e+GbiPIAqesYkSLNYgWAssBRYAFcBNYBjFBSTfkuR7GrhTSOnCmfmYcgTbgbeAoAPGOIJP8dPIVhKFKKEwZppYj2If8IAG+x8Eb7CNDq9lGJ7YCkGQXcBeIKSZJQi8zDNYHOMMu/XL8WYmxHvAbrx3WABPc5YsxzntJYke7m6tVk85psNCsZ4ddOqQ9Qr5hDJM+tF7RuwwimIxOxh1S5Racml2MjdGAMqBeh2i+840UYJiBGfHry7GSVHj9j3kvjMWa3BgJOQPjXe82BEz680htU2lzXpzqP2F9ljQF0w6UAlRzLNuS3PfmUa+Al7LW4k/ND68Zfhy2B9+fOpawkx0RfZEliSzSbsbsp/tbHJTms4z85hdQMtzLednMgJQVly2rLmu+RcHOkvdFqZjJmIXULe4blG+9XW16x4phM5U6JipsAvwS/+DXtYnUOm4ognomLltF5C20tds1q860PnXcUUT0DEzYhdwuPfw5XzrnZc647Yqgrw3ZCbomDlvF7DxyMYnE2aia6a10dRo1+bvNq+wVVH2OlOhY+Ynu4BkNhmM7Iksaetpi6Wt9CCQTlvpwUM9h2KRvZFHU9lUwFZFEHNbmPv3TAPzCfAXEHbNdY5bGCyknjE3JPeduTtifOma5w5fuDUCuoOm4n3guhbXHtdRfKhD1DNzdzzfqsW1x1ad8R+8flg1cgB4xVOOybA4GP0sukVKWVysVNAUorhIKZHNySIAn2FlslJaQoik3zTHll25kmiD3D26VzNh4HfgYU95AJmRiWhrZJ/vti/llKOUyAlF3CfVmZ54PO79k7eRlUAMb/8TVNWpiv3hiyVxXX4Wmr390AA4zhCrCCB4SjfF/IF5P1eeK//NQxVCWNYNvQNgKkx2AU7G+mnw3TGu1pysPOVF3gIrJ2V/Ycw0kEXyKg6G0MkQlshUn6r6WmREzj56FiiVFobREY/Hr3nfZvdwjFFWcRPB804pZV2lR8PdJXmH0jxQCnoCuVzrn4ODgzA3P85bUbxkF1b8t7/nofbIIQ2FpFLqD3y+X/v7+//34vZpJMsPgzeFKVYrQ5XPFiIzYqz6ZPURpymVElmE6lNSdkej0YuxWCw7U1zhOwMY7xprc/Nz38ySX1WeLT9Y1hXuzZdDKZGRWANCym7LMHr6+vpMO905MQNQtLPoQKY0M206CA0Fz0WO1vwwCy2JEJclXCoKhS52d3en3WgWfptNIOPPvC5TcqUVsKL3rhnjxo2aE5UnJscpGEepXp+UF55Yvryvra1N+2Sbs84ABN8JrkhVpU4roYqwyC34sfrzefHQCHALIfoMuLRhYKC3Aay5rKNgCLwd+EB8JJKlm0pbahctWl1bW7uQOb6J9wX+A8zucxGCTS9IAAAAAElFTkSuQmCC\",\n        anchor: [0.5, 1]\n    }, {\n        src: \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADMAAAAmCAYAAABpuqMCAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAN1wAADdcBQiibeAAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAARZSURBVFiF3ZhbbFRVFIa/vedSZkTbClJow1irNpGIvpDIAw+NIYghqTHig6JGIoLSGEK8xEhoKpKovBoJg1aCaVNpsYhIRINh1D5oDYaIvUhn2qGhNwi2RabtXM7ZPrQk0Ns5Z5+ZF/7Hs9e//vXvtXP2OgduI4isZ1S1d0JmPVAJrACWAYuAq0A/0A7qWzBOIaquZ1M6e2bU/kLwvAu8AQRsMMZAfAK+jxCbR7JRQnbMqAMbQYSBuzXY/4J6FfFas9sypCu2UgJ1sBpEI3pGmOSJo6jwbpRytbnuzHCwGtT7uO+wAPZAeJfbJHqYPFqNrnLMhAliI2LrMR2yXiHqUAGkYugfrfkwDMb9iO3DTomaxyz1HrkxAlAI8m0dovPOTN4jQ9h7/epiDDJFTu8hjc5k1mPDSBDvWDPrIkm29Cq2ppJs6T3KukgA37gNkSD4nnBamc4xq7SuxDvWzwvdT1Na4UeGAL8fGXqG0op+NkVtGrLUmQ4dMw9ZBdTxeGs+/odnWyvAv/IwFb9by6gVTgvTMVNsFbCBUNl8609x733Z0JkOHTOLrAL8yKVu1qew2HZFU9Ax859VQApz0GJ9wIbONdsVTUHHzJBVwAl6u+dbP0ZP3IbOvBsyGzTMqFariBc589gIqfOzrQ2TPP8ykdU2hCx1pkOnM2esAsZJB4qpf6CJnkgK8yKQSmFePEIsUkzdgxMYC6xlRMRpYRoTwKcLwXsJyHfMtY9RCJQgXko4ITnvzOSIccgxz5lIrVMjoD1oGnuAy3pcS1yGzF4dop6ZyfF8pxbXGjt1xn9w+2GlwvXA865y3AzDbAiVfVglpczLUyqQFCLPp5TIGNIH4PWY6YyUphBi3J9MJlb29Y00gXGD7tZMPnAOKHWVB5DXUyOhJz8Pey+NTtiWV8IQirhXql874/G4+09eFV4DRACPfg7UPbu+/zK/4VxcN0MGDrv8oQGIbS2g9rlJsfDHf1pcGAEQHtMscW8GgMFqwMZYPxPegWsDRW+e/NmNugmmIWUsO2ZETQbYhI0h9BZa2kgveefk1yKRNKyj54BSKeHxNMfj8cEsdQYQ22LAW04o+XV/ngq2xK9qKioFHXmGcSAWi/0NOflxHm4EnrUKy2sf6ly+4YsjGgrjSqm/8HrPxmKxWy5ur0YyK2wXycxalectnCtAJpKJJTuOf2c3oVIig1BRJWVbKBTqiEQimdnist8ZwNP3caVRXPDNHPnV4r2nGwpq/+iaL4dSIi0xe4SUbabH0xmNRpNWujkxA+Dr3VefXp4/YzoIRmK/FW9u/GEO2jhCdEu44AsGO9ra2lJONHNxzABIG2OvyGH/GrMwELrxzHMlcaVox/Gfbo5TMIZSXV4p2x9ZtSra1NSk/WbLWWcAAmdrVk88uvQX5RE+Mqax7PXmz+443TUEjCJE1AMXnuvp6aoBM5d1ZA0LWnd/IJL7x+/6qqquvKxsbXl5eQk53sTbAv8DzFJ5Mvw8/r8AAAAASUVORK5CYII=\",\n        anchor: [0.5, 1]\n    }, {\n        src: \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADMAAAAmCAYAAABpuqMCAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAN1wAADdcBQiibeAAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAQLSURBVFiF3ZnPT1xVHMU/983QYcbqlNZoCmEkqCxMtJsm+gfQ2KaJqaYurDHaZeO2dmH8lZg06qZLtYY0RhqkKFrd1KYJE2VhqiQG5YftDAwEShFpARmGN8y84wIxhQLvx8xA0pPczbzv955z7u97B+4hmLLXKN0PHASeA54A9gJ7gGngBtAPfAdcwpj5svOXBVIN0odIC0jyULJIHyDt2m7pqyEdRZr2aGJtmUZ6YbstgGSQ3kFyAhpZKQ7S20jlH/Y+zLxboom15a3tMnK0DD2ythSRnt9qI7tKmCNu5RZSTRBZVkA7bwK7A+a6oQZ4I0ii/wm3vI9MAtEghB6xADzsdx8K0jMH8WAkBgudkLRhVJC3YfQrSEYh54EjBjwbQJtPSF+4jfuYlJ2Rftc6uC31Rr1trJ9vhZlf3YR0Sl3rGVnBBanLg5lftsLMDTchtjSymRlbyngwM+5XWpAFwAZ2bBoCeZcY20DEhSmPMW4xqxBkAfjHLSAPN12+T3jgmfOs6D8EMTPpFvA9DG32/RvIeODZtEHKA+mc23iPSgu3pd715sstqbdaynmYMy1+pQXpmS63gBxEa+GxDkjmYQTI52GkHZK18PgiVHvgSfoVFmQB2AmMAXHfud4xC9RhTNZPkv+eWT5inPOd5w8tfo0Ex/IVebJCp+bJoKfmUgwdq5CZY0EllXZNlc4DgcnvQrHYlmhsfN2yrEhEitrGRKokUyhaVQDhkLNUsCzHGJPbYdvZJ8fHZzqguJJeqpk48BvQUFI9gDU/P5M4dOjT8NjYond6UzQiE7b002Amkwl6OVuGMbPAK9zROoEgac/p0xf9GFmmVwhLjxbg1YaGhobSzCzX2A18VEoVOy9f7o63tWVKURFynLryPO1IYaAbeNpvanhiYuKRAwdaTDYbuHcdcBw4W3rPABhTAF7GwyF0VdrS0tJDp059XYoRpLwJhTozmczN8pgBMCYNnPSTEm9tvRTr7p4OyCjBQKRY/CSdTv8BlXk4vwC86BYW6e8frD98uD0AQ05SL+FwTzqd/uvOD5Uw86Cx7WuKRDbcxa1sNlt35MjHkVTK05FFMgWMUrKsvkQiMZBMJgvrxYWDat4QxvxtjY+/Vqyt/Zb1G0u7z5y56GZEMksWzrCxrD4nHBpMpVI2wNDQxlelij1UV42Onl+qr7/rdBBLJn+uPX78hw3SchgzZMG1qlhsoK+vL++Hs3Kv7sPD1VY8/qdTU5NY+Sk0NTWVaG4+G5qb+3+YCBaQroctq/+p/ftTHR0dgVe2iv6FEO3peWZx374fFQpVUSgU95448dl9V65MArMYkwrBtZeGh6+/B04ldZQN1Vevvm9sO/fAl+2tTY2NzU1NTXVUuBHvCfwLna16k1MlopgAAAAASUVORK5CYII=\",\n        anchor: [0.5, 1]\n    }, {\n        src: \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADMAAAAmCAYAAABpuqMCAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAN1wAADdcBQiibeAAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAATaSURBVFiF3VhdbBRVFP7Ondlddvqz/aERARtFMUos4YFIH3iAxESICfCABtqkCRiJtjGRBBODivhH1PigEovFGKhJXWktpdgQfDCugEFrCEhbitvdditSKIhtge52d3bu8YE2AWx7d2a2D/o97jnf+c43996Zsxf4H4GyXXD25ta8MSOxiiWvAWERCPeCUQzCNYAGwHyOGIf90I5erX3mZja1s2Ym8EJDYZq0V0D8IgB/BpQ4gN0ez9h7wx9tGs5GD1kxk1sdXM+EOgBFDuh/E9NzN2s3HHTbh3BHZzJqvt7BhEY4MwIARUz8jVEdfB1gVw9Xc0M2qh95gwhvwv0KExFWeh7vTJu/Nh9zXMQpcXxrNbqpMQmkBNYnPt3Y4oTsqJGCl/YVmOasKJxvrekwpEv54MieyiG7REdnxjR92zEzRgCgMC3Ey06Itldm9ubWvIQ/PojMXr9OETdYu8fud0i3qzJmJFaB1UZyvHp8b1V5++qyuQu8mpiTsuTlIx0DvVvqTy6Lm5aKbyRE+kkAzXZ6s73NWPIaVU6OV4+Hd63tXbtk/gqvJkoBeL2aKF23ZP6K8LvrIoZHSyh1AKXO3bB/ZgQ9qkrZW1XeHpjleWyyWIHhKaurKv9FqcO0yHZrdgkAz1VlrC6bu2C6+FOL5z2QgZBS527YN8MoVqV4NTHHTXwcszPuaRxOXs03VAkpS15WxC9loHM9447G4WSbDaoyjnQM9E4X//bMhZhShjDtA5kMDsxQuypjS/3JZcNxs2Oy2HA81fF8Q3u5Uoah1LkbDs4M/aBKiZuW/+FXDz3UcvpCKGXJfgCplCX7m0/1hxa+1rowkbJmZaAUstua7QmgpLoxN07WnwACdrk2MDLqN+fhw6pROyTbK3NrxKB9dnn2wF/YNQI4HDR1ab0F4IoTbga4okt+xwnRkZmRPZVDIGx1wlWCsNXJ+H+L6gI5NcEGABVuatwBtoLFbdtrhBA+H7M/SeTzMFPaEh4A0DVppoWQRJTwJpOjZRcvDjcB1gTdlZnCLY2BlMc6A+B+dy4AkU4Olxz7uE4khsYy5TCTRYyYLvj4+Vgs5vovb171V8slUQhu7hMYHOhs+dL4oz3mtEIaqHd5OwPcqK04AeADNzX8g10nXBgBANKknOfaDACMlszZAUA91k8CbWzkUuBs049u9CUgLSGiWTGDnSvTuqBKgJVD6O0gaZmB35qbyUxa6uwpwJwiTTsYi8UuZ8cMgJHdG6JMYpsdjr//5FHfXz3XHEoyA90+y/osGo12AjNwcZ5TE2wE8LQqz3v90vni458ccCCRYOaz0PVT0Wj0jg+37QsNFYTJ1axZT7DQC6fOSY7mnw62ZVqTmdIgjrAQXaWlpd2hUCg9WV7WVwYA8jbXrpH+wkNT1Of8c23BnL6feqarwUymgOwjIbqkpp2PRCJJle6MmAGA/E21DZZR+K/pwHf195+L2vd/NwUtAaJeAYQ9htHd1dWVsqOZ9W02gevsfzY3NbqcvTmlE7+J5M2rgdMHvr89j4E4mHt0Ic4tXro00tTU5PjNNmMrAwBFle+XpwLzjzEJD6RlFZ1q+Nx3pXsQwAiIIhoQ3tjX17MTkNnQm1EzAFBQsettM3DfNv/FM81FnS37oevd4XB4AADPtPZ/Gv8AkvXQkIP4nXQAAAAASUVORK5CYII=\",\n        anchor: [0.5, 1]\n    }, {\n        src: \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADMAAAAmCAYAAABpuqMCAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAN1wAADdcBQiibeAAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAASpSURBVFiF3ZhbbBRlFMd/3ze7bXdp0yKlQI2NIqZlK8YHjDxgFEIikVhKAibeooH4otFIosFLgvdEn9QQHojxAkoIFChRMWBCXC5GxRgb6sJSWrrlDgXbUrrbndmZ44Mlwdru7MxsH/T/ON/5n//5z5n55swH/yOoomesb6rAMBaDNAExYAYwBbiC4hxwFORrKNlDouVaMaWLZ2bOksk44VeA5xEiBTDSiFpHqbxP267+YpRQHDONS5cjagNwkw/2n2j1DH+07gxahhGQr2hcthZhPRD1mSOC8Ag1DQ69yYNBiglmJtb8BvAWwTusgAVUN+S4nDzgN4l/M41Ll4NaTzHfO8UDVNe3c/l40h/dD+5ursKkC3/viBv6MKzbad/d55WofclZ8hoTYwRgMnb4ZT9E752pb6ogpC8WuP36RRoVnub1O+S9M4axuBAj0bLS9M6P18SzbdtPSaLVzLZtP7X9ozXxSKQkU4BKFKwHvZbmvTOx5i+BJ/JWUlaaPrf/s5OV5dE7R6/1Dw611y5YOSuTMfPfEKU2kWh9yktp3jujmO0W8tUHLx4eywhAVcWkORvfe+EXVx1HYl5L825GqHULWXL/PTPzrS9dOO82Vx3lrjMafnazKW4BJWFjepD1EVQXXNEI/JgZdAswLfuCy/r5AnSuFlzRCPyYuegW8E3815P51lv3/ZQqQCfvDRkLfswcdgt48tUP7+0fHGofa61v4Fr706+vm1cMndHwsQHID24hmYwZqV2wclbL3h/jpmX3AKZp2T1b9xyK1y5cdcfwsFnmrkPca2nevzONK8rBOoNQ6ZlbKBQDGOmbOfL9kBea9878PWJ87pnnBcKnXo2A30FTW28Dl3xx3XEJw3rXD9GfmfbdfShZ7YvrBiWr/Yz/EPTHKta8GXgsUI4bIc6WuqG257TWpaUikaxSpWERlbN1GCBkOFZOa0cplSnJZofmnD3b3wL2dXowMzNXVFJmtQG3BsoDaJz+uuHkhpBjDhfKEVG2ElIhLQeTqVQq+C9v47L5IHEkyHmCyFTrzKZK60rKb4IcbAx6OgO9yVNMbSgD7vObotweOFRtnv89QBVKOU6vvw1gNGr61wLuY/0YCIl5fpp5en8QeQccW+uu4piJx3NoHqeAIfRGKLBqzNM7lNi2e/Q4EDGVYexMpVIXgj9m13Ep2UdNwxXg4UIpVVbvd5W5y3mH0jwQgWSZbW873tPTAxNxcB5r3gascAsrdTLJW4aPb/WhkBGRI4RCv3V1df3jwx3ykSw/cvazKqQWCXryeCFa7KEaq+fbQlOKqBxKOkXrRF1d3bF4PJ4bK674nQGM+iVNthHeNU5+qTbPbqnK9Z7Il0NEWRqnW2mdcAwj2dnZmXXTnRAzAOHYQ5stSv41HURzgz/Xml17x6FlUOqkho5wNHoskUiYXjSL/5iNwEqnV+mInu+oUN31a4bkeqdlU/tuvIUCaUROhLQ+etfcuZ0tLS2+d7YJ6wxAZPaiecO6/IAIYUTsGWb3J5PsqxeBAZTqNKDj0e7uE2+CUwy9CTUDUFa/6J2sEX2pwurfMd0+8wWh0LGOjo5zgEy09n8afwEcs7T5cvn0GwAAAABJRU5ErkJggg==\",\n        anchor: [0.5, 1]\n    }, {\n        src: \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADMAAAAmCAYAAABpuqMCAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAN1wAADdcBQiibeAAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAS2SURBVFiF3VhbTBxVGP7+szPscmkq1FZqE2pvUYvYwpK0SUla0ib0iaf6oD6a+qDxoUlNvMTthZp4ifHBB22M8ZI0jVCqVk0gbeOKxAsJpAG3ENiBxdiWSypQdmd3Znbm9wGaCAKzc2b3Qb/HOf/3ff835+TMmQP8j0D5FjxwYGhdJlN0lIibmbEbwGYAGwDcBXCbmW8KIa6k0+mOWKw6mU/vvIWpqRkvV9XsK0R4CUBxDhQdwAe2Ld66cWPbbD56yEuY+vrRY8x8HkCFBP0vZhzv69tx2W8fwh+dKRzWIszcCrkgAFBBhEvhcPwNgH29XF9h6upGIwDOwP8ME0Bnw2HtdZ8iclhcWq1+NFaAw8zH+vp2fiVDlmpk796xBwIBR4P80loLM6ap7BgY2DrjlSi1zBSFX0NhggBAeVFR9mUZoueZWfiOqJPIbfuVhZ7JZB7y+h1SvLpkMkVHAXYNEgoJvaVlY09DQ8l2VaVKy+KJri59NBKZ2mcYrvyS4uJQE4B2L715XmZE3OxWEwoJvaNj62hjY+khVaUqAEWqSlWHD5ce6uzcGg8GKe2mwUyuPsvhOQwzHneraWnZ2FNWRk+sNFZWJmrOnNn0m5sGEe/22pvMBvCwW0FDQ8n2tcYPHizZ5qbBzK4+yyETZoNbgapSpZ/xBdCDube0AIkwNO9WYVk8sfY47uRgdC/nlhYhEYYn3Sq6uvTRtcaj0VQiB6M1X8hKkFlmPW4FkcjUvmTSGVhpbH7eGTh1amq/mwazu89yyGzNP7jVGAYXNzWN77x2LRW1LB4HYFoWj1+9moo2NY3vMk0OuTYmKOq5N6+E6upYWSgU+hPAeq9cD5izrNIt/f2VKS8kzzMTi1UnifCpV55HfOI1CCB50DQM5SyAKRluDpgyTeWcDFEqzOLx/IQMNweckDn+Az5/rMJh7QKAZ/xoLIV9cXr6yItCiGCQudggCqrMlLWFCgBKwLGyQjhElC4yjFTNrVuzbYB9n+03zHoANwA84isDAGZ9Njl7/LzjTGRy55BNjIQi+KehRCLh+5c3HNYaAEQBBORVmPXU+19Yme8TsgJZ4HOftzNAb++ObgDv+NGwzO5uH0EAgAKOs8V3GABYt+6PCADXY/1KYGf6Tjr59o9+/B3AsYXQ8hImGm3MAs6zAFwPoUthWXrq3XbmtO1euwqYTQoELicSiYm8hAGA3t5dGjOf9MIxMt92ZM3eu5KWzMBg0LY/0jTtd6AAF+fhsNYK4Cm3OierDc3PPf+lhEWamfuhKL2api35cHu+0HBH9gVm+whRsHy1Cnb0VDJ57rtcFZkpC+I4CxGrqqoajEaj2ZXq8j4zAFBb+0uzEJu+XkWfM6kPLxqZSyNraTCTJeCMkRAxJxAYisfjhptvQcIAQG1t9wUhNv/rdGCZPb/q8692rkJLg2hUAMNqSclgLBYzvXgWYJktYGbGeq6iYq6BaH3V/WeOMzOdTr55/Z91DOhgHlGEuPlkfX28ra1Nemcr2MwAQF3dlf1Ej3UBARWwbf3e6Y8t6+dJAHMgigeA4afHxkZOA04+/AoaBgD27PmmRVEePWka19sN/b3PoCiDw8PDtwFwob3/0/gbh/Lm30zcQi4AAAAASUVORK5CYII=\",\n        anchor: [0.5, 1]\n    }, {\n        src: \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADMAAAAmCAYAAABpuqMCAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAN1wAADdcBQiibeAAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAASdSURBVFiF3ZhbbBRVHMZ/58xeSgNCqRegsamt1EhEXwjw4AMmJGpAEhNoVOItxgdFQ1C5qqQiKiVRHtQIGuKDXNItFJGSoFFYpIltExIj9EK7WxbTUi7BFqHbTndm/r60CWDp7MxsX/ge9/y/7/t/55ydOXPgDoLKtWDVQZnkDPGUgiUIs4DpQCFwBTgv0KLhpwE4UlmhrufSO2dhPtstBSrEOhRvAxOyoKSV4stIiC2rnlV9ueghJ2GqYrJUYAcw1Qf9H6V4fe0yVRu0Dx2ELCJqS0w2CsTwFwRgqgj7qqrlQxEJNLmBwmzdx0bgI4KvsBLFpqp9vB9IxC9xeGvFgmiMAkdg6foKdcAP2Vcj2w7IFDNDEv9bayz0Soay9ctVr1eir202lGED4xMEoIAQq/0QPa9M1UGZJCYXye7x6xfpQbjP63so5NVl+IXoGiQSIr14Lk1l0ynVmmmOw4WOHjrrGpln2a78/KjwJLDfS2+et5mCJW41kRDpFYvpnFnEAq0pBiJaU/xQEQveeoZEyGAgFz63wvt/RnjYrWTxXJoiYR4ZbSwaZvaiuTS6+ihmeW3NzwNghltB2XRKxxovn8EDufC5FX7CFLqKaqYFGR/G3Vl3NKLrlQBccytwHC6MOS70ZOHzb9YdDcNPmItuBR09dI413t5Nyk1DMfaEjAY/YZrcCuoamWdmODXa2OAQpw43Md9NQ5S7z63wHkZxzK3Espnw1SEebOsi7jicA4Ych3NtXcS/rmOmZZPnaiPEvbfmEZUxmZgHXcBkr1wPuGoMUrT6JdXvheR5ZSor1HWE773yPGKn1yDg86ApFpuAS364WeCSZNjsh+grzPDxfJUfbhZY5ef4DwE/rLbEZDfwQhCNG+HY9t7ta0tXaK2jUZEJplLRsIiybB0GCBlOxtLaUUoNREyzf3Z3d18N2CP8oGEmA38CJYFSABnzel/tF0/vuNbbNZgtR0TZSkiFtJxoS6VSge4A1lWoq8CL3DA7/iDScPjTg16CACglBlrKLHi5pKSkJFAYgHUVql6ErUE0Uqd/qT/TsDcVQEIZjlMUOAyAeS8bIYtj/Sjo7+vpOV797vEg/g44ttbJnISpfEJZ2mE5WRxCb2rCzmSO16zZnzH7/W9TkSFlGLWpVOpCTsIArHlOJQXe88Jp+WPXkfMd9Vd8WopAa9S2tyeTydMwHhfnMYkJLHOru9LT0nZg26JqHxYDIvIXodDJZDJ504vb84WGGwyLN00xFxrhaMHtaiyzv//onpV12WqKKAslCdG6ubi4uDUej1uj1eV8ZQA++LZ7ycQpM368jb40HNq89/SJnR1jaYiojMY5q7RudgyjLZFImG6+4xIGYMM3f+++q/D+/50Ous7EG47sfPXn29AGUKpTQ3s4P7+1ubl5yItnzrfZCCJ59muD6d7H8/ILikd+S1+7fPnYnpW/3VgnkEakI6R1y6Nz5iRqamp8P9nGbWUA3vn85Px7ih77XWkj7NiWffSHN75Ltfx6EbiKUgkD2p8/e7ajEpzx7CNnWLm16eNP9pgDr6yu3lVeWrqwvLy8iHGexDsC/wHqq7fSQTg4DwAAAABJRU5ErkJggg==\",\n        anchor: [0.5, 1]\n    }, {\n        src: \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADMAAAAmCAYAAABpuqMCAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAN1wAADdcBQiibeAAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAARmSURBVFiF3ZhfbBRVFMZ/d2Z3y1aatoCAbVyxahON6AuJPPDQGIIakhojPihqJCIoxBDinxgJTUUSlVcjYTENYNo0UCiKRKrRdFUetJGEWAuE7rZLA+VPg22Fbdk/M8cHtkmtbWfmzu4L3+Pc833nfPfczD0zcAdBFVqwCSnLwdNAPfAIcA8wH7gODAJnBI5Z0LEZdbOQuQtmZjdSacIHwNtA2AVlTMHnQfh0HWqkEDUUxMweZI2CKDBPg/63wBtvotr91mH4IQui9iINCg6hZwRgnoLDUWS7IL4215eZvdAg8BH+O6yAHVHY5ldEC/mjdciPxjSwFazZgDqqQ9YqZB9SkYEE+kdrNgxb8MAm1LBXotYxy8CHFMcIQKUB7+kQPXcmf49cxd3rVxdjOVjk9R7y3Jn8hehoJFDK2Kp2YuvTDGwQMuvTDKw6TCwYZtxFmtIgPOW1Np1jVu8UEChl7OVB+pY8R50RIgKEjBCRJc9Tt3aQuEtDjnmmQsfMw04BTzbTFSrn0enWQhUsrTvA704acnsU8gQdM1VOAZHV1My2ft+z3F+IPFOhY2a+o2iIxX7W81jguqIJXa8E4IZTgJ3hisP6ZRd5/nFdUR46Zq46BQx8S99s6/1HSbrIM+uGTAfPZgS6nGI6X+GJzAjd062lh+mOvcZyF6kc80yFTmc6nQKy44Rbqniwv42YneECkLEzXEgcJNZcxUPWLeY4aSiIeS3M8wTwBTI3ABeBcq9cDxgNQ/WrqJQXkufO5EeMfV55XqCgyasR0Bw0LdgBXNPhusC1HOzUIWqZyY/nW3W4LrBVZ/wHnx9WUaQFeMmPxmTYWK2fRGo2G4ZRUiISTitVEhRROcsIAgRMO5szDFspNR5Kp1NLL10aaQNrgu/XTDlwGljiywWQMW6O7K96JjoauHjLLUdEWUpIBgz59VwymfT9yRtFVnD7NWrqq4h0zN/2VXdZa1JXIAcHfP3QANiIOimwy49G710/nPRhBECZtl3t2wzAFWgA57F+OtwwL18+seCdn/3kt8G2DCNREDONqBywFhdD6GRYKpv97u73j6RVynKOngEiGWWa7clk8kpBzABsRCWAd71wTpc1dwzMOXldM6UInC2xrD2JROIvKMKP8yhyCHjBKW4odObc/qrVBzVSjIvInwQCpxKJxH8u7oCGmBM25VR6ZUBKKmcKyKhU6puFW467FRRROZTExTB6IpHI2VgslpsuruCdAfjMvFRfYVV9PYO+dFbubP2jvKl3Ng0RlTWw+5Vh9NimeS4ej6ed8hbFDMCu4EBLefbe/00HfeHYb0cWrft+Bto4SvUZcD5YWnq2p6cn4yVnMY4ZAGNZ6/WQMbwibFdGJp6lzKGh4wu2/DQ5TmAMkd6AYZx5bNmyeFtbm/abrWidAWgMn1q++NbjvygxgzY569jCt77sLf3xKjCKUnETzr/Y39/bCHYx6ygYts/p+ni3So9vnnuwubamZmVtbW01Rd7EOwL/Ai1BeTIkgAbWAAAAAElFTkSuQmCC\",\n        anchor: [0.5, 1]\n    }, {\n        src: \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADMAAAAmCAYAAABpuqMCAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAN1wAADdcBQiibeAAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAQMSURBVFiF3ZnLT1xlGIef78zAMFgCeGscLCGoLEy0myb6B9SIMTXW1IU1Rk3cGF16SYy3xMRUN8aVWkMaY0lDUbS6qbcwKjGmSmKwXKQzMBAoINICMgxnLufnoqWhCJzLzEDSX/Ju5rzved/nu39n4BqSKfULhWqAVuAh4E7gFuAGYA44DwwAXwGnDWap1PlLIqF6oXeEloXkwdJCR4Tqdrr2qyR0SGjOI8R6mxN6ZKcZEDJCrws5AUFWzRF6Tajkw94PzBtFQqy3V3cK5FAJemS9FYQObjdIXRFzxM0uCNUHqcsKyPMKcH3AWDfVAy8GCfQ94S7vIzNANEhCj1oGdvvdh4L0TCteQKpZpos4NuOILDbjfEacKBkPOaqB+wPU5k9Cn7qO+2qlNa8/tZEuqk9RTxvrJ9sB87trIV3q3hBkVSfV7QHmt+2AOe9aiK2xLWFspTzATPqtLcgCYAOVLk5ZFx8bQ8QlVdZg3HyuUpAF4F9XjyzTLs+nPORZ9FjPFQWBmXH1+JqRLZ9/QcpDnq0bpBQSOuY63qNa1kX1bThfLqhPVcp4mDNtfmsL0jPdrh4ZosS4nU7iZBkDsmQZo4M4Me5ghSoPeeJ+CwuyAOwCJoBav7E+tAA0GEzaT5Dvnrl8xDjmN86n2vyCBJYuXZFnynRqngl6ai4G6HCZYA4Hramoa6pQOxA4+XoVKJxobmx+zrKsSESK2sZEKiSTL1gVAOGQk8tblmOMyVTadvquycn5TiisxhcLUwv8ATQVRQEsWUvzB2IPfDQRnljxnF+mYEQqbOnnoVQqFfRyBoDBLABPsKZ1gkhIR+rfPuUHBMAYhbB0Wx6ebGpqaioKBsBgeoB3i3nHd9d929NRcyJVTBkhx2koyacdoTDQA9zjN3Y6NDXVeut9bWmTDty7DjgOHC26ZwAMJg88jpdD6BrlTC738k0vfV4MCFLWhEJdqVRquiQwAAaTBF7wE9Nec/z0L1U9cwFTSjAYKRQ+TCaTZy/VUGIJnQQedfMbqhwYOhB7sCNAioykPsLh3mQy+ffaB+WAudE29nBEkU138WWTTh9sePiDkXDC05FFMnmMErKs/sbGxsF4PJ7fyC8ctOjNZDD/TFqTT8UKsS/ZuLH0ft17p9xAJJOzcEaNZfU74dBQIpGwAUZGNr8qle1D9XjFePue3J7/nQ5+jMZ/fWb3099sEpbBmBELhiuqqwf7+/uzfnKWDWaU0apaq/aveqe+cfW32dDsbGts/9HF0OKVYSJYRjoXtqyBu/ftS3R2dgZe2cr6F0JvtPfevSt7fwopVJEnX3j+5mc//qH6+xlgAWMSIRh+bHT03JvglLOOkulM1Zm3bGNnOnZ1HG9pbt7f0tLSQJkb8ZrQf5kyepAtajIBAAAAAElFTkSuQmCC\",\n        anchor: [0.5, 1]\n    }, {\n        src: \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADMAAAAmCAYAAABpuqMCAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAN1wAADdcBQiibeAAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAASoSURBVFiF3VhNbFRVFP7OffMY6EjnvYGMrW2atmijRNyUBJcsTGRFQkJTKwpuXBliSDQxGolVEo0rjAuBhLCRGFuL4AoXTauWaBtNTHHoD/NHImXoOH2vY9+Uzvs5blpSoO37m7rgW777feec794zb867wGMEqnXAYrG4XQhxgIgOAtgNoBHADgAlADMAbjDzD7ZtX00mkwu1zF0zM7quq47jvAfgOIBtHiQVAF8S0Weqquq1qKEmZkql0mEiOgsgEUA+R0Rvqqp6KWwdIoyYmUnTtJNE1IdgRgAgwczfaZr2ITOH2txQZnRdP8nMvQh/wsTMH+u6/kGoIEGFy63VFybGGnCI6LCqqt8HEQcqRNM0hZkzCN5aG4YXQuxSFEXzKwzUZsz8PjbHCACojuO8G0To+2SKxeJ2SZLuwtvrNygqlmU96fd/KOI3ixDiADwYIaJKLBYbk2W5HUADgIJpmlnDMPYxs5u+TpKklwEM+KrND3m5yIMeOJV4PJ6VZXk/gBYAWwC0yLK8Px6Pp4losRZ5HkaQ38xzboRYLDZGRM+vtUZEe2Kx2KhbDGbe7bewIGaeciMst9ZG621uMYjINc/DCGJmhwdOQ8h1ANjpgfMAgpj51wOn4LJ+x0OMsgfOAwhi5q4bwTTNrMt63kMetw15BL7NMPOYG2f59Xt9Hf31SqXyolsMInLN8zB8mxFCDLlxmHnb/Pz806ZpDgO4BaAK4JZpmsPlcvkZx3G2ekg17Lc23xPA7OzsE5FI5G8Acb9aH5ivVqtNDQ0Nhh+R75NJJpMLzHzBr84PiOi8XyNAwKlZ13XVtu1JIkoG0W8EZp6VJOnZ/21qVhRFI6ITQbRuIKITQYwAIT+s5ubmLgJ4NUyM1bBt+5vOzs63hBDRKPO2JaKozEyWLWQAiEiOaQnhENHilqUlY8/t23o/YK/ow5qJA/gTQGsoFwAMw9CPdHefnZmZuedVw0w2MfIRwb9M5vP5UHcAiURiHsDrWLU7QcDM/MXp01f8GAEAIpYgeJcFHGttbW0NZQYAEonECIDPw8T4aWho5PLAQD5ECJIcp6kmlxHMHNE0bQTAPr/au4XCnVe6us4bhhH4dB3AcYBzoU8GAIjIEkIcgbch9D4syzJ7e3sHwhgBc5Uk6VI+ny/UxAwAKIqSAfCOH01/X9/V30dHSwFTMgMTUds+k8lk/gI24eJc07Q+Zu5y401PTU2+1tPzbYAUi8w8jkjkj0wmM7t6oeZmyuXyTsMwpqPRqLpuNZWKcezo0a/y2aynkYWZLBCnWYhUS0vLxPDwsLUWz/ftjBvq6+v/SaVSbzQ2Nl7G2pvF586cueJmhJlMASdHQqSciDSZTqeXACCbXf9TqeYns4Lx8fGLzc3Nj0wHv1679tvbx4//uI5sEURZAUzLdXUTqVSq6ifnppnJ5XJbmXlKUZSWlWelUqnYdejQuYWFhfttwkAFzDcjQtx4Ye/edH9/f+A3W83bbAVtbW33hoaGuuvr638WQsiWZdmfnjo1sGxkHkRpCZjuyeVufgQ4ADCVy21WObXB4ODgJ4VCYfHC+Qtfd7S3v9TR0dGETeyIxwb/Abxf6DIUZxAeAAAAAElFTkSuQmCC\",\n        anchor: [0.5, 1]\n    }, {\n        src: \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADMAAAAmCAYAAABpuqMCAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAN1wAADdcBQiibeAAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAS9SURBVFiF3VhNbFRVFP7Ond9OlBnApihJM1N0EqltQzoJLFxAQiKrruhCjXFh3GhcEGowGomiJEhYUJtUiTFCGEJsBX9CU2pQqzZB6WtLOgw0MNN5TUSggtNp6Tw6fe8dNyWp0Pa9d9/Mhm8593zfOd+9J/educAjBCq34MDAwOPBYHAHM7cQ0UYATwJYC+AOgL+J6LJpmj+EQqGz9fX1d8uZu2xmRkdHV8/Pz7/DzG8BqLJBKQLo8Hg8BzZt2jRVjhrKYmZwcHAnER0BsEaC/i8Rvd7c3HzabR3CDZmZSVGUvUTUBTkjALCGmb9RFOV9Zna1ua7MDA8P7wXwIdyfMAHYNzQ09J5bESkstFaXG40lYBLRzubm5m9lyFKFjIyMRAzDyEK+tVZC3u/3b2hsbMw7JUq1ma7r76IyRgBgdalUeluG6PhkFr4jt2Dv+pVFsaqqqsbpd8jrNEswGNwBG0aEEMVYLHYhHA7XEdE6Zr5ZKBTGc7ncZtM0rfihYrH4AoBTTmpz3GbM3GIpKkSxqalpPBKJbCWiWgB+IqqNRCJbGxoaMkIIzUqDiCzzPJTXKYGInrWKicViF4QQzy215vV6G6LR6J9WGsy80WltMhfAU1YB4XC4bqX1SCQSs9IgIss8D0LGzFobhaxzs76AJ2xXtAAZMzNWAcx802L9ho0807YrWoCMmVtWAYVCYXyl9ampKdVGnhU3ZCnImLlgFZDL5Tbrup5aak3X9ZSqqlusNIjIMs+DkLmaf7GKMU2zKpVKPZ3P5/uZeQJAiZkn8vl8fyqVesY0zaANjX6ntTmeANLp9GOapv0FIOyU6wAFn8+3vqmpadYJyfHJ1NfX32Xmr5zyHOJLp0YAyUEzEAjsAzApw7WBSb/f/7EMUcrMwni+S4ZrA7tkxn/A5R8rRVFOAHjJjcZiGIZxsrW19U0hRCDAXDVHFPAxk24IHwB4Pea8LoRJRJp/bm624fr1qW7AuM93ayYM4CKAqCsXADRNm9qze/eRycnJe3Y5zGQQQ/UK/n1MVVVXbwCJRKIA4BUs2h0ZMDMfP3bseydGAICIPRC8QQdejUajUVdmACCRSAwAOOhGQxkcHPj53DnVhQR5THO9azMAMDMzsxeA5Vi/FO7cvn2js6PjVzf5TcA0hMiWxcy2bdt0AC/DxhC6GLquz3/W2XlK0zT5NmUukcdzWlXVm2UxAwCJRCJLRG1OOD/29Z29NDp6RzIlM3AlYBifZ7PZS0AFHs4VRekC0GoVN6GqY3va2r6WSKEx8yi83qFsNvu/D7fjBw0beKNUKm33+/2rlwu4p2mz7e3tZ+wKMpMO4gwLka6trb3S39+vLxVX9pMBgN7e3pbq6urvltHn40ePnuw5c+baShrMNC9g5kiItOnxjGUymTmrvBUxAwA9PT0nampqHpoOLo6M/HFg//6+ZWgaiMYFcNUXCl1Jp9MlJzkr0WYAgFAo9Nr09PTzq1atqr3/W6FQ+OfTw4d/WhzHQBHM17xCXG5MJDLd3d3SN1vFTgYAksnklng8/psQwqfrunH40KEvFEW5BaAAoowHuPpiLnftA8CsZB1lQzKZ/Oj8+fPawU8OJuN1ddvj8fh6VHgTHwn8B/S71Ufd4vUbAAAAAElFTkSuQmCC\",\n        anchor: [0.5, 1]\n    }, {\n        src: \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADMAAAAmCAYAAABpuqMCAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAN1wAADdcBQiibeAAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAATTSURBVFiF3VhPTBRXHP7e2xmBTYwgDXVdQ6m2hxrsyaweeoCkSXtQExOZ0JLSQ9NLmx5MbGya1P49NCRoQg9UG1MTA5RZEbegsYemVE1gMU1JBRZhF9dkccHGAkUXZmfe/HooJJTCzs6b5dB+yV7m/b7v9/veezvvNw/4H4EVWjASiWzNZrOvAjhCRHsBBACUA3gE4AGAUQDfA7iuadrjQuYumJm2trYyRVE+YIy9B6AkD0qGMfaVoihfHj16dK4QNRTEjK7rxwCcBbBdgv4HY+zturq6y17r4F7IRMR0XT8FQIecEQDYTkSXOjs7PyIiT5Pr80Kurq7+GMCn8L7CjDFWG4vFrHA4fENaRJa4vLV0LxrrwAZwTNO0bhmyVCHd3d2lpmkmIL+1cmHWNM09DQ0Ns26JUv8Z0zQ/xOYYAYAyRVHelyG6XplIJLLVMIwZ5Pf6lUUGwNNuzyHFbZblA9HRiKIomVAoNBgIBHZzznfYtj2dTqcno9HoASGEE99PRK8A6HJTm8w2O+IUoChK5tChQ5PBYLCGc14JYAvnvDIYDNYcPnw47vP5FguRZy1cmyGiF5xiQqHQoKqq1euNqaq6LxQKRZ00GGN73dYmszI7nQICgcDunAI7dz5biDxrIWOm3FGU8x1expfxVN4Vrei6JQBYcAqwbXs61zgRpfPI82feFS1DxsyMU0A6nZ7MNT41NZXMI0/OCVkPMmYGnQKi0egB0zTvrDeWzWbvDA4OHnTSYIw55lkL12YYYz85xQghSnp6ep5LpVJ9tm3fB5C1bft+KpXq6+3tfV4IUeykQUR9bmtzfWgS0WUALQC25YoTQpT09/fXrHr0zPIvH8wvLS25/r5xvTKapj0mom/d8lzifGNj4xO3JKlG07KszwA8lOHmgYemaX4hQ5Qys9yeH5fh5oHjMu0/4PHDStf1NgCve9FYDSFEx8mTJ9/lnBcVEZUYjBWpRMwSXAUAxWebFuc2Y2xxi2E82Tc1NRcGxArfq5ltAIYAVHlyAcAwjLmW06fPzs7OLuXLIWKCEZIKp5tjyWTS04WGpmnzAN7AqtmRBF27ejXixggAMEY+cNpjAW9WVVVVeTIDAJqm3SKiJi8ao8PDt24PDCQ9SDCfbQc9mwGAioqKUwAc2/r1MD83lw53dv7sJb8N2ILzREHM1NbWWrZtNyCPJnQ1hBDmpXC4yzAM+W1KlGU+3+VkMjldEDMAUF9fnwBwwg0n2t9/PTEx8UgyJREQKxLi60QiMQxswsW5rus6gDqnuOl0eqzlzJlOiRSLRPQbFOWXRCLxj4PbdW/mBMuy3iGil1VVLdsoJmsYTzra23vz1SRiFhjFifORysrKWF9fn7VeXMFXBgDOnTt3pLS09MoG+nStp6fj1s2bE7k0iJjJYd9jnI/YPt9YPB43nPJuihkAaG1tbSsvL/9XdzB+9+7AhfPnf9iAtgjGJjkwrvr9sZGRkaybnAXfZisoLi5+K5PJvOT3+ytXni0sLPz+XXv7j6vjCMiAaELhfPTF/fvj4XBY+s22aSsDAM3NzQeDweANzrkqhBAdFy9+Mzo6OgNgHozFfcD4a/fuTXzy94W5Z2yqGQBoamr6fNeuXSeGfh3qutJ16QIUJTY+Pv4AAG127v80/gIGr+iWe+FGsAAAAABJRU5ErkJggg==\",\n        anchor: [0.5, 1]\n    }, {\n        src: \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADMAAAAmCAYAAABpuqMCAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAN1wAADdcBQiibeAAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAToSURBVFiF3VhdbFNlGH7ec05/F6IUE9GLIYgXXYpXJBBZE0xM9EausIl6ObzBGSHRdnEJ1p+RhnBBNF4YY/xJFigNaIwxLpFYB2WwMWCW0bG1W7eEdUBwQ0fb7fy83nQJjK3nnO90F/okvTnf+7zP+/Q75/ve7wP+R6BGJ4xGo+skSXqFmfcAaAHwFIANAO4CmCai64Zh/OT3+3+Nx+PzjdRumJmOjo71zNwB4B0APguUMjN/vri4mDh27NhcI2poiJloNLqXiL4EEBCg/8XMbx05cuS00zpkh3yKxWKHiOgLAH7BHD4iiuzatcvIZDJnnRTjyEw0Gv2QiD6C8xkmInqxtbVVy2QyvcJJRIm1V+ukkxwrwCCivYlE4gcRslAhBw4ceNzj8RQg9o2YYZaInk0kErN2iZKImtvt/gBrYwQA1gN4X4Roe2ai0eg6IroFa8uvKMo+n+9Ju/uQYleltiGaGnG73eVIJNIfDAa3yLK8Udf1mVwuN55MJneoqmrG91er1ZcBnLJVm51gAKjt7HXhdrvLnZ2d46FQaLcsy80A3LIsN4dCod2dnZ15l8tVaYTOcoh8M0GzgEgk0u/xeEIrjXm93m2RSOSiBZ0Wu4WJmHnaLCAYDG6pN97S0rK5ETrLIWJmg1mALMsbnYzX8ITlimoQMfOPWYCu6zMm4yULOn9brqgGETO3zAJyudx4vfFr164VzXIwc90/ZCWImOk3C0gmkzuq1Wp2pbFyuZxNpVI7zXIQkanOcoiY+d0sQFVVX1dX19ZsNpvWdX0SwKKu65NDQ0Ppw4cPP6dpmtcsBzOn7RZme9P0+XynK5XKZwAeqxenqqqvu7t79wOPNtV+VnDPMAzb5xvbM1NrMb6xy7OJr48ePXrfLkmo0SSijwHcFuFawG0i+lSEKGSm1p4fFOFawEGR9h9weLCKxWLdAN5wkuNBMPPxEydOvC1JksfD7Fsg8riYSdMlFwAosqFqkmQQUcW9sHB/282bcylAX+LbXgCWYT+AFwA84zAPVFWdO9PTM+WWpHcBQCeCAoCJICsMAGAQZGaAGZrLhcubNutbGUVF4rMjxWLR8ZE3Fou1AkjDwX0CM/OVwcHvJwqFomgKDfjO6e0MMpnMVDgc9gIIi+YoTU+fyw4NXXFQBpFh3BFaAJbD6/UeAmClrX8ElXK5dOnixT+c6BuAoUtSoSFm4vG4ZhjGm7DQhD5UhGGoAwMDp1RV1c2jVwHzIsny6WKxOOP4NVvC+fPnZ8Ph8F0Ar1rlFPL5X8bHxuo2pXXADIx4df3kjcnJSWANLs5jsdhJAK+Zxd2bmxv5racnKSBRYeY/oSiDhULhoY3b6dL8CDRN209EL8myvH7VGFW9f6Gv72erOZlJA3GeJWm4ubk5l06ntZXiGj4zANDe3r6nqanpx1Xyc/bq1eOjN26M1cvBTKoEY4IkadiQ5ZF8Pr9gprsmZgCgvb29u6mp6ZHuYKZUupDp7e1ZhVYB0bgEjLr8/tzw8PCiHc2Gv2ZLmJ+fb1MUpdXj8TQvPatWq3f6+/rOPBjHQBnMY4okXX9++/Z8KpUSXtnWbGYAYN++fTsDgUAvEbkMw9AvnDv3ValUugXgHojyMjD6+sTEWBwwGqG3pmYAoK2t7ZNAIPDe1OTUqSuXBr6FouRGR0enAfBaa/+n8S8PPeWMetb8+wAAAABJRU5ErkJggg==\",\n        anchor: [0.5, 1]\n    }, {\n        src: \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADMAAAAmCAYAAABpuqMCAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAN1wAADdcBQiibeAAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAATISURBVFiF3VhNbBtFGH0z3vXGbqpSikQBKSIOHKgop0quYtMadSsqVfRCoQo9IjiAuAXJ4lB+D0Q5Ig4VQvxIVZREKQhRRNoiNi2VcBECUaUNjmM7VRPHcdP81HGc/ZmPSyKVNMnuzjoHeEfPe9/73s54dnaA/xFYowsmEont0Wj0iBDiGGNsD4BHAOwCMANgEsB1IvrOcZwfDcOoNtK7YWGOHj260zTNNBG9BSDiQVID8Ilt2x8bhjHXiB4aEubQoUPHGWOnATwoIb8D4LWLFy+eDdpHKKCeHT58+BSATwFEJWtEALzc2toqCoXC5SDNBAqj6/q7AN5H8BlmjLHnYrGYnc/nL0kXkRWuLK2+IDXWgWCMHb9w4cI3MmKpRlKp1AOKooxB7j/ihllN09rOnTs361fIZdwURXkHWxMEAHaapvm2jND3zCQSie2RSKQMb9uvLGq2bT/s9z2k+HWJRqNHiMg1iKZptXQ6fTUej8dUVd1tWdZUJpPJd3V1xev1ups+qijK8wAG/PTme5kJIY65cTRNq/X29uaTyWRKVdUWAGFVVVuSyWSqp6cn19TUtOTBytVnLXyHYYw95cZJp9NXt23b9vR6Y83NzXs7OzszHqz2+O1NZgN41I0Qj8djm423t7e3NsJnLWTC7HIjqKq6O8j4Ch7y3NEKZMLcdSNYljXlMl7y4LPguaMVyIQpuxEymUx+s/ErV64UPfhs+kDWg+8wRHTVjdPV1RWvVqvX1hurVqvXuru793uwcvVZC5nd7Gc3Tr1ej3R0dDwxNDRkWJY1DsC0LGvcMAzjxIkTT5qm2eTBx/Ddm19BKpVqVhTlFoAdfrU+MM85f+z8+fOLfkS+Z2bliPGFX50fMMY+9xsEkDxoapr2AYBpGa0HTIfD4Y9khFIfZ6Ojo/VYLDYJ4EUZvQteHxwc/E1GGOjDStf1MwBeCVJjDXqy2eybnHNNI4osM6apRMx2uAoASkhYNueCMbYUXl5e3DsxMdcPOKvioGF2ENGfjLHHg2UAhBBzpVu3TlumWfeqIWIOIxQVTpdHisVi4E9eXdeTAAwEuE8gIpqpVL6uLiwUZUvYwFdBb2eQz+dvtrW1NQF4VrbGUq32y+zMzB8B2mBMiIrUbrYWlmWdAuDlWH8fbMsqzUxPDwXxF4BwOB9rSBjDMGwhxEl4OITeCyKyKpXKgOM4jjt7wyImC4XOFovFqcDLbBWFQmE2FovNAHjBq+buwsIP1fn5TQ+lm4AIGGlynL6/x8fHgS24ONd1vQ/AS248yzRHJm7e7JWwWCKiv6Aov4+Njf3rxe37QsMNtm2/wTnXOec7N+KQEIvlcvl7rzWJmA1GOeJ8uKWl5YZhGPZ6vIbPDAAcOHDgWDgc/naD+jR7+3bP/Nzc6GY1iJjFIQqM82ERCo3kcrllN98tCQMABw8ePKOq6n2ng6Va7dfy5OTgBrIlMJbnQFaNRm8MDw+bfjwbvsxWwRh71XGcZCgUaln9zXGcynSp9NO9PAJqIBpVOL/+zL59uf7+fumdbctmBgASicT+SCRyCYBKRE6lVPqsVquVAcyDsVwIyHYUCqPvAaIRflsaBgCSyeSHmqZ1Lt5dHLhze/pLKMqNbDY7CYC22vs/jX8A/Nff8x41WYEAAAAASUVORK5CYII=\",\n        anchor: [0.5, 1]\n    }, {\n        src: \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADMAAAAmCAYAAABpuqMCAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAN1wAADdcBQiibeAAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAPjSURBVFiF3ZlNbxtVFIafe2cceyZxEitfqiMs1EUWSLDqggXskOiGSqCyoAj+AH8BChISAv5ABahCBaoGJziISAhWMR8LECBQUNo0cZpJpLQNVWMDTZxre+ayMIGQOp7J2DMFXuls5p57zvver7lzBv5HEBHETAMngVPAA8AxYAi4DVwHLgOfAJ8BdyLI3xVkgDeAHUAHsG3gdWDwXpBth9M0Rz6IiIN2G3gqfsp3QwBnAY9wQvbMA14immUfGC/TmYiD9mK89P/GaTqfkYPmAk/GKQKamzbsHvGzLZqHSWx4MwIR++21uISkCX78hrVtoO+oxGQIMScBy8/Jtu2dQqFQVEqta61rSqn16enpomVZ1QA5bODxENyOjPfxGVnbtrcrlcrPugXK5fK8ZVlBZvZCHGK+9yNSKBTmWgnZQz6fnwsg5rs4xFz3I6KUWmsnRinlBBCzcVRiYd64Cuhp56C1rvn4KCFE0idPDfDz+QfCHAC/+znUarWbPu03AuT5LTCjPxFGzKafw+zs7LV27TMzM06APG0HpFt4F5/1blnWTrlcnm+1X7a2tuZTqVTVLwZwPg4xzwcgoi3L2snn83NKKae555UzOTk5F1CIBp6LQ0wfUAlIKKxVgN6jEguzZ+7QXGpR4jzNK00syNA8CKKYlU1ivjUDnOkC8VZ2JiyhTj9TL3aSvAUu5XK5F6SUyaTWlhIimdBaNFyZADANr96Q0hNCVHuU2n5wY6My1fygAzoXMwD8BNzfYRyklJVcNvuWaZq7QftoLVyhcUypv1p0HKcbBYRHgCJgdBBDjwwNvTeQTjth+zfgQicE9rAOpIBHwwbo6+39ejiT+bEDDkJ43q0wR3MrnAW+DdPRNIwbY8PDX3SS3APPlXKlW2IawLMEuITuhxCiPjoy8pEQwvX3PgRa14RhFBzHudmNZbaHMs2KzRNBOwz29386kE63vZS2gdawmHLd/NW1tTWIpoKYB572c0r29Czel81+GCJ+VWs9j2n+sLKy8sv+hijEDAshlrTWh77FpRDb4+Pj55KmGejKorVoIHRJS7mQy+WuFIvFRiu/SGq7hmGccl3340Pi6+FM5tLgwMByuxhai7rEWxVSLniGsVgqlZRf3sgK1YlE4mK9Xr/rdmBb1jfZsbHPD+lWRYhrEpYStn1lYWGhdpScUVbdU1LKq57n5fYeGIZxK5fNvm0Yxl/LRMMOWi+bUl5+6MSJ0tTUVOiTLdJfCJZlPby7u/ul1joBuMdGR9/pte1N4FeEKBmw9Mzq6vIrzQL8vx+pVOpVIUS1v6//g4njxx+bmJgY5x7/h/lP4A+AJ7grnrOyCgAAAABJRU5ErkJggg==\",\n        anchor: [0.5, 1]\n    }];\n\n    // applying default labels\n    if (!this.options.labels) {\n        this.options.labels = {};\n    }\n    Object.keys(Drawing.DefaultLabels).forEach(function(key) {\n        if (!this.options.labels.hasOwnProperty(key)) {\n            this.options.labels[key] = Drawing.DefaultLabels[key];\n        }\n    }, this);\n\n    // applying default styles\n    if (!this.options.defaultStyles) {\n        this.options.defaultStyles = {};\n    }\n    Object.keys(Drawing.DefaultStyles).forEach(function(key) {\n        if (!options.defaultStyles.hasOwnProperty(key)) {\n            this.options.defaultStyles[key] = Drawing.DefaultStyles[key];\n            return;\n        }\n        if (key == \"polyFillOpacity\" &&\n            (options.defaultStyles[key] < 0 ||\n                options.defaultStyles[key] > 1)) {\n            console.log(\"Wrong value (\" + options.defaultStyles[key] + \") for defaultStyles.polyFillOpactity. Must be between 0 and 1\");\n            this.options.defaultStyles[key] = Drawing.DefaultStyles[key];\n            return;\n        }\n        if (key == \"strokeWidth\" || key == \"polyStrokeWidth\") {\n            var intValue = parseInt(options.defaultStyles[key], 10);\n            if (isNaN(intValue) || intValue < 0) {\n                console.log(\"Wrong value (\" + options.defaultStyles[key] + \") for defaultStyles.strokeWidth. Must be a positive interger value.\");\n                this.options.defaultStyles[key] = Drawing.DefaultStyles[key];\n                return;\n            }\n            this.options.defaultStyles[key] = intValue;\n        }\n    }, this);\n\n    this.interactionCurrent = null;\n    this.interactionSelectEdit = null;\n\n    this.stylingOvl = null;\n\n    this.layer = null;\n    if (this.options.layer && this.options.layer instanceof ol.layer.Vector) {\n        this.layer = this.options.layer;\n    }\n\n    // detection du support : desktop ou tactile\n    // FIXME : utile ?\n    this._isDesktop = this._detectSupport();\n\n};\n\n/**\n * Creates empty layer to host features\n *\n * @private\n */\nDrawing.prototype._createEmptyLayer = function() {\n    var features = new ol.Collection();\n    var layer = new ol.layer.Vector({\n        source: new ol.source.Vector({\n            features: features\n        })\n    });\n    // on rajoute le champ gpResultLayerId permettant d'identifier une couche cre par le composant.\n    layer.gpResultLayerId = \"drawing\";\n    // on le rajoute au controle (et  la carte)\n    this.setLayer(layer);\n};\n\n/**\n * Sets vector layer to hosts feature.\n *\n * @param {ol.layer.Vector} vlayer - vector layer\n */\nDrawing.prototype.setLayer = function(vlayer) {\n\n    if (!vlayer) {\n        this.layer = null;\n        return;\n    }\n\n    if (!(vlayer instanceof ol.layer.Vector)) {\n        console.log(\"no valid layer given for hosting drawn features.\");\n        return;\n    }\n\n    // ajout du layer de dessin  la carte s'il n'y est pas dj\n    var layers = this.getMap().getLayers();\n    if (layers) {\n        var found = false;\n        layers.forEach(function(mapLayer) {\n                if (mapLayer == vlayer) {\n                    logger.trace(\"layer already in map. Not adding.\");\n                    found = true;\n                }\n            },\n            this);\n        // si le layer n'est pas sur la carte, on l'ajoute.\n        if (!found) {\n            this.getMap().addLayer(vlayer);\n        }\n        // TODO style par defaut du geoportail !\n        // application des styles ainsi que ceux par defaut de ol sur le layer\n        vlayer.getSource().getFeatures().forEach(function(feature) {\n            var featureStyleFunction = feature.getStyleFunction();\n            if (featureStyleFunction) {\n                var styles = featureStyleFunction.call(feature, 0);\n                if (styles && styles.length !== 0) {\n                    feature.setStyle(styles[0]);\n                }\n            }\n        });\n    }\n    this.layer = vlayer;\n};\n\n/**\n * this method is called by the constructor.\n * this information is useful to switch to touch mode.\n * Detection : test for desktop or tactile\n *\n * @method _detectSupport\n * @private\n */\nDrawing.prototype._detectSupport = function() {\n\n    // TODO\n    // Choix de grer la dtection dans le code du composant au lieu du DOM car :\n    // Utilisation de l'implmentation Leaflet\n    // http://leafletjs.com/reference.html#browser\n\n    var isDesktop = true;\n    var userAgent = window.navigator.userAgent.toLowerCase();\n\n    if (userAgent.indexOf(\"iphone\") !== -1 ||\n        userAgent.indexOf(\"ipod\") !== -1 ||\n        userAgent.indexOf(\"ipad\") !== -1 ||\n        userAgent.indexOf(\"android\") !== -1 ||\n        userAgent.indexOf(\"mobile\") !== -1 ||\n        userAgent.indexOf(\"blackberry\") !== -1 ||\n        userAgent.indexOf(\"tablet\") !== -1 ||\n        userAgent.indexOf(\"phone\") !== -1 ||\n        userAgent.indexOf(\"touch\") !== -1) {\n        isDesktop = false;\n    }\n\n    if (userAgent.indexOf(\"msie\") !== -1 ||\n        userAgent.indexOf(\"trident\") !== -1) {\n        isDesktop = true;\n    }\n\n    return isDesktop;\n};\n\n// ################################################################### //\n// ######################## methods handle dom ####################### //\n// ################################################################### //\n\n/**\n * Create control main container (called by Drawing constructor)\n *\n * @method _initContainer\n * @private\n */\nDrawing.prototype._initContainer = function() {\n    // creation du container principal\n    var container = this._createMainContainerElement();\n\n    var inputShow = this._showDrawingContainer = this._createShowDrawingElement();\n    container.appendChild(inputShow);\n\n    var picto = this._createShowDrawingPictoElement();\n    container.appendChild(picto);\n\n    var panel = this._createDrawingPanelElement();\n\n    container.appendChild(panel);\n\n    return container;\n};\n\n// ################################################################### //\n// ##################### handlers events to control ################## //\n// ################################################################### //\n\n/**\n * Callback de fin de dessin de geometrie\n *\n * @private\n */\nDrawing.prototype._drawEndFeature = function(feature, geomType) {\n\n    // application des styles par defaut.\n    var style = null;\n\n    switch (geomType) {\n        case \"Point\":\n            style = new ol.style.Style({\n                image: new ol.style.Icon(this._getIconStyleOptions(this.options.markersList[0]))\n            });\n            break;\n        case \"LineString\":\n            style = new ol.style.Style({\n                stroke: new ol.style.Stroke({\n                    color: this.options.defaultStyles.strokeColor,\n                    width: this.options.defaultStyles.strokeWidth\n                })\n            });\n            break;\n        case \"Polygon\":\n            style = new ol.style.Style({\n                fill: new ol.style.Fill({\n                    color: this.hexToRgba(\n                        this.options.defaultStyles.polyFillColor,\n                        this.options.defaultStyles.polyFillOpacity\n                    )\n                }),\n                stroke: new ol.style.Stroke({\n                    color: this.options.defaultStyles.polyStrokeColor,\n                    width: this.options.defaultStyles.polyStrokeWidth\n                })\n            });\n            break;\n    }\n    feature.setStyle(style);\n\n    // gestion des mesures\n    this._updateMeasure(feature, geomType);\n\n    // creation overlay pour saisie du label\n    var popupOvl = null;\n    var context = this;\n\n    /**\n     * Enregistrement de la valeur saisie dans l'input.\n     *\n     * @param {String} value - valeur de l'attribut.\n     * @param {Boolean} save - true si on garde le label.\n     */\n    var setAttValue = function(value, save) {\n        context.getMap().removeOverlay(popupOvl);\n        if (save && value && value.trim().length > 0) {\n            var formated = value.replace(/\\n/g, \"<br>\");\n            feature.setProperties({\n                description: formated\n            });\n        }\n    };\n    var popup = this._createLabelDiv({\n        applyFunc: setAttValue,\n        inputId: this._addUID(\"att-input\"),\n        placeholder: \"Saisir une description...\",\n        measure: (this.options.tools.measure) ? feature.getProperties().measure : null,\n        geomType: geomType\n    });\n    popupOvl = new ol.Overlay({\n        element: popup,\n        // FIXME : autres valeurs.\n        positioning: \"top-center\"\n            // stopEvent : false\n    });\n    // context.getMap().addOverlay(popupOvl) ;\n    this.getMap().addOverlay(popupOvl);\n    var geomExtent = feature.getGeometry().getExtent();\n    popupOvl.setPosition([\n        (geomExtent[0] + geomExtent[2]) / 2, (geomExtent[1] + geomExtent[3]) / 2\n    ]);\n    document.getElementById(this._addUID(\"att-input\")).focus();\n};\n\n/**\n * Creates Interaction for features removal.\n *\n * @returns {ol.interaction.Select} created interaction.\n * @private\n */\nDrawing.prototype._createRemoveInteraction = function() {\n    var interaction = new ol.interaction.Select({\n        // features : this.layer.getSource().getFeaturesCollection(),\n        layers: [this.layer]\n    });\n    interaction.on(\"select\", function(seEv) {\n            if (!seEv || !seEv.selected || seEv.selected.length == 0) {\n                return;\n            }\n            this.layer.getSource().removeFeature(seEv.selected[0]);\n            // suppression puis rajout de l'interaction pour appliquer le changement tout de suite...\n            this.getMap().removeInteraction(this.interactionCurrent);\n            this.interactionCurrent = this._createRemoveInteraction();\n            this.getMap().addInteraction(this.interactionCurrent);\n\n        },\n        this);\n    return interaction;\n};\n\n/**\n * Creates Interaction for features style definition.\n *\n * @returns {ol.interaction.Select} created interaction.\n * @private\n */\nDrawing.prototype._createStylingInteraction = function() {\n    var interaction = new ol.interaction.Select({\n        layers: [this.layer]\n    });\n    interaction.on(\"select\", function(seEv) {\n            // suppression de toute popup existante\n            if (this.stylingOvl) {\n                this.getMap().removeOverlay(this.stylingOvl);\n            }\n            if (!seEv || !seEv.selected || seEv.selected.length == 0) {\n                return;\n            }\n\n            var valuesColor = null;\n            var hexColor = null;\n            var popupOvl = null;\n            var geomType = null;\n            var initValues = {};\n            if (seEv.selected[0].getGeometry() instanceof ol.geom.Point) {\n                // on determine si c'est un marker ou un label.\n                var _label = seEv.selected[0].getProperties().name;\n                if (seEv.selected[0].getStyle().getText() && _label) {\n                    geomType = \"Text\";\n                    if (seEv.selected[0].getStyle().getText().getStroke() &&\n                        seEv.selected[0].getStyle().getText().getStroke().getColor()) {\n                        valuesColor = seEv.selected[0].getStyle().getText().getStroke().getColor();\n                        if (Array.isArray(valuesColor)) {\n                            valuesColor = \"rgba(\" + valuesColor.join() + \")\";\n                            hexColor = this.rgbaToHex(valuesColor);\n                            initValues.strokeColor = hexColor.hex;\n                            initValues.strokeOpacity = hexColor.opacity;\n                        } else {\n                            initValues.strokeColor = valuesColor;\n                        }\n                    }\n                    if (seEv.selected[0].getStyle().getText().getFill() &&\n                        seEv.selected[0].getStyle().getText().getFill().getColor()) {\n                        valuesColor = seEv.selected[0].getStyle().getText().getFill().getColor();\n                        if (Array.isArray(valuesColor)) {\n                            valuesColor = \"rgba(\" + valuesColor.join() + \")\";\n                            hexColor = this.rgbaToHex(valuesColor);\n                            initValues.fillColor = hexColor.hex;\n                            initValues.fillOpacity = hexColor.opacity;\n                        } else {\n                            initValues.fillColor = valuesColor;\n                        }\n                    }\n                    initValues.strokeColor = initValues.hasOwnProperty(\"strokeColor\") ? initValues.strokeColor : this.options.defaultStyles.textStrokeColor;\n                    initValues.fillColor = initValues.hasOwnProperty(\"fillColor\") ? initValues.fillColor : this.options.defaultStyles.textFillColor;\n                } else if (seEv.selected[0].getStyle() &&\n                    seEv.selected[0].getStyle().getImage()) {\n                    geomType = \"Point\";\n                    if (seEv.selected[0].getStyle().getImage().getSrc()) {\n                        initValues.markerSrc = seEv.selected[0].getStyle().getImage().getSrc();\n                    } else {\n                        initValues.markerSrc = this.options.markersList[0].src;\n                    }\n                }\n\n            } else if (seEv.selected[0].getGeometry() instanceof ol.geom.LineString) {\n                geomType = \"Line\";\n                if (seEv.selected[0].getStyle() &&\n                    seEv.selected[0].getStyle().getStroke()) {\n                    if (seEv.selected[0].getStyle().getStroke().getWidth()) {\n                        initValues.strokeWidth = seEv.selected[0].getStyle().getStroke().getWidth();\n                    }\n                    if (seEv.selected[0].getStyle().getStroke().getColor()) {\n                        valuesColor = seEv.selected[0].getStyle().getStroke().getColor();\n                        if (Array.isArray(valuesColor)) {\n                            valuesColor = \"rgba(\" + valuesColor.join() + \")\";\n                            hexColor = this.rgbaToHex(valuesColor);\n                            initValues.strokeColor = hexColor.hex;\n                            initValues.fillOpacity = hexColor.opacity;\n                        } else {\n                            initValues.strokeColor = valuesColor;\n                        }\n                    }\n                }\n                initValues.strokeWidth = initValues.hasOwnProperty(\"strokeWidth\") ? initValues.strokeWidth : this.options.defaultStyles.strokeWidth;\n                initValues.strokeColor = initValues.hasOwnProperty(\"strokeColor\") ? initValues.strokeColor : this.options.defaultStyles.strokeColor;\n            } else if (seEv.selected[0].getGeometry() instanceof ol.geom.Polygon) {\n                geomType = \"Polygon\";\n                if (seEv.selected[0].getStyle() &&\n                    seEv.selected[0].getStyle().getStroke()) {\n                    if (seEv.selected[0].getStyle().getStroke().getWidth()) {\n                        initValues.strokeWidth = seEv.selected[0].getStyle().getStroke().getWidth();\n                    }\n                    if (seEv.selected[0].getStyle().getStroke().getColor()) {\n                        valuesColor = seEv.selected[0].getStyle().getStroke().getColor();\n                        if (Array.isArray(valuesColor)) {\n                            valuesColor = \"rgba(\" + valuesColor.join() + \")\";\n                            hexColor = this.rgbaToHex(valuesColor);\n                            initValues.strokeColor = hexColor.hex;\n                            initValues.strokeOpacity = hexColor.opacity;\n                        } else {\n                            initValues.strokeColor = valuesColor;\n                        }\n                    }\n                }\n                if (seEv.selected[0].getStyle() &&\n                    seEv.selected[0].getStyle().getFill()) {\n                    if (seEv.selected[0].getStyle().getFill().getColor()) {\n                        valuesColor = seEv.selected[0].getStyle().getFill().getColor();\n                        if (Array.isArray(valuesColor)) {\n                            valuesColor = \"rgba(\" + valuesColor.join() + \")\";\n                        }\n                        hexColor = this.rgbaToHex(valuesColor);\n                        initValues.fillColor = hexColor.hex;\n                        initValues.fillOpacity = hexColor.opacity;\n                    }\n                }\n                initValues.strokeWidth = initValues.hasOwnProperty(\"strokeWidth\") ? initValues.strokeWidth : this.options.defaultStyles.polyStrokeWidth;\n                initValues.strokeColor = initValues.hasOwnProperty(\"strokeColor\") ? initValues.strokeColor : this.options.defaultStyles.polyStrokeColor;\n                initValues.fillColor = initValues.hasOwnProperty(\"fillColor\") ? initValues.fillColor : this.options.defaultStyles.polyFillColor;\n                initValues.fillOpacity = initValues.hasOwnProperty(\"fillOpacity\") ? initValues.fillOpacity : this.options.defaultStyles.polyFillOpacity;\n            }\n            if (!geomType) {\n                console.log(\"Unhandled geometry type for styling.\");\n                return;\n            }\n            var dtObj = this;\n            /**\n             * function called when apply button is pressed.\n             *\n             * @param {String} action - \"apply\" (to selected object), \"default\" (set as default), \"cancel\" (do nothing).\n             */\n            var applyStyle = function(action) {\n                if (action == \"cancel\") {\n                    dtObj.getMap().removeOverlay(popupOvl);\n                    return;\n                }\n                var setDefault = (action == \"apply\") ? false : true;\n\n                var fillColorElem = document.getElementById(dtObj._addUID(\"fillColor\"));\n                var fillOpacityElem = document.getElementById(dtObj._addUID(\"fillOpacity\"));\n                var strokeColorElem = document.getElementById(dtObj._addUID(\"strokeColor\"));\n                var strokeWidthElem = document.getElementById(dtObj._addUID(\"strokeWidth\"));\n                switch (geomType.toLowerCase()) {\n                    case \"text\":\n                        if (setDefault) {\n                            dtObj.options.defaultStyles.textStrokeColor = strokeColorElem.value;\n                            dtObj.options.defaultStyles.textFillColor = fillColorElem.value;\n                        } else {\n                            seEv.selected[0].setStyle(new ol.style.Style({\n                                text: new ol.style.Text({\n                                    font: \"16px sans\",\n                                    textAlign: \"left\",\n                                    text: seEv.selected[0].getStyle().getText().getText(),\n                                    fill: new ol.style.Fill({\n                                        color: fillColorElem.value\n                                    }),\n                                    stroke: new ol.style.Stroke({\n                                        color: strokeColorElem.value,\n                                        width: 3\n                                    })\n                                })\n                            }));\n                        }\n                        break;\n                    case \"point\":\n                        var markerSelected = dtObj._getsMarkersOptionsFromSrc(document.querySelector(\"input[name='marker']:checked\").value);\n                        if (setDefault) {\n                            if (dtObj.options.markersList.length > 1) {\n                                // index du marker dans la liste des markers\n                                var idxMarker = dtObj.options.markersList.findIndex(function(mrk) {\n                                    if (mrk == markerSelected) {\n                                        return true;\n                                    }\n                                    return false;\n                                });\n                                if (idxMarker > 0) {\n                                    // on enleve le marker de son ancienne position\n                                    dtObj.options.markersList.splice(idxMarker, 1);\n                                    // on le place en tte de liste\n                                    dtObj.options.markersList.splice(0, 0, markerSelected);\n                                }\n                            }\n                        } else {\n                            seEv.selected[0].setStyle(new ol.style.Style({\n                                image: new ol.style.Icon(dtObj._getIconStyleOptions(markerSelected))\n                            }));\n                        }\n                        break;\n                    case \"line\":\n                        if (setDefault) {\n                            dtObj.options.defaultStyles.strokeColor = strokeColorElem.value;\n                            dtObj.options.defaultStyles.strokeWidth = parseInt(strokeWidthElem.value, 10);\n                        } else {\n                            seEv.selected[0].setStyle(new ol.style.Style({\n                                stroke: new ol.style.Stroke({\n                                    width: parseInt(strokeWidthElem.value, 10),\n                                    color: strokeColorElem.value\n                                })\n                            }));\n                        }\n                        break;\n                    case \"polygon\":\n                        var opacity = parseInt(fillOpacityElem.value, 10) / 10;\n                        if (setDefault) {\n                            dtObj.options.defaultStyles.polyStrokeColor = strokeColorElem.value;\n                            dtObj.options.defaultStyles.polyFillColor = fillColorElem.value;\n                            dtObj.options.defaultStyles.polyFillOpacity = opacity;\n                            dtObj.options.defaultStyles.polyStrokeWidth = parseInt(strokeWidthElem.value, 10);\n                        } else {\n                            seEv.selected[0].setStyle(new ol.style.Style({\n                                stroke: new ol.style.Stroke({\n                                    width: parseInt(strokeWidthElem.value, 10),\n                                    color: strokeColorElem.value\n                                }),\n                                fill: new ol.style.Fill({\n                                    // color : fillColorElem.value\n                                    color: dtObj.hexToRgba(fillColorElem.value, opacity)\n                                })\n                            }));\n                        }\n                        break;\n                }\n                if (!setDefault) {\n                    // application des styles par defaut\n                    // fermeture de la popup (si on applique le style  l'objet)\n                    dtObj.getMap().removeOverlay(popupOvl);\n                }\n            };\n\n            var popupDiv = this._createStylingDiv({\n                geomType: geomType,\n                initValues: initValues,\n                applyFunc: applyStyle\n            });\n            popupOvl = new ol.Overlay({\n                element: popupDiv,\n                // FIXME : autres valeurs.\n                positioning: \"top-center\"\n                    // stopEvent : false\n            });\n            this.getMap().addOverlay(popupOvl);\n            popupOvl.setPosition(seEv.mapBrowserEvent.coordinate);\n            this.stylingOvl = popupOvl;\n            // suppression puis rajout de l'interaction pour appliquer le changement tout de suite...\n            this.getMap().removeInteraction(this.interactionCurrent);\n            this.interactionCurrent = this._createStylingInteraction();\n            this.getMap().addInteraction(this.interactionCurrent);\n        },\n        this);\n    return interaction;\n};\n\n/**\n * Creates Interaction for text definition.\n *\n * @returns {ol.interaction.Select} created interaction.\n * @private\n */\nDrawing.prototype._createLabelInteraction = function() {\n    var interaction = new ol.interaction.Select({\n        layers: [this.layer]\n    });\n    interaction.on(\"select\", function(seEv) {\n            // suppression de toute popup existante\n            if (this.labelOvl) {\n                this.getMap().removeOverlay(this.labelOvl);\n            }\n            if (!seEv || !seEv.selected || seEv.selected.length == 0) {\n                return;\n            }\n            var popupOvl = null;\n            var geomType = null;\n            var _textValue = null;\n            var _measure = null;\n            if (seEv.selected[0].getGeometry() instanceof ol.geom.Point) {\n                // on determine si c'est un marker ou un label.\n                var _label = seEv.selected[0].getProperties().name;\n                if (seEv.selected[0].getStyle() &&\n                    seEv.selected[0].getStyle().getText() && _label) {\n                    geomType = \"Text\";\n                } else if (seEv.selected[0].getStyle() &&\n                    seEv.selected[0].getStyle().getImage()) {\n                    geomType = \"Point\";\n                }\n            } else if (seEv.selected[0].getGeometry() instanceof ol.geom.LineString) {\n                geomType = \"Line\";\n            } else if (seEv.selected[0].getGeometry() instanceof ol.geom.Polygon) {\n                geomType = \"Polygon\";\n            }\n            if (!geomType) {\n                console.log(\"Unhandled geometry type for styling.\");\n                return;\n            }\n            if (geomType == \"Text\") {\n                // pour les labels on rcupre la valeur dans le style\n                _textValue = seEv.selected[0].getStyle().getText().getText();\n            } else {\n                // pour les autres, c'est un attribut du feature\n                var featProps = seEv.selected[0].getProperties();\n                if (featProps && featProps.hasOwnProperty(\"description\")) {\n                    _textValue = featProps[\"description\"];\n                }\n                if (featProps && featProps.hasOwnProperty(\"measure\")) {\n                    _measure = featProps[\"measure\"];\n                }\n            }\n            var context = this;\n            /**\n             * Enregistrement de la valeur saisie dans l'input.\n             *\n             * @param {String} value - valeur de l'attribut.\n             * @param {Boolean} save - true si on garde le label.\n             */\n            var setTextValue = function(value, save) {\n                context.getMap().removeOverlay(popupOvl);\n                if (!save) {\n                    return;\n                }\n                var feature = seEv.selected[0];\n                if (geomType == \"Text\") {\n                    var style = feature.getStyle();\n                    style.getText().setText(value);\n                    feature.setProperties({\n                        name: value\n                    });\n                    feature.setStyle(style);\n                    return;\n                }\n                var _formated = value.replace(/\\n/g, \"<br>\");\n                feature.setProperties({\n                    description: _formated\n                });\n            };\n            var popupDiv = this._createLabelDiv({\n                applyFunc: setTextValue,\n                inputId: this._addUID(\"label-input\"),\n                placeholder: (geomType == \"Text\" ? \"Saisir un label...\" : \"Saisir une description...\"),\n                text: _textValue,\n                measure: (this.options.tools.measure) ? _measure : null,\n                geomType: geomType\n            });\n            popupOvl = new ol.Overlay({\n                element: popupDiv,\n                // FIXME : autres valeurs.\n                positioning: \"top-center\"\n                    // stopEvent : false\n            });\n            this.getMap().addOverlay(popupOvl);\n            popupOvl.setPosition(seEv.mapBrowserEvent.coordinate);\n            document.getElementById(this._addUID(\"label-input\")).focus();\n            this.labelOvl = popupOvl;\n            // suppression puis rajout de l'interaction pour appliquer le changement tout de suite...\n            this.getMap().removeInteraction(this.interactionCurrent);\n            this.interactionCurrent = this._createLabelInteraction();\n            this.getMap().addInteraction(this.interactionCurrent);\n        },\n        this);\n    return interaction;\n};\n\n/**\n * Callback de fin de modification du dessin afin de mettre  jour la mesure\n * TODO\n *\n * @private\n */\nDrawing.prototype._updateMeasure = function(feature, geomType) {\n\n    logger.log(feature);\n\n    var measure = null;\n\n    var wgs84Sphere = new ol.Sphere(6378137);\n    var projection = this.getMap().getView().getProjection();\n\n    /** arrondi */\n    function __roundDecimal(nombre, precision) {\n        precision = precision || 2;\n        var factor = Math.pow(10, precision);\n        return Math.round(nombre * factor) / factor;\n    }\n\n    var type = (geomType) ? geomType : feature.getProperties().type;\n    switch (type) {\n        case \"Point\":\n            var coordinatesPoint = (feature.getGeometry()).getCoordinates();\n            var c = ol.proj.transform(coordinatesPoint, projection, \"EPSG:4326\");\n            measure = \"lon : \";\n            measure += __roundDecimal(c[0], 4) + \"\";\n            measure += \" / \";\n            measure += \"lat : \";\n            measure += __roundDecimal(c[1], 4) + \"\";\n\n            break;\n        case \"LineString\":\n            var measureLength = 0;\n            var coordinatesLine = (feature.getGeometry()).getCoordinates();\n            for (var i = 0, ii = coordinatesLine.length - 1; i < ii; ++i) {\n                var c1 = ol.proj.transform(coordinatesLine[i], projection, \"EPSG:4326\");\n                var c2 = ol.proj.transform(coordinatesLine[i + 1], projection, \"EPSG:4326\");\n                measureLength += wgs84Sphere.haversineDistance(c1, c2);\n            }\n            measure = (measureLength > 1000) ?\n                __roundDecimal(measureLength / 1000, 3) + \" km\" :\n                __roundDecimal(measureLength, 3) + \" m\";\n\n            break;\n        case \"Polygon\":\n            var measureArea = 0;\n            var coordinatesAera = ((feature.getGeometry()).clone().transform(projection, \"EPSG:4326\")).getLinearRing(0).getCoordinates();\n            measureArea = Math.abs(wgs84Sphere.geodesicArea(coordinatesAera));\n\n            measure = (measureArea > 1000000) ?\n                __roundDecimal(measureArea / 1000000, 3) + \" km^2\" :\n                __roundDecimal(measureArea, 2) + \" m^2\";\n\n            break;\n    }\n\n    // enregistrement de la mesure dans la feature\n    feature.setProperties({\n        measure: measure,\n        type: type\n    });\n};\n\n/**\n * Handles click on drawing tools icons\n *\n * @param {Event} clickEvent - click event\n * @param {String} toolId - selected tool Id\n * @param {Drawing} context - Drawing control.\n * @private\n */\nDrawing.prototype._handleToolClick = function(clickEvent, toolId, context) {\n    var map = context.getMap();\n    if (!map) {\n        logger.trace(\"Drawing control not attached to any map.\");\n        return;\n    }\n    // on supprime  les interactions des autres extensions\n    Interactions.unset(map, {\n        current: \"Drawing\"\n    });\n\n    // on supprime l'interaction courante s'il y en a une.\n    if (context.interactionCurrent) {\n        map.removeInteraction(context.interactionCurrent);\n        context.interactionCurrent = null;\n    }\n\n    // on supprime l'interaction de selection courante s'il y en a une.\n    if (context.interactionSelectEdit) {\n        map.removeInteraction(context.interactionSelectEdit);\n        context.interactionSelectEdit = null;\n    }\n\n    // si aucune couche de dessin, on en cre une vide.\n    if (!this.layer) {\n        this._createEmptyLayer();\n    }\n    switch (toolId) {\n        case this._addUID(\"drawing-tool-point\"):\n            if (context.dtOptions[\"points\"].active) {\n                context.interactionCurrent = new ol.interaction.Draw({\n                    features: context.layer.getSource().getFeaturesCollection(),\n                    style: new ol.style.Style({\n                        image: new ol.style.Icon(this._getIconStyleOptions(this.options.markersList[0]))\n                    }),\n                    type: (\"Point\")\n                });\n                context.interactionCurrent.on(\"drawend\", function(deEv) {\n                        // ajout eventuel d'un attribut description sur le feature\n                        context._drawEndFeature(deEv.feature, \"Point\");\n                    },\n                    context);\n            }\n            break;\n        case this._addUID(\"drawing-tool-line\"):\n            if (context.dtOptions[\"lines\"].active) {\n                context.interactionCurrent = new ol.interaction.Draw({\n                    features: context.layer.getSource().getFeaturesCollection(),\n                    style: new ol.style.Style({\n                        image: new ol.style.Circle({\n                            radius: this.options.cursorStyle.radius,\n                            stroke: new ol.style.Stroke({\n                                color: this.options.cursorStyle.strokeColor,\n                                width: this.options.cursorStyle.strokeWidth\n                            }),\n                            fill: new ol.style.Fill({\n                                color: this.options.cursorStyle.fillColor\n                            })\n                        }),\n                        stroke: new ol.style.Stroke({\n                            color: this.options.defaultStyles.strokeColor,\n                            width: this.options.defaultStyles.strokeWidth\n                        })\n                    }),\n                    type: (\"LineString\")\n                });\n                context.interactionCurrent.on(\"drawend\", function(deEv) {\n                        // ajout eventuel d'un attribut description sur le feature\n                        context._drawEndFeature(deEv.feature, \"LineString\");\n                    },\n                    context);\n            }\n            break;\n        case this._addUID(\"drawing-tool-polygon\"):\n            if (context.dtOptions[\"polygons\"].active) {\n                context.interactionCurrent = new ol.interaction.Draw({\n                    features: context.layer.getSource().getFeaturesCollection(),\n                    style: new ol.style.Style({\n                        image: new ol.style.Circle({\n                            radius: this.options.cursorStyle.radius,\n                            stroke: new ol.style.Stroke({\n                                color: this.options.cursorStyle.strokeColor,\n                                width: this.options.cursorStyle.strokeWidth\n                            }),\n                            fill: new ol.style.Fill({\n                                color: this.options.cursorStyle.fillColor\n                            })\n                        }),\n                        stroke: new ol.style.Stroke({\n                            color: this.options.defaultStyles.polyStrokeColor,\n                            width: this.options.defaultStyles.polyStrokeWidth\n                        }),\n                        fill: new ol.style.Fill({\n                            color: this.hexToRgba(\n                                this.options.defaultStyles.polyFillColor,\n                                this.options.defaultStyles.polyFillOpacity\n                            )\n                        })\n                    }),\n                    type: (\"Polygon\")\n                });\n                context.interactionCurrent.on(\"drawend\", function(deEv) {\n                        // ajout eventuel d'un attribut description sur le feature\n                        context._drawEndFeature(deEv.feature, \"Polygon\");\n                    },\n                    context);\n            }\n            break;\n        case this._addUID(\"drawing-tool-text\"):\n            // text : creation de points invisibles avec un label.\n            if (context.dtOptions[\"text\"].active) {\n                context.interactionCurrent = new ol.interaction.Draw({\n                    features: context.layer.getSource().getFeaturesCollection(),\n                    style: new ol.style.Style({\n                        image: new ol.style.Circle({\n                            radius: this.options.cursorStyle.radius,\n                            stroke: new ol.style.Stroke({\n                                color: this.options.cursorStyle.strokeColor,\n                                width: this.options.cursorStyle.strokeWidth\n                            }),\n                            fill: new ol.style.Fill({\n                                color: this.options.cursorStyle.fillColor\n                            })\n                        })\n                    }),\n                    type: (\"Point\")\n                });\n                context.interactionCurrent.on(\"drawend\", function(deEv) {\n                        // creation overlay pour saisie du label\n                        var popupOvl = null;\n                        /**\n                         * Enregistrement de la valeur saisie dans l'input.\n                         *\n                         * @param {String} value - valeur du label\n                         * @param {Boolean} save - true si on garde le label.\n                         */\n                        var setTextValue = function( /*context,feature,*/ value, save) {\n                            context.getMap().removeOverlay(popupOvl);\n                            if (!save) {\n                                // removes feature from overlay.\n                                context.layer.getSource().removeFeature(deEv.feature);\n                                return;\n                            }\n\n                            deEv.feature.setProperties({\n                                name: value\n                            });\n\n                            deEv.feature.setStyle(new ol.style.Style({\n                                image: new ol.style.Icon(context._getIconStyleOptions(context.options.defaultStyles.textIcon1x1)),\n                                text: new ol.style.Text({\n                                    textAlign: \"left\",\n                                    font: \"16px sans\",\n                                    text: value,\n                                    fill: new ol.style.Fill({\n                                        color: context.options.defaultStyles.textFillColor\n                                    }),\n                                    stroke: new ol.style.Stroke({\n                                        color: context.options.defaultStyles.textStrokeColor,\n                                        width: 3\n                                    })\n                                })\n                            }));\n                        };\n                        var popup = this._createLabelDiv({\n                            applyFunc: setTextValue,\n                            inputId: context._addUID(\"label-input\"),\n                            geomType: \"Text\",\n                            placeholder: \"Saisir un label...\"\n                        });\n                        popupOvl = new ol.Overlay({\n                            element: popup,\n                            // FIXME : autres valeurs.\n                            positioning: \"top-center\" // par defaut, top-left...\n                                // stopEvent : false\n                        });\n                        context.getMap().addOverlay(popupOvl);\n                        popupOvl.setPosition(deEv.feature.getGeometry().getCoordinates());\n                        document.getElementById(this._addUID(\"label-input\")).focus();\n                    },\n                    context);\n            }\n            break;\n        case this._addUID(\"drawing-tool-edit\"):\n            if (context.dtOptions[\"edit\"].active) {\n                context.interactionSelectEdit = new ol.interaction.Select({\n                    condition: ol.events.condition.singleClick,\n                    layers: [this.layer]\n                });\n\n                context.interactionSelectEdit.setProperties({\n                    name: \"Drawing\",\n                    source: context\n                });\n                map.addInteraction(context.interactionSelectEdit);\n\n                context.interactionCurrent = new ol.interaction.Modify({\n                    // features : context.layer.getSource().getFeaturesCollection(),\n                    features: this.interactionSelectEdit.getFeatures(),\n                    style: new ol.style.Style({\n                        image: new ol.style.Circle({\n                            radius: this.options.cursorStyle.radius,\n                            stroke: new ol.style.Stroke({\n                                color: this.options.cursorStyle.strokeColor,\n                                width: this.options.cursorStyle.strokeWidth\n                            }),\n                            fill: new ol.style.Fill({\n                                color: this.options.cursorStyle.fillColor\n                            })\n                        })\n                    }),\n                    /** deleteCondition : aucune en mode \"edition\" */\n                    deleteCondition: function( /*event*/ ) {\n                        return false;\n                    }\n                });\n                context.interactionCurrent.on(\"modifyend\", function(deEv) {\n                    var feature = deEv.features.item(0);\n                    context._updateMeasure(feature);\n                }, context);\n            }\n            break;\n        case this._addUID(\"drawing-tool-display\"):\n            if (context.dtOptions[\"display\"].active) {\n                context.interactionCurrent = this._createStylingInteraction();\n            }\n            break;\n        case this._addUID(\"drawing-tool-tooltip\"):\n\n            if (context.dtOptions[\"tooltip\"].active) {\n                context.interactionCurrent = this._createLabelInteraction();\n            }\n            break;\n        case this._addUID(\"drawing-tool-remove\"):\n            if (context.dtOptions[\"remove\"].active) {\n                context.interactionCurrent = context._createRemoveInteraction();\n            }\n            break;\n        default:\n            logger.trace(\"unhandled tool type\");\n    }\n    if (context.interactionCurrent) {\n        context.interactionCurrent.setProperties({\n            name: \"Drawing\",\n            source: this\n        });\n        map.addInteraction(context.interactionCurrent);\n    }\n    logger.log(\"interactions\", map.getInteractions());\n};\n\n// ################################################################### //\n// ####################### handlers events to dom #################### //\n// ################################################################### //\n\n/**\n * this method is called by event 'click' on 'GPshowDrawingPicto' tag label\n * (cf. this._createShowDrawingPictoElement),\n * and toggles event 'mousemove' on map.\n *\n * @method onShowDrawingClick\n * @private\n */\nDrawing.prototype.onShowDrawingClick = function() {\n\n    var map = this.getMap();\n    // on supprime toutes les interactions\n    Interactions.unset(map);\n\n    // checked : true - panel close\n    // checked : false - panel open\n    this.collapsed = this._showDrawingContainer.checked;\n    // on gnre nous mme l'evenement OpenLayers de changement de proprit\n    // (utiliser mousePosition.on(\"change:collapsed\", function(e) ) pour s'abonner  cet vnement)\n    this.dispatchEvent(\"change:collapsed\");\n\n    // on deselectionne les Tools\n    for (var toolsType in this.dtOptions) {\n        if (this.dtOptions.hasOwnProperty(toolsType)) {\n            if (this.dtOptions[toolsType].active) {\n                var toolsId = this._addUID(\"drawing-tool-\" + this.dtOptions[toolsType].id);\n                document.getElementById(toolsId).className = \"drawing-tool\";\n                this.dtOptions[toolsType].active = false;\n            }\n        }\n    }\n};\n\n/**\n * this method is called by event 'click' on 'drawing-export' tag button.\n *\n * @method onExportFeatureClick\n * @private\n */\nDrawing.prototype.onExportFeatureClick = function() {\n\n    // TODO\n    var content = this.exportFeatures();\n    if (!content) {\n        return;\n    }\n    var link = document.createElement(\"a\");\n    // FIXME : determiner le bon charset !\n    var charset = \"utf-8\";\n    link.setAttribute(\"href\", \"data:application/vnd.google-earth.kml+xml;charset=\" + charset + \",\" + encodeURIComponent(content));\n    link.setAttribute(\"download\", this.getExportName() + \".kml\");\n    if (document.createEvent) {\n        var event = document.createEvent(\"MouseEvents\");\n        event.initEvent(\"click\", true, true);\n        link.dispatchEvent(event);\n    } else {\n        link.click();\n    }\n};\n\nexport default Drawing;\n\n\n\n// WEBPACK FOOTER //\n// ./src/OpenLayers/Controls/Drawing.js","var DrawingDOM = {\n\n    /** Add uuid to the tag ID */\n    _addUID: function(id) {\n        var uid = (this._uid) ? id + \"-\" + this._uid : id;\n        return uid;\n    },\n\n    /**\n     * Main container (DOM)\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createMainContainerElement: function() {\n\n        var container = document.createElement(\"div\");\n        container.id = this._addUID(\"GPdrawing\");\n        container.className = \"GPwidget\";\n        return container;\n    },\n\n    // ################################################################### //\n    // ################### Methods of main container ##################### //\n    // ################################################################### //\n\n    /**\n     * Hidden checkbox for minimizing/maximizing\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createShowDrawingElement: function() {\n\n        var input = document.createElement(\"input\");\n        input.id = this._addUID(\"GPshowDrawing\");\n        input.className = \"GPshowDrawing\";\n        input.type = \"checkbox\";\n        return input;\n    },\n\n    /**\n     * Show mouse position control\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createShowDrawingPictoElement: function() {\n\n        var self = this;\n\n        var label = document.createElement(\"label\");\n        label.id = this._addUID(\"GPshowDrawingPicto\");\n        label.className = \"GPshowAdvancedToolPicto\";\n        label.htmlFor = this._addUID(\"GPshowDrawing\");\n        label.title = this.options.labels.control;\n\n        // gestionnaire d'evenement :\n        // on ouvre le menu de saisie de saisie\n        // L'ouverture/Fermeture permet de faire le menage\n        // (reinitialisation)\n        if (label.addEventListener) {\n            label.addEventListener(\"click\", function(e) {\n                self.onShowDrawingClick(e);\n            });\n        } else if (label.attachEvent) {\n            label.attachEvent(\"onclick\", function(e) {\n                self.onShowDrawingClick(e);\n            });\n        }\n\n        var spanOpen = document.createElement(\"span\");\n        spanOpen.id = this._addUID(\"GPshowDrawingOpen\");\n        spanOpen.className = \"GPshowAdvancedToolOpen\";\n        label.appendChild(spanOpen);\n\n        return label;\n    },\n\n    /**\n     * Drawing panel\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createDrawingPanelElement: function() {\n\n        var div = document.createElement(\"div\");\n        div.id = this._addUID(\"GPdrawingPanel\");\n        div.className = \"GPpanel\";\n\n        div.appendChild(this._createDrawingPanelHeaderElement());\n\n        this.dtOptions = {};\n        if (this.options.tools.points) {\n            this.dtOptions.points = {\n                label: this.options.labels.points,\n                active: false,\n                panel: \"draw\",\n                id: \"point\"\n            };\n        }\n        if (this.options.tools.lines) {\n            this.dtOptions.lines = {\n                label: this.options.labels.lines,\n                active: false,\n                panel: \"draw\",\n                id: \"line\"\n            };\n        }\n        if (this.options.tools.polygons) {\n            this.dtOptions.polygons = {\n                label: this.options.labels.polygons,\n                active: false,\n                panel: \"draw\",\n                id: \"polygon\"\n            };\n        }\n        if (this.options.tools.text) {\n            this.dtOptions.text = {\n                label: this.options.labels.text,\n                active: false,\n                panel: \"draw\",\n                id: \"text\"\n            };\n        }\n        if (this.options.tools.edit) {\n            this.dtOptions.edit = {\n                label: this.options.labels.edit,\n                active: false,\n                panel: \"edit\",\n                id: \"edit\"\n            };\n        }\n        if (this.options.tools.display) {\n            this.dtOptions.display = {\n                label: this.options.labels.display,\n                active: false,\n                panel: \"edit\",\n                id: \"display\"\n            };\n        }\n        if (this.options.tools.tooltip) {\n            this.dtOptions.tooltip = {\n                label: this.options.labels.tooltip,\n                active: false,\n                panel: \"edit\",\n                id: \"tooltip\"\n            };\n        }\n        if (this.options.tools.remove) {\n            this.dtOptions.remove = {\n                label: this.options.labels.remove,\n                active: false,\n                panel: \"edit\",\n                id: \"remove\"\n            };\n        }\n        // ajout drawing tools\n        if (this.dtOptions.points ||\n            this.dtOptions.lines ||\n            this.dtOptions.polygons ||\n            this.dtOptions.text) {\n            div.appendChild(this._createDrawingToolSection(this.options.labels.creatingTools, \"draw\"));\n        }\n        // ajout editing tools\n        if (this.dtOptions.edit ||\n            this.dtOptions.display ||\n            this.dtOptions.tooltip ||\n            this.dtOptions.remove) {\n            div.appendChild(this._createDrawingToolSection(this.options.labels.editingTools, \"edit\"));\n        }\n        // ajout export tools\n        if (this.options.tools.export) {\n            div.appendChild(this._createSavingSection(\n                this.options.labels.export,\n                this.options.labels.exportTitle\n            ));\n        }\n\n        return div;\n\n    },\n\n    // ################################################################### //\n    // ####################### Panel container ########################### //\n    // ################################################################### //\n\n    /** ... */\n    _createDrawingPanelHeaderElement: function() {\n        /*\n         * <div class=\"GPpanelHeader\">\n         *     <div class=\"GPpanelTitle\">Annoter la carte</div>\n         *     <div id=\"GPdrawingPanelClose\" class=\"GPpanelClose\" title=\"Fermer le panneau\"></div>\n         * </div>\n         */\n\n        var container = document.createElement(\"div\");\n        container.className = \"GPpanelHeader\";\n\n        var divTitle = document.createElement(\"div\");\n        divTitle.className = \"GPpanelTitle\";\n        divTitle.innerHTML = this.options.controlLabel || \"Annoter la carte\";\n        container.appendChild(divTitle);\n\n        var divClose = document.createElement(\"div\");\n        divClose.id = this._addUID(\"GPdrawingPanelClose\");\n        divClose.className = \"GPpanelClose\";\n        divClose.title = \"Fermer le panneau\";\n\n        // Link panel close / visibility checkbox\n        var dtObj = this;\n        if (divClose.addEventListener) {\n            divClose.addEventListener(\"click\", function() {\n                document.getElementById(dtObj._addUID(\"GPshowDrawingPicto\")).click();\n            }, false);\n        } else if (divClose.attachEvent) {\n            divClose.attachEvent(\"onclick\", function() {\n                document.getElementById(dtObj._addUID(\"GPshowDrawingPicto\")).click();\n            });\n        }\n\n        container.appendChild(divClose);\n\n        return container;\n    },\n\n    /**\n     * Creates drawing tool section DOM structure.\n     *\n     * @param {String} sectionLabel - section title\n     * @param {String} panelType - Drawing (\"draw\") or editing (\"edit\") tools panel\n     * @returns {DOMElement} DOM element\n     */\n    _createDrawingToolSection: function(sectionLabel, panelType) {\n        /*\n         * Exemple panelType == \"draw\"\n         *\n         * <div class=\"drawing-tool-section\">\n         *     <p class=\"drawing-tool-section-title\">Outils de cration</p>\n         *     <ul class=\"drawing-tools-flex-display\">\n         *         <li id=\"drawing-tool-point\" class=\"drawing-tool\" title=\"Placer des points\"></li>\n         *         <li id=\"drawing-tool-line\" class=\"drawing-tool\" title=\"Dessiner des lignes\"></li>\n         *         <li id=\"drawing-tool-polygon\" class=\"drawing-tool\" title=\"Dessiner des polygones\"></li>\n         *         <li id=\"drawing-tool-text\" class=\"drawing-tool\" title=\"Ecrire sur la carte\"></li>\n         *     </ul>\n         * </div>\n         */\n        var container = document.createElement(\"div\");\n        container.className = \"drawing-tool-section\";\n\n        var p = document.createElement(\"p\");\n        p.className = \"drawing-tool-section-title\";\n        p.innerHTML = sectionLabel;\n        container.appendChild(p);\n\n        var ul = document.createElement(\"ul\");\n        ul.className = \"drawing-tools-flex-display\";\n        var context = this;\n        /** li click handler function */\n        function liClickHandler(e) {\n            /*jshint validthis: true */\n            // this == elem clicked\n            context._handleDOMToolClick(e, this.id, context);\n            context._handleToolClick(e, this.id, context);\n        }\n        for (var type in this.dtOptions) {\n            if (this.dtOptions[type].panel != panelType) {\n                continue;\n            }\n            var li = document.createElement(\"li\");\n            li.className = \"drawing-tool\";\n            li.id = this._addUID(\"drawing-tool-\" + this.dtOptions[type].id);\n            li.title = this.dtOptions[type].label;\n            li.addEventListener(\"click\", liClickHandler);\n            ul.appendChild(li);\n        }\n        container.appendChild(ul);\n\n        return container;\n    },\n\n    /**\n     * Creates drawing tool section DOM structure.\n     *\n     * @param {String} buttonLabel - Button label\n     * @param {String} buttonTitle - Button title\n     * @returns {DOMElement} DOM element\n     */\n    _createSavingSection: function(buttonLabel, buttonTitle) {\n        /*\n         * <div class=\"drawing-tool-section drawing-tools-flex-display\">\n         *     <button title=\"Exporter en KML\" class=\"tool-form-submit drawing-button\" id=\"drawing-export\" type=\"button\">Exporter</button>\n         * </div>\n         */\n        var container = document.createElement(\"div\");\n        container.className = \"drawing-tool-section drawing-tools-flex-display\";\n\n        var button = document.createElement(\"button\");\n        button.title = buttonTitle;\n        button.className = \"tool-form-submit drawing-button\";\n        button.id = this._addUID(\"drawing-export\");\n        button.type = \"button\";\n        button.textContent = buttonLabel;\n        var context = this;\n        /** export function */\n        button.onclick = function() {\n            context.onExportFeatureClick();\n        };\n        container.appendChild(button);\n\n        return container;\n    },\n\n    /**\n     * Converts rgba String to #RRGGBBAA\n     * (Code adapted from : https://gist.github.com/mstssk/afda4ce9e5c335fd79cd)\n     *\n     * @param {String} rgba - A color of RGB or RGBA format.\n     * returns {Object} hex and opacity formated values\n     */\n    rgbaToHex: function(rgba) {\n        /** number to hex conversion */\n        function hex(number) {\n            if (number > 255) {\n                throw \"'\" + number + \"'' is greater than 255(0xff);\";\n            }\n            var str = Number(number).toString(16);\n            return (\"0\" + str).slice(-2);\n        }\n        var regex = /rgba?\\(\\s*(\\d+)\\s*,\\s*(\\d+)\\s*,\\s*(\\d+)\\s*(?:,\\s*(0?.?\\d+)\\s*)?\\)/;\n        var parsed = regex.exec(rgba);\n        if (!parsed) {\n            throw \"Invalid format: \" + rgba;\n        }\n        var red = parsed[1];\n        var green = parsed[2];\n        var blue = parsed[3];\n        var alpha = parsed[4];\n        var elems = [hex(red), hex(green), hex(blue)];\n        var result = {};\n        result.hex = \"#\" + elems.join(\"\");\n        if (alpha) {\n            // elems.push(hex(alpha));\n            result.opacity = parseFloat(alpha);\n        }\n        return result;\n    },\n\n    /**\n     * Converts hex color and opacity value to rgba String.\n     * (Code adapted from : http://stackoverflow.com/a/5624139)\n     */\n    hexToRgba: function(hex, opacity) {\n        // Expand shorthand form (e.g. \"03F\") to full form (e.g. \"0033FF\")\n        var shorthandRegex = /^#?([a-f\\d])([a-f\\d])([a-f\\d])$/i;\n        hex = hex.replace(shorthandRegex, function(m, r, g, b) {\n            return r + r + g + g + b + b;\n        });\n\n        var rgb = /^#?([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})$/i.exec(hex);\n        rgb = rgb ? {\n            r: parseInt(rgb[1], 16),\n            g: parseInt(rgb[2], 16),\n            b: parseInt(rgb[3], 16)\n        } : null;\n        var result = rgb ? \"rgba(\" + rgb.r + \", \" + rgb.g + \", \" + rgb.b + \", \" + opacity + \")\" : null;\n        return result;\n    },\n\n    /**\n     * Creates input for color choosing\n     *\n     * @param {Object} options - options\n     * @param {String} options.defaultValue - defaultValue\n     * @param {String} options.className - input className\n     * @returns {DOMElement} - created li element\n     */\n    _createMarkersChooser: function(options) {\n        var li = document.createElement(\"li\");\n        li.className = options.className;\n        for (var i = 0; i < this.options.markersList.length; i++) {\n            // radio bouton pour la selection\n            var inputElem = document.createElement(\"input\");\n            inputElem.type = \"radio\";\n            inputElem.name = \"marker\";\n            inputElem.id = this._addUID(\"marker-\" + i);\n            inputElem.value = this.options.markersList[i].src;\n            inputElem.className = \"marker-input-radio\";\n            if (options.defaultValue == inputElem.value) {\n                inputElem.checked = true;\n            }\n            li.appendChild(inputElem);\n            // label pour l'affichage du marker\n            var labelElem = document.createElement(\"label\");\n            labelElem.className = \"marker-label\"; // utile ?\n            labelElem.setAttribute(\"for\", inputElem.id);\n            var imgElem = document.createElement(\"img\");\n            imgElem.src = inputElem.value;\n            labelElem.appendChild(imgElem);\n            li.appendChild(labelElem);\n        }\n        return li;\n    },\n\n    /**\n     * Creates input for color choosing\n     *\n     * @param {Object} options - options\n     * @param {String} options.label - label\n     * @param {String} options.type - input type for element (\"color\")\n     * @param {String} options.defaultValue - defaultValue\n     * @param {String} options.id - input id\n     * @param {String} options.title - input title\n     * @param {String} options.className - input className\n     * @returns {DOMElement} - created li element\n     */\n    _createStylingElement: function(options) {\n        var li = document.createElement(\"li\");\n        li.className = options.className;\n        var textNode = document.createTextNode(options.label);\n        li.appendChild(textNode);\n        var inputElem = document.createElement(\"input\");\n        try {\n            inputElem.type = options.type;\n        } catch (e) {\n            // ie 11 input type== color ne marche pas...\n            inputElem.type = \"text\";\n        }\n        inputElem.id = options.id;\n        inputElem.value = options.defaultValue;\n        if (options.title) {\n            inputElem.title = options.title;\n        }\n        // si options.type == \"range\"\n        if (options.min !== undefined) {\n            inputElem.min = options.min;\n        }\n        if (options.max !== undefined) {\n            inputElem.max = options.max;\n        }\n        if (options.step !== undefined) {\n            inputElem.step = options.step;\n        }\n        li.appendChild(inputElem);\n        return li;\n    },\n\n    /**\n     * Creates Styling div to include in popup.\n     *\n     * @param {Object} options - toolId selected\n     * @param {String} options.geomType - gemeotryType selected (\"Point\", \"Line\" or \"Polygon\")\n     * @param {Object} options.initValues - values to init fields\n     * @param {String} options.initValues.markerSrc - marker URL for Points\n     * @param {Function} options.applyFunc - function called when apply is selected\n     * @returns {DOMElement} DOM element created\n     */\n    _createStylingDiv: function(options) {\n        var div = document.createElement(\"div\");\n        div.className = \"gp-styling-div\";\n        var ul = document.createElement(\"ul\");\n        var li = null;\n        /*\n         * TODO : finir de remplir la div pour tous les styles ditables.\n         */\n        switch (options.geomType.toLowerCase()) {\n            case \"point\":\n                li = this._createMarkersChooser({\n                    className: \"gp-styling-option\",\n                    // defaultValue : this.options.markersList[0].src\n                    defaultValue: options.initValues.markerSrc\n                });\n                ul.appendChild(li);\n                break;\n            case \"text\":\n                li = this._createStylingElement({\n                    type: \"color\",\n                    className: \"gp-styling-option\",\n                    label: this.options.labels.fillColor,\n                    id: this._addUID(\"fillColor\"),\n                    defaultValue: options.initValues.fillColor\n                });\n                ul.appendChild(li);\n                li = this._createStylingElement({\n                    type: \"color\",\n                    className: \"gp-styling-option\",\n                    label: this.options.labels.strokeColor,\n                    id: this._addUID(\"strokeColor\"),\n                    defaultValue: options.initValues.strokeColor\n                });\n                ul.appendChild(li);\n                break;\n            case \"line\":\n                li = this._createStylingElement({\n                    type: \"color\",\n                    className: \"gp-styling-option\",\n                    label: this.options.labels.strokeColor,\n                    id: this._addUID(\"strokeColor\"),\n                    defaultValue: options.initValues.strokeColor\n                });\n                ul.appendChild(li);\n                li = this._createStylingElement({\n                    type: \"range\",\n                    className: \"gp-styling-option\",\n                    label: this.options.labels.strokeWidth,\n                    title: \"1  10 pixels\",\n                    id: this._addUID(\"strokeWidth\"),\n                    min: 1,\n                    max: 10,\n                    step: 1,\n                    defaultValue: options.initValues.strokeWidth\n                });\n                ul.appendChild(li);\n                break;\n            case \"polygon\":\n                li = this._createStylingElement({\n                    type: \"color\",\n                    className: \"gp-styling-option\",\n                    label: this.options.labels.strokeColor,\n                    id: this._addUID(\"strokeColor\"),\n                    defaultValue: options.initValues.strokeColor\n                });\n                ul.appendChild(li);\n                li = this._createStylingElement({\n                    type: \"range\",\n                    className: \"gp-styling-option\",\n                    label: this.options.labels.strokeWidth,\n                    title: \"1  10 pixels\",\n                    id: this._addUID(\"strokeWidth\"),\n                    min: 1,\n                    max: 10,\n                    step: 1,\n                    defaultValue: options.initValues.strokeWidth\n                });\n                ul.appendChild(li);\n                li = this._createStylingElement({\n                    type: \"color\",\n                    className: \"gp-styling-option\",\n                    label: this.options.labels.fillColor,\n                    id: this._addUID(\"fillColor\"),\n                    defaultValue: options.initValues.fillColor\n                });\n                ul.appendChild(li);\n                li = this._createStylingElement({\n                    type: \"range\",\n                    className: \"gp-styling-option\",\n                    label: this.options.labels.fillOpacity,\n                    title: \"0 (transparent)  100% (opaque)\",\n                    id: this._addUID(\"fillOpacity\"),\n                    min: 0,\n                    max: 10,\n                    step: 1,\n                    defaultValue: options.initValues.fillOpacity * 10\n                });\n                ul.appendChild(li);\n                break;\n            default:\n                console.log(\"Unhandled geometry type for styling.\");\n        }\n        div.appendChild(ul);\n        // apply button\n        var applyButton = document.createElement(\"input\");\n        applyButton.type = \"button\";\n        applyButton.className = \"gp-styling-button\";\n        applyButton.value = this.options.labels.applyToObject;\n        /** click sur applyButton */\n        applyButton.onclick = function() {\n            options.applyFunc.call(this, \"apply\");\n        };\n        div.appendChild(applyButton);\n        // set default button\n        var setDefaultButton = document.createElement(\"input\");\n        setDefaultButton.type = \"button\";\n        setDefaultButton.value = this.options.labels.setAsDefault;\n        setDefaultButton.className = \"gp-styling-button\";\n        /** click sur set Default Button */\n        setDefaultButton.onclick = function() {\n            options.applyFunc.call(this, \"default\");\n        };\n        div.appendChild(setDefaultButton);\n        // cancel Button\n        var cancelButton = document.createElement(\"input\");\n        cancelButton.type = \"button\";\n        // cancelButton.value = \"X\" ;\n        cancelButton.className = \"gp-styling-button closer\";\n        /** click sur cancel Button */\n        cancelButton.onclick = function() {\n            options.applyFunc.call(this, \"cancel\");\n        };\n        div.appendChild(cancelButton);\n        return div;\n    },\n\n    /**\n     * Creates Text editing div to include in popup.\n     *\n     * @param {Object} options - options for popup\n     * @param {String} options.geomType - gemeotryType selected (\"Point\", \"Line\" or \"Polygon\")\n     * @param {String} options.text - text to fill input.\n     * @param {String} options.measure - measure to fill input.\n     * @param {String} options.placeholder - placeholder for text input.\n     * @param {String} options.inputId - text input id.\n     * @param {Function} options.applyFunc - function called when text is to be saved.\n     * @returns {DOMElement} DOM element created\n     * @private\n     */\n    _createLabelDiv: function(options) {\n        var popup = document.createElement(\"div\");\n        popup.className = \"gp-label-div\";\n        var inputLabel = null;\n        if (options.geomType == \"Text\") {\n            inputLabel = document.createElement(\"input\");\n            inputLabel.type = \"text\";\n            inputLabel.className = \"gp-input-label-style\";\n        } else {\n            inputLabel = document.createElement(\"textArea\");\n            inputLabel.rows = 2;\n            inputLabel.cols = 40;\n            inputLabel.className = \"gp-textarea-att-label-style\";\n        }\n\n        if (options.text) {\n            inputLabel.value = options.text;\n        }\n\n        inputLabel.autocomplete = \"off\";\n        inputLabel.placeholder = options.placeholder;\n        inputLabel.id = options.inputId;\n        popup.appendChild(inputLabel);\n        /** blur */\n        inputLabel.onblur = function() {\n            options.applyFunc.call(this, inputLabel.value, true);\n        };\n        /** keyup */\n        inputLabel.onkeyup = function(evtk) {\n            if (options.geomType == \"Text\" && evtk.keyCode == 13) {\n                options.applyFunc.call(this, inputLabel.value, true);\n            }\n            if (evtk.keyCode == 27) {\n                options.applyFunc.call(this, inputLabel.value, false);\n            }\n        };\n\n        if (options.measure && options.geomType != \"Text\") {\n            var inputMeasure = document.createElement(\"input\");\n            inputMeasure.type = \"text\";\n            inputMeasure.readonly = true;\n            inputMeasure.className = \"gp-input-measure-style\";\n            inputMeasure.value = options.measure;\n            popup.appendChild(inputMeasure);\n        }\n\n        if (options.geomType != \"Text\") {\n            // apply button\n            var applyButton = document.createElement(\"input\");\n            applyButton.type = \"button\";\n            applyButton.className = \"gp-styling-button\";\n            applyButton.value = this.options.labels.saveDescription;\n            /** click sur applyButton */\n            applyButton.onclick = function() {\n                options.applyFunc.call(this, inputLabel.value, true);\n            };\n            popup.appendChild(applyButton);\n            // cancel Button\n            var cancelButton = document.createElement(\"input\");\n            cancelButton.type = \"button\";\n            cancelButton.className = \"gp-styling-button closer\";\n            /** click sur cancel Button */\n            cancelButton.onclick = function() {\n                options.applyFunc.call(this, inputLabel.value, false);\n            };\n            popup.appendChild(cancelButton);\n        }\n\n        return popup;\n    },\n\n    /**\n     * Handles drawing tool selection from a DOM point of view.\n     *\n     * @param {Event} e - DOM Event\n     * @param {String} toolId - toolId selected\n     * @param {DrawingDOM} context - Drawing control instance\n     */\n    _handleDOMToolClick: function(e, toolId, context) {\n        for (var availType in context.dtOptions) {\n            var availToolId = context._addUID(\"drawing-tool-\" + context.dtOptions[availType].id);\n            var li = document.getElementById(availToolId);\n            // ce n'est pas l'outil selectionne : on le desactive (s'il ne l'tait pas dj).\n            if (availToolId != toolId) {\n                li.className = \"drawing-tool\";\n                context.dtOptions[availType].active = false;\n                continue;\n            }\n            // ici, c'est le l'outil selectionne\n            if (context.dtOptions[availType].active) {\n                li.className = \"drawing-tool\";\n            } else {\n                li.className = \"drawing-tool drawing-tool-active\";\n            }\n            context.dtOptions[availType].active = !context.dtOptions[availType].active;\n        }\n    }\n\n};\n\nexport default DrawingDOM;\n\n\n\n// WEBPACK FOOTER //\n// ./src/Common/Controls/DrawingDOM.js","import ol from \"ol\";\nimport Gp from \"gp\";\nimport Logger from \"../../Common/Utils/LoggerByDefault\";\nimport Utils from \"../../Common/Utils\";\nimport RightManagement from \"../../Common/Utils/CheckRightManagement\";\nimport SelectorID from \"../../Common/Utils/SelectorID\";\nimport LocationSelector from \"./LocationSelector\";\nimport LayerSwitcher from \"./LayerSwitcher\";\nimport Markers from \"./Utils/Markers\";\nimport RouteDOM from \"../../Common/Controls/RouteDOM\";\n\n\nvar logger = Logger.getLogger(\"route\");\n\n/**\n * @classdesc\n *\n * Route Control.\n *\n * @constructor\n * @alias ol.control.Route\n * @extends {ol.control.Control}\n * @param {Object} options - route control options\n * @param {String}   [options.apiKey] - API key for services call (route and autocomplete services), mandatory if autoconf service has not been charged in advance\n * @param {Boolean} [options.collapsed = true] - Specify if widget has to be collapsed (true) or not (false) on map loading. Default is true.\n * @param {Object}  [options.exclusions = {toll : false, tunnel : false, bridge : false}] - list of exclusions with status (true = checked). By default : no exclusions checked.\n * @param {Array}   [options.graphs = [\"Voiture\", \"Pieton\"]] - list of resources, by default : [\"Voiture\", \"Pieton\"]. The first element is selected.\n * @param {Object} [options.markersOpts] - options to use your own markers. Object properties can be \"departure\", \"stages\" or \"arrival\". Corresponding value is an object with following properties :\n * @param {String} [options.markersOpts[property].url] - marker base64 encoded url (ex \"data:image/png;base64,...\"\"). Mandatory for a custom marker\n * @param {Array} [options.markersOpts[property].offset] - Offsets in pixels used when positioning the overlay. The first element in the array is the horizontal offset. A positive value shifts the overlay right. The second element in the array is the vertical offset. A positive value shifts the overlay down. Default is [0, 0]. (see http://openlayers.org/en/latest/apidoc/ol.Overlay.html)\n * @param {Object} [options.routeOptions = {}] - route service options. see {@link http://ignf.github.io/geoportal-access-lib/latest/jsdoc/module-Services.html#~route Gp.Services.route()} to know all route options.\n * @param {Object} [options.autocompleteOptions = {}] - autocomplete service options. see {@link http://ignf.github.io/geoportal-access-lib/latest/jsdoc/module-Services.html#~autoComplete Gp.Services.autoComplete()} to know all autocomplete options\n * @example\n *  var route = ol.control.Route({\n *      collapsed : true\n *      exclusions : {\n *         \"toll\" : true,\n *         \"bridge\" : false,\n *         \"tunnel\" : true\n *      },\n *      graphs : ['Pieton', 'Voiture'],\n *      markersOpts : {\n *          departure : {\n *              url : \"...\",\n *              offset : [0,0]\n *          },\n *          stages : {\n *              url : \"...\",\n *              offset : [0,0]\n *          },\n *          arrival : {\n *              url : \"...\",\n *              offset : [0,0]\n *          }\n *      }\n *      autocompleteOptions : {},\n *      routeOptions : {}\n *  });\n */\nfunction Route(options) {\n\n    options = options || {};\n\n    if (!(this instanceof Route)) {\n        throw new TypeError(\"ERROR CLASS_CONSTRUCTOR\");\n    }\n\n    // initialisation du composant\n    this.initialize(options);\n\n    // Widget main DOM container\n    this._container = this._createMainContainerElement();\n    this._containerElement = null;\n\n    // on peut ventuellement encapsuler le composant dans une div passe par l'utilisateur\n    if (options.element && options.element.appendChild) {\n        // dans ce cas on stocke les deux container\n        options.element.appendChild(this._container);\n        this._containerElement = options.element;\n    }\n\n    // call ol.control.Control constructor\n    ol.control.Control.call(this, {\n        element: this._containerElement || this._container,\n        target: options.target,\n        render: options.render\n    });\n}\n\n// Inherits from ol.control.Control\nol.inherits(Route, ol.control.Control);\n\n/**\n * @lends module:Route\n */\nRoute.prototype = Object.create(ol.control.Control.prototype, {});\n\n// on rcupre les mthodes de la classe commune RouteDOM\nUtils.assign(Route.prototype, RouteDOM);\n\n/**\n * Constructor (alias)\n * @private\n */\nRoute.prototype.constructor = Route;\n\n// ################################################################### //\n// ##################### public methods ############################## //\n// ################################################################### //\n\n/**\n * Returns true if widget is collapsed (minimized), false otherwise\n *\n * @returns {Boolean} collapsed - true if widget is collapsed\n */\nRoute.prototype.getCollapsed = function() {\n    return this.collapsed;\n};\n\n/**\n * Collapse or display widget main container\n *\n * @param {Boolean} collapsed - True to collapse widget, False to display it\n */\nRoute.prototype.setCollapsed = function(collapsed) {\n    if (collapsed === undefined) {\n        console.log(\"[ERROR] Route:setCollapsed - missing collapsed parameter\");\n        return;\n    }\n    if ((collapsed && this.collapsed) || (!collapsed && !this.collapsed)) {\n        return;\n    }\n    if (collapsed) {\n        document.getElementById(\"GProutePanelClose-\" + this._uid).click();\n    } else {\n        document.getElementById(\"GPshowRoute-\" + this._uid).click();\n    }\n    this.collapsed = collapsed;\n};\n\n/**\n * Get vector layer where geoJson route is drawn\n *\n * @returns {Object} layer - ol.layer.Vector route layer\n */\nRoute.prototype.getLayer = function() {\n    return this._geojsonSections;\n};\n\n/**\n * Overwrite OpenLayers setMap method\n *\n * @param {ol.Map} map - Map.\n */\nRoute.prototype.setMap = function(map) {\n\n    if (map) {\n        // enrichissement du DOM du container\n        this._container = this._initContainer(map);\n    }\n\n    // on appelle la mthode setMap originale d'OpenLayers\n    ol.control.Control.prototype.setMap.call(this, map);\n\n};\n\n// ################################################################### //\n// ##################### init component ############################## //\n// ################################################################### //\n\n/**\n * Initialize route control (called by Route constructor)\n *\n * @param {Object} options - constructor options\n * @private\n */\nRoute.prototype.initialize = function(options) {\n\n    this._checkInputOptions(options);\n\n    // set default options\n    this.options = {\n        collapsed: true,\n        graphs: [\"Voiture\", \"Pieton\"],\n        exclusions: {\n            toll: false,\n            tunnel: false,\n            bridge: false\n        },\n        routeOptions: {},\n        autocompleteOptions: {}\n    };\n\n    // merge with user options\n    Utils.assign(this.options, options);\n\n    // cas particulier des markers par dfaut\n    var defaultMarkersOpts = {\n        departure: {\n            url: Markers[\"red\"],\n            offset: Markers.defaultOffset\n        },\n        stages: {\n            url: Markers[\"lightOrange\"],\n            offset: Markers.defaultOffset\n        },\n        arrival: {\n            url: Markers[\"darkOrange\"],\n            offset: Markers.defaultOffset\n        }\n    };\n    // on rcupre les options de chaque type de marker si spcifi\n    this.options.markersOpts = Utils.assign(defaultMarkersOpts, options.markersOpts);\n\n    /** {Boolean} specify if Route control is collapsed (true) or not (false) */\n    this.collapsed = this.options.collapsed;\n\n    this._uid = SelectorID.generate();\n\n    // containers principaux\n    this._waitingContainer = null;\n    this._formRouteContainer = null;\n    this._resultsRouteContainer = null;\n    this._showRouteExclusionsElement = null;\n\n    // liste de points selectionne\n    this._currentPoints = [];\n\n    // Mode de transport selectionn : 'Voiture' ou 'Pieton'\n    this._currentTransport = null;\n    this._initTransport();\n\n    // Mode de calcul selectionn : 'Plus rapide' ou 'plus court'\n    this._currentComputation = null;\n    this._initComputation();\n\n    // Exclusions selectionnes : Tunnel, Toll et Bridge\n    this._currentExclusions = [];\n    this._initExclusions();\n\n    // si un calcul est en cours ou non\n    this._waiting = false;\n    // timer pour cacher la patience aprs un certain temps\n    this._timer = null;\n\n    // la geometrie du parcours\n    this._geojsonRoute = null;\n\n    // la geometrie des troncons\n    this._geojsonSections = null;\n\n    // le container de la popup (pour les troncons selectionns)\n    this._popupContent = null;\n    this._popupDiv = this._initPopupDiv();\n    // l'overlay ol.Overlay correspondant  la popup (pour les troncons selectionns)\n    this._popupOverlay = null;\n\n    // ol.interaction.Select associes  la couche des rsultats (troncons)\n    this._resultsSelectInteraction = null;\n    this._resultsHoverInteraction = null;\n\n    // styles pour les slections des features\n    this._defaultFeatureStyle = new ol.style.Style({\n        stroke: new ol.style.Stroke({\n            color: \"rgba(0,183,152,0.9)\",\n            width: 12\n        })\n    });\n    this._selectedFeatureStyle = new ol.style.Style({\n        stroke: new ol.style.Stroke({\n            color: \"rgba(255,102,0,0.9)\",\n            width: 12\n        })\n    });\n\n    // reponse du service\n    // Ex. {\n    //   totalTime, totalDistance, bbox, routeGeometry,\n    //   routeInstructions : [{duration, distance, code, instruction, bbox, geometry}]\n    // }\n    this._currentRouteInformations = null;\n\n    // liste des ressources avec droits par service\n    // Ex. {\n    //   \"Route\" : {\n    //       key : \"ger4g456re45er456t4er5ge5\",\n    //       resources : [\"Pieton\", \"Voiture\"]\n    //   }\n    // }\n    this._resources = {};\n\n    // gestion des droits sur les ressources\n    this._noRightManagement = false;\n\n    // gestion des droits sur les ressources/services\n    this._checkRightsManagement();\n};\n\n/**\n * this method is called by this.initialize()\n *\n * @private\n */\nRoute.prototype._checkInputOptions = function(options) {\n\n    // vrification des options\n    // mode de transport\n    if (options.graphs) {\n        if (Array.isArray(options.graphs)) {\n            // on ne permet pas de passer un tableau vide : on spcifie au moins un graph\n            if (options.graphs.length === 0) {\n                options.graphs = null;\n            } else {\n                for (var i = 0; i < options.graphs.length; i++) {\n                    if (typeof options.graphs[i] !== \"string\") {\n                        console.log(\"[ol.control.Route] ERROR : parameter 'graphs' elements should be of type 'string'\");\n                        options.graphs = null;\n                    } else {\n                        if (options.graphs[i].toLowerCase() === \"pieton\") {\n                            options.graphs[i] = \"Pieton\";\n                        }\n                        if (options.graphs[i].toLowerCase() === \"voiture\") {\n                            options.graphs[i] = \"Voiture\";\n                        }\n                    }\n\n                }\n            }\n        } else {\n            logger.warn(\"'graphs' parameter should be an array\");\n            options.graphs = null;\n        }\n    }\n\n    // collapsed\n    if (options.collapsed === \"true\") {\n        options.collapsed = true;\n    }\n    if (options.collapsed === \"false\") {\n        options.collapsed = false;\n    }\n};\n\n/**\n * Check rights to resources (called by constructor)\n *\n * @private\n */\nRoute.prototype._checkRightsManagement = function() {\n\n    var _opts = null;\n    var _res = [];\n    var _key = null;\n\n    // les ressources du service du calcul d'Itineraire\n    _key = this.options.routeOptions.apiKey;\n    _opts = this.options.routeOptions.filterOptions;\n    _res = (_opts) ? _opts.type : [];\n    if (!_res || _res.length === 0) {\n        _res = [\"Voiture\", \"Pieton\"];\n    }\n\n    var rightManagementRoute = RightManagement.check({\n        key: _key || this.options.apiKey,\n        resources: _res,\n        services: [\"Itineraire\"]\n    });\n    logger.log(\"rightManagementRoute\", rightManagementRoute);\n\n    // les ressources du service d'autocompletion\n    _key = this.options.autocompleteOptions.apiKey;\n    _opts = this.options.autocompleteOptions.filterOptions;\n    _res = (_opts) ? _opts.type : [];\n    if (!_res || _res.length === 0) {\n        _res = [\n            \"PositionOfInterest\",\n            \"StreetAddress\"\n        ];\n    }\n\n    var rightManagementAutoComplete = RightManagement.check({\n        key: _key || this.options.apiKey,\n        resources: _res,\n        services: [\"AutoCompletion\"]\n    });\n    logger.log(\"rightManagementAutoComplete\", rightManagementAutoComplete);\n\n    // au cas o pas de droit !\n    if (!rightManagementRoute && !rightManagementAutoComplete) {\n        this._noRightManagement = true;\n    }\n\n    // FIXME je reconstruis differement la structure pour la gestion des clefs differentes\n    // pour chaque service...\n    if (rightManagementAutoComplete) {\n        this._resources[\"AutoCompletion\"] = {};\n        this._resources[\"AutoCompletion\"][\"resources\"] = rightManagementAutoComplete[\"AutoCompletion\"];\n        this._resources[\"AutoCompletion\"][\"key\"] = rightManagementAutoComplete[\"key\"];\n    }\n\n    if (rightManagementRoute) {\n        this._resources[\"Itineraire\"] = {};\n        this._resources[\"Itineraire\"][\"resources\"] = rightManagementRoute[\"Itineraire\"];\n        this._resources[\"Itineraire\"][\"key\"] = rightManagementRoute[\"key\"];\n    }\n\n};\n\n/**\n * initialize component container (DOM)\n *\n * @private\n */\nRoute.prototype._initContainer = function(map) {\n    // get main container\n    var container = this._container;\n\n    var inputShow = this._showRouteContainer = this._createShowRouteElement();\n    container.appendChild(inputShow);\n\n    // mode \"collapsed\"\n    if (!this.collapsed) {\n        inputShow.checked = true;\n    }\n\n    var picto = this._createShowRoutePictoElement();\n    container.appendChild(picto);\n\n    var routePanel = this._createRoutePanelElement();\n\n    // header form\n    var routeHeader = this._createRoutePanelHeaderElement();\n    routePanel.appendChild(routeHeader);\n\n    // form\n    var routeForm = this._formRouteContainer = this._createRoutePanelFormElement();\n\n    // form: menu des points\n    var points = this._createRoutePanelFormPointsElement(map);\n    for (var i = 0; i < points.length; i++) {\n        routeForm.appendChild(points[i]);\n    }\n\n    // form: menu des modes\n    var choice = this._createRoutePanelFormModeChoiceElement();\n    choice.appendChild(this._createRoutePanelFormModeChoiceTransportElement(this.options.graphs));\n    choice.appendChild(this._createRoutePanelFormModeChoiceComputeElement());\n    routeForm.appendChild(choice);\n\n    // form: menu des exclusions\n    routeForm.appendChild(this._createShowRouteExclusionsElement());\n    this._showRouteExclusionsElement = this._createShowRouteExclusionsPictoElement();\n    routeForm.appendChild(this._showRouteExclusionsElement);\n    var exclusion = this._createRoutePanelFormExclusionsElement();\n    exclusion.appendChild(this._createRoutePanelFormExclusionOptionsElement(this.options.exclusions));\n    routeForm.appendChild(exclusion);\n\n    var divReset = this._createRouteFormResetElement();\n    routeForm.appendChild(divReset);\n\n    // form: bouton du calcul\n    var submit = this._createRouteSubmitFormElement();\n    routeForm.appendChild(submit);\n\n    routePanel.appendChild(routeForm);\n\n    // results\n    var routeResults = this._resultsRouteContainer = this._createRoutePanelResultsElement();\n    routePanel.appendChild(routeResults);\n\n    // waiting\n    var waiting = this._waitingContainer = this._createRouteWaitingElement();\n    routePanel.appendChild(waiting);\n\n    container.appendChild(routePanel);\n    var context = this;\n    // hide autocomplete suggested locations on container click\n    if (container.addEventListener) {\n        container.addEventListener(\"click\", function(e) {\n            context._hideRouteSuggestedLocations.call(context, e);\n        });\n    }\n\n    return container;\n};\n\n// ################################################################### //\n// ####################### init application ########################## //\n// ################################################################### //\n\n/**\n * this method is called by the constructor and initialize transport mode\n * (\"Voiture\" ou \"Pieton\")\n *\n * @private\n */\nRoute.prototype._initTransport = function() {\n    // Mode de transport selectionn\n    this._currentTransport = \"Voiture\"; // par defaut\n\n    // par defaut\n    var transport = this.options.graphs;\n    if (!transport || transport.length === 0) {\n        this.options.graphs = [\"Voiture\", \"Pieton\"];\n    }\n\n    // option\n    if (Array.isArray(transport) && transport.length) {\n        // FIXME pb si le 1er graphe n'est pas une ressource connue !\n        if (transport[0] === \"Voiture\" || transport[0] === \"Pieton\") {\n            this._currentTransport = transport[0];\n        }\n    }\n\n    // TODO option sur le service\n    var serviceOptions = this.options.routeOptions;\n    if (serviceOptions.graph) {\n        this._currentTransport = serviceOptions.graph;\n    }\n};\n\n/**\n * this method is called by the constructor and initialize computation mode\n * (fastest or shortest)\n *\n * @private\n */\nRoute.prototype._initComputation = function() {\n    // Mode de calcul selectionn\n    this._currentComputation = \"fastest\"; // par defaut\n\n    // TODO option sur le service\n    var serviceOptions = this.options.routeOptions;\n    if (serviceOptions.routePreference) {\n        this._currentComputation = serviceOptions.routePreference;\n    }\n};\n\n/**\n * this method is called by the constructor and initialize exclusions\n *\n * @private\n */\nRoute.prototype._initExclusions = function() {\n    // Exclusions selectionnes : Tunnel, Toll et Bridge\n    this._currentExclusions = []; // par defaut\n\n    // par defaut\n    var exclusion = this.options.exclusions;\n    if (!exclusion || (typeof exclusion === \"object\" && Object.keys(exclusion).length === 0)) {\n        this.options.exclusions = {\n            toll: false,\n            tunnel: false,\n            bridge: false\n        };\n    }\n\n    // option\n    if (exclusion && typeof exclusion === \"object\" && Object.keys(exclusion).length) {\n        for (var k in exclusion) {\n            if (exclusion.hasOwnProperty(k)) {\n                if (exclusion[k]) {\n                    this._currentExclusions.push(k);\n                }\n            }\n        }\n    }\n\n    // TODO option sur le service\n    var serviceOptions = this.options.routeOptions;\n    if (Array.isArray(serviceOptions.exclusions)) {\n        this._currentExclusions = serviceOptions.exclusions;\n    }\n};\n\n/**\n * this method is called by this.initialize() and initialize popup div\n * (to display results information on route result click)\n *\n * @return {Object} element - DOM element for popup\n * @private\n */\nRoute.prototype._initPopupDiv = function() {\n    var context = this;\n    var element = document.createElement(\"div\");\n    element.className = \"gp-feature-info-div\";\n    var closer = document.createElement(\"input\");\n    closer.type = \"button\";\n    closer.className = \"gp-styling-button closer\";\n    /** on closer click : remove popup */\n    closer.onclick = function() {\n        if (context._popupOverlay != null) {\n            context._popupOverlay.setPosition(undefined);\n        }\n        return false;\n    };\n    this._popupContent = document.createElement(\"div\");\n    this._popupContent.className = \"gp-features-content-div\";\n    element.appendChild(this._popupContent);\n    element.appendChild(closer);\n\n    return element;\n};\n\n// ################################################################### //\n// ############################## DOM ################################ //\n// ################################################################### //\n\n/**\n * Create List Points\n * Overwrite RouteDOM method !\n *\n * @returns {Array} List DOM element\n * @private\n */\nRoute.prototype._createRoutePanelFormPointsElement = function(map) {\n\n    var points = [];\n    var count = 1;\n\n    // point de depart\n    var start = new LocationSelector({\n        apiKey: this.options.apiKey || null,\n        tag: {\n            id: count,\n            groupId: this._uid,\n            markerOpts: this.options.markersOpts[\"departure\"],\n            label: \"Dpart\",\n            display: true\n        },\n        autocompleteOptions: this.options.autocompleteOptions || null\n    });\n    start.setMap(map);\n    // on ajoute des couteurs d'vnements (en plus de ceux de LocationSelector),\n    // pour prendre en compte les CSS spcifiques de GProuteForm\n    this._addFormPointsEventListeners(start);\n    points.push(start._container);\n    this._currentPoints.push(start);\n\n    // points intermediaires\n    for (count = 2; count < 7; count++) {\n        var step = new LocationSelector({\n            apiKey: this.options.apiKey || null,\n            tag: {\n                id: count,\n                groupId: this._uid,\n                label: \"Etape\",\n                markerOpts: this.options.markersOpts[\"stages\"],\n                display: false,\n                removeOption: true\n            },\n            autocompleteOptions: this.options.autocompleteOptions || null\n        });\n        step.setMap(map);\n        this._addFormPointsEventListeners(step);\n        points.push(step._container);\n        this._currentPoints.push(step);\n    }\n\n    // point d'arrive\n    var end = new LocationSelector({\n        apiKey: this.options.apiKey || null,\n        tag: {\n            id: count,\n            groupId: this._uid,\n            markerOpts: this.options.markersOpts[\"arrival\"],\n            label: \"Arrive\",\n            display: true,\n            addOption: true\n        },\n        autocompleteOptions: this.options.autocompleteOptions || null\n    });\n    end.setMap(map);\n    this._addFormPointsEventListeners(end);\n    points.push(end._container);\n    this._currentPoints.push(end);\n\n    return points;\n};\n\n/**\n * Attach events listeners to route form points (locationSelector)\n *\n * @param {Object} formPoint - route form point (locationSelector)\n * @private\n */\nRoute.prototype._addFormPointsEventListeners = function(formPoint) {\n    if (!formPoint) {\n        return;\n    }\n    var context = this;\n    if (formPoint._inputLabelContainer.addEventListener) {\n        // display form on origin label click\n        formPoint._inputLabelContainer.addEventListener(\n            \"click\",\n            function() {\n                context.onRouteOriginLabelClick.call(this, context);\n            }\n        );\n        // minimize form on input show pointer, and set map event listeners (see this.onRouteOriginPointerClick)\n        formPoint._inputShowPointer.addEventListener(\n            \"click\",\n            function() {\n                context.onRouteOriginPointerClick.call(this, context, formPoint);\n            }\n        );\n        if (formPoint._removePointElement) {\n            formPoint._removePointElement.addEventListener(\n                \"click\",\n                function() {\n                    // Moving up exclusions picto\n                    var exclusionsPictoTop = context._showRouteExclusionsElement.style.top;\n                    context._showRouteExclusionsElement.style.top = (parseInt(exclusionsPictoTop, 10) - 33).toString() + \"px\";\n                }\n            );\n        }\n        if (formPoint._addPointElement) {\n            formPoint._addPointElement.addEventListener(\n                \"click\",\n                function() {\n                    // Moving down exclusions picto\n                    var exclusionsPictoTop = context._showRouteExclusionsElement.style.top;\n                    context._showRouteExclusionsElement.style.top = (parseInt(exclusionsPictoTop, 10) + 33).toString() + \"px\";\n                }\n            );\n        }\n    } else if (formPoint._inputLabelContainer.attachEvent) {\n        // attachEvent: Internet explorer event listeners management\n        formPoint._inputLabelContainer.attachEvent(\n            \"onclick\",\n            function() {\n                context.onRouteOriginLabelClick.call(this, context);\n            }\n        );\n        formPoint._inputShowPointer.attachEvent(\n            \"onclick\",\n            function() {\n                context.onRouteOriginPointerClick.call(this, context, formPoint);\n            }\n        );\n        if (formPoint._removePointElement) {\n            formPoint._removePointElement.attachEvent(\n                \"onclick\",\n                function() {\n                    // Moving up exclusions picto\n                    var exclusionsPictoTop = context._showRouteExclusionsElement.style.top;\n                    context._showRouteExclusionsElement.style.top = (parseInt(exclusionsPictoTop, 10) - 33).toString() + \"px\";\n                }\n            );\n        }\n        if (formPoint._addPointElement) {\n            formPoint._addPointElement.attachEvent(\n                \"onclick\",\n                function() {\n                    // Moving down exclusions picto\n                    var exclusionsPictoTop = context._showRouteExclusionsElement.style.top;\n                    context._showRouteExclusionsElement.style.top = (parseInt(exclusionsPictoTop, 10) + 33).toString() + \"px\";\n                }\n            );\n        }\n    }\n};\n\n// ################################################################### //\n// ####################### handlers events to dom #################### //\n// ################################################################### //\n\n/**\n * this method is called by event 'submit' on 'GProuteForm' tag form\n * (cf. this._createRoutePanelFormElement), and it displays the results.\n *\n * @param {Object} options - options\n * @private\n */\nRoute.prototype.onRouteComputationSubmit = function(options) {\n    logger.log(\"onRouteComputationSubmit\", options);\n\n    // FIXME on lance une requte en EPSG:4326, les coordonnes\n    // doivent donc tre du type cad en lat/lon.\n    // or, BUG du service du calcul d'itineraire car les\n    // coordonnes envoyes doivent tre en lon/lat avec une SRS en EPSG:4326 !?\n    // sinon, a plante...\n\n    // Liste des points\n    var points = this._currentPoints;\n\n    // - point de depart (info: points[0].getCoordinate est du type [lon, lat], en EPSG:4326)\n    var start;\n    if (points[0] && points[0].getCoordinate) {\n        var startCoordinate = points[0].getCoordinate();\n        start = {\n            x: startCoordinate[0],\n            y: startCoordinate[1]\n        };\n        logger.log(\"start\", start);\n    }\n\n    // - point d'arrive\n    var end;\n    var endPoint = points[points.length - 1];\n    if (endPoint && endPoint.getCoordinate) {\n        var endCoordinate = endPoint.getCoordinate();\n        end = {\n            x: endCoordinate[0],\n            y: endCoordinate[1]\n        };\n        logger.log(\"end\", end);\n    }\n\n    // - les tapes\n    var step = [];\n    for (var i = 1; i < points.length - 1; i++) {\n        if (points[i] && points[i].getCoordinate) {\n            var iCoordinate = points[i].getCoordinate();\n            if (iCoordinate) {\n                var coordinate = {\n                    x: iCoordinate[0],\n                    y: iCoordinate[1]\n                };\n                logger.log(\"step\", coordinate);\n                step.push(coordinate);\n            }\n        }\n    }\n\n    // oups, aucun droits !\n    // on evite donc une requte inutile ...\n    if (this._noRightManagement) {\n        return;\n    }\n\n    // valeurs selectionnes\n    this._currentTransport = options.transport;\n    this._currentComputation = options.computation;\n    this._currentExclusions = options.exclusions;\n\n    // on recupere les ventuelles options du service passes par l'utilisateur\n    var routeOptions = this.options.routeOptions;\n\n    // gestion du protocole et du timeout\n    // le timeout est indispensable sur le protocole JSONP.\n    var _protocol = routeOptions.protocol || \"XHR\";\n    var _timeout = routeOptions.timeOut || 0;\n    if (_protocol === \"JSONP\" && _timeout === 0) {\n        // FIXME le timeout est obligatoire pour ce type de protocole...\n        _timeout = 15000;\n    }\n\n    // on met en place l'affichage des resultats dans la fenetre de resultats.\n    var context = this;\n    this._requestRouting({\n        startPoint: start,\n        endPoint: end,\n        viaPoints: step,\n        graph: routeOptions.graph || this._currentTransport,\n        routePreference: routeOptions.routePreference || this._currentComputation,\n        exclusions: routeOptions.exclusions || this._currentExclusions,\n        geometryInInstructions: true,\n        distanceUnit: \"m\",\n        timeOut: _timeout,\n        protocol: _protocol,\n        /** callback onSuccess */\n        onSuccess: function(results) {\n            logger.log(results);\n            if (results) {\n                context._fillRouteResultsDetails(results);\n            }\n        },\n        /** callback onFailure */\n        onFailure: function(error) {\n            context._hideWaitingContainer();\n            context._clearRouteResultsDetails();\n            logger.log(error.message);\n        }\n    });\n\n};\n\n/**\n * this method is called by event 'click' on 'GPlocationOriginLabel' label\n * and set 'GProuteForm' CSS class to \"\" (normal)\n *\n * @param {Object} routeControl - context : route Control (this)\n * @private\n */\nRoute.prototype.onRouteOriginLabelClick = function(routeControl) {\n    var map = routeControl.getMap();\n    routeControl._formRouteContainer.className = \"\";\n    // on dsactive l'couteur d'vnements sur la carte (pour ne pas placer un marker au clic)\n    map.un(\n        \"click\",\n        function() {\n            // on ne rtablit pas le mode \"normal\" si on est dans le panel des rsultats (o className = \"GProuteComponentHidden\")\n            if (routeControl._formRouteContainer.className === \"GProuteFormMini\") {\n                routeControl._formRouteContainer.className = \"\";\n            }\n        }\n    );\n};\n\n/**\n * this method is called by event 'click' on 'GPlocationOriginPointerImg' label\n * and display or minimize 'GProuteForm', using CSS class (\"GProuteFormMini\" or \"\")\n *\n * @param {Object} routeControl - context : route Control (equivalent to this)\n * @param {Object} locationSelector - context : locationSelector input (one of this._currentPoints)\n * @private\n */\nRoute.prototype.onRouteOriginPointerClick = function(routeControl, locationSelector) {\n    var map = routeControl.getMap();\n    if (locationSelector._inputShowPointerContainer.checked) {\n        // au click sur l'input pour pointer sur la carte: on minimise le formulaire\n        routeControl._formRouteContainer.className = \"GProuteFormMini\";\n        // et au clic sur la carte, on raffichera le formulaire \"normal\"\n        map.on(\n            \"click\",\n            function() {\n                // on ne rtablit pas le mode \"normal\" si on est dans le panel des rsultats (o className = \"GProuteComponentHidden\")\n                if (routeControl._formRouteContainer.className === \"GProuteFormMini\") {\n                    routeControl._formRouteContainer.className = \"\";\n                }\n            }\n        );\n    } else {\n        // si on dselectionne le pointer, on rtablit le formulaire en mode normal\n        routeControl._formRouteContainer.className = \"\";\n        // et on enlve l'couteur d'vnement sur la carte\n        map.un(\n            \"click\",\n            function() {\n                // on ne rtablit pas le mode \"normal\" si on est dans le panel des rsultats (o className = \"GProuteComponentHidden\")\n                if (routeControl._formRouteContainer.className === \"GProuteFormMini\") {\n                    routeControl._formRouteContainer.className = \"\";\n                }\n            }\n        );\n    }\n};\n\n/**\n * this method is called by event 'click' on 'GPshowRoutePicto'\n * tag label (cf. this._createShowRoutePictoElement),\n * and it cleans all value of input.\n *\n * @private\n */\nRoute.prototype.onShowRoutePanelClick = function() {\n    // clean !\n    if (!this._geojsonSections && !this._waiting) {\n        this._clear();\n    }\n    this.collapsed = document.getElementById(\"GPshowRoute-\" + this._uid).checked;\n    // on gnre nous mme l'evenement OpenLayers de changement de pt\n    // (utiliser ol.control.Route.on(\"change:collapsed\", function ) pour s'abonner  cet vnement)\n    this.dispatchEvent(\"change:collapsed\");\n};\n\n/**\n * this method is called by event 'change' on 'GProuteComputationSelect' tag select\n * (cf. this._createRoutePanelFormModeChoiceComputeElement).\n * this value is saved as a parameter for the service route.\n *\n * @param {Object} e - HTMLElement\n * @private\n */\nRoute.prototype.onRouteModeComputationChange = function(e) {\n    var idx = e.target.selectedIndex;\n    var value = e.target.options[idx].value;\n\n    if (!value) {\n        return;\n    }\n\n    logger.log(value);\n    this._currentComputation = value;\n};\n\n/**\n * this method is called by event 'change' on 'GProuteResultsComputationSelect' tag select\n * (cf. this._createRouteResultsElement).\n * this value is saved as a parameter for the service route,\n * and this launches the route request !\n *\n * @param {Object} e - HTMLElement\n * @private\n */\nRoute.prototype.onRouteModeComputationChangeAndRun = function(e) {\n\n    // event choice computation\n    this.onRouteModeComputationChange(e);\n\n    // clean avant un nouveau calcul !\n    this._clearRouteResultsDetails();\n    this._clearRouteResultsGeometry();\n    this._clearRouteResultsFeatureGeometry();\n\n    // submit request\n    this.onRouteComputationSubmit({\n        computation: this._currentComputation,\n        transport: this._currentTransport,\n        exclusions: this._currentExclusions\n    });\n};\n\n/**\n * this method is called by event 'change' on 'GProuteTransportCar' or 'GProuteTransportPedestrian' tag input\n * (cf. this._createRoutePanelFormModeChoiceTransportElement).\n * this value is saved as a parameter for the service route.\n *\n * @param {Object} e - HTMLElement\n * @private\n */\nRoute.prototype.onRouteModeTransportChange = function(e) {\n    var value = e.target.value;\n    if (!value) {\n        return;\n    }\n    this._currentTransport = value;\n};\n\n/**\n * TODO this method is called by event 'click' on 'GPshowRouteExclusionsPicto' tag input\n * (cf. this._createShowRouteExclusionsPictoElement), and it displays the panel options of exclusions.\n *\n * @param {Object} e - HTMLElement\n * @private\n */\nRoute.prototype.onShowRouteExclusionsClick = function(e) {\n    logger.log(\"onShowRouteExclusionsClick\", e);\n    // FIXME not use ?!\n};\n\n/**\n * this method is called by event 'change' on 'GProuteExclusionsToll'\n * or 'GProuteExclusionsTunnel' or 'GProuteExclusionsBridge' tag input\n * (cf. this._createRoutePanelFormExclusionOptionsElement).\n * this value is saved as a parameter for the service route.\n *\n * @param {Object} e - HTMLElement\n * @private\n */\nRoute.prototype.onRouteExclusionsChange = function(e) {\n    var value = e.target.value;\n    var checked = e.target.checked;\n\n    if (!value || (typeof value !== \"string\")) {\n        return;\n    }\n    value = value.toLowerCase();\n\n    var bFound = false;\n    var iFound = null;\n    for (var i = 0; i < this._currentExclusions.length; i++) {\n        if (this._currentExclusions[i] === value) {\n            iFound = i;\n            bFound = true;\n        }\n    }\n    // on l'ajoute si la valeur n'existe pas et est dselectionne\n    // info : checked = passage autoris (ce n'est pas une exclusion)\n    if (!bFound && !checked) {\n        this._currentExclusions.push(value);\n    }\n    // on la retire si la valeur existe et est selectionne\n    if (bFound && checked) {\n        this._currentExclusions.splice(iFound, 1);\n    }\n};\n\n/**\n * this method is called by event 'click' on 'GProuteReset'\n * tag label (cf. this._createRouteFormResetElement),\n * and it cleans all route input options and results.\n *\n * @private\n */\nRoute.prototype.onRouteResetClick = function() {\n    // clear points\n    var currentPoints = this._currentPoints;\n    for (var i = 0; i < currentPoints.length; i++) {\n        currentPoints[i].clear();\n    }\n\n    // clear results\n    this._clear();\n\n    this._clearRouteInputOptions();\n};\n\n/**\n * this method is called by event 'click' on 'GProuteSubmit'\n * tag label (cf. this._createRouteSubmitFormElement),\n * and it cleans the route geometry.\n *\n * @private\n */\nRoute.prototype.onShowRouteResultsNewClick = function() {\n    // clean avant un nouveau calcul !\n    this._clearRouteResultsDetails();\n    this._clearRouteResultsGeometry();\n    this._clearRouteResultsFeatureGeometry();\n};\n\n/**\n * this method is called by event 'mouseover' on 'GProuteResultsDetailsInstruction_'\n * tag label (cf. this._addRouteResultsDetailsElement),\n * and it makes a style on feature route.\n *\n * @param {Object} e - HTMLElement\n * @private\n */\nRoute.prototype.onRouteResultsDetailsMouseOver = function(e) {\n    // rcupration de l'id de l'instruction survole\n    var tagid = e.target.id; // ex GProuteResultsDetailsInstruction_125\n    var idx = tagid.substring(tagid.indexOf(\"_\") + 1); // ex. 125\n\n    // on passe le texte en gras\n    if (e.target.classList) {\n        e.target.classList.add(\"GProuteResultsDetailsInstructionHighlight\");\n    }\n\n    if (!this._geojsonSections) {\n        return;\n    }\n\n    // on rcupre l'entit correspondante  l'instruction survole\n    var f = this._geojsonSections.getSource().getFeatureById(parseInt(idx, 10));\n    // et on lui affecte un nouveau style\n    f.setStyle(this._selectedFeatureStyle);\n};\n\n/**\n * this method is called by event 'mouseout' on 'GProuteResultsDetailsInstruction_'\n * tag label (cf. this._addRouteResultsDetailsElement),\n * and it deletes a style on feature route.\n *\n * @param {Object} e - HTMLElement\n * @private\n */\nRoute.prototype.onRouteResultsDetailsMouseOut = function(e) {\n    // rcupration de l'id de l'instruction survole\n    var tagid = e.target.id; // ex GProuteResultsDetailsInstruction_125\n    var idx = tagid.substring(tagid.indexOf(\"_\") + 1); // ex. 125\n\n    // on repasse le texte en style normal\n    if (e.target.classList) {\n        e.target.classList.remove(\"GProuteResultsDetailsInstructionHighlight\");\n    }\n\n    if (!this._geojsonSections) {\n        return;\n    }\n    // on rcupre l'entit correspondante  l'instruction qui tait survole\n    var f = this._geojsonSections.getSource().getFeatureById(parseInt(idx, 10));\n    // et on lui raffecte un style normal\n    f.setStyle(null);\n};\n\n// ################################################################### //\n// ########################### Routing ############################### //\n// ############## (methods to request and results) ################### //\n\n/**\n * this method is called by this.onRouteComputationSubmit()\n * and executes a request to the service.\n *\n * @param {Object} options - route service request options\n * @param {Function} options.onSuccess - callback\n * @param {Function} options.onFailure - callback\n * @private\n */\nRoute.prototype._requestRouting = function(options) {\n\n    // on ne fait pas de requte si on n'a pas renseign de parametres !\n    if (!options || (typeof options === \"object\" && Object.keys(options).length === 0)) {\n        return;\n    }\n\n    // on ne fait pas de requte si\n    // - la parametre 'startPoint' est vide !\n    if (!options.startPoint) {\n        return;\n    }\n    // - la parametre 'endPoint' est vide !\n    if (!options.endPoint) {\n        return;\n    }\n\n    // on ne fait pas de requte si aucun droit !\n    if (this._noRightManagement || !this._resources[\"Itineraire\"]) {\n        return;\n    }\n\n    // gestion des droits !\n    var resources = this._resources[\"Itineraire\"].resources;\n    if (!resources || (typeof resources === \"object\" && Object.keys(resources).length === 0)) {\n        return;\n    }\n\n    // gestion de la clef !\n    var key = this._resources[\"Itineraire\"][\"key\"];\n\n    // la ressource donne elle des droits ?\n    var bFound = false;\n    for (var i = 0; i < resources.length; i++) {\n        if (resources[i] === options.graph) {\n            bFound = true;\n        }\n    }\n\n    // on fait quoi ?\n    if (!bFound) {\n        console.log(\"no rights for this service !?\");\n        return;\n    }\n\n    // cas o la clef API n'est pas renseigne dans les options du service,\n    // on utilise celle de l'autoconf ou celle renseigne au niveau du controle\n    options.apiKey = this.options.routeOptions.apiKey || this.options.apiKey || key;\n\n    logger.log(options);\n\n    // mise en place de la patience\n    this._displayWaitingContainer();\n\n    // appel du service de calcul d'itinraires\n    Gp.Services.route(options);\n};\n\n/**\n * this method is called by this.onRouteComputationSubmit() (in case of route computation success)\n * and fills the container of the route instructions list, distance and time\n * information, also, constructs the geometry route.\n *\n * @private\n */\nRoute.prototype._fillRouteResultsDetails = function(results) {\n\n    // 1. Affichage des distances et dures\n    var distance = results.totalDistance;\n    var duration = results.totalTime;\n    // Dtails avec simplifications des troncons\n    var instructions = this._simplifiedInstructions(results.routeInstructions);\n    // var instructions = results.routeInstructions;\n\n    if (instructions) {\n        this._fillRouteResultsDetailsContainer(distance, duration, instructions);\n    }\n\n    // 2. Affichage des gomtries\n    // Geometrie simplifie (si renseigne)\n    var geometry = results.routeGeometry;\n    if (geometry) {\n        this._fillRouteResultsDetailsGeometry(geometry, this._defaultFeatureStyle);\n    }\n\n    // Geometries des tronon (si renseigne)\n    if (instructions && instructions[0].geometry) {\n        this._fillRouteResultsDetailsFeatureGeometry(instructions, this._defaultFeatureStyle);\n    }\n\n    // 3. Zoom sur l'emprise de l'itinraire (si spcifie)\n    var bbox = results.bbox;\n    if (bbox) {\n        var map = this.getMap();\n        var bounds = [bbox.left, bbox.bottom, bbox.right, bbox.top];\n        // reprojection dans la projection de la carte (bbox initialement en EPSG:4326)\n        var mapProj = map.getView().getProjection().getCode();\n        if (mapProj !== \"EPSG:4326\") {\n            bounds = ol.proj.transformExtent(bounds, \"EPSG:4326\", mapProj);\n        }\n        map.getView().fit(bounds, map.getSize());\n    }\n\n    // sauvegarde de l'etat des resultats\n    this._currentRouteInformations = results;\n\n    // mise  jour du controle !\n    this._formRouteContainer.className = \"GProuteComponentHidden\";\n    this._hideWaitingContainer();\n    this._resultsRouteContainer.className = \"\";\n};\n\n/**\n * this method is called by this._fillRouteResultsDetails()\n * and fills the container of the route instructions list, distance and time\n * information.\n *\n * @private\n */\nRoute.prototype._fillRouteResultsDetailsContainer = function(distance, duration, instructions) {\n    // Distance et Dure\n    this._resultsRouteValuesContainer = this._addRouteResultsValuesElement(distance, duration, this._convertSecondsToTime);\n\n    // Dtails\n    this._resultsRouteDetailsContainer = this._addRouteResultsDetailsElement(instructions, this._convertSecondsToTime);\n};\n\n/**\n * this method is called by this._fillRouteResultsDetails()\n * and constructs the geometry route.\n *\n * @param {Object} geometry - geoJSON object for route geometry\n * @param {Object} style - route ol.style.Style object\n * @private\n */\nRoute.prototype._fillRouteResultsDetailsGeometry = function(geometry, style) {\n\n    this._clearRouteResultsGeometry();\n\n    var map = this.getMap();\n\n    if (!geometry) {\n        return;\n    }\n\n    // cration de l'objet geoJSON\n    var geojsonObject = {\n        type: \"Feature\",\n        crs: {\n            type: \"name\",\n            properties: {\n                name: \"EPSG:4326\"\n            }\n        },\n        geometry: geometry\n    };\n    var geojsonformat = new ol.format.GeoJSON({\n        defaultDataProjection: \"EPSG:4326\"\n    });\n    var features = geojsonformat.readFeatures(\n        geojsonObject, {\n            dataProjection: \"EPSG:4326\",\n            featureProjection: \"EPSG:3857\"\n        }\n    );\n\n    // ajout de la gomtrie comme nouvelle couche vecteur  la carte\n    this._geojsonRoute = new ol.layer.Vector({\n        source: new ol.source.Vector({\n            features: features\n        }),\n        style: style\n    });\n    map.addLayer(this._geojsonRoute);\n\n};\n\n/**\n * this method is called by this._fillRouteResultsDetails()\n * and constructs the geometries street with informations.\n *\n * @param {Array} instructions - route instructions list (containing geoJSON geometry)\n * @param {Object} style - route ol.style.Style object\n * @private\n */\nRoute.prototype._fillRouteResultsDetailsFeatureGeometry = function(instructions, style) {\n\n    this._clearRouteResultsFeatureGeometry();\n\n    var map = this.getMap();\n\n    // 1. cration de l'objet geoJSON\n    var geojsonObject = {\n        type: \"FeatureCollection\",\n        crs: {\n            type: \"name\",\n            properties: {\n                name: \"EPSG:4326\"\n            }\n        },\n        features: []\n    };\n\n    // 2. Remplissage de l'objet geoJSON : ajout des gomtries de chaque instruction\n    for (var i = 0; i < instructions.length; i++) {\n        var o = instructions[i];\n        var id = i + 1;\n\n        var coords = o.geometry.coordinates;\n        for (var j = 0; j < coords.length; j++) {\n            // remarque : les coordonnes sont au format string,  convertir en nombres\n            if (typeof coords[j][0] === \"string\") {\n                coords[j][0] = parseFloat(coords[j][0]);\n                coords[j][1] = parseFloat(coords[j][1]);\n            }\n        }\n\n        geojsonObject.features.push({\n            type: \"Feature\",\n            geometry: o.geometry,\n            properties: {\n                popupContent: \"(\" + id + \") distance : \" + this._convertDistance(o.distance) +\n                    \" / temps : \" + this._convertSecondsToTime(o.duration)\n            },\n            id: id\n        });\n    }\n\n    logger.log(geojsonObject);\n\n    // Cration du format GeoJSON, avec reprojection des gomtries\n    var geojsonformat = new ol.format.GeoJSON({\n        defaultDataProjection: \"EPSG:4326\"\n    });\n    var mapProj = this.getMap().getView().getProjection().getCode();\n    var features = geojsonformat.readFeatures(\n        geojsonObject, {\n            dataProjection: \"EPSG:4326\",\n            featureProjection: mapProj\n        }\n    );\n\n    // 3. Ajout du trac de l'itinraire (geoJSON) comme nouvelle couche vecteur  la carte\n    this._geojsonSections = new ol.layer.Vector({\n        source: new ol.source.Vector({\n            features: features\n        }),\n        style: style,\n        opacity: 0.9\n    });\n\n    var graph;\n    if (this._currentTransport === \"Pieton\") {\n        graph = \"piton\";\n        this._geojsonSections.gpResultLayerId = \"Pieton$OGC:OPENLS;Itineraire\";\n    } else {\n        graph = \"voiture\";\n        this._geojsonSections.gpResultLayerId = \"Voiture$OGC:OPENLS;Itineraire\";\n    }\n    // ajout  la carte\n    map.addLayer(this._geojsonSections);\n\n    // 4. Si un layer switcher est prsent dans la carte, on lui affecte des informations pour cette couche\n    map.getControls().forEach(\n        function(control) {\n            if (control instanceof LayerSwitcher) {\n                // un layer switcher est prsent dans la carte\n                var layerId = this._geojsonSections.gpLayerId;\n                // on n'ajoute des informations que s'il n'y en a pas dj (si le titre est le numro par dfaut)\n                if (control._layers[layerId].title === layerId) {\n                    control.addLayer(\n                        this._geojsonSections, {\n                            title: \" Itinraire \" + graph,\n                            description: \" Itinraire bas sur un graphe \" + graph\n                        }\n                    );\n                }\n            }\n        },\n        this\n    );\n\n    // 5. Ajout de popups aux troncons\n    // Cration de l'interaction : survol des features (=troncons de l'itinraire)\n    this._resultsHoverInteraction = new ol.interaction.Select({\n        condition: ol.events.condition.pointerMove,\n        layers: [this._geojsonSections],\n        style: this._selectedFeatureStyle\n    });\n    this._resultsHoverInteraction.on(\n        \"select\",\n        this._onResultsFeatureMouseOver,\n        this\n    );\n    map.addInteraction(this._resultsHoverInteraction);\n\n    // Cration de l'interaction : selection des features (=troncons de l'itinraire)\n    this._resultsSelectInteraction = new ol.interaction.Select({\n        layers: [this._geojsonSections],\n        style: this._selectedFeatureStyle\n    });\n    this._resultsSelectInteraction.on(\n        \"select\",\n        this._onResultsFeatureSelect,\n        this\n    );\n    map.addInteraction(this._resultsSelectInteraction);\n\n};\n\n/**\n * this method is called on route features hover\n * and highlight instruction label\n *\n * @private\n */\nRoute.prototype._onResultsFeatureMouseOver = function(e) {\n\n    if (e.selected.length !== 0) {\n        // si on a bien survol un tronon, on surligne l'instruction correspondante\n        var f = e.selected[0];\n        var selectedInstruction = document.getElementById(\"GProuteResultsDetailsInstruction_\" + f.getId() + \"-\" + this._uid);\n        if (selectedInstruction && selectedInstruction.classList) {\n            selectedInstruction.classList.add(\"GProuteResultsDetailsInstructionHighlight\");\n        }\n    }\n\n    // si on dselectionne un tronon (mouseout), on rtablit un style normal pour l'instruction\n    if (e.deselected.length !== 0) {\n        var deselectedFeature = e.deselected[0];\n        // on repasse l'instruction correspondante en normal\n        var deSelectedInstruction = document.getElementById(\"GProuteResultsDetailsInstruction_\" + deselectedFeature.getId() + \"-\" + this._uid);\n        if (deSelectedInstruction && deSelectedInstruction.classList) {\n            deSelectedInstruction.classList.remove(\"GProuteResultsDetailsInstructionHighlight\");\n        }\n    }\n\n};\n\n/**\n * this method is called on route features select\n * and set a popup with feature information\n *\n * @param {Object} e - on select event\n * @private\n */\nRoute.prototype._onResultsFeatureSelect = function(e) {\n    var map = this.getMap();\n    if (e.selected.length !== 0) {\n        // si on a slectionn un troncon, on lui ajoute une popup\n        var f = e.selected[0];\n        this._popupContent.innerHTML = f.getProperties().popupContent;\n\n        if (!this._popupOverlay) {\n            // ajout de la popup a la carte comme un overlay\n            this._popupOverlay = new ol.Overlay({\n                element: this._popupDiv,\n                positioning: \"bottom-center\",\n                position: e.mapBrowserEvent.coordinate\n            });\n            map.addOverlay(this._popupOverlay);\n\n        } else {\n            // si l'overlay est dj cr, on modifie juste sa position\n            this._popupOverlay.setPosition(e.mapBrowserEvent.coordinate);\n        }\n\n    } else {\n        // si aucun troncon n'est slectionn (click  ct du trac),\n        // on fait disparaitre la popup si elle existe\n        if (this._popupOverlay != null) {\n            this._popupOverlay.setPosition(undefined);\n        }\n    }\n};\n\n// ################################################################### //\n// ############################# Clean ############################### //\n// ################################################################### //\n\n/**\n * this method is called by this.onShowRoutePanelClick()\n * and it clears all elements (reinit).\n *\n * @private\n */\nRoute.prototype._clear = function() {\n\n    this._currentTransport = null;\n    this._currentExclusions = [];\n    this._currentComputation = null;\n\n    // les resultats\n    this._clearRouteResultsDetails();\n    // la geometrie\n    this._clearRouteResultsGeometry();\n    this._clearRouteResultsFeatureGeometry();\n    // les points\n    for (var i = 0; i < this._currentPoints.length; i++) {\n        this._currentPoints[i].clear();\n    }\n    // suppression des points intermdiaires\n    this._removeRouteStepLocations();\n};\n\n/**\n * this method is called by this.onRouteResetClick()\n * and it clears all options inputs (reinit).\n *\n * @private\n */\nRoute.prototype._clearRouteInputOptions = function() {\n\n    // reinit options to default\n    this._initTransport();\n    this._initComputation();\n    this._initExclusions();\n\n    // set transport mode to default\n    var transportdiv;\n    if (this._currentTransport === \"Pieton\") {\n        transportdiv = document.getElementById(\"GProuteTransportPedestrian-\" + this._uid);\n        if (transportdiv) {\n            transportdiv.checked = \"true\";\n        }\n    } else {\n        transportdiv = document.getElementById(\"GProuteTransportCar-\" + this._uid);\n        if (transportdiv) {\n            transportdiv.checked = \"true\";\n        }\n    }\n\n    // set computation mode to default\n    var computationdiv = document.getElementById(\"GProuteComputationSelect-\" + this._uid);\n    if (computationdiv) {\n        computationdiv.value = this._currentComputation;\n    }\n\n    // set exclusions to default\n    var tollInput = document.getElementById(\"GProuteExclusionsToll-\" + this._uid);\n    if (tollInput) {\n        if (this._currentExclusions.indexOf(\"toll\") !== -1) {\n            tollInput.checked = false;\n        } else {\n            tollInput.checked = true;\n        }\n    }\n\n    var tunnelInput = document.getElementById(\"GProuteExclusionsTunnel-\" + this._uid);\n    if (tunnelInput) {\n        if (this._currentExclusions.indexOf(\"tunnel\") !== -1) {\n            tunnelInput.checked = false;\n        } else {\n            tunnelInput.checked = true;\n        }\n    }\n\n    var bridgeInput = document.getElementById(\"GProuteExclusionsBridge-\" + this._uid);\n    if (bridgeInput) {\n        if (this._currentExclusions.indexOf(\"bridge\") !== -1 && bridgeInput) {\n            bridgeInput.checked = false;\n        } else {\n            bridgeInput.checked = true;\n        }\n    }\n};\n\n/**\n * this method is called by this._clear()\n * and it removes step location inputs (excepted departure and arrival)\n *\n * @private\n */\nRoute.prototype._removeRouteStepLocations = function() {\n    var points = document.querySelectorAll(\"div[id^=\\\"GPlocationPoint\\\"]\");\n    var stepPoints = 0;\n    if (points.length !== 0) {\n        // on boucle sur les points intermdiaires\n        for (var i = 1; i < (points.length - 1); i++) {\n            // on va regarder les classes associes\n            var classList = points[i].classList;\n            if (classList.length !== 0) {\n                for (var j = 0; j < classList.length; j++) {\n                    if (classList[j] === \"GPlocationStageFlexInput\") {\n                        // si l'lment est visible, on le supprime en simulant un clic sur la croix (x)\n                        document.getElementById(this._addUID(\"GPlocationStageRemove_\" + (i + 1))).click();\n                        stepPoints += 1;\n                    }\n                }\n            }\n        }\n    }\n};\n\n/**\n * this method is called by this.onRouteComputationSubmit() (in case of failure)\n * and it clears all route instructions.\n *\n * @private\n */\nRoute.prototype._clearRouteResultsDetails = function() {\n\n    this._currentRouteInformations = null;\n\n    // doit on nettoyer le container \"GProuteResultsDetails\" ?\n    // il sera de toute faon cras par la prochaine requte...\n    if (this._resultsRouteDetailsContainer) {\n        var detailsDiv = this._resultsRouteDetailsContainer;\n        if (detailsDiv.childElementCount) {\n            while (detailsDiv.firstChild) {\n                detailsDiv.removeChild(detailsDiv.firstChild);\n            }\n        }\n    }\n\n    if (this._resultsRouteValuesContainer) {\n        var valuesDiv = this._resultsRouteValuesContainer;\n        if (valuesDiv.childElementCount) {\n            while (valuesDiv.firstChild) {\n                valuesDiv.removeChild(valuesDiv.firstChild);\n            }\n        }\n    }\n};\n\n/**\n * this method is called by this.onRouteComputationSubmit()\n * and it clears all route geometries.\n *\n * @private\n */\nRoute.prototype._clearRouteResultsGeometry = function() {\n    var map = this.getMap();\n\n    if (this._geojsonRoute != null) {\n        map.removeLayer(this._geojsonRoute);\n        this._geojsonRoute = null;\n    }\n};\n\n/**\n * this method is called by this.onRouteComputationSubmit()\n * and it clears all route geometries.\n *\n * @private\n */\nRoute.prototype._clearRouteResultsFeatureGeometry = function() {\n\n    var map = this.getMap();\n\n    // on retire la couche itinraire de la carte\n    if (this._geojsonSections != null) {\n        map.removeLayer(this._geojsonSections);\n        this._geojsonSections = null;\n    }\n    // on retire l'overlay de la popup de la carte\n    if (this._popupOverlay != null) {\n        map.removeOverlay(this._popupOverlay);\n        this._popupOverlay = null;\n    }\n    // et les interactions lies  cette couche\n    if (this._resultsSelectInteraction != null) {\n        map.removeInteraction(this._resultsSelectInteraction);\n        this._resultsSelectInteraction = null;\n    }\n    if (this._resultsHoverInteraction != null) {\n        map.removeInteraction(this._resultsHoverInteraction);\n        this._resultsHoverInteraction = null;\n    }\n};\n\n/**\n * this method is called by event 'click' on control main container\n * and hide suggested Locations (unless target is an autocomplete input)\n *\n * @private\n */\nRoute.prototype._hideRouteSuggestedLocations = function(e) {\n    // si on clique sur un input de saisie de locationSelector\n    if (e.target && e.target.id && e.target.id.indexOf(\"GPlocationOrigin_\") !== -1) {\n        // on rcupre le numro du point\n        var pointId = parseInt(e.target.id.split(\"_\")[1][0], 10) - 1;\n        // et on cache les autres rsultats d'autocompltion (sauf celui sur lequel on clique)\n        for (var j = 0; j < this._currentPoints.length; j++) {\n            if (j !== parseInt(pointId, 10)) {\n                this._currentPoints[j]._hideSuggestedLocation();\n            }\n        }\n    } else {\n        // si on clique ailleurs dans le DOM du control, on cache tous les rsultats d'autocompltion\n        for (var i = 0; i < this._currentPoints.length; i++) {\n            this._currentPoints[i]._hideSuggestedLocation();\n        }\n    }\n};\n\n/**\n * this method displays waiting container and sets a timeout\n *\n * @private\n */\nRoute.prototype._displayWaitingContainer = function() {\n\n    this._waitingContainer.className = \"GProuteCalcWaitingContainerVisible\";\n    this._waiting = true;\n\n    // mise en place d'un timeout pour rinitialiser le panel (cacher la patience)\n    // si on est toujours en attente (si la requte est bloque par exemple)\n    // ceci est vrai, uniquement sur le protocole JSONP !\n    var opts = this.options.routeOptions;\n    if (opts && opts.timeOut) {\n        if (this._timer) {\n            clearTimeout(this._timer);\n            this._timer = null;\n        }\n        var context = this;\n        this._timer = setTimeout(function() {\n            if (context._waiting === true) {\n                context._hideWaitingContainer();\n            } else {\n                if (context._timer) {\n                    clearTimeout(context._timer);\n                }\n            }\n        }, 16000);\n    }\n};\n\n/**\n * this method hides waiting container and clears timeout\n *\n * @private\n */\nRoute.prototype._hideWaitingContainer = function() {\n    if (this._waiting) {\n        this._waitingContainer.className = \"GProuteCalcWaitingContainerHidden\";\n        this._waiting = false;\n        var opts = this.options.routeOptions;\n        if (opts && opts.timeOut) {\n            clearTimeout(this._timer);\n            this._timer = null;\n        }\n    }\n};\n\n// ################################################################### //\n// ########################## Geometry ############################### //\n// ################################################################### //\n\n/**\n * simplified instructions\n *\n * @private\n */\nRoute.prototype._simplifiedInstructions = function(instructions) {\n\n    var newInstructions = [];\n\n    // cas o...\n    var current = instructions[0];\n    if (instructions.length === 1) {\n        newInstructions.push(current);\n    }\n\n    for (var i = 1; i < instructions.length; i++) {\n        var o = instructions[i];\n        if (o.instruction === current.instruction) {\n            current.distance = (parseFloat(o.distance) + parseFloat(current.distance)).toString();\n            current.duration = (parseFloat(o.duration) + parseFloat(current.duration)).toString();\n            for (var j = 1; j < o.geometry.coordinates.length; j++) {\n                current.geometry.coordinates.push(o.geometry.coordinates[j]);\n            }\n        } else {\n            newInstructions.push(current);\n            current = o;\n            // last\n            if (i === instructions.length - 1) {\n                newInstructions.push(o);\n                current = null;\n            }\n        }\n    }\n    logger.log(newInstructions);\n    return newInstructions;\n};\n\n// ################################################################### //\n// ################# Utils for Distance/Duration ##################### //\n// ################################################################### //\n\n/**\n * convert seconds to time : HH:MM:SS\n *\n * @private\n */\nRoute.prototype._convertSecondsToTime = function(duration) {\n    var time = \"\";\n\n    duration = Math.round(duration);\n    var hours = Math.floor(duration / (60 * 60));\n\n    var divisor4minutes = duration % (60 * 60);\n    var minutes = Math.floor(divisor4minutes / 60);\n    // if (!minutes) {\n    //     minutes = \"00\";\n    // }\n\n    // var divisor4seconds = divisor4minutes % 60;\n    // var seconds = Math.ceil(divisor4seconds);\n    // if (!seconds) {\n    //     seconds = \"00\";\n    // }\n\n    if (hours) {\n        time = hours + \"h \";\n    }\n    time += minutes + \" min\";\n    return time;\n};\n\n/**\n * convert distance in meters or kilometers\n *\n * @private\n */\nRoute.prototype._convertDistance = function(distance) {\n    var d = \"\";\n\n    var distanceKm = parseInt(distance / 1000, 10);\n    if (!distanceKm) {\n        d = parseInt(distance, 10) + \" m\"; // arrondi !\n    } else {\n        d = distanceKm + \" km\";\n    }\n\n    return d;\n};\n\nexport default Route;\n\n\n\n// WEBPACK FOOTER //\n// ./src/OpenLayers/Controls/Route.js","import ID from \"../Utils/SelectorID\";\n\nvar LocationSelectorDOM = {\n\n    /** Add uuid to the tag ID */\n    _addUID: function(id) {\n        var uid = (this._uid) ? id + \"-\" + this._uid : id;\n        return uid;\n    },\n\n    /**\n     * Main container (DOM)\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createMainContainerElement: function() {\n\n        var container = document.createElement(\"div\");\n        container.className = this._addUID(\"GPlocationPoint\"); // ceci permet de gerer les groupes de points !\n        container.className += \" GPwidget\";\n        return container;\n    },\n\n    /**\n     * Create Container Point\n     * see event !\n     *\n     * @param {Number} id - tag ID\n     * @param {Number} display  - display\n     * @returns {DOMElement} DOM element\n     */\n    _createLocationPointElement: function(id, display) {\n\n        var div = document.createElement(\"div\");\n        div.id = this._addUID(\"GPlocationPoint_\" + id);\n        div.className = (display) ? \"GPflexInput GPlocationStageFlexInput\" : \"GPflexInput GPlocationStageFlexInputHidden\";\n        div.style.cssText = \"\";\n\n        return div;\n    },\n\n    /**\n     * Create Container Point\n     * see event !\n     *\n     * @param {Number} id - tag ID\n     * @param {String} text - label\n     * @returns {DOMElement} DOM element\n     */\n    _createLocationPointLabelElement: function(id, text) {\n\n        // contexte d'execution\n        var self = this;\n\n        var labelOrigin = document.createElement(\"label\");\n        labelOrigin.id = this._addUID(\"GPlocationOriginLabel_\" + id);\n        labelOrigin.htmlFor = \"GPlocationOrigin_\" + id;\n        labelOrigin.innerHTML = text;\n        labelOrigin.addEventListener(\"click\", function(e) {\n\n            var i = ID.index(this.id);\n            var points = document.getElementsByClassName(self._addUID(\"GPlocationPoint\"));\n            for (var j = 0; j < points.length; j++) {\n                var tag = points[j].childNodes[0].id;\n                var id = ID.index(tag);\n                document.getElementById(self._addUID(\"GPlocationPoint_\" + id)).style.cssText = \"\";\n            }\n            document.getElementById(self._addUID(\"GPlocationOriginCoords_\" + i)).value = \"\";\n            document.getElementById(self._addUID(\"GPlocationOrigin_\" + i)).value = \"\";\n            document.getElementById(self._addUID(\"GPlocationPoint_\" + i)).style.cssText = \"\";\n            document.getElementById(self._addUID(\"GPlocationOriginPointer_\" + i)).checked = false;\n            document.getElementById(self._addUID(\"GPlocationOrigin_\" + i)).className = \"GPlocationOriginVisible\";\n            document.getElementById(self._addUID(\"GPlocationOriginCoords_\" + i)).className = \"GPlocationOriginHidden\";\n            if (document.getElementById(self._addUID(\"GPlocationStageRemove_\" + i))) {\n                document.getElementById(self._addUID(\"GPlocationStageRemove_\" + i)).className = \"GPlocationStageRemove\";\n            }\n            if (document.getElementById(self._addUID(\"GPlocationStageAdd\"))) {\n                document.getElementById(self._addUID(\"GPlocationStageAdd\")).className = \"\";\n            }\n            // document.getElementById(self._addUID(\"GPlocationOriginCoords_\" + i)).disabled = true;\n            self.onLocationClearPointClick(e);\n        });\n\n        return labelOrigin;\n    },\n\n    /**\n     * Create Input AutoComplete Point tag\n     *\n     * @param {Number} id - tag ID\n     * @returns {DOMElement} DOM element\n     */\n    _createLocationAutoCompleteteInputElement: function(id) {\n\n        // contexte d'execution\n        var self = this;\n\n        var inputOrigin = document.createElement(\"input\");\n        inputOrigin.id = this._addUID(\"GPlocationOrigin_\" + id);\n        inputOrigin.className = \"GPlocationOriginVisible\";\n        inputOrigin.type = \"text\";\n        inputOrigin.placeholder = \"Saisir une adresse\";\n        inputOrigin.autocomplete = \"off\";\n        inputOrigin.addEventListener(\"keyup\", function(e) {\n            var charCode = e.which || e.keyCode;\n            if (charCode === 13 || charCode === 10 || charCode === 38 || charCode === 40) {\n                return;\n            }\n\n            var i = ID.index(this.id);\n            if (document.getElementById(self._addUID(\"GPlocationOrigin_\" + i)).value.length > 2) {\n                document.getElementById(self._addUID(\"GPlocationAutoCompleteList_\" + i)).style.display = \"block\";\n            } else {\n                document.getElementById(self._addUID(\"GPlocationAutoCompleteList_\" + i)).style.display = \"none\";\n            }\n            // gestionnaire d'evenement :\n            // on rcupre la valeur de saisie pour une requte sur le service d'autocompletion.\n            // le resultat de la requte nous permet de recuperer les coordonnes du point...\n            self.onAutoCompleteSearchText(e);\n        });\n\n        inputOrigin.addEventListener(\"keydown\", function(e) {\n            var charCode = e.which || e.keyCode;\n\n            var container = document.getElementById(self._addUID(\"GPlocationAutoCompleteList_\" + id));\n\n            // si aucun container !?\n            if (!container) {\n                return;\n            }\n\n            var curr = container.getElementsByClassName(\"GPautoCompleteProposal current\");\n            var list = container.getElementsByClassName(\"GPautoCompleteProposal\");\n\n            // si aucune suggestion, on ne va pas plus loin !\n            var length = list.length;\n            if (!length) {\n                return;\n            }\n\n            var current = null;\n\n            // si aucun item courant, on prend le 1er !\n            if (!curr.length) {\n                current = list[0];\n                current.className = \"GPautoCompleteProposal current\";\n                current.style.color = \"#000000\";\n                current.style[\"background-color\"] = \"#CEDBEF\";\n                return;\n            } else {\n                current = curr[0];\n            }\n\n            var index = parseInt(ID.index(current.id), 10);\n            var next = (index === length - 1) ? list[0] : list[index + 1];\n            var prev = (index === 0) ? list[length - 1] : list[index - 1];\n\n            current.style[\"background-color\"] = \"\";\n            current.style.color = \"\";\n            prev.style[\"background-color\"] = \"\";\n            prev.style.color = \"\";\n            next.style[\"background-color\"] = \"\";\n            next.style.color = \"\";\n\n            switch (charCode) {\n                case 38: // arrow up\n                    console.log(\"arrow up\");\n                    current.className = \"GPautoCompleteProposal\";\n                    prev.className = \"GPautoCompleteProposal current\";\n                    prev.style.color = \"#000000\";\n                    prev.style[\"background-color\"] = \"#CEDBEF\";\n                    break;\n                case 40: // arrow down\n                    console.log(\"arrow down\");\n                    current.className = \"GPautoCompleteProposal\";\n                    next.className = \"GPautoCompleteProposal current\";\n                    next.style.color = \"#000000\";\n                    next.style[\"background-color\"] = \"#CEDBEF\";\n                    break;\n                case 13: // enter\n                    console.log(\"enter\");\n                    current.click(e);\n                    break;\n            }\n\n            current.focus();\n        });\n\n        return inputOrigin;\n    },\n\n    /**\n     * Create Input Coordinate Point tag\n     *\n     * @param {Number} id - tag ID\n     * @returns {DOMElement} DOM element\n     */\n    _createLocationCoordinateInputElement: function(id) {\n\n        // contexte d'execution\n        var self = this;\n\n        var inputOriginCoord = document.createElement(\"input\");\n        inputOriginCoord.id = this._addUID(\"GPlocationOriginCoords_\" + id);\n        inputOriginCoord.className = \"GPlocationOriginHidden\";\n        inputOriginCoord.type = \"text\";\n        inputOriginCoord.disabled = false;\n        inputOriginCoord.addEventListener(\"click\", function() {\n            var i = ID.index(this.id);\n            document.getElementById(self._addUID(\"GPlocationOriginLabel_\" + i)).click();\n        });\n        return inputOriginCoord;\n    },\n\n    /**\n     * Create Show Pointer tag\n     *\n     * @param {Number} id - tag ID\n     * @returns {DOMElement} DOM element\n     */\n    _createLocationPointerShowInputElement: function(id) {\n\n        var inputOriginPointer = document.createElement(\"input\");\n        inputOriginPointer.id = this._addUID(\"GPlocationOriginPointer_\" + id);\n        inputOriginPointer.type = \"checkbox\";\n        return inputOriginPointer;\n    },\n\n    /**\n     * Create Input Pointer tag\n     *\n     * @param {Number} id - tag ID\n     * @returns {DOMElement} DOM element\n     */\n    _createLocationPointerInputElement: function(id) {\n\n        // contexte d'execution\n        var self = this;\n\n        var labelOriginPointer = document.createElement(\"label\");\n        labelOriginPointer.id = this._addUID(\"GPlocationOriginPointerImg_\" + id);\n        labelOriginPointer.htmlFor = \"GPlocationOriginPointer_\" + id;\n        labelOriginPointer.className = \"GPlocationOriginPointerImg\";\n        labelOriginPointer.title = \"Pointer un lieu sur la carte\";\n        labelOriginPointer.addEventListener(\"click\", function(e) {\n            e.preventDefault();\n            e.stopPropagation();\n            var i = ID.index(this.id);\n            var points = document.getElementsByClassName(self._addUID(\"GPlocationPoint\"));\n            var j;\n            var tag;\n            var id;\n            for (j = 0; j < points.length; j++) {\n                tag = points[j].childNodes[0].id;\n                id = ID.index(tag);\n                if (i != id) {\n                    document.getElementById(self._addUID(\"GPlocationOriginPointer_\" + id)).checked = false;\n                    if (document.getElementById(self._addUID(\"GPlocationOriginCoords_\" + id)).value == \"Pointer un lieu sur la carte\") {\n                        document.getElementById(self._addUID(\"GPlocationOriginCoords_\" + id)).value = \"\";\n                        document.getElementById(self._addUID(\"GPlocationOrigin_\" + id)).className = \"GPlocationOriginVisible\";\n                        document.getElementById(self._addUID(\"GPlocationOriginCoords_\" + id)).className = \"GPlocationOriginHidden\";\n                    }\n                }\n            }\n            if (document.getElementById(self._addUID(\"GPlocationOriginPointer_\" + i)).checked) {\n                document.getElementById(self._addUID(\"GPlocationOriginCoords_\" + i)).value = \"\";\n                for (j = 0; j < points.length; j++) {\n                    tag = points[j].childNodes[0].id;\n                    id = ID.index(tag);\n                    document.getElementById(self._addUID(\"GPlocationPoint_\" + id)).style.cssText = \"\";\n                }\n                if (document.getElementById(self._addUID(\"GPlocationStageRemove_\" + i))) {\n                    document.getElementById(self._addUID(\"GPlocationStageRemove_\" + i)).className = \"GPlocationStageRemove\";\n                }\n                if (document.getElementById(self._addUID(\"GPlocationStageAdd\"))) {\n                    document.getElementById(self._addUID(\"GPlocationStageAdd\")).className = \"\";\n                }\n                document.getElementById(self._addUID(\"GPlocationOriginPointer_\" + i)).checked = false;\n                document.getElementById(self._addUID(\"GPlocationOrigin_\" + i)).className = \"GPlocationOriginVisible\";\n                document.getElementById(self._addUID(\"GPlocationOriginCoords_\" + i)).className = \"GPlocationOriginHidden\";\n            } else {\n                document.getElementById(self._addUID(\"GPlocationOriginCoords_\" + i)).value = \"Pointer un lieu sur la carte\";\n                for (j = 0; j < points.length; j++) {\n                    tag = points[j].childNodes[0].id;\n                    id = ID.index(tag);\n                    if (i == id) {\n                        document.getElementById(self._addUID(\"GPlocationPoint_\" + id)).style.cssText = \"\";\n                    } else {\n                        document.getElementById(self._addUID(\"GPlocationPoint_\" + id)).style.display = \"none\";\n                    }\n                }\n                if (document.getElementById(self._addUID(\"GPlocationStageRemove_\" + i))) {\n                    document.getElementById(self._addUID(\"GPlocationStageRemove_\" + i)).className = \"GPlocationOriginHidden\";\n                }\n                if (document.getElementById(self._addUID(\"GPlocationStageAdd\"))) {\n                    document.getElementById(self._addUID(\"GPlocationStageAdd\")).className = \"GPlocationOriginHidden\";\n                }\n                document.getElementById(self._addUID(\"GPlocationOriginPointer_\" + i)).checked = true;\n                document.getElementById(self._addUID(\"GPlocationOrigin_\" + i)).className = \"GPlocationOriginHidden\";\n                document.getElementById(self._addUID(\"GPlocationOriginCoords_\" + i)).className = \"GPlocationOriginVisible\";\n                document.getElementById(self._addUID(\"GPlocationOriginCoords_\" + i)).disabled = true;\n            }\n            // gestionnaire d'evenement :\n            // on stocke la valeur du point, utilise pour la requte sur le service de calcul d'itiniraire\n            self.onActivateMapPointClick(e);\n        });\n\n        return labelOriginPointer;\n    },\n\n    /**\n     * Create Remove Point tag\n     * see event !\n     *\n     * @param {Number} id - tag ID\n     * @returns {DOMElement} DOM element\n     */\n    _createLocationRemovePointElement: function(id) {\n\n        // contexte d'execution\n        var self = this;\n\n        var divRm = document.createElement(\"div\");\n        divRm.id = this._addUID(\"GPlocationStageRemove_\" + id);\n        divRm.className = \"GPlocationStageRemove\";\n        divRm.title = \"Supprimer l'tape\";\n        divRm.addEventListener(\"click\", function(e) {\n\n            var points = document.getElementsByClassName(self._addUID(\"GPlocationPoint\"));\n            var last = points.length - 1;\n            var start = points[0].childNodes[0].id;\n            var end = points[last].childNodes[0].id;\n\n            var startID = ID.index(start);\n            var endID = ID.index(end);\n\n            if (id != startID && id != endID) {\n                var i = ID.index(this.id);\n                document.getElementById(self._addUID(\"GPlocationPoint_\" + i)).className = \"GPflexInput GPlocationStageFlexInputHidden\";\n                document.getElementById(self._addUID(\"GPlocationOrigin_\" + i)).value = \"\";\n                document.getElementById(self._addUID(\"GPlocationOrigin_\" + i)).className = \"GPlocationOriginVisible\";\n                document.getElementById(self._addUID(\"GPlocationOriginCoords_\" + i)).value = \"\";\n                document.getElementById(self._addUID(\"GPlocationOriginCoords_\" + i)).className = \"GPlocationOriginHidden\";\n                document.getElementById(self._addUID(\"GPlocationStageAdd\")).style.display = \"\";\n                // Moving up exclusions picto\n                // var exclusionsPictoTop = document.getElementById(self._addUID(\"GPshowLocationExclusionsPicto\")).style.top;\n                // document.getElementById(self._addUID(\"GPshowLocationExclusionsPicto\")).style.top = (parseInt(exclusionsPictoTop) - 33).toString() + \"px\";\n\n                // gestionnaire d'evenement :\n                // on supprime le point, utilis pour la requte sur le service d'itiniraire\n                self.onLocationRemovePointClick(e);\n            }\n        });\n\n        return divRm;\n    },\n\n    /**\n     * Create Add Point tag\n     * see event !\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createLocationAddPointElement: function() {\n\n        // contexte d'execution\n        var self = this;\n\n        var divAdd = document.createElement(\"div\");\n        divAdd.id = this._addUID(\"GPlocationStageAdd\");\n        divAdd.title = \"Ajouter une tape\";\n        divAdd.addEventListener(\"click\", function(e) {\n\n            var lastStage = 1;\n            var nbStages = 0;\n            var points = document.getElementsByClassName(self._addUID(\"GPlocationPoint\"));\n            for (var i = 1; i < points.length - 1; i++) {\n                var tag = points[i].childNodes[0].id;\n                var id = ID.index(tag);\n                if (document.getElementById(self._addUID(\"GPlocationPoint_\" + id))) {\n                    if (document.getElementById(self._addUID(\"GPlocationPoint_\" + id)).className == \"GPflexInput GPlocationStageFlexInputHidden\") {\n                        if (lastStage == 1) {\n                            lastStage = id;\n                        }\n                    } else {\n                        nbStages++;\n                    }\n                }\n            }\n            // FIXME algo  revoir : lastStage = id hors si id = 300 sur 3 points !?\n            if (lastStage < points.length) {\n                document.getElementById(self._addUID(\"GPlocationPoint_\" + lastStage)).className = \"GPflexInput GPlocationStageFlexInput\";\n                // Moving down exclusions picto\n                // var exclusionsPictoTop = document.getElementById(self._addUID(\"GPshowLocationExclusionsPicto\")).style.top;\n                // document.getElementById(self._addUID(\"GPshowLocationExclusionsPicto\")).style.top = (parseInt(exclusionsPictoTop) + 33).toString() + \"px\";\n            }\n            if (nbStages == 4) {\n                document.getElementById(self._addUID(\"GPlocationStageAdd\")).style.display = \"none\";\n            }\n            // gestionnaire d'evenement :\n            // on ajoute le point, utilis pour la requte sur le service d'itiniraire\n            self.onLocationAddPointClick(e);\n        });\n\n        return divAdd;\n    },\n\n    /**\n     * Create Results autocompletion to the point\n     * see event!\n     *\n     * @param {Number} id - tag ID\n     * @returns {DOMElement} DOM element\n     */\n    _createLocationAutoCompleteResultElement: function(id) {\n\n        // contexte d'execution\n        var self = this;\n\n        var div = document.createElement(\"div\");\n        div.id = this._addUID(\"GPlocationAutoCompleteList_\" + id);\n        div.className = \"GPadvancedAutoCompleteList\";\n\n        if (div.addEventListener) {\n            div.addEventListener(\"click\", function(e) {\n                self.onAutoCompletedResultsItemClick(e);\n                document.getElementById(self._addUID(\"GPlocationAutoCompleteList_\" + id)).style.display = \"none\";\n            }, false);\n        } else if (div.attachEvent) {\n            div.attachEvent(\"onclick\", function(e) {\n                self.onAutoCompletedResultsItemClick(e);\n                document.getElementById(self._addUID(\"GPlocationAutoCompleteList_\" + id)).style.display = \"none\";\n            });\n        }\n\n        return div;\n    },\n\n    /**\n     * Autocompletion result to a point.\n     * Proposals are dynamically filled in Javascript by autocomplete service\n     *\n     * TODO formaliser le contenu des reponse\n     *\n     * @param {Number} id - tag ID\n     * @param {Object} location - suggested location result\n     * @param {Number} n  - number of the point\n     */\n    _createLocationAutoCompletedLocationElement: function(id, location, n) {\n        var container = document.getElementById(this._addUID(\"GPlocationAutoCompleteList_\" + id));\n\n        var div = document.createElement(\"div\");\n        div.id = this._addUID(\"AutoCompletedLocation_\" + n);\n        div.className = \"GPautoCompleteProposal\";\n        div.innerHTML = location.fullText;\n\n        container.appendChild(div);\n    },\n\n    /** ... */\n    GPdisplayCoordinate: function(value) {\n\n        var points = document.getElementsByClassName(this._addUID(\"GPlocationPoint\"));\n        for (var i = 0; i < points.length; i++) {\n            var tag = points[i].childNodes[0].id;\n            var id1 = ID.index(tag);\n            if (document.getElementById(this._addUID(\"GPlocationOriginPointer_\" + id1)).checked) {\n                document.getElementById(this._addUID(\"GPlocationOriginCoords_\" + id1)).value = value;\n                document.getElementById(this._addUID(\"GPlocationOriginCoords_\" + id1)).disabled = false;\n                for (var j = 0; j < points.length; j++) {\n                    tag = points[j].childNodes[0].id;\n                    var id2 = ID.index(tag);\n                    document.getElementById(this._addUID(\"GPlocationPoint_\" + id2)).style.cssText = \"\";\n                    if (document.getElementById(this._addUID(\"GPlocationStageRemove_\" + id2))) {\n                        document.getElementById(this._addUID(\"GPlocationStageRemove_\" + id2)).className = \"GPlocationStageRemove\";\n                    }\n                }\n                document.getElementById(this._addUID(\"GPlocationOriginPointer_\" + id1)).checked = false;\n                if (document.getElementById(this._addUID(\"GPlocationStageAdd\"))) {\n                    document.getElementById(this._addUID(\"GPlocationStageAdd\")).className = \"\";\n                }\n                return;\n            }\n        }\n    }\n};\n\nexport default LocationSelectorDOM;\n\n\n\n// WEBPACK FOOTER //\n// ./src/Common/Controls/LocationSelectorDOM.js","/**\n * desativation JSHINT\n * W083 - Don't make functions within a loop.\n */\n\nimport ID from \"../Utils/SelectorID\";\n\nvar RouteDOM = {\n\n    /** Add uuid to the tag ID */\n    _addUID: function(id) {\n        var uid = (this._uid) ? id + \"-\" + this._uid : id;\n        return uid;\n    },\n\n    /**\n     * Main container (DOM)\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createMainContainerElement: function() {\n\n        var container = document.createElement(\"div\");\n        container.id = this._addUID(\"GProute\");\n        container.className = \"GPwidget\";\n        return container;\n    },\n\n    // ################################################################### //\n    // ################# Methods to display Main Panel ################### //\n    // ################################################################### //\n\n    /**\n     * Hidden checkbox for minimizing/maximizing panel\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createShowRouteElement: function() {\n        var input = document.createElement(\"input\");\n        input.id = this._addUID(\"GPshowRoute\");\n        input.type = \"checkbox\";\n        return input;\n    },\n\n    /**\n     * Show route control\n     * see event !\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createShowRoutePictoElement: function() {\n\n        // contexte d'execution\n        var context = this;\n\n        var label = document.createElement(\"label\");\n        label.id = this._addUID(\"GPshowRoutePicto\");\n        label.className = \"GPshowAdvancedToolPicto\";\n        label.htmlFor = this._addUID(\"GPshowRoute\");\n        label.title = \"Ouvrir le calcul d'itinraire\";\n\n        // gestionnaire d'evenement :\n        // on ouvre le menu de saisie du calcul d'itiniraire\n        // L'ouverture/Fermeture permet de faire le menage\n        // (reinitialisation)\n        if (label.addEventListener) {\n            label.addEventListener(\"click\", function(e) {\n                context.onShowRoutePanelClick(e);\n            });\n        } else if (label.attachEvent) {\n            label.attachEvent(\"onclick\", function(e) {\n                context.onShowRoutePanelClick(e);\n            });\n        }\n\n        var spanOpen = document.createElement(\"span\");\n        spanOpen.id = this._addUID(\"GPshowRouteOpen\");\n        spanOpen.className = \"GPshowAdvancedToolOpen\";\n        label.appendChild(spanOpen);\n\n        return label;\n    },\n\n    // ################################################################### //\n    // ################## Methods to display Inputs Panel ################ //\n    // ################################################################### //\n\n    /**\n     * Create Container Panel\n     *\n     * FIXME\n     * don't call this._createRoutePanelHeaderElement\n     * don't call this._createRoutePanelFormElement\n     * don't call this._createRoutePanelResultsElement\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createRoutePanelElement: function() {\n        var div = document.createElement(\"div\");\n        div.id = this._addUID(\"GProutePanel\");\n        div.className = \"GPpanel\";\n\n        // div.appendChild(this._createRoutePanelHeaderElement());\n        // div.appendChild(this._createRoutePanelFormElement());\n        // div.appendChild(this._createRoutePanelResultsElement());\n\n        return div;\n    },\n\n    /**\n     * Create Header Panel\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createRoutePanelHeaderElement: function() {\n\n        // contexte d'execution\n        var self = this;\n\n        var container = document.createElement(\"div\");\n        container.className = \"GPpanelHeader\";\n\n        var div = document.createElement(\"div\");\n        div.className = \"GPpanelTitle\";\n        div.innerHTML = \"Calcul d'itinraire\";\n        container.appendChild(div);\n\n        var divClose = document.createElement(\"div\");\n        divClose.id = this._addUID(\"GProutePanelClose\");\n        divClose.className = \"GPpanelClose\";\n        divClose.title = \"Masquer le panneau\";\n\n        // Link panel close / visibility checkbox\n        if (divClose.addEventListener) {\n            divClose.addEventListener(\"click\", function() {\n                document.getElementById(self._addUID(\"GPshowRoutePicto\")).click();\n            }, false);\n        } else if (divClose.attachEvent) {\n            divClose.attachEvent(\"onclick\", function() {\n                document.getElementById(self._addUID(\"GPshowRoutePicto\")).click();\n            });\n        }\n        container.appendChild(divClose);\n\n        return container;\n    },\n\n    /**\n     * Create Form\n     * see evenement !\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createRoutePanelFormElement: function() {\n\n        // contexte d'execution\n        var self = this;\n\n        var form = document.createElement(\"form\");\n        form.id = this._addUID(\"GProuteForm\");\n        form.setAttribute(\"onkeypress\", \"return event.keyCode != 13;\"); // FIXME hack pour desactiver l'execution via 'enter' au clavier !\n\n        form.addEventListener(\"submit\", function(e) {\n\n            console.log(e);\n            e.preventDefault();\n\n            // points\n            var points = document.getElementsByClassName(self._addUID(\"GPlocationPoint\"));\n\n            // Must have at least two origin points\n            var start = points[0].childNodes[0].id;\n            var end = points[points.length - 1].childNodes[0].id;\n            var startID = ID.index(start);\n            var endID = ID.index(end);\n\n            if ((document.getElementById(self._addUID(\"GPlocationOrigin_\" + startID)).value == \"\" &&\n                    document.getElementById(self._addUID(\"GPlocationOriginCoords_\" + startID)).value == \"\") ||\n                (document.getElementById(self._addUID(\"GPlocationOrigin_\" + endID)).value == \"\" &&\n                    document.getElementById(self._addUID(\"GPlocationOriginCoords_\" + endID)).value == \"\")) {\n                return false;\n            }\n\n            // Send stages to results panel\n            var id;\n            document.getElementById(self._addUID(\"GProuteResultsStages\")).innerHTML = \"\";\n            for (var i = 0; i < points.length; i++) {\n                var tag = points[i].childNodes[0].id;\n                id = ID.index(tag);\n                if (document.getElementById(self._addUID(\"GPlocationPoint_\" + id)).className == \"GPflexInput GPlocationStageFlexInput\") {\n                    var resultStage = document.createElement(\"div\");\n                    resultStage.className = \"GProuteResultsStages\";\n                    var resultStageLabel = document.createElement(\"div\");\n                    resultStageLabel.className = \"GProuteResultStageLabel\";\n                    resultStageLabel.innerHTML = document.getElementById(self._addUID(\"GPlocationOriginLabel_\" + id)).innerHTML + \" :\";\n                    resultStage.appendChild(resultStageLabel);\n                    var resultStageValue = document.createElement(\"div\");\n                    resultStageValue.className = \"GProuteResultStageValue\";\n                    var elementCoords = document.getElementById(self._addUID(\"GPlocationOriginCoords_\" + id));\n                    var stageCoords = elementCoords.value;\n                    var visible = (elementCoords.className === \"GPlocationOriginVisible\") ? true : false;\n                    if (stageCoords != null && stageCoords != \"\" && visible) {\n                        resultStageValue.innerHTML = stageCoords;\n                    } else {\n                        resultStageValue.innerHTML = document.getElementById(self._addUID(\"GPlocationOrigin_\" + id)).value;\n                    }\n                    resultStage.appendChild(resultStageValue);\n                    if (resultStageValue.innerHTML != \"\") {\n                        document.getElementById(self._addUID(\"GProuteResultsStages\")).appendChild(resultStage);\n                    }\n                }\n            }\n\n            // on peut rcuperer les valeurs utiles pour les transmettre au service d'iti...\n            // - le mode de calcul\n            // - le mode de transport\n            // - les exclusions\n            // Les points sont dj stocks dans l'application.\n\n            // computation mode params\n            var modeComputation = null;\n            if (document.getElementById(self._addUID(\"GProuteComputationSelect\"))) {\n                var select = document.getElementById(self._addUID(\"GProuteResultsComputationSelect\"));\n                select.selectedIndex = document.getElementById(self._addUID(\"GProuteComputationSelect\")).selectedIndex;\n                modeComputation = select.options[select.selectedIndex].value;\n            }\n\n            // transport mode params\n            var modeTransport = null;\n            // voiture ?\n            if (document.getElementById(self._addUID(\"GProuteTransportCar\"))) {\n                if (document.getElementById(self._addUID(\"GProuteTransportCar\")).checked) {\n                    modeTransport = document.getElementById(self._addUID(\"GProuteTransportCar\")).value;\n                }\n            }\n            // pieton ?\n            if (document.getElementById(self._addUID(\"GProuteTransportPedestrian\"))) {\n                if (document.getElementById(self._addUID(\"GProuteTransportPedestrian\")).checked) {\n                    modeTransport = document.getElementById(self._addUID(\"GProuteTransportPedestrian\")).value;\n                }\n            }\n\n            // exclusions params\n            var exclusions = [];\n            var exclusionsElement = document.getElementsByClassName(\"GProuteExclusionsOption\");\n            for (var j = 0; j < exclusionsElement.length; j++) {\n                id = exclusionsElement[j].htmlFor;\n                var el = document.getElementById(id);\n                if (!el.checked) {\n                    exclusions.push(el.value);\n                }\n            }\n\n            self.onRouteComputationSubmit({\n                computation: modeComputation,\n                transport: modeTransport,\n                exclusions: exclusions\n            });\n\n            // FIXME mise  jour du controle dans le composant JS !\n            // document.getElementById(self._addUID(\"GProuteForm\")).className = \"GProuteComponentHidden\";\n            // document.getElementById(self._addUID(\"GProuteResultsPanel\")).className = \"\";\n\n            return false;\n\n        });\n\n        return form;\n    },\n\n    /**\n     * Create Results Panel\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createRoutePanelResultsElement: function() {\n        var container = document.createElement(\"div\");\n        container.id = this._addUID(\"GProuteResultsPanel\");\n        container.className = \"GProuteComponentHidden\";\n\n        container.appendChild(this._createRouteResultsStagesElement());\n        container.appendChild(this._createRouteResultsElement());\n\n        var divBorderUp = document.createElement(\"div\");\n        divBorderUp.className = \"GPfakeBorder GPfakeBorderLeft\";\n        container.appendChild(divBorderUp);\n\n        container.appendChild(this._createRouteShowResultsDetailsElement());\n\n        var labelShow = document.createElement(\"label\");\n        labelShow.htmlFor = this._addUID(\"GProuteResultsShowDetails\");\n        labelShow.innerHTML = \"Afficher le dtail\";\n        container.appendChild(labelShow);\n\n        var labelHide = document.createElement(\"label\");\n        labelHide.htmlFor = this._addUID(\"GProuteResultsShowDetails\");\n        labelHide.innerHTML = \"Masquer le dtail\";\n        container.appendChild(labelHide);\n\n        var divBorderDown = document.createElement(\"div\");\n        divBorderDown.className = \"GPfakeBorder\";\n        container.appendChild(divBorderDown);\n\n        container.appendChild(this._createRouteResultsDetailsElement());\n\n        return container;\n    },\n\n    /**\n     * Create Waiting Panel\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createRouteWaitingElement: function() {\n        var div = document.createElement(\"div\");\n        div.id = this._addUID(\"GProuteCalcWaitingContainer\");\n        div.className = \"GProuteCalcWaitingContainerHidden\";\n\n        var p = document.createElement(\"p\");\n        p.className = \"GProuteCalcWaiting\";\n        p.innerHTML = \"Calcul en cours...\";\n\n        div.appendChild(p);\n\n        return div;\n    },\n    // ################################################################### //\n    // ############### Methods to the window results ##################### //\n    // ################################################################### //\n\n    /**\n     * Create Results Stages\n     * (results dynamically generate !)\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createRouteResultsStagesElement: function() {\n        var div = document.createElement(\"div\");\n        div.id = this._addUID(\"GProuteResultsStages\");\n        return div;\n    },\n\n    /**\n     * Create Show Results\n     * see event!\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createRouteResultsElement: function() {\n\n        // contexte\n        var self = this;\n\n        var container = document.createElement(\"div\");\n        container.id = this._addUID(\"GProuteResults\");\n\n        // FIXME Route results are dynamically filled in Javascript by route service\n        var divValue = document.createElement(\"div\");\n        divValue.id = this._addUID(\"GProuteResultsValues\");\n        container.appendChild(divValue);\n\n        var divMode = document.createElement(\"div\");\n        divMode.id = this._addUID(\"GProuteResultsMode\");\n\n        var select = document.createElement(\"select\");\n        select.id = this._addUID(\"GProuteResultsComputationSelect\");\n        select.className = \"GPinputSelect\";\n        // gestionnaire d'evenement :\n        // on stocke la valeur du mode de calcul, et on relance le calcul d'itiniraire\n        select.addEventListener(\"change\", function(e) {\n            self.onRouteModeComputationChangeAndRun(e);\n        });\n\n        var computes = [{\n            code: \"fastest\",\n            label: \"Plus rapide\"\n        }, {\n            code: \"shortest\",\n            label: \"Plus court\"\n        }];\n\n        for (var i = 0; i < computes.length; i++) {\n            var option = document.createElement(\"option\");\n            option.value = computes[i].code;\n            option.text = computes[i].label;\n            select.appendChild(option);\n        }\n        divMode.appendChild(select);\n        container.appendChild(divMode);\n\n        var divNew = document.createElement(\"div\");\n        divNew.id = this._addUID(\"GProuteResultsNew\");\n        divNew.title = \"Modifier le calcul\";\n        divNew.addEventListener(\"click\", function(e) {\n            document.getElementById(self._addUID(\"GProuteResultsPanel\")).className = \"GProuteComponentHidden\";\n            document.getElementById(self._addUID(\"GProuteForm\")).className = \"\";\n            self.onShowRouteResultsNewClick(e);\n        });\n        container.appendChild(divNew);\n\n        return container;\n    },\n\n    /**\n     * Add Results Duration and Distance\n     * (results dynamically generate !)\n     * see event!\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _addRouteResultsValuesElement: function(distance, duration, fconvert) {\n        var div = document.getElementById(this._addUID(\"GProuteResultsValues\"));\n\n        // clean !\n        if (div.childElementCount) {\n            while (div.firstChild) {\n                div.removeChild(div.firstChild);\n            }\n        }\n\n        var containerDistance = document.createElement(\"div\");\n        containerDistance.className = \"GProuteResultsValue\";\n\n        var labelDistance = document.createElement(\"label\");\n        labelDistance.className = \"GProuteResultsValueLabel\";\n        labelDistance.innerHTML = \"Distance :\";\n        containerDistance.appendChild(labelDistance);\n\n        var distanceLabel = 0;\n        var isKm = parseInt(distance / 1000, 10);\n\n        if (!isKm) {\n            distanceLabel = Math.round(distance) + \" m\";\n        } else {\n            var distanceArrondi = Math.round(distance);\n            distanceArrondi = distanceArrondi / 1000;\n            distanceLabel = distanceArrondi + \" km\";\n        }\n\n        var divDistance = document.createElement(\"div\");\n        divDistance.id = this._addUID(\"GProuteResultsValueDist\");\n        divDistance.innerHTML = distanceLabel;\n        containerDistance.appendChild(divDistance);\n\n        div.appendChild(containerDistance);\n\n        var containerDuration = document.createElement(\"div\");\n        containerDuration.className = \"GProuteResultsValue\";\n\n        var labelDuration = document.createElement(\"label\");\n        labelDuration.className = \"GProuteResultsValueLabel\";\n        labelDuration.innerHTML = \"Dure :\";\n        containerDuration.appendChild(labelDuration);\n\n        var divDuration = document.createElement(\"div\");\n        divDuration.id = this._addUID(\"GProuteResultsValueDist\");\n        divDuration.innerHTML = fconvert(duration);\n        containerDuration.appendChild(divDuration);\n\n        div.appendChild(containerDuration);\n\n        return div;\n    },\n\n    /**\n     * Create Show Results Details\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createRouteShowResultsDetailsElement: function() {\n        var input = document.createElement(\"input\");\n        input.id = this._addUID(\"GProuteResultsShowDetails\");\n        input.type = \"checkbox\";\n        return input;\n    },\n\n    /**\n     *  Create Results Details\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createRouteResultsDetailsElement: function() {\n        // <!-- Route results details are dynamically filled in Javascript by route service -->\n        var div = document.createElement(\"div\");\n        div.id = this._addUID(\"GProuteResultsDetails\");\n        return div;\n    },\n\n    /**\n     *  Add Results Details\n     * (results dynamically generate !)\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _addRouteResultsDetailsElement: function(instructions, fconvert) {\n\n        // contexte\n        var context = this;\n\n        var div = document.getElementById(this._addUID(\"GProuteResultsDetails\"));\n\n        // clean !\n        if (div.childElementCount) {\n            while (div.firstChild) {\n                div.removeChild(div.firstChild);\n            }\n        }\n\n        // calcul des valeurs cumul !\n        var distanceCumul = 0;\n        var durationCumul = 0;\n\n        /* jshint -W083 */\n        for (var i = 0; i < instructions.length; i++) {\n            var id = i + 1;\n\n            var o = instructions[i];\n\n            var divNum = document.createElement(\"div\");\n            divNum.className = \"GProuteResultsDetailsNumber\";\n            divNum.innerHTML = id + \".\";\n            div.appendChild(divNum);\n\n            durationCumul += parseFloat(o.duration);\n            distanceCumul += parseFloat(o.distance);\n\n            var distance = 0;\n            var isCumulKm = parseInt(distanceCumul / 1000, 10);\n            if (!isCumulKm) {\n                distance = Math.round(distanceCumul) + \" m\";\n            } else {\n                var distanceArrondi = Math.round(distanceCumul);\n                distanceArrondi = distanceArrondi / 1000;\n                distance = distanceArrondi + \" km\";\n            }\n\n            var divIns = document.createElement(\"div\");\n            divIns.className = \"GProuteResultsDetailsInstruction\";\n            divIns.id = this._addUID(\"GProuteResultsDetailsInstruction_\" + id);\n            divIns.title = \"distance : \" + distance + \" / \" + \"temps : \" + fconvert(durationCumul);\n            divIns.innerHTML = o.instruction;\n\n            divIns.addEventListener(\"mouseover\", function(e) {\n                context.onRouteResultsDetailsMouseOver(e);\n            });\n            divIns.addEventListener(\"mouseout\", function(e) {\n                context.onRouteResultsDetailsMouseOut(e);\n            });\n            divIns.addEventListener(\"click\", function(e) {\n                // mode mobile !\n                if (typeof context.onRouteResultsDetailsClick === \"function\") {\n                    context.onRouteResultsDetailsClick(e);\n                }\n            });\n            div.appendChild(divIns);\n\n        }\n\n        return div;\n    },\n\n    // ################################################################### //\n    // ################### Methods to the form points #################### //\n    // ################# OVERWRITTEN BY LOCATIONSELECTOR ! ################# //\n\n    /**\n     * Create Point\n     * see event !\n     * OVERWRITTEN BY LOCATIONSELECTOR !\n     * (version initial without LOCATIONSELECTOR PLUGIN)\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createRoutePanelFormPointElement: function(n, text, visibility) {\n\n        // contexte d'execution\n        var context = this;\n\n        var div = document.createElement(\"div\");\n        div.id = \"GProutePoint\" + n;\n        div.className = (visibility) ? \"GPflexInput GProuteStageFlexInput\" : \"GPflexInput GProuteStageFlexInputHidden\";\n\n        var labelOrigin = document.createElement(\"label\");\n        labelOrigin.id = \"GProuteOriginLabel\" + n;\n        labelOrigin.htmlFor = \"GProuteOrigin\" + n;\n        labelOrigin.innerHTML = text;\n        labelOrigin.addEventListener(\"click\", function() {\n            var i = this.id.charAt(this.id.length - 1);\n            document.getElementById(\"GProuteOriginCoords\" + i).value = \"\";\n            for (var j = 1; j < 8; j++) {\n                document.getElementById(\"GProutePoint\" + j).style.display = \"flex\";\n            }\n            document.getElementById(\"GProuteForm\").className = \"\";\n            document.getElementById(\"GProuteOriginPointer\" + i).checked = false;\n            document.getElementById(\"GProuteOrigin\" + i).className = \"GProuteOriginVisible\";\n            document.getElementById(\"GProuteOriginCoords\" + i).className = \"GProuteOriginHidden\";\n        });\n        div.appendChild(labelOrigin);\n\n        var inputOrigin = document.createElement(\"input\");\n        inputOrigin.id = \"GProuteOrigin\" + n;\n        inputOrigin.className = \"GProuteOriginVisible\";\n        inputOrigin.type = \"text\";\n        inputOrigin.placeholder = \"Saisir une adresse\";\n        inputOrigin.addEventListener(\"keyup\", function(e) {\n            var charCode = e.which || e.keyCode;\n            if (charCode === 13 || charCode === 10) {\n                return;\n            }\n            var i = this.id.charAt(this.id.length - 1);\n            if (document.getElementById(\"GProuteOrigin\" + i).value.length > 2) {\n                document.getElementById(\"GProuteAutoCompleteList\" + i).style.display = \"block\";\n            } else {\n                document.getElementById(\"GProuteAutoCompleteList\" + i).style.display = \"none\";\n            }\n            // gestionnaire d'evenement :\n            // on rcupre la valeur de saisie pour une requte sur le service d'autocompletion.\n            // le resultat de la requte nous permet de recuperer les coordonnes du point...\n            context.onAutoCompleteSearchText(e);\n        });\n        inputOrigin.addEventListener(\"blur\", function() {\n            var i = this.id.charAt(this.id.length - 1);\n            document.getElementById(\"GProuteAutoCompleteList\" + i).style.display = \"none\";\n        });\n        div.appendChild(inputOrigin);\n\n        var inputOriginCoord = document.createElement(\"input\");\n        inputOriginCoord.id = \"GProuteOriginCoords\" + n;\n        inputOriginCoord.className = \"GProuteOriginHidden\";\n        inputOriginCoord.type = \"text\";\n        inputOriginCoord.disabled = true;\n        div.appendChild(inputOriginCoord);\n\n        var inputOriginPointer = document.createElement(\"input\");\n        inputOriginPointer.id = \"GProuteOriginPointer\" + n;\n        inputOriginPointer.type = \"checkbox\";\n        div.appendChild(inputOriginPointer);\n\n        var labelOriginPointer = document.createElement(\"label\");\n        labelOriginPointer.id = \"GProuteOriginPointerImg\" + n;\n        labelOriginPointer.htmlFor = \"GProuteOriginPointer\" + n;\n        labelOriginPointer.className = \"GProuteOriginPointerImg\";\n        labelOriginPointer.title = \"Pointer un lieu sur la carte\";\n        labelOriginPointer.addEventListener(\"click\", function(evt) {\n            evt.preventDefault();\n            evt.stopPropagation();\n            var i = this.id.charAt(this.id.length - 1);\n            var j;\n            for (j = 1; j < 8; j++) {\n                if (i != j) {\n                    document.getElementById(\"GProuteOriginPointer\" + j).checked = false;\n                    if (document.getElementById(\"GProuteOriginCoords\" + j).value == \"Pointer un lieu sur la carte\") {\n                        document.getElementById(\"GProuteOriginCoords\" + j).value = \"\";\n                        document.getElementById(\"GProuteOrigin\" + j).className = \"GProuteOriginVisible\";\n                        document.getElementById(\"GProuteOriginCoords\" + j).className = \"GProuteOriginHidden\";\n                    }\n                }\n            }\n            if (document.getElementById(\"GProuteOriginPointer\" + i).checked) {\n                document.getElementById(\"GProuteOriginCoords\" + i).value = \"\";\n                for (j = 1; j < 8; j++) {\n                    document.getElementById(\"GProutePoint\" + j).style.display = \"flex\";\n                }\n                document.getElementById(\"GProuteForm\").className = \"\";\n                document.getElementById(\"GProuteOriginPointer\" + i).checked = false;\n                document.getElementById(\"GProuteOrigin\" + i).className = \"GProuteOriginVisible\";\n                document.getElementById(\"GProuteOriginCoords\" + i).className = \"GProuteOriginHidden\";\n            } else {\n                document.getElementById(\"GProuteOriginCoords\" + i).value = \"Pointer un lieu sur la carte\";\n                for (j = 1; j < 8; j++) {\n                    if (i == j) {\n                        document.getElementById(\"GProutePoint\" + j).style.display = \"flex\";\n                    } else {\n                        document.getElementById(\"GProutePoint\" + j).style.display = \"none\";\n                    }\n                }\n                document.getElementById(\"GProuteForm\").className = \"GProuteFormMini\";\n                document.getElementById(\"GProuteOriginPointer\" + i).checked = true;\n                document.getElementById(\"GProuteOrigin\" + i).className = \"GProuteOriginHidden\";\n                document.getElementById(\"GProuteOriginCoords\" + i).className = \"GProuteOriginVisible\";\n            }\n            // gestionnaire d'evenement :\n            // on stocke la valeur du point, utilise pour la requte sur le service de calcul d'itiniraire\n            context.onRouteMapPointClick(evt);\n        });\n        div.appendChild(labelOriginPointer);\n\n        return div;\n    },\n\n    /**\n     * Create Remove Point tag\n     * see event !\n     * OVERWRITTEN BY LOCATIONSELECTOR !\n     * (version initial without LOCATIONSELECTOR PLUGIN)\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createRoutePanelFormRemoveStageElement: function(n) {\n\n        // contexte d'execution\n        var context = this;\n\n        var divRm = document.createElement(\"div\");\n        divRm.id = \"GProuteStageRemove\" + n;\n        divRm.className = \"GProuteStageRemove\";\n        divRm.title = \"Supprimer l'tape\";\n        if (n != 1 && n != 7) {\n            divRm.addEventListener(\"click\", function(e) {\n                var i = this.id.charAt(this.id.length - 1);\n                document.getElementById(\"GProutePoint\" + i).className = \"GPflexInput GProuteStageFlexInputHidden\";\n                document.getElementById(\"GProuteOrigin\" + i).value = \"\";\n                document.getElementById(\"GProuteOrigin\" + i).className = \"GProuteOriginVisible\";\n                document.getElementById(\"GProuteOriginCoords\" + i).value = \"\";\n                document.getElementById(\"GProuteOriginCoords\" + i).className = \"GProuteOriginHidden\";\n                document.getElementById(\"GProuteStageAdd\").style.display = \"\";\n                // Moving up exclusions picto\n                var exclusionsPictoTop = document.getElementById(\"GPshowRouteExclusionsPicto\").style.top;\n                document.getElementById(\"GPshowRouteExclusionsPicto\").style.top = (parseInt(exclusionsPictoTop, 10) - 33).toString() + \"px\";\n                // gestionnaire d'evenement :\n                // on supprime le point, utilis pour la requte sur le service d'itiniraire\n                context.onRouteRemovePointClick(e);\n            });\n        }\n        return divRm;\n    },\n\n    /**\n     * Create Add Point tag\n     * see event !\n     * OVERWRITTEN BY LOCATIONSELECTOR !\n     * (version initial without LOCATIONSELECTOR PLUGIN)\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createRoutePanelFormAddStageElement: function() {\n\n        // contexte d'execution\n        var context = this;\n\n        var divAdd = document.createElement(\"div\");\n        divAdd.id = \"GProuteStageAdd\";\n        divAdd.title = \"Ajouter une tape\";\n        divAdd.addEventListener(\"click\", function(e) {\n            var lastStage = 1;\n            var nbStages = 0;\n            for (var i = 2; i < 7; i++) {\n                if (document.getElementById(\"GProutePoint\" + i).className == \"GPflexInput GProuteStageFlexInputHidden\") {\n                    if (lastStage == 1) {\n                        lastStage = i;\n                    }\n                } else {\n                    nbStages++;\n                }\n\n            }\n            if (lastStage < 7) {\n                document.getElementById(\"GProutePoint\" + lastStage).className = \"GPflexInput GProuteStageFlexInput\";\n                // Moving down exclusions picto\n                var exclusionsPictoTop = document.getElementById(\"GPshowRouteExclusionsPicto\").style.top;\n                document.getElementById(\"GPshowRouteExclusionsPicto\").style.top = (parseInt(exclusionsPictoTop, 10) + 33).toString() + \"px\";\n            }\n            if (nbStages == 4) {\n                document.getElementById(\"GProuteStageAdd\").style.display = \"none\";\n            }\n            // gestionnaire d'evenement :\n            // on ajoute le point, utilis pour la requte sur le service d'itiniraire\n            context.onRouteAddPointClick(e);\n        });\n\n        return divAdd;\n    },\n\n    /**\n     * Create Results autocompletion to the point\n     * see event!\n     * OVERWRITTEN BY LOCATIONSELECTOR !\n     * (version initial without LOCATIONSELECTOR PLUGIN)\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createRoutePanelFormAutoCompleteListElement: function(n) {\n\n        // contexte d'execution\n        var context = this;\n\n        var div = document.createElement(\"div\");\n        div.id = \"GProuteAutoCompleteList\" + n;\n        div.className = \"GPadvancedAutoCompleteList\";\n\n        if (div.addEventListener) {\n            div.addEventListener(\"click\", function(e) {\n                context.onAutoCompletedResultsItemClick(e);\n                document.getElementById(\"GProuteAutoCompleteList\" + n).style.display = \"none\";\n            }, false);\n        } else if (div.attachEvent) {\n            div.attachEvent(\"onclick\", function(e) {\n                context.onAutoCompletedResultsItemClick(e);\n                document.getElementById(\"GProuteAutoCompleteList\" + n).style.display = \"none\";\n            });\n        }\n\n        // Proposals are dynamically filled in Javascript by autocomplete service\n        // <div class=\"GPautoCompleteProposal\">...</div>\n\n        return div;\n    },\n\n    /**\n     * Autocompletion result to a point.\n     * Proposals are dynamically filled in Javascript by autocomplete service\n     * OVERWRITTEN BY LOCATIONSELECTOR !\n     * (version initial without LOCATIONSELECTOR PLUGIN)\n     *\n     *\n     * @param {Object} location - suggested location results\n     * @param {Number} n  - number of the point\n     * @param {Number} id - ID\n     */\n    _createRouteAutoCompletedLocationElement: function(location, n, id) {\n        var container = document.getElementById(\"GProuteAutoCompleteList\" + n);\n\n        var div = document.createElement(\"div\");\n        div.id = \"AutoCompletedLocation\" + id;\n        div.className = \"GPautoCompleteProposal\";\n        div.innerHTML = location.fullText;\n\n        container.appendChild(div);\n    },\n\n    // ################################################################### //\n    // ############## Methods to the choice mode into form ############### //\n    // ################################################################### //\n\n    /**\n     * Create Container to Mode choice transport\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createRoutePanelFormModeChoiceElement: function() {\n        var div = document.createElement(\"div\");\n        div.id = this._addUID(\"GProuteModeChoice\");\n\n        // div.appendChild(this._createRoutePanelFormModeChoiceTransportElement());\n        // div.appendChild(this._createRoutePanelFormModeChoiceComputeElement());\n\n        return div;\n    },\n\n    /**\n     * Create Mode choice transport\n     * see event !\n     * FIXME event not useful\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createRoutePanelFormModeChoiceTransportElement: function(transports) {\n\n        // contexte d'execution\n        var context = this;\n\n        var div = document.createElement(\"div\");\n        div.id = this._addUID(\"GProuteTransportChoice\");\n\n        var span = document.createElement(\"span\");\n        span.className = \"GProuteModeLabel\";\n        span.innerHTML = \"Mode de transport\";\n        div.appendChild(span);\n\n        /* jshint -W083 */\n        for (var i = 0; i < transports.length; i++) {\n            var transport = transports[i];\n\n            if (transport === \"Voiture\") {\n\n                var inputCar = document.createElement(\"input\");\n                inputCar.id = this._addUID(\"GProuteTransportCar\");\n                inputCar.type = \"radio\";\n                inputCar.name = \"GProuteTransport\";\n                inputCar.value = \"Voiture\";\n                if (i === 0) {\n                    inputCar.checked = true;\n                }\n                // gestionnaire d'evenement :\n                // on stocke le mode de transport,\n                // utilisation pour la requte sur le service de calcul d'itiniraire\n                if (inputCar.addEventListener) {\n                    inputCar.addEventListener(\"change\", function(e) {\n                        context.onRouteModeTransportChange(e);\n                    });\n                } else if (inputCar.attachEvent) {\n                    inputCar.attachEvent(\"onchange\", function(e) {\n                        context.onRouteModeTransportChange(e);\n                    });\n                }\n                div.appendChild(inputCar);\n\n                var labelCar = document.createElement(\"label\");\n                labelCar.className = \"GProuteTransportImg\";\n                labelCar.htmlFor = this._addUID(\"GProuteTransportCar\");\n                labelCar.title = \"Voiture\";\n                div.appendChild(labelCar);\n\n            }\n\n            if (transport === \"Pieton\") {\n\n                var inputPedestrian = document.createElement(\"input\");\n                inputPedestrian.id = this._addUID(\"GProuteTransportPedestrian\");\n                inputPedestrian.type = \"radio\";\n                inputPedestrian.name = \"GProuteTransport\";\n                inputPedestrian.value = \"Pieton\";\n                if (i === 0) {\n                    inputPedestrian.checked = true;\n                }\n                // gestionnaire d'evenement :\n                // on stocke le mode de transport,\n                // utilisation pour la requte sur le service de calcul d'itiniraire\n                if (inputPedestrian.addEventListener) {\n                    inputPedestrian.addEventListener(\"change\", function(e) {\n                        context.onRouteModeTransportChange(e);\n                    });\n                } else if (inputPedestrian.attachEvent) {\n                    inputPedestrian.attachEvent(\"onchange\", function(e) {\n                        context.onRouteModeTransportChange(e);\n                    });\n                }\n                div.appendChild(inputPedestrian);\n\n                var labelPedestrian = document.createElement(\"label\");\n                labelPedestrian.className = \"GProuteTransportImg\";\n                labelPedestrian.htmlFor = this._addUID(\"GProuteTransportPedestrian\");\n                labelPedestrian.title = \"Piton\";\n                div.appendChild(labelPedestrian);\n            }\n        }\n\n        return div;\n    },\n\n    /**\n     * Create Mode choice computation\n     * see event!\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createRoutePanelFormModeChoiceComputeElement: function() {\n\n        // contexte d'execution\n        var context = this;\n\n        var div = document.createElement(\"div\");\n        div.id = this._addUID(\"GProuteComputationChoice\");\n\n        var span = document.createElement(\"span\");\n        span.className = \"GProuteModeLabel\";\n        span.innerHTML = \"Mode de calcul\";\n        div.appendChild(span);\n\n        var select = document.createElement(\"select\");\n        select.id = this._addUID(\"GProuteComputationSelect\");\n        select.className = \"GPinputSelect\";\n        // gestionnaire d'evenement :\n        // on stocke la valeur du mode de calcul,\n        // utilisation pour la requte sur le service de calcul d'itiniraire\n        select.addEventListener(\"change\", function(e) {\n            context.onRouteModeComputationChange(e);\n        });\n\n        var computes = [{\n            code: \"fastest\",\n            label: \"Plus rapide\"\n        }, {\n            code: \"shortest\",\n            label: \"Plus court\"\n        }];\n\n        for (var i = 0; i < computes.length; i++) {\n            var option = document.createElement(\"option\");\n            option.value = computes[i].code;\n            option.text = computes[i].label;\n            select.appendChild(option);\n        }\n        div.appendChild(select);\n\n        return div;\n    },\n\n    // ################################################################### //\n    // ################# Methods to the choice exclusions ################ //\n    // ################################################################### //\n\n    /**\n     * Hidden checkbox for minimizing/maximizing Exclusions Options\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createShowRouteExclusionsElement: function() {\n        var input = document.createElement(\"input\");\n        input.id = this._addUID(\"GPshowRouteExclusions\");\n        input.type = \"checkbox\";\n        return input;\n    },\n\n    /**\n     * Label to Exclusions Options\n     * see event !\n     * FIXME event not useful\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createShowRouteExclusionsPictoElement: function() {\n\n        // contexte d'execution\n        var context = this;\n\n        var label = document.createElement(\"label\");\n        label.id = this._addUID(\"GPshowRouteExclusionsPicto\");\n        label.className = \"GPshowMoreOptions GPshowRouteExclusionsPicto\";\n        label.htmlFor = this._addUID(\"GPshowRouteExclusions\");\n        label.title = \"Exclusions\";\n        label.style.top = \"185px\";\n\n        // gestionnaire d'evenement :\n        // on ouvre le menu des options des exclusions\n        if (label.addEventListener) {\n            label.addEventListener(\"click\", function(e) {\n                context.onShowRouteExclusionsClick(e);\n            });\n        } else if (label.attachEvent) {\n            label.attachEvent(\"onclick\", function(e) {\n                context.onShowRouteExclusionsClick(e);\n            });\n        }\n\n        return label;\n    },\n\n    /**\n     * Create Container to Exclusions\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createRoutePanelFormExclusionsElement: function() {\n\n        var div = document.createElement(\"div\");\n        div.id = this._addUID(\"GProuteExclusions\");\n\n        var span = document.createElement(\"span\");\n        span.className = \"GProuteExclusionsLabel\";\n        span.innerHTML = \"Passages autoriss\";\n        div.appendChild(span);\n\n        // div.appendChild(this._createRoutePanelFormExclusionOptionsElement());\n\n        return div;\n    },\n\n    /**\n     * Create Exclusions Options\n     * see event !\n     * FIXME event not useful\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createRoutePanelFormExclusionOptionsElement: function(exclusions) {\n\n        // contexte d'execution\n        var context = this;\n\n        var div = document.createElement(\"div\");\n        div.className = \"GProuteExclusionsOptions\";\n\n        /* jshint -W083 */\n        for (var value in exclusions) {\n            if (exclusions.hasOwnProperty(value)) {\n\n                var status = exclusions[value];\n                switch (value) {\n                    case \"toll\":\n                        var inputToll = document.createElement(\"input\");\n                        inputToll.id = this._addUID(\"GProuteExclusionsToll\");\n                        inputToll.type = \"checkbox\";\n                        inputToll.value = \"Toll\";\n                        inputToll.checked = !status;\n                        // gestionnaire d'evenement :\n                        // on stocke l'exclusion,\n                        // utilisation pour la requte sur le service de calcul d'itiniraire\n                        if (inputToll.addEventListener) {\n                            inputToll.addEventListener(\"change\", function(e) {\n                                context.onRouteExclusionsChange(e);\n                            });\n                        } else if (inputToll.attachEvent) {\n                            inputToll.attachEvent(\"onchange\", function(e) {\n                                context.onRouteExclusionsChange(e);\n                            });\n                        }\n                        div.appendChild(inputToll);\n\n                        var labelToll = document.createElement(\"label\");\n                        labelToll.className = \"GProuteExclusionsOption\";\n                        labelToll.htmlFor = this._addUID(\"GProuteExclusionsToll\");\n                        labelToll.innerHTML = \"Pages\";\n                        div.appendChild(labelToll);\n                        break;\n\n                    case \"tunnel\":\n                        var inputTunnel = document.createElement(\"input\");\n                        inputTunnel.id = this._addUID(\"GProuteExclusionsTunnel\");\n                        inputTunnel.type = \"checkbox\";\n                        inputTunnel.value = \"Tunnel\";\n                        inputTunnel.checked = !status;\n                        // gestionnaire d'evenement :\n                        // on stocke l'exclusion,\n                        // utilisation pour la requte sur le service de calcul d'itiniraire\n                        if (inputTunnel.addEventListener) {\n                            inputTunnel.addEventListener(\"change\", function(e) {\n                                context.onRouteExclusionsChange(e);\n                            });\n                        } else if (inputTunnel.attachEvent) {\n                            inputTunnel.attachEvent(\"onchange\", function(e) {\n                                context.onRouteExclusionsChange(e);\n                            });\n                        }\n                        div.appendChild(inputTunnel);\n\n                        var labelTunnel = document.createElement(\"label\");\n                        labelTunnel.className = \"GProuteExclusionsOption\";\n                        labelTunnel.htmlFor = this._addUID(\"GProuteExclusionsTunnel\");\n                        labelTunnel.innerHTML = \"Tunnels\";\n                        div.appendChild(labelTunnel);\n                        break;\n\n                    case \"bridge\":\n                        var inputBridge = document.createElement(\"input\");\n                        inputBridge.id = this._addUID(\"GProuteExclusionsBridge\");\n                        inputBridge.type = \"checkbox\";\n                        inputBridge.value = \"Bridge\";\n                        inputBridge.checked = !status;\n                        // gestionnaire d'evenement :\n                        // on stocke l'exclusion,\n                        // utilisation pour la requte sur le service de calcul d'itiniraire\n                        if (inputBridge.addEventListener) {\n                            inputBridge.addEventListener(\"change\", function(e) {\n                                context.onRouteExclusionsChange(e);\n                            });\n                        } else if (inputBridge.attachEvent) {\n                            inputBridge.attachEvent(\"onchange\", function(e) {\n                                context.onRouteExclusionsChange(e);\n                            });\n                        }\n                        div.appendChild(inputBridge);\n\n                        var labelBridge = document.createElement(\"label\");\n                        labelBridge.className = \"GProuteExclusionsOption\";\n                        labelBridge.htmlFor = this._addUID(\"GProuteExclusionsBridge\");\n                        labelBridge.innerHTML = \"Ponts\";\n                        div.appendChild(labelBridge);\n                        break;\n                }\n            }\n        }\n\n        return div;\n    },\n\n    // ################################################################### //\n    // ############################### Submit Form ####################### //\n    // ################################################################### //\n\n    /**\n     * Create Submit Form Element\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createRouteSubmitFormElement: function() {\n\n        var input = document.createElement(\"input\");\n        input.id = this._addUID(\"GProuteSubmit\");\n        input.className = \"GPinputSubmit\";\n        input.type = \"submit\";\n        input.value = \"Calculer\";\n\n        return input;\n    },\n\n    // ################################################################### //\n    // ############################### Reset picto ####################### //\n    // ################################################################### //\n\n    /**\n     * Create Reset Picto Element\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createRouteFormResetElement: function() {\n\n        var self = this;\n\n        var divReset = document.createElement(\"div\");\n        divReset.id = this._addUID(\"GProuteReset\");\n        divReset.title = \"Rinitialiser les paramtres\";\n        divReset.addEventListener(\"click\", function(e) {\n            self.onRouteResetClick(e);\n        });\n\n        return divReset;\n    }\n};\n\nexport default RouteDOM;\n\n\n\n// WEBPACK FOOTER //\n// ./src/Common/Controls/RouteDOM.js","import ol from \"ol\";\nimport Gp from \"gp\";\nimport Logger from \"../../Common/Utils/LoggerByDefault\";\nimport Utils from \"../../Common/Utils\";\nimport RightManagement from \"../../Common/Utils/CheckRightManagement\";\nimport SelectorID from \"../../Common/Utils/SelectorID\";\nimport LocationSelector from \"./LocationSelector\";\nimport LayerSwitcher from \"./LayerSwitcher\";\nimport Markers from \"./Utils/Markers\";\nimport IsoDOM from \"../../Common/Controls/IsoDOM\";\n\n\nvar logger = Logger.getLogger(\"isocurve\");\n\n/**\n * @classdesc\n *\n * Isocurve Control.\n *\n * @constructor\n * @alias ol.control.Isocurve\n * @extends {ol.control.Control}\n * @param {Object} options - Isocurve control options\n * @param {String}   [options.apiKey] - API key for services call (isocurve and autocomplete services), mandatory if autoconf service has not been charged in advance\n * @param {Boolean} [options.collapsed = true] - Specify if widget has to be collapsed (true) or not (false) on map loading. Default is true.\n * @param {Object}  [options.exclusions = {toll : false, tunnel : false, bridge : false}] - list of exclusions with status (true = checked). By default : no exclusions checked.\n * @param {Array}   [options.graphs = [\"Voiture\", \"Pieton\"]] - list of graph resources to be used for isocurve calculation, by default : [\"Voiture\", \"Pieton\"]. Possible values are \"Voiture\" and \"Pieton\". The first element is selected.\n * @param {Array}   [options.methods = [\"time\", \"distance\"]] - list of methods, by default : [\"time\", \"distance\"]. Possible values are \"time\" and \"distance\". The first element is selected by default.\n * @param {Array}   [options.directions = [\"departure\", \"arrival\"]] - list of directions to be displayed, by default : [\"departure\", \"arrival\"]. The first element is selected by default. Possible values are \"departure\" and \"arrival\".\n *      Directions enable to specify if input location point will be used as a departure point (\"departure\") or as an arrival point (\"arrival\")\n * @param {Object} [options.markerOpts] - options to use your own marker. Default is a lightOrange marker.\n * @param {String} [options.markerOpts.url] - marker base64 encoded url (ex \"data:image/png;base64,...\"\"). Mandatory for a custom marker\n * @param {Array} [options.markerOpts.offset] - Offsets in pixels used when positioning the overlay. The first element in the array is the horizontal offset. A positive value shifts the overlay right. The second element in the array is the vertical offset. A positive value shifts the overlay down. Default is [0, 0]. (see http://openlayers.org/en/latest/apidoc/ol.Overlay.html)\n * @param {Object} [options.isocurveOptions = {}] - isocurve service options. see {@link http://ignf.github.io/geoportal-access-lib/latest/jsdoc/module-Services.html#~isoCurve Gp.Services.isoCurve()} to know all isocurve options.\n * @param {Object} [options.autocompleteOptions = {}] - autocomplete service options. see {@link http://ignf.github.io/geoportal-access-lib/latest/jsdoc/module-Services.html#~autoComplete Gp.Services.autoComplete()} to know all autocomplete options\n * @example\n *  var iso = ol.control.Isocurve({\n *      collapsed : false\n *      methods : [\"time\", \"distance\"],\n *      exclusions : {\n *         toll : true,\n *         bridge : false,\n *         tunnel : true\n *      },\n *      graphs : [\"Pieton\", \"Voiture\"],\n *      markerOpts : {\n *          url : \"...\",\n *          offset : [0,0]\n *      }\n *      isocurveOptions : {},\n *      autocompleteOptions : {}\n *  });\n */\nfunction Isocurve(options) {\n    options = options || {};\n\n    if (!(this instanceof Isocurve)) {\n        throw new TypeError(\"ERROR CLASS_CONSTRUCTOR\");\n    }\n\n    // initialisation du composant\n    this.initialize(options);\n\n    // // Widget main DOM container\n    this._container = this._createMainContainerElement();\n    // info: le container sera complt lors de l'ajout  la carte (setMap), car certains composants ncessitent d'tre lis  la map.\n    this._containerElement = null;\n\n    // on peut ventuellement encapsuler le composant dans une div passe par l'utilisateur\n    if (options.element && options.element.appendChild) {\n        // dans ce cas on stocke les deux container\n        options.element.appendChild(this._container);\n        this._containerElement = options.element;\n    }\n\n    // call ol.control.Control constructor\n    ol.control.Control.call(this, {\n        element: this._containerElement || this._container,\n        target: options.target,\n        render: options.render\n    });\n};\n\n// Inherits from ol.control.Control\nol.inherits(Isocurve, ol.control.Control);\n\n/**\n * @lends module:Isocurve\n */\nIsocurve.prototype = Object.create(ol.control.Control.prototype, {});\n\n// on rcupre les mthodes de la classe commune IsoDOM\nUtils.assign(Isocurve.prototype, IsoDOM);\n\n/**\n * Constructor (alias)\n *\n * @private\n */\nIsocurve.prototype.constructor = Isocurve;\n\n// ################################################################### //\n// ##################### public methods ############################## //\n// ################################################################### //\n\n/**\n * Returns true if widget is collapsed (minimized), false otherwise\n *\n * @returns {Boolean} collapsed - true if widget is collapsed\n */\nIsocurve.prototype.getCollapsed = function() {\n    return this.collapsed;\n};\n\n/**\n * Collapse or display widget main container\n *\n * @param {Boolean} collapsed - True to collapse widget, False to display it\n */\nIsocurve.prototype.setCollapsed = function(collapsed) {\n    if (collapsed === undefined) {\n        console.log(\"[ERROR] Isocurve:setCollapsed - missing collapsed parameter\");\n        return;\n    }\n    if ((collapsed && this.collapsed) || (!collapsed && !this.collapsed)) {\n        return;\n    }\n    if (collapsed) {\n        document.getElementById(\"GPisochronPanelClose-\" + this._uid).click();\n    } else {\n        document.getElementById(\"GPshowIsochronPicto-\" + this._uid).click();\n    }\n    this.collapsed = collapsed;\n};\n\n/**\n * Get vector layer where Isocurve geometry is drawn\n *\n * @returns {Object} layer - ol.layer.Vector isocurve layer\n */\nIsocurve.prototype.getLayer = function() {\n    return this._geojsonLayer;\n};\n\n/**\n * Overwrite OpenLayers setMap method\n *\n * @param {ol.Map} map - Map.\n */\nIsocurve.prototype.setMap = function(map) {\n\n    if (map) {\n        // enrichissement du DOM du container lors de l'ajout  la carte\n        this._container = this._initContainer(map);\n    }\n\n    // on appelle la mthode setMap originale d'OpenLayers\n    ol.control.Control.prototype.setMap.call(this, map);\n\n};\n\n// ################################################################### //\n// ##################### init component ############################## //\n// ################################################################### //\n\n/**\n * Initialize Isocurve control (called by Isocurve constructor)\n *\n * @param {Object} options - constructor options\n * @private\n */\nIsocurve.prototype.initialize = function(options) {\n\n    this._checkInputOptions(options);\n\n    // set default options\n    this.options = {\n        collapsed: true,\n        methods: [\"time\", \"distance\"],\n        graphs: [\"Voiture\", \"Pieton\"],\n        exclusions: {\n            toll: false,\n            tunnel: false,\n            bridge: false\n        },\n        directions: [\"departure\", \"arrival\"],\n        markerOpts: {\n            url: Markers[\"lightOrange\"],\n            offset: Markers.defaultOffset\n        },\n        isocurveOptions: {},\n        autocompleteOptions: {}\n    };\n\n    // merge with user options\n    Utils.assign(this.options, options);\n\n    /** {Boolean} specify if isocurve control is collapsed (true) or not (false) */\n    this.collapsed = this.options.collapsed;\n\n    // identifiant du contrle : utile pour suffixer les identifiants CSS (pour grer le cas o il y en a plusieurs dans la mme page)\n    this._uid = SelectorID.generate();\n\n    // Options du service paramtrables via l'interface (graph, method, exclusions)\n    // Mode de transport selectionn : 'Voiture' ou 'Pieton'\n    this._currentTransport = null;\n    this._initTransport();\n    // Mode de calcul selectionn : 'time' (isochron) ou 'distance' (isodistance)\n    this._currentComputation = null;\n    this._initComputation();\n    // Exclusions selectionnes : Tunnel, Toll et Bridge\n    this._currentExclusions = [];\n    this._initExclusions();\n    // sens de parcours : \"departure\" ou \"arrival\"\n    this._currentDirection = null;\n    this._initDirection();\n\n    // point de saisie\n    this._originPoint = null;\n\n    // // containers principaux\n    this._showIsoContainer = null;\n    this._waitingContainer = null;\n    this._formContainer = null;\n\n    // les rsultats du calcul\n    this._currentIsoResults = null;\n\n    // la gomtrie\n    this._geojsonLayer;\n\n    // si un calcul est en cours ou non\n    this._waiting = false;\n    // timer pour cacher la patience aprs un certain temps\n    this._timer = null;\n\n    // styles pour les slections des features\n    this._defaultFeatureStyle = new ol.style.Style({\n        fill: new ol.style.Fill({\n            color: \"rgba(0, 183, 152, 0.7)\"\n        })\n    });\n\n    // liste des ressources avec droits par service\n    // Ex. {\n    //   \"Isocurve\" : {\n    //       key : \"ger4g456re45er456t4er5ge5\",\n    //       resources : [\"Pieton\", \"Voiture\"]\n    //   }\n    // }\n    this._resources = {};\n\n    // gestion des droits sur les ressources\n    this._noRightManagement = false;\n\n    // gestion des droits sur les ressources/services\n    this._checkRightsManagement();\n};\n\n/**\n * this method is called by this.initialize()\n *\n * @private\n */\nIsocurve.prototype._checkInputOptions = function(options) {\n\n    // vrification des options\n    // on ne permet pas de n'afficher aucun mode de calcul ou aucun mode de transport ?\n    var i;\n\n    // modes de calcul\n    if (options.methods) {\n        if (Array.isArray(options.methods)) {\n            // on ne permet pas de passer un tableau vide : on spcifie au moins une mthode\n            if (options.methods.length === 0) {\n                options.methods = null;\n            } else {\n                for (i = 0; i < options.methods.length; i++) {\n                    if (typeof options.methods[i] !== \"string\") {\n                        console.log(\"[ol.control.Isocurve] ERROR : parameter 'methods' elements should be of type 'string'\");\n                    }\n                }\n            }\n        } else {\n            logger.warn(\"'methods' parameter should be an array\");\n            options.methods = null;\n        }\n    }\n\n    // mode de transport\n    if (options.graphs) {\n        if (Array.isArray(options.graphs)) {\n            // on ne permet pas de passer un tableau vide : on spcifie au moins un graph\n            if (options.graphs.length === 0) {\n                options.graphs = null;\n            } else {\n                for (i = 0; i < options.graphs.length; i++) {\n                    if (typeof options.graphs[i] !== \"string\") {\n                        console.log(\"[ol.control.Isocurve] ERROR : parameter 'graphs' elements should be of type 'string'\");\n                    } else {\n                        if (options.graphs[i].toLowerCase() === \"pieton\") {\n                            options.graphs[i] = \"Pieton\";\n                        }\n                        if (options.graphs[i].toLowerCase() === \"voiture\") {\n                            options.graphs[i] = \"Voiture\";\n                        }\n                    }\n\n                }\n            }\n        } else {\n            logger.warn(\"'graphs' parameter should be an array\");\n            options.graphs = null;\n        }\n    }\n\n    // sens du parcours\n    if (options.directions) {\n        if (Array.isArray(options.directions)) {\n            // on ne permet pas de passer un tableau vide : on spcifie au moins une direction\n            if (options.directions.length === 0) {\n                options.directions = null;\n            } else {\n                for (i = 0; i < options.directions.length; i++) {\n                    if (typeof options.directions[i] !== \"string\") {\n                        console.log(\"[ol.control.Isocurve] ERROR : parameter 'directions' elements should be of type 'string'\");\n                    }\n                }\n            }\n        } else {\n            logger.warn(\"'directions' parameter should be an array\");\n            options.directions = null;\n        }\n    }\n\n    // collapsed\n    if (options.collapsed === \"true\") {\n        options.collapsed = true;\n    }\n    if (options.collapsed === \"false\") {\n        options.collapsed = false;\n    }\n};\n\n/**\n * this method is called by this.initialize() and initialize transport mode\n * (\"Voiture\" ou \"Pieton\")\n *\n * @private\n */\nIsocurve.prototype._initTransport = function() {\n    // Mode de transport selectionn\n    this._currentTransport = \"Voiture\"; // par defaut\n\n    // par defaut\n    var transports = this.options.graphs;\n    if (!transports || transports.length === 0) {\n        this.options.graphs = [\"Voiture\", \"Pieton\"];\n    }\n\n    // option\n    if (Array.isArray(transports) && transports.length) {\n        // FIXME pb si le 1er graphe n'est pas une ressource connue !\n        if (transports[0] === \"Voiture\" || transports[0] === \"Pieton\") {\n            this._currentTransport = transports[0];\n        }\n    }\n\n    // si l'utilisateur a spcifi un graph dans le service, on surcharge les options du widget\n    var serviceOptions = this.options.isocurveOptions;\n    if (serviceOptions.graph) {\n        this._currentTransport = serviceOptions.graph;\n    }\n};\n\n/**\n * this method is called by this.initialize() and initialize computation mode\n * (time or distance)\n *\n * @private\n */\nIsocurve.prototype._initComputation = function() {\n    // Mode de calcul selectionn\n    this._currentComputation = \"time\"; // par defaut\n\n    // par defaut\n    var methods = this.options.methods;\n    if (!methods || methods.length === 0) {\n        this.options.methods = [\"time\", \"distance\"];\n    }\n\n    // option\n    if (Array.isArray(methods) && methods.length) {\n        // FIXME pb si le 1er graphe n'est pas une ressource connue !\n        if (methods[0] === \"time\" || methods[0] === \"distance\") {\n            this._currentComputation = methods[0];\n        }\n    }\n\n    // si l'utilisateur a spcifi une mthode dans le service, on surcharge les options du widget\n    var serviceOptions = this.options.isocurveOptions;\n    if (serviceOptions.method) {\n        this._currentComputation = serviceOptions.method;\n    }\n    if (serviceOptions.time) {\n        this._currentComputation = \"time\";\n    }\n    if (serviceOptions.distance) {\n        this._currentComputation = \"distance\";\n    }\n};\n\n/**\n * this method is called by this.initialize() and initialize direction mode\n * (departure or arrival)\n *\n * @private\n */\nIsocurve.prototype._initDirection = function() {\n    // Mode de calcul selectionn\n    this._currentDirection = \"departure\"; // par defaut\n\n    // par defaut\n    var directions = this.options.directions;\n    if (!directions || directions.length === 0) {\n        this.options.directions = [\"departure\", \"arrival\"];\n    }\n\n    // option\n    if (Array.isArray(directions) && directions.length) {\n        // FIXME pb si le 1er graphe n'est pas une ressource connue !\n        if (directions[0] === \"departure\" || directions[0] === \"arrival\") {\n            this._currentDirection = directions[0];\n        }\n    }\n\n    // si l'utilisateur a spcifi une mthode dans le service, on surcharge les options du widget\n    var serviceOptions = this.options.isocurveOptions;\n    if (!serviceOptions.reverse) {\n        this._currentDirection = \"departure\";\n    }\n    if (serviceOptions.reverse === true) {\n        this._currentDirection = \"arrival\";\n        this.options.directions = [\"arrival\", \"departure\"];\n    }\n};\n\n/**\n * this method is called by this.initialize() and initialize exclusions\n *\n * @private\n */\nIsocurve.prototype._initExclusions = function() {\n    // Exclusions selectionnes : Tunnel, Toll et Bridge\n    this._currentExclusions = []; // par defaut\n\n    // par defaut\n    var exclusion = this.options.exclusions;\n    if (!exclusion || (typeof exclusion === \"object\" && Object.keys(exclusion).length === 0)) {\n        this.options.exclusions = {\n            toll: false,\n            tunnel: false,\n            bridge: false\n        };\n    }\n\n    // option\n    if (exclusion && typeof exclusion === \"object\" && Object.keys(exclusion).length) {\n        for (var k in exclusion) {\n            if (exclusion.hasOwnProperty(k)) {\n                if (exclusion.k) {\n                    this._currentExclusions.push(k);\n                }\n            }\n        }\n    }\n\n    // si l'utilisateur a spcifi des exclusions dans le service, on surcharge les options du widget\n    var serviceOptions = this.options.isocurveOptions;\n    if (Array.isArray(serviceOptions.exclusions)) {\n        this._currentExclusions = serviceOptions.exclusions;\n    }\n};\n\n/**\n * Check rights to resources (called by this.initialize())\n *\n * @private\n */\nIsocurve.prototype._checkRightsManagement = function() {\n\n    var _opts = null;\n    var _res = [];\n    var _key = null;\n\n    // les ressources du service du calcul d'isocurve\n    _key = this.options.isocurveOptions.apiKey;\n    _opts = this.options.isocurveOptions.filterOptions;\n    _res = (_opts) ? _opts.type : [];\n    if (!_res || _res.length === 0) {\n        _res = [\"Voiture\", \"Pieton\"];\n    }\n\n    var rightManagementIsocurve = RightManagement.check({\n        key: _key || this.options.apiKey,\n        resources: _res,\n        services: [\"Isochrone\"]\n    });\n    logger.log(\"rightManagementIsocurve\", rightManagementIsocurve);\n\n    // les ressources du service d'autocompletion\n    _key = this.options.autocompleteOptions.apiKey;\n    _opts = this.options.autocompleteOptions.filterOptions;\n    _res = (_opts) ? _opts.type : [];\n    if (!_res || _res.length === 0) {\n        _res = [\n            \"PositionOfInterest\",\n            \"StreetAddress\"\n        ];\n    }\n\n    var rightManagementAutoComplete = RightManagement.check({\n        key: _key || this.options.apiKey,\n        resources: _res,\n        services: [\"AutoCompletion\"]\n    });\n    logger.log(\"rightManagementAutoComplete\", rightManagementAutoComplete);\n\n    // au cas o pas de droit !\n    if (!rightManagementIsocurve && !rightManagementAutoComplete) {\n        this._noRightManagement = true;\n    }\n\n    // FIXME je reconstruis differement la structure pour la gestion des clefs differentes\n    // pour chaque service...\n    if (rightManagementAutoComplete) {\n        this._resources[\"AutoCompletion\"] = {};\n        this._resources[\"AutoCompletion\"][\"resources\"] = rightManagementAutoComplete[\"AutoCompletion\"];\n        this._resources[\"AutoCompletion\"][\"key\"] = rightManagementAutoComplete[\"key\"];\n    }\n\n    if (rightManagementIsocurve) {\n        this._resources[\"Isocurve\"] = {};\n        this._resources[\"Isocurve\"][\"resources\"] = rightManagementIsocurve[\"Isochrone\"];\n        this._resources[\"Isocurve\"][\"key\"] = rightManagementIsocurve[\"key\"];\n    }\n\n};\n\n// ################################################################### //\n// ######################## DOM initialize ########################### //\n// ################################################################### //\n\n/**\n * initialize component container (DOM)\n *\n * @private\n */\nIsocurve.prototype._initContainer = function(map) {\n    // get main container\n    var container = this._container;\n\n    var inputShow = this._showIsoContainer = this._createShowIsoElement();\n    container.appendChild(inputShow);\n\n    // mode \"collapsed\"\n    if (!this.collapsed) {\n        inputShow.checked = true;\n    }\n\n    var picto = this._createShowIsoPictoElement();\n    container.appendChild(picto);\n\n    // panneau\n    var panel = this._createIsoPanelElement();\n\n    // header\n    var header = this._createIsoPanelHeaderElement();\n    panel.appendChild(header);\n\n    // form\n    var form = this._formContainer = this._createIsoPanelFormElement();\n\n    // form: input de saisie de la localisation (fonction de Isocurve, voir ci-dessous)\n    var point = this._createIsoPanelFormPointElement(map);\n    form.appendChild(point);\n\n    var isoChronChecked = false;\n    var isoDistChecked = false;\n    var typeChoice = this._createIsoPanelFormTypeChoiceElement();\n    for (var i = 0; i < this.options.methods.length; i++) {\n        if (this.options.methods[i] === \"time\") {\n            isoChronChecked = (i === 0) ? true : false;\n            typeChoice.appendChild(this._createIsoPanelFormTypeChoiceChronElement(isoChronChecked));\n        }\n        if (this.options.methods[i] === \"distance\") {\n            isoDistChecked = (i === 0) ? true : false;\n            typeChoice.appendChild(this._createIsoPanelFormTypeChoiceDistElement(isoDistChecked));\n        }\n    }\n    form.appendChild(typeChoice);\n\n    // form: menu du choix des valeurs\n    form.appendChild(this._createIsoPanelFormValueIsochronElement(isoChronChecked));\n    form.appendChild(this._createIsoPanelFormValueIsodistanceElement(isoDistChecked));\n\n    // form: menu du choix du transport et du sens du parcours\n    var modeChoice = this._createIsoPanelFormModeChoiceElement();\n    modeChoice.appendChild(this._createIsoPanelFormModeChoiceTransportElement(this.options.graphs));\n    // FIXME : doit on passer le paramtre defaultDirection ?\n    modeChoice.appendChild(this._createIsoPanelFormModeChoiceDirectionElement(this.options.directions));\n    form.appendChild(modeChoice);\n\n    // form: menu des exclusions\n    if (this.options.exclusions && (typeof this.options.exclusions === \"object\") && (Object.keys(this.options.exclusions).length !== 0)) {\n        form.appendChild(this._createShowIsoExclusionsElement());\n        form.appendChild(this._createShowIsoExclusionsPictoElement());\n        var exclusion = this._createIsoPanelFormExclusionsElement();\n        exclusion.appendChild(this._createIsoPanelFormExclusionOptionsElement(this.options.exclusions));\n        form.appendChild(exclusion);\n    }\n\n    var divReset = this._createIsoFormResetElement();\n    form.appendChild(divReset);\n\n    // form: bouton du calcul\n    var submit = this._submitContainer = this._createIsoSubmitFormElement();\n    form.appendChild(submit);\n\n    panel.appendChild(form);\n\n    // waiting\n    var waiting = this._waitingContainer = this._createIsoWaitingElement();\n    panel.appendChild(waiting);\n\n    container.appendChild(panel);\n    var context = this;\n    // hide autocomplete suggested locations on container click\n    if (container.addEventListener) {\n        container.addEventListener(\"click\", function(e) {\n            context._hideIsoSuggestedLocations.call(context, e);\n        });\n    }\n\n    return container;\n\n};\n\n/**\n * Create start point\n *\n * @returns {Object} DOM element\n * @private\n */\nIsocurve.prototype._createIsoPanelFormPointElement = function(map) {\n    this._originPoint = new LocationSelector({\n        apiKey: this.options.apiKey || null,\n        tag: {\n            id: 1,\n            groupId: this._uid,\n            markerOpts: this.options.markerOpts,\n            label: \"Dpart\",\n            display: true\n        },\n        autocompleteOptions: this.options.autocompleteOptions || null\n    });\n    this._originPoint.setMap(map);\n    // a la slection d'un nouveau point, on rinitialise aussi le trac\n    var self = this;\n    /** click sur le pointer */\n    document.getElementById(\"GPlocationOriginPointerImg_1-\" + this._uid).onclick = function() {\n        self._clearGeojsonLayer();\n        var map = self.getMap();\n        if (self._originPoint._inputShowPointerContainer.checked) {\n            // au click sur l'input pour pointer sur la carte: on minimise le formulaire\n            self._formContainer.className = \"GPisochronFormMini\";\n            // et au clic sur la carte, on raffichera le formulaire \"normal\"\n            map.on(\n                \"click\",\n                function() {\n                    self._formContainer.className = \"\";\n                }\n            );\n        } else {\n            // si on dselectionne le pointer, on rtablit le formulaire en mode normal\n            self._formContainer.className = \"\";\n            // et on enlve l'couteur d'vnement sur la carte\n            map.un(\n                \"click\",\n                function() {\n                    self._formContainer.className = \"\";\n                }\n            );\n        }\n    };\n    /** click sur le label */\n    document.getElementById(\"GPlocationOriginLabel_1-\" + this._uid).onclick = function() {\n        self._clearGeojsonLayer();\n        self._formContainer.className = \"\";\n        // on dsactive l'couteur d'vnements sur la carte (pour ne pas placer un marker au clic)\n        map.un(\n            \"click\",\n            function() {\n                self._formContainer.className = \"\";\n            }\n        );\n    };\n    /** click sur la zone de saisie */\n    document.getElementById(\"GPlocationOrigin_1-\" + this._uid).onclick = function() {\n        self._clearGeojsonLayer();\n    };\n    return this._originPoint._container;\n};\n\n// ################################################################### //\n// ####################### handlers events to dom #################### //\n// ################################################################### //\n\n/**\n * this method is called by event 'submit' on 'GPisochronForm' tag form\n * (cf. this._createIsoPanelFormElement),\n * and call isocurve service to display results\n *\n * @private\n */\nIsocurve.prototype.onIsoComputationSubmit = function() {\n\n    // si on n'a pas de valeur rcupre pour notre point origine, on ne fait rien\n    if (!this._originPoint || !this._originPoint.getCoordinate || !this._originPoint.getCoordinate()) {\n        console.log(\"[Isocurve] Missing position parameter to submit isocurve request\");\n        return;\n    }\n\n    // rcupration de l'origine\n    var positionCoordinates = this._originPoint.getCoordinate();\n    var position = {\n        x: positionCoordinates[0],\n        y: positionCoordinates[1]\n    };\n    logger.log(\"origin : \", position);\n\n    // rcupration du temps ou de la distance\n    var time;\n    var distance;\n    if (this._currentComputation.toLowerCase() === \"time\") {\n        var timeHourInput = document.getElementById(\"GPisochronValueChronInput1-\" + this._uid);\n        var hours = parseInt(timeHourInput.value, 10);\n        if (isNaN && isNaN(hours)) {\n            hours = 0;\n        }\n        var timeMinutesInput = document.getElementById(\"GPisochronValueChronInput2-\" + this._uid);\n        var minutes = parseInt(timeMinutesInput.value, 10);\n        if (isNaN && isNaN(minutes)) {\n            minutes = 0;\n        }\n        // dure exprime en secondes\n        time = hours * 3600 + minutes * 60;\n        logger.log(\"time : \" + time);\n    }\n    if (this._currentComputation.toLowerCase() === \"distance\") {\n        var distInput = document.getElementById(\"GPisochronValueDistInput-\" + this._uid);\n        // distance exprime en mtres\n        distance = parseFloat(distInput.value) * 1000;\n        logger.log(\"distance : \" + distance);\n    }\n\n    // si on n'a pas de valeur de calcul renseigne, on ne lance pas la requte.\n    if (!time && !distance) {\n        console.log(\"[Isocurve] Missing time or distance parameter to submit isocurve request\");\n        return;\n    }\n\n    // oups, aucun droits !\n    // on evite donc une requte inutile ...\n    if (this._noRightManagement) {\n        console.log(\"[Isocurve] no rights for this service\");\n        return;\n    }\n\n    // on recupere les ventuelles options du service passes par l'utilisateur\n    var options = this.options.isocurveOptions || {};\n\n    // gestion du protocole et du timeout\n    // le timeout est indispensable sur le protocole JSONP.\n    var _protocol = options.protocol || \"XHR\";\n    var _timeout = options.timeOut || 0;\n    if (_protocol === \"JSONP\" && _timeout === 0) {\n        // FIXME le timeout est obligatoire pour ce type de protocole...\n        _timeout = 15000;\n    }\n\n    // on met en place l'affichage des resultats dans la fenetre de resultats.\n    var context = this;\n    var isoRequestOptions = {\n        position: position,\n        graph: options.graph || this._currentTransport,\n        exclusions: options.exclusions || this._currentExclusions,\n        method: options.method || this._currentComputation,\n        smoothing: options.smoothing || true,\n        timeOut: _timeout,\n        protocol: _protocol,\n        /** callback onSuccess */\n        onSuccess: function(results) {\n            logger.log(results);\n            if (results) {\n                context._drawIsoResults(results);\n            }\n        },\n        /** callback onFailure */\n        onFailure: function(error) {\n            // FIXME mise  jour du controle mais le service ne repond pas en 200 !?\n            context._hideWaitingContainer();\n            logger.log(error.message);\n        }\n    };\n    if ((this._currentDirection.toLowerCase() === \"arrival\") || (options.reverse)) {\n        isoRequestOptions.reverse = true;\n    }\n    if (time) {\n        isoRequestOptions.time = time;\n    }\n    if (distance) {\n        isoRequestOptions.distance = distance;\n    }\n\n    this._requestIsoCurve(isoRequestOptions);\n};\n\n/**\n * this method is called by event 'click' on 'GPshowIsochronPicto' picto\n * (cf. this._createShowIsoPictoElement),\n * and clear inputs and previous isocurve drawings\n *\n * @private\n */\nIsocurve.prototype.onShowIsoPanelClick = function() {\n    this.collapsed = this._showIsoContainer.checked;\n    // on gnre nous mme l'evenement OpenLayers de changement de proprit\n    // (utiliser ol.control.Isocurve.on(\"change:collapsed\", function ) pour s'abonner  cet vnement)\n    this.dispatchEvent(\"change:collapsed\");\n};\n\n/**\n * this method is called by event 'change' on 'GPisochronChoiceAltDist' or 'GPisochronChoiceAltChron'\n * input (cf. this._createIsoPanelFormTypeChoiceElement),\n * and updates current computation mode\n *\n * @param {Object} e - HTMLElement\n * @private\n */\nIsocurve.prototype.onIsoTypeChoiceChange = function(e) {\n    var value = e.target.value;\n    if (!value) {\n        return;\n    }\n    if (value === \"isodistance\") {\n        this._currentComputation = \"distance\";\n    }\n    if (value === \"isochron\") {\n        this._currentComputation = \"time\";\n    }\n};\n\n/**\n * this method is called by event 'click' on 'GPisochronTransportPedestrian' or 'GPisochronTransportCar'\n * input (cf. this._createIsoPanelFormModeChoiceTransportElement),\n * and updates current transport mode\n *\n * @param {Object} e - HTMLElement\n * @private\n */\nIsocurve.prototype.onIsoModeTransportChange = function(e) {\n    var value = e.target.value;\n    if (!value) {\n        return;\n    }\n    this._currentTransport = value;\n};\n\n/**\n * this method is called by event 'change' on 'GPisochronDirectionSelect' select\n * (cf. this._createIsoPanelFormModeChoiceDirectionElement),\n * and updates current direction mode\n *\n * @param {Object} e - HTMLElement\n * @private\n */\nIsocurve.prototype.onIsoModeDirectionChange = function(e) {\n    var value = e.target.value;\n    if (!value) {\n        return;\n    }\n    if (value.toLowerCase() === \"arrival\") {\n        this._originPoint._inputLabelContainer.innerHTML = \"Arrive\";\n    } else {\n        this._originPoint._inputLabelContainer.innerHTML = \"Dpart\";\n    }\n    this._currentDirection = value;\n};\n\n/**\n * this method is called by event 'change' on 'GPIsoExclusionsToll'\n * or 'GPIsoeExclusionsTunnel' or 'GPIsoExclusionsBridge' tag input\n * (cf. this._createIsoPanelFormExclusionOptionsElement).\n * this value is saved as a parameter for the service isocurve.\n *\n * @param {Object} e - HTMLElement\n * @private\n */\nIsocurve.prototype.onIsoExclusionsChange = function(e) {\n    var value = e.target.value;\n    var checked = e.target.checked;\n\n    if (!value) {\n        return;\n    }\n\n    var bFound = false;\n    var iFound = null;\n    for (var i = 0; i < this._currentExclusions.length; i++) {\n        if (this._currentExclusions[i] === value) {\n            iFound = i;\n            bFound = true;\n        }\n    }\n    // on l'ajoute si la valeur n'existe pas et est selectionne\n    if (!bFound && !checked) {\n        this._currentExclusions.push(value);\n    }\n    // on la retire si la valeur existe et est deselectionne\n    if (bFound && checked) {\n        this._currentExclusions[iFound] = null;\n    }\n};\n\n/**\n * this method is called by event 'click' on 'GPisoReset'\n * tag label (cf. this._createIsoFormResetElement),\n * and it cleans all isochron input options and results.\n *\n * @private\n */\nIsocurve.prototype.onIsoResetClick = function() {\n    // clear\n    this._clear();\n};\n\n// ################################################################### //\n// ######################## isocurve calculation ##################### //\n// ################################################################### //\n\n/**\n * this method is called by this.onIsoComputationSubmit\n * and executes a request to the service.\n *\n * @param {Object} options - isocurve service request options\n * @private\n */\nIsocurve.prototype._requestIsoCurve = function(options) {\n    // on ne fait pas de requte si on n'a pas renseign de parametres !\n    if (!options || ((typeof options === \"object\") && (Object.keys(options).length === 0))) {\n        return;\n    }\n    // on ne fait pas de requte si on n'a pas de point d'origine\n    if (!options.position) {\n        return;\n    }\n    // ni si on n'a aucun droit\n    if (this._noRightManagement || !this._resources[\"Isocurve\"]) {\n        console.log(\"no rights for this service\");\n        return;\n    }\n\n    // gestion des droits !\n    var resources = this._resources[\"Isocurve\"].resources;\n    if (!resources || (typeof resources === \"object\" && Object.keys(resources).length === 0)) {\n        console.log(\"no rights for this service\");\n        return;\n    }\n\n    // la ressource donne elle des droits ?\n    var bFound = false;\n    for (var i = 0; i < resources.length; i++) {\n        if (resources[i] === options.graph) {\n            bFound = true;\n        }\n    }\n    // on fait quoi ?\n    if (!bFound) {\n        console.log(\"no rights for this service !?\");\n        return;\n    }\n\n    // cas o la clef API n'est pas renseigne dans les options du service,\n    // on utilise celle de l'autoconf ou celle renseigne au niveau du controle\n    var key = this._resources[\"Isocurve\"][\"key\"];\n    options.apiKey = this.options.isocurveOptions.apiKey || this.options.apiKey || key;\n\n    logger.log(options);\n\n    // on efface une ventuelle prcdente couche\n    this._clearGeojsonLayer();\n\n    // mise en place de la patience\n    this._displayWaitingContainer();\n\n    // appel du service de calcul d'isochrones\n    Gp.Services.isoCurve(options);\n\n};\n\n/**\n * this method is called by this.onIsoComputationSubmit (in case of success)\n * and draw isocurve results geometry on map\n *\n * @param {Object} results - isocurve response results\n * @private\n */\nIsocurve.prototype._drawIsoResults = function(results) {\n\n    // sauvegarde de l'etat des resultats\n    this._currentIsoResults = results;\n    // cache la patience\n    this._hideWaitingContainer();\n\n    if (!results.geometry) {\n        return;\n    }\n\n    var map = this.getMap();\n\n    // 1. cration de l'objet geoJSON\n    var geojsonObject = {\n        type: \"Feature\",\n        crs: {\n            type: \"name\",\n            properties: {\n                name: \"EPSG:4326\"\n            }\n        },\n        geometry: results.geometry\n    };\n    var geojsonformat = new ol.format.GeoJSON({\n        defaultDataProjection: \"EPSG:4326\"\n    });\n    var mapProj = map.getView().getProjection().getCode();\n    var features = geojsonformat.readFeatures(\n        geojsonObject, {\n            dataProjection: \"EPSG:4326\",\n            featureProjection: mapProj\n        }\n    );\n\n    // 2. ajout de la gomtrie comme nouvelle couche vecteur  la carte\n    this._geojsonLayer = new ol.layer.Vector({\n        source: new ol.source.Vector({\n            features: features\n        }),\n        style: this._defaultFeatureStyle,\n        opacity: 0.9\n    });\n    // ajout d'un identifiant  la couche\n    var graph;\n    if (this._currentTransport === \"Pieton\") {\n        graph = \"piton\";\n        this._geojsonLayer.gpResultLayerId = \"Pieton$GEOPORTAIL:GPP:Isocurve\";\n    } else {\n        graph = \"voiture\";\n        this._geojsonLayer.gpResultLayerId = \"Voiture$GEOPORTAIL:GPP:Isocurve\";\n    }\n    // ajout  la carte\n    map.addLayer(this._geojsonLayer);\n\n    // 3. Zoom sur l'emprise de la geometry\n    if (features[0] && features[0].getGeometry() && features[0].getGeometry().getExtent()) {\n        var extent = features[0].getGeometry().getExtent();\n        map.getView().fit(extent, map.getSize());\n    }\n\n    // 5. Si un layer switcher est prsent dans la carte, on lui affecte des informations pour cette couche\n    var method = (this._currentComputation === \"time\") ? \"Isochrone\" : \"Isodistance\";\n    map.getControls().forEach(\n        function(control) {\n            if (control instanceof LayerSwitcher) {\n                // un layer switcher est prsent dans la carte\n                var layerId = this._geojsonLayer.gpLayerId;\n                // on n'ajoute des informations que s'il n'y en a pas dj (si le titre est le numro par dfaut)\n                if (control._layers[layerId].title === layerId) {\n                    control.addLayer(\n                        this._geojsonLayer, {\n                            title: method + \" \" + graph,\n                            description: method + \" bas sur un graphe \" + graph\n                        }\n                    );\n                }\n            }\n        },\n        this\n    );\n\n};\n\n// ################################################################### //\n// ############################# Clean ############################### //\n// ################################################################### //\n\n/**\n * this method is called by this.onShowIsoPanelClick()\n * and it clears all elements (reinit).\n *\n * @private\n */\nIsocurve.prototype._clear = function() {\n    // clear inputs\n    this._clearIsoInputs();\n\n    // clear origin point (and marker)\n    this._originPoint.clear();\n\n    // remove geometry layer\n    this._clearGeojsonLayer();\n\n    // clear results\n    this._currentIsoResults = null;\n};\n\n/**\n * this method is called by this._clear()\n * and it clears all input elements (dist and time)\n *\n * @private\n */\nIsocurve.prototype._clearIsoInputs = function() {\n    // 1. clear inputs\n    // clear time inputs (if exists) :\n    // hours\n    var timeHourInput = document.getElementById(\"GPisochronValueChronInput1-\" + this._uid);\n    if (timeHourInput) {\n        timeHourInput.value = \"0\";\n    }\n    // minutes\n    var timeMinutesInput = document.getElementById(\"GPisochronValueChronInput2-\" + this._uid);\n    if (timeMinutesInput) {\n        timeMinutesInput.value = \"0\";\n    }\n    // clear distance input (if exists)\n    var distInput = document.getElementById(\"GPisochronValueDistInput-\" + this._uid);\n    if (distInput) {\n        distInput.value = \"0\";\n    }\n\n    // 2. reinit options to default\n    this._initTransport();\n    this._initComputation();\n    this._initDirection();\n    this._initExclusions();\n\n    // 3. set transport mode to default\n    var transportdiv;\n    if (this._currentTransport === \"Pieton\") {\n        transportdiv = document.getElementById(\"GPisochronTransportPedestrian-\" + this._uid);\n        if (transportdiv) {\n            transportdiv.checked = \"true\";\n        }\n    } else {\n        transportdiv = document.getElementById(\"GPisochronTransportCar-\" + this._uid);\n        if (transportdiv) {\n            transportdiv.checked = \"true\";\n        }\n    }\n\n    // 4. set computation mode to default (distance or time)\n    var computationdiv;\n    if (this._currentComputation.toLowerCase() === \"distance\") {\n        computationdiv = document.getElementById(\"GPisochronChoiceAltDist-\" + this._uid);\n        if (computationdiv) {\n            computationdiv.checked = \"true\";\n        }\n        if (document.getElementById(\"GPisochronValueDist-\" + this._uid)) {\n            document.getElementById(\"GPisochronValueDist-\" + this._uid).className = \"GPflexInput\";\n        }\n        if (document.getElementById(\"GPisochronValueChron-\" + this._uid)) {\n            document.getElementById(\"GPisochronValueChron-\" + this._uid).className = \"GPisochronValueHidden\";\n        }\n    } else {\n        computationdiv = document.getElementById(\"GPisochronChoiceAltChron-\" + this._uid);\n        if (computationdiv) {\n            computationdiv.checked = \"true\";\n        }\n        if (document.getElementById(\"GPisochronValueChron-\" + this._uid)) {\n            document.getElementById(\"GPisochronValueChron-\" + this._uid).className = \"GPflexInput\";\n        }\n        if (document.getElementById(\"GPisochronValueDist-\" + this._uid)) {\n            document.getElementById(\"GPisochronValueDist-\" + this._uid).className = \"GPisochronValueHidden\";\n        }\n    }\n\n    // 5. set direction mode to default (arrival or departure)\n    var directionSelect = document.getElementById(\"GPisochronDirectionSelect-\" + this._uid);\n    if (directionSelect) {\n        directionSelect.value = this._currentDirection;\n    }\n    if (this._currentDirection === \"arrival\") {\n        this._originPoint._inputLabelContainer.innerHTML = \"Arrive\";\n    } else {\n        this._originPoint._inputLabelContainer.innerHTML = \"Dpart\";\n    }\n\n    // 6. set exclusions to default\n    var tollInput = document.getElementById(\"GPisoExclusionsToll-\" + this._uid);\n    if (tollInput) {\n        if (this._currentExclusions.indexOf(\"toll\") !== -1) {\n            tollInput.checked = false;\n        } else {\n            tollInput.checked = true;\n        }\n    }\n    var tunnelInput = document.getElementById(\"GPisoExclusionsTunnel-\" + this._uid);\n    if (tunnelInput) {\n        if (this._currentExclusions.indexOf(\"tunnel\") !== -1) {\n            tunnelInput.checked = false;\n        } else {\n            tunnelInput.checked = true;\n        }\n    }\n    var bridgeInput = document.getElementById(\"GPisoExclusionsBridge-\" + this._uid);\n    if (bridgeInput) {\n        if (this._currentExclusions.indexOf(\"bridge\") !== -1 && bridgeInput) {\n            bridgeInput.checked = false;\n        } else {\n            bridgeInput.checked = true;\n        }\n    }\n};\n\n/**\n * this method is called by this.onIsoComputationSubmit (in case of failure)\n * and it clears all geometries\n *\n * @private\n */\nIsocurve.prototype._clearGeojsonLayer = function() {\n    var map = this.getMap();\n    // remove layer\n    if (this._geojsonLayer) {\n        map.removeLayer(this._geojsonLayer);\n        this._geojsonLayer = null;\n    }\n};\n\n/**\n * this method is called by event 'click' on control main container\n * and hide suggested Locations (unless target is an autocomplete input)\n *\n * @private\n */\nIsocurve.prototype._hideIsoSuggestedLocations = function(e) {\n    // si on clique sur l'input de saisie du point d'origine\n    if (e.target && e.target.id && e.target.id.indexOf(\"GPlocationOrigin_\") !== -1) {\n        return;\n    } else {\n        // si on clique ailleurs dans le DOM du control, on cache tous les rsultats d'autocompltion\n        this._originPoint._hideSuggestedLocation();\n    }\n};\n\n/**\n * this method displays waiting container and sets a timeout\n *\n * @private\n */\nIsocurve.prototype._displayWaitingContainer = function() {\n\n    this._waitingContainer.className = \"GPisochronCalcWaitingContainerVisible\";\n    this._waiting = true;\n\n    // mise en place d'un timeout pour rinitialiser le panel (cacher la patience)\n    // si on est toujours en attente (si la requte est bloque par exemple)\n    var opts = this.options.isocurveOptions;\n    if (opts && opts.timeOut) {\n        if (this._timer) {\n            clearTimeout(this._timer);\n            this._timer = null;\n        }\n        var context = this;\n        this._timer = setTimeout(function() {\n            if (context._waiting === true) {\n                context._hideWaitingContainer();\n            } else {\n                if (context._timer) {\n                    clearTimeout(context._timer);\n                }\n            }\n        }, 16000);\n    }\n};\n\n/**\n * this method hides waiting container and clears timeout\n *\n * @private\n */\nIsocurve.prototype._hideWaitingContainer = function() {\n    if (this._waiting) {\n        this._waitingContainer.className = \"GPisochronCalcWaitingContainerHidden\";\n        this._waiting = false;\n        var opts = this.options.isocurveOptions;\n        if (opts && opts.timeOut) {\n            clearTimeout(this._timer);\n            this._timer = null;\n        }\n    }\n};\n\nexport default Isocurve;\n\n\n\n// WEBPACK FOOTER //\n// ./src/OpenLayers/Controls/Isocurve.js","/**\n * desativation JSHINT\n * W083 - Don't make functions within a loop.\n */\n\nvar IsoDOM = {\n\n    /** Add uuid to the tag ID */\n    _addUID: function(id) {\n        var uid = (this._uid) ? id + \"-\" + this._uid : id;\n        return uid;\n    },\n\n    /**\n     * Main container (DOM)\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createMainContainerElement: function() {\n\n        var container = document.createElement(\"div\");\n        container.id = this._addUID(\"GPisochron\");\n        container.className = \"GPwidget\";\n        return container;\n    },\n\n    // ################################################################### //\n    // ################# Methods to display Main Panel ################### //\n    // ################################################################### //\n\n    /**\n     * Hidden checkbox for minimizing/maximizing panel\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createShowIsoElement: function() {\n        var input = document.createElement(\"input\");\n        input.id = this._addUID(\"GPshowIsochron\");\n        input.type = \"checkbox\";\n        return input;\n    },\n\n    /**\n     * Show iso control\n     * see event !\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createShowIsoPictoElement: function() {\n\n        // contexte d'execution\n        var context = this;\n\n        var label = document.createElement(\"label\");\n        label.id = this._addUID(\"GPshowIsochronPicto\");\n        label.className = \"GPshowAdvancedToolPicto\";\n        label.htmlFor = this._addUID(\"GPshowIsochron\");\n        label.title = \"Calculer une isochrone\";\n\n        // gestionnaire d'evenement :\n        // on ouvre le menu de saisie du calcul d'isochrone\n        // L'ouverture/Fermeture permet de faire le menage\n        // (reinitialisation)\n        if (label.addEventListener) {\n            label.addEventListener(\"click\", function(e) {\n                context.onShowIsoPanelClick(e);\n            });\n        } else if (label.attachEvent) {\n            label.attachEvent(\"onclick\", function(e) {\n                context.onShowIsoPanelClick(e);\n            });\n        }\n\n        var spanOpen = document.createElement(\"span\");\n        spanOpen.id = this._addUID(\"GPshowIsochronOpen\");\n        spanOpen.className = \"GPshowAdvancedToolOpen\";\n        label.appendChild(spanOpen);\n\n        return label;\n    },\n\n    // ################################################################### //\n    // ################## Methods to display Inputs Panel ################ //\n    // ################################################################### //\n\n    /**\n     * Create Container Panel\n     *\n     * FIXME\n     * don't call this._createIsoPanelHeaderElement\n     * don't call this._createIsoPanelFormElement\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createIsoPanelElement: function() {\n        var div = document.createElement(\"div\");\n        div.id = this._addUID(\"GPisochronPanel\");\n        div.className = \"GPpanel\";\n\n        // div.appendChild(this._createIsoPanelHeaderElement());\n        // div.appendChild(this._createIsoPanelFormElement());\n\n        return div;\n    },\n\n    /**\n     * Create Header Panel\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createIsoPanelHeaderElement: function() {\n\n        var self = this;\n\n        var container = document.createElement(\"div\");\n        container.className = \"GPpanelHeader\";\n\n        var div = document.createElement(\"div\");\n        div.className = \"GPpanelTitle\";\n        div.innerHTML = \"Calcul d'isochrone\";\n        container.appendChild(div);\n\n        // on desactive l'impl. reduction de la fenetre\n        // var divReduce  = document.createElement(\"div\");\n        // divReduce.id = this._addUID(\"GPisochronPanelReduce\");\n        // divReduce.className = \"GPpanelReduce\";\n        // divReduce.title = \"Masquer le panneau\";\n        //\n        // if (divReduce.addEventListener) {\n        //     divReduce.addEventListener(\"click\", function () {\n        //         if ( typeof self.onReduceIsoPanelClick === \"function\") {\n        //             document.getElementById(self._addUID(\"GPshowIsochron\")).checked = false;\n        //             self.onReduceIsoPanelClick();\n        //         }\n        //     }, false);\n        // } else if (divReduce.attachEvent) {\n        //     divReduce.attachEvent(\"onclick\", function () {\n        //         if ( typeof self.onReduceIsoPanelClick === \"function\") {\n        //             document.getElementById(self._addUID(\"GPshowIsochron\")).checked = false;\n        //             self.onReduceIsoPanelClick();\n        //         }\n        //     });\n        // }\n        // container.appendChild(divReduce);\n\n        var divClose = document.createElement(\"div\");\n        divClose.id = this._addUID(\"GPisochronPanelClose\");\n        divClose.className = \"GPpanelClose\";\n        divClose.title = \"Fermer le panneau\";\n\n        // Link panel close / visibility checkbox\n        if (divClose.addEventListener) {\n            divClose.addEventListener(\"click\", function() {\n                document.getElementById(self._addUID(\"GPshowIsochronPicto\")).click();\n            }, false);\n        } else if (divClose.attachEvent) {\n            divClose.attachEvent(\"onclick\", function() {\n                document.getElementById(self._addUID(\"GPshowIsochronPicto\")).click();\n            });\n        }\n        container.appendChild(divClose);\n\n        return container;\n    },\n\n    /**\n     * Create Form\n     * see evenement !\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createIsoPanelFormElement: function() {\n\n        // contexte d'execution\n        var self = this;\n\n        var form = document.createElement(\"form\");\n        form.id = this._addUID(\"GPisochronForm\");\n\n        form.addEventListener(\"submit\", function(e) {\n\n            e.preventDefault();\n            self.onIsoComputationSubmit(e);\n            return false;\n        });\n\n        return form;\n    },\n\n    /**\n     * Create Waiting Panel\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createIsoWaitingElement: function() {\n        var div = document.createElement(\"div\");\n        div.id = this._addUID(\"GPisochronCalcWaitingContainer\");\n        div.className = \"GPisochronCalcWaitingContainerHidden\";\n\n        var p = document.createElement(\"p\");\n        p.className = \"GPisochronCalcWaiting\";\n        p.innerHTML = \"Calcul en cours...\";\n\n        div.appendChild(p);\n\n        return div;\n    },\n\n    // ################################################################### //\n    // ############# Methods to the type choice into form ################ //\n    // ################################################################### //\n\n    /**\n     * Create Container to type choice\n     *\n     * FIXME\n     * don't call this._createIsoPanelFormTypeChoiceChronElement\n     * don't call this._createIsoPanelFormTypeChoiceDistElement\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createIsoPanelFormTypeChoiceElement: function() {\n        var div = document.createElement(\"div\");\n        div.id = this._addUID(\"GPisochronChoice\");\n\n        // div.appendChild(this._createIsoPanelFormTypeChoiceChronElement());\n        // div.appendChild(this._createIsoPanelFormTypeChoiceDistElement());\n\n        return div;\n    },\n\n    /**\n     * Create Type choice Chron\n     * see event !\n     * FIXME event not useful\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createIsoPanelFormTypeChoiceChronElement: function(checked) {\n\n        var self = this;\n\n        var div = document.createElement(\"div\");\n        div.className = \"GPisochronChoiceAlt\";\n\n        var input = document.createElement(\"input\");\n        input.id = this._addUID(\"GPisochronChoiceAltChron\");\n        input.name = \"GPisochronChoiceMode\";\n        input.type = \"radio\";\n        input.checked = (checked) ? true : false;\n        if (input.addEventListener) {\n            input.addEventListener(\"change\", function(e) {\n                document.getElementById(self._addUID(\"GPisochronValueChron\")).className = \"GPflexInput\";\n                document.getElementById(self._addUID(\"GPisochronValueDist\")).className = \"GPisochronValueHidden\";\n                self.onIsoTypeChoiceChange(e);\n            }, false);\n        } else if (input.attachEvent) {\n            input.attachEvent(\"onchange\", function() {\n                document.getElementById(self._addUID(\"GPisochronValueChron\")).className = \"GPflexInput\";\n                document.getElementById(self._addUID(\"GPisochronValueDist\")).className = \"GPisochronValueHidden\";\n                self.onIsoTypeChoiceChange();\n            });\n        }\n        // info: Internet explorer support\n        input.value = \"isochron\";\n        div.appendChild(input);\n\n        var label = document.createElement(\"label\");\n        label.className = \"GPisochronChoiceAltImg\";\n        label.htmlFor = this._addUID(\"GPisochronChoiceAltChron\");\n        div.appendChild(label);\n\n        var span = document.createElement(\"span\");\n        span.id = this._addUID(\"GPisochronChoiceAltChronTxt\");\n        span.innerHTML = \"isochrone\";\n        if (span.addEventListener) {\n            span.addEventListener(\"click\", function() {\n                document.getElementById(self._addUID(\"GPisochronChoiceAltChron\")).click();\n            }, false);\n        } else if (span.attachEvent) {\n            span.attachEvent(\"onclick\", function() {\n                document.getElementById(self._addUID(\"GPisochronChoiceAltChron\")).click();\n            });\n        }\n        div.appendChild(span);\n\n        return div;\n    },\n\n    /**\n     * Create Type choice Dist\n     * see event !\n     * FIXME event not useful\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createIsoPanelFormTypeChoiceDistElement: function(checked) {\n\n        var self = this;\n\n        var div = document.createElement(\"div\");\n        div.className = \"GPisochronChoiceAlt\";\n\n        var input = document.createElement(\"input\");\n        input.id = this._addUID(\"GPisochronChoiceAltDist\");\n        input.name = \"GPisochronChoiceMode\";\n        input.type = \"radio\";\n        input.checked = (checked) ? true : false;\n        if (input.addEventListener) {\n            input.addEventListener(\"change\", function(e) {\n                document.getElementById(self._addUID(\"GPisochronValueDist\")).className = \"GPflexInput\";\n                document.getElementById(self._addUID(\"GPisochronValueChron\")).className = \"GPisochronValueHidden\";\n                self.onIsoTypeChoiceChange(e);\n            }, false);\n        } else if (input.attachEvent) {\n            input.attachEvent(\"onchange\", function() {\n                document.getElementById(self._addUID(\"GPisochronValueDist\")).className = \"GPflexInput\";\n                document.getElementById(self._addUID(\"GPisochronValueChron\")).className = \"GPisochronValueHidden\";\n                self.onIsoTypeChoiceChange();\n            });\n        }\n        // info: Internet explorer support\n        input.value = \"isodistance\";\n        div.appendChild(input);\n\n        var label = document.createElement(\"label\");\n        label.className = \"GPisochronChoiceAltImg\";\n        label.htmlFor = this._addUID(\"GPisochronChoiceAltDist\");\n        div.appendChild(label);\n\n        var span = document.createElement(\"span\");\n        span.id = this._addUID(\"GPisochronChoiceAltDistTxt\");\n        span.innerHTML = \"isodistance\";\n        if (span.addEventListener) {\n            span.addEventListener(\"click\", function() {\n                document.getElementById(self._addUID(\"GPisochronChoiceAltDist\")).click();\n            }, false);\n        } else if (span.attachEvent) {\n            span.attachEvent(\"onclick\", function() {\n                document.getElementById(self._addUID(\"GPisochronChoiceAltDist\")).click();\n            });\n        }\n        div.appendChild(span);\n\n        return div;\n    },\n\n    // ################################################################### //\n    // ############### Methods to the value iso into form ################ //\n    // ################################################################### //\n\n    /**\n     * Create isochron inputs values\n     * see event !\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createIsoPanelFormValueIsochronElement: function(checked) {\n\n        // contexte\n        var context = this;\n\n        var div = document.createElement(\"div\");\n        div.id = this._addUID(\"GPisochronValueChron\");\n        div.className = (checked) ? \"GPflexInput\" : \"GPisochronValueHidden\";\n\n        var label = document.createElement(\"label\");\n        label.id = this._addUID(\"GPisochronValueChronLabel\");\n        label.htmlFor = this._addUID(\"GPisochronValueChronInput\");\n        label.innerHTML = \"Temps\";\n        div.appendChild(label);\n\n        var input1 = document.createElement(\"input\");\n        input1.id = this._addUID(\"GPisochronValueChronInput1\");\n        input1.min = \"0\";\n        input1.step = \"1\";\n        input1.value = \"0\";\n        input1.type = \"number\";\n        if (input1.addEventListener) {\n            input1.addEventListener(\"change\", function(e) {\n                if (typeof context.onIsoValueChronTimeMinuteChange === \"function\") {\n                    context.onIsoValueChronTimeHourChange(e);\n                }\n            });\n        } else if (input1.attachEvent) {\n            input1.attachEvent(\"onchange\", function(e) {\n                if (typeof context.onIsoValueChronTimeMinuteChange === \"function\") {\n                    context.onIsoValueChronTimeHourChange(e);\n                }\n            });\n        }\n        div.appendChild(input1);\n\n        var label1 = document.createElement(\"label\");\n        label1.innerHTML = \"h\";\n        div.appendChild(label1);\n\n        var input2 = document.createElement(\"input\");\n        input2.id = this._addUID(\"GPisochronValueChronInput2\");\n        input2.min = \"0\";\n        input2.max = \"59\";\n        input2.step = \"1\";\n        input2.value = \"0\";\n        input2.type = \"number\";\n        if (input2.addEventListener) {\n            input2.addEventListener(\"change\", function(e) {\n                if (typeof context.onIsoValueChronTimeMinuteChange === \"function\") {\n                    context.onIsoValueChronTimeMinuteChange(e);\n                }\n            });\n        } else if (input2.attachEvent) {\n            input2.attachEvent(\"onchange\", function(e) {\n                if (typeof context.onIsoValueChronTimeMinuteChange === \"function\") {\n                    context.onIsoValueChronTimeMinuteChange(e);\n                }\n            });\n        }\n        div.appendChild(input2);\n\n        var label2 = document.createElement(\"label\");\n        label2.innerHTML = \"min\";\n        div.appendChild(label2);\n\n        return div;\n    },\n\n    /**\n     * Create isodistance inputs values\n     * see event !\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createIsoPanelFormValueIsodistanceElement: function(checked) {\n\n        // contexte\n        var context = this;\n\n        var div = document.createElement(\"div\");\n        div.id = this._addUID(\"GPisochronValueDist\");\n        div.className = (checked) ? \"GPflexInput\" : \"GPisochronValueHidden\";\n\n        var label = document.createElement(\"label\");\n        label.id = this._addUID(\"GPisochronValueDistLabel\");\n        label.htmlFor = this._addUID(\"GPisochronValueDistInput\");\n        label.innerHTML = \"Distance\";\n        div.appendChild(label);\n\n        var input1 = document.createElement(\"input\");\n        input1.id = this._addUID(\"GPisochronValueDistInput\");\n        input1.min = \"0\";\n        input1.step = \"any\";\n        input1.value = \"0\";\n        input1.type = \"number\";\n        if (input1.addEventListener) {\n            input1.addEventListener(\"change\", function(e) {\n                if (typeof context.onIsoValueDistChange === \"function\") {\n                    context.onIsoValueDistChange(e);\n                }\n            });\n        } else if (input1.attachEvent) {\n            input1.attachEvent(\"onchange\", function(e) {\n                if (typeof context.onIsoValueDistChange === \"function\") {\n                    context.onIsoValueDistChange(e);\n                }\n            });\n        }\n        div.appendChild(input1);\n\n        var label1 = document.createElement(\"label\");\n        label1.innerHTML = \"km\";\n        div.appendChild(label1);\n\n        return div;\n    },\n\n    // ################################################################### //\n    // ############ Methods to the mode choice into form ################# //\n    // ################################################################### //\n\n    /**\n     * Create Container to Mode choice\n     *\n     * FIXME\n     * don't call this._createIsoPanelFormModeChoiceTransportElement\n     * don't call this._createIsoPanelFormModeChoiceDirectionElement\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createIsoPanelFormModeChoiceElement: function() {\n        var div = document.createElement(\"div\");\n        div.id = this._addUID(\"GPisochronModeChoice\");\n\n        // div.appendChild(this._createIsoPanelFormModeChoiceTransportElement());\n        // div.appendChild(this._createIsoPanelFormModeChoiceDirectionElement());\n\n        return div;\n    },\n\n    /**\n     * Create Mode choice transport\n     * see event !\n     * FIXME event not useful\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createIsoPanelFormModeChoiceTransportElement: function(transports) {\n\n        // contexte d'execution\n        var context = this;\n\n        var div = document.createElement(\"div\");\n        div.id = this._addUID(\"GPisochronTransportChoice\");\n\n        var span = document.createElement(\"span\");\n        span.className = \"GPisochronModeLabel\";\n        span.innerHTML = \"Mode de transport\";\n        div.appendChild(span);\n\n        /* jshint -W083 */\n        for (var i = 0; i < transports.length; i++) {\n            var transport = transports[i];\n\n            if (transport === \"Voiture\") {\n\n                var inputCar = document.createElement(\"input\");\n                inputCar.id = this._addUID(\"GPisochronTransportCar\");\n                inputCar.type = \"radio\";\n                inputCar.name = \"GPisochronTransport\";\n                if (i === 0) {\n                    inputCar.checked = true;\n                }\n                // gestionnaire d'evenement :\n                // on stocke le mode de transport,\n                // utilisation pour la requte sur le service de calcul d'itiniraire\n                if (inputCar.addEventListener) {\n                    inputCar.addEventListener(\"change\", function(e) {\n                        context.onIsoModeTransportChange(e);\n                    });\n                } else if (inputCar.attachEvent) {\n                    inputCar.attachEvent(\"onchange\", function(e) {\n                        context.onIsoModeTransportChange(e);\n                    });\n                }\n                // info : internet explorer support\n                inputCar.value = \"Voiture\";\n                div.appendChild(inputCar);\n\n                var labelCar = document.createElement(\"label\");\n                labelCar.className = \"GPisochronTransportImg\";\n                labelCar.htmlFor = this._addUID(\"GPisochronTransportCar\");\n                labelCar.title = \"Voiture\";\n                div.appendChild(labelCar);\n\n            }\n\n            if (transport === \"Pieton\") {\n\n                var inputPedestrian = document.createElement(\"input\");\n                inputPedestrian.id = this._addUID(\"GPisochronTransportPedestrian\");\n                inputPedestrian.type = \"radio\";\n                inputPedestrian.name = \"GPisochronTransport\";\n                if (i === 0) {\n                    inputPedestrian.checked = true;\n                }\n                // gestionnaire d'evenement :\n                // on stocke le mode de transport,\n                // utilisation pour la requte sur le service de calcul d'itiniraire\n                if (inputPedestrian.addEventListener) {\n                    inputPedestrian.addEventListener(\"change\", function(e) {\n                        context.onIsoModeTransportChange(e);\n                    });\n                } else if (inputPedestrian.attachEvent) {\n                    inputPedestrian.attachEvent(\"onchange\", function(e) {\n                        context.onIsoModeTransportChange(e);\n                    });\n                }\n                // info : internet explorer support\n                inputPedestrian.value = \"Pieton\";\n                div.appendChild(inputPedestrian);\n\n                var labelPedestrian = document.createElement(\"label\");\n                labelPedestrian.className = \"GPisochronTransportImg\";\n                labelPedestrian.htmlFor = this._addUID(\"GPisochronTransportPedestrian\");\n                labelPedestrian.title = \"Piton\";\n                div.appendChild(labelPedestrian);\n            }\n        }\n\n        return div;\n    },\n\n    /**\n     * Create Mode choice direction\n     * see event!\n     *\n     * @param {Array} directions - directions to display in list (\"Departure\", \"Arrival\"). First element will be selected by default\n     * @returns {DOMElement} DOM element\n     */\n    _createIsoPanelFormModeChoiceDirectionElement: function(directions) {\n\n        // contexte d'execution\n        var self = this;\n\n        var div = document.createElement(\"div\");\n        div.id = this._addUID(\"GPisochronDirectionChoice\");\n\n        var span = document.createElement(\"span\");\n        span.className = \"GPisochronModeLabel\";\n        span.innerHTML = \"Sens de parcours\";\n        div.appendChild(span);\n\n        var select = document.createElement(\"select\");\n        select.id = this._addUID(\"GPisochronDirectionSelect\");\n        select.className = \"GPinputSelect\";\n        // gestionnaire d'evenement :\n        // on stocke la valeur du mode de calcul,\n        // utilisation pour la requte sur le service de calcul d'iso\n        select.addEventListener(\"change\", function(e) {\n            self.onIsoModeDirectionChange(e);\n        });\n\n        for (var i = 0; i < directions.length; i++) {\n            var direction = directions[i];\n            if (direction.toLowerCase() === \"departure\") {\n                var departureOption = document.createElement(\"option\");\n                if (i === 0) {\n                    departureOption.selected = \"selected\";\n                }\n                departureOption.value = \"departure\";\n                departureOption.text = \"Dpart\";\n                select.appendChild(departureOption);\n            }\n            if (direction.toLowerCase() === \"arrival\") {\n                var arrivalOption = document.createElement(\"option\");\n                if (i === 0) {\n                    arrivalOption.selected = \"selected\";\n                }\n                arrivalOption.value = \"arrival\";\n                arrivalOption.text = \"Arrive\";\n                select.appendChild(arrivalOption);\n            }\n        }\n        div.appendChild(select);\n\n        return div;\n    },\n\n    // ################################################################### //\n    // ################# Methods to the choice exclusions ################ //\n    // ################################################################### //\n\n    /**\n     * Hidden checkbox for minimizing/maximizing Exclusions Options\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createShowIsoExclusionsElement: function() {\n        var input = document.createElement(\"input\");\n        input.id = this._addUID(\"GPshowIsoExclusions\");\n        input.type = \"checkbox\";\n        return input;\n    },\n\n    /**\n     * Label to Exclusions Options\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createShowIsoExclusionsPictoElement: function() {\n\n        var label = document.createElement(\"label\");\n        label.id = this._addUID(\"GPshowIsoExclusionsPicto\");\n        label.className = \"GPshowMoreOptions GPshowIsoExclusionsPicto\";\n        label.htmlFor = this._addUID(\"GPshowIsoExclusions\");\n        label.title = \"Exclusions\";\n        label.style.top = \"240px\";\n\n        return label;\n    },\n\n    /**\n     * Create Container to Exclusions\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createIsoPanelFormExclusionsElement: function() {\n\n        var div = document.createElement(\"div\");\n        div.id = this._addUID(\"GPisoExclusions\");\n\n        var span = document.createElement(\"span\");\n        span.className = \"GPisoExclusionsLabel\";\n        span.innerHTML = \"Passages autoriss\";\n        div.appendChild(span);\n\n        // div.appendChild(this._createIsoPanelFormExclusionOptionsElement());\n\n        return div;\n    },\n\n    /**\n     * Create Exclusions Options\n     * see event !\n     * FIXME event not useful\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createIsoPanelFormExclusionOptionsElement: function(exclusions) {\n\n        // contexte d'execution\n        var context = this;\n\n        var div = document.createElement(\"div\");\n        div.className = \"GPisoExclusionsOptions\";\n\n        /* jshint -W083 */\n        for (var value in exclusions) {\n            if (exclusions.hasOwnProperty(value)) {\n\n                var status = exclusions[value];\n                switch (value) {\n                    case \"toll\":\n                        var inputToll = document.createElement(\"input\");\n                        inputToll.id = this._addUID(\"GPisoExclusionsToll\");\n                        inputToll.type = \"checkbox\";\n                        inputToll.checked = !status;\n                        // gestionnaire d'evenement :\n                        // on stocke l'exclusion,\n                        // utilisation pour la requte sur le service de calcul d'itiniraire\n                        if (inputToll.addEventListener) {\n                            inputToll.addEventListener(\"change\", function(e) {\n                                context.onIsoExclusionsChange(e);\n                            });\n                        } else if (inputToll.attachEvent) {\n                            inputToll.attachEvent(\"onchange\", function(e) {\n                                context.onIsoExclusionsChange(e);\n                            });\n                        }\n                        // info : internet explorer support\n                        inputToll.value = \"Toll\";\n                        div.appendChild(inputToll);\n\n                        var labelToll = document.createElement(\"label\");\n                        labelToll.className = \"GPisoExclusionsOption\";\n                        labelToll.htmlFor = this._addUID(\"GPisoExclusionsToll\");\n                        labelToll.innerHTML = \"Pages\";\n                        div.appendChild(labelToll);\n                        break;\n\n                    case \"tunnel\":\n                        var inputTunnel = document.createElement(\"input\");\n                        inputTunnel.id = this._addUID(\"GPisoExclusionsTunnel\");\n                        inputTunnel.type = \"checkbox\";\n                        inputTunnel.checked = !status;\n                        // gestionnaire d'evenement :\n                        // on stocke l'exclusion,\n                        // utilisation pour la requte sur le service de calcul d'itiniraire\n                        if (inputTunnel.addEventListener) {\n                            inputTunnel.addEventListener(\"change\", function(e) {\n                                context.onIsoExclusionsChange(e);\n                            });\n                        } else if (inputTunnel.attachEvent) {\n                            inputTunnel.attachEvent(\"onchange\", function(e) {\n                                context.onIsoExclusionsChange(e);\n                            });\n                        }\n                        // info : internet explorer support\n                        inputTunnel.value = \"Tunnel\";\n                        div.appendChild(inputTunnel);\n\n                        var labelTunnel = document.createElement(\"label\");\n                        labelTunnel.className = \"GPisoExclusionsOption\";\n                        labelTunnel.htmlFor = this._addUID(\"GPisoExclusionsTunnel\");\n                        labelTunnel.innerHTML = \"Tunnels\";\n                        div.appendChild(labelTunnel);\n                        break;\n\n                    case \"bridge\":\n                        var inputBridge = document.createElement(\"input\");\n                        inputBridge.id = this._addUID(\"GPisoExclusionsBridge\");\n                        inputBridge.type = \"checkbox\";\n                        inputBridge.checked = !status;\n                        // gestionnaire d'evenement :\n                        // on stocke l'exclusion,\n                        // utilisation pour la requte sur le service de calcul d'itiniraire\n                        if (inputBridge.addEventListener) {\n                            inputBridge.addEventListener(\"change\", function(e) {\n                                context.onIsoExclusionsChange(e);\n                            });\n                        } else if (inputBridge.attachEvent) {\n                            inputBridge.attachEvent(\"onchange\", function(e) {\n                                context.onIsoExclusionsChange(e);\n                            });\n                        }\n                        // info : internet explorer support\n                        inputBridge.value = \"Bridge\";\n                        div.appendChild(inputBridge);\n\n                        var labelBridge = document.createElement(\"label\");\n                        labelBridge.className = \"GPisoExclusionsOption\";\n                        labelBridge.htmlFor = this._addUID(\"GPisoExclusionsBridge\");\n                        labelBridge.innerHTML = \"Ponts\";\n                        div.appendChild(labelBridge);\n                        break;\n                }\n            }\n        }\n\n        return div;\n    },\n\n    // ################################################################### //\n    // ############################### Submit Form ####################### //\n    // ################################################################### //\n\n    /**\n     * Create Submit Form Element\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createIsoSubmitFormElement: function() {\n\n        var input = document.createElement(\"input\");\n        input.id = this._addUID(\"GPisochronSubmit\");\n        input.className = \"GPinputSubmit\";\n        input.type = \"submit\";\n        input.value = \"Calculer\";\n\n        return input;\n    },\n\n    // ################################################################### //\n    // ############################### Reset picto ####################### //\n    // ################################################################### //\n\n    /**\n     * Create Reset Picto Element\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createIsoFormResetElement: function() {\n\n        var self = this;\n\n        var divReset = document.createElement(\"div\");\n        divReset.id = this._addUID(\"GPisochronReset\");\n        divReset.title = \"Rinitialiser les paramtres\";\n        divReset.addEventListener(\"click\", function(e) {\n            self.onIsoResetClick(e);\n        });\n\n        return divReset;\n    }\n};\n\nexport default IsoDOM;\n\n\n\n// WEBPACK FOOTER //\n// ./src/Common/Controls/IsoDOM.js","import ol from \"ol\";\nimport Gp from \"gp\";\nimport Logger from \"../../Common/Utils/LoggerByDefault\";\nimport Utils from \"../../Common/Utils\";\nimport Markers from \"./Utils/Markers\";\nimport LayerSwitcher from \"./LayerSwitcher\";\nimport RightManagement from \"../../Common/Utils/CheckRightManagement\";\nimport SelectorID from \"../../Common/Utils/SelectorID\";\nimport ReverseGeocodingDOM from \"../../Common/Controls/ReverseGeocodingDOM\";\n\n\nvar logger = Logger.getLogger(\"reversegeocoding\");\n\n/**\n * @classdesc\n *\n * ReverseGeocode Control.\n *\n * @constructor\n * @alias ol.control.ReverseGeocode\n * @extends {ol.control.Control}\n * @param {Object} options - ReverseGeocode control options\n * @param {String}   [options.apiKey] - API key for services call (reverse geocode service), mandatory if autoconf service has not been charged in advance\n * @param {Boolean} [options.collapsed = true] - Specify if widget has to be collapsed (true) or not (false) on map loading. Default is true.\n * @param {Object}   [options.resources =  [\"StreetAddress\", \"PositionOfInterest\", \"CadastralParcel\"]] - resources for geocoding, by default : [\"StreetAddress\", \"PositionOfInterest\", \"CadastralParcel\"]. Possible values are : \"StreetAddress\", \"PositionOfInterest\", \"CadastralParcel\", \"Administratif\". Resources will be displayed in the same order in widget list.\n * @param {Object}   [options.delimitations = [\"Point\", \"Circle\", \"Extent\"]] - delimitations for reverse geocoding, by default : [\"Point\", \"Circle\", \"Extent\"]. Possible values are : \"Point\", \"Circle\", \"Extent\". Delimitations will be displayed in the same order in widget list.\n * @param {Object}  [options.reverseGeocodeOptions = {}] - reverse geocode service options. see {@link http://ignf.github.io/geoportal-access-lib/latest/jsdoc/module-Services.html#~reverseGeocode Gp.Services.reverseGeocode()} to know all reverse geocode options.\n * @example\n *  var iso = ol.control.ReverseGeocode({\n *      collapsed : false,\n *      resources : [\"StreetAddress\", \"PositionOfInterest\"],\n *      delimitations : [\"Point\", \"Circle\"],\n *      reverseGeocodeOptions : {}\n *  });\n */\nfunction ReverseGeocode(options) {\n    options = options || {};\n\n    if (!(this instanceof ReverseGeocode)) {\n        throw new TypeError(\"ERROR CLASS_CONSTRUCTOR\");\n    }\n\n    // initialisation du composant\n    this.initialize(options);\n\n    // Widget main DOM container\n    this._container = this._initContainer();\n    this._containerElement = null;\n\n    // on peut ventuellement encapsuler le composant dans une div passe par l'utilisateur\n    if (options.element && options.element.appendChild) {\n        // dans ce cas on stocke les deux container\n        options.element.appendChild(this._container);\n        this._containerElement = options.element;\n    }\n\n    // call ol.control.Control constructor\n    ol.control.Control.call(this, {\n        element: this._containerElement || this._container,\n        target: options.target,\n        render: options.render\n    });\n};\n\n// Inherits from ol.control.Control\nol.inherits(ReverseGeocode, ol.control.Control);\n\n/**\n * @lends module:ReverseGeocode\n */\nReverseGeocode.prototype = Object.create(ol.control.Control.prototype, {});\n\n// on rcupre les mthodes de la classe commune ReverseGeocodingDOM\nUtils.assign(ReverseGeocode.prototype, ReverseGeocodingDOM);\n\n/**\n * Constructor (alias)\n *\n * @private\n */\nReverseGeocode.prototype.constructor = ReverseGeocode;\n\n// ################################################################### //\n// ############## public methods (getters, setters) ################## //\n// ################################################################### //\n\n/**\n * Returns true if widget is collapsed (minimized), false otherwise\n *\n * @returns {Boolean} collapsed - true if widget is collapsed\n */\nReverseGeocode.prototype.getCollapsed = function() {\n    return this.collapsed;\n};\n\n/**\n * Collapse or display widget main container\n *\n * @param {Boolean} collapsed - True to collapse widget, False to display it\n */\nReverseGeocode.prototype.setCollapsed = function(collapsed) {\n    if (collapsed === undefined) {\n        console.log(\"[ERROR] ReverseGeocode:setCollapsed - missing collapsed parameter\");\n        return;\n    }\n    if ((collapsed && this.collapsed) || (!collapsed && !this.collapsed)) {\n        return;\n    }\n    if (collapsed) {\n        document.getElementById(\"GPreverseGeocodingPanelClose-\" + this._uid).click();\n    } else {\n        document.getElementById(\"GPshowReverseGeocoding-\" + this._uid).click();\n    }\n    this.collapsed = collapsed;\n};\n\n/**\n * Overwrite OpenLayers setMap method\n *\n * @param {ol.Map} map - Map.\n */\nReverseGeocode.prototype.setMap = function(map) {\n\n    if (map) {\n        // lors de l'ajout  la map, on active la saisie du point ou de la zone de recherche sur la carte,\n        // mais seulement si le widget est ouvert\n        this._activateMapInteraction(map);\n    } else {\n        var _map = this.getMap();\n        // on remet  zro = on efface les gomtries + interactions + valeurs stockes\n        // suppression des rsultats prcdents\n        this._clearResults();\n        // on efface les points qui ont pu tre saisis prcdemment\n        this._clearInputFeatures();\n        // on supprime l'ventuelle prcdente interaction\n        this._removeMapInteraction(_map);\n        // on retire aussi la couche de saisie de la zone de recherche  la fermeture du widget\n        if (this._inputFeaturesLayer != null) {\n            _map.removeLayer(this._inputFeaturesLayer);\n            this._inputFeaturesLayer = null;\n            this._inputFeaturesSources = null;\n            this._inputFeatures = null;\n        }\n    }\n\n    // on appelle la mthode setMap originale d'OpenLayers\n    ol.control.Control.prototype.setMap.call(this, map);\n\n};\n\n// ################################################################### //\n// ##################### init component ############################## //\n// ################################################################### //\n\n/**\n * Initialize ReverseGeocode control (called by ReverseGeocode constructor)\n *\n * @param {Object} options - constructor options\n * @private\n */\nReverseGeocode.prototype.initialize = function(options) {\n\n    // ############################################################ //\n    // ################### Options du composant ################### //\n\n    // check input options format (resources and delimitations arrays)\n    this._checkInputOptions(options);\n\n    // set default options\n    this.options = {\n        collapsed: true,\n        resources: [\"StreetAddress\", \"PositionOfInterest\", \"CadastralParcel\"],\n        delimitations: [\"Point\", \"Circle\", \"Extent\"],\n        reverseGeocodeOptions: {}\n    };\n\n    // merge with user options\n    Utils.assign(this.options, options);\n\n    /** {Boolean} specify if reverseGeocoding control is collapsed (true) or not (false) */\n    this.collapsed = this.options.collapsed;\n\n    // identifiant du contrle : utile pour suffixer les identifiants CSS (pour grer le cas o il y en a plusieurs dans la mme page)\n    this._uid = SelectorID.generate();\n\n    // #################################################################### //\n    // ################### informations sur les droits #################### //\n\n    // ressources des services d'autocompletion et de geocodage\n    this._servicesRightManagement = {};\n\n    // gestion des droits sur les ressources\n    this._noRightManagement = false;\n\n    // gestion des droits sur les ressources/services\n    this._checkRightsManagement();\n\n    // #################################################################### //\n    // ################### informations sur les droits #################### //\n\n    // Type de gocodage slectionn (StreetAddress, PositionOfInterest, ...)\n    this._currentGeocodingType = null;\n    this._initGeocodingType();\n\n    // Type de dlimitation  utiliser pour la requte + pour slection sur la containerDistance\n    this._currentGeocodingDelimitation = null;\n    this._initGeocodingDelimitation();\n\n    // ################################################################## //\n    // ################### Elements principaux du DOM ################### //\n\n    // containers principaux\n    this._showReverseGeocodingInput = null;\n    // header panel\n    this._panelHeaderContainer = null;\n    this._panelTitleContainer = null;\n    this._returnPictoContainer = null;\n    // form\n    this._formContainer = null;\n    // results\n    this._resultsContainer = null;\n    this._resultsListContainer = null;\n    // waiting\n    this._waitingContainer = null;\n\n    // ###################################################################### //\n    // ################### informations des points saisis ################### //\n\n    // collection des points saisis sur la carte\n    this._inputFeatures = null;\n    // source contenant les features ci-dessus\n    this._inputFeaturesSource = null;\n    // couche vectorielle dans laquelle seront saisis les points (features ci-dessus)\n    this._inputFeaturesLayer = null;\n    // interaction avec la carte (de type \"Point\", \"Circle\" ou \"Polygon\")\n    this._mapInteraction = null;\n\n    // #################################################################### //\n    // ################### informations pour la requte ################### //\n\n    // options pour la requte de gocodage inverse\n    this._requestOptions = null;\n    // position du gocodage inverse qui sera envoye dans la requte\n    this._requestPosition = null;\n    // eventuels filtres gomtriques saisis par l'utilisateur : cercle ou bbox\n    this._requestCircleFilter = null;\n    this._requestBboxFilter = null;\n    // pour savoir si un calcul est en cours ou non\n    this._waiting = false;\n    // timer pour cacher la patience aprs un certain temps\n    this._timer = null;\n\n    // #################################################################### //\n    // #################### informations des rsultats #################### //\n\n    this._reverseGeocodingLocations = [];\n    this._reverseGeocodingLocationsMarkers = [];\n    this._resultsDefaultStyle = new ol.style.Style({\n        image: new ol.style.Icon({\n            src: Markers[\"lightOrange\"],\n            anchor: [0.5, 1]\n        })\n    });\n    this._resultsSelectedStyle = new ol.style.Style({\n        image: new ol.style.Icon({\n            src: Markers[\"red\"],\n            anchor: [0.5, 1]\n        })\n    });\n    this._resultsHoverInteraction = null;\n    this._resultsSelectInteraction = null;\n    // container de la popup (affichage des infos au clic sur les markers)\n    this._popupContent = null;\n    this._popupDiv = this._initPopupDiv();\n    this._popupOverlay = null;\n\n};\n\n/**\n * this method is called by this.initialize()\n * and makes sure input options are correctly formated\n *\n * @private\n */\nReverseGeocode.prototype._checkInputOptions = function(options) {\n    var i;\n    var j;\n\n    // on vrifie le tableau des resources\n    if (options.resources) {\n        var resources = options.resources;\n        // on vrifie que la liste des ressources de geocodage est bien un tableau\n        if (!Array.isArray(resources)) {\n            console.log(\"[ReverseGeocode] 'options.resources' parameter should be an array\");\n            resources = null;\n        }\n        var resourcesList = [\"StreetAddress\", \"PositionOfInterest\", \"CadastralParcel\", \"Administratif\"];\n        var wrongResourcesIndexes = [];\n        for (i = 0; i < resources.length; i++) {\n            if (resourcesList.indexOf(resources[i]) === -1) {\n                // si la resource n'est pas rfrence, on stocke son index pour la retirer du tableau (aprs avoir termin de parcourir le tableau)\n                wrongResourcesIndexes.push(i);\n                console.log(\"[ReverseGeocode] options.resources : \" + resources[i] + \" is not a resource for reverse geocode\");\n            }\n        }\n        // on retire les ressoures non rfrences qu'on a pu rencontrer\n        if (wrongResourcesIndexes.length !== 0) {\n            for (j = 0; j < wrongResourcesIndexes.length; j++) {\n                resources.splice(wrongResourcesIndexes[j], 1);\n            }\n        }\n    }\n\n    // et le tableau des dlimitations\n    if (options.delimitations) {\n        var delimitations = options.delimitations;\n        // on vrifie que la liste des delimitations est bien un tableau\n        if (!Array.isArray(delimitations)) {\n            console.log(\"[ReverseGeocode] 'options.delimitations' parameter should be an array\");\n            delimitations = null;\n        }\n        var delimitationsList = [\"Circle\", \"Point\", \"Extent\"];\n        var wrongDelimitationsIndexes = [];\n        for (i = 0; i < delimitations.length; i++) {\n            if (delimitationsList.indexOf(delimitations[i]) === -1) {\n                // si la delimitations n'est pas rfrence, on stocke son index pour la retirer du tableau (aprs avoir termin de parcourir le tableau)\n                wrongDelimitationsIndexes.push(i);\n                console.log(\"[ReverseGeocode] options.delimitations : \" + delimitations[i] + \" is not a delimitation for reverse geocode\");\n            }\n        }\n        // on retire les ressoures non rfrences qu'on a pu rencontrer\n        if (wrongDelimitationsIndexes.length !== 0) {\n            for (j = 0; j < wrongDelimitationsIndexes.length; j++) {\n                delimitations.splice(wrongDelimitationsIndexes[j], 1);\n            }\n        }\n    }\n\n};\n\n/**\n * this method is called by this.initialize() and initialize geocoding type (=resource)\n * (\"StreetAddress\", \"PositionOfInterest\", \"CadastralParcel\", \"Administratif\")\n *\n * @private\n */\nReverseGeocode.prototype._initGeocodingType = function() {\n    // Type de gocodage selectionn\n    this._currentGeocodingType = \"StreetAddress\"; // par defaut\n\n    // par defaut\n    var resources = this.options.resources;\n    if (!resources || resources.length === 0) {\n        this.options.resources = [\"StreetAddress\", \"PositionOfInterest\", \"CadastralParcel\"];\n    }\n\n    // options utilisateur\n    if (Array.isArray(resources) && resources.length) {\n\n        // vrification des droits\n        var noRightsIndexes = [];\n        for (var i = 0; i < resources.length; i++) {\n            if (this._servicesRightManagement[\"Geocode\"].indexOf(resources[i]) < 0) {\n                // si on n'a pas les droits sur la ressource, on va la supprimer : on stocke son index\n                noRightsIndexes.push(i);\n                console.log(\"[ReverseGeocode] no rights for options.resources : \" + resources[i]);\n            }\n        }\n        // on retire les ressoures non autorises qu'on a pu rencontrer\n        if (noRightsIndexes.length !== 0) {\n            for (var j = 0; j < noRightsIndexes.length; j++) {\n                resources.splice(noRightsIndexes[j], 1);\n            }\n        }\n\n        // rcupration du type par dfaut\n        if (resources[0] === \"StreetAddress\" || resources[0] === \"PositionOfInterest\" || resources[0] === \"CadastralParcel\" || resources[0] === \"Administratif\") {\n            this._currentGeocodingType = resources[0];\n        }\n    }\n\n    // si l'utilisateur a spcifi au moins une ressource dans le service, on surcharge les options du widget\n    var serviceOptions = this.options.reverseGeocodeOptions;\n    if (serviceOptions.filterOptions && Array.isArray(serviceOptions.filterOptions.type) && serviceOptions.filterOptions.type.length !== 0) {\n        this._currentGeocodingType = serviceOptions.filterOptions.type[0];\n    }\n};\n\n/**\n * this method is called by this.initialize() and initialize geocoding delimitation\n * (\"Point\", \"Circle\", \"Extent\")\n *\n * @private\n */\nReverseGeocode.prototype._initGeocodingDelimitation = function() {\n    // Type de dlimitation selectionn\n    this._currentGeocodingDelimitation = \"Point\"; // par defaut\n\n    // par defaut\n    var delimitations = this.options.delimitations;\n    if (!delimitations || delimitations.length === 0) {\n        this.options.delimitations = [\"Point\", \"Circle\", \"Extent\"];\n    }\n\n    // options utilisateur\n    if (Array.isArray(delimitations) && delimitations.length) {\n        var d = delimitations[0].toLowerCase();\n        if (d === \"point\" || d === \"circle\" || d === \"extent\") {\n            this._currentGeocodingDelimitation = delimitations[0];\n        }\n    }\n};\n\n/**\n * this method is called by this.initialize() and initialize popup div\n * (to display results information on marker click)\n *\n * @return {Object} element - DOM element for popup\n * @private\n */\nReverseGeocode.prototype._initPopupDiv = function() {\n    var context = this;\n    var element = document.createElement(\"div\");\n    element.className = \"gp-feature-info-div\";\n    var closer = document.createElement(\"input\");\n    closer.type = \"button\";\n    closer.className = \"gp-styling-button closer\";\n    /** on closer click : remove popup */\n    closer.onclick = function() {\n        if (context._popupOverlay != null) {\n            context._popupOverlay.setPosition(undefined);\n        }\n        return false;\n    };\n    this._popupContent = document.createElement(\"div\");\n    this._popupContent.className = \"gp-features-content-div\";\n    element.appendChild(this._popupContent);\n    element.appendChild(closer);\n\n    return element;\n};\n\n/**\n * Check rights to resources (called by this.initialize())\n *\n * @private\n */\nReverseGeocode.prototype._checkRightsManagement = function() {\n\n    var _resources = [];\n    var _key;\n    var _opts = null;\n\n    // les ressources du service de geocodage\n    _key = this.options.reverseGeocodeOptions.apiKey;\n    _opts = this.options.reverseGeocodeOptions.filterOptions;\n    // on rcupre les ventuelles ressources passes en option, soit dans reverseGeocodeOptions :\n    _resources = (_opts) ? _opts.type : [];\n    // soit directement dans options.resources.geocode :\n    if (!_resources || _resources.length === 0) {\n        _resources = this.options.resources;\n    }\n    // ou celles par dfaut sinon.\n    if (!_resources || _resources.length === 0) {\n        _resources = [\n            \"StreetAddress\",\n            \"PositionOfInterest\"\n        ];\n    }\n    var rightManagementGeocode = RightManagement.check({\n        key: _key || this.options.apiKey,\n        resources: _resources,\n        services: [\"Geocode\"]\n    });\n    logger.log(\"rightManagementGeocode\", rightManagementGeocode);\n\n    // aucun droit !\n    if (!rightManagementGeocode) {\n        this._noRightManagement = true;\n        return;\n    }\n\n    // on recupre les informations utiles\n    // Ex. la clef API issue de l'autoconfiguration si elle n'a pas\n    // t renseigne.\n    if (!this.options.apiKey) {\n        this.options.apiKey = rightManagementGeocode.key;\n    }\n\n    if (rightManagementGeocode) {\n        this._servicesRightManagement[\"Geocode\"] = rightManagementGeocode[\"Geocode\"];\n    }\n\n};\n\n/**\n * Create control main container (DOM initialize)\n *\n * @private\n */\nReverseGeocode.prototype._initContainer = function() {\n\n    // create main container\n    var container = this._createMainContainerElement();\n\n    // create show ReverseGeocode element\n    var inputShow = this._showReverseGeocodingInput = this._createShowReverseGeocodingElement();\n    container.appendChild(inputShow);\n\n    // mode \"collapsed\"\n    if (!this.collapsed) {\n        inputShow.checked = true;\n    }\n\n    // create ReverseGeocode picto\n    var picto = this._createShowReverseGeocodingPictoElement();\n    container.appendChild(picto);\n\n    // panel\n    var reverseGeocodingPanel = this._createReverseGeocodingPanelElement();\n\n    // header\n    var panelHeader = this._panelHeaderContainer = this._createReverseGeocodingPanelHeaderElement();\n    // return picto (hidden at start)\n    var returnPicto = this._returnPictoContainer = this._createReverseGeocodingPanelReturnPictoElement();\n    panelHeader.appendChild(returnPicto);\n    // pane title\n    var panelTitle = this._panelTitleContainer = this._createReverseGeocodingPanelTitleElement();\n    panelHeader.appendChild(panelTitle);\n    // close picto\n    var closeDiv = this._createReverseGeocodingPanelCloseElement();\n    panelHeader.appendChild(closeDiv);\n    reverseGeocodingPanel.appendChild(panelHeader);\n\n    // form\n    var reverseGeocodingForm = this._formContainer = this._createReverseGeocodingPanelFormElement();\n    // choices element\n    reverseGeocodingForm.appendChild(this._createReverseGeocodingFormModeChoiceGeocodingTypeElement(this.options.resources));\n    reverseGeocodingForm.appendChild(this._createReverseGeocodingFormModeChoiceGeocodingDelimitationElement(this.options.delimitations));\n\n    // submit (bouton \"Chercher\")\n    var submit = this._createReverseGeocodingSubmitFormElement();\n    reverseGeocodingForm.appendChild(submit);\n\n    reverseGeocodingPanel.appendChild(reverseGeocodingForm);\n\n    // waiting\n    var waiting = this._waitingContainer = this._createReverseGeocodingWaitingElement();\n    reverseGeocodingPanel.appendChild(waiting);\n\n    // results (dans le panel)\n    var resultsPanel = this._resultsContainer = this._createReverseGeocodingResultsPanelElement();\n    var reverseGeocodingResultsList = this._resultsListContainer = this._createReverseGeocodingResultsListElement();\n    resultsPanel.appendChild(reverseGeocodingResultsList);\n    reverseGeocodingPanel.appendChild(resultsPanel);\n\n    container.appendChild(reverseGeocodingPanel);\n\n    logger.log(container);\n\n    return container;\n};\n\n// ################################################################### //\n// ################### Map interactions management ################### //\n// ################################################################### //\n\n/**\n * this method is called by this.setMap,\n * or by this.onShowReverseGeocodingClick,\n * and calls method corresponding to current delimitation, if widget is not collapsed.\n *\n * @param {ol.Map} map - control map.\n * @private\n */\nReverseGeocode.prototype._activateMapInteraction = function(map) {\n    if (!this.collapsed) {\n\n        // 1. Creation de la couche vectorielle sur laquelle on va dessiner\n        if (this._inputFeaturesLayer == null) {\n            // on cre une collection, qui accueillera les points saisis sur la carte par les interactions,\n            // sous formes de features (dans une couche vectorielle).\n            // on les stocke de sorte  pouvoir les supprimer facilement\n            this._inputFeatures = new ol.Collection();\n\n            // on cre la couche qui va accueillir les features\n            this._inputFeaturesSource = new ol.source.Vector({\n                features: this._inputFeatures\n            });\n            this._inputFeaturesLayer = new ol.layer.Vector({\n                source: this._inputFeaturesSource,\n                style: new ol.style.Style({\n                    fill: new ol.style.Fill({\n                        color: \"rgba(0, 183, 152, 0.3)\"\n                    }),\n                    stroke: new ol.style.Stroke({\n                        color: \"rgba(0, 183, 152, 0.8)\",\n                        width: 3\n                    }),\n                    image: new ol.style.Icon({\n                        src: Markers[\"turquoiseBlue\"],\n                        anchor: [0.5, 1]\n                    })\n                })\n            });\n            // on rajoute le champ gpResultLayerId permettant d'identifier une couche cre par le composant. (pour layerSwitcher par ex)\n            this._inputFeaturesLayer.gpResultLayerId = \"reverseGeocoding\";\n            // on ajoute la couche  la carte\n            map.addLayer(this._inputFeaturesLayer);\n        }\n\n        // 2. Cration de l'interaction de dessin, selon le type de dlimitation slectionn\n        var delimitation = this._currentGeocodingDelimitation.toLowerCase();\n        switch (delimitation) {\n            case \"point\":\n                this._activatePointInteraction(map);\n                break;\n            case \"circle\":\n                this._activateCircleInteraction(map);\n                break;\n            case \"extent\":\n                this._activateBoxInteraction(map);\n                break;\n            default:\n                break;\n        }\n\n        // 3. Si un layer switcher est prsent dans la carte, on lui affecte des informations pour cette couche\n        map.getControls().forEach(\n            function(control) {\n                if (control instanceof LayerSwitcher) {\n                    // un layer switcher est prsent dans la carte\n                    var layerId = this._inputFeaturesLayer.gpLayerId;\n                    // on n'ajoute des informations que s'il n'y en a pas dj (si le titre est le numro par dfaut)\n                    if (control._layers[layerId].title === layerId) {\n                        control.addLayer(\n                            this._inputFeaturesLayer, {\n                                title: \"Saisie (recherche inverse)\",\n                                description: \"Couche de saisie d'une zone de recherche pour la recherche inverse\"\n                            }\n                        );\n                        control.setRemovable(this._inputFeaturesLayer, false);\n                    }\n                }\n            },\n            this\n        );\n    }\n};\n\n/**\n * this method is called by this._activateMapInteraction,\n * and creates map point drawing interaction.\n *\n * @param {ol.Map} map - control map.\n * @private\n */\nReverseGeocode.prototype._activatePointInteraction = function(map) {\n\n    // interaction permettant de dessiner un point\n    this._mapInteraction = new ol.interaction.Draw({\n        style: new ol.style.Style({\n            image: new ol.style.Circle({\n                radius: 0,\n                fill: new ol.style.Fill({\n                    color: \"rgba(0, 183, 152, 0.8)\"\n                })\n            })\n        }),\n        type: (\"Point\"),\n        source: this._inputFeaturesSource\n    });\n\n    this._mapInteraction.on(\n        \"drawstart\",\n        function(e) {\n            logger.log(\"on drawstart \", e);\n\n            // on efface les points qui ont pu tre saisis prcdemment (on vide la collection des features de la couche)\n            this._inputFeatures.clear();\n\n            // on rcupre les coordonnes du point qui vient d'tre saisi\n            this._onDrawStart(e, \"point\");\n        },\n        this\n    );\n\n    map.addInteraction(this._mapInteraction);\n    this._setCursor(\"crosshair\", map);\n};\n\n/**\n * this method is called by this._activateMapInteraction,\n * and creates map circle drawing interaction.\n *\n * @param {ol.Map} map - control map.\n * @private\n */\nReverseGeocode.prototype._activateCircleInteraction = function(map) {\n\n    // interaction permettant de dessiner un cercle\n    this._mapInteraction = new ol.interaction.Draw({\n        style: new ol.style.Style({\n            fill: new ol.style.Fill({\n                color: \"rgba(0, 183, 152, 0.3)\"\n            }),\n            stroke: new ol.style.Stroke({\n                color: \"rgba(0, 183, 152, 0.8)\",\n                width: 3\n            }),\n            image: new ol.style.Circle({\n                radius: 4,\n                fill: new ol.style.Fill({\n                    color: \"rgba(0, 183, 152, 0.8)\"\n                })\n            })\n        }),\n        type: (\"Circle\"),\n        source: this._inputFeaturesSource\n    });\n\n    this._mapInteraction.on(\n        \"drawstart\",\n        function(e) {\n            logger.log(\"on drawstart \", e);\n            // on efface les points qui ont pu tre saisis prcdemment (on vide la collection des features de la couche)\n            this._inputFeatures.clear();\n            // on rcupre les coordonnes du centre du cercle = premier point du trac\n            this._onDrawStart(e, \"circle\");\n        },\n        this\n    );\n\n    this._mapInteraction.on(\n        \"drawend\",\n        function(e) {\n            logger.log(\"on drawend\", e);\n\n            // on rcupre le rayon du cercle qui vient d'tre trac\n            if (e.feature && e.feature.getGeometry) {\n                var radius = e.feature.getGeometry().getRadius();\n                // et on le stocke comme filtre pour la requte\n                this._requestCircleFilter = {};\n                this._requestCircleFilter.radius = radius;\n                if (this._requestPosition) {\n                    this._requestCircleFilter.x = this._requestPosition.x;\n                    this._requestCircleFilter.y = this._requestPosition.y;\n                }\n                logger.log(\"circle radius : \", radius);\n            }\n        },\n        this\n    );\n\n    map.addInteraction(this._mapInteraction);\n};\n\n/**\n * this method is called by this._activateMapInteraction,\n * and creates map box drawing interaction.\n *\n * @param {ol.Map} map - control map.\n * @private\n */\nReverseGeocode.prototype._activateBoxInteraction = function(map) {\n\n    // info : il n'y a pas de geometry de type rectangle, donc on va crer un objet de type \"LineString\",\n    // avec seulement 2 points qui formeront les extrmits du rectangle.\n    // on aura donc une gomtrie LineString avec 5 coordonnes : start, point2, end, point4, start,\n    // o les coordonnes de point2 et point4 sont calcules  partir de start et end, et start est rpt  la fin pour fermer la gomtrie.\n\n    /** function to draw rectangle with only 2 points */\n    var geometryFunction = function(coordinates, geometry) {\n        if (!geometry) {\n            geometry = new ol.geom.Polygon(null);\n        }\n        var start = coordinates[0];\n        var end = coordinates[1];\n        // on cre les 5 coordonnes de la ligne  partir des 2 points saisis.\n        geometry.setCoordinates([\n            [start, [start[0], end[1]], end, [end[0], start[1]], start]\n        ]);\n        return geometry;\n    };\n\n    // interaction permettant de dessiner un rectangle (= LineString de 5 points,  partir de 2 points saisis)\n    this._mapInteraction = new ol.interaction.Draw({\n        style: new ol.style.Style({\n            fill: new ol.style.Fill({\n                color: \"rgba(0, 183, 152, 0.3)\"\n            }),\n            stroke: new ol.style.Stroke({\n                color: \"rgba(0, 183, 152, 0.8)\",\n                width: 3\n            }),\n            image: new ol.style.Circle({\n                radius: 4,\n                fill: new ol.style.Fill({\n                    color: \"rgba(0, 183, 152, 0.8)\"\n                })\n            })\n        }),\n        type: (\"LineString\"),\n        source: this._inputFeaturesSource,\n        maxPoints: 2,\n        geometryFunction: geometryFunction\n    });\n\n    this._mapInteraction.on(\n        \"drawstart\",\n        function(e) {\n            logger.log(\"on drawstart\", e);\n            // on efface les points qui ont pu tre saisis prcdemment (on vide la collection des features de la couche)\n            this._inputFeatures.clear();\n        },\n        this\n    );\n\n    this._mapInteraction.on(\n        \"drawend\",\n        function(e) {\n            logger.log(\"on drawend\", e);\n            // on va rcuprer les coordonnes du rectangle qui vient d'tre trac\n            this._onBoxDrawEnd(e);\n        },\n        this\n    );\n\n    map.addInteraction(this._mapInteraction);\n};\n\n/**\n * remove draw interaction from map (if exists)\n *\n * @param {ol.Map} map - control map.\n * @private\n */\nReverseGeocode.prototype._removeMapInteraction = function(map) {\n    if (this._mapInteraction != null) {\n        map.removeInteraction(this._mapInteraction);\n        this._mapInteraction = null;\n    }\n    this._setCursor();\n};\n\n/**\n * this method is called by event 'drawstart' on map point or circle drawing interaction\n * (cf. this._activatePointInteraction), and it gets map click coordinates.\n * this point is saved as a parameter for reverse Geocode service.\n *\n * @param {Object} e - HTMLElement\n * @param {String} type - geometry type : \"point\" or \"circle\"\n * @private\n */\nReverseGeocode.prototype._onDrawStart = function(e, type) {\n\n    var coordinate;\n    if (e.feature && e.feature.getGeometry) {\n        var geometry = e.feature.getGeometry();\n        if (type === \"point\") {\n            coordinate = geometry.getCoordinates();\n        }\n        if (type === \"circle\") {\n            coordinate = geometry.getCenter();\n        }\n    }\n    if (!coordinate) {\n        return;\n    }\n\n    var crs;\n    if (this.options.reverseGeocodeOptions && this.options.reverseGeocodeOptions.srs) {\n        crs = this.options.reverseGeocodeOptions.srs;\n    } else {\n        var map = this.getMap();\n        if (!map || !map.getView()) {\n            return;\n        }\n        crs = map.getView().getProjection();\n    }\n\n    var geoCoordinate = ol.proj.transform(coordinate, crs, \"EPSG:4326\");\n    this._requestPosition = {\n        x: geoCoordinate[0],\n        y: geoCoordinate[1]\n    };\n    logger.log(\"position coordinates : \", this._requestPosition);\n\n};\n\n/**\n * this method is called by event 'drawend' on map box drawing interaction\n * (cf. this._activateBoxInteraction), and it gets geometry coordinates,\n * to be saved as a filter parameter for reverse Geocode service.\n *\n * @param {Object} e - HTMLElement\n * @private\n */\nReverseGeocode.prototype._onBoxDrawEnd = function(e) {\n    // on va rcuprer les coordonnes du rectangle qui vient d'tre trac\n    if (e.feature && e.feature.getGeometry) {\n        // info: coordinates est un tableau [start, point2, end, point4, start]\n        // car c'est une linestring donc on a 5 coordonnes pour boucler\n        var coordinates = e.feature.getGeometry().getCoordinates()[0];\n        var start = coordinates[0];\n        var end = coordinates[2];\n\n        var crs;\n        if (this.options.reverseGeocodeOptions && this.options.reverseGeocodeOptions.srs) {\n            crs = this.options.reverseGeocodeOptions.srs;\n        } else {\n            var map = this.getMap();\n            if (!map || !map.getView()) {\n                return;\n            }\n            crs = map.getView().getProjection();\n        }\n\n        // on reprojette les coordonnes des deux extrmits du rectangle (start et end)\n        var startGeoCoordinate = ol.proj.transform(start, crs, \"EPSG:4326\");\n        var endGeoCoordinate = ol.proj.transform(end, crs, \"EPSG:4326\");\n\n        this._requestPosition = {};\n        this._requestBboxFilter = {};\n        // on rcupre les valeurs left, right, top et bottom, pour le filtre bbox du service reverseGeocode\n        if (startGeoCoordinate[0] < endGeoCoordinate[0]) {\n            this._requestBboxFilter.left = startGeoCoordinate[0];\n            this._requestBboxFilter.right = endGeoCoordinate[0];\n        } else {\n            this._requestBboxFilter.left = endGeoCoordinate[0];\n            this._requestBboxFilter.right = startGeoCoordinate[0];\n        }\n        if (startGeoCoordinate[1] < endGeoCoordinate[1]) {\n            this._requestBboxFilter.bottom = startGeoCoordinate[1];\n            this._requestBboxFilter.top = endGeoCoordinate[1];\n        } else {\n            this._requestBboxFilter.bottom = endGeoCoordinate[1];\n            this._requestBboxFilter.top = startGeoCoordinate[1];\n        }\n\n        // ainsi que le centre du rectangle pour le paramtre \"position\" du service reverseGeocode\n        this._requestPosition.x = (startGeoCoordinate[0] + endGeoCoordinate[0]) / 2;\n        this._requestPosition.y = (startGeoCoordinate[1] + endGeoCoordinate[1]) / 2;\n        logger.log(\"bbox filter : \", this._requestBboxFilter);\n\n        logger.log(\"center coordinates : \", this._requestPosition);\n    }\n};\n\n/**\n * this change the cursor of the map when entering a point.\n *\n * @param {String} cursor - cursor style\n * @param {ol.Map} map - control map (optional)\n * @private\n */\nReverseGeocode.prototype._setCursor = function(cursor, map) {\n    map = map || this.getMap();\n    if (!map) {\n        return;\n    }\n    var div = map.getTargetElement();\n\n    if (cursor) {\n        div.style.cursor = cursor;\n    } else {\n        div.style.cursor = null;\n    }\n};\n\n// ################################################################### //\n// ##################### Reverse Geocoding request ################### //\n// ################################################################### //\n\n/**\n * this methode is called by this.onReverseGeocodingSubmit method,\n * it generates and sends reverse geocode request, then displays results\n *\n * @private\n */\nReverseGeocode.prototype._reverseGeocodingRequest = function() {\n    var map = this.getMap();\n\n    // on construit les options pour la requte\n    this._requestOptions = this._getReverseGeocodingRequestOptions();\n\n    // retrait de l'interaction sur la map pendant l'attente (et l'affichage des rsultats)\n    this._removeMapInteraction(map);\n    // affichage d'une patience pendant l'attente\n    this._displayWaitingContainer();\n\n    // envoi de la requte\n    Gp.Services.reverseGeocode(this._requestOptions);\n};\n\n/**\n * this methode is called by this._reverseGeocodingRequest method,\n * and returns options object for Gp.Services.reverseGeocode request\n *\n * @returns {Object} requestOptions - reverse geocode options\n * @private\n */\nReverseGeocode.prototype._getReverseGeocodingRequestOptions = function() {\n\n    var map = this.getMap();\n\n    // on recupere les ventuelles options du service passes par l'utilisateur\n    var reverseGeocodeOptions = this.options.reverseGeocodeOptions;\n\n    // on cre les options pour le service reverseGeocode\n    var context = this;\n    var requestOptions = {\n        apiKey: reverseGeocodeOptions.apiKey || this.options.apiKey,\n        position: this._requestPosition,\n        filterOptions: {\n            type: [this._currentGeocodingType]\n        },\n        srs: \"CRS:84\",\n        returnFreeForm: false,\n        maximumResponses: reverseGeocodeOptions.maximumResponses || 25,\n        timeOut: reverseGeocodeOptions.timeOut || 30000,\n        protocol: reverseGeocodeOptions.protocol || \"XHR\",\n        /** callback onSuccess */\n        onSuccess: function(response) {\n            if (response.locations) {\n                logger.log(\"reverseGeocode results : \", response.locations);\n                context._displayGeocodedLocations(response.locations);\n            }\n        },\n        /** callback onFailure */\n        onFailure: function(error) {\n            // FIXME mise  jour du controle mais le service ne repond pas en 200 !?\n\n            // on cache la patience\n            context._hideWaitingContainer();\n\n            // suppression d'ventuels rsultats prcdents\n            context._clearResults();\n            // on efface les points qui ont t saisis prcdemment\n            context._clearInputFeatures();\n\n            // et on ractive l'interaction sur la map\n            context._activateMapInteraction(map);\n            logger.log(error.message);\n        }\n    };\n\n    // on rcupre d'ventuels filtres\n    if (this._currentGeocodingDelimitation.toLowerCase() === \"circle\" && this._requestCircleFilter) {\n        // FIXME : a confirmer !\n        if (this._requestCircleFilter.radius > 1000) {\n            console.log(\"INFO : initial circle radius (\" + this._requestCircleFilter.radius + \") limited to 1000m.\");\n            this._requestCircleFilter.radius = 1000;\n        }\n        requestOptions.filterOptions.circle = this._requestCircleFilter;\n    }\n    if (this._currentGeocodingDelimitation.toLowerCase() === \"extent\" && this._requestBboxFilter) {\n        requestOptions.filterOptions.bbox = this._requestBboxFilter;\n    }\n    logger.log(\"reverseGeocode request options : \", requestOptions);\n\n    return requestOptions;\n};\n\n/**\n * this method is called by this._reverseGeocodingRequest() (in case of reverse geocode success)\n * and display results : in both container list and map\n *\n * @param {Array} locations - array of geocoded locations (reverse geocode results)\n * @private\n */\nReverseGeocode.prototype._displayGeocodedLocations = function(locations) {\n\n    // 1. on vide les rsultats prcdents\n    this._clearResults();\n    this._reverseGeocodingLocations = locations;\n\n    // 2. cache de la patience et du formulaire\n    this._formContainer.className = \"GPreverseGeocodingComponentHidden\";\n    this._hideWaitingContainer();\n    // affichage de la div des rsultats (et changement du titre)\n    this._panelTitleContainer.innerHTML = \"Rsultats de la recherche\";\n    this._returnPictoContainer.className = \"\";\n    this._resultsContainer.className = \"GPpanel\";\n\n    // 3. ajout de la liste des rsultats dans le container des resultats\n    this._fillGeocodedLocationListContainer(locations);\n\n    // 4. affichage des rsultats sur la carte (+ zoom ?)\n    this._displayGeocodedLocationsOnMap(locations);\n};\n\n// ################################################################### //\n// ############################# results list ######################## //\n// ################################################################### //\n\n/**\n * this method is called by this._displayGeocodedLocations()\n * and fills the container with results list\n *\n * @param {Array} locations - array of geocoded locations (reverse geocode results)\n * @private\n */\nReverseGeocode.prototype._fillGeocodedLocationListContainer = function(locations) {\n\n    //  ajout de la liste des rsultats dans le container des resultats\n    for (var i = 0; i < locations.length; i++) {\n        var location = locations[i];\n        logger.log(location);\n        // on rcupre la description  afficher dans la liste\n        var locationDescription = this._fillGeocodedLocationDescription(location);\n        // on ajoute chaque rsutat  la liste\n        if (locationDescription.length !== 0) {\n            this._createReverseGeocodingResultElement(locationDescription, i);\n        }\n    }\n};\n\n/**\n * this method is called by this._fillGeocodedLocationListContainer()\n * and fills location description (String), depending on matchType\n *\n * @param {Object} location - geocoded location (from reverse geocode results)\n * @returns {String} locationDescription - geocoded location description to be displayed\n * @private\n */\nReverseGeocode.prototype._fillGeocodedLocationDescription = function(location) {\n\n    if (!location || !location.placeAttributes) {\n        return;\n    }\n    var attr = location.placeAttributes;\n\n    var locationDescription = \"\";\n    // on slectionne les infos  afficher selon le type\n    switch (location.type) {\n\n        case \"StreetAddress\":\n            if (attr.street) {\n                locationDescription += attr.number ? attr.number + \" \" : \"\";\n                locationDescription += attr.street + \", \";\n            }\n            locationDescription += attr.postalCode + \" \" + attr.commune;\n            break;\n\n        case \"PositionOfInterest\":\n            if (location.matchType === \"City\" && attr.commune) {\n                locationDescription += attr.commune;\n                locationDescription += attr.postalCode ? \", \" + attr.postalCode : \"\";\n            } else if (location.matchType === \"Dpartement\" && attr.municipality) {\n                locationDescription += attr.municipality;\n                locationDescription += attr.postalCode ? \", \" + attr.postalCode : \"\";\n            } else if (location.matchType === \"Toponym\" && attr.municipality) {\n                locationDescription += attr.municipality;\n                locationDescription += attr.postalCode ? \", \" + attr.postalCode : \"\";\n                locationDescription += attr.commune ? \" \" + attr.commune : \"\";\n            } else {\n                locationDescription += attr.municipality ? attr.municipality : \"\";\n            }\n            locationDescription += attr.nature ? \" (\" + attr.nature + \") \" : \"\";\n            break;\n\n        case \"CadastralParcel\":\n            locationDescription += attr.cadastralParcel ? attr.cadastralParcel : \"\";\n            locationDescription += attr.municipality ? \" (\" + attr.municipality + \")\" : \"\";\n            break;\n\n        case \"Administratif\":\n            locationDescription += attr.municipality ? attr.municipality : \"\";\n            if (attr.inseeDepartment) {\n                locationDescription += \"(Dpartement)\";\n            } else if (attr.inseeRegion) {\n                locationDescription += \"(Rgion)\";\n            }\n            break;\n\n        default:\n            locationDescription += attr.municipality ? attr.municipality : \"\";\n            break;\n    };\n\n    return locationDescription;\n};\n\n// ################################################################### //\n// ######################## map results (markers) #################### //\n// ################################################################### //\n\n/**\n * this method is called by this._displayGeocodedLocations()\n * and display locations in map (markers)\n *\n * @param {Object} locations - geocoded locations (reverse geocode result)\n * @private\n */\nReverseGeocode.prototype._displayGeocodedLocationsOnMap = function(locations) {\n    if (this._reverseGeocodingLocations.length !== 0) {\n\n        var map = this.getMap();\n\n        // 1. cration de la couche o seront ajouts les rsultats\n        this._createResultsLayer();\n        // ajout de chaque rsultat  la couche (marker)\n        for (var i = 0; i < locations.length; i++) {\n            this._addResultFeature(locations[i], i);\n        }\n\n        // 2. Zoom sur l'tendue des rsultats (features)\n        if (this._resultsFeatures.getLength() > 1) {\n            if (this._resultsFeaturesSource && this._resultsFeaturesSource.getExtent) {\n                var extent = this._resultsFeaturesSource.getExtent();\n                map.getView().fit(extent, map.getSize());\n            }\n        } else {\n            // dans le cas o on n'a qu'un seul rsultat, l'tendue n'est pas dfinie, on zoome donc sur le rsulat\n            var feature = this._resultsFeatures.item(0);\n            var coords = feature.getGeometry().getCoordinates();\n            map.getView().setCenter(coords);\n            map.getView().setZoom(17);\n        }\n\n        // 3. ajout des interactions (survol, click)\n        // au survol : modification des styles (marker et list)\n        this._resultsHoverInteraction = new ol.interaction.Select({\n            condition: ol.events.condition.pointerMove,\n            layers: [this._resultsFeaturesLayer]\n        });\n        this._resultsHoverInteraction.on(\n            \"select\",\n            this._onResultsFeatureMouseOver,\n            this\n        );\n        map.addInteraction(this._resultsHoverInteraction);\n\n        // au click : affichage popup\n        this._resultsSelectInteraction = new ol.interaction.Select({\n            layers: [this._resultsFeaturesLayer]\n        });\n        this._resultsSelectInteraction.on(\n            \"select\",\n            this._onResultsFeatureSelect,\n            this\n        );\n        map.addInteraction(this._resultsSelectInteraction);\n\n        // 4. Si un layer switcher est prsent dans la carte, on lui affecte des informations pour cette couche\n        var geocodeType = \"\";\n        switch (this._currentGeocodingType) {\n            case \"StreetAddress\":\n                geocodeType = \"adresses\";\n                break;\n            case \"PositionOfInterest\":\n                geocodeType = \"toponymes\";\n                break;\n            case \"CadastralParcel\":\n                geocodeType = \"parcelles cadastrales\";\n                break;\n            case \"Administratif\":\n                geocodeType = \"units administratives\";\n                break;\n            default:\n                break;\n        }\n        map.getControls().forEach(\n            function(control) {\n                if (control instanceof LayerSwitcher) {\n                    // un layer switcher est prsent dans la carte\n                    var layerId = this._resultsFeaturesLayer.gpLayerId;\n                    // on n'ajoute des informations que s'il n'y en a pas dj (si le titre est le numro par dfaut)\n                    if (control._layers[layerId].title === layerId) {\n                        control.addLayer(\n                            this._resultsFeaturesLayer, {\n                                title: \"Rsultats de la recherche inverse\",\n                                description: \"Rsultats de la recherche inverse sur les \" + geocodeType\n                            }\n                        );\n                        control.setRemovable(this._resultsFeaturesLayer, false);\n                    }\n                }\n            },\n            this\n        );\n    }\n};\n\n/**\n * this method is called by this._displayGeocodedLocations()\n * and creates result layer (where geocoded locations will be displayed)\n *\n * @private\n */\nReverseGeocode.prototype._createResultsLayer = function() {\n\n    var map = this.getMap();\n\n    this._resultsFeatures = new ol.Collection();\n\n    // on cre la couche qui va accueillir les features\n    this._resultsFeaturesSource = new ol.source.Vector({\n        features: this._resultsFeatures\n    });\n    this._resultsFeaturesLayer = new ol.layer.Vector({\n        source: this._resultsFeaturesSource\n    });\n    // on rajoute le champ gpResultLayerId permettant d'identifier une couche cre par le composant. (pour layerSwitcher par ex)\n    this._resultsFeaturesLayer.gpResultLayerId = \"reverseGeocodingResults\";\n    // on ajoute la couche  la carte\n    map.addLayer(this._resultsFeaturesLayer);\n};\n\n/**\n * this method is called by this._displayGeocodedLocations()\n * and displays locations in map (markers) : add new feature to results layer\n *\n * @param {Object} location - geocoded location (reverse geocode result)\n * @param {Number} i - geocoded location index in response list\n * @private\n */\nReverseGeocode.prototype._addResultFeature = function(location, i) {\n    var map = this.getMap();\n\n    // rcupration de la position\n    var position = [location.position.x, location.position.y];\n    if (!position) {\n        return;\n    }\n    var view = map.getView();\n    var mapProj = view.getProjection().getCode();\n    if (mapProj !== \"EPSG:4326\") {\n        // on retransforme les coordonnes de la position dans la projection de la carte\n        position = ol.proj.transform(position, \"EPSG:4326\", mapProj);\n    }\n\n    // on ajoute le rsultat  la collection de points existantes (composant la couche vectorielle this._inputFeaturesLayer)\n    var feature = new ol.Feature({\n        geometry: new ol.geom.Point(position)\n    });\n    feature.setStyle(this._resultsDefaultStyle);\n    feature.setId(i);\n    feature.setProperties({\n        popupContent: this._fillPopupContent(location)\n    });\n    this._resultsFeatures.push(feature);\n};\n\n/**\n * this method is called by this._addResultFeature()\n * and fills popup content (to be displayed on marker click) for a given geocoded location\n *\n * @param {Object} location - geocoded location (reverse geocode result)\n * @returns {String} popupContent - text to be displayed in popup\n * @private\n */\nReverseGeocode.prototype._fillPopupContent = function(location) {\n    var popupContent = \"<ul>\";\n\n    var attributes = location.placeAttributes;\n    for (var attr in attributes) {\n        if (attributes.hasOwnProperty(attr)) {\n            if (attr !== \"bbox\") {\n                popupContent += \"<li>\";\n                popupContent += \"<span class=\\\"gp-attname-others-span\\\">\" + attr.toUpperCase() + \" : </span>\";\n                popupContent += attributes[attr];\n                popupContent += \" </li>\";\n            }\n        }\n    }\n    popupContent += \" </ul>\";\n\n    return popupContent;\n};\n\n/**\n * this method is called on 'pointerMove' on this._resultsFeaturesLayer (ol.interaction.Select)\n * (cf. this._displayGeocodedLocationsOnMap() )\n * and highlights result in list container\n *\n * @param {Object} e - on select event\n * @private\n */\nReverseGeocode.prototype._onResultsFeatureMouseOver = function(e) {\n\n    var f;\n\n    // si on survole un rsultat, on change son style (marker)\n    if (e.selected.length !== 0) {\n\n        // on change le style du marker (red)\n        f = e.selected[0];\n        f.setStyle(this._resultsSelectedStyle);\n\n        // on surligne le rsultat correspondant dans la liste des rsultats\n        if (f.getId() != null) {\n            var selectedResultDiv = document.getElementById(\"ReverseGeocodedLocation_\" + f.getId() + \"-\" + this._uid);\n            if (selectedResultDiv && selectedResultDiv.classList) {\n                selectedResultDiv.classList.add(\"GPreverseGeocodedLocationHighlight\");\n            }\n        }\n        document.getElementById(\"ReverseGeocodedLocation_\" + f.getId() + \"-\" + this._uid);\n    }\n\n    // si on dselectionne un rsultat (mouseout), on rtablit un style normal pour le marker\n    if (e.deselected.length !== 0) {\n\n        // on change le style du marker (lightOrange)\n        f = e.deselected[0];\n        f.setStyle(this._resultsDefaultStyle);\n\n        // on rtablit un style normal pour le rsultat correspondant dans la liste des rsultats\n        var deSelectedResultDiv = document.getElementById(\"ReverseGeocodedLocation_\" + f.getId() + \"-\" + this._uid);\n        if (deSelectedResultDiv && deSelectedResultDiv.classList) {\n            deSelectedResultDiv.classList.remove(\"GPreverseGeocodedLocationHighlight\");\n        }\n    }\n};\n\n/**\n * this method is called on 'click' on this._resultsFeaturesLayer (ol.interaction.Select)\n * (cf. this._displayGeocodedLocationsOnMap() )\n * and sets a popup with feature information\n *\n * @param {Object} e - on select event\n * @private\n */\nReverseGeocode.prototype._onResultsFeatureSelect = function(e) {\n    var map = this.getMap();\n    if (e.selected.length !== 0) {\n        // si on a slectionn un marker, on lui ajoute une popup\n        var f = e.selected[0];\n        this._popupContent.innerHTML = f.getProperties().popupContent;\n\n        if (!this._popupOverlay) {\n            // ajout de la popup a la carte comme un overlay\n            this._popupOverlay = new ol.Overlay({\n                element: this._popupDiv,\n                positioning: \"bottom-center\",\n                position: e.mapBrowserEvent.coordinate\n            });\n            map.addOverlay(this._popupOverlay);\n\n        } else {\n            // si l'overlay est dj cr, on modifie juste sa position\n            this._popupOverlay.setPosition(e.mapBrowserEvent.coordinate);\n        }\n\n    } else {\n        // si aucun troncon n'est slectionn (click  ct du trac),\n        // on fait disparaitre la popup si elle existe\n        if (this._popupOverlay != null) {\n            this._popupOverlay.setPosition(undefined);\n        }\n    }\n};\n\n// ################################################################### //\n// ####################### handlers events to dom #################### //\n// ################################################################### //\n\n/**\n * this method is called by event 'click' on 'GPshowReverseGeocodingPicto' tag label\n * (cf. ReverseGeocodingDOM._createShowReverseGeocodingPictoElement), and it cleans the component\n * when it's closed.\n *\n * @private\n */\nReverseGeocode.prototype.onShowReverseGeocodingClick = function() {\n    this.collapsed = this._showReverseGeocodingInput.checked;\n    // info : on gnre nous mme l'evenement OpenLayers de changement de proprit\n    // (utiliser ol.control.ReverseGeocode.on(\"change:collapsed\", function ) pour s'abonner  cet vnement)\n    this.dispatchEvent(\"change:collapsed\");\n    var map = this.getMap();\n\n    if (!this._waiting && !this._reverseGeocodingLocations.length) {\n        // Cas 1 : input panel (ni en attente, ni sur le panel des rsultats)\n        if (this.collapsed) {\n            // on remet  zro = on efface les gomtries + interactions + valeurs stockes\n            // suppression des rsultats prcdents\n            this._clearResults();\n            // on efface les points qui ont pu tre saisis prcdemment\n            this._clearInputFeatures();\n            // on supprime l'ventuelle prcdente interaction\n            this._removeMapInteraction(map);\n            // on retire aussi la couche de saisie de la zone de recherche  la fermeture du widget\n            if (this._inputFeaturesLayer != null) {\n                map.removeLayer(this._inputFeaturesLayer);\n                this._inputFeaturesLayer = null;\n                this._inputFeaturesSources = null;\n                this._inputFeatures = null;\n            }\n        } else {\n            // on ractive l'interaction\n            this._activateMapInteraction(map);\n        }\n    }\n    // info : si on est en attente ou sur le panel des rsultats : on ne fait rien.\n};\n\n/**\n * this method is called by event 'change' on 'GPreverseGeocodingCode' tag select\n * (cf. ReverseGeocodingDOM._createReverseGeocodingFormModeChoiceGeocodingTypeElement).\n * this value is saved as a parameter for reverseGeocode service.\n *\n * @param {Object} e - HTMLElement\n * @private\n */\nReverseGeocode.prototype.onReverseGeocodingTypeChange = function(e) {\n    var idx = e.target.selectedIndex;\n    var value = e.target.options[idx].value;\n\n    if (!value) {\n        return;\n    }\n    logger.log(value);\n    this._currentGeocodingType = value;\n};\n\n/**\n * this method is called by event 'change' on 'GPreverseGeocodingCode' tag select\n * (cf. ReverseGeocodingDOM._createReverseGeocodingFormModeChoiceGeocodingDelimitationElement).\n * this value is saved as a parameter for reverseGeocode service.\n *\n * @param {Object} e - HTMLElement\n * @private\n */\nReverseGeocode.prototype.onReverseGeocodingDelimitationChange = function(e) {\n    var idx = e.target.selectedIndex;\n    var value = e.target.options[idx].value;\n\n    if (!value) {\n        return;\n    }\n\n    logger.log(value);\n    this._currentGeocodingDelimitation = value;\n\n    // on met  jour l'interaction de la map en fonction de la nouvelle dlimitation\n    var map = this.getMap();\n    // on supprime l'interaction prcdente, ainsi que les gomtries et valeurs stockes (filtres, position)\n    this._clearInputFeatures();\n    // on supprime l'ventuelle prcdente interaction\n    this._removeMapInteraction(map);\n    // on cre une nouvelle interaction\n    this._activateMapInteraction(map);\n};\n\n/**\n * this method is called by event 'click' on 'GPreverseGeocodingReturnPicto' div\n * (cf. ReverseGeocodingDOM._createReverseGeocodingPanelReturnPictoElement),\n * and clear geocoded location (from both list container and map)\n *\n * @private\n */\nReverseGeocode.prototype.onGPreverseGeocodingReturnPictoClick = function() {\n    // suppression des rsultats prcdents\n    this._clearResults();\n    // on efface les points qui ont pu tre saisis prcdemment\n    this._clearInputFeatures();\n    // et on ractive l'interaction sur la map\n    this._activateMapInteraction(this.getMap());\n};\n\n/**\n * this methode is called by event 'submit' on reverseGeocoding form ('GPreverseGeocodingForm')\n * (cf. ReverseGeocodingDOM._createReverseGeocodingPanelFormElement),\n * it checks reverse geocode mandatory parameters,\n * then call this._reverseGeocodingRequest() to generate and send request\n *\n * @private\n */\nReverseGeocode.prototype.onReverseGeocodingSubmit = function() {\n\n    // le paramtre position est obligatoire\n    if (!this._requestPosition) {\n        logger.log(\"missing position\");\n        return;\n    }\n\n    // si on n'a trouv aucun droit, on evite une requte inutile ...\n    if (this._noRightManagement) {\n        return;\n    }\n\n    this._reverseGeocodingRequest();\n};\n\n/**\n * this method is called by event 'click' on 'ReverseGeocodedLocation_' div\n * (cf. ReverseGeocodingDOM._createReverseGeocodingResultElement),\n * and zoom to location ?\n * TODO\n *\n * @param {Object} e - HTMLElement\n * @private\n */\nReverseGeocode.prototype.onReverseGeocodingResultClick = function(e) {\n    logger.log(\"onReverseGeocodingResultClick\", e);\n};\n\n/**\n * this method is called by event 'mouseover' on 'ReverseGeocodedLocation_' div\n * (cf. ReverseGeocodingDOM._createReverseGeocodingResultElement),\n * and changes style of matching marker on map (selected)\n *\n * @param {Object} e - HTMLElement\n * @private\n */\nReverseGeocode.prototype.onReverseGeocodingResultMouseOver = function(e) {\n\n    // rcupration de l'id du rsultat survol\n    var tagid = e.target.id; // ex ReverseGeocodedLocation_21\n    var idx = tagid.substring(tagid.indexOf(\"_\") + 1); // ex. 21\n\n    // on passe le texte en gras\n    if (e.target.classList) {\n        e.target.classList.add(\"GPreverseGeocodedLocationHighlight\");\n    }\n\n    if (!this._resultsFeaturesSource) {\n        return;\n    }\n\n    // on rcupre l'entit correspondante au rsultat survol\n    var f = this._resultsFeaturesSource.getFeatureById(parseInt(idx, 10));\n    // et on lui affecte un nouveau style\n    f.setStyle(this._resultsSelectedStyle);\n};\n\n/**\n * this method is called by event 'mouseout' on 'ReverseGeocodedLocation_' div\n * (cf. ReverseGeocodingDOM._createReverseGeocodingResultElement),\n * and changes style of matching marker on map (default)\n *\n * @param {Object} e - HTMLElement\n * @private\n */\nReverseGeocode.prototype.onReverseGeocodingResultMouseOut = function(e) {\n\n    // rcupration de l'id du rsultat survol\n    var tagid = e.target.id; // ex GProuteResultsDetailsInstruction_125\n    var idx = tagid.substring(tagid.indexOf(\"_\") + 1); // ex. 125\n\n    // on repasse le texte en style normal\n    if (e.target.classList) {\n        e.target.classList.remove(\"GPreverseGeocodedLocationHighlight\");\n    }\n\n    if (!this._resultsFeaturesSource) {\n        return;\n    }\n    // on rcupre l'entit correspondante au rsultat qui tait survol\n    var f = this._resultsFeaturesSource.getFeatureById(parseInt(idx, 10));\n    // et on lui raffecte un style normal\n    f.setStyle(this._resultsDefaultStyle);\n};\n\n// ################################################################### //\n// ################################ clean ############################ //\n// ################################################################### //\n\n/**\n * this method clears previous location results\n *\n * @private\n */\nReverseGeocode.prototype._clearResults = function() {\n\n    var map = this.getMap();\n\n    this._reverseGeocodingLocations = [];\n    // on vide le container avec la liste des rsultats\n    if (this._resultsListContainer) {\n        while (this._resultsListContainer.firstChild) {\n            this._resultsListContainer.removeChild(this._resultsListContainer.firstChild);\n        }\n    }\n    // on retire la couche des rsultats\n    if (this._resultsFeaturesLayer) {\n        map.removeLayer(this._resultsFeaturesLayer);\n        this._resultsFeaturesLayer = null;\n    }\n    // on retire l'overlay de la popup de la carte\n    if (this._popupOverlay != null) {\n        map.removeOverlay(this._popupOverlay);\n        this._popupOverlay = null;\n    }\n    // on retire les interactions sur les markers (select et mouseover)\n    if (this._resultsSelectInteraction != null) {\n        map.removeInteraction(this._resultsSelectInteraction);\n        this._resultsSelectInteraction = null;\n    }\n    if (this._resultsHoverInteraction != null) {\n        map.removeInteraction(this._resultsHoverInteraction);\n        this._resultsHoverInteraction = null;\n    }\n};\n\n/**\n * this method clears previous input features (features, layer, position and filters)\n *\n * @private\n */\nReverseGeocode.prototype._clearInputFeatures = function() {\n    // on efface les points qui ont pu tre saisis prcdemment (on vide la collection des features de la couche)\n    if (this._inputFeatures) {\n        this._inputFeatures.clear();\n    }\n\n    // on supprime les valeurs stockes (filtres, position)\n    this._requestPosition = null;\n    this._requestCircleFilter = null;\n    this._requestBboxFilter = null;\n};\n\n/**\n * this method displays waiting container and sets a timeout\n *\n * @private\n */\nReverseGeocode.prototype._displayWaitingContainer = function() {\n\n    this._waitingContainer.className = \"GProuteCalcWaitingContainerVisible\";\n    this._waiting = true;\n\n    // mise en place d'un timeout pour rinitialiser le panel (cacher la patience)\n    // si on est toujours en attente (si la requte est bloque par exemple)\n    if (this._timer) {\n        clearTimeout(this._timer);\n        this._timer = null;\n    }\n    var context = this;\n    this._timer = setTimeout(function() {\n        if (context._waiting === true) {\n            context._hideWaitingContainer();\n        } else {\n            if (context._timer) {\n                clearTimeout(context._timer);\n            }\n        }\n    }, 16000);\n};\n\n/**\n * this method hides waiting container and clears timeout\n *\n * @private\n */\nReverseGeocode.prototype._hideWaitingContainer = function() {\n    if (this._waiting) {\n        this._waitingContainer.className = \"GProuteCalcWaitingContainerHidden\";\n        this._waiting = false;\n        clearTimeout(this._timer);\n        this._timer = null;\n    }\n};\n\nexport default ReverseGeocode;\n\n\n\n// WEBPACK FOOTER //\n// ./src/OpenLayers/Controls/ReverseGeocode.js","var ReverseGeocodingDOM = {\n\n    /** Add uuid to the tag ID */\n    _addUID: function(id) {\n        var uid = (this._uid) ? id + \"-\" + this._uid : id;\n        return uid;\n    },\n\n    /**\n     * Main container (DOM)\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createMainContainerElement: function() {\n\n        var container = document.createElement(\"div\");\n        container.id = this._addUID(\"GPreverseGeocoding\");\n        container.className = \"GPwidget\";\n        return container;\n    },\n\n    // ################################################################### //\n    // ################### Methods of main container ##################### //\n    // ################################################################### //\n\n    /**\n     * Hidden checkbox for minimizing/maximizing\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createShowReverseGeocodingElement: function() {\n\n        var input = document.createElement(\"input\");\n        input.id = this._addUID(\"GPshowReverseGeocoding\");\n        input.type = \"checkbox\";\n        return input;\n    },\n\n    /**\n     * Show ReverseGeocoding\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createShowReverseGeocodingPictoElement: function() {\n\n        // contexte d'execution\n        var self = this;\n\n        var label = document.createElement(\"label\");\n        label.id = this._addUID(\"GPshowReverseGeocodingPicto\");\n        label.className = \"GPshowAdvancedToolPicto\";\n        label.htmlFor = this._addUID(\"GPshowReverseGeocoding\");\n        label.title = \"Ouvrir la recherche inverse\";\n\n        // Close all results and panels when minimizing the widget\n        if (label.addEventListener) {\n            label.addEventListener(\"click\", function() {\n                self.onShowReverseGeocodingClick();\n            });\n        } else if (label.attachEvent) {\n            label.attachEvent(\"onclick\", function() {\n                self.onShowReverseGeocodingClick();\n            });\n        }\n\n        var spanOpen = document.createElement(\"span\");\n        spanOpen.id = this._addUID(\"GPshowReverseGeocodingOpen\");\n        spanOpen.className = \"GPshowAdvancedToolOpen\";\n        label.appendChild(spanOpen);\n\n        return label;\n    },\n\n    /**\n     * Create Waiting Panel\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createReverseGeocodingWaitingElement: function() {\n        var div = document.createElement(\"div\");\n        div.id = this._addUID(\"GPreverseGeocodingCalcWaitingContainer\");\n        div.className = \"GPreverseGeocodingCalcWaitingContainerHidden\";\n\n        var p = document.createElement(\"p\");\n        p.className = \"GPreverseGeocodingCalcWaiting\";\n        p.innerHTML = \"Recherche en cours...\";\n\n        div.appendChild(p);\n\n        return div;\n    },\n\n    /**\n     * Reverse geocoding results panel element.\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createReverseGeocodingResultsPanelElement: function() {\n        var resultsPanelDiv = document.createElement(\"div\");\n        resultsPanelDiv.id = this._addUID(\"GPreverseGeocodingResultsPanel\");\n        resultsPanelDiv.className = \"GPpanel GPreverseGeocodingComponentHidden\";\n        return resultsPanelDiv;\n    },\n\n    /**\n     * Reverse geocoding results list.\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createReverseGeocodingResultsListElement: function() {\n        var container = document.createElement(\"div\");\n        container.id = this._addUID(\"GPreverseGeocodingResultsList\");\n        // Results are dynamically filled in Javascript by reverse geocoding service\n        return container;\n    },\n\n    /**\n     *  Add Result\n     * (results dynamically generate !)\n     *\n     * @param {String} locationDescription - reverse geocoded location results\n     * @param {Number} id - ID\n     */\n    _createReverseGeocodingResultElement: function(locationDescription, id) {\n\n        // contexte\n        var context = this;\n\n        var container = document.getElementById(this._addUID(\"GPreverseGeocodingResultsList\"));\n\n        var div = document.createElement(\"div\");\n        div.id = this._addUID(\"ReverseGeocodedLocation_\" + id);\n        div.className = \"GPautoCompleteProposal\";\n        div.innerHTML = locationDescription;\n        div.title = locationDescription;\n\n        if (div.addEventListener) {\n            div.addEventListener(\"mouseover\", function(e) {\n                context.onReverseGeocodingResultMouseOver(e);\n            });\n            div.addEventListener(\"mouseout\", function(e) {\n                context.onReverseGeocodingResultMouseOut(e);\n            });\n            div.addEventListener(\"click\", function(e) {\n                if (typeof context.onReverseGeocodingResultClick === \"function\") {\n                    context.onReverseGeocodingResultClick(e);\n                }\n            });\n        } else if (div.attachEvent) {\n            div.attachEvent(\"onmouseover\", function(e) {\n                context.onReverseGeocodingResultMouseOver(e);\n            });\n            div.attachEvent(\"onmouseout\", function(e) {\n                context.onReverseGeocodingResultMouseOut(e);\n            });\n            div.attachEvent(\"onclick\", function(e) {\n                if (typeof context.onReverseGeocodingResultClick === \"function\") {\n                    context.onReverseGeocodingResultClick(e);\n                }\n            });\n        }\n\n        container.appendChild(div);\n    },\n\n    // ################################################################### //\n    // ######################### Inputs panel ############################ //\n    // ################################################################### //\n\n    /**\n     * Create Container Panel\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createReverseGeocodingPanelElement: function() {\n        var div = document.createElement(\"div\");\n        div.id = this._addUID(\"GPreverseGeocodingPanel\");\n        div.className = \"GPpanel\";\n\n        return div;\n    },\n\n    /**\n     * Create Header Panel\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createReverseGeocodingPanelHeaderElement: function() {\n        var container = document.createElement(\"div\");\n        container.className = \"GPpanelHeader\";\n        // info: on spare les appels pour la cration du picto de retour,\n        // du titre et de la croix de fermeture pour les rcuprer dans le composant\n        return container;\n    },\n\n    /**\n     * Create return picto in panel header\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createReverseGeocodingPanelReturnPictoElement: function() {\n        // contexte\n        var self = this;\n\n        var divNew = document.createElement(\"div\");\n        divNew.id = this._addUID(\"GPreverseGeocodingReturnPicto\");\n        divNew.title = \"Nouvelle recherche\";\n        divNew.className = \"GPreverseGeocodingReturnPictoHidden\";\n        if (divNew.addEventListener) {\n            divNew.addEventListener(\"click\", function(e) {\n                document.getElementById(self._addUID(\"GPreverseGeocodingResultsPanel\")).className = \"GProuteComponentHidden\";\n                document.getElementById(self._addUID(\"GPreverseGeocodingForm\")).className = \"\";\n                document.getElementById(self._addUID(\"GPreverseGeocodingHeaderTitle\")).innerHTML = \"Recherche inverse\";\n                document.getElementById(self._addUID(\"GPreverseGeocodingReturnPicto\")).className = \"GPreverseGeocodingReturnPictoHidden\";\n                self.onGPreverseGeocodingReturnPictoClick(e);\n            });\n        } else if (divNew.attachEvent) {\n            divNew.attachEvent(\"onclick\", function(e) {\n                document.getElementById(self._addUID(\"GPreverseGeocodingResultsPanel\")).className = \"GProuteComponentHidden\";\n                document.getElementById(self._addUID(\"GPreverseGeocodingForm\")).className = \"\";\n                document.getElementById(self._addUID(\"GPreverseGeocodingHeaderTitle\")).innerHTML = \"Recherche inverse\";\n                document.getElementById(self._addUID(\"GPreverseGeocodingReturnPicto\")).className = \"GPreverseGeocodingReturnPictoHidden\";\n                self.onGPreverseGeocodingReturnPictoClick(e);\n            });\n        }\n        return divNew;\n    },\n\n    /**\n     * Create Header Title Panel\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createReverseGeocodingPanelTitleElement: function() {\n        var div = document.createElement(\"div\");\n        div.className = \"GPpanelTitle\";\n        div.id = this._addUID(\"GPreverseGeocodingHeaderTitle\");\n        div.innerHTML = \"Recherche inverse\";\n        return div;\n    },\n\n    /**\n     * Create Header close div\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createReverseGeocodingPanelCloseElement: function() {\n        // contexte\n        var self = this;\n\n        var divClose = document.createElement(\"div\");\n        divClose.id = this._addUID(\"GPreverseGeocodingPanelClose\");\n        divClose.className = \"GPpanelClose\";\n        divClose.title = \"Fermer le panneau\";\n\n        // Link panel close / visibility checkbox\n        if (divClose.addEventListener) {\n            divClose.addEventListener(\"click\", function() {\n                document.getElementById(self._addUID(\"GPshowReverseGeocodingPicto\")).click();\n            }, false);\n        } else if (divClose.attachEvent) {\n            divClose.attachEvent(\"onclick\", function() {\n                document.getElementById(self._addUID(\"GPshowReverseGeocodingPicto\")).click();\n            });\n        }\n\n        return divClose;\n    },\n\n    /**\n     * Create Form\n     * see event !\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createReverseGeocodingPanelFormElement: function() {\n\n        // contexte d'execution\n        var self = this;\n\n        var form = document.createElement(\"form\");\n        form.id = this._addUID(\"GPreverseGeocodingForm\");\n\n        if (form.addEventListener) {\n            form.addEventListener(\"submit\", function(e) {\n                e.preventDefault();\n                self.onReverseGeocodingSubmit();\n            });\n        } else if (form.attachEvent) {\n            form.attachEvent(\"onsubmit\", function(e) {\n                e.preventDefault();\n                self.onReverseGeocodingSubmit();\n            });\n        }\n\n        return form;\n    },\n\n    // ################################################################### //\n    // ####################### Choice mode into form ##################### //\n    // ################################################################### //\n\n    /**\n     * Create Container to Mode choice geocoding type\n     *\n     * @param {Array} resources - geocoding resources to be displayed (and used)\n     * @returns {DOMElement} DOM element\n     */\n    _createReverseGeocodingFormModeChoiceGeocodingTypeElement: function(resources) {\n\n        // contexte d'execution\n        var context = this;\n\n        var div = document.createElement(\"div\");\n        div.className = \"GPflexInput\";\n\n        var label = document.createElement(\"label\");\n        label.className = \"GPreverseGeocodingCodeLabel\";\n        label.innerHTML = \"Recherche par\";\n        label.title = \"Recherche par\";\n        div.appendChild(label);\n\n        var select = document.createElement(\"select\");\n        select.className = \"GPreverseGeocodingCode\";\n        // gestionnaire d'evenement : on stocke la valeur du type de geocodage,\n        // utilis dans la requte de gocodage inverse\n        if (select.addEventListener) {\n            select.addEventListener(\"change\", function(e) {\n                context.onReverseGeocodingTypeChange(e);\n            });\n        } else if (select.attachEvent) {\n            select.attachEvent(\"onchange\", function(e) {\n                context.onReverseGeocodingTypeChange(e);\n            });\n        }\n\n        // on prend soit les valeurs passes par l'utilisateur, soit des valeurs par dfaut\n        if (!resources || !Array.isArray(resources)) {\n            resources = [\"StreetAddress\", \"PositionOfInterest\", \"CadastralParcel\"];\n        }\n        for (var i = 0; i < resources.length; i++) {\n            switch (resources[i]) {\n                case \"PositionOfInterest\":\n                    var POIOption = document.createElement(\"option\");\n                    POIOption.value = \"PositionOfInterest\";\n                    POIOption.text = \"Lieux/toponymes\";\n                    select.appendChild(POIOption);\n                    break;\n                case \"StreetAddress\":\n                    var SAOption = document.createElement(\"option\");\n                    SAOption.value = \"StreetAddress\";\n                    SAOption.text = \"Adresses\";\n                    select.appendChild(SAOption);\n                    break;\n                case \"CadastralParcel\":\n                    var CPOption = document.createElement(\"option\");\n                    CPOption.value = \"CadastralParcel\";\n                    CPOption.text = \"Parcelles cadastrales\";\n                    select.appendChild(CPOption);\n                    break;\n                case \"Administratif\":\n                    var adminOption = document.createElement(\"option\");\n                    adminOption.value = \"Administratif\";\n                    adminOption.text = \"Units administratives\";\n                    select.appendChild(adminOption);\n                    break;\n                default:\n                    break;\n            }\n        }\n\n        div.appendChild(select);\n\n        return div;\n    },\n\n    /**\n     * Create Container to Mode choice geocoding delimitation\n     *\n     * @param {Array} delimitations - geocoding delimitations to be displayed (and used)\n     * @returns {DOMElement} DOM element\n     */\n    _createReverseGeocodingFormModeChoiceGeocodingDelimitationElement: function(delimitations) {\n\n        // contexte d'execution\n        var context = this;\n\n        var div = document.createElement(\"div\");\n        div.className = \"GPflexInput\";\n\n        var label = document.createElement(\"label\");\n        label.className = \"GPreverseGeocodingCodeLabel\";\n        label.innerHTML = \"Dlimitation\";\n        label.title = \"Dlimitation\";\n        div.appendChild(label);\n\n        var select = document.createElement(\"select\");\n        select.className = \"GPreverseGeocodingCode\";\n        // gestionnaire d'evenement : on stocke la valeur du type de dlimitation,\n        // et on modifie l'vnement de pointage sur la carte en fonction\n        if (select.addEventListener) {\n            select.addEventListener(\"change\", function(e) {\n                context.onReverseGeocodingDelimitationChange(e);\n            });\n        } else if (select.attachEvent) {\n            select.attachEvent(\"onchange\", function(e) {\n                context.onReverseGeocodingDelimitationChange(e);\n            });\n        }\n\n        // on prend soit les valeurs passes par l'utilisateur, soit des valeurs par dfaut\n        if (!delimitations || !Array.isArray(delimitations)) {\n            delimitations = [\"Point\", \"Circle\", \"Extent\"];\n        }\n        for (var i = 0; i < delimitations.length; i++) {\n            switch (delimitations[i].toLowerCase()) {\n                case \"point\":\n                    var pointOption = document.createElement(\"option\");\n                    pointOption.value = \"point\";\n                    pointOption.text = \"Pointer un lieu\";\n                    select.appendChild(pointOption);\n                    break;\n                case \"circle\":\n                    var circleOption = document.createElement(\"option\");\n                    circleOption.value = \"circle\";\n                    circleOption.text = \"Dessiner un cercle\";\n                    select.appendChild(circleOption);\n                    break;\n                case \"extent\":\n                    var extentOption = document.createElement(\"option\");\n                    extentOption.value = \"extent\";\n                    extentOption.text = \"Dessiner une emprise\";\n                    select.appendChild(extentOption);\n                    break;\n                default:\n                    break;\n            }\n        }\n\n        div.appendChild(select);\n\n        return div;\n    },\n\n    // ################################################################### //\n    // ########################### Submit Form ########################### //\n    // ################################################################### //\n\n    /**\n     * Create Submit Form Element\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createReverseGeocodingSubmitFormElement: function() {\n\n        var input = document.createElement(\"input\");\n        input.id = this._addUID(\"GPreverseGeocodingSubmit\");\n        input.className = \"GPinputSubmit\";\n        input.type = \"submit\";\n        input.value = \"Rechercher\";\n\n        return input;\n    }\n\n};\n\nexport default ReverseGeocodingDOM;\n\n\n\n// WEBPACK FOOTER //\n// ./src/Common/Controls/ReverseGeocodingDOM.js","import ol from \"ol\";\nimport Gp from \"gp\";\nimport Logger from \"../../Common/Utils/LoggerByDefault\";\nimport Utils from \"../../Common/Utils\";\nimport Markers from \"./Utils/Markers\";\nimport LayerImportDOM from \"../../Common/Controls/LayerImportDOM\";\nimport SelectorID from \"../../Common/Utils/SelectorID\";\nimport ProxyUtils from \"../../Common/Utils/ProxyUtils\";\nimport KMLExtended from \"../Formats/KML\";\n\n\nvar logger = Logger.getLogger(\"layerimport\");\n\n/**\n * @classdesc\n *\n * LayerImport Control. Allows users to add geographical data in standards formats from their own sources to the map.\n *\n * @constructor\n * @alias ol.control.LayerImport\n * @extends {ol.control.Control}\n * @param {Object} options - options for function call.\n * @param {Boolean} [options.collapsed = false] - Specify if LayerImport control should be collapsed at startup. Default is true.\n * @param {Array} [options.layerTypes = [\"KML\", \"GPX\", \"GeoJSON\", \"WMS\", \"WMTS\"]] - data types that could be imported : \"KML\", \"GPX\", \"GeoJSON\", \"WMS\" and \"WMTS\". Values will be displayed in the same order in widget list.\n * @param {Object} [options.webServicesOptions = {}] - Options to import WMS or WMTS layers\n * @param {String} [options.webServicesOptions.proxyUrl] - Proxy URL to avoid cross-domain problems. Mandatory to import WMS and WMTS layer.\n * @param {Array.<String>} [options.webServicesOptions.noProxyDomains] - Proxy will not be used for this list of domain names. Only use if you know what you're doing.\n * @param {Object} [options.vectorStyleOptions] - Options for imported vector layer styling (KML, GPX, GeoJSON)\n * @param {Object} [options.vectorStyleOptions.KML] - Options for KML layer styling\n * @param {Boolean} [options.vectorStyleOptions.KML.extractStyles = true] - Extract styles from the KML. Default is true.\n * @param {Boolean} [options.vectorStyleOptions.KML.showPointNames = true] - Show names as labels for KML placemarks which contain points. Default is true.\n * @param {Object} [options.vectorStyleOptions.KML.defaultStyle] - default style to be applied to KML imports in case no style is defined. defaultStyle is an {@link http://openlayers.org/en/latest/apidoc/ol.style.Style.html ol.style.Style} object.\n * @param {Object} [options.vectorStyleOptions.GPX] - Options for GPX layer styling\n * @param {Object} [options.vectorStyleOptions.GPX.defaultStyle] - default style to be applied to GPX imports in case no style is defined. defaultStyle is an {@link http://openlayers.org/en/latest/apidoc/ol.style.Style.html ol.style.Style} object.\n * @param {Object} [options.vectorStyleOptions.GeoJSON] - Options for GeoJSON layer styling\n * @param {Object} [options.vectorStyleOptions.GeoJSON.defaultStyle] - default style to be applied to GeoJSON imports in case no style is defined. defaultStyle is an {@link http://openlayers.org/en/latest/apidoc/ol.style.Style.html ol.style.Style} object.\n * @example\n *  var LayerImport = new ol.control.LayerImport({\n *      collapsed : false,\n *      layerTypes : [\"KML\", \"GPX\"],\n *      webServicesOptions : {\n *          proxyUrl : \"http://localhost/proxy/php/proxy.php?url=\",\n *          noProxyDomains : []\n *      },\n *      vectorStyleOptions : {\n *          KML : {\n *              extractStyles : true,\n *              defaultStyle : new ol.style.Style({\n *                  image : new ol.style.Icon({\n *                       src : \"data:image/png;base64....\",\n *                       size : [51, 38],\n *                  }),\n *                  stroke : new ol.style.Stroke({\n *                       color : \"#ffffff\",\n *                       width : 7\n *                  }),\n *                  fill : new ol.style.Fill({\n *                       color : \"rgba(255, 183, 152, 0.2)\"\"\n *                  }),\n *                  text : new ol.style.Text({\n *                      font : \"16px Sans\",\n *                      textAlign : \"left\",\n *                      fill : new ol.style.Fill({\n *                          color : \"rgba(255, 255, 255, 1)\"\n *                      }),\n *                      stroke : new ol.style.Stroke({\n *                          color : \"rgba(0, 0, 0, 1)\",\n *                          width : 2\n *                      })\n *                  })\n *              })\n *          },\n *          GPX : {\n *              defaultStyle : new ol.style.Style({\n *                  image : new ol.style.Icon({\n *                       src : \"path/to/my/icon.png\",\n *                       size : [51, 38],\n *                  }),\n *                  stroke : new ol.style.Stroke({\n *                       color : \"#ffffff\",\n *                       width : 7\n *                  })\n *              })\n *          }\n *      }\n *  });\n */\nfunction LayerImport(options) {\n\n    options = options || {};\n\n    if (!(this instanceof LayerImport)) {\n        throw new TypeError(\"ERROR CLASS_CONSTRUCTOR\");\n    }\n\n    this._initialize(options);\n\n    // init control DOM container\n    var container = this._initContainer(options);\n\n    // call ol.control.Control constructor\n    ol.control.Control.call(this, {\n        element: container,\n        target: options.target,\n        render: options.render\n    });\n};\n\n// Inherits from ol.control.Control\nol.inherits(LayerImport, ol.control.Control);\n\n/**\n * Default styles applyied to KML, GPX and GeoJSON features.\n *\n * @private\n */\nLayerImport.DefaultStyles = {\n    image: new ol.style.Icon({\n        src: Markers[\"lightOrange\"],\n        anchor: [25.5, 38],\n        anchorOrigin: \"top-left\",\n        anchorXUnits: \"pixels\",\n        anchorYUnits: \"pixels\"\n    }),\n    stroke: new ol.style.Stroke({\n        color: \"rgba(0,42,80,0.8)\",\n        width: 4\n    }),\n    fill: new ol.style.Fill({\n        color: \"rgba(0, 183, 152, 0.5)\"\n    }),\n    text: new ol.style.Text({\n        font: \"16px Sans\",\n        textAlign: \"left\",\n        fill: new ol.style.Fill({\n            color: \"rgba(255, 255, 255, 1)\"\n        }),\n        stroke: new ol.style.Stroke({\n            color: \"rgba(0, 0, 0, 1)\",\n            width: 2\n        })\n    })\n};\n\n/**\n * @lends module:LayerImport\n */\nLayerImport.prototype = Object.create(ol.control.Control.prototype, {});\n\n// on rcupre les mthodes de la classe commune LayerImportDOM\nUtils.assign(LayerImport.prototype, LayerImportDOM);\n\n/**\n * Constructor (alias)\n *\n * @private\n */\nLayerImport.prototype.constructor = LayerImport;\n\n// ################################################################### //\n// ############## public methods (getters, setters) ################## //\n// ################################################################### //\n\n/**\n * Returns true if widget is collapsed (minimized), false otherwise\n *\n * @returns {Boolean} collapsed - true if widget is collapsed\n */\nLayerImport.prototype.getCollapsed = function() {\n    return this.collapsed;\n};\n\n/**\n * Collapse or display widget main container\n *\n * @param {Boolean} collapsed - True to collapse widget, False to display it\n */\nLayerImport.prototype.setCollapsed = function(collapsed) {\n    if (collapsed === undefined) {\n        console.log(\"[ERROR] LayerImport:setCollapsed - missing collapsed parameter\");\n        return;\n    }\n    if ((collapsed && this.collapsed) || (!collapsed && !this.collapsed)) {\n        return;\n    }\n    if (collapsed) {\n        document.getElementById(\"GPimportPanelClose-\" + this._uid).click();\n    } else {\n        document.getElementById(\"GPshowImport-\" + this._uid).click();\n    }\n    this.collapsed = collapsed;\n};\n\n/**\n * Returns content of a static import (KML, GPX or GeoJSON)\n *\n * @returns {String} contentStatic  - content static\n */\nLayerImport.prototype.getStaticImportContent = function() {\n    return this.contentStatic;\n};\n\n/**\n * Returns content of a service import (GetCapabilities)\n *\n * @returns {String} contentService  - content service\n */\nLayerImport.prototype.getServiceImportContent = function() {\n    return this.contentService;\n};\n\n// ################################################################### //\n// ##################### init component ############################## //\n// ################################################################### //\n\n/**\n * Initialize LayerImport control (called by LayerImport constructor)\n *\n * @param {Object} options - constructor options\n * @private\n */\nLayerImport.prototype._initialize = function(options) {\n\n    // ############################################################ //\n    // ################### Options du composant ################### //\n\n    // check input options format\n    this._checkInputOptions(options);\n\n    // set default options\n    this.options = {\n        collapsed: true,\n        layerTypes: [\"KML\", \"GPX\", \"GeoJSON\", \"WMS\", \"WMTS\"],\n        webServicesOptions: {},\n        vectorStyleOptions: {\n            KML: {\n                extractStyles: true,\n                showPointNames: true,\n                defaultStyle: {}\n            },\n            GPX: {\n                defaultStyle: {}\n            },\n            GeoJSON: {\n                defaultStyle: {}\n            }\n        }\n    };\n\n    // set extractStyles parameter\n    if (options.vectorStyleOptions && options.vectorStyleOptions.KML && options.vectorStyleOptions.KML.extractStyles) {\n        this.options.vectorStyleOptions.KML.extractStyles = options.vectorStyleOptions.KML.extractStyles;\n    }\n    // set showPointNames parameter\n    if (options.vectorStyleOptions && options.vectorStyleOptions.KML && options.vectorStyleOptions.KML.showPointNames) {\n        this.options.vectorStyleOptions.KML.showPointNames = options.vectorStyleOptions.KML.showPointNames;\n    }\n\n    // set vector layers default styles (KML, GPX, GeoJSON)\n    if (options.vectorStyleOptions && options.vectorStyleOptions.KML && options.vectorStyleOptions.KML.defaultStyle) {\n        // get from options if specified\n        this.options.vectorStyleOptions.KML.defaultStyle = options.vectorStyleOptions.KML.defaultStyle;\n    } else {\n        // get from control default options otherwise\n        this.options.vectorStyleOptions.KML.defaultStyle = new ol.style.Style({\n            image: LayerImport.DefaultStyles.image,\n            stroke: LayerImport.DefaultStyles.stroke,\n            fill: LayerImport.DefaultStyles.fill,\n            text: LayerImport.DefaultStyles.text\n        });\n    }\n    if (options.vectorStyleOptions && options.vectorStyleOptions.GPX && options.vectorStyleOptions.GPX.defaultStyle) {\n        // get from options if specified\n        this.options.vectorStyleOptions.GPX.defaultStyle = options.vectorStyleOptions.GPX.defaultStyle;\n    } else {\n        // get from control default options otherwise\n        this.options.vectorStyleOptions.GPX.defaultStyle = new ol.style.Style({\n            image: LayerImport.DefaultStyles.image,\n            stroke: LayerImport.DefaultStyles.stroke,\n            fill: LayerImport.DefaultStyles.fill\n        });\n    }\n    if (options.vectorStyleOptions && options.vectorStyleOptions.GeoJSON && options.vectorStyleOptions.GeoJSON.defaultStyle) {\n        // get from options if specified\n        this.options.vectorStyleOptions.GeoJSON.defaultStyle = options.vectorStyleOptions.GeoJSON.defaultStyle;\n    } else {\n        // get from control default options otherwise\n        this.options.vectorStyleOptions.GeoJSON.defaultStyle = new ol.style.Style({\n            image: LayerImport.DefaultStyles.image,\n            stroke: LayerImport.DefaultStyles.stroke,\n            fill: LayerImport.DefaultStyles.fill\n        });\n    }\n\n    // merge layer types\n    if (Array.isArray(options.layerTypes)) {\n        var layerTypes = [];\n        for (var i = 0; i < options.layerTypes.length; i++) {\n            layerTypes.push(options.layerTypes[i]);\n        }\n        this.options.layerTypes = layerTypes;\n    }\n\n    // merge with user options\n    Utils.mergeParams(this.options, options);\n\n    /** {Boolean} specify if reverseGeocoding control is collapsed (true) or not (false) */\n    this.collapsed = this.options.collapsed;\n\n    // identifiant du contrle : utile pour suffixer les identifiants CSS (pour grer le cas o il y en a plusieurs dans la mme page)\n    this._uid = SelectorID.generate();\n\n    // si une requte est en cours ou non\n    this._waiting = false;\n    // timer pour cacher la patience aprs un certain temps\n    this._timer = null;\n\n    // initialisation des types d'import\n    this._initImportTypes();\n    // initialisation des styles par dfaut\n    this._initDefaultStyles();\n\n    // ################################################################## //\n    // ################### Elements principaux du DOM ################### //\n\n    // containers principaux (FIXME : tous utiles ?)\n    this._showImportInput = null;\n    this._importPanel = null;\n    this._formContainer = null;\n    this._staticLocalImportInput = null;\n    this._staticUrlImportInput = null;\n    this._serviceUrlImportInput = null;\n    this._getCapPanel = null;\n    this._getCapResultsListContainer = null;\n    this._waitingContainer = null;\n\n    // ################################################################## //\n    // ################ Interrogation du GetCapabilities ################ //\n\n    this._getCapRequestUrl = null;\n    this._getCapResponseWMS = null;\n    this._getCapResponseWMSLayers = [];\n    this._getCapResponseWMTS = null;\n    this._getCapResponseWMTSLayers = [];\n\n};\n\n/**\n * this method is called by this.initialize()\n * and makes sure input options are correctly formated\n *\n * @param {Object} options - control input options\n * @private\n */\nLayerImport.prototype._checkInputOptions = function(options) {\n    // on vrifie le tableau des types\n    if (options.layerTypes) {\n        var layerTypes = options.layerTypes;\n        // on vrifie que la liste des types est bien un tableau\n        if (!Array.isArray(layerTypes)) {\n            console.log(\"[ol.control.LayerImport] 'options.layerTypes' parameter should be an array. Set default values [\\\"KML\\\", \\\"GPX\\\", \\\"GeoJSON\\\", \\\"WMS\\\", \\\"WMTS\\\"]\");\n            options.layerTypes = [\n                \"KML\",\n                \"GPX\",\n                \"GeoJSON\",\n                \"WMS\",\n                \"WMTS\"\n            ];\n        } else {\n            var typesList = [\n                \"KML\",\n                \"GPX\",\n                \"GEOJSON\",\n                \"WMS\",\n                \"WMTS\",\n                \"WFS\"\n            ];\n            var wrongTypesIndexes = [];\n            for (var i = 0; i < layerTypes.length; i++) {\n                if (typeof layerTypes[i] !== \"string\") {\n                    // si l'lment du tableau n'est pas une chaine de caractres, on stocke l'index pour le retirer du tableau\n                    wrongTypesIndexes.push(i);\n                    console.log(\"[ol.control.LayerImport] 'options.layerTypes' elements should be of type string (\" + layerTypes[i] + \")\");\n                } else {\n                    // on passe en majuscules pour comparer\n                    layerTypes[i] = layerTypes[i].toUpperCase();\n                    if (typesList.indexOf(layerTypes[i]) === -1) {\n                        // si le type n'est pas rfrenc, on stocke son index pour le retirer du tableau (aprs avoir termin de parcourir le tableau)\n                        wrongTypesIndexes.push(i);\n                        console.log(\"[ol.control.LayerImport] options.layerTypes : \" + layerTypes[i] + \" is not a supported type\");\n                    }\n                    // cas spcial du GeoJSON qu'on ne laisse pas en majuscules\n                    if (layerTypes[i] === \"GEOJSON\") {\n                        layerTypes[i] = \"GeoJSON\";\n                    }\n                }\n            }\n            // on retire les types non rfrencs qu'on a pu rencontrer\n            if (wrongTypesIndexes.length !== 0) {\n                for (var j = wrongTypesIndexes.length - 1; j >= 0; j--) {\n                    layerTypes.splice(wrongTypesIndexes[j], 1);\n                }\n            }\n        }\n    }\n};\n\n/**\n * this method is called by this.initialize()\n * and initializes default styles for vector layers (KML/GPX/GeoJSON)\n *\n * @private\n */\nLayerImport.prototype._initDefaultStyles = function() {\n    var kmlDefaultStyles = this.options.vectorStyleOptions.KML.defaultStyle;\n    this._defaultKMLStyle = new ol.style.Style({\n        image: kmlDefaultStyles.image,\n        stroke: kmlDefaultStyles.stroke,\n        fill: kmlDefaultStyles.fill,\n        text: kmlDefaultStyles.text\n    });\n    var gpxDefaultStyles = this.options.vectorStyleOptions.GPX.defaultStyle;\n    this._defaultGPXStyle = new ol.style.Style({\n        image: gpxDefaultStyles.image,\n        stroke: gpxDefaultStyles.stroke,\n        fill: gpxDefaultStyles.fill\n    });\n    var geoJSONDefaultStyles = this.options.vectorStyleOptions.GeoJSON.defaultStyle;\n    this._defaultGeoJSONStyle = new ol.style.Style({\n        image: geoJSONDefaultStyles.image,\n        stroke: geoJSONDefaultStyles.stroke,\n        fill: geoJSONDefaultStyles.fill\n    });\n};\n\n/**\n * this method is called by this.initialize()\n * and initializes import types parameter\n *\n * @private\n */\nLayerImport.prototype._initImportTypes = function() {\n    this._currentImportType = this.options.layerTypes[0] || \"KML\";\n    if (this._currentImportType === \"KML\" || this._currentImportType === \"GPX\" || this._currentImportType === \"GeoJSON\") {\n        this._isCurrentImportTypeStatic = true;\n    } else if (this._currentImportType === \"WMS\" || this._currentImportType === \"WMTS\" || this._currentImportType === \"WFS\") {\n        this._isCurrentImportTypeStatic = false;\n    }\n    this._currentStaticImportType = \"local\";\n};\n\n/**\n * Create control main container (DOM initialize)\n *\n * @private\n * @returns {DOMElement} container - control main container\n */\nLayerImport.prototype._initContainer = function() {\n\n    // create main container\n    var container = this._createMainContainerElement();\n\n    // create show Import element\n    var inputShow = this._showImportInput = this._createShowImportElement();\n    container.appendChild(inputShow);\n\n    // mode \"collapsed\"\n    if (!this.collapsed) {\n        inputShow.checked = true;\n    }\n\n    // create Import picto\n    var picto = this._createShowImportPictoElement();\n    container.appendChild(picto);\n\n    // panel\n    var importPanel = this._importPanel = this._createImportPanelElement();\n\n    // header\n    var panelHeader = this._createImportPanelHeaderElement();\n    importPanel.appendChild(panelHeader);\n\n    // form : initialisation du formulaire d'import des couches (types d'import et saisie de l'url / du fichier)\n    var importForm = this._formContainer = this._initInputFormElement();\n    importPanel.appendChild(importForm);\n\n    container.appendChild(importPanel);\n\n    // results (dans le panel)\n    var getCapPanel = this._getCapPanel = this._createImportGetCapPanelElement();\n    getCapPanel.appendChild(this._createImportGetCapPanelHeaderElement());\n    var importGetCapResultsList = this._getCapResultsListContainer = this._createImportGetCapResultsListElement();\n    getCapPanel.appendChild(importGetCapResultsList);\n\n    container.appendChild(getCapPanel);\n\n    // waiting\n    var waiting = this._waitingContainer = this._createImportWaitingElement();\n    container.appendChild(waiting);\n\n    return container;\n};\n\n/**\n * Create control main container (DOM initialize)\n *\n * @private\n * @returns {DOMElement} importForm - form main container\n */\nLayerImport.prototype._initInputFormElement = function() {\n    // form main container\n    var importForm = this._createImportPanelFormElement();\n\n    // Format choice\n    var importTypeChoiceDiv = this._createImportTypeLineElement(this.options.layerTypes);\n    importForm.appendChild(importTypeChoiceDiv);\n\n    // params for KML/GPX/GeoJSON\n\n    var importStaticParamsContainer = this._createImportStaticParamsContainer(this.options.layerTypes[0]);\n    // static file name\n    var staticNameLabel = this._createStaticNameLabel();\n    importStaticParamsContainer.appendChild(staticNameLabel);\n    // static import choice (local / url)\n    var staticImportChoice = this._createStaticModeChoiceDiv();\n    // TODO : passer un paramtre \"checked\" ??\n    var staticLocalImportChoice = this._createStaticLocalChoiceDiv();\n    staticImportChoice.appendChild(staticLocalImportChoice);\n    var staticUrlImportChoice = this._createStaticUrlChoiceDiv();\n    staticImportChoice.appendChild(staticUrlImportChoice);\n    importStaticParamsContainer.appendChild(staticImportChoice);\n\n    // div for local file import\n    var staticLocalInputDiv = this._createStaticLocalInputDiv();\n    // label\n    staticLocalInputDiv.appendChild(this._createStaticLocalInputLabel());\n    // file input\n    this._staticLocalImportInput = this._createStaticLocalInput();\n    staticLocalInputDiv.appendChild(this._staticLocalImportInput);\n    // append div to params container\n    importStaticParamsContainer.appendChild(staticLocalInputDiv);\n\n    // div for url input (info: sparation pour rcuprer l'lment input)\n    var staticUrlInputDiv = this._createStaticUrlInputDiv();\n    // label\n    staticUrlInputDiv.appendChild(this._createStaticUrlInputLabel());\n    // url input\n    this._staticUrlImportInput = this._createStaticUrlInput();\n    staticUrlInputDiv.appendChild(this._staticUrlImportInput);\n    // append div to params container\n    importStaticParamsContainer.appendChild(staticUrlInputDiv);\n\n    // append static params container to form container\n    importForm.appendChild(importStaticParamsContainer);\n\n    // params for WMS/WMTS/WFS\n\n    var importServiceParamsContainer = this._createServiceParamsContainer(this.options.layerTypes[0]);\n    // div for service url\n    var importServiceUrlDiv = this._createServiceUrlDiv();\n    // label\n    importServiceUrlDiv.appendChild(this._createServiceUrlInputLabel());\n    // input\n    this._serviceUrlImportInput = this._createServiceUrlInput();\n    importServiceUrlDiv.appendChild(this._serviceUrlImportInput);\n    // append div to params container\n    importServiceParamsContainer.appendChild(importServiceUrlDiv);\n    // append service params container to form container\n    importForm.appendChild(importServiceParamsContainer);\n\n    // submit (bouton \"Importer\")\n    var submit = this._createImportSubmitFormElement();\n    importForm.appendChild(submit);\n\n    return importForm;\n};\n\n// ################################################################### //\n// ######################### DOM events ############################## //\n// ################################################################### //\n\n/**\n * this method is called by event 'click' on 'GPshowImportPicto' picto\n * (cf. LayerImportDOM._createShowImportPictoElement),\n * and dispatch event change:collapsed (for tools listening this property)\n *\n * @private\n */\nLayerImport.prototype._onShowImportClick = function() {\n    this.collapsed = this._showImportInput.checked;\n    // info : on gnre nous mme l'evenement OpenLayers de changement de proprit\n    // (utiliser ol.control.LayerImport.on(\"change:collapsed\", function ) pour s'abonner  cet vnement)\n    this.dispatchEvent(\"change:collapsed\");\n};\n\n/**\n * this method is called by event 'change' on 'GPimportType' tag form\n * (cf. LayerImportDOM._createImportTypeLineElement),\n * and change current import type\n *\n * @param {Object} e - HTMLElement\n * @private\n */\nLayerImport.prototype._onImportTypeChange = function(e) {\n    this._currentImportType = e.target.value;\n    if (this._currentImportType === \"KML\" || this._currentImportType === \"GPX\" || this._currentImportType === \"GeoJSON\") {\n        this._isCurrentImportTypeStatic = true;\n    } else if (this._currentImportType === \"WMS\" || this._currentImportType === \"WMTS\" || this._currentImportType === \"WFS\") {\n        this._isCurrentImportTypeStatic = false;\n    }\n};\n\n/**\n * this method is called by event 'change' on 'GPimportType' tag form\n * (cf. LayerImportDOM._createImportTypeLineElement),\n * and change current import type\n *\n * @param {Object} e - HTMLElement\n * @private\n */\nLayerImport.prototype._onStaticImportTypeChange = function(e) {\n    this._currentStaticImportType = e.target.value;\n};\n\n/**\n * this method is called by event 'click' on 'GPimportGetCapPanelClose' tag form\n * (cf. LayerImportDOM._createImportGetCapPanelHeaderElement),\n * and reset getCapabilities information\n *\n * @private\n */\nLayerImport.prototype._onGetCapPanelClose = function() {\n    this._clearGetCapParams();\n    this._emptyGetCapResultsList();\n};\n\n// ################################################################### //\n// ######################## Submit form ############################## //\n// ################################################################### //\n\n/**\n * this method is called by event 'submit' on 'GPimportForm' tag form\n * (cf. LayerImportDOM._createImportPanelFormElement),\n * and import static layer or call getCap service (according to import type)\n *\n * @private\n */\nLayerImport.prototype._onImportSubmit = function() {\n\n    logger.log(\"import d'une couche de type : \" + this._currentImportType);\n\n    // reinitialisation du contenu d'un import de type\n    // - static (KML ou GPX ou GeoJSON)\n    this.contentStatic = null;\n    // - service (WMS, ...)\n    this.contentService = null;\n\n    if (this._isCurrentImportTypeStatic) {\n        this._importStaticLayer();\n    } else {\n        this._importServiceLayers();\n    }\n};\n\n// ################################################################### //\n// ################## Import KML/GPX/GeoJSON layers ################## //\n// ################################################################### //\n\n/**\n * this method is called by this_onImportSubmit method\n * and import static layer (KML/GPX/GeoJSON) from url or file\n *\n * @private\n */\nLayerImport.prototype._importStaticLayer = function() {\n\n    var layerName;\n    var staticImportNameInput = document.getElementById(this._addUID(\"GPimportName\"));\n    if (staticImportNameInput) {\n        layerName = staticImportNameInput.value;\n        logger.log(\"import layer name : \" + layerName);\n    }\n\n    if (this._currentStaticImportType === \"local\") {\n        logger.log(\"import static layer from local file\");\n        this._importStaticLayerFromLocalFile(layerName);\n\n    } else if (this._currentStaticImportType === \"url\") {\n        logger.log(\"import static layer from url\");\n        this._importStaticLayerFromUrl(layerName);\n    }\n\n};\n\n/**\n * this method is called by _importStaticLayer method\n * and import static layer (KML/GPX/GeoJSON) from url\n *\n * @param {String} layerName - imported layer name\n * @private\n */\nLayerImport.prototype._importStaticLayerFromUrl = function(layerName) {\n    layerName = layerName || \"\";\n\n    // 1. Rcupration de l'url\n    var url = this._staticUrlImportInput.value;\n    logger.log(\"url : \", url);\n    if (url.length === 0) {\n        console.log(\"[ol.control.LayerImport] url parameter is mandatory\");\n        return;\n    }\n    // on supprime les ventuels espaces avant ou aprs\n    if (url.trim) {\n        url = url.trim();\n    }\n\n    // 2. rcupration proxy\n    if (!this.options.webServicesOptions || (!this.options.webServicesOptions.proxyUrl && !this.options.webServicesOptions.noProxyDomains)) {\n        console.log(\"[ol.control.LayerImport] options.webServicesOptions.proxyUrl parameter is mandatory to request resources on another domain (cross-domain)\");\n        return;\n    };\n    url = ProxyUtils.proxifyUrl(url, this.options.webServicesOptions);\n\n    // FIXME pb de surcharge en mode UMD !? a ne marche pas...\n    // this._hideWaitingContainer();\n    // this._addFeaturesFromImportStaticLayerUrl(url, layerName);\n\n    var context = this;\n    Gp.Protocols.XHR.call({\n        url: url,\n        method: \"GET\",\n        timeOut: 15000,\n        /** on success callback : display results in container */\n        onResponse: function(response) {\n\n            context._hideWaitingContainer();\n            context._addFeaturesFromImportStaticLayer(response, layerName);\n\n        },\n        /** on error callback : log error */\n        onFailure: function(error) {\n            // en cas d'erreur, on revient au panel initial et on cache la patience\n            context._hideWaitingContainer();\n            console.log(\"[ol.control.LayerImport] KML/GPX/GeoJSON request failed : \", error);\n        }\n    });\n};\n\n/**\n * this method is called by _importStaticLayer method\n * and import static layer (KML/GPX/GeoJSON) from local file\n *\n * @param {String} layerName - imported layer name\n * @private\n */\nLayerImport.prototype._importStaticLayerFromLocalFile = function(layerName) {\n    var file = this._staticLocalImportInput.files[0];\n    if (!file) {\n        console.log(\"[ol.control.LayerImport] missing file\");\n        return;\n    }\n\n    // Cration d'un objet FileReader qui permet de lire le contenu du fichier charg\n    var fReader = new FileReader();\n\n    // Dfinition des fonctions de callbacks associes au reader,\n    // notamment la fonction onload qui affichera les entits charges  la carte\n    var context = this;\n    /** on readAsText error */\n    fReader.onerror = function(e) {\n        // en cas d'erreur, on revient au panel initial et on cache la patience\n        context._hideWaitingContainer();\n        logger.log(\"error fileReader : \", e);\n    };\n    /** on readAsText progress */\n    fReader.onprogress = function() {\n        logger.log(\"onprogress\");\n    };\n    /** on load start */\n    fReader.onloadstart = function() {\n        // affichage d'une patience le temps du chargement\n        context._displayWaitingContainer();\n        logger.log(\"onloadstart\");\n    };\n    /** on readAsText abort */\n    fReader.onabort = function() {\n        // en cas d'erreur, on revient au panel initial et on cache la patience\n        context._hideWaitingContainer();\n        logger.log(\"onabort\");\n    };\n    /** on readAsText loadend */\n    fReader.onloadend = function(e) {\n        // fReader = null ?\n        // en cas d'erreur, on revient au panel initial et on cache la patience\n        // context._hideWaitingContainer();\n        // TODO : replier le formulaire ?\n        logger.log(\"onloadend : \", e);\n    };\n    /** on readAsText load */\n    fReader.onload = function(e) {\n        logger.log(\"fileReader onload - file content : \", e.target.result);\n\n        // on cache la patience\n        context._hideWaitingContainer();\n        context._addFeaturesFromImportStaticLayer(e.target.result, layerName);\n    };\n\n    // Lecture du fichier charg  l'aide de fileReader\n    fReader.readAsText(file);\n};\n\n/**\n * this method is called by _importStaticLayerFom* method\n * and add features to the map\n *\n * @param {String} fileContent - content file\n * @param {String} layerName - imported layer name\n * @private\n */\nLayerImport.prototype._addFeaturesFromImportStaticLayer = function(fileContent, layerName) {\n\n    // rcupration du contenu du fichier\n    var map = this.getMap();\n    if (!map || !fileContent) {\n        return;\n    }\n\n    // sauvegarde du content KML/GPX/GeoJSON\n    this.contentStatic = fileContent;\n\n    var format;\n    var vectorStyle;\n    if (this._currentImportType === \"KML\") {\n        // lecture du fichier KML : cration d'un format ol.format.KML, qui possde une mthode readFeatures (et readProjection)\n        format = new KMLExtended({\n            showPointNames: this.options.vectorStyleOptions.KML.showPointNames,\n            extractStyles: this.options.vectorStyleOptions.KML.extractStyles,\n            defaultStyle: [\n                this.options.vectorStyleOptions.KML.defaultStyle\n            ]\n        });\n        vectorStyle = this.options.vectorStyleOptions.KML.defaultStyle;\n    } else if (this._currentImportType === \"GPX\") {\n        // lecture du fichier GPX : cration d'un format ol.format.GPX, qui possde une mthode readFeatures (et readProjection)\n        format = new ol.format.GPX();\n        vectorStyle = this.options.vectorStyleOptions.GPX.defaultStyle;\n    } else if (this._currentImportType === \"GeoJSON\") {\n        // lecture du fichier GeoJSON : cration d'un format ol.format.GeoJSON, qui possde une mthode readFeatures (et readProjection)\n        format = new ol.format.GeoJSON();\n        vectorStyle = this.options.vectorStyleOptions.GeoJSON.defaultStyle;\n    }\n\n    // lecture de la gomtrie des entits  partir du fichier, pour ventuelle reprojection.\n    var fileProj = format.readProjection(fileContent);\n    // rcupration de la projection de la carte pour reprojection des gomtries\n    var mapProj = this._getMapProjectionCode();\n\n    // rcupration des entits avec reprojection ventuelle des gomtries\n    var features = null;\n    features = format.readFeatures(\n        fileContent, {\n            dataProjection: fileProj,\n            featureProjection: mapProj\n        }\n    );\n\n    logger.log(\"loaded features : \", features);\n\n    // cration d'une couche vectorielle  partir de ces features\n    var vectorSource = new ol.source.Vector({\n        features: new ol.Collection()\n    });\n    vectorSource.addFeatures(features);\n\n    logger.trace(vectorSource);\n\n    // ajout des informations pour le layerSwitcher (titre, description)\n    if (layerName) {\n        vectorSource._title = vectorSource._description = layerName;\n    } else {\n        if (format.readName && format.readName(fileContent)) {\n            vectorSource._title = vectorSource._description = format.readName(fileContent);\n        } else {\n            vectorSource._title = vectorSource._description = \"Import \" + this._currentImportType;\n            logger.log(\"[ol.control.LayerImport] set default name \\\"Import \" + this._currentImportType + \"\\\"\");\n        }\n    }\n\n    var vectorLayer = new ol.layer.Vector({\n        source: vectorSource,\n        style: vectorStyle\n    });\n\n    // on rajoute le champ gpResultLayerId permettant d'identifier une couche cre par le composant. (pour layerSwitcher par ex)\n    vectorLayer.gpResultLayerId = \"layerimport:\" + this._currentImportType;\n    map.addLayer(vectorLayer);\n\n    // TODO : appeler fonction commune\n    // zoom sur l'tendue des entits rcupres (si possible)\n    if (map.getView() && map.getSize() && vectorSource.getExtent) {\n        var sourceExtent = vectorSource.getExtent();\n        if (sourceExtent && sourceExtent[0] !== Infinity) {\n            map.getView().fit(vectorSource.getExtent(), map.getSize());\n        }\n    }\n};\n\n/**\n * NOT USE : this method is called by _importStaticLayerFom* method\n * and add features to the map\n *\n * @param {String} url - url\n * @param {String} layerName - imported layer name\n * @private\n */\nLayerImport.prototype._addFeaturesFromImportStaticLayerUrl = function(url, layerName) {\n\n    // rcupration du contenu du fichier\n    var map = this.getMap();\n    if (!map || !url) {\n        return;\n    }\n\n    var format;\n    if (this._currentImportType === \"KML\") {\n        // lecture du fichier KML : cration d'un format ol.format.KML, qui possde une mthode readFeatures (et readProjection)\n        format = new KMLExtended({\n            showPointNames: true, // FIXME option !\n            extractStyles: this.options.vectorStyleOptions.KML.extractStyles,\n            defaultStyle: [\n                this.options.vectorStyleOptions.KML.defaultStyle\n            ]\n        });\n\n    } else if (this._currentImportType === \"GPX\") {\n        // lecture du fichier GPX : cration d'un format ol.format.GPX, qui possde une mthode readFeatures (et readProjection)\n        format = new ol.format.GPX();\n    } else if (this._currentImportType === \"GeoJSON\") {\n        // lecture du fichier GeoJSON : cration d'un format ol.format.GeoJSON, qui possde une mthode readFeatures (et readProjection)\n        format = new ol.format.GeoJSON();\n    }\n\n    // cration d'une couche vectorielle  partir de ces features\n    var vectorSource = new ol.source.Vector({\n        url: url,\n        format: format\n    });\n\n    if (this._currentImportType === \"GPX\") {\n        vectorSource.forEachFeature(\n            function(feature) {\n                // si aucun style n'est associ au feature\n                if (feature.getStyle() == null) {\n                    logger.log(\"[ol.control.LayerImport] set default style for GPX feature\");\n                    feature.setStyle(\n                        this.options.vectorStyleOptions.GPX.defaultStyle\n                    );\n                }\n            }\n        );\n    }\n    if (this._currentImportType === \"GeoJSON\") {\n        vectorSource.forEachFeature(\n            function(feature) {\n                // si aucun style n'est associ au feature\n                if (feature.getStyle() == null) {\n                    logger.log(\"[ol.control.LayerImport] set default style for GeoJSON feature\");\n                    feature.setStyle(\n                        this.options.vectorStyleOptions.GeoJSON.defaultStyle\n                    );\n                }\n            }\n        );\n    }\n\n    // ajout des informations pour le layerSwitcher (titre, description)\n    if (layerName) {\n        vectorSource._title = vectorSource._description = layerName;\n    } else {\n        vectorSource._title = vectorSource._description = \"Import \" + this._currentImportType;\n    }\n\n    var vectorLayer = new ol.layer.Vector({\n        source: vectorSource\n    });\n\n    // on rajoute le champ gpResultLayerId permettant d'identifier une couche cre par le composant. (pour layerSwitcher par ex)\n    vectorLayer.gpResultLayerId = \"layerimport:\" + this._currentImportType;\n    map.addLayer(vectorLayer);\n\n    // TODO : appeler fonction commune\n    // zoom sur l'tendue des entits rcupres (si possible)\n    if (map.getView() && map.getSize() && vectorSource.getExtent) {\n        var sourceExtent = vectorSource.getExtent();\n        if (sourceExtent && sourceExtent[0] !== Infinity) {\n            map.getView().fit(vectorSource.getExtent(), map.getSize());\n        }\n    }\n};\n\n// ################################################################### //\n// #################### Import WMS/WMTS layers ####################### //\n// ################################################################### //\n\n/**\n * this method is called by this_onImportSubmit method\n * and call getCap service from specified url, then display layers list in new panel\n *\n * @private\n */\nLayerImport.prototype._importServiceLayers = function() {\n\n    if (this._currentImportType === \"WFS\") {\n        console.log(\"[ol.control.LayerImport] WFS layer import is not implemented yet\");\n        return;\n    }\n\n    // 0. on vide d'ventuels rsultats prcdents dans le panel GetCapResults\n    this._emptyGetCapResultsList();\n\n    // 1. rcupration de l'url renseigne\n    var url = this._getCapRequestUrl = this._serviceUrlImportInput.value;\n    if (!url) {\n        console.log(\"[ol.control.LayerImport] url parameter is mandatory\");\n        return;\n    }\n    logger.log(\"url : \", url);\n\n    // on supprime les ventuels espaces avant ou aprs\n    if (url.trim) {\n        url = url.trim();\n    }\n    // Info : on ajoute des paramtres uniquement si l'utilisateur n'en a pas dj saisi (on vrifie la position du caractre \"?\")\n    var questionMarkIndex = url.indexOf(\"?\");\n    if (questionMarkIndex < 0) {\n        // dans le cas d'une url du type http://wxs.ign.fr/geoportail/wmts\n        url += \"?SERVICE=\" + this._currentImportType + \"&REQUEST=GetCapabilities\";\n    } else if (questionMarkIndex === (url.length - 1)) {\n        // dans le cas o l'url se termine par \"?\"\n        url += \"SERVICE=\" + this._currentImportType + \"&REQUEST=GetCapabilities\";\n    }\n    // si on n'est pas dans ces deux cas : l'utilisateur a dj saisit des paramtres aprs \"?\" => on ne fait rien.\n\n    // 2. rcupration proxy\n    if (!this.options.webServicesOptions || (!this.options.webServicesOptions.proxyUrl && !this.options.webServicesOptions.noProxyDomains)) {\n        console.log(\"[ol.control.LayerImport] options.webServicesOptions.proxyUrl parameter is mandatory to request web service layers (getcapabilities request)\");\n        return;\n    };\n    var proxyUrl = this.options.webServicesOptions.proxyUrl;\n    var noProxyDomains = this.options.webServicesOptions.noProxyDomains;\n    // on regarde si l'url nest pas dans les domaines sans proxy\n    var bfound = false;\n    if (noProxyDomains && Array.isArray(noProxyDomains) && noProxyDomains.length > 0) {\n        for (var i in noProxyDomains) {\n            logger.log(\"analyzing \" + noProxyDomains[i]);\n            if (url.indexOf(noProxyDomains[i]) !== -1) {\n                logger.log(url + \" found in noProxyDomains list (\" + noProxyDomains[i] + \").\");\n                bfound = true;\n            }\n        }\n    }\n    // si on n'est pas dans un domaine sans proxy, on ajoute le proxy (+ encodage)\n    if (bfound === false) {\n        url = proxyUrl + encodeURIComponent(url);\n    }\n\n    // 3. affichage d'une patience le temps de la requte\n    this._displayWaitingContainer();\n\n    // 4. send getcapabilities request (XHR protocol => proxy Url is needed)\n    var context = this;\n    Gp.Protocols.XHR.call({\n        url: url,\n        method: \"GET\",\n        timeOut: 15000,\n        /** on success callback : display results in container */\n        onResponse: function(response) {\n            context._hideWaitingContainer();\n            context._displayGetCapResponseLayers.call(context, response);\n        },\n        /** on error callback : log error */\n        onFailure: function(error) {\n            // en cas d'erreur, on revient au panel initial et on cache la patience\n            context._hideWaitingContainer();\n            console.log(\"[ol.control.LayerImport] getCapabilities request failed : \", error);\n        }\n    });\n};\n\n/**\n * this method is called by this._importServiceLayers method\n * and display layers list from getcapabilities response\n *\n * @param {Object} xmlResponse - getCapabilities response (xml format)\n * @private\n */\nLayerImport.prototype._displayGetCapResponseLayers = function(xmlResponse) {\n\n    var parser;\n    var layers;\n    var layerDescription;\n    var projection;\n    this._getCapResponseWMSLayers = [];\n\n    // sauvegarde du content d'un GetCapabilities\n    this.contentService = xmlResponse;\n\n    // Affichage du panel des couches accessibles\n    this._importPanel.style.display = \"none\";\n    this._getCapPanel.style.display = \"block\";\n\n    // Parse GetCapabilities Response\n    if (this._currentImportType === \"WMS\") {\n\n        parser = new ol.format.WMSCapabilities();\n        if (!parser) {\n            return;\n        }\n        var getCapResponseWMS = this._getCapResponseWMS = parser.read(xmlResponse);\n        logger.log(\"getCapabilities response : \", getCapResponseWMS);\n\n        if (getCapResponseWMS && getCapResponseWMS.Capability && getCapResponseWMS.Capability.Layer) {\n            // info: le parser OL3 rcupre la premire layer de <Capability> comme un unique objet (il crase les prcdents s'il y a pls <Layer>  la racine de <Capability>)\n            // /!\\ tre vigilant si le parser est modifi (notamment pour rcuprer les diffrentes layers  la racine. ex  http://geoservices.brgm.fr/geologie?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetCapabilities)\n\n            var getCapLayer = getCapResponseWMS.Capability.Layer;\n            // on va lire le contenu de la (ou les) <Layer> pour l'afficher ou en afficher les couches disponibles\n            if (Array.isArray(getCapLayer)) {\n                // cas o on a plusieurs <Layer>  la racine, mais non gr encore par ol.format.WMSCapabilities jusqu' la v3.18.2.\n                for (var i = 0; i < getCapLayer.length; i++) {\n                    this._displayGetCapResponseWMSLayer(getCapLayer[i]);\n                }\n            } else {\n                // cas du parser ol.format.WMSCapabilities jusqu' la v3.18.2.\n                this._displayGetCapResponseWMSLayer(getCapLayer);\n            }\n        }\n\n    } else if (this._currentImportType === \"WMTS\") {\n\n        parser = new ol.format.WMTSCapabilities();\n        if (!parser) {\n            return;\n        }\n        var getCapResponseWMTS = this._getCapResponseWMTS = parser.read(xmlResponse);\n        logger.log(\"getCapabilities response : \", getCapResponseWMTS);\n\n        if (getCapResponseWMTS && getCapResponseWMTS.Contents && getCapResponseWMTS.Contents.Layer) {\n            layers = getCapResponseWMTS.Contents.Layer;\n\n            if (Array.isArray(layers)) {\n                // on stocke la liste des couches pour faire le lien avec le DOM\n                this._getCapResponseWMTSLayers = layers;\n\n                for (var j = 0; j < layers.length; j++) {\n                    // on vrifie que la projection de la couche WMTS est compatible avec celle de la carte\n                    // (ie elle doit tre connue par ol.proj)\n                    projection = this._getWMTSLayerProjection(layers[j], getCapResponseWMTS);\n                    if (projection && typeof projection === \"string\") {\n                        if (ol.proj.get(projection) || ol.proj.get(projection.toUpperCase())) {\n                            // si la projection de la couche est connue par ol.proj,\n                            // on ajoute chaque couche de la rponse dans la liste des couches accessibles\n                            layerDescription = layers[j].Title;\n                            if (this._getCapResultsListContainer) {\n                                this._getCapResultsListContainer.appendChild(this._createImportGetCapResultElement(layerDescription, j));\n                            }\n                        } else {\n                            // si la projection de la couche n'est pas connue par ol.proj,\n                            // on n'affiche pas la couche dans le panel des rsultats\n                            console.log(\"[ol.control.LayerImport] wmts layer cannot be added to map : unknown projection\", layers[j]);\n                            continue;\n                        }\n                    }\n                }\n            }\n        }\n    }\n};\n\n/**\n * this method is called by this._displayGetCapResponseLayers method\n * and display WMS layer in list from getcapabilities response\n *\n * @param {Object} layerObj - object corresponding to <Layer> content in WMS GetCapabilities response\n * @param {Object} [parentLayersInfos] - object corresponding to parents <Layer> content in WMS GetCapabilities response (without children <Layer> infos)\n * @private\n */\nLayerImport.prototype._displayGetCapResponseWMSLayer = function(layerObj, parentLayersInfos) {\n    if (!layerObj) {\n        console.log(\"[ol.control.LayerImport] _displayGetCapResponseWMSLayer : getCapabilities layer object not found\");\n    } else {\n        logger.log(\"[ol.control.LayerImport] _displayGetCapResponseWMSLayer - layerObj : \", layerObj);\n    }\n\n    // rcupration de la projection de la map (pour vrifier que l'on peut reprojeter les couches disponibles)\n    var mapProjCode = this._getMapProjectionCode();\n    var projection;\n    var layerDescription;\n\n    // 1. hritage ventuels des informations de la couche parent\n    if (parentLayersInfos) {\n        var key;\n        var i;\n\n        // proprits hrites  ajouter aux proprits parent\n        var addKeys = [\n            \"CRS\",\n            \"Style\"\n            // \"AuthorityURL\" // TODO\n        ];\n        for (i = 0; i < addKeys.length; i++) {\n            key = addKeys[i];\n            if (Array.isArray(parentLayersInfos[key]) && parentLayersInfos[key].length !== 0) {\n                if (Array.isArray(layerObj[key]) && layerObj[key].length !== 0) {\n                    // on ajoute celles de la couche parent\n                    for (var n = 0; n < parentLayersInfos[key]; n++) {\n                        if (layerObj[key].indexOf(parentLayersInfos[key][n]) === -1) {\n                            // si le CRS/Style parent n'est pas dans les CRS/Style de la couche, on l'ajoute\n                            layerObj[key].push(parentLayersInfos[key][n]);\n                        }\n                    }\n                } else {\n                    // si la couche n'a pas de CRS ou Style, on rcupre ceux de la couche parent\n                    layerObj[key] = parentLayersInfos[key];\n                }\n            }\n        }\n\n        // proprits qui remplacent les valeurs des proprits hrites,\n        // cd on rcupre la proprit parent seulement si elle n'est pas dfinie pour l'lment enfant\n        var replaceKeys = [\n            \"BoundingBox\",\n            \"EX_GeographicBoundingBox\",\n            \"MaxScaleDenominator\",\n            \"MinScaleDenominator\",\n            \"Attribution\",\n            \"Dimension\",\n            \"queryable\",\n            \"cascaded\",\n            \"opaque\",\n            \"noSubsets\",\n            \"fixedWidth\",\n            \"fixedHeight\"\n        ];\n        for (i = 0; i < replaceKeys.length; i++) {\n            key = replaceKeys[i];\n            if (parentLayersInfos[key] && !layerObj[key]) {\n                layerObj[key] = parentLayersInfos[key];\n            }\n        }\n        // on affiche l'arborescence dans le titre de la couche (sauf si on est au premier niveau ?)\n        if (!parentLayersInfos._isRootLayer && parentLayersInfos.Title) {\n            layerObj.Title = parentLayersInfos.Title + \" > \" + layerObj.Title;\n        }\n\n    } else {\n        // si on n'a pas d'infos de couche parent, on est  la racine du Capability, on le note\n        layerObj._isRootLayer = true;\n    }\n\n    // 2. si on a d'autres couches <Layer> imbriques, on descend d'un niveau, sinon on affiche la couche dans la liste des rsultats\n    if (layerObj.Layer) {\n        if (Array.isArray(layerObj.Layer)) {\n            for (var j = 0; j < layerObj.Layer.length; j++) {\n                // on recommence pour chaque sous couche, avec les infos ventuellement hrites\n                this._displayGetCapResponseWMSLayer(layerObj.Layer[j], layerObj);\n            }\n        }\n    } else {\n\n        // on rcupre la longueur de la liste des couches dj rcupres, pour avoir ce qui sera l'index de la couche  ajouter.\n        var lastIndex = this._getCapResponseWMSLayers.length;\n\n        // on vrifie que la couche ait une projection compatible avec celle de la carte\n        // ou soit connue par proj4js, et on stocke cette projection dans les infos de la couche.\n        projection = this._getWMSLayerProjection(layerObj, mapProjCode);\n\n        if (!projection) {\n            // si aucune projection n'est compatible avec celle de la carte ou connue par ol.proj,\n            // on n'affiche pas la couche dans le panel des rsultats\n            console.log(\"[ol.control.LayerImport] wms layer cannot be added to map : unknown projection\", layerObj);\n\n        } else {\n            // si on a une projection compatible : on la stocke et la couche sera ventuellement reprojete  l'ajout\n            layerObj._projection = projection;\n            // on ajoute chaque couche de la rponse dans la liste des couches accessibles\n            layerDescription = layerObj.Title;\n            if (this._getCapResultsListContainer) {\n                this._getCapResultsListContainer.appendChild(this._createImportGetCapResultElement(layerDescription, lastIndex));\n            }\n            // puis on stoke la couche dans la liste pour faire le lien avec le DOM\n            this._getCapResponseWMSLayers[lastIndex] = layerObj;\n        }\n    }\n};\n\n/**\n * this method is called on 'GPimportGetCapProposal' div click\n * and add corresponding layer to map\n *\n * @param {Object} e - HTMLElement\n * @private\n */\nLayerImport.prototype._onGetCapResponseLayerClick = function(e) {\n    if (e.target && e.target.id) {\n        var proposalId = parseInt(e.target.id.substr(23), 10);\n\n        if (proposalId == null) {\n            return;\n        }\n\n        var layerInfo;\n\n        if (this._currentImportType === \"WMS\") {\n            // rcupration des informations lies  la couche\n            layerInfo = this._getCapResponseWMSLayers[proposalId];\n            // ajout de la couche  la carte\n            this._addGetCapWMSLayer(layerInfo);\n\n        } else if (this._currentImportType === \"WMTS\") {\n            // rcupration des informations lies  la couche\n            layerInfo = this._getCapResponseWMTSLayers[proposalId];\n            // ajout de la couche  la carte\n            this._addGetCapWMTSLayer(layerInfo);\n        }\n\n    }\n};\n\n// ################################################################### //\n// ######### create WMS layer from getCapabilities response ######### //\n// ################################################################### //\n\n/**\n * this method is called by this._onGetCapResponseLayerClick\n * and add WMS layer to map using parameters from getCapabilities response\n *\n * @param {Object} layerInfo - layer information from getCapabilities response\n * @private\n */\nLayerImport.prototype._addGetCapWMSLayer = function(layerInfo) {\n    var map = this.getMap();\n    if (!map) {\n        console.log(\"[ol.control.LayerImport] _addGetCapWMSLayer error : map is not defined\");\n        return;\n    }\n    if (!layerInfo) {\n        console.log(\"[ol.control.LayerImport] _addGetCapWMSLayer error : layerInfo is not defined\");\n        return;\n    }\n\n    // rcupration de la projection de la carte\n    var mapProjCode = this._getMapProjectionCode();\n\n    var wmsSourceOptions = {};\n\n    // Rcupration de l'url\n    var getMapUrl = this._getWMSLayerGetMapUrl();\n    // on essaie de rcuprer l'url du service dans le getCapbilities\n    if (getMapUrl) {\n        wmsSourceOptions.url = getMapUrl;\n    } else {\n        // sinon, on rcupre l'url du getCapabilities,  laquelle on enlve ventuellement les paramtres\n        var questionMarkIndex = this._getCapRequestUrl.indexOf(\"?\");\n        if (questionMarkIndex !== -1) {\n            wmsSourceOptions.url = this._getCapRequestUrl.substring(0, questionMarkIndex);\n        } else {\n            wmsSourceOptions.url = this._getCapRequestUrl;\n        }\n    }\n\n    wmsSourceOptions.params = {};\n    if (layerInfo.Name) {\n        wmsSourceOptions.params[\"LAYERS\"] = layerInfo.Name;\n    } else {\n        console.log(\"[ol.control.LayerImport] unable to add wms layer : mandatory layer 'name' parameter cannot be found\", layerInfo);\n        return;\n    }\n    wmsSourceOptions.params[\"SERVICE\"] = \"WMS\";\n    if (this._getCapResponseWMS.version) {\n        wmsSourceOptions.params[\"VERSION\"] = this._getCapResponseWMS.version;\n    }\n\n    // on a dj vrifi que la couche peut tre reprojete,\n    // on vrifie que la couche ait une projection compatible avec celle de la carte\n    // ou soit connue par proj4js\n    var projection = layerInfo._projection;\n    if (!projection) {\n        console.log(\"[ol.control.LayerImport] wms layer cannot be added to map : unknown projection\");\n        return;\n    } else if (projection !== mapProjCode) {\n        // si la projection de la carte n'est pas disponible pour cette couche,\n        // on spcifie une projection (qui doit avoir t dfinie dans proj4js) pour reprojection par OL3\n        wmsSourceOptions.projection = projection;\n    }\n\n    // rcupration du premier style disponible (pas d'info default?)\n    var legend;\n    if (layerInfo.Style && Array.isArray(layerInfo.Style)) {\n        var style = layerInfo.Style[0];\n        wmsSourceOptions.params[\"STYLES\"] = style.Name;\n        if (style.LegendURL && Array.isArray(style.LegendURL) && style.LegendURL.length !== 0) {\n            legend = style.LegendURL[0].OnlineResource;\n        }\n    }\n\n    // Cration de la source (tester un try catch ?)\n    var wmsSource = new ol.source.TileWMS(wmsSourceOptions);\n    // ajout des informations pour le layerSwitcher (titre, description, legendes, metadata) ou originators\n    this._getWMSLayerInfoForLayerSwitcher(layerInfo, legend, wmsSource);\n\n    var layerTileOptions = {};\n    layerTileOptions[\"source\"] = wmsSource;\n    // rcupration des rsolutions min et max de la layer  partir des dnominateurs d'chelle\n    this._getWMSLayerMinMaxResolution(layerInfo, mapProjCode, layerTileOptions);\n    // rcupration de l'tendue (bbox)\n    this._getWMSLayerExtent(layerInfo, mapProjCode, layerTileOptions);\n\n    // cration de la couche  partir de la source\n    var wmsLayer = new ol.layer.Tile(layerTileOptions);\n    // on rajoute le champ gpResultLayerId permettant d'identifier une couche cre par le composant. (pour layerSwitcher par ex)\n    wmsLayer.gpResultLayerId = \"layerimport:WMS\";\n    // on rajoute le champ gpGFIparams permettant d'identifier si la couche est queryable, et de transmettre les formats reconnus par GetFeatureInfo\n    if (layerInfo.queryable) {\n        wmsLayer.gpGFIparams = {\n            queryable: true\n        };\n        // rcupration des diffrents formats reconnus par le GetFeatureInfo\n        if (this._getCapResponseWMS && this._getCapResponseWMS.Capability && this._getCapResponseWMS.Capability.Request && this._getCapResponseWMS.Capability.Request.GetFeatureInfo && this._getCapResponseWMS.Capability.Request.GetFeatureInfo.Format && Array.isArray(this._getCapResponseWMS.Capability.Request.GetFeatureInfo.Format)) {\n            wmsLayer.gpGFIparams.formats = this._getCapResponseWMS.Capability.Request.GetFeatureInfo.Format;\n        }\n    }\n\n    map.addLayer(wmsLayer);\n};\n\n/**\n * this method is called by this._addGetCapWMSLayer\n * and gets service getMap request url\n *\n * @return {String} getmapurl - service getMap request url\n * @private\n */\nLayerImport.prototype._getWMSLayerGetMapUrl = function() {\n    var getmapurl;\n    if (this._getCapResponseWMS && this._getCapResponseWMS.Capability && this._getCapResponseWMS.Capability.Request && this._getCapResponseWMS.Capability.Request.GetMap) {\n        var getmap = this._getCapResponseWMS.Capability.Request.GetMap;\n        if (getmap.DCPType && Array.isArray(getmap.DCPType) && getmap.DCPType.length !== 0) {\n            var url = getmap.DCPType[0];\n            if (url && url.HTTP && url.HTTP.Get) {\n                getmapurl = url.HTTP.Get.OnlineResource;\n            }\n        }\n    }\n    return getmapurl;\n};\n\n/**\n * this method is called by this._addGetCapWMSLayer\n * and gets a projection both available for a given layer and already defined in proj4js (ol.proj)\n * (ol3 raster reprojection will be then able to reproject layer in map projection)\n *\n * @param {Object} layerInfo - layer information from getCapabilities response\n * @param {String} mapProjCode - map projection code (e.g. \"EPSG:4326\")\n * @return {String} projection - ol.proj projection alias (e.g. \"EPSG:4326\")\n * @private\n */\nLayerImport.prototype._getWMSLayerProjection = function(layerInfo, mapProjCode) {\n    var projection;\n\n    if (!layerInfo || typeof layerInfo !== \"object\") {\n        logger.log(\"missing layer information (from getCapabilities)\");\n        return;\n    }\n\n    // on va parcourir la liste des CRS disponibles pour la couche\n    // si on trouve la projection de la carte : c'est parfait\n    // si on trouve une projection qui est connue par ol.proj : OL3 gre la reprojection\n    var CRSList = layerInfo.CRS;\n    if (Array.isArray(CRSList)) {\n        for (var i = 0; i < CRSList.length; i++) {\n            var layerCRS = CRSList[i];\n            if (layerCRS === mapProjCode) {\n                projection = layerCRS;\n                break;\n            } else {\n                if (layerCRS && typeof layerCRS === \"string\") {\n                    if (ol.proj.get(layerCRS) || ol.proj.get(layerCRS.toUpperCase())) {\n                        projection = layerCRS;\n                        break;\n                    }\n                }\n            }\n        }\n    }\n    return projection;\n};\n\n/**\n * this method is called by this._addGetCapWMSLayer\n * and sets minResolution and maxResolution parameters for WMS layer (if available in getCapabilities response)\n *\n * @param {Object} layerInfo - layer information from getCapabilities response\n * @param {String} mapProjCode - map projection code (e.g. \"EPSG:4326\")\n * @param {Object} layerTileOptions - options for ol.layer.Tile (to be filled)\n * @private\n */\nLayerImport.prototype._getWMSLayerMinMaxResolution = function(layerInfo, mapProjCode, layerTileOptions) {\n    // rcupration des rsolutions min et max  partir des dnominateurs d'chelle\n    var mapUnits = ol.proj.get(mapProjCode).getUnits();\n    if (mapUnits === \"m\") {\n        // info : 1 pixel = 0.00028 m\n        if (layerInfo.MinScaleDenominator) {\n            layerTileOptions.minResolution = layerInfo.MinScaleDenominator * 0.00028;\n        }\n        if (layerInfo.MaxScaleDenominator) {\n            layerTileOptions.maxResolution = layerInfo.MaxScaleDenominator * 0.00028;\n        }\n    } else if (mapUnits === \"degrees\") {\n        // info : 6378137 * 2 * pi / 360 = rayon de la terre (ellipsoide WGS84)\n        var cste = 0.00028 * 180 / (Math.PI * 6378137);\n        if (layerInfo.MinScaleDenominator) {\n            layerTileOptions.minResolution = layerInfo.MinScaleDenominator * cste;\n        }\n        if (layerInfo.MaxScaleDenominator) {\n            layerTileOptions.maxResolution = layerInfo.MaxScaleDenominator * cste;\n        }\n    }\n};\n\n/**\n * this method is called by this._addGetCapWMSLayer\n * and sets extent for WMS layer in map projection (if available in getCapabilities response)\n *\n * @param {Object} layerInfo - layer information from getCapabilities response\n * @param {String} mapProjCode - map projection code (e.g. \"EPSG:4326\")\n * @param {Object} layerTileOptions - options for ol.layer.Tile (to be filled)\n * @private\n */\nLayerImport.prototype._getWMSLayerExtent = function(layerInfo, mapProjCode, layerTileOptions) {\n    if (!layerInfo) {\n        console.log(\"[ol.control.LayerImport] _getWMSLayerExtent error : layerInfo is not defined\");\n        return;\n    }\n\n    // rcupration des 2 proprits qui peuvent spcifier l'tendue (bbox) selon les specs OGC WMS 1.3.0 :\n    // 1. layerInfo.EX_GeographicBoundingBox est un tableau de type [westBoundLongitude, southBoundLatitude, eastBoundLongitude, northBoundLatitude] en WGS84\n    var exGeographicBoundingBox = layerInfo[\"EX_GeographicBoundingBox\"];\n    // 2. layerInfo.BoundingBox est un tableau dont chaque lment est un objet (balise bbox) avec les proprits suivantes :\n    // crs (String) et extent (tableau de type [minx, miny, maxx, maxy])\n    var boundingBox = layerInfo.BoundingBox;\n\n    if (exGeographicBoundingBox && Array.isArray(exGeographicBoundingBox)) {\n        if (mapProjCode === \"EPSG:4326\") {\n            // si la projection de la carte est la mme que celle de l'extent (EPSG:4326), on la passe telle quelle\n            layerTileOptions.extent = exGeographicBoundingBox;\n        } else {\n            layerTileOptions.extent = ol.proj.transformExtent(exGeographicBoundingBox, \"EPSG:4326\", mapProjCode);\n        }\n\n        // si jamais EX_GeographicBoundingBox n'est pas ou est mal renseign, on essaie de rcuprer via le paramtre BoundingBox\n    } else if (boundingBox && Array.isArray(boundingBox)) {\n        var crs;\n        var extent;\n        for (var i = 0; i < boundingBox.length; i++) { // on peut avoir plusieurs BoundingBox\n            crs = boundingBox[i].crs;\n            extent = boundingBox[i].extent;\n            if (crs) {\n                if (crs === mapProjCode) {\n                    // si la bbox est dans la projection de la carte, on la passe telle quelle\n                    layerTileOptions.extent = extent;\n                    break;\n                } else {\n                    if (crs && typeof crs === \"string\") {\n                        var olProj = ol.proj.get(crs) ? ol.proj.get(crs) : ol.proj.get(crs.toUpperCase());\n                        // if ( ol.proj.get(crs) || ol.proj.get(crs.toUpperCase()) ) {\n                        if (olProj) {\n                            // si la bbox est dans une projection connue, on va la reprojeter\n                            // tout d'abord, on gre le cas des systmes EPSG gographiques : inversion des axes x et y\n                            if (olProj.getUnits() === \"degrees\" && crs.toUpperCase().indexOf(\"EPSG\") === 0) {\n                                // le tableau extent est invers, on a besoin de : [miny, minx, maxx, maxy]\n                                var reversedExtent = [extent[1], extent[0], extent[3], extent[2]];\n                                layerTileOptions.extent = ol.proj.transformExtent(reversedExtent, olProj, mapProjCode);\n                            } else {\n                                // reprojection dans la projection de la carte\n                                layerTileOptions.extent = ol.proj.transformExtent(extent, olProj, mapProjCode);\n                            }\n                            break;\n                        }\n                    }\n                }\n            }\n        }\n    }\n};\n\n/**\n * this method is called by this._addGetCapWMSLayer\n * and sets more information about layer (legends, title, description, metadata, originators) for layerSwitcher or attributions controls\n *\n * @param {Object} layerInfo - layer information from getCapabilities response\n * @param {String} legend - legend url\n * @param {Object} wmsSource - options for ol.source.TileWMS (to be filled)\n * @private\n */\nLayerImport.prototype._getWMSLayerInfoForLayerSwitcher = function(layerInfo, legend, wmsSource) {\n    // ajout des informations pour le layerSwitcher (titre, description)\n    if (layerInfo.Title) {\n        wmsSource._title = layerInfo.Title;\n        wmsSource._description = layerInfo.Abstract ? layerInfo.Abstract : layerInfo.Title;\n    } else {\n        wmsSource._title = layerInfo.Name;\n        wmsSource._description = layerInfo.Abstract ? layerInfo.Abstract : layerInfo.Name;\n    }\n    // ajout de lgende si on en a trouv\n    if (legend) {\n        wmsSource._legends = [{\n            url: legend\n        }];\n    }\n    // ajout d'ventuelles mtadonnes\n    if (layerInfo.MetadataURL && Array.isArray(layerInfo.MetadataURL)) {\n        wmsSource._metadata = [];\n        for (var i = 0; i < layerInfo.MetadataURL.length; i++) {\n            var metadata = layerInfo.MetadataURL[i].OnlineResource;\n            if (metadata) {\n                wmsSource._metadata.push({\n                    url: metadata\n                });\n            }\n        }\n    }\n    // ajout d'ventuelles attributions / originators\n    if (layerInfo.Attribution) {\n        var attribution = layerInfo.Attribution;\n        wmsSource._originators = {};\n        if (attribution.OnlineResource) {\n            wmsSource._originators.url = attribution.OnlineResource;\n        }\n        if (attribution.Title) {\n            wmsSource._originators.name = wmsSource._originators.attribution = attribution.Title;\n        }\n        if (attribution.LogoURL && attribution.LogoURL.OnlineResource) {\n            wmsSource._originators.logo = attribution.LogoURL.OnlineResource;\n        }\n    }\n};\n\n// ################################################################### //\n// ######### create WMTS layer from getCapabilities response ######### //\n// ################################################################### //\n\n/**\n * this method is called by this._onGetCapResponseLayerClick\n * and add WMTS layer to map using parameters from getCapabilities response\n *\n * @param {Object} layerInfo - layer information from getCapabilities response\n * @private\n */\nLayerImport.prototype._addGetCapWMTSLayer = function(layerInfo) {\n\n    if (!layerInfo || !layerInfo.Identifier) {\n        console.log(\"[ol.control.LayerImport] layer information not found in getCapabilities response for layer \");\n        return;\n    }\n\n    var map = this.getMap();\n    if (!map) {\n        return;\n    }\n\n    var wmtsSourceOptions = {};\n    wmtsSourceOptions.layer = layerInfo.Identifier;\n    // service version\n    if (this._getCapResponseWMTS.version) {\n        wmtsSourceOptions.version = this._getCapResponseWMTS.version;\n    }\n    // Rcupration de l'url\n    var getMapUrl = this._getWMTSLayerGetTileUrl();\n    // on essaie de rcuprer l'url du service dans le getCapbilities\n    if (getMapUrl) {\n        wmtsSourceOptions.url = getMapUrl;\n    } else {\n        // sinon, on rcupre l'url du getCapabilities,  laquelle on enlve ventuellement les paramtres\n        var questionMarkIndex = this._getCapRequestUrl.indexOf(\"?\");\n        if (questionMarkIndex !== -1) {\n            wmtsSourceOptions.url = this._getCapRequestUrl.substring(0, questionMarkIndex);\n        } else {\n            wmtsSourceOptions.url = this._getCapRequestUrl;\n        }\n    }\n\n    // Rcupration des informations de la pyramide (tileGrid information) : matrixIds, resolutions, origin et projection\n    var tmsOptions = this._getTMSParams(layerInfo);\n    wmtsSourceOptions.matrixSet = tmsOptions.tms;\n    wmtsSourceOptions.projection = tmsOptions.projCode;\n    wmtsSourceOptions.tileGrid = new ol.tilegrid.WMTS({\n        resolutions: tmsOptions.resolutions,\n        matrixIds: tmsOptions.matrixIds,\n        origin: tmsOptions.origin\n    });\n\n    // Rcupration du style par dfaut\n    var defaultStyle;\n    var legend;\n    if (layerInfo.Style && Array.isArray(layerInfo.Style)) {\n        var style;\n        for (var s = 0; s < layerInfo.Style.length; s++) {\n            style = layerInfo.Style[s];\n            // on rcupre le style\n            defaultStyle = style.Identifier;\n            if (style.isDefault) {\n                // si c'est celui par dfaut, on le garde (on ne boucle plus sur les autres styles)\n                break;\n            }\n            // et une ventuelle lgende\n            if (style.LegendURL && Array.isArray(style.LegendURL) && style.LegendURL.length !== 0) {\n                legend = style.LegendURL[0].href;\n            }\n        }\n    }\n    if (defaultStyle == null) {\n        console.log(\"[ol.control.LayerImport] style information not found in getCapabilities response for layer \" + layerInfo.Identifier);\n    }\n    wmtsSourceOptions.style = defaultStyle;\n\n    // Rcupration du format (le premier trouv)\n    var format;\n    if (layerInfo.Format && Array.isArray(layerInfo.Format)) {\n        format = layerInfo.Format[0];\n    }\n    if (format == null) {\n        console.log(\"[ol.control.LayerImport] format information not found in getCapabilities response for layer \" + layerInfo.Identifier);\n    }\n    wmtsSourceOptions.format = format;\n\n    // Cration de la source (tester un try catch ?)\n    var wmtsSource = new ol.source.WMTS(wmtsSourceOptions);\n\n    // ajout des informations pour le layerSwitcher (titre, description)\n    if (layerInfo.Title) {\n        wmtsSource._title = layerInfo.Title;\n        wmtsSource._description = layerInfo.Abstract ? layerInfo.Abstract : layerInfo.Title;\n    } else {\n        wmtsSource._title = layerInfo.Identifier;\n        wmtsSource._description = layerInfo.Abstract ? layerInfo.Abstract : layerInfo.Identifier;\n    }\n    // ajout d'une ventuelle lgende\n    if (legend) {\n        wmtsSource._legends = [{\n            url: legend\n        }];\n    }\n\n    var layerTileOptions = {};\n    layerTileOptions.source = wmtsSource;\n    // rcupration de l'tendue (bbox)\n    layerTileOptions.extent = this._getWMTSLayerExtent(layerInfo);\n    var wmtsLayer;\n    try {\n        wmtsLayer = new ol.layer.Tile(layerTileOptions);\n    } catch (e) {\n        console.log(\"[ol.control.LayerImport] an error occured while trying to create ol.layer.Tile from getCapabilities information. error : \", e);\n        return;\n    }\n    // on rajoute le champ gpResultLayerId permettant d'identifier une couche cre par le composant. (pour layerSwitcher par ex)\n    wmtsLayer.gpResultLayerId = \"layerimport:WMTS\";\n\n    map.addLayer(wmtsLayer);\n};\n\n/**\n * this method is called by this._addGetCapWMTSLayer\n * and gets service getTile request url\n *\n * @return {String} gettileurl - service getTile request url\n * @private\n */\nLayerImport.prototype._getWMTSLayerGetTileUrl = function() {\n    var gettileurl;\n    if (this._getCapResponseWMTS && this._getCapResponseWMTS.OperationsMetadata && this._getCapResponseWMTS.OperationsMetadata.GetTile) {\n        var gettile = this._getCapResponseWMTS.OperationsMetadata.GetTile;\n        if (gettile.DCP && gettile.DCP.HTTP && gettile.DCP.HTTP.Get && Array.isArray(gettile.DCP.HTTP.Get) && gettile.DCP.HTTP.Get.length !== 0) {\n            gettileurl = gettile.DCP.HTTP.Get[0].href;\n        }\n    }\n    return gettileurl;\n};\n\n/**\n * this method is called by this._displayGetCapResponseLayers\n * and gets layer TileMatrixSet projection if defined in proj4js\n *\n * @param {Object} layerInfo - layer information from getCapabilities response\n * @param {Object} getCapResponseWMTS - whole getCapabilities response\n * @return {String} projection - ol.proj projection alias (e.g. \"EPSG:4326\")\n * @private\n */\nLayerImport.prototype._getWMTSLayerProjection = function(layerInfo, getCapResponseWMTS) {\n    var projection;\n\n    if (!layerInfo || typeof layerInfo !== \"object\") {\n        logger.log(\"missing layer information (from getCapabilities)\");\n        return;\n    }\n\n    if (!getCapResponseWMTS || typeof getCapResponseWMTS !== \"object\") {\n        logger.log(\"missing getCapabilities response\");\n        return;\n    }\n\n    if (layerInfo.TileMatrixSetLink && Array.isArray(layerInfo.TileMatrixSetLink)) {\n        var tms = layerInfo.TileMatrixSetLink[0].TileMatrixSet;\n        var crs;\n        if (getCapResponseWMTS.Contents && Array.isArray(getCapResponseWMTS.Contents.TileMatrixSet)) {\n            var tileMatrixSets = getCapResponseWMTS.Contents.TileMatrixSet;\n            for (var i = 0; i < tileMatrixSets.length; i++) {\n                if (tileMatrixSets[i].Identifier === tms && tileMatrixSets[i].TileMatrix) {\n                    // on a trouv le TMS correspondant\n                    var tileMatrixSet = tileMatrixSets[i];\n                    crs = tileMatrixSet.SupportedCRS;\n                    if (crs && typeof crs === \"string\") {\n                        if (ol.proj.get(crs) || ol.proj.get(crs.toUpperCase())) {\n                            projection = crs;\n                        }\n                    }\n                    break;\n                }\n            }\n        }\n    };\n\n    return projection;\n};\n\n/**\n * this method is called by this._addGetCapWMTSLayer\n * and get ol.tileGrid.WMTS parameters using getCapabilities response\n *\n * @param {Object} layerInfo - layer information from getCapabilities response\n * @return {Object} tmsOptions - ol.tileGrid.WMTS options\n * @private\n */\nLayerImport.prototype._getTMSParams = function(layerInfo) {\n    var tmsOptions = {};\n\n    var matrixIds = [];\n    var resolutions = [];\n    var origin = [];\n    var tms;\n    var projCode;\n    var projection;\n\n    // TODO : recup TOUS les autres params d'un tileGrid ! (tileSize, width...)\n\n    var map = this.getMap();\n    if (!map) {\n        return;\n    }\n\n    // Rcupration des informations de la pyramide (tileGrid information) : matrixIds, resolutions, origin\n    if (layerInfo.TileMatrixSetLink && Array.isArray(layerInfo.TileMatrixSetLink)) {\n        tms = layerInfo.TileMatrixSetLink[0].TileMatrixSet;\n\n        if (this._getCapResponseWMTS.Contents && Array.isArray(this._getCapResponseWMTS.Contents.TileMatrixSet)) {\n            var tileMatrixSets = this._getCapResponseWMTS.Contents.TileMatrixSet;\n            for (var i = 0; i < tileMatrixSets.length; i++) {\n                if (tileMatrixSets[i].Identifier === tms && tileMatrixSets[i].TileMatrix) {\n                    // on a trouv le TMS correspondant\n                    var tileMatrixSet = tileMatrixSets[i];\n\n                    var tilematrix;\n                    var id;\n                    var scaledenominator;\n                    var resolution;\n                    var units;\n\n                    if (tileMatrixSet.SupportedCRS) {\n                        projCode = tileMatrixSet.SupportedCRS;\n                        projection = ol.proj.get(projCode);\n                    }\n                    if (projection && projection.getUnits) {\n                        units = projection.getUnits();\n                    }\n\n                    if (Array.isArray(tileMatrixSet.TileMatrix)) {\n                        for (var j = 0; j < tileMatrixSet.TileMatrix.length; j++) {\n\n                            // construction du tableau des matrixIds\n                            tilematrix = tileMatrixSet.TileMatrix[j];\n                            if (tilematrix.Identifier != null) {\n                                id = parseInt(tilematrix.Identifier, 10);\n                                matrixIds.push(id);\n                            }\n\n                            // construction du tableau des rsolutions, calcules  partir des dnominateurs d'chelle (scaledenominator)\n                            scaledenominator = tilematrix.ScaleDenominator;\n                            // calcul des rsolutions selon la projection du TMS : selon si on a des coordonnes planes ou gographiques\n                            if (units === \"degrees\") {\n                                // info : 6378137 * 2 * pi / 360 = rayon de la terre (ellipsoide WGS84)\n                                resolution = scaledenominator * 0.00028 * 180 / (Math.PI * 6378137);\n                            } else {\n                                // info : 1 pixel = 0.00028 m\n                                resolution = scaledenominator * 0.00028;\n                            }\n                            resolutions.push(resolution);\n\n                            origin = tilematrix.TopLeftCorner;\n                        }\n                    }\n\n                    // tri des rsolutions par ordre dcroissant\n                    if (Array.isArray(resolutions) && resolutions.sort !== undefined) {\n                        resolutions.sort(\n                            function(x, y) {\n                                return y - x;\n                            }\n                        );\n                    }\n                    // tri des identifiants des niveaux de pyramide (matrixIds) par ordre croissant\n                    if (Array.isArray(matrixIds) && matrixIds.sort !== undefined) {\n                        matrixIds.sort(\n                            function(x, y) {\n                                return x - y;\n                            }\n                        );\n                    }\n                }\n            }\n        } else {\n            console.log(\"[ol.control.LayerImport] TileMatrixSet data not found in getCapabilities response for layer \" + layerInfo.Identifier);\n        }\n\n    } else {\n        return;\n    }\n\n    tmsOptions.tms = tms;\n    tmsOptions.projCode = projCode;\n    tmsOptions.matrixIds = matrixIds;\n    tmsOptions.resolutions = resolutions;\n    tmsOptions.origin = origin;\n\n    return tmsOptions;\n};\n\n/**\n * this method is called by this._addGetCapWMTSLayer\n * and sets extent for WMTS layer in map projection (if available in getCapabilities response)\n *\n * @param {Object} layerInfo - layer information from getCapabilities response\n * @return {Array} extent - layer extent\n * @private\n */\nLayerImport.prototype._getWMTSLayerExtent = function(layerInfo) {\n    var extent;\n    var mapProjCode = this._getMapProjectionCode();\n\n    // rcupration de l'tendue (bbox)\n    if (layerInfo.WGS84BoundingBox && Array.isArray(layerInfo.WGS84BoundingBox)) {\n        extent = ol.proj.transformExtent(layerInfo.WGS84BoundingBox, \"EPSG:4326\", mapProjCode);\n    }\n\n    return extent;\n};\n\n// ################################################################### //\n// ################################ utils ############################ //\n// ################################################################### //\n\n/**\n * gets control map projection code\n *\n * @return {String} mapProjCode - control map projection code (e.g. \"EPSG:3857\")\n * @private\n */\nLayerImport.prototype._getMapProjectionCode = function() {\n    var map = this.getMap();\n    if (!map || !map.getView || !map.getView().getProjection) {\n        logger.log(\"unable to get layerimport's map\");\n        return;\n    }\n    var mapProjCode = map.getView().getProjection().getCode();\n    return mapProjCode;\n};\n\n// ################################################################### //\n// ################################ clean ############################ //\n// ################################################################### //\n\n/**\n * this method displays waiting container and sets a timeout\n *\n * @private\n */\nLayerImport.prototype._displayWaitingContainer = function() {\n\n    this._waitingContainer.className = \"GPimportWaitingContainerVisible\";\n    this._waiting = true;\n\n    // mise en place d'un timeout pour rinitialiser le panel (cacher la patience)\n    // si on est toujours en attente (si la requte est bloque par exemple)\n    if (this._timer) {\n        clearTimeout(this._timer);\n        this._timer = null;\n    }\n    var context = this;\n    this._timer = setTimeout(function() {\n        if (context._waiting === true) {\n            context._hideWaitingContainer();\n        } else {\n            if (context._timer) {\n                clearTimeout(context._timer);\n            }\n        }\n    }, 16000);\n};\n\n/**\n * this method hides waiting container and clears timeout\n *\n * @private\n */\nLayerImport.prototype._hideWaitingContainer = function() {\n    if (this._waiting) {\n        this._waitingContainer.className = \"GPimportWaitingContainerHidden\";\n        this._waiting = false;\n        clearTimeout(this._timer);\n        this._timer = null;\n    }\n};\n\n/**\n * this method clears previous getCap request url or response information\n *\n * @private\n */\nLayerImport.prototype._clearGetCapParams = function() {\n    this._getCapRequestUrl = null;\n    this._getCapResponseWMS = null;\n    this._getCapResponseWMTS = null;\n    this._getCapResponseWMSLayers = null;\n    this._getCapResponseWMTSLayers = null;\n};\n\n/**\n * this method empties getCap results list (DOM element)\n *\n * @private\n */\nLayerImport.prototype._emptyGetCapResultsList = function() {\n    if (this._getCapResultsListContainer) {\n        while (this._getCapResultsListContainer.firstChild) {\n            this._getCapResultsListContainer.removeChild(this._getCapResultsListContainer.firstChild);\n        }\n    }\n};\n\nexport default LayerImport;\n\n\n\n// WEBPACK FOOTER //\n// ./src/OpenLayers/Controls/LayerImport.js","var LayerImportDOM = {\n\n    /** Add uuid to the tag ID */\n    _addUID: function(id) {\n        var uid = (this._uid) ? id + \"-\" + this._uid : id;\n        return uid;\n    },\n\n    /**\n     * Main container (DOM)\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createMainContainerElement: function() {\n\n        var container = document.createElement(\"div\");\n        container.id = this._addUID(\"GPimport\");\n        container.className = \"GPwidget\";\n        return container;\n    },\n\n    // ################################################################### //\n    // ######################### show widget ############################# //\n    // ################################################################### //\n\n    /**\n     * Hidden checkbox for minimizing/maximizing\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createShowImportElement: function() {\n\n        var input = document.createElement(\"input\");\n        input.id = this._addUID(\"GPshowImport\");\n        input.type = \"checkbox\";\n        return input;\n    },\n\n    /**\n     * Show Import\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createShowImportPictoElement: function() {\n\n        // contexte d'execution\n        var self = this;\n\n        var label = document.createElement(\"label\");\n        label.id = this._addUID(\"GPshowImportPicto\");\n        label.className = \"GPshowAdvancedToolPicto\";\n        label.htmlFor = this._addUID(\"GPshowImport\");\n        label.title = \"Ouvrir l'import de couches\";\n\n        // Close all results and panels when minimizing the widget\n        if (label.addEventListener) {\n            label.addEventListener(\"click\", function() {\n                self._onShowImportClick();\n            });\n        } else if (label.attachEvent) {\n            label.attachEvent(\"onclick\", function() {\n                self._onShowImportClick();\n            });\n        }\n\n        var spanOpen = document.createElement(\"span\");\n        spanOpen.id = this._addUID(\"GPshowImportOpen\");\n        spanOpen.className = \"GPshowAdvancedToolOpen\";\n        label.appendChild(spanOpen);\n\n        return label;\n    },\n\n    // ################################################################### //\n    // ######################### Header panel ############################ //\n    // ################################################################### //\n\n    /**\n     * Create Container Panel\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createImportPanelElement: function() {\n        var div = document.createElement(\"div\");\n        div.id = this._addUID(\"GPimportPanel\");\n        div.className = \"GPpanel\";\n\n        return div;\n    },\n\n    /**\n     * Create Header Panel\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createImportPanelHeaderElement: function() {\n        var container = document.createElement(\"div\");\n        container.className = \"GPpanelHeader\";\n\n        // panel title\n        var panelTitle = this._createImportPanelTitleElement();\n        container.appendChild(panelTitle);\n        // close picto\n        var closeDiv = this._createImportPanelCloseElement();\n        container.appendChild(closeDiv);\n\n        return container;\n    },\n\n    /**\n     * Create Header Title Panel\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createImportPanelTitleElement: function() {\n        var div = document.createElement(\"div\");\n        div.className = \"GPpanelTitle\";\n        div.innerHTML = \"Import de donnes\";\n        return div;\n    },\n\n    /**\n     * Create Header close div\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createImportPanelCloseElement: function() {\n        // contexte\n        var self = this;\n\n        var divClose = document.createElement(\"div\");\n        divClose.id = this._addUID(\"GPimportPanelClose\");\n        divClose.className = \"GPpanelClose\";\n        divClose.title = \"Fermer le panneau\";\n\n        // Link panel close / visibility checkbox\n        if (divClose.addEventListener) {\n            divClose.addEventListener(\"click\", function() {\n                document.getElementById(self._addUID(\"GPshowImportPicto\")).click();\n            }, false);\n        } else if (divClose.attachEvent) {\n            divClose.attachEvent(\"onclick\", function() {\n                document.getElementById(self._addUID(\"GPshowImportPicto\")).click();\n            });\n        }\n\n        return divClose;\n    },\n\n    // ################################################################### //\n    // ########################### Form panel ############################ //\n    // ################################################################### //\n\n    /**\n     * Create Form\n     * see event !\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createImportPanelFormElement: function() {\n\n        // contexte d'execution\n        var self = this;\n\n        var form = document.createElement(\"form\");\n        form.id = this._addUID(\"GPimportForm\");\n        form.className = \"map-tool-box\";\n\n        // TODO ?\n        if (form.addEventListener) {\n            form.addEventListener(\"submit\", function(e) {\n                e.preventDefault();\n                self._onImportSubmit();\n            });\n        } else if (form.attachEvent) {\n            form.attachEvent(\"onsubmit\", function(e) {\n                e.preventDefault();\n                self._onImportSubmit();\n            });\n        }\n\n        return form;\n    },\n\n    /**\n     * Create Container for import type choice\n     *\n     * @param {Array} importTypes - import types to be displayed (and used)\n     * @returns {DOMElement} DOM element\n     */\n    _createImportTypeLineElement: function(importTypes) {\n\n        // contexte d'execution\n        var context = this;\n\n        var div = document.createElement(\"div\");\n        div.id = this._addUID(\"GPimportTypeLine\");\n        div.className = \"GPimportInputLine\";\n\n        var label = document.createElement(\"label\");\n        label.htmlFor = this._addUID(\"GPimportType\");\n        label.className = \"GPimportLabel\";\n        label.innerHTML = \"Type de donne\";\n        label.title = \"Type de donne\";\n        div.appendChild(label);\n\n        var select = document.createElement(\"select\");\n        select.className = \"GPimportSelect\";\n        // gestionnaire d'evenement : on stocke la valeur du type d'import\n        if (select.addEventListener) {\n            select.addEventListener(\"change\", function(e) {\n                if (this.value === \"KML\" || this.value === \"GPX\" || this.value === \"GeoJSON\") {\n                    // static import\n                    document.getElementById(context._addUID(\"GPimportStaticParams\")).className = \"GPimportVisibleParams\";\n                    document.getElementById(context._addUID(\"GPimportServiceParams\")).className = \"GPimportHiddenParams\";\n                } else if (this.value === \"WMS\" || this.value === \"WMTS\" || this.value === \"WFS\") {\n                    // service import\n                    document.getElementById(context._addUID(\"GPimportServiceParams\")).className = \"GPimportVisibleParams\";\n                    document.getElementById(context._addUID(\"GPimportStaticParams\")).className = \"GPimportHiddenParams\";\n                }\n                context._onImportTypeChange(e);\n            });\n        } else if (select.attachEvent) {\n            select.attachEvent(\"onchange\", function() {\n                if (this.value === \"KML\" || this.value === \"GPX\" || this.value === \"GeoJSON\") {\n                    // static import\n                    document.getElementById(context._addUID(\"GPimportStaticParams\")).className = \"GPimportVisibleParams\";\n                    document.getElementById(context._addUID(\"GPimportServiceParams\")).className = \"GPimportHiddenParams\";\n                } else if (this.value === \"WMS\" || this.value === \"WMTS\" || this.value === \"WFS\") {\n                    // service import\n                    document.getElementById(context._addUID(\"GPimportServiceParams\")).className = \"GPimportVisibleParams\";\n                    document.getElementById(context._addUID(\"GPimportStaticParams\")).className = \"GPimportHiddenParams\";\n                }\n                context._onImportTypeChange();\n            });\n        }\n        select.id = this._addUID(\"GPimportType\");\n\n        // on prend soit les valeurs passes par l'utilisateur, soit des valeurs par dfaut\n        if (!importTypes || !Array.isArray(importTypes)) {\n            importTypes = [\n                \"KML\",\n                \"GPX\",\n                \"GeoJSON\",\n                \"WMS\",\n                \"WMTS\",\n                \"WFS\"\n            ];\n        }\n        var option;\n        for (var i = 0; i < importTypes.length; i++) {\n            option = document.createElement(\"option\");\n            option.value = importTypes[i];\n            option.text = importTypes[i];\n            select.appendChild(option);\n        }\n\n        div.appendChild(select);\n\n        return div;\n    },\n\n    /**\n     * Create Waiting Panel\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createImportWaitingElement: function() {\n        var div = document.createElement(\"div\");\n        div.id = this._addUID(\"GPimportWaitingContainer\");\n        div.className = \"GPimportWaitingContainerHidden\";\n\n        var p = document.createElement(\"p\");\n        p.className = \"GPimportWaiting\";\n        p.innerHTML = \"Recherche en cours...\";\n\n        div.appendChild(p);\n\n        return div;\n    },\n\n    // ################################################################### //\n    // ############### Params for static import (KML / GPX / GeoJSON) ############## //\n    // ################################################################### //\n\n    /**\n     * Create container for KML/GPX/GeoJSON parameters\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createImportStaticParamsContainer: function(currentType) {\n        var div = document.createElement(\"div\");\n        div.id = this._addUID(\"GPimportStaticParams\");\n        if (currentType === \"KML\" || currentType === \"GPX\" || currentType === \"GeoJSON\") {\n            div.className = \"GPimportVisibleParams\";\n        } else {\n            div.className = \"GPimportHiddenParams\";\n        }\n\n        return div;\n    },\n\n    /**\n     * Create name label for KML/GPX/GeoJSON parameters\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createStaticNameLabel: function() {\n\n        var div = document.createElement(\"div\");\n        div.className = \"GPimportInputLine\";\n\n        var label = document.createElement(\"label\");\n        label.className = \"GPimportLabel\";\n        label.htmlFor = this._addUID(\"GPimportName\");\n        label.innerHTML = \"Nom\";\n        label.title = \"Nom\";\n        div.appendChild(label);\n\n        var input = document.createElement(\"input\");\n        input.type = \"text\";\n        input.id = this._addUID(\"GPimportName\");\n        input.className = \"GPimportInput\";\n        div.appendChild(input);\n\n        return div;\n    },\n\n    /**\n     * Create import choice for KML/GPX/GeoJSON parameters (local or url)\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createStaticModeChoiceDiv: function() {\n\n        var div = document.createElement(\"div\");\n        div.id = this._addUID(\"GPimportChoice\");\n        return div;\n    },\n\n    /**\n     * Create local import choice for KML/GPX/GeoJSON parameters\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createStaticLocalChoiceDiv: function() {\n\n        var context = this;\n\n        var div = document.createElement(\"div\");\n        div.className = \"GPimportChoiceAlt\";\n\n        var input = document.createElement(\"input\");\n        input.type = \"radio\";\n        if (input.addEventListener) {\n            input.addEventListener(\"change\", function(e) {\n                document.getElementById(context._addUID(\"GPimportValueLocal\")).className = \"GPimportInputLine\";\n                document.getElementById(context._addUID(\"GPimportValueUrl\")).className = \"GPimportValueHidden\";\n                context._onStaticImportTypeChange(e);\n            });\n        } else if (input.appendChild) {\n            input.appendChild(\"onchange\", function() {\n                document.getElementById(context._addUID(\"GPimportValueLocal\")).className = \"GPimportInputLine\";\n                document.getElementById(context._addUID(\"GPimportValueUrl\")).className = \"GPimportValueHidden\";\n                context._onStaticImportTypeChange();\n            });\n        }\n        input.name = \"GPimportChoiceMode\";\n        input.value = \"local\";\n        input.checked = true;\n        input.id = this._addUID(\"GPimportChoiceAltLocal\");\n        div.appendChild(input);\n\n        var label = document.createElement(\"label\");\n        label.className = \"GPimportChoiceAltTxt\";\n        label.htmlFor = this._addUID(\"GPimportChoiceAltLocal\");\n        label.innerHTML = \"par fichier local\";\n        label.title = \"par fichier local\";\n        div.appendChild(label);\n\n        return div;\n    },\n\n    /**\n     * Create url import choice for KML/GPX/GeoJSON parameters\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createStaticUrlChoiceDiv: function() {\n\n        var context = this;\n\n        var div = document.createElement(\"div\");\n        div.className = \"GPimportChoiceAlt\";\n\n        var input = document.createElement(\"input\");\n        input.type = \"radio\";\n        if (input.addEventListener) {\n            input.addEventListener(\"change\", function(e) {\n                document.getElementById(context._addUID(\"GPimportValueUrl\")).className = \"GPimportInputLine\";\n                document.getElementById(context._addUID(\"GPimportValueLocal\")).className = \"GPimportValueHidden\";\n                context._onStaticImportTypeChange(e);\n            });\n        } else if (input.appendChild) {\n            input.appendChild(\"onchange\", function() {\n                document.getElementById(context._addUID(\"GPimportValueUrl\")).className = \"GPimportInputLine\";\n                document.getElementById(context._addUID(\"GPimportValueLocal\")).className = \"GPimportValueHidden\";\n                context._onStaticImportTypeChange();\n            });\n        }\n        input.id = this._addUID(\"GPimportChoiceAltUrl\");\n        input.name = \"GPimportChoiceMode\";\n        input.value = \"url\";\n        input.checked = false;\n        div.appendChild(input);\n\n        var label = document.createElement(\"label\");\n        label.className = \"GPimportChoiceAltTxt\";\n        label.htmlFor = this._addUID(\"GPimportChoiceAltUrl\");\n        label.innerHTML = \"par URL\";\n        label.title = \"par URL\";\n        div.appendChild(label);\n\n        return div;\n    },\n\n    /**\n     * Create input div for KML/GPX/GeoJSON parameters local import\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createStaticLocalInputDiv: function() {\n        var div = document.createElement(\"div\");\n        div.id = this._addUID(\"GPimportValueLocal\");\n        div.className = \"GPimportInputLine\";\n        return div;\n    },\n\n    /**\n     * Create input label for KML/GPX/GeoJSON parameters local import\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createStaticLocalInputLabel: function() {\n        var label = document.createElement(\"label\");\n        label.className = \"GPimportLabel\";\n        label.htmlFor = this._addUID(\"GPimportFile\");\n        label.innerHTML = \"Fichier local\";\n        label.title = \"Fichier local\";\n        return label;\n    },\n\n    /**\n     * Create file input for KML/GPX/GeoJSON parameters local import\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createStaticLocalInput: function() {\n        var input = document.createElement(\"input\");\n        input.type = \"file\";\n        input.id = this._addUID(\"GPimportFile\");\n        input.className = \"GPimportInputFile\";\n        return input;\n    },\n\n    /**\n     * Create input div for KML/GPX/GeoJSON parameters url import\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createStaticUrlInputDiv: function() {\n        var div = document.createElement(\"div\");\n        div.id = this._addUID(\"GPimportValueUrl\");\n        div.className = \"GPimportValueHidden\";\n        return div;\n    },\n\n    /**\n     * Create input label for KML/GPX/GeoJSON parameters url import\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createStaticUrlInputLabel: function() {\n        var label = document.createElement(\"label\");\n        label.className = \"GPimportLabel\";\n        label.htmlFor = this._addUID(\"GPimportUrl\");\n        label.innerHTML = \"URL\";\n        label.title = \"URL\";\n        return label;\n    },\n\n    /**\n     * Create url input for KML/GPX/GeoJSON parameters url import\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createStaticUrlInput: function() {\n        var input = document.createElement(\"input\");\n        input.type = \"text\";\n        input.id = this._addUID(\"GPimportUrl\");\n        input.className = \"GPimportInput\";\n        return input;\n    },\n\n    // ################################################################### //\n    // ######## Params for service params import (WMS//WMTS/WFS) ######### //\n    // ################################################################### //\n\n    /**\n     * Create container for WMS/WMTS/WFS parameters\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createServiceParamsContainer: function(currentType) {\n        var div = document.createElement(\"div\");\n        div.id = this._addUID(\"GPimportServiceParams\");\n        if (currentType === \"WMS\" || currentType === \"WMTS\" || currentType === \"WFS\") {\n            div.className = \"GPimportVisibleParams\";\n        } else {\n            div.className = \"GPimportHiddenParams\";\n        }\n\n        return div;\n    },\n\n    /**\n     * Create div for WMS/WMTS/WFS url\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createServiceUrlDiv: function() {\n        var div = document.createElement(\"div\");\n        div.className = \"GPimportInputLine\";\n        return div;\n    },\n\n    /**\n     * Create input label for WMS/WMTS/WFS url\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createServiceUrlInputLabel: function() {\n        var label = document.createElement(\"label\");\n        label.className = \"GPimportLabel\";\n        label.htmlFor = this._addUID(\"GPimportServiceUrl\");\n        label.innerHTML = \"URL du service\";\n        label.title = \"URL du service\";\n        return label;\n    },\n\n    /**\n     * Create input for WMS/WMTS/WFS parameters url\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createServiceUrlInput: function() {\n        var input = document.createElement(\"input\");\n        input.type = \"text\";\n        input.id = this._addUID(\"GPimportServiceUrl\");\n        input.className = \"GPimportInput\";\n        return input;\n    },\n\n    // ################################################################### //\n    // ########################### Submit Form ########################### //\n    // ################################################################### //\n\n    /**\n     * Create Submit Form Element\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createImportSubmitFormElement: function() {\n\n        var input = document.createElement(\"input\");\n        input.id = this._addUID(\"GPimportSubmit\");\n        input.className = \"GPinputSubmit tool-form-submit\";\n        input.type = \"submit\";\n        input.value = \"Importer\";\n\n        return input;\n    },\n\n    // ################################################################### //\n    // ########################### GetCap Panel ########################## //\n    // ################################################################### //\n\n    /**\n     * Create GetCap Panel Element\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createImportGetCapPanelElement: function() {\n        var div = document.createElement(\"div\");\n        div.id = this._addUID(\"GPimportGetCapPanel\");\n        div.className = \"GPpanel\";\n        return div;\n    },\n\n    /**\n     * Create GetCap Panel Header Element\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createImportGetCapPanelHeaderElement: function() {\n\n        // contexte\n        var context = this;\n\n        var container = document.createElement(\"div\");\n        container.className = \"GPpanelHeader\";\n\n        // panel title\n        var panelTitle = document.createElement(\"div\");\n        panelTitle.className = \"GPpanelTitle\";\n        panelTitle.innerHTML = \"Couches accessibles\";\n        panelTitle.title = \"Couches accessibles\";\n        container.appendChild(panelTitle);\n\n        // close picto\n        var closeDiv = document.createElement(\"div\");\n        if (closeDiv.addEventListener) {\n            closeDiv.addEventListener(\"click\", function() {\n                document.getElementById(context._addUID(\"GPimportGetCapPanel\")).style.display = \"none\";\n                document.getElementById(context._addUID(\"GPimportPanel\")).style.display = \"\";\n                context._onGetCapPanelClose();\n            });\n        } else if (closeDiv.attachEvent) {\n            closeDiv.attachEvent(\"click\", function() {\n                document.getElementById(context._addUID(\"GPimportGetCapPanel\")).style.display = \"none\";\n                document.getElementById(context._addUID(\"GPimportPanel\")).style.display = \"\";\n                context._onGetCapPanelClose();\n            });\n        }\n        closeDiv.className = \"GPpanelClose\";\n        closeDiv.title = \"Fermer le panneau\";\n        closeDiv.id = this._addUID(\"GPimportGetCapPanelClose\");\n        container.appendChild(closeDiv);\n\n        return container;\n    },\n\n    /**\n     * Create GetCap Results List Element\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createImportGetCapResultsListElement: function() {\n        var container = document.createElement(\"div\");\n        container.id = this._addUID(\"GPimportGetCapResults\");\n        return container;\n    },\n\n    /**\n     * Create GetCap Result Element ( = layer description)\n     *\n     * @param {String} layerDescription - description to be displayed for layer\n     * @param {Number} id - layer identifier in getCapabilities response layers list\n     * @returns {DOMElement} DOM element\n     */\n    _createImportGetCapResultElement: function(layerDescription, id) {\n        var div = document.createElement(\"div\");\n        div.className = \"GPimportGetCapProposal\";\n        div.innerHTML = layerDescription;\n        div.title = layerDescription;\n\n        var context = this;\n        if (div.addEventListener) {\n            div.addEventListener(\"click\", function(e) {\n                context._onGetCapResponseLayerClick(e);\n            });\n        } else if (div.attachEvent) {\n            div.attachEvent(\"onclick\", function() {\n                context._onGetCapResponseLayerClick();\n            });\n        }\n        div.id = \"GPimportGetCapProposal_\" + id;\n\n        return div;\n    }\n\n};\n\nexport default LayerImportDOM;\n\n\n\n// WEBPACK FOOTER //\n// ./src/Common/Controls/LayerImportDOM.js","\nimport ol from \"ol\";\nimport LayerUtils from \"../../Common/Utils/LayerUtils\";\n\n/**\n * @classdesc\n * OpenLayers Control to manage Originators for layer resources\n *\n * @constructor\n * @extends {ol.control.Attribution}\n * @alias ol.control.GeoportalAttribution\n * @param {Object} options - ol.control.Attribution options (see {@link http://openlayers.org/en/latest/apidoc/ol.control.Attribution.html ol.Control.Attribution})\n * @example\n * map.addControl(\n *      new ol.control.GeoportalAttribution({\n *          collapsed : false\n * );\n */\nfunction GeoportalAttribution(options) {\n\n    if (!(this instanceof GeoportalAttribution)) {\n        throw new TypeError(\"ERROR CLASS_CONSTRUCTOR\");\n    }\n\n    // call ol.control.Attribution constructor\n    ol.control.Attribution.call(this,\n        options\n    );\n\n}\n\n// Inherits from ol.control.Attribution\nol.inherits(GeoportalAttribution, ol.control.Attribution);\n\n/*\n * @lends module:GeoportalAttribution\n */\nGeoportalAttribution.prototype = Object.create(ol.control.Attribution.prototype, {});\n\n/**\n * Constructor (alias)\n */\nGeoportalAttribution.prototype.constructor = GeoportalAttribution;\n\n/**\n * Overload setMap function, that enables to catch map events, such as movend events.\n *\n * @param {ol.Map} map - Map.\n */\nGeoportalAttribution.prototype.setMap = function(map) {\n\n    if (map != null) {\n        // Remove default ol.control.Attribution\n        var ctrls = map.getControls();\n        ctrls.forEach(\n            function(element) {\n                if (element instanceof ol.control.Attribution && !(element instanceof GeoportalAttribution)) {\n                    this.remove(element);\n                }\n            },\n            ctrls\n        );\n\n        // on rcupre les attributions des couches dj ajoutes  la carte.\n        this._updateAttributions(map);\n\n        // At every map movement, layers attributions have to be updated,\n        // according to map and originators zoom and extent.\n        var context = this;\n        map.on(\n            \"moveend\",\n            function() {\n                context._updateAttributions(map);\n            },\n            this\n        );\n        map.getLayers().on(\n            \"add\",\n            function() {\n                context._updateAttributions(map);\n            },\n            this\n        );\n        map.getLayers().on(\n            \"remove\",\n            function() {\n                context._updateAttributions(map);\n            },\n            this\n        );\n    }\n\n    ol.control.Attribution.prototype.setMap.call(this, map);\n\n};\n\n/**\n * Update map layers attributions\n *\n * @param {ol.Map} map - Map.\n * @private\n */\nGeoportalAttribution.prototype._updateAttributions = function(map) {\n    // get map parameters\n    var mapAttributions = {};\n\n    var view = map.getView();\n    // extent, then convert to geographical coordinates\n    var extent = view.calculateExtent(map.getSize());\n    var mapProjection = view.getProjection().getCode();\n    var geoExtent = ol.proj.transformExtent(extent, mapProjection, \"EPSG:4326\");\n    // transform extent from [minx, miny, maxx, maxy] to [maxy, minx, miny, maxx]\n    var standardExtent = [geoExtent[3], geoExtent[0], geoExtent[1], geoExtent[2]];\n    // zoom\n    var zoom = view.getZoom();\n    // layers\n    var layers = map.getLayers().getArray();\n\n    // info : This option suppresses warnings about functions inside of loops.\n    /* jshint loopfunc: true */\n\n    // loop on layers to get their originators, if there is at least one originator, and if layer is visible.\n    for (var i = 0; i < layers.length; i++) {\n\n        // distinguish case of ol.layer.Group (which is made up of layers with their own source)\n        // and other ol.layer (with their own source)\n        if (layers[i].getSource) {\n            // single ol.layer\n            this._updateLayerAttributions(layers[i], mapAttributions, standardExtent, mapProjection, zoom);\n        } else if (layers[i].getLayers) {\n            // ol.layer.Group\n            var lyrs = layers[i].getLayers();\n            var context = this;\n            lyrs.forEach(\n                function(lyr) {\n                    if (lyr.getSource) {\n                        context._updateLayerAttributions(lyr, mapAttributions, standardExtent, mapProjection, zoom);\n                    } else {\n                        console.log(\"cannot find layer source in layergroup \", layers[i]);\n                    }\n                }\n            );\n        }\n    }\n};\n\n/**\n * Update a layer attributions\n *\n * @param {ol.layer} layer - layer\n * @param {Object} mapAttributions - object recensing attributions already added, to prevent displaying twice the same producer\n * @param {Array} mapExtent - map current extent\n * @param {String} mapCrs - map current crs\n * @param {Number} mapZoom - map current zoom\n * @private\n */\nGeoportalAttribution.prototype._updateLayerAttributions = function(layer, mapAttributions, mapExtent, mapCrs, mapZoom) {\n    var src = layer.getSource();\n\n    var attributions = [];\n\n    var visibility = layer.getVisible();\n    var originators = src._originators;\n\n    // info : clean previous attributions ONLY for Geoportal Layers (when src._originators is defined)\n    if (typeof originators !== \"undefined\") {\n        src.setAttributions(); // clean\n    }\n\n    if (originators && visibility) {\n\n        // get layer's attributions array\n        var layerAttributions = LayerUtils.getAttributions({\n            extent: mapExtent,\n            crs: mapCrs,\n            zoom: mapZoom,\n            visibility: visibility,\n            originators: originators\n        });\n\n        for (var j = 0; j < layerAttributions.length; j++) {\n            var attributionj = layerAttributions[j];\n            // check that this attribution hasn't been added yet for another layer\n            if (!mapAttributions || !mapAttributions[attributionj]) {\n                // add attribution html\n                attributions.push(new ol.Attribution({\n                    html: attributionj\n                }));\n\n                // add attribution to mapAttributions, to manage all layers attributions\n                mapAttributions[attributionj] = true;\n            }\n        };\n\n        // update source attribution\n        if (attributions.length !== 0) {\n            src.setAttributions(attributions);\n        }\n    }\n};\n\nexport default GeoportalAttribution;\n\n\n\n// WEBPACK FOOTER //\n// ./src/OpenLayers/Controls/GeoportalAttribution.js","/* globals AmCharts, d3 */\nimport ol from \"ol\";\nimport Gp from \"gp\";\nimport Logger from \"../../Common/Utils/LoggerByDefault\";\nimport Utils from \"../../Common/Utils\";\nimport RightManagement from \"../../Common/Utils/CheckRightManagement\";\nimport Measures from \"./Measures/Measures\";\nimport MeasureToolBox from \"./MeasureToolBox\";\nimport Interactions from \"./Utils/Interactions\";\nimport ElevationPathDOM from \"../../Common/Controls/ElevationPathDOM\";\nimport ProfileElevationPathDOM from \"../../Common/Controls/ProfileElevationPathDOM\";\nimport ID from \"../../Common/Utils/SelectorID\";\n\n\nvar logger = Logger.getLogger(\"elevationpath\");\n\n/**\n * @classdesc\n *\n * Elevation Path Control. Allows users to draw a path on a OL3 map see the elevation profile computed with geoportal elevation path web service along that path.\n *\n * @constructor\n * @alias ol.control.ElevationPath\n * @extends ol.control.Control\n * @param {Object} options - options for function call.\n * @param {Boolean} [options.active = false] - specify if control should be actived at startup. Default is false.\n * @param {Object} [options.stylesOptions = DEFAULT_STYLES] - styles management\n * @param {Object} [options.stylesOptions.marker = {}] - styles management of marker displayed on map when the user follows the elevation path. Specified with an {@link https://openlayers.org/en/latest/apidoc/ol.style.Image.html ol.style.Image} subclass object\n * @param {Object} [options.stylesOptions.draw = {}] - styles used when drawing. Specified with following properties.\n * @param {Object} [options.stylesOptions.draw.pointer = {}] - Style for mouse pointer when drawing the line. Specified with an {@link https://openlayers.org/en/latest/apidoc/ol.style.Image.html ol.style.Image} subclass object.\n * @param {Object} [options.stylesOptions.draw.start = {}] - Line Style when drawing. Specified with an {@link https://openlayers.org/en/latest/apidoc/ol.style.Stroke.html ol.style.Stroke} object.\n * @param {Object} [options.stylesOptions.draw.finish = {}] - Line Style when finished drawing. Specified with an {@link https://openlayers.org/en/latest/apidoc/ol.style.Stroke.html ol.style.Stroke} object.\n * @param {Object} [options.elevationPathOptions = {}] - elevation path service options. See {@link http://ignf.github.io/geoportal-access-lib/latest/jsdoc/module-Services.html#~getAltitude Gp.Services.getAltitude()} for available options\n * @param {Object} [options.displayProfileOptions = {}] - profile options.\n * @param {Boolean} [options.displayProfileOptions.greaterSlope = true] - display the greater slope into the graph\n * @param {Boolean} [options.displayProfileOptions.meanSlope = true] -  display the mean slope into the graph\n * @param {Boolean} [options.displayProfileOptions.ascendingElevation = true] -  display the ascending elevation into the graph\n * @param {Boolean} [options.displayProfileOptions.descendingElevation = true] -  display the descending elevation into the graph\n * @param {Boolean} [options.displayProfileOptions.currentSlope = true] -  display current slope value on profile mouseover\n * @param {Function} [options.displayProfileOptions.apply] - function to display profile if you want to cutomise it. By default, ([DISPLAY_PROFILE_BY_DEFAULT()](./ol.control.ElevationPath.html#.DISPLAY_PROFILE_BY_DEFAULT)) is used. Helper functions to use with D3 ([DISPLAY_PROFILE_LIB_D3()](./ol.control.ElevationPath.html#.DISPLAY_PROFILE_LIB_D3)) or AmCharts ([DISPLAY_PROFILE_LIB_AMCHARTS()](./ol.control.ElevationPath.html#.DISPLAY_PROFILE_LIB_AMCHARTS)) frameworks are also provided. You may also provide your own function.\n * @param {Object} [options.displayProfileOptions.target] - DOM container to use to display the profile.\n * @example\n *\n * var measure = new ol.control.ElevationPath({\n *    stylesOptions : {\n *     draw : {\n *       finish : new ol.style.Stroke({\n *            color : \"rgba(0, 0, 0, 0.5)\",\n *            width : 2\n *       })\n *     },\n *    }\n *    displayProfileOptions : {\n *       apply : ol.control.ElevationPath.DISPLAY_PROFILE_RAW,\n *    }\n * });\n *\n * Exemples :\n * - displayProfileOptions.apply : null\n * - displayProfileOptions.apply : function (elevations, container, context) {  // do some stuff... }\n * - displayProfileOptions.apply : ol.control.ElevationPath.DISPLAY_PROFILE_{LIB_AMCHARTS | LIB_D3 | RAW}\n *\n */\nfunction ElevationPath(options) {\n    logger.trace(\"ElevationPath()\");\n\n    /**\n     * options\n     * @private\n     */\n    options = options || {};\n\n    if (!(this instanceof ElevationPath)) {\n        throw new TypeError(\"ERROR CLASS_CONSTRUCTOR\");\n    }\n\n    /**\n     * Nom de la classe (heritage)\n     * @private\n     */\n    this.CLASSNAME = \"ElevationPath\";\n\n    // uuid\n    this._uid = ID.generate();\n\n    // container : HTMLElement\n    this._showContainer = null;\n    this._pictoContainer = null;\n    this._panelContainer = null;\n    this._profileContainer = null;\n    this._waitingContainer = null;\n    this._infoContainer = null;\n\n    // timer sur la fenetre d'informations des donnes\n    this._timerHdlr = null;\n\n    // objet de type \"ol.style\"\n    this._drawStyleStart = null;\n    this._drawStyleFinish = null;\n    this._markerStyle = null;\n\n    // graph\n    this._profile = null;\n\n    // data elevations\n    this._data = {};\n\n    /* objet de type\n        \"ol.source.Vector\",\n        \"ol.layer.Vector\",\n        \"ol.interaction.Draw\"\n    */\n    this._measureSource = null;\n    this._measureVector = null;\n    this._measureDraw = null;\n\n    // objet de type ol.feature, saisie en cours\n    this._lastSketch = null;\n    this._currentSketch = null;\n\n    // objet de type ol.feature, marker\n    this._marker = null;\n\n    // gestion des droits sur le service\n    this._noRightManagement = false;\n\n    // initialisation du composant\n    this._initialize(options);\n\n    // gestion des droits\n    this._checkRightsManagement();\n\n    // creation du DOM container\n    var container = (options.element) ? options.element : this._initializeContainer();\n\n    // heritage\n    ol.control.Control.call(this, {\n        element: container,\n        target: options.target,\n        render: options.render\n    });\n}\n\n// heritage avec ol.control.Control\nol.inherits(ElevationPath, ol.control.Control);\n\n/**\n * @lends module:ElevationPath\n */\nElevationPath.prototype = Object.create(ol.control.Control.prototype, {});\n\n// on rcupre les mixins de la classe \"ElevationPathDOM\"\nUtils.assign(ElevationPath.prototype, ElevationPathDOM);\n\n/**\n * suppression du marker\n *\n * @private\n */\nElevationPath.__removeProfileMarker = function(context) {\n    var self = context;\n    // suppression de l'ancien marker\n    if (self._marker) {\n        self._measureSource.removeFeature(self._marker);\n        self._marker = null;\n    }\n};\n\n/**\n * suppression du marker\n *\n * @private\n */\nElevationPath.__createProfileMarker = function(context, d) {\n    var self = context;\n    var map = self.getMap();\n    var proj = map.getView().getProjection();\n\n    var _coordinate = ol.proj.transform([d.lon, d.lat], \"EPSG:4326\", proj);\n    var _coordinateProj = self._measureSource\n        .getFeatures()[0]\n        .getGeometry()\n        .getClosestPoint(_coordinate);\n\n    var _geometry = new ol.geom.Point(_coordinateProj);\n\n    self._marker = new ol.Feature({\n        geometry: _geometry\n    });\n    logger.trace(_geometry);\n\n    // style\n    self._marker.setStyle(self._markerStyle);\n\n    // ajout du marker sur la map\n    self._measureSource.addFeature(self._marker);\n};\n\n/**\n * mise  jour du marker\n *\n * @private\n */\nElevationPath.__updateProfileMarker = function(context, d) {\n    var self = context;\n    ElevationPath.__removeProfileMarker(self);\n    ElevationPath.__createProfileMarker(self, d);\n};\n\n/**\n * TODO : customisation possible d'une opration sur le profil\n * @private\n */\nElevationPath.__customRawProfileOperation = function(context, d) {\n    logger.log(\"__customRawProfileOperation\");\n\n    var self = context;\n\n    var _pts = d.points;\n    var _proj = self.getMap().getView().getProjection();\n    for (var i = 0; i < _pts.length; i++) {\n        var obj = _pts[i];\n        var _coordinate = ol.proj.transform([obj.lon, obj.lat], \"EPSG:4326\", _proj);\n        var _geometry = new ol.geom.Point(_coordinate);\n\n        self._marker = new ol.Feature({\n            geometry: _geometry\n        });\n        logger.trace(_geometry);\n\n        // TODO style en options ?\n        var styles = ElevationPath.DEFAULT_STYLES.RESULTS;\n        var _image = new ol.style.Circle({\n            radius: styles.imageRadius,\n            stroke: new ol.style.Stroke({\n                color: styles.imageStrokeColor,\n                width: styles.imageStrokeWidth\n            }),\n            fill: new ol.style.Fill({\n                color: styles.imageFillColor\n            })\n        });\n        self._marker.setStyle(new ol.style.Style({\n            image: _image\n        }));\n\n        // ajout du marker sur la map\n        self._measureSource.addFeature(self._marker);\n    }\n};\n\n/**\n * TODO : customisation possible d'une opration sur le profil\n * Ex. Methode apple dans le DOM : ProfileElevationPathDOM\n * @private\n */\nElevationPath.__customRawProfileMouseOverEvent = function(context, e) {\n    logger.log(\"__customRawProfileMouseOverEvent\", context, e);\n};\n\n/**\n * display Profile using Amcharts framework. This method needs AmCharts libraries to be loaded.\n *\n * @param {Object} data - collection elevations\n * @param {HTMLElement} container - container\n * @param {Object} context - this control object\n */\nElevationPath.DISPLAY_PROFILE_LIB_AMCHARTS = function(data, container, context) {\n    logger.trace(\"ElevationPath.DISPLAY_PROFILE_LIB_AMCHARTS\");\n\n    // Calcul du profile\n    if (typeof AmCharts === \"undefined\") {\n        console.log(\"Lib. AmCharts is not loaded !\");\n        return;\n    }\n\n    var profile = ProfileElevationPathDOM.displayProfileLibAmCharts(data, container, context, ElevationPath);\n    // on sauvegarde le profil du container dans l'objet\n    if (profile) {\n        this._profile = profile;\n    }\n};\n\n/**\n * display Profile using D3 javascript framework. This method needs D3 libraries to be loaded.\n *\n * @param {Object} data - elevations values for profile\n * @param {HTMLElement} container - html container where to display profile\n * @param {Object} context - this control object\n */\nElevationPath.DISPLAY_PROFILE_LIB_D3 = function(data, container, context) {\n    logger.trace(\"ElevationPath.DISPLAY_PROFILE_LIB_D3\");\n\n    // Calcul du profile\n    if (typeof d3 === \"undefined\") {\n        console.log(\"Lib. D3 is not loaded !\");\n        return;\n    }\n\n    var profile = ProfileElevationPathDOM.displayProfileLibD3(data, container, context, ElevationPath);\n    // on sauvegarde le profil du container dans l'objet\n    if (profile) {\n        this._profile = profile;\n    }\n};\n\n/**\n * display Profile without graphical rendering (raw service response)\n *\n * @param {Object} data - elevations values for profile\n * @param {HTMLElement} container - html container where to display profile\n * @param {Object} context - this control object\n */\nElevationPath.DISPLAY_PROFILE_RAW = function(data, container, context) {\n    logger.trace(\"ElevationPath.DISPLAY_PROFILE_RAW\");\n\n    var profile = ProfileElevationPathDOM.displayProfileRaw(data, container, context, ElevationPath);\n    // on sauvegarde le profil du container dans l'objet\n    if (profile) {\n        this._profile = profile;\n    }\n};\n\n/**\n * Display Profile function used by default : no additonal framework needed.\n *\n * @param {Object} data - elevations values for profile\n * @param {HTMLElement} container - html container where to display profile\n * @param {Object} context - this control object\n */\nElevationPath.DISPLAY_PROFILE_BY_DEFAULT = function(data, container, context) {\n    logger.trace(\"ElevationPath.DISPLAY_PROFILE_BY_DEFAULT\");\n\n    var profile = ProfileElevationPathDOM.displayProfileByDefault(data, container, context, ElevationPath);\n    // on sauvegarde le profil du container dans l'objet\n    if (profile) {\n        this._profile = profile;\n    }\n};\n\n/**\n * Styles applied by default if stylesOptions property is not set.\n */\nElevationPath.DEFAULT_STYLES = {\n    // styling drawing by default\n    // see => Measures.DEFAULTS_STYLES\n    // stying marker to the profile by default\n    MARKER: new ol.style.Icon({\n        src: \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACIAAAAsCAYAAAAATWqyAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAABTtJREFUeNq8WGtsFUUU/rb3gtdCAykFG9AUDTQUKimhxUewEusrJYoBo4FfEgoqotHERH6oP9TGmJhIrIlWAf9hjAaEiME2pgFfVVpFii8sWqIQLLSx3EJLW7p+Z2Z2b2l7d/b23vZLTmZ2duacb2fmnDk7DlKA67rXs1hJKacsohRQppjXFygnKT9TDlH2O47zFzIFGnco91EOuqnjoBnr2Ow4FhIlLN6m3DykFTh3BGj/Doj/CfSe082xPCDnBmDWTUBeyXDVjZTHOUNHUiZCEs+weI0ySTV0/w0c2wa07gIungn+vOx8YN46oPhpYOp1Xms/5TmSeSMUERKImFnYqBoGuPRNL5LEW8BgX2rrmjWZZLYApS8BUW8r4T0zO5eTEjFr+S6lSjV0HgPqVwNdf6S30abNB+7aDeQWey3bKZtIxvU5DxvyrE/izJfAvuXpkxCIDtElOjWqjK2RM8LZWMbiG0oEnUc5kB7a14WMYvI04H56du5ieZKluZWz8r0/IyQh5TuKRH8cqFuTeRIC0Sm6xYbYok1j21+ahyhLVO3wC8D5VowbRLfY0FhibOulIavDLEoRZyD8sJDeMWBXKG5ZsIobsdDsg+OMq3u1m1u9KQo8zP45EqjRxOUpk6i50IRl4FuGjpZtwUoiMYa314GFj/EzIsN8n8v+C1e4kfvwcm+wnhsZY27xQ8oiWZpKrWRQB6tAElfxpKnjsCdGklDzG9HvpI/0DYLYEpsalVnmAAM6fgR62oMHl70C5N9mn3rpI32DILbEpkZ5ljlFgbPNFtebzij5VPhNKX1lTBASNtXSzPZ3cxCuvVOH7FTCu4yxeZDGbCES0z5+PniQ3uGpwTYmYTOWCPGTpgYP6u9OnYhtzBCbQkSH0NiM4EEdP6VOxDYmYbNLiJxQ1elFwYPaG3XQCn3QHddjgpCweUKI6K2bvzw4YROf//rJob6fZl/H2FRoFiINfqo3qyzYwD8MVIeYLw32J+8j76SP9A2C2BKbGg1CZL+EF/W4YKP9a3/fCeyhkrY9DOOXEu1SlzZ5J31sSNjqURm/OfQkY9qgvkYOvXhbuH0g505Oga7HT9rPF9+t5+pDL0ulwzt46FV5ROax+JUSRRtP0LoHMK64+xNg7iqVEVOKSKRVxRGpsKhRnaRD4SPjR0J0axKCGmP7ilQxm4X8d8xXmfvHJZlPkCR3WfODl9FLMlxCIhevSJ5Nwzo1XdKxYpe3hpmB6BKdmoS43VqPxIgsni+aWOg8biZ3f+nLmSMiuvKWek/P01az7QdLyNVT7lC/l59WAKcb0iMxhzpW1nvmvpDtSiKD1l9OkpnDgv8UyMWFU9wvTP8vdY6NhJwnD1JVtso2OiiLSeL0iJUbNfg6zikVVwRTyOn2HWOfjfLtHgnBhtFIJCViyNDZUatdmnGlaFPqJIoe1WM1aqlz71ivJbLNobgAA9zgu7nZ/vstHAk5WVdzaPRqmGC5lER6kjpV4OWJdq+1kkshSk4VH9izcy/bV66qSPQZV+0J9G7rTY6+XNmqHmYwyJVV24kse1X31dhKHdasygkzy+a64oC4nWr47F4e858nSbLv4V/KAe9JKpVDrx/SImLIXMOiRUKdujESl+49O8xVZxpXzVc/C/I/RxL/hgq8YYkYhev9q6kVO4d9B+sr3vdICNaHJTHWW8Ya/87wqy2uWwstUk/gTYw3aCRGOarMDfS67kfFWqSuIe9imAjQEC272nJHixYNaSvGRIIGN49ywbsZEw1zI11N6TZSHeaGORn+F2AAJtRIMx4t+hUAAAAASUVORK5CYII=\",\n        anchor: [0.5, 1],\n        snapToPixel: true\n    }),\n    // styling service results points by default\n    RESULTS: {\n        // INFO orient maintenance !\n        imageRadius: 5,\n        imageFillColor: \"rgba(128, 128, 128, 0.2)\",\n        imageStrokeColor: \"rgba(0, 0, 0, 0.7)\",\n        imageStrokeWidth: 2\n    }\n    // FIXME ???\n    // PROFILE : {\n    //     type : \"serial\",\n    //     pathToImages : \"http://cdn.amcharts.com/lib/3/images/\",\n    //     categoryField : \"dist\",\n    //     autoMarginOffset : 0,\n    //     marginRight : 10,\n    //     marginTop : 10,\n    //     startDuration : 0,\n    //     color : \"#5E5E5E\",\n    //     fontSize : 10,\n    //     theme : \"light\",\n    //     thousandsSeparator : \"\",\n    //     categoryAxis : {\n    //         color : \"#5E5E5E\",\n    //         gridPosition : \"start\",\n    //         minHorizontalGap : 40,\n    //         tickPosition : \"start\",\n    //         title : \"Distance (km)\",\n    //         titleColor : \"#5E5E5E\",\n    //         startOnAxis : true\n    //     },\n    //     chartCursor : {\n    //         animationDuration : 0,\n    //         bulletsEnabled : true,\n    //         bulletSize : 10,\n    //         categoryBalloonEnabled : false,\n    //         cursorColor : \"#F90\",\n    //         graphBulletAlpha : 1,\n    //         graphBulletSize : 1,\n    //         zoomable : false\n    //     },\n    //     trendLines : [],\n    //     graphs : [\n    //         {\n    //             balloonColor : \"#CCCCCC\",\n    //             balloonText : \"<span class='altiPathValue'>[[title]] : [[value]]m</span><br/><span class='altiPathCoords'>(lat: [[lat]] / lon:[[lon]])</span>\",\n    //             bullet : \"round\",\n    //             bulletAlpha : 0,\n    //             bulletBorderColor : \"#FFF\",\n    //             bulletBorderThickness : 2,currentSlope\n    //             bulletColor : \"#F90\",\n    //             bulletSize : 6,\n    //             hidden : false,\n    //             id : \"AmGraph-1\",\n    //             fillAlphas : 0.4,\n    //             fillColors : \"#C77A04\",\n    //             lineAlpha : 1,\n    //             lineColor : \"#C77A04\",\n    //             lineThickness : 1,\n    //             title : \"Altitude\",\n    //             valueField : \"z\"\n    //         }\n    //     ],\n    //     guides : [],\n    //     valueAxes : [\n    //         {\n    //             id : \"ValueAxis-1\",\n    //             minVerticalGap : 20,\n    //             title : \"Altitude (m)\"\n    //         }\n    //     ],\n    //     allLabels : [],\n    //     balloon : {\n    //         borderColor : \"#CCCCCC\",\n    //         borderThickness : 1,\n    //         fillColor : \"#FFFFFF\",\n    //         showBullet : true\n    //     },\n    //     titles : []\n    // }\n};\n\n/**\n * Constructor (alias)\n * @private\n */\nElevationPath.prototype.constructor = ElevationPath;\n\n// ################################################################### //\n// ##################### public methods ############################## //\n// ################################################################### //\n\n/**\n * Attach control to map. Overloaded ol.control.Control.setMap() method.\n *\n * @param {ol.Map} map - Map.\n */\nElevationPath.prototype.setMap = function(map) {\n    logger.trace(\"ElevationPath::setMap\");\n\n    if (map) {\n        // activation des interactions de dessin selon la valeur de\n        // l'option active\n        if (this.options.active) {\n            // on n'affiche pas la fenetre de profile s'il n'existe pas...\n            if (this._profile === null) {\n                this._panelContainer.style.display = \"none\";\n                // this._panelContainer.style.visibility = \"hidden\";\n            }\n            this._initMeasureInteraction(map);\n            this._addMeasureInteraction(map);\n        }\n\n        // ajout du composant dans une toolbox\n        if (!this.options.target) {\n            MeasureToolBox.add(map, this);\n        }\n    }\n\n    // on appelle la mthode setMap originale d'OpenLayers\n    ol.control.Control.prototype.setMap.call(this, map);\n\n};\n\n/**\n * Returns true if widget is actived (drawing),\n * false otherwise\n *\n * @returns {Boolean} active - true or false\n */\nElevationPath.prototype.getActive = function() {\n    logger.trace(\"ElevationPath::getActive\");\n    return this.options.active;\n};\n\n/**\n * Actived widget drawing or not\n *\n * @param {Boolean} active - true / false\n */\nElevationPath.prototype.setActive = function(active) {\n    logger.trace(\"ElevationPath::setActive\");\n    this.options.active = active;\n};\n\n/**\n * clean\n */\nElevationPath.prototype.clean = function() {\n    logger.trace(\"ElevationPath::clean\");\n\n    var map = this.getMap();\n\n    // fenetre du profil\n    this._panelContainer.style.display = \"none\";\n    // this._panelContainer.style.visibility = \"hidden\";\n\n    // picto\n    this._showContainer.checked = false;\n\n    this._removeProfile();\n    this._removeMeasure();\n    this._removeMeasureInteraction(map);\n};\n\n/**\n * Remove measure\n * @private\n */\nElevationPath.prototype._removeMeasure = function() {\n    // sketch\n    this._lastSketch = null;\n    this._currentSketch = null;\n\n    if (this._measureSource) {\n        // marker\n        if (this._marker) {\n            this._measureSource.removeFeature(this._marker);\n            this._marker = null;\n        }\n\n        // all other features\n        var _features = this._measureSource.getFeatures();\n        for (var i = 0; i < _features.length; i++) {\n            this._measureSource.removeFeature(_features[i]);\n        }\n    }\n};\n\n/**\n * Remove profile\n * @private\n */\nElevationPath.prototype._removeProfile = function() {\n\n    // graph\n    this._profile = null;\n\n    // on vide le container\n    if (this._profileContainer) {\n        while (this._profileContainer.firstChild) {\n            this._profileContainer.removeChild(this._profileContainer.firstChild);\n        }\n    }\n};\n\n// ################################################################### //\n// ##################### init component ############################## //\n// ################################################################### //\n\n/**\n * Initialize control (called by constructor)\n *\n * @private\n */\nElevationPath.prototype._initialize = function(options) {\n    logger.trace(\"ElevationPath::_initialize : \", options);\n\n    // liste des options\n    this.options = {\n        target: null,\n        render: null,\n        active: false,\n        apiKey: null,\n        elevationOptions: {},\n        displayProfileOptions: {\n            greaterSlope: true,\n            meanSlope: true,\n            ascendingElevation: true,\n            descendingElevation: true,\n            currentSlope: true,\n            apply: null,\n            target: null\n        },\n        stylesOptions: {\n            profile: null,\n            draw: null,\n            marker: null\n        }\n    };\n\n    // merge with user options\n    Utils.mergeParams(this.options, options);\n\n    // cle API sur le service\n    this.options.apiKey = options.apiKey;\n\n    // gestion de l'affichage du profil\n    var _profile = options.displayProfileOptions || {};\n\n    // gestion de la fonction du profil\n    var displayFunction = _profile.apply;\n    this.options.displayProfileOptions.apply = (typeof displayFunction === \"function\") ?\n        displayFunction : ElevationPath.DISPLAY_PROFILE_BY_DEFAULT;\n\n    // gestion du container du profil\n    var displayContainer = _profile.target;\n    this.options.displayProfileOptions.target = (typeof displayContainer !== \"undefined\") ?\n        displayContainer : null;\n\n    // gestion des styles\n    var _styles = options.stylesOptions || {};\n\n    // FIXME ???\n    // gestion du style du profil\n    // var profileStyle = _styles.profile;\n    // this.options.stylesOptions.profile = ( typeof profileStyle === \"undefined\" || Object.keys(profileStyle).length === 0 ) ?\n    //     ElevationPath.DEFAULT_STYLES.PROFILE : profileStyle;\n    // this._createStylingProfile();\n\n    // gestion des styles du trac\n    this.options.stylesOptions.draw = _styles.draw || {};\n    this._createStylingDraw();\n\n    // gestion des styles du marker\n    this.options.stylesOptions.marker = _styles.marker || {};\n    this._createStylingMarker();\n\n};\n\n/**\n * initialize component container (DOM)\n *\n * @private\n */\nElevationPath.prototype._initializeContainer = function() {\n    logger.trace(\"ElevationPath::_initializeContainer : \", this._uid);\n\n    // create main container\n    var container = this._createMainContainerElement();\n\n    var inputShow = this._showContainer = this._createShowElevationPathElement();\n    container.appendChild(inputShow);\n\n    var picto = this._pictoContainer = this._createShowElevationPathPictoElement();\n    container.appendChild(picto);\n\n    // mode \"active\"\n    if (this.options.active) {\n        this._showContainer.checked = true;\n    }\n\n    // panneau\n    var panel = this._panelContainer = this._createElevationPathPanelElement();\n\n    // header\n    var header = this._createElevationPathPanelHeaderElement();\n    panel.appendChild(header);\n\n    // profile\n    var profile = this._profileContainer = this._createElevationPathPanelProfilElement();\n    panel.appendChild(profile);\n\n    // waiting\n    var waiting = this._waitingContainer = this._createElevationPathWaitingElement();\n    panel.appendChild(waiting);\n\n    // info\n    var info = this._infoContainer = this._createElevationPathInformationsElement();\n    panel.appendChild(info);\n\n    if (this.options.displayProfileOptions.target === null) {\n        container.appendChild(panel);\n    }\n\n    return container;\n};\n\n/**\n * this method is called by constructor (into method _initialize())\n * and check the rights to resources\n *\n * @private\n */\nElevationPath.prototype._checkRightsManagement = function() {\n    logger.trace(\"ElevationPath::_checkRightsManagement\");\n\n    var rightManagement = RightManagement.check({\n        key: this.options.apiKey,\n        resources: [\"SERVICE_CALCUL_ALTIMETRIQUE_RSC\"],\n        services: [\"Elevation\"]\n    });\n\n    if (!rightManagement) {\n        this._noRightManagement = true;\n    }\n\n    // on recupre les informations utiles\n    // sur ce controle, on ne s'occupe pas de la ressource car elle est unique...\n    // Ex. la clef API issue de l'autoconfiguration si elle n'a pas\n    // t renseigne.\n    if (!this.options.apiKey) {\n        this.options.apiKey = rightManagement.key;\n    }\n\n};\n\n// ################################################################### //\n// ###################### init styles ################################ //\n// ################################################################### //\n\n/**\n * create style marker object : \"ol.style\"\n *\n * @private\n */\nElevationPath.prototype._createStylingMarker = function() {\n    logger.trace(\"ElevationPath::_createStylingMarker \");\n\n    var marker = ElevationPath.DEFAULT_STYLES.MARKER;\n    logger.trace(\"style marker\", marker);\n\n    // si marker n'est pas un objet ol.style.Image, on applique le\n    // style par dfaut.\n    if (this.options.stylesOptions.marker instanceof ol.style.Image) {\n        marker = this.options.stylesOptions.marker;\n    }\n\n    this._markerStyle = new ol.style.Style({\n        image: marker\n    });\n};\n\n/**\n * create style draw object : \"ol.style\"\n *\n * @private\n */\nElevationPath.prototype._createStylingDraw = function() {\n    logger.trace(\"ElevationPath::_createStylingDraw\");\n\n    // on interprete les params pour y creer un objet ol.Style\n    var styles = this.options.stylesOptions.draw;\n\n    // style de depart\n    logger.trace(\"style start\", styles.start);\n\n    // Creation  partir des styles par dfaut\n    var startStyleOpts = {\n        image: Measures.DEFAULT_POINTER_STYLE,\n        stroke: Measures.DEFAULT_DRAW_START_STYLE.getStroke()\n    };\n    // ecrasement  partir des proprits renseignes\n    if (styles.hasOwnProperty(\"pointer\") && styles.pointer instanceof ol.style.Image) {\n        startStyleOpts.image = styles.pointer;\n    }\n    if (styles.hasOwnProperty(\"start\") && styles.start instanceof ol.style.Stroke) {\n        startStyleOpts.stroke = styles.start;\n    }\n\n    this._drawStyleStart = new ol.style.Style(startStyleOpts);\n\n    // style de fin\n    logger.trace(\"style finish\", styles.finish);\n\n    var finishStyleOpts = {\n        stroke: Measures.DEFAULT_DRAW_FINISH_STYLE.getStroke()\n    };\n    // ecrasement  partir des proprits renseignes\n    if (styles.hasOwnProperty(\"finish\") && styles.finish instanceof ol.style.Stroke) {\n        finishStyleOpts.stroke = styles.finish;\n    }\n\n    this._drawStyleFinish = new ol.style.Style(finishStyleOpts);\n};\n\n/**\n * create style graph\n * FIXME :  revoir car ne sert que pour AmCharts !?\n *\n * @private\n */\nElevationPath.prototype._createStylingProfile = function() {\n    logger.trace(\"ElevationPath::_createStylingProfile\");\n\n    var userStyles = this.options.stylesOptions.profile;\n\n    logger.trace(\"style profile\", userStyles);\n\n    var defaultStyle = ElevationPath.DEFAULT_STYLES.PROFILE;\n    Object.keys(defaultStyle).forEach(function(key) {\n\n        if (!userStyles.hasOwnProperty(key)) {\n            // si le style user n'existe pas, on ajoute celui par defaut\n            userStyles[key] = defaultStyle[key];\n            return;\n        } else {\n            var _defaultStyle = defaultStyle[key];\n            if (typeof _defaultStyle === \"object\") {\n                // on merge avec un objet,\n                // les styles user ecrasent ceux par defaut...\n                Utils.mergeParams(_defaultStyle, userStyles[key]);\n                userStyles[key] = _defaultStyle;\n                return;\n            }\n        }\n\n    }, this);\n};\n\n// ################################################################### //\n// ################### Map interactions management ################### //\n// ################################################################### //\n\n/**\n * this method is called by this.onShowElevationPathClick,\n * and initialize a vector layer, if widget is active.\n *\n * @param {ol.Map} map - Map\n * @private\n */\nElevationPath.prototype._initMeasureInteraction = function(map) {\n    logger.trace(\"ElevationPath::_initMeasureInteraction()\");\n\n    // var map = this.getMap();\n    if (!map) {\n        return;\n    }\n\n    this._measureSource = new ol.source.Vector();\n\n    this._measureVector = new ol.layer.Vector({\n        source: this._measureSource,\n        style: this._drawStyleFinish\n    });\n\n    map.addLayer(this._measureVector);\n};\n\n/**\n * this method is called by this.onShowElevationPathClick,\n * and add draw interaction to map, if widget is not active.\n *\n * @param {ol.Map} map - Map\n * @private\n */\nElevationPath.prototype._addMeasureInteraction = function(map) {\n    logger.trace(\"ElevationPath::_addMeasureInteraction()\");\n\n    // var map = this.getMap();\n    if (!map) {\n        return;\n    }\n\n    // Creates and adds the interaction\n    this._measureDraw = new ol.interaction.Draw({\n        source: this._measureSource,\n        type: \"LineString\",\n        style: this._drawStyleStart\n    });\n\n    this._measureDraw.setProperties({\n        name: \"ElevationPath\",\n        source: this\n    });\n\n    map.addInteraction(this._measureDraw);\n\n    // Event start\n    var self = this;\n    this._measureDraw.on(\"drawstart\", function(evt) {\n        logger.trace(\"drawstart\", evt);\n\n        // delete marker current\n        if (self._marker !== null) {\n            self._measureSource.removeFeature(self._marker);\n            self._marker = null;\n        }\n\n        // set new feature and remove last feature\n        if (self._lastSketch !== null) {\n            self._measureSource.removeFeature(self._lastSketch);\n            self._lastSketch = null;\n        }\n        self._currentSketch = evt.feature;\n\n        // and, all features\n        var _features = self._measureSource.getFeatures();\n        for (var i = 0; i < _features.length; i++) {\n            self._measureSource.removeFeature(_features[i]);\n        }\n\n    }, this);\n\n    // Event end\n    this._measureDraw.on(\"drawend\", function(evt) {\n        logger.trace(\"drawend\", evt);\n\n        // set feature\n        self._lastSketch = self._currentSketch;\n\n        // set an alti request and display results\n\n        // FIXME  revoir...\n        // Si il n'y a pas de surcharge utilisateur de la fonction de recuperation des\n        // resultats, on realise l'affichage du panneau\n        if (typeof self.options.elevationOptions.onSuccess === \"undefined\" && self.options.displayProfileOptions.target === null) {\n            self._panelContainer.style.display = \"block\";\n            // self._panelContainer.style.visibility = \"visible\";\n        }\n        self._requestService();\n    }, this);\n};\n\n/**\n * this method is called by this.onShowElevationPathClick,\n * and removes draw interaction from map (if exists)\n * And removes layer too...\n *\n * @param {ol.Map} map - Map\n * @private\n */\nElevationPath.prototype._removeMeasureInteraction = function(map) {\n    logger.trace(\"ElevationPath::_removeMeasureInteraction()\");\n\n    // var map = this.getMap();\n    if (!map) {\n        return;\n    }\n\n    if (this._measureVector) {\n        map.removeLayer(this._measureVector);\n        this._measureVector = null;\n    }\n\n    if (this._measureDraw) {\n        map.removeInteraction(this._measureDraw);\n        this._measureDraw = null;\n    }\n};\n\n// ################################################################### //\n// ############################ Alti request ######################### //\n// ################################################################### //\n\n/**\n * transforme geometry feature to position coordinate (service)\n *\n * @private\n */\nElevationPath.prototype._getGeometry = function() {\n\n    // INFO\n    // on transmet toujours des coordonnes au service en EPSG:4326\n\n    if (this._currentSketch === null) {\n        logger.warn(\"Current Feature undefined !?\");\n        return;\n    }\n\n    var geometry = [];\n\n    var map = this.getMap();\n    var projSrc = map.getView().getProjection();\n    var projDest = \"EPSG:4326\";\n    var coordinates = this._currentSketch.getGeometry().getCoordinates();\n    for (var i = 0; i < coordinates.length; i++) {\n        var xy = coordinates[i];\n        var ll = xy;\n        // on transmet au service des coordonnes en EPSG:4326\n        if (projSrc !== projDest) {\n            ll = ol.proj.transform(xy, projSrc, projDest);\n        }\n        geometry.push({\n            lon: ll[0],\n            lat: ll[1]\n        });\n    }\n\n    return geometry;\n};\n\n/**\n * get geometry feature length\n *\n * @private\n */\nElevationPath.prototype._getLength = function() {\n\n    if (this._currentSketch === null) {\n        logger.warn(\"Current Feature undefined !?\");\n        return;\n    }\n\n    var length = 0;\n\n    var wgs84Sphere = new ol.Sphere(6378137);\n\n    var map = this.getMap();\n    var projSrc = map.getView().getProjection();\n    var projDest = \"EPSG:4326\";\n\n    var coordinates = this._currentSketch.getGeometry().getCoordinates();\n    for (var i = 0, ii = coordinates.length - 1; i < ii; ++i) {\n        var c1 = ol.proj.transform(coordinates[i], projSrc, projDest);\n        var c2 = ol.proj.transform(coordinates[i + 1], projSrc, projDest);\n        length += wgs84Sphere.haversineDistance(c1, c2);\n    }\n\n    return length;\n};\n\n/**\n * this method is called at the end of the path,\n * it generates and sends alti request, then displays results\n *\n * @private\n */\nElevationPath.prototype._requestService = function() {\n    logger.trace(\"ElevationPath::_requestService\");\n\n    // les coordonnes sont obligatoires\n    var geometry = this._getGeometry();\n    logger.trace(\"geometry\", geometry);\n    if (!geometry) {\n        logger.warn(\"missing geometry !?\");\n        return;\n    }\n\n    // oups, aucun droits !\n    if (this._noRightManagement) {\n        logger.warn(\"no rights to this service !\");\n        return;\n    }\n\n    // on construit les options pour la requte\n    var options = {};\n\n    // on surcharge avec les options de l'utilisateur\n    Utils.mergeParams(options, this.options.elevationOptions);\n\n    // au cas o ...\n    Utils.mergeParams(options, {\n        apiKey: this.options.apiKey\n    });\n\n    // les callbacks\n    var self = this;\n\n    /** callback _requestServiceOnSuccess */\n    var _requestServiceOnSuccess = function(result) {\n        logger.trace(result);\n        if (result) {\n            self._panelContainer.style.display = \"block\";\n            // self._panelContainer.style.visibility = \"visible\";\n            self._displayProfile(result.elevations);\n            self._waitingContainer.className = \"GPelevationPathCalcWaitingContainerHidden\";\n            self._waiting = false;\n        }\n    };\n\n    /** callback _requestServiceOnFailure */\n    var _requestServiceOnFailure = function(error) {\n        // on ferme le panneau en cas d'erreur !\n        self._panelContainer.style.display = \"none\";\n        // self._panelContainer.style.visibility = \"hidden\";\n        logger.error(error.message);\n        self._waitingContainer.className = \"GPelevationPathCalcWaitingContainerHidden\";\n        self._waiting = false;\n    };\n\n    Utils.mergeParams(options, {\n        onSuccess: this.options.elevationOptions.onSuccess || _requestServiceOnSuccess,\n        onFailure: this.options.elevationOptions.onFailure || _requestServiceOnFailure\n    });\n\n    // le sampling est soit defini par l'utilisateur (opts),\n    // ou soit calcul dynamiquement...\n    var sampling = options.sampling;\n    if (!sampling) {\n\n        // computing sampling\n        var _sampling = 50;\n        var _length = this._getLength();\n        logger.trace(\"length\", _length);\n        var p = Math.floor(_length) / 5; // en mtre sur un pas moyen de 5m !\n        if (p >= 200) {\n            _sampling = 200;\n        } else {\n            _sampling = Math.floor(p);\n        }\n\n        Utils.mergeParams(options, {\n            sampling: _sampling || 50\n        });\n    }\n\n    // et enfin, la geometrie\n    Utils.mergeParams(options, {\n        positions: geometry\n    });\n\n    logger.trace(\"options du service\", options);\n\n    // mise en place de la patience\n    this._waitingContainer.className = \"GPelevationPathCalcWaitingContainerVisible\";\n\n    // Request altitude service\n    Gp.Services.getAltitude(options);\n};\n\n// ################################################################### //\n// ########################## Profil display ######################### //\n// ################################################################### //\n\n/**\n * this method computes results elevations (Z and distance)\n *\n * @param {Array} elevations - array of elevation\n * @return {Array} elevations\n * @private\n */\nElevationPath.prototype._computeElevationMeasure = function(elevations) {\n    logger.trace(\"ElevationPath::_computeElevationMeasure\", elevations);\n\n    var _data = elevations;\n\n    // FIXME facteur  2000 doit il etre une option ?\n    var _limite = 2000; // metres\n    var _unit = \"km\";\n    var _factor = 1000;\n    var _length = this._getLength();\n    if (_length < _limite) {\n        _factor = 1;\n        _unit = \"m\";\n    }\n\n    // Calcul de la distance au dpart pour chaque point + arrondi des lat/lon\n    _data[0].dist = 0;\n    _data[0].slope = 0;\n\n    var _distanceMinus = 0;\n    var _distancePlus = 0;\n    var _ascendingElevation = 0;\n    var _descendingElevation = 0;\n    var _distance = 0;\n    var _slopes = 0;\n\n    var wgs84Sphere = new ol.Sphere(6378137);\n\n    for (var i = 1; i < _data.length; i++) {\n\n        var a = [_data[i].lon, _data[i].lat];\n        var b = [_data[i - 1].lon, _data[i - 1].lat];\n        var dist = wgs84Sphere.haversineDistance(a, b);\n\n        var za = _data[i].z;\n        var zb = _data[i - 1].z;\n        if (za < 0) {\n            za = 0;\n        }\n        if (zb < 0) {\n            zb = 0;\n        }\n        var slope = za - zb;\n        if (slope < 0) {\n            _distanceMinus += dist;\n            _descendingElevation += slope;\n        } else if (slope > 0) {\n            _distancePlus += dist;\n            _ascendingElevation += slope;\n        }\n        _distance += dist / _factor;\n        _data[i].dist = _distance;\n\n        _slopes += (slope) ? Math.abs(Math.round(slope / dist * 100)) : 0;\n        _data[i].slope = (slope) ? Math.abs(Math.round(slope / dist * 100)) : 0;\n\n        // EVOL ?\n        // cf. gradiant\n        // http://www.color-hex.com/color/00b798\n        var value = _data[i].slope;\n        if (value > 15 && value < 30) {\n            _data[i].color = \"#005b4c\";\n        } else if (value > 30 && value < 45) {\n            _data[i].color = \"#00362d\";\n        } else if (value > 45) {\n            _data[i].color = \"#00120f\";\n        } else {\n            _data[i].color = \"#00B798\";\n        }\n\n        _data[i].lat = Math.round(_data[i].lat * 10000) / 10000;\n        _data[i].lon = Math.round(_data[i].lon * 10000) / 10000;\n    }\n\n    // Valeur du coeff d'arrondi des distances en fonction de la distance totale\n    var coeffArrond = 100;\n    if (_distance > 100) {\n        coeffArrond = 1;\n    } else if (_distance > 10) {\n        coeffArrond = 10;\n    }\n\n    // Correction arrondi distance totale\n    _distance = Math.round(_distance * coeffArrond) / coeffArrond;\n    _distanceMinus = Math.round(_distanceMinus * coeffArrond) / coeffArrond;\n    _distancePlus = Math.round(_distancePlus * coeffArrond) / coeffArrond;\n\n    // Correction des altitudes aberrantes + arrondi des calculs de distance + ...\n    var _altMin = _data[0].z;\n    var _altMax = _data[0].z;\n    var _greaterSlope = _data[0].slope;\n\n    for (var ji = 0; ji < _data.length; ji++) {\n        var d = _data[ji];\n        if (d.z < 0) {\n            d.z = 0;\n        }\n        if (d.z >= _altMax) {\n            _altMax = d.z;\n        }\n        if (d.z <= _altMin) {\n            _altMin = d.z;\n        }\n\n        d.dist = Math.round(d.dist * coeffArrond) / coeffArrond;\n        // FIXME erreur avec D3 car cette lib souhaite un numerique !\n        // d.dist = d.dist.toLocaleString();\n\n        if (d.slope > _greaterSlope) {\n            _greaterSlope = d.slope;\n        }\n    }\n\n    return {\n        greaterSlope: _greaterSlope, // pente max\n        meanSlope: Math.round(_slopes / _data.length), // pente moyenne\n        distancePlus: _distancePlus.toLocaleString(), // distance cumule positive\n        distanceMinus: _distanceMinus.toLocaleString(), // distance cumule ngative\n        ascendingElevation: _ascendingElevation, // dnivel cumule positive\n        descendingElevation: _descendingElevation, // dnivel cumule ngative\n        altMin: _altMin.toLocaleString(), // altitude min\n        altMax: _altMax.toLocaleString(), // altitude max\n        distance: _distance.toLocaleString(), // distance totale\n        unit: _unit, // unit des mesures de distance\n        points: _data\n    };\n};\n\n/**\n * this method is called after service request (in case of success)\n * and display results\n *\n * @param {Array} elevations - array of elevation\n * @private\n */\nElevationPath.prototype._displayProfile = function(elevations) {\n    logger.trace(\"ElevationPath::_displayProfile\", elevations);\n\n    // data\n    if (this._data) {\n        this._data = {};\n    }\n\n    // sauvegarde des donnes\n    var data = this._data = this._computeElevationMeasure(elevations);\n\n    // container\n    var container = this.options.displayProfileOptions.target;\n    if (container) {\n        container.appendChild(this._panelContainer);\n    }\n    container = this._profileContainer;\n\n    // TODO contexte ?\n    var context = this;\n\n    // fonction\n    var displayFunction = this.options.displayProfileOptions.apply;\n\n    // execution...\n    displayFunction.call(this, data, container, context);\n\n    var opts = this.options.displayProfileOptions;\n    var element = document.getElementById(\"GPelevationPathPanelInfo-\" + this._uid);\n    if (element) {\n        if (opts.greaterSlope ||\n            opts.meanSlope ||\n            opts.ascendingElevation ||\n            opts.descendingElevation) {\n            // on affiche les informations\n            element.style.display = \"block\";\n        }\n    }\n\n};\n\n// ################################################################### //\n// ####################### handlers events to dom #################### //\n// ################################################################### //\n\n/**\n * this method is called by event 'click' on '' picto\n * and enable or disable the entry of the path\n *\n * @private\n */\nElevationPath.prototype.onShowElevationPathClick = function() {\n\n    var map = this.getMap();\n    Interactions.unset(map, {\n        current: \"ElevationPath\"\n    });\n\n    // Activation/Desactivation des interactions de dessins\n    if (!this._showContainer.checked) {\n        // on n'affiche pas la fenetre de profile s'il n'existe pas...\n        if (this._profile === null) {\n            this._panelContainer.style.display = \"none\";\n            // this._panelContainer.style.visibility = \"hidden\";\n        }\n        this._initMeasureInteraction(map);\n        this._addMeasureInteraction(map);\n    } else {\n        this._panelContainer.style.display = \"none\";\n        // this._panelContainer.style.visibility = \"hidden\";\n        this._removeMeasure();\n        this._removeProfile();\n        this._removeMeasureInteraction(map);\n    }\n};\n\n/**\n * this method is called by event 'click' on '' picto\n * (cf. this.),\n * and display the panel info\n *\n * @private\n */\nElevationPath.prototype.onOpenElevationPathInfoClick = function() {\n\n    // options d'affichage\n    var meanSlope = this.options.displayProfileOptions.meanSlope;\n    var greaterSlope = this.options.displayProfileOptions.greaterSlope;\n    var ascendingElevation = this.options.displayProfileOptions.ascendingElevation;\n    var descendingElevation = this.options.displayProfileOptions.descendingElevation;\n\n    // clean\n    var div = this._infoContainer;\n    if (div.childElementCount) {\n        while (div.firstChild) {\n            div.removeChild(div.firstChild);\n        }\n    }\n\n    // creation des infomations\n\n    if (ascendingElevation) {\n        this._addElevationPathInformationsItem(\"Dnivel positif : \" + this._data.ascendingElevation.toLocaleString() + \" m\");\n    }\n\n    if (descendingElevation) {\n        this._addElevationPathInformationsItem(\"Dnivel ngatif : \" + this._data.descendingElevation.toLocaleString() + \" m\");\n    }\n\n    if (meanSlope) {\n        this._addElevationPathInformationsItem(\"Pente moyenne : \" + this._data.meanSlope.toLocaleString() + \" %\");\n    }\n\n    if (greaterSlope) {\n        this._addElevationPathInformationsItem(\"Plus forte pente : \" + this._data.greaterSlope.toLocaleString() + \" %\");\n    }\n\n    // show des informations !\n    if (div.className === \"GPelevationPathInformationsContainerVisible\") {\n        clearTimeout(this._timerHdlr);\n        div.className = \"GPelevationPathInformationsContainerHidden\";\n    } else {\n        div.className = \"GPelevationPathInformationsContainerVisible\";\n    }\n\n    // hidden des informations !\n    this._timerHdlr = setTimeout(function() {\n        div.className = \"GPelevationPathInformationsContainerHidden\";\n    }, 4000);\n\n};\n\nexport default ElevationPath;\n\n\n\n// WEBPACK FOOTER //\n// ./src/OpenLayers/Controls/ElevationPath.js","var MeasureToolBoxDOM = {\n\n    _toolboxId: \"GPtoolbox-measure-main\",\n    _buttonId: \"GPtoolbox-measure-button\",\n    _widgetId: \"GPtoolbox-measure-widget\",\n\n    /** get toolBox ID */\n    getToolBoxID: function(uid) {\n        return (uid) ? this._toolboxId + \"-\" + uid : this._toolboxId;\n    },\n\n    /** get toolBox ID */\n    getButtonID: function(uid) {\n        return (uid) ? this._buttonId + \"-\" + uid : this._buttonId;\n    },\n\n    /** get toolBox Container for widget */\n    getWidgetID: function(uid) {\n        return (uid) ? this._widgetId + \"-\" + uid : this._widgetId;\n    },\n\n    /**\n     * Main container (DOM)\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createToolBoxContainerElement: function(uid) {\n\n        // <div id=\"GPtoolbox-measure-main\">\n        //   <button id=\"GPtoolbox-measure-button\">&#9776;</button>\n        //   <div id=\"GPtoolbox-measure-widget\">\n        //     <!-- HERE : widgets tools measures -->\n        //   </div>\n        // </div>\n        var container = document.createElement(\"div\");\n        container.id = this.getToolBoxID(uid);\n        container.className = \"GPshowAdvancedToolPicto\";\n\n        var button = document.createElement(\"button\");\n        button.id = this.getButtonID(uid);\n        var self = this;\n        button.addEventListener(\"click\", function() {\n            this.blur(); // permet de perdre le focus !\n            var widget = document.getElementById(self.getWidgetID(uid));\n            if (widget.style.display === \"block\") {\n                widget.style.display = \"none\";\n            } else {\n                widget.style.display = \"block\";\n            }\n        });\n        container.appendChild(button);\n\n        var widget = document.createElement(\"div\");\n        widget.id = this.getWidgetID(uid);\n        widget.addEventListener(\"click\", function() {\n\n            /*\n                e.preventDefault();\n\n                // FIXME desactiver tous les outils sur\n                // l'ouverture/fermeture de la toolbox ?\n\n                var current = e.target.parentNode.getAttribute(\"for\");\n                var widgets = this.querySelectorAll(\"div > input\");\n                for (var i = 0; i < widgets.length; i++) {\n                    var id = widgets[i].id;\n\n                    if (document.getElementById(id) &&\n                        document.getElementById(id).checked &&\n                        document.querySelector(\"#\" + id + \" + label\")) {\n                            document.querySelector(\"#\" + id + \" + label\").click();\n                            // document.getElementById(id).checked = true;\n                    }\n\n                    if (current === id && widgets[i].checked) {\n                        widgets[i].checked = false;\n                    } else if (current === id && !widgets[i].checked) {\n                        widgets[i].checked = true;\n                    }\n                }\n            */\n\n        }, false);\n\n        container.appendChild(widget);\n\n        return container;\n    }\n};\n\nexport default MeasureToolBoxDOM;\n\n\n\n// WEBPACK FOOTER //\n// ./src/Common/Controls/MeasureToolBoxDOM.js","var ElevationPathDOM = {\n\n    /** Add uuid to the tag ID */\n    _addUID: function(id) {\n        var uid = (this._uid) ? id + \"-\" + this._uid : id;\n        return uid;\n    },\n\n    /**\n     * Main container (DOM)\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createMainContainerElement: function() {\n\n        var container = document.createElement(\"div\");\n        container.id = this._addUID(\"GPelevationPath\");\n        container.className = \"GPwidget\";\n        return container;\n    },\n\n    // ################################################################### //\n    // ################# Methods to display Main Panel ################### //\n    // ################################################################### //\n\n    /**\n     * Hidden checkbox for minimizing/maximizing panel\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createShowElevationPathElement: function() {\n        var input = document.createElement(\"input\");\n        input.id = this._addUID(\"GPshowElevationPath\");\n        input.type = \"checkbox\";\n        return input;\n    },\n\n    /**\n     * Show control\n     * see event !\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createShowElevationPathPictoElement: function() {\n\n        // contexte d'execution\n        var context = this;\n\n        var label = document.createElement(\"label\");\n        label.id = this._addUID(\"GPshowElevationPathPicto\");\n        label.className = \"GPshowAdvancedToolPicto\";\n        label.htmlFor = this._addUID(\"GPshowElevationPath\");\n        label.title = \"Calculer un profil\";\n\n        // gestionnaire d'evenement :\n        // on ouvre le menu de saisie de saisie\n        // L'ouverture/Fermeture permet de faire le menage\n        // (reinitialisation)\n        if (label.addEventListener) {\n            label.addEventListener(\"click\", function(e) {\n                context.onShowElevationPathClick(e);\n            });\n        } else if (label.attachEvent) {\n            label.attachEvent(\"onclick\", function(e) {\n                context.onShowElevationPathClick(e);\n            });\n        }\n\n        var spanOpen = document.createElement(\"span\");\n        spanOpen.id = this._addUID(\"GPshowElevationPathOpen\");\n        spanOpen.className = \"GPshowAdvancedToolOpen\";\n        label.appendChild(spanOpen);\n\n        return label;\n    },\n\n    // ################################################################### //\n    // ######################### Methods to Panel ######################## //\n    // ################################################################### //\n\n    /**\n     * Create Container Panel\n     *\n     * FIXME\n     * don't call this._createElevationPathPanelHeaderElement\n     * don't call this._createElevationPathPanelProfilElement\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createElevationPathPanelElement: function() {\n        var div = document.createElement(\"div\");\n        div.id = this._addUID(\"GPelevationPathPanel\");\n        div.className = \"GPpanel\";\n\n        // div.appendChild(this._createElevationPathPanelHeaderElement());\n        // div.appendChild(this._createElevationPathPanelProfilElement());\n\n        return div;\n    },\n\n    /**\n     * Create Header Panel\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createElevationPathPanelHeaderElement: function() {\n\n        var self = this;\n\n        var container = document.createElement(\"div\");\n        container.className = \"GPpanelHeader\";\n\n        var divInfo = document.createElement(\"div\");\n        divInfo.id = this._addUID(\"GPelevationPathPanelInfo\");\n        divInfo.className = \"GPpanelInfo\";\n        divInfo.title = \"Informations\";\n        // add event on click\n        if (divInfo.addEventListener) {\n            divInfo.addEventListener(\n                \"click\",\n                function() {\n                    self.onOpenElevationPathInfoClick();\n                }\n            );\n        } else if (divInfo.attachEvent) {\n            // internet explorer\n            divInfo.attachEvent(\n                \"onclick\",\n                function() {\n                    self.onOpenElevationPathInfoClick();\n                }\n            );\n        }\n        container.appendChild(divInfo);\n\n        var divTitle = document.createElement(\"div\");\n        divTitle.className = \"GPpanelTitle\";\n        divTitle.innerHTML = \"Profil Altimtrique\";\n        container.appendChild(divTitle);\n\n        var divReduce = document.createElement(\"div\");\n        divReduce.id = this._addUID(\"GPelevationPathPanelReduce\");\n        divReduce.className = \"GPpanelReduce\";\n        divReduce.title = \"Masquer le panneau\";\n\n        if (divReduce.addEventListener) {\n            divReduce.addEventListener(\"click\", function() {\n                if (typeof self.onReduceElevationPathPanelClick === \"function\") {\n                    document.getElementById(self._addUID(\"GPshowElevationPath\")).checked = false;\n                    self.onReduceElevationPathPanelClick();\n                }\n            }, false);\n        } else if (divReduce.attachEvent) {\n            divReduce.attachEvent(\"onclick\", function() {\n                if (typeof self.onReduceElevationPathPanelClick === \"function\") {\n                    document.getElementById(self._addUID(\"GPshowElevationPath\")).checked = false;\n                    self.onReduceElevationPathPanelClick();\n                }\n            });\n        }\n        container.appendChild(divReduce);\n\n        var divClose = document.createElement(\"div\");\n        divClose.id = this._addUID(\"GPelevationPathPanelClose\");\n        divClose.className = \"GPpanelClose\";\n        divClose.title = \"Fermer le panneau\";\n\n        // Link panel close / visibility checkbox\n        if (divClose.addEventListener) {\n            divClose.addEventListener(\"click\", function() {\n                document.getElementById(self._addUID(\"GPshowElevationPathPicto\")).click();\n            }, false);\n        } else if (divClose.attachEvent) {\n            divClose.attachEvent(\"onclick\", function() {\n                document.getElementById(self._addUID(\"GPshowElevationPathPicto\")).click();\n            });\n        }\n        container.appendChild(divClose);\n\n        return container;\n    },\n\n    /**\n     * Create Form\n     * see evenement !\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createElevationPathPanelProfilElement: function() {\n\n        var div = document.createElement(\"div\");\n        div.id = \"GPelevationPathProfil\";\n\n        return div;\n    },\n\n    /**\n     * Create Waiting Panel\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createElevationPathWaitingElement: function() {\n        var div = document.createElement(\"div\");\n        div.id = this._addUID(\"GPelevationPathCalcWaitingContainer\");\n        div.className = \"GPelevationPathCalcWaitingContainerHidden\";\n\n        var p = document.createElement(\"p\");\n        p.className = \"GPelevationPathCalcWaiting\";\n        p.innerHTML = \"Calcul en cours...\";\n\n        div.appendChild(p);\n\n        return div;\n    },\n\n    /**\n     * Create information Panel\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createElevationPathInformationsElement: function() {\n\n        var div = document.createElement(\"div\");\n        div.id = this._addUID(\"GPelevationPathInformationsContainer\");\n        div.className = \"GPelevationPathInformationsContainerHidden\";\n\n        var p = document.createElement(\"p\");\n        p.className = \"GPelevationPathInformations\";\n        p.innerHTML = \"Aucune information...\";\n        div.appendChild(p);\n\n        return div;\n    },\n\n    /**\n     * Add a information into Panel\n     *\n     * @param {String} value - value of item\n     * @returns {DOMElement} DOM element\n     */\n    _addElevationPathInformationsItem: function(value) {\n\n        var div = document.getElementById(this._addUID(\"GPelevationPathInformationsContainer\"));\n\n        if (div) {\n            var p = document.createElement(\"p\");\n            p.className = \"GPelevationPathInformations\";\n            p.innerHTML = value;\n            div.appendChild(p);\n        }\n\n        return div;\n\n    }\n};\n\nexport default ElevationPathDOM;\n\n\n\n// WEBPACK FOOTER //\n// ./src/Common/Controls/ElevationPathDOM.js","/* globals AmCharts, d3 */\nvar ProfileElevationPathDOM = {\n\n    /**\n     * Display Profile function used by default : no additonal framework needed.\n     * @param {Object} data - elevations values for profile\n     * @param {HTMLElement} container - html container where to display profile\n     * @param {Object} context - this control object\n     * @param {Object} className - calling class (ie ElevationPath)\n     */\n    displayProfileByDefault: function(data, container, context, className) {\n\n        var self = context;\n\n        // on nettoie toujours...\n        if (container) {\n            while (container.firstChild) {\n                container.removeChild(container.firstChild);\n            }\n        }\n\n        if (!data) {\n            return;\n        }\n\n        var _displayProfileOptions = self.options.displayProfileOptions;\n\n        var _points = data.points;\n\n        var sortedElev = JSON.parse(JSON.stringify(_points));\n        sortedElev.sort(function(e1, e2) {\n            return e1.z - e2.z;\n        });\n\n        var minZ = sortedElev[0].z;\n        var maxZ = sortedElev[sortedElev.length - 1].z;\n        var diff = maxZ - minZ;\n        var dist = data.distance;\n        var unit = data.unit;\n        // var distMin = 0;\n        var barwidth = 100 / _points.length;\n\n        var div = document.createElement(\"div\");\n        div.id = \"profileElevationByDefault\";\n        container.appendChild(div);\n\n        var divBox = document.createElement(\"div\");\n        divBox.className = \"profile-box\";\n\n        var divZ = document.createElement(\"div\");\n        divZ.className = \"profile-z-vertical\";\n        var ulZ = document.createElement(\"ul\");\n        var liZmin = document.createElement(\"li\");\n        liZmin.setAttribute(\"class\", \"profile-min-z\");\n        liZmin.innerHTML = minZ + \" m\";\n        var liZmax = document.createElement(\"li\");\n        liZmax.setAttribute(\"class\", \"profile-max-z\");\n        liZmax.innerHTML = maxZ + \" m\";\n\n        // var divUnit = document.createElement(\"div\");\n        // divUnit.className = \"profile-unit\";\n        // divUnit.innerHTML = \"m\";\n\n        ulZ.appendChild(liZmax);\n        ulZ.appendChild(liZmin);\n        divZ.appendChild(ulZ);\n        // divZ.appendChild(divUnit);\n        divBox.appendChild(divZ);\n\n        var divData = document.createElement(\"div\");\n        divData.className = \"profile-content\";\n        divData.addEventListener(\"mouseover\", function(e) {\n\n            var _lon = parseFloat(e.target.dataset[\"lon\"]);\n            var _lat = parseFloat(e.target.dataset[\"lat\"]);\n\n            if (_lon && _lat) {\n                className.__createProfileMarker(self, {\n                    lat: _lat,\n                    lon: _lon\n                });\n            }\n        });\n        divData.addEventListener(\"mousemove\", function(e) {\n            var _lon = parseFloat(e.target.dataset[\"lon\"]);\n            var _lat = parseFloat(e.target.dataset[\"lat\"]);\n\n            if (_lon && _lat) {\n                className.__updateProfileMarker(self, {\n                    lat: _lat,\n                    lon: _lon\n                });\n            }\n        });\n        divData.addEventListener(\"mouseout\", function() {\n            className.__removeProfileMarker(self);\n        });\n\n        var ulData = document.createElement(\"ul\");\n        ulData.id = \"profile-data\";\n        ulData.className = \"profile-z-axis profile-x-axis\";\n        divData.appendChild(ulData);\n\n        for (var i = 0; i < _points.length; i++) {\n            var d = _points[i];\n            var li = document.createElement(\"li\");\n            li.setAttribute(\"data-z\", d.z);\n            li.setAttribute(\"data-lon\", d.lon);\n            li.setAttribute(\"data-lat\", d.lat);\n            li.setAttribute(\"data-dist\", d.dist);\n\n            var pct = Math.floor((d.z - minZ) * 100 / diff);\n            li.setAttribute(\"class\", \"percent v\" + pct);\n            li.title = \"Altitude : \" + d.z + \"m\";\n            if (_displayProfileOptions.currentSlope) {\n                li.title += \" - Pente : \" + d.slope + \"%\";\n            }\n            li.title += \" (Lat : \" + d.lat + \" / Lon : \" + d.lon + \")\";\n\n            li.setAttribute(\"style\", \"width: \" + barwidth + \"%\");\n            ulData.appendChild(li);\n        }\n\n        divBox.appendChild(divData);\n        div.appendChild(divBox);\n\n        var divX = document.createElement(\"div\");\n        divX.className = \"profile-x-horizontal\";\n        var ulX = document.createElement(\"ul\");\n        var liXmin = document.createElement(\"li\");\n        liXmin.setAttribute(\"class\", \"profile-min-x\");\n        liXmin.innerHTML = \"\";\n        var liXmax = document.createElement(\"li\");\n        liXmax.setAttribute(\"class\", \"profile-max-x\");\n        liXmax.innerHTML = dist + \" \" + unit;\n        ulX.appendChild(liXmin);\n        ulX.appendChild(liXmax);\n        divX.appendChild(ulX);\n        div.appendChild(divX);\n\n        return container;\n    },\n\n    /**\n     * Display Profile without graphical rendering (raw service response)\n     * @param {Object} data - elevations values for profile\n     * @param {HTMLElement} container - html container where to display profile\n     * @param {Object} context - this control object\n     * @param {Object} className - calling class (ie ElevationPath)\n     */\n    displayProfileRaw: function(data, container, context, className) {\n\n        // on nettoie toujours...\n        if (container) {\n            while (container.firstChild) {\n                container.removeChild(container.firstChild);\n            }\n        }\n\n        var _points = data.points;\n\n        var div = document.createElement(\"textarea\");\n        div.id = \"profilElevationResults\";\n        div.rows = 10;\n        div.cols = 50;\n        div.style.width = \"100%\";\n        div.innerHTML = JSON.stringify(_points, undefined, 4);\n        div.addEventListener(\"mouseover\", function(e) {\n            className.__customRawProfileMouseOverEvent(context, e);\n        });\n\n        // TODO\n        // for (var i = 0; i < _points.length; i++) {\n        //     var point = _points[i];\n        //     var divC  = document.createElement(\"code\");\n        //     divC.id = \"point_\" + i;\n        //     divC.innerHTML = JSON.stringify(point, undefined, 4);\n        //     div.appendChild(divC);\n        //     divC.addEventListener(\"mouseover\", function (e) {\n        //          className.__customRawProfileMouseOverEvent(context, e);\n        //     });\n        // }\n\n        container.appendChild(div);\n\n        return container;\n    },\n\n    /**\n     * Display Profile using D3 javascript framework. This method needs D3 libraries to be loaded.\n     * @param {Object} data - elevations values for profile\n     * @param {HTMLElement} container - html container where to display profile\n     * @param {Object} context - this control object\n     * @param {Object} className - calling class (ie ElevationPath)\n     */\n    displayProfileLibD3: function(data, container, context, className) {\n\n        var self = context;\n\n        // on nettoie toujours...\n        if (container) {\n            while (container.firstChild) {\n                container.removeChild(container.firstChild);\n            }\n        }\n\n        var _points = data.points;\n\n        var _displayProfileOptions = self.options.displayProfileOptions;\n\n        var margin = {\n            top: 20,\n            right: 20,\n            bottom: 30,\n            left: 40\n        };\n\n        var width = container.clientWidth - margin.left - margin.right;\n        var height = container.clientHeight - margin.top - margin.bottom;\n\n        var x = d3.scale.linear()\n            .range([0, width]);\n\n        var y = d3.scale.linear()\n            .range([height, 0]);\n\n        var xAxis = d3.svg.axis()\n            .scale(x)\n            .orient(\"bottom\")\n            .ticks(5);\n\n        var yAxis = d3.svg.axis()\n            .scale(y)\n            .orient(\"left\")\n            .ticks(5);\n\n        var line = d3.svg.line()\n            .interpolate(\"basis\")\n            .x(function(d) {\n                return x(d.dist);\n            })\n            .y(function(d) {\n                return y(d.z);\n            });\n\n        var area = d3.svg.area()\n            .interpolate(\"basis\")\n            .x(function(d) {\n                return x(d.dist);\n            })\n            .y0(height)\n            .y1(function(d) {\n                return y(d.z);\n            });\n\n        var svg = d3.select(container)\n            .append(\"svg\")\n            .attr(\"width\", width + margin.left + margin.right)\n            .attr(\"height\", height + margin.top + margin.bottom)\n            .append(\"g\")\n            .attr(\"transform\", \"translate(\" + margin.left + \",\" + margin.top + \")\");\n\n        var xDomain = d3.extent(_points, function(d) {\n            return d.dist;\n        });\n        x.domain(xDomain);\n\n        var yDomain = [\n            0,\n            d3.max(_points, function(d) {\n                return d.z;\n            })\n        ];\n        y.domain(yDomain);\n\n        svg.append(\"path\")\n            .datum(_points)\n            .attr(\"class\", \"area-d3\")\n            .attr(\"d\", area);\n\n        svg.append(\"g\")\n            .attr(\"class\", \"x axis-d3\")\n            .attr(\"transform\", \"translate(0,\" + height + \")\")\n            .call(xAxis)\n            .append(\"text\")\n            .attr(\"y\", -15)\n            .attr(\"dy\", \".71em\")\n            .attr(\"x\", width)\n            .text(\"Distance (\" + data.unit + \")\");\n\n        svg.append(\"g\")\n            .attr(\"class\", \"y axis-d3\")\n            .call(yAxis)\n            .append(\"text\")\n            .attr(\"transform\", \"rotate(-90)\")\n            .attr(\"y\", 6)\n            .attr(\"dy\", \".71em\")\n            .text(\"Altitude (m)\");\n\n        svg.append(\"g\")\n            .attr(\"class\", \"grid-d3 vertical\")\n            .attr(\"transform\", \"translate(0,\" + height + \")\")\n            .call(xAxis\n                .orient(\"bottom\")\n                .tickSize(-height, 0, 0)\n                .tickFormat(\"\")\n            );\n\n        svg.append(\"g\")\n            .attr(\"class\", \"grid-d3 horizontal\")\n            .call(yAxis\n                .orient(\"left\")\n                .tickSize(-width, 0, 0)\n                .tickFormat(\"\")\n            );\n\n        svg.append(\"path\")\n            .datum(_points)\n            .attr(\"class\", \"line-d3\")\n            .attr(\"d\", line);\n\n        svg.selectAll(\"circle\")\n            .data(_points)\n            .enter()\n            .append(\"circle\")\n            .attr(\"cx\", function(d) {\n                return x(d.dist);\n            })\n            .attr(\"cy\", function(d) {\n                return y(d.z);\n            })\n            .attr(\"r\", 0)\n            .attr(\"class\", \"circle-d3\");\n\n        var focus = svg.append(\"g\").style(\"display\", \"none\");\n\n        focus.append(\"line\")\n            .attr(\"id\", \"focusLineX\")\n            .attr(\"class\", \"focusLine-d3\");\n        focus.append(\"line\")\n            .attr(\"id\", \"focusLineY\")\n            .attr(\"class\", \"focusLine-d3\");\n        focus.append(\"circle\")\n            .attr(\"id\", \"focusCircle\")\n            .attr(\"r\", 4)\n            .attr(\"class\", \"circle-d3 focusCircle-d3\");\n\n        var div = d3.select(container).append(\"div\")\n            .attr(\"class\", \"tooltip-d3\")\n            .style(\"opacity\", 0);\n\n        var bisectDist = d3.bisector(function(d) {\n            return d.dist;\n        }).left;\n\n        svg.append(\"rect\")\n            .attr(\"class\", \"overlay-d3\")\n            .attr(\"width\", width)\n            .attr(\"height\", height)\n            .on(\"mouseover\", function() {\n                focus.style(\"display\", null);\n                className.__createProfileMarker(self, _points[0]);\n            })\n            .on(\"mouseout\", function() {\n                focus.style(\"display\", \"none\");\n                className.__removeProfileMarker(self);\n\n                // tooltips\n                div.transition()\n                    .duration(500)\n                    .style(\"opacity\", 0);\n            })\n            .on(\"mousemove\", function() {\n\n                var m = d3.mouse(this);\n                var distance = x.invert(m[0]);\n                var i = bisectDist(_points, distance);\n\n                var d0 = _points[i - 1];\n                var d1 = _points[i];\n                var d = distance - d0[0] > d1[0] - distance ? d1 : d0;\n\n                var xc = x(d.dist);\n                var yc = y(d.z);\n\n                focus.select(\"#focusCircle\")\n                    .attr(\"cx\", xc)\n                    .attr(\"cy\", yc);\n                focus.select(\"#focusLineX\")\n                    .attr(\"x1\", xc).attr(\"y1\", y(yDomain[0]))\n                    .attr(\"x2\", xc).attr(\"y2\", y(yDomain[1]));\n                focus.select(\"#focusLineY\")\n                    .attr(\"x1\", x(xDomain[0])).attr(\"y1\", yc)\n                    .attr(\"x2\", x(xDomain[1])).attr(\"y2\", yc);\n\n                className.__updateProfileMarker(self, d);\n\n                // tooltips\n                div.transition()\n                    .duration(200)\n                    .style(\"opacity\", 0.9);\n\n                var _message = \"\";\n                _message += \" Altitude : \" + d.z + \" m\";\n                if (_displayProfileOptions.currentSlope) {\n                    _message += \"<br/> Pente : \" + d.slope + \" %\";\n                }\n                _message += \"<br/> (Lat : \" + d.lat + \"/ Lon : \" + d.lon + \")\";\n\n                div.html(_message)\n                    .style(\"left\", (d3.event.pageX) + \"px\")\n                    .style(\"top\", (d3.event.pageY - 28) + \"px\");\n            });\n\n        // return d3.selectAll(\"rect.overlay\")[0][0];\n        return svg;\n    },\n\n    /**\n     * Display Profile using Amcharts framework. This method needs AmCharts libraries to be loaded.\n     * @param {Object} data - elevations values for profile\n     * @param {HTMLElement} container - html container where to display profile\n     * @param {Object} context - this control object\n     * @param {Object} className - calling class (ie ElevationPath)\n     */\n    displayProfileLibAmCharts: function(data, container, context, className) {\n\n        var self = context;\n\n        var _points = data.points;\n\n        var ballonText = \"<span class='altiPathValue'>[[title]] : [[value]]m</span><br/>\";\n        var currentSlope = self.options.displayProfileOptions.currentSlope;\n        if (currentSlope) {\n            ballonText += \"<span class='altiPathValue'>Pente : [[slope]] %</span><br/>\";\n        }\n        ballonText += \"<span class='altiPathCoords'>(Lat: [[lat]] / Lon:[[lon]])</span>\";\n\n        AmCharts.addInitHandler(function() {});\n\n        var settings = {\n            type: \"serial\",\n            pathToImages: \"http://cdn.amcharts.com/lib/3/images/\",\n            categoryField: \"dist\",\n            autoMarginOffset: 0,\n            marginRight: 10,\n            marginTop: 10,\n            startDuration: 0,\n            color: \"#5E5E5E\",\n            fontSize: 8,\n            theme: \"light\",\n            thousandsSeparator: \"\",\n            numberFormatter: {\n                precision: -1,\n                decimalSeparator: \",\",\n                thousandsSeparato: \" \"\n            },\n            categoryAxis: {\n                color: \"#5E5E5E\",\n                gridPosition: \"start\",\n                minHorizontalGap: 40,\n                tickPosition: \"start\",\n                title: \"Distance (\" + data.unit + \")\",\n                titleColor: \"#5E5E5E\",\n                labelOffset: 0,\n                startOnAxis: true\n            },\n            chartCursor: {\n                animationDuration: 0,\n                bulletsEnabled: true,\n                bulletSize: 10,\n                categoryBalloonEnabled: false,\n                cursorColor: \"#F90\",\n                graphBulletAlpha: 1,\n                graphBulletSize: 1,\n                zoomable: false\n            },\n            trendLines: [],\n            graphs: [{\n                balloonColor: \"#CCCCCC\",\n                balloonText: ballonText,\n                bullet: \"round\",\n                bulletAlpha: 0,\n                bulletBorderColor: \"#FFF\",\n                bulletBorderThickness: 2,\n                bulletColor: \"#F90\",\n                bulletSize: 6,\n                hidden: false,\n                id: \"AmGraph-1\",\n                fillAlphas: 0.4,\n                fillColors: \"#C77A04\",\n                lineAlpha: 1,\n                lineColor: \"#C77A04\",\n                lineThickness: 1,\n                title: \"Altitude\",\n                valueField: \"z\"\n            }],\n            guides: [],\n            valueAxes: [{\n                id: \"ValueAxis-1\",\n                minVerticalGap: 20,\n                title: \"Altitude (m)\"\n            }],\n            balloon: {\n                borderColor: \"#CCCCCC\",\n                borderThickness: 1,\n                fillColor: \"#FFFFFF\",\n                showBullet: true\n            },\n            titles: [],\n            allLabels: [],\n            dataProvider: _points\n        };\n\n        var _containerProfile = AmCharts.makeChart(container, settings);\n\n        _containerProfile.addListener(\"changed\", function(e) {\n            var obj = e.chart.dataProvider[e.index];\n            className.__updateProfileMarker(self, obj);\n        });\n\n        return _containerProfile;\n\n    }\n};\n\nexport default ProfileElevationPathDOM;\n\n\n\n// WEBPACK FOOTER //\n// ./src/Common/Controls/ProfileElevationPathDOM.js","import ol from \"ol\";\nimport Logger from \"../../../Common/Utils/LoggerByDefault\";\nimport Utils from \"../../../Common/Utils\";\nimport MeasureToolBox from \"../MeasureToolBox\";\nimport Measures from \"./Measures\";\nimport MeasureLengthDOM from \"../../../Common/Controls/MeasureLengthDOM\";\nimport ID from \"../../../Common/Utils/SelectorID\";\n\n// Derived from OpenLayers measure example\n// http://openlayers.org/en/latest/examples/measure.html\n\n\nvar logger = Logger.getLogger(\"measurelength\");\n\n/**\n * @classdesc\n *\n * Length measurement Control. Allows users to draw a path on OL3 map and have its length computed and displayed.\n *\n * @constructor\n * @alias ol.control.MeasureLength\n * @extends {ol.control.Control}\n * @param {Object} options - options for function call.\n * @param {Boolean} [options.geodesic = true] - If true, length will be computed on the global sphere using the {@link https://openlayers.org/en/latest/apidoc/ol.Sphere.html#haversineDistance ol.Sphere.haversineDistance()} function. Otherwise, length will be computed on the projected plane.\n * @param {Object} [options.styles = {}] - styles used when drawing. Specified with following properties.\n * @param {Object} [options.styles.pointer = {}] - Style for mouse pointer when drawing the path. Specified with an {@link https://openlayers.org/en/latest/apidoc/ol.style.Image.html ol.style.Image} subclass object.\n * @param {Object} [options.styles.start = {}] - Line Style when drawing. Specified with an {@link https://openlayers.org/en/latest/apidoc/ol.style.Style.html ol.style.Style} object.\n * @param {Object} [options.styles.finish = {}] - Line Style when finished drawing. Specified with an {@link https://openlayers.org/en/latest/apidoc/ol.style.Style.html ol.style.Style} object.\n * <!-- @param {Object} [options.tooltip = {}] - NOT YET IMPLEMENTED ! -->\n * @example\n * var measureLength = new ol.control.MeasureLength({\n *    geodesic : false\n * });\n */\nfunction MeasureLength(options) {\n\n    // options\n    options = options || {};\n\n    if (!(this instanceof MeasureLength)) {\n        throw new TypeError(\"ERROR CLASS_CONSTRUCTOR\");\n    }\n\n    // Nom de la classe (heritage)\n    this.CLASSNAME = \"MeasureLength\";\n\n    // uuid\n    this._uid = ID.generate();\n\n    // container d'activation du controle\n    this._showContainer = null;\n    this._pictoContainer = null;\n\n    // initialisation du composant\n    this._initialize(options);\n\n    // creation du DOM container\n    var container = (options.element) ? options.element : this._initializeContainer();\n\n    // heritage\n    ol.control.Control.call(this, {\n        element: container,\n        target: options.target,\n        render: options.render\n    });\n\n}\n\n// heritage avec ol.control.Control\nol.inherits(MeasureLength, ol.control.Control);\n\n/**\n * @lends module:MeasureLength\n */\nMeasureLength.prototype = Object.create(ol.control.Control.prototype, {});\n\n// on rcupre les mixins de la classe \"MeasureLengthDOM\" ainsi que celles\n// de \"Measures\".\nUtils.assign(MeasureLength.prototype, Measures);\nUtils.assign(MeasureLength.prototype, MeasureLengthDOM);\n\n/**\n * Constructor (alias)\n * @private\n */\nMeasureLength.prototype.constructor = MeasureLength;\n\n// ################################################################### //\n// ##################### public methods ############################## //\n// ################################################################### //\n\n/**\n * Overwrite OpenLayers setMap method\n *\n * @param {ol.Map} map - Map.\n */\nMeasureLength.prototype.setMap = function(map) {\n    logger.trace(\"setMap()\");\n\n    var className = this.CLASSNAME;\n\n    // on fait le choix de ne pas activer les events sur la map  l'init de l'outil,\n    // mais uniquement  son utilisation !\n    if (map) {\n\n        // var self = this;\n        // map.on(\"click\", function (e) {\n        //     logger.trace(\"event on map with click!\");\n        //     self.onPointerMoveHandler(e);\n        // });\n        //\n        // map.on(\"singleclick\", function (e) {\n        //     logger.trace(\"event on map with singleclick!\");\n        //     self.onPointerMoveHandler(e);\n        // });\n        //\n        // map.on(\"pointermove\", function (e) {\n        //     logger.trace(\"event on map with pointermove!\");\n        //     self.onPointerMoveHandler(e);\n        // });\n\n        if (!this.options.target) {\n            MeasureToolBox.add(map, this);\n        }\n\n    } else {\n        this.clean();\n    }\n\n    // sauvegarde de l'tat de l'outil\n    this.tools[className].instance = (map) ? this : null;\n\n    // on appelle la mthode setMap originale d'OpenLayers\n    ol.control.Control.prototype.setMap.call(this, map);\n\n};\n\n// ################################################################### //\n// ##################### init component ############################## //\n// ################################################################### //\n\n/**\n * Initialize measure control (called by constructor)\n *\n * @private\n */\nMeasureLength.prototype._initialize = function(options) {\n    logger.trace(\"call MeasureLength::_initialize() : \", options);\n\n    // liste des options\n    this.options = {};\n    this.options.geodesic = (typeof options.geodesic !== \"undefined\") ? options.geodesic : true;\n    this.options.target = (typeof options.target !== \"undefined\") ? options.target : null;\n    this.options.render = (typeof options.render !== \"undefined\") ? options.render : null;\n\n    // gestion des styles !\n    this.createStylingMeasureInteraction(options.styles);\n\n};\n\n/**\n * initialize component container (DOM)\n *\n * @private\n */\nMeasureLength.prototype._initializeContainer = function() {\n    logger.trace(\"call MeasureLength::_initializeContainer() : \", this._uid);\n\n    var container = this._createMainContainerElement();\n\n    var show = this._showContainer = this._createShowMeasureLengthElement();\n    container.appendChild(show);\n\n    // par defaut, pas d'interaction  l'initialisation...\n    this._showContainer.checked = false;\n\n    var picto = this._pictoContainer = this._createShowMeasureLengthPictoElement();\n    container.appendChild(picto);\n\n    return container;\n};\n\n// ################################################################### //\n// ########################## methods ################################ //\n// ################################################################### //\n\n/**\n * Add all events on map\n *\n * @private\n */\nMeasureLength.prototype.addMeasureEvents = function() {\n    logger.trace(\"call MeasureLength::addMeasureEvents()\");\n\n    var map = this.getMap();\n\n    map.on(\"singleclick\", this.onPointerMoveHandler, this);\n    map.on(\"pointermove\", this.onPointerMoveHandler, this);\n};\n\n/**\n * Remove all events on map\n *\n * @private\n */\nMeasureLength.prototype.removeMeasureEvents = function() {\n    logger.trace(\"call MeasureLength::removeMeasureEvents()\");\n\n    var map = this.getMap();\n\n    map.un(\"singleclick\", this.onPointerMoveHandler, this);\n    map.un(\"pointermove\", this.onPointerMoveHandler, this);\n};\n\n/**\n * Format length output.\n *\n * @param {ol.geom.Line} line - geometry line.\n * @return {String} The formatted output.\n * @private\n */\nMeasureLength.prototype.format = function(line) {\n    logger.trace(\"call MeasureLength::format()\");\n\n    var map = this.getMap();\n\n    var measure;\n    if (this.options.geodesic) {\n        var wgs84Sphere = new ol.Sphere(6378137);\n        var coordinates = line.getCoordinates();\n        measure = 0;\n        var sourceProj = map.getView().getProjection();\n        for (var i = 0, ii = coordinates.length - 1; i < ii; ++i) {\n            var c1 = ol.proj.transform(coordinates[i], sourceProj, \"EPSG:4326\");\n            var c2 = ol.proj.transform(coordinates[i + 1], sourceProj, \"EPSG:4326\");\n            measure += wgs84Sphere.haversineDistance(c1, c2);\n        }\n    } else {\n        measure = Math.round(line.getLength() * 100) / 100;\n    }\n\n    var output;\n    if (measure > 1000) {\n        output = (Math.round(measure / 1000 * 100) / 100) + \" \" + \"km\";\n    } else {\n        output = (Math.round(measure * 100) / 100) + \" \" + \"m\";\n    }\n    return output;\n};\n\n// ################################################################### //\n// ####################### handlers events to dom #################### //\n// ################################################################### //\n\n/**\n * this method is called by event 'click' on picto\n *\n * @param {Object} e - HTMLElement\n *\n * @private\n */\nMeasureLength.prototype.onShowMeasureLengthClick = function(e) {\n    logger.trace(\"call MeasureLength::onShowMeasureLengthClick()\", e);\n\n    // appel de la methode commune\n    this.onShowMeasureClick(e, \"LineString\");\n};\n\nexport default MeasureLength;\n\n\n\n// WEBPACK FOOTER //\n// ./src/OpenLayers/Controls/Measures/MeasureLength.js","var MeasureLengthDOM = {\n\n    /** Add uuid to the tag ID */\n    _addUID: function(id) {\n        var uid = (this._uid) ? id + \"-\" + this._uid : id;\n        return uid;\n    },\n\n    /**\n     * Main container (DOM)\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createMainContainerElement: function() {\n\n        var container = document.createElement(\"div\");\n        container.id = this._addUID(\"GPmeasureLength\");\n        container.className = \"GPwidget\";\n        return container;\n    },\n\n    // ################################################################### //\n    // ################### Methods of main container ##################### //\n    // ################################################################### //\n\n    /**\n     * Hidden checkbox for minimizing/maximizing\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createShowMeasureLengthElement: function() {\n\n        var input = document.createElement(\"input\");\n        input.id = this._addUID(\"GPshowMeasureLength\");\n        input.type = \"checkbox\";\n        return input;\n    },\n\n    /**\n     * Show control\n     * see event !\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createShowMeasureLengthPictoElement: function() {\n\n        // contexte d'execution\n        var context = this;\n\n        var label = document.createElement(\"label\");\n        label.id = this._addUID(\"GPshowMeasureLengthPicto\");\n        label.className = \"GPshowAdvancedToolPicto\";\n        label.htmlFor = this._addUID(\"GPshowMeasureLength\");\n        label.title = \"Mesurer une distance\";\n\n        // gestionnaire d'evenement :\n        // on ouvre le menu de saisie...\n        // L'ouverture/Fermeture permet de faire le menage\n        // (reinitialisation)\n        if (label.addEventListener) {\n            label.addEventListener(\"click\", function(e) {\n                context.onShowMeasureLengthClick(e);\n            });\n        } else if (label.attachEvent) {\n            label.attachEvent(\"onclick\", function(e) {\n                context.onShowMeasureLengthClick(e);\n            });\n        }\n\n        var spanOpen = document.createElement(\"span\");\n        spanOpen.id = this._addUID(\"GPshowMeasureLengthOpen\");\n        spanOpen.className = \"GPshowAdvancedToolOpen\";\n        label.appendChild(spanOpen);\n\n        return label;\n    }\n};\n\nexport default MeasureLengthDOM;\n\n\n\n// WEBPACK FOOTER //\n// ./src/Common/Controls/MeasureLengthDOM.js","import ol from \"ol\";\nimport Logger from \"../../../Common/Utils/LoggerByDefault\";\nimport Utils from \"../../../Common/Utils\";\nimport MeasureToolBox from \"../MeasureToolBox\";\nimport Measures from \"./Measures\";\nimport MeasureAreaDOM from \"../../../Common/Controls/MeasureAreaDOM\";\nimport ID from \"../../../Common/Utils/SelectorID\";\n\n// Derived from OpenLayers measure example\n// http://openlayers.org/en/latest/examples/measure.html\n\n\nvar logger = Logger.getLogger(\"measurearea\");\n\n/**\n * @classdesc\n *\n * Tool Measure Area Control. Allows users to measure the length of a path drawn on the map.\n *\n * @constructor\n * @alias ol.control.MeasureArea\n * @extends {ol.control.Control}\n * @param {Object} options - options for function call.\n * @param {Boolean} [options.geodesic = true] - If true, area will be computed on the global sphere using the {@link https://openlayers.org/en/latest/apidoc/ol.Sphere.html#geodesicArea ol.Sphere.geodesicArea()} function. Otherwise, area will be computed on the projected plane.\n * @param {Object} [options.styles = {}] - styles used when drawing. Specified with following properties.\n * @param {Object} [options.styles.pointer = {}] - Style for mouse pointer when drawing the polygon to measure. Specified with an {@link https://openlayers.org/en/latest/apidoc/ol.style.Image.html ol.style.Image} subclass object.\n * @param {Object} [options.styles.start = {}] - Polygon Style when drawing. Specified with an {@link https://openlayers.org/en/latest/apidoc/ol.style.Style.html ol.style.Style} object.\n * @param {Object} [options.styles.finish = {}] - Polygon Style when finished drawing. Specified with an {@link https://openlayers.org/en/latest/apidoc/ol.style.Style.html ol.style.Style} object.\n * <!-- @param {Object} [options.tooltip = {}] - NOT YET IMPLEMENTED ! -->\n * @example\n * var measureArea = new ol.control.MeasureArea({\n *    geodesic : false\n * });\n */\nfunction MeasureArea(options) {\n\n    /**\n     * options\n     * @private\n     */\n    options = options || {};\n\n    if (!(this instanceof MeasureArea)) {\n        throw new TypeError(\"ERROR CLASS_CONSTRUCTOR\");\n    }\n\n    /**\n     * Nom de la classe (heritage)\n     * @private\n     */\n    this.CLASSNAME = \"MeasureArea\";\n\n    // uuid\n    this._uid = ID.generate();\n\n    // container d'activation du controle\n    this._showContainer = null;\n    this._pictoContainer = null;\n\n    // initialisation du composant\n    this._initialize(options);\n\n    // creation du DOM container\n    var container = (options.element) ? options.element : this._initializeContainer();\n\n    // heritage\n    ol.control.Control.call(this, {\n        element: container,\n        target: options.target,\n        render: options.render\n    });\n}\n\n// heritage avec ol.control.Control\nol.inherits(MeasureArea, ol.control.Control);\n\n/**\n * @lends module:MeasureArea\n */\nMeasureArea.prototype = Object.create(ol.control.Control.prototype, {});\n\n// on rcupre les mixins de la classe \"MeasureAreaDOM\" ainsi que celles\n// de \"Measures\".\nUtils.assign(MeasureArea.prototype, Measures);\nUtils.assign(MeasureArea.prototype, MeasureAreaDOM);\n\n/**\n * Constructor (alias)\n * @private\n */\nMeasureArea.prototype.constructor = MeasureArea;\n\n// ################################################################### //\n// ##################### public methods ############################## //\n// ################################################################### //\n\n/**\n * Overwrite OpenLayers setMap method\n *\n * @param {ol.Map} map - Map.\n */\nMeasureArea.prototype.setMap = function(map) {\n    logger.trace(\"setMap()\");\n\n    var className = this.CLASSNAME;\n\n    // on fait le choix de ne pas activer les events sur la map  l'init de l'outil,\n    // mais uniquement  son utilisation !\n    if (map) {\n\n        // var self = this;\n        // map.on(\"click\", function (e) {\n        //     logger.trace(\"event on map with click!\");\n        //     self.onPointerMoveHandler(e);\n        // });\n        //\n        // map.on(\"singleclick\", function (e) {\n        //     logger.trace(\"event on map with singleclick!\");\n        //     self.onPointerMoveHandler(e);\n        // });\n        //\n        // map.on(\"pointermove\", function (e) {\n        //     logger.trace(\"event on map with pointermove!\");\n        //     self.onPointerMoveHandler(e);\n        // });\n\n        if (!this.options.target) {\n            MeasureToolBox.add(map, this);\n        }\n    } else {\n        this.clean();\n    }\n\n    // sauvegarde de l'tat de l'outil\n    this.tools[className].instance = (map) ? this : null;\n\n    // on appelle la mthode setMap originale d'OpenLayers\n    ol.control.Control.prototype.setMap.call(this, map);\n\n};\n\n// ################################################################### //\n// ##################### init component ############################## //\n// ################################################################### //\n\n/**\n * Initialize measure control (called by constructor)\n *\n * @private\n */\nMeasureArea.prototype._initialize = function(options) {\n    logger.trace(\"call MeasureArea::_initialize() : \", options);\n\n    // liste des options\n    this.options = {};\n    this.options.geodesic = (typeof options.geodesic !== \"undefined\") ? options.geodesic : true;\n    this.options.target = (typeof options.target !== \"undefined\") ? options.target : null;\n    this.options.render = (typeof options.render !== \"undefined\") ? options.render : null;\n\n    // gestion des styles !\n    this.createStylingMeasureInteraction(options.styles);\n};\n\n/**\n * initialize component container (DOM)\n *\n * @private\n */\nMeasureArea.prototype._initializeContainer = function() {\n    logger.trace(\"call MeasureArea::_initializeContainer() : \", this._uid);\n\n    var container = this._createMainContainerElement();;\n\n    var show = this._showContainer = this._createShowMeasureAreaElement();\n    container.appendChild(show);\n\n    // par defaut, pas d'interaction  l'initialisation...\n    this._showContainer.checked = false;\n\n    var picto = this._pictoContainer = this._createShowMeasureAreaPictoElement();\n    container.appendChild(picto);\n\n    return container;\n};\n\n// ################################################################### //\n// ##################### overridden methods ########################## //\n// ################################################################### //\n\n/**\n * Add all events on map\n *\n * @private\n */\nMeasureArea.prototype.addMeasureEvents = function() {\n    logger.trace(\"call MeasureArea::addMeasureEvents()\");\n\n    var map = this.getMap();\n\n    map.on(\"singleclick\", this.onPointerMoveHandler, this);\n    map.on(\"pointermove\", this.onPointerMoveHandler, this);\n};\n\n/**\n * Remove all events on map\n *\n * @private\n */\nMeasureArea.prototype.removeMeasureEvents = function() {\n    logger.trace(\"call MeasureArea::removeMeasureEvents()\");\n\n    var map = this.getMap();\n\n    map.un(\"singleclick\", this.onPointerMoveHandler, this);\n    map.un(\"pointermove\", this.onPointerMoveHandler, this);\n};\n\n/**\n * Format length output.\n *\n * @param {ol.geom.Polygon} polygon - geometry polygon.\n * @return {String} The formatted output.\n * @private\n */\nMeasureArea.prototype.format = function(polygon) {\n    logger.trace(\"call MeasureArea::format()\");\n\n    var map = this.getMap();\n\n    var measure;\n    if (this.options.geodesic) {\n        var wgs84Sphere = new ol.Sphere(6378137);\n        var sourceProj = map.getView().getProjection();\n        var geom = (polygon.clone().transform(sourceProj, \"EPSG:4326\"));\n        var coordinates = geom.getLinearRing(0).getCoordinates();\n        measure = Math.abs(wgs84Sphere.geodesicArea(coordinates));\n    } else {\n        measure = polygon.getArea();\n    }\n\n    var output;\n    if (measure > 1000000) {\n        output = (Math.round(measure / 1000000 * 100) / 100) + \" \" + \"km<sup>2</sup>\";\n    } else if (measure > 100000) {\n        output = (Math.round(measure / 1000000 * 1000) / 1000) + \" \" + \"km<sup>2</sup>\";\n    } else if (measure > 1000) {\n        output = (Math.round(measure / 10) * 10) + \" \" + \"m<sup>2</sup>\";\n    } else {\n        output = (Math.round(measure * 100) / 100) + \" \" + \"m<sup>2</sup>\";\n    }\n    return output;\n};\n\n// ################################################################### //\n// ####################### handlers events to dom #################### //\n// ################################################################### //\n\n/**\n * this method is called by event 'click' on picto\n *\n * @param {Object} e - HTMLElement\n *\n * @private\n */\nMeasureArea.prototype.onShowMeasureAreaClick = function(e) {\n    logger.trace(\"call MeasureArea::onShowMeasureAreaClick()\", e);\n\n    // appel de la methode commune\n    this.onShowMeasureClick(e, \"Polygon\");\n};\n\nexport default MeasureArea;\n\n\n\n// WEBPACK FOOTER //\n// ./src/OpenLayers/Controls/Measures/MeasureArea.js","var MeasureAreaDOM = {\n\n    /** Add uuid to the tag ID */\n    _addUID: function(id) {\n        var uid = (this._uid) ? id + \"-\" + this._uid : id;\n        return uid;\n    },\n\n    /**\n     * Main container (DOM)\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createMainContainerElement: function() {\n\n        var container = document.createElement(\"div\");\n        container.id = this._addUID(\"GPmeasureArea\");\n        container.className = \"GPwidget\";\n        return container;\n    },\n\n    // ################################################################### //\n    // ################### Methods of main container ##################### //\n    // ################################################################### //\n\n    /**\n     * Hidden checkbox for minimizing/maximizing\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createShowMeasureAreaElement: function() {\n\n        var input = document.createElement(\"input\");\n        input.id = this._addUID(\"GPshowMeasureArea\");\n        input.type = \"checkbox\";\n        return input;\n    },\n\n    /**\n     * Show control\n     * see event !\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createShowMeasureAreaPictoElement: function() {\n\n        // contexte d'execution\n        var context = this;\n\n        var label = document.createElement(\"label\");\n        label.id = this._addUID(\"GPshowMeasureAreaPicto\");\n        label.className = \"GPshowAdvancedToolPicto\";\n        label.htmlFor = this._addUID(\"GPshowMeasureArea\");\n        label.title = \"Mesurer une surface\";\n\n        // gestionnaire d'evenement :\n        // on ouvre le menu de saisie...\n        // L'ouverture/Fermeture permet de faire le menage\n        // (reinitialisation)\n        if (label.addEventListener) {\n            label.addEventListener(\"click\", function(e) {\n                context.onShowMeasureAreaClick(e);\n            });\n        } else if (label.attachEvent) {\n            label.attachEvent(\"onclick\", function(e) {\n                context.onShowMeasureAreaClick(e);\n            });\n        }\n\n        var spanOpen = document.createElement(\"span\");\n        spanOpen.id = this._addUID(\"GPshowMeasureAreaOpen\");\n        spanOpen.className = \"GPshowAdvancedToolOpen\";\n        label.appendChild(spanOpen);\n\n        return label;\n    }\n};\n\nexport default MeasureAreaDOM;\n\n\n\n// WEBPACK FOOTER //\n// ./src/Common/Controls/MeasureAreaDOM.js","import ol from \"ol\";\nimport Logger from \"../../../Common/Utils/LoggerByDefault\";\nimport Utils from \"../../../Common/Utils\";\nimport MeasureToolBox from \"../MeasureToolBox\";\nimport Measures from \"./Measures\";\nimport MeasureAzimuthDOM from \"../../../Common/Controls/MeasureAzimuthDOM\";\nimport ID from \"../../../Common/Utils/SelectorID\";\n\n// Derived from OpenLayers measure example\n// http://openlayers.org/en/latest/examples/measure.html\n\n\nvar logger = Logger.getLogger(\"measureazimut\");\n\n/**\n * @classdesc\n *\n * Azimuth measurement Control. Allows users to draw a line on an OL3 map and have its angle in decimal degrees clockwise from the geographical north.\n *\n * @constructor\n * @alias ol.control.MeasureAzimuth\n * @extends {ol.control.Control}\n * @param {Object} options - options for function call.\n * @param {Boolean} [options.geodesic = false] - If true, azimuth will be computed on the global sphere. Otherwise, it will be computed on the projected plane.\n * @param {Object} [options.styles = {}] - styles used when drawing. Specified with following properties.\n * @param {Object} [options.styles.pointer = {}] - Style for mouse pointer when drawing the line. Specified with an {@link https://openlayers.org/en/latest/apidoc/ol.style.Image.html ol.style.Image} subclass object.\n * @param {Object} [options.styles.start = {}] - Line Style when drawing. Specified with an {@link https://openlayers.org/en/latest/apidoc/ol.style.Style.html ol.style.Style} object.\n * @param {Object} [options.styles.finish = {}] - Line Style when finished drawing. Specified with an {@link https://openlayers.org/en/latest/apidoc/ol.style.Style.html ol.style.Style} object.\n * <!-- @param {Object} [options.tooltip = {}] - NOT YET IMPLEMENTED ! -->\n * @example\n * var measure = new ol.control.MeasureAzimuth({\n *   geodesic : true\n * });\n */\nfunction MeasureAzimuth(options) {\n\n    /**\n     * options\n     * @private\n     */\n    options = options || {};\n\n    if (!(this instanceof MeasureAzimuth)) {\n        throw new TypeError(\"ERROR CLASS_CONSTRUCTOR\");\n    }\n\n    /**\n     * Nom de la classe (heritage)\n     * @private\n     */\n    this.CLASSNAME = \"MeasureAzimuth\";\n\n    // uuid\n    this._uid = ID.generate();\n\n    // container d'activation du controle\n    this._showContainer = null;\n    this._pictoContainer = null;\n\n    // initialisation du composant\n    this._initialize(options);\n\n    // creation du DOM container\n    var container = (options.element) ? options.element : this._initializeContainer();\n\n    // heritage\n    ol.control.Control.call(this, {\n        element: container,\n        target: options.target,\n        render: options.render\n    });\n}\n\n// heritage avec ol.control.Control\nol.inherits(MeasureAzimuth, ol.control.Control);\n\n/**\n * @lends module:MeasureAzimuth\n */\nMeasureAzimuth.prototype = Object.create(ol.control.Control.prototype, {});\n\n// on rcupre les mixins de la classe \"MeasureAzimuthDOM\" ainsi que celles\n// de \"Measures\".\nUtils.assign(MeasureAzimuth.prototype, Measures);\nUtils.assign(MeasureAzimuth.prototype, MeasureAzimuthDOM);\n\n/**\n * Constructor (alias)\n * @private\n */\nMeasureAzimuth.prototype.constructor = MeasureAzimuth;\n\n// ################################################################### //\n// ##################### public methods ############################## //\n// ################################################################### //\n\n/**\n * Overwrite OpenLayers setMap method\n *\n * @param {ol.Map} map - Map.\n */\nMeasureAzimuth.prototype.setMap = function(map) {\n    logger.trace(\"setMap()\");\n\n    var className = this.CLASSNAME;\n\n    // on fait le choix de ne pas activer les events sur la map  l'init de l'outil,\n    // mais uniquement  son utilisation !\n    if (map) {\n\n        // var self = this;\n        // map.on(\"click\", function (e) {\n        //     logger.trace(\"event on map with click!\");\n        //     self.onPointerMoveAzimutHandler(e);\n        // });\n        //\n        // map.on(\"singleclick\", function (e) {\n        //     logger.trace(\"event on map with singleclick!\");\n        //     self.onPointerMoveAzimutHandler(e);\n        // });\n        //\n        // map.on(\"pointermove\", function (e) {\n        //     logger.trace(\"event on map with pointermove!\");\n        //     self.onPointerMoveAzimutHandler(e);\n        // });\n\n        if (!this.options.target) {\n            MeasureToolBox.add(map, this);\n        }\n    } else {\n        this.clean();\n    }\n\n    // sauvegarde de l'tat de l'outil\n    this.tools[className].instance = (map) ? this : null;\n\n    // on appelle la mthode setMap originale d'OpenLayers\n    ol.control.Control.prototype.setMap.call(this, map);\n\n};\n\n/**\n * Setter for option Geodesic\n *\n * @param {Boolean} value - geodesic value\n */\nMeasureAzimuth.prototype.setGeodesic = function(value) {\n    this.options.geodesic = (typeof value !== \"undefined\") ? value : false;\n};\n\n/**\n * Getter for option Geodesic\n *\n * @return {Boolean} geodesic value\n */\nMeasureAzimuth.prototype.isGeodesic = function() {\n    return this.options.geodesic;\n};\n\n// ################################################################### //\n// ##################### init component ############################## //\n// ################################################################### //\n\n/**\n * Initialize measure control (called by constructor)\n *\n * @private\n */\nMeasureAzimuth.prototype._initialize = function(options) {\n    logger.trace(\"call MeasureAzimuth::_initialize() : \", options);\n\n    // liste des options\n    this.options = {};\n    this.options.geodesic = (typeof options.geodesic !== \"undefined\") ? options.geodesic : false;\n    this.options.target = (typeof options.target !== \"undefined\") ? options.target : null;\n    this.options.render = (typeof options.render !== \"undefined\") ? options.render : null;\n\n    // gestion des styles !\n    this.createStylingMeasureInteraction(options.styles);\n\n};\n\n/**\n * initialize component container (DOM)\n *\n * @private\n */\nMeasureAzimuth.prototype._initializeContainer = function() {\n    logger.trace(\"call MeasureAzimuth::_initializeContainer() : \", this._uid);\n\n    var container = this._createMainContainerElement();;\n\n    var show = this._showContainer = this._createShowMeasureAzimuthElement();\n    container.appendChild(show);\n\n    // par defaut, pas d'interaction  l'initialisation...\n    this._showContainer.checked = false;\n\n    var picto = this._pictoContainer = this._createShowMeasureAzimuthPictoElement();\n    container.appendChild(picto);\n\n    return container;\n};\n\n// ################################################################### //\n// ##################### overridden methods ########################## //\n// ################################################################### //\n\n/**\n * Add all events on map\n *\n * @private\n */\nMeasureAzimuth.prototype.addMeasureEvents = function() {\n    logger.trace(\"call MeasureAzimuth::addMeasureEvents()\");\n\n    var map = this.getMap();\n\n    map.on(\"singleclick\", this.onPointerMoveAzimutHandler, this);\n    map.on(\"pointermove\", this.onPointerMoveAzimutHandler, this);\n};\n\n/**\n * Remove all events on map\n *\n * @private\n */\nMeasureAzimuth.prototype.removeMeasureEvents = function() {\n    logger.trace(\"call MeasureAzimuth::removeMeasureEvents()\");\n\n    var map = this.getMap();\n\n    map.un(\"singleclick\", this.onPointerMoveAzimutHandler, this);\n    map.un(\"pointermove\", this.onPointerMoveAzimutHandler, this);\n};\n\n/**\n * Format length output.\n *\n * @param {ol.geom.LineString} line - geometry line.\n * @return {String} The formatted output.\n * @private\n */\nMeasureAzimuth.prototype.format = function(line) {\n    logger.trace(\"call MeasureAzimuth::format()\");\n\n    var map = this.getMap();\n\n    var sourceProj = map.getView().getProjection();\n\n    var c1 = ol.proj.transform(line.getFirstCoordinate(), sourceProj, \"EPSG:4326\");\n    var c2 = ol.proj.transform(line.getLastCoordinate(), sourceProj, \"EPSG:4326\");\n\n    if (!this.options.geodesic) {\n        // TODO calcul sur une petite distance (>500m) afin de simuler un cap !\n        var wgs84Sphere = new ol.Sphere(6378137);\n        var lengthGeodesic = wgs84Sphere.haversineDistance(c1, c2);\n        logger.trace(\"measure between 2 points with geodesic method\", lengthGeodesic);\n        if (lengthGeodesic > 500) {\n            var fraction = 500.0 / lengthGeodesic;\n            logger.trace(\"%\", fraction);\n            c2 = ol.proj.transform(line.getCoordinateAt(fraction), sourceProj, \"EPSG:4326\");\n        }\n    }\n\n    var degrees2radians = Math.PI / 180;\n    var radians2degrees = 180 / Math.PI;\n\n    var lon1 = degrees2radians * c1[0];\n    var lon2 = degrees2radians * c2[0];\n\n    var lat1 = degrees2radians * c1[1];\n    var lat2 = degrees2radians * c2[1];\n\n    var a = Math.sin(lon2 - lon1) * Math.cos(lat2);\n    var b = Math.cos(lat1) * Math.sin(lat2) - Math.sin(lat1) * Math.cos(lat2) * Math.cos(lon2 - lon1);\n\n    var atan = Math.atan2(a, b);\n\n    var azimut = radians2degrees * atan;\n    logger.trace(\"azimut\", azimut);\n\n    if (azimut < 0) {\n        azimut += 360;\n    }\n    var output = Math.round(azimut * 100) / 100 + \" \";\n\n    return output;\n};\n\n// ################################################################### //\n// ####################### handlers events to dom #################### //\n// ################################################################### //\n\n/**\n * this method is called by event 'click' on picto\n *\n * @param {Object} e - HTMLElement\n * @private\n */\nMeasureAzimuth.prototype.onShowMeasureAzimuthClick = function(e) {\n    logger.trace(\"call MeasureAzimuth::onShowMeasureAzimuthClick()\", e);\n\n    // appel de la methode commune\n    this.onShowMeasureClick(e, \"LineString\");\n};\n\n/**\n * Handle pointer click.\n *\n * @param {ol.MapBrowserEvent} e - The event.\n * @private\n */\nMeasureAzimuth.prototype.onPointerMoveAzimutHandler = function(e) {\n\n    this.onPointerMoveHandler(e);\n\n    if (this.sketch) {\n        var geom = ( /** @type {ol.geom.LineString} */ (this.sketch.getGeometry()));\n        if (geom.getCoordinates().length > 2) {\n            this.measureDraw.finishDrawing();\n        }\n    }\n\n};\n\nexport default MeasureAzimuth;\n\n\n\n// WEBPACK FOOTER //\n// ./src/OpenLayers/Controls/Measures/MeasureAzimuth.js","var MeasureAzimuthDOM = {\n\n    /** Add uuid to the tag ID */\n    _addUID: function(id) {\n        var uid = (this._uid) ? id + \"-\" + this._uid : id;\n        return uid;\n    },\n\n    /**\n     * Main container (DOM)\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createMainContainerElement: function() {\n\n        var container = document.createElement(\"div\");\n        container.id = this._addUID(\"GPmeasureAzimuth\");\n        container.className = \"GPwidget\";\n        return container;\n    },\n\n    // ################################################################### //\n    // ################### Methods of main container ##################### //\n    // ################################################################### //\n\n    /**\n     * Hidden checkbox for minimizing/maximizing\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createShowMeasureAzimuthElement: function() {\n\n        var input = document.createElement(\"input\");\n        input.id = this._addUID(\"GPshowMeasureAzimuth\");\n        input.type = \"checkbox\";\n        return input;\n    },\n\n    /**\n     * Show control\n     * see event !\n     *\n     * @returns {DOMElement} DOM element\n     */\n    _createShowMeasureAzimuthPictoElement: function() {\n\n        // contexte d'execution\n        var context = this;\n\n        var label = document.createElement(\"label\");\n        label.id = this._addUID(\"GPshowMeasureAzimuthPicto\");\n        label.className = \"GPshowAdvancedToolPicto\";\n        label.htmlFor = this._addUID(\"GPshowMeasureAzimuth\");\n        label.title = \"Mesurer un azimut\";\n\n        // gestionnaire d'evenement :\n        // on ouvre le menu de saisie...\n        // L'ouverture/Fermeture permet de faire le menage\n        // (reinitialisation)\n        if (label.addEventListener) {\n            label.addEventListener(\"click\", function(e) {\n                context.onShowMeasureAzimuthClick(e);\n            });\n        } else if (label.attachEvent) {\n            label.attachEvent(\"onclick\", function(e) {\n                context.onShowMeasureAzimuthClick(e);\n            });\n        }\n\n        var spanOpen = document.createElement(\"span\");\n        spanOpen.id = this._addUID(\"GPshowMeasureAzimuthOpen\");\n        spanOpen.className = \"GPshowAdvancedToolOpen\";\n        label.appendChild(spanOpen);\n\n        return label;\n    }\n};\n\nexport default MeasureAzimuthDOM;\n\n\n\n// WEBPACK FOOTER //\n// ./src/Common/Controls/MeasureAzimuthDOM.js"],"sourceRoot":""}